import{j as n1}from"./jsx-runtime.CzgMDNMm.js";import{g as w_,r as ps,R as O5,a as M_}from"./index.DQ2WTIsS.js";import{P as vt}from"./index.BEUvLPWW.js";function F5(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function N5(s,e,n){return e=W5(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function aC(s,e){return z5(s)||F5(s,e)||eI(s,e)||H5()}function U5(s){return k5(s)||G5(s)||eI(s)||V5()}function k5(s){if(Array.isArray(s))return pb(s)}function z5(s){if(Array.isArray(s))return s}function G5(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function eI(s,e){if(s){if(typeof s=="string")return pb(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pb(s,e)}}function pb(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function V5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j5(s,e){if(typeof s!="object"||s===null)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function W5(s){var e=j5(s,"string");return typeof e=="symbol"?e:String(e)}var Q5=function(e,n){var i=new Set(n);return Object.assign.apply(Object,[{}].concat(U5(Object.entries(e).filter(function(o){var a=aC(o,1),c=a[0];return!i.has(c)}).map(function(o){var a=aC(o,2),c=a[0],u=a[1];return N5({},c,u)}))))};/*! fromentries. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var X5=function(e){return[...e].reduce((n,[i,o])=>(n[i]=o,n),{})};const lC=w_(X5);function K5(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function mb(s){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mb(s)}function tI(s,e){return Y5(s)||K5(s,e)||nI(s,e)||Z5()}function cC(s){return q5(s)||$5(s)||nI(s)||J5()}function q5(s){if(Array.isArray(s))return gb(s)}function Y5(s){if(Array.isArray(s))return s}function $5(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function nI(s,e){if(s){if(typeof s=="string")return gb(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gb(s,e)}}function gb(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function J5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ov(s,e){var n=mb(e)==="object"?e:{wrapperElementType:e,methodNames:(arguments.length<=2?void 0:arguments[2])||void 0,initPropNames:(arguments.length<=3?void 0:arguments[3])||void 0},i=n.wrapperElementType,o=i===void 0?"div":i,a=n.nodeMapper,c=a===void 0?function(p){return p}:a,u=n.methodNames,h=u===void 0?[]:u,d=n.initPropNames,f=d===void 0?[]:d;return ps.forwardRef(function(p,A){var g=ps.useRef(),v=ps.useState({}),b=tI(v,2),x=b[0],E=b[1];ps.useEffect(function(){return E(p)});var S=ps.useMemo(function(){var T=lC(f.filter(function(L){return p.hasOwnProperty(L)}).map(function(L){return[L,p[L]]}));return s(T)},[]);hC(function(){S(c(g.current))},ps.useLayoutEffect),hC(function(){return S._destructor instanceof Function?S._destructor:void 0});var M=ps.useCallback(function(T){for(var L=arguments.length,B=new Array(L>1?L-1:0),F=1;F<L;F++)B[F-1]=arguments[F];return S[T]instanceof Function?S[T].apply(S,B):void 0},[S]),C=Q5(p,[].concat(cC(h),cC(f)));return Object.keys(C).filter(function(T){return x[T]!==p[T]}).forEach(function(T){return M(T,p[T])}),ps.useImperativeHandle(A,function(){return lC(h.map(function(T){return[T,function(){for(var L=arguments.length,B=new Array(L),F=0;F<L;F++)B[F]=arguments[F];return M.apply(void 0,[T].concat(B))}]}))}),O5.createElement(o,{ref:g})})}function hC(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ps.useEffect,n=ps.useRef(),i=ps.useRef(!1),o=ps.useRef(!1),a=ps.useState(0),c=tI(a,2);c[0];var u=c[1];i.current&&(o.current=!0),e(function(){return i.current||(n.current=s(),i.current=!0),u(function(h){return h+1}),function(){o.current&&n.current&&n.current()}},[])}var eU={exports:{}};(function(s,e){(function(i,o){s.exports=o()})(self,()=>(()=>{var n={"./node_modules/@ungap/custom-elements/index.js":()=>{/*! (c) Andrea Giammarchi @webreflection ISC */(function(){var c=function(sn,Rt){var gn=function(Jn){for(var $n=0,Ei=Jn.length;$n<Ei;$n++)si(Jn[$n])},si=function(Jn){var $n=Jn.target,Ei=Jn.attributeName,Fi=Jn.oldValue;$n.attributeChangedCallback(Ei,Fi,$n.getAttribute(Ei))};return function(Ln,Jn){var $n=Ln.constructor.observedAttributes;return $n&&sn(Jn).then(function(){new Rt(gn).observe(Ln,{attributes:!0,attributeOldValue:!0,attributeFilter:$n});for(var Ei=0,Fi=$n.length;Ei<Fi;Ei++)Ln.hasAttribute($n[Ei])&&si({target:Ln,attributeName:$n[Ei],oldValue:null})}),Ln}};function u(sn,Rt){if(sn){if(typeof sn=="string")return h(sn,Rt);var gn=Object.prototype.toString.call(sn).slice(8,-1);if(gn==="Object"&&sn.constructor&&(gn=sn.constructor.name),gn==="Map"||gn==="Set")return Array.from(sn);if(gn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(gn))return h(sn,Rt)}}function h(sn,Rt){(Rt==null||Rt>sn.length)&&(Rt=sn.length);for(var gn=0,si=new Array(Rt);gn<Rt;gn++)si[gn]=sn[gn];return si}function d(sn,Rt){var gn=typeof Symbol<"u"&&sn[Symbol.iterator]||sn["@@iterator"];if(!gn){if(Array.isArray(sn)||(gn=u(sn))||Rt&&sn&&typeof sn.length=="number"){gn&&(sn=gn);var si=0,Ln=function(){};return{s:Ln,n:function(){return si>=sn.length?{done:!0}:{done:!1,value:sn[si++]}},e:function(Fi){throw Fi},f:Ln}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Jn=!0,$n=!1,Ei;return{s:function(){gn=gn.call(sn)},n:function(){var Fi=gn.next();return Jn=Fi.done,Fi},e:function(Fi){$n=!0,Ei=Fi},f:function(){try{!Jn&&gn.return!=null&&gn.return()}finally{if($n)throw Ei}}}}/*! (c) Andrea Giammarchi - ISC */var f=!0,p=!1,A="querySelectorAll",g=function(Rt){var gn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,si=arguments.length>2&&arguments[2]!==void 0?arguments[2]:MutationObserver,Ln=arguments.length>3&&arguments[3]!==void 0?arguments[3]:["*"],Jn=function Fi(Vi,lr,cr,Le,ht,yt){var de=d(Vi),be;try{for(de.s();!(be=de.n()).done;){var Ve=be.value;(yt||A in Ve)&&(ht?cr.has(Ve)||(cr.add(Ve),Le.delete(Ve),Rt(Ve,ht)):Le.has(Ve)||(Le.add(Ve),cr.delete(Ve),Rt(Ve,ht)),yt||Fi(Ve[A](lr),lr,cr,Le,ht,f))}}catch(dt){de.e(dt)}finally{de.f()}},$n=new si(function(Fi){if(Ln.length){var Vi=Ln.join(","),lr=new Set,cr=new Set,Le=d(Fi),ht;try{for(Le.s();!(ht=Le.n()).done;){var yt=ht.value,de=yt.addedNodes,be=yt.removedNodes;Jn(be,Vi,lr,cr,p,p),Jn(de,Vi,lr,cr,f,p)}}catch(Ve){Le.e(Ve)}finally{Le.f()}}}),Ei=$n.observe;return($n.observe=function(Fi){return Ei.call($n,Fi,{subtree:f,childList:f})})(gn),$n},v="querySelectorAll",b=self,x=b.document,E=b.Element,S=b.MutationObserver,M=b.Set,C=b.WeakMap,T=function(Rt){return v in Rt},L=[].filter,B=function(sn){var Rt=new C,gn=function(Le){for(var ht=0,yt=Le.length;ht<yt;ht++)Rt.delete(Le[ht])},si=function(){for(var Le=Vi.takeRecords(),ht=0,yt=Le.length;ht<yt;ht++)$n(L.call(Le[ht].removedNodes,T),!1),$n(L.call(Le[ht].addedNodes,T),!0)},Ln=function(Le){return Le.matches||Le.webkitMatchesSelector||Le.msMatchesSelector},Jn=function(Le,ht){var yt;if(ht)for(var de,be=Ln(Le),Ve=0,dt=Ei.length;Ve<dt;Ve++)be.call(Le,de=Ei[Ve])&&(Rt.has(Le)||Rt.set(Le,new M),yt=Rt.get(Le),yt.has(de)||(yt.add(de),sn.handle(Le,ht,de)));else Rt.has(Le)&&(yt=Rt.get(Le),Rt.delete(Le),yt.forEach(function(ut){sn.handle(Le,ht,ut)}))},$n=function(Le){for(var ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,yt=0,de=Le.length;yt<de;yt++)Jn(Le[yt],ht)},Ei=sn.query,Fi=sn.root||x,Vi=g(Jn,Fi,S,Ei),lr=E.prototype.attachShadow;return lr&&(E.prototype.attachShadow=function(cr){var Le=lr.call(this,cr);return Vi.observe(Le),Le}),Ei.length&&$n(Fi[v](Ei)),{drop:gn,flush:si,observer:Vi,parse:$n}},F=self,D=F.document,P=F.Map,U=F.MutationObserver,K=F.Object,J=F.Set,z=F.WeakMap,j=F.Element,G=F.HTMLElement,H=F.Node,te=F.Error,Z=F.TypeError,ee=F.Reflect,oe=K.defineProperty,xe=K.keys,Pe=K.getOwnPropertyNames,me=K.setPrototypeOf,Ce=!self.customElements,Je=function(Rt){for(var gn=xe(Rt),si=[],Ln=gn.length,Jn=0;Jn<Ln;Jn++)si[Jn]=Rt[gn[Jn]],delete Rt[gn[Jn]];return function(){for(var $n=0;$n<Ln;$n++)Rt[gn[$n]]=si[$n]}};if(Ce){var Oe=function(){var Rt=this.constructor;if(!nt.has(Rt))throw new Z("Illegal constructor");var gn=nt.get(Rt);if(Tn)return Fe(Tn,gn);var si=$e.call(D,gn);return Fe(me(si,Rt.prototype),gn)},$e=D.createElement,nt=new P,gt=new P,Tt=new P,Ze=new P,mn=[],Ft=function(Rt,gn,si){var Ln=Tt.get(si);if(gn&&!Ln.isPrototypeOf(Rt)){var Jn=Je(Rt);Tn=me(Rt,Ln);try{new Ln.constructor}finally{Tn=null,Jn()}}var $n="".concat(gn?"":"dis","connectedCallback");$n in Ln&&Rt[$n]()},Qt=B({query:mn,handle:Ft}),Xt=Qt.parse,Tn=null,vn=function(Rt){if(!gt.has(Rt)){var gn,si=new Promise(function(Ln){gn=Ln});gt.set(Rt,{$:si,_:gn})}return gt.get(Rt).$},Fe=c(vn,U);oe(self,"customElements",{configurable:!0,value:{define:function(Rt,gn){if(Ze.has(Rt))throw new te('the name "'.concat(Rt,'" has already been used with this registry'));nt.set(gn,Rt),Tt.set(Rt,gn.prototype),Ze.set(Rt,gn),mn.push(Rt),vn(Rt).then(function(){Xt(D.querySelectorAll(Rt))}),gt.get(Rt)._(gn)},get:function(Rt){return Ze.get(Rt)},whenDefined:vn}}),oe(Oe.prototype=G.prototype,"constructor",{value:Oe}),oe(self,"HTMLElement",{configurable:!0,value:Oe}),oe(D,"createElement",{configurable:!0,value:function(Rt,gn){var si=gn&&gn.is,Ln=si?Ze.get(si):Ze.get(Rt);return Ln?new Ln:$e.call(D,Rt)}}),"isConnected"in H.prototype||oe(H.prototype,"isConnected",{configurable:!0,get:function(){return!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}else if(Ce=!self.customElements.get("extends-li"),Ce)try{var Te=function sn(){return self.Reflect.construct(HTMLLIElement,[],sn)};Te.prototype=HTMLLIElement.prototype;var pt="extends-li";self.customElements.define("extends-li",Te,{extends:"li"}),Ce=D.createElement("li",{is:pt}).outerHTML.indexOf(pt)<0;var Nt=self.customElements,zt=Nt.get,Vt=Nt.whenDefined;oe(self.customElements,"whenDefined",{configurable:!0,value:function(Rt){var gn=this;return Vt.call(this,Rt).then(function(si){return si||zt.call(gn,Rt)})}})}catch{}if(Ce){var fn=function(Rt){var gn=Ye.get(Rt);Ct(gn.querySelectorAll(this),Rt.isConnected)},mt=self.customElements,Ee=D.createElement,_e=mt.define,Ne=mt.get,ye=mt.upgrade,De=ee||{construct:function(Rt){return Rt.call(this)}},ke=De.construct,Ye=new z,Qe=new J,ne=new P,W=new P,k=new P,he=new P,Re=[],We=[],ve=function(Rt){return he.get(Rt)||Ne.call(mt,Rt)},at=function(Rt,gn,si){var Ln=k.get(si);if(gn&&!Ln.isPrototypeOf(Rt)){var Jn=Je(Rt);Fn=me(Rt,Ln);try{new Ln.constructor}finally{Fn=null,Jn()}}var $n="".concat(gn?"":"dis","connectedCallback");$n in Ln&&Rt[$n]()},At=B({query:We,handle:at}),Ct=At.parse,Pt=B({query:Re,handle:function(Rt,gn){Ye.has(Rt)&&(gn?Qe.add(Rt):Qe.delete(Rt),We.length&&fn.call(We,Rt))}}),$t=Pt.parse,Bn=j.prototype.attachShadow;Bn&&(j.prototype.attachShadow=function(sn){var Rt=Bn.call(this,sn);return Ye.set(this,Rt),Rt});var pi=function(Rt){if(!W.has(Rt)){var gn,si=new Promise(function(Ln){gn=Ln});W.set(Rt,{$:si,_:gn})}return W.get(Rt).$},Ri=c(pi,U),Fn=null;Pe(self).filter(function(sn){return/^HTML.*Element$/.test(sn)}).forEach(function(sn){var Rt=self[sn];function gn(){var si=this.constructor;if(!ne.has(si))throw new Z("Illegal constructor");var Ln=ne.get(si),Jn=Ln.is,$n=Ln.tag;if(Jn){if(Fn)return Ri(Fn,Jn);var Ei=Ee.call(D,$n);return Ei.setAttribute("is",Jn),Ri(me(Ei,si.prototype),Jn)}else return ke.call(this,Rt,[],si)}oe(gn.prototype=Rt.prototype,"constructor",{value:gn}),oe(self,sn,{value:gn})}),oe(D,"createElement",{configurable:!0,value:function(Rt,gn){var si=gn&&gn.is;if(si){var Ln=he.get(si);if(Ln&&ne.get(Ln).tag===Rt)return new Ln}var Jn=Ee.call(D,Rt);return si&&Jn.setAttribute("is",si),Jn}}),oe(mt,"get",{configurable:!0,value:ve}),oe(mt,"whenDefined",{configurable:!0,value:pi}),oe(mt,"upgrade",{configurable:!0,value:function(Rt){var gn=Rt.getAttribute("is");if(gn){var si=he.get(gn);if(si){Ri(me(Rt,si.prototype),gn);return}}ye.call(mt,Rt)}}),oe(mt,"define",{configurable:!0,value:function(Rt,gn,si){if(ve(Rt))throw new te("'".concat(Rt,"' has already been defined as a custom element"));var Ln,Jn=si&&si.extends;ne.set(gn,Jn?{is:Rt,tag:Jn}:{is:"",tag:Rt}),Jn?(Ln="".concat(Jn,'[is="').concat(Rt,'"]'),k.set(Ln,gn.prototype),he.set(Rt,gn),We.push(Ln)):(_e.apply(mt,arguments),Re.push(Ln=Rt)),pi(Rt).then(function(){Jn?(Ct(D.querySelectorAll(Ln)),Qe.forEach(fn,[Ln])):$t(D.querySelectorAll(Ln))}),W.get(Rt)._(gn)}})}})()},"./node_modules/an-array/index.js":c=>{var u=Object.prototype.toString;c.exports=h;function h(d){return d.BYTES_PER_ELEMENT&&u.call(d.buffer)==="[object ArrayBuffer]"||Array.isArray(d)}},"./node_modules/as-number/index.js":c=>{c.exports=function(h,d){return typeof h=="number"?h:typeof d=="number"?d:0}},"./node_modules/base64-js/index.js":(c,u)=>{u.byteLength=b,u.toByteArray=E,u.fromByteArray=C;for(var h=[],d=[],f=typeof Uint8Array<"u"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A=0,g=p.length;A<g;++A)h[A]=p[A],d[p.charCodeAt(A)]=A;d[45]=62,d[95]=63;function v(T){var L=T.length;if(L%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var B=T.indexOf("=");B===-1&&(B=L);var F=B===L?0:4-B%4;return[B,F]}function b(T){var L=v(T),B=L[0],F=L[1];return(B+F)*3/4-F}function x(T,L,B){return(L+B)*3/4-B}function E(T){var L,B=v(T),F=B[0],D=B[1],P=new f(x(T,F,D)),U=0,K=D>0?F-4:F,J;for(J=0;J<K;J+=4)L=d[T.charCodeAt(J)]<<18|d[T.charCodeAt(J+1)]<<12|d[T.charCodeAt(J+2)]<<6|d[T.charCodeAt(J+3)],P[U++]=L>>16&255,P[U++]=L>>8&255,P[U++]=L&255;return D===2&&(L=d[T.charCodeAt(J)]<<2|d[T.charCodeAt(J+1)]>>4,P[U++]=L&255),D===1&&(L=d[T.charCodeAt(J)]<<10|d[T.charCodeAt(J+1)]<<4|d[T.charCodeAt(J+2)]>>2,P[U++]=L>>8&255,P[U++]=L&255),P}function S(T){return h[T>>18&63]+h[T>>12&63]+h[T>>6&63]+h[T&63]}function M(T,L,B){for(var F,D=[],P=L;P<B;P+=3)F=(T[P]<<16&16711680)+(T[P+1]<<8&65280)+(T[P+2]&255),D.push(S(F));return D.join("")}function C(T){for(var L,B=T.length,F=B%3,D=[],P=16383,U=0,K=B-F;U<K;U+=P)D.push(M(T,U,U+P>K?K:U+P));return F===1?(L=T[B-1],D.push(h[L>>2]+h[L<<4&63]+"==")):F===2&&(L=(T[B-2]<<8)+T[B-1],D.push(h[L>>10]+h[L>>4&63]+h[L<<2&63]+"=")),D.join("")}},"./node_modules/buffer-equal/index.js":(c,u,h)=>{var d=h("./node_modules/buffer/index.js").Buffer;c.exports=function(f,p){if(d.isBuffer(f)&&d.isBuffer(p)){if(typeof f.equals=="function")return f.equals(p);if(f.length!==p.length)return!1;for(var A=0;A<f.length;A++)if(f[A]!==p[A])return!1;return!0}}},"./node_modules/buffer/index.js":(c,u,h)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const d=h("./node_modules/base64-js/index.js"),f=h("./node_modules/ieee754/index.js"),p=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;u.Buffer=b,u.SlowBuffer=P,u.INSPECT_MAX_BYTES=50;const A=2147483647;u.kMaxLength=A,b.TYPED_ARRAY_SUPPORT=g(),!b.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function g(){try{const ne=new Uint8Array(1),W={foo:function(){return 42}};return Object.setPrototypeOf(W,Uint8Array.prototype),Object.setPrototypeOf(ne,W),ne.foo()===42}catch{return!1}}Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.byteOffset}});function v(ne){if(ne>A)throw new RangeError('The value "'+ne+'" is invalid for option "size"');const W=new Uint8Array(ne);return Object.setPrototypeOf(W,b.prototype),W}function b(ne,W,k){if(typeof ne=="number"){if(typeof W=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return M(ne)}return x(ne,W,k)}b.poolSize=8192;function x(ne,W,k){if(typeof ne=="string")return C(ne,W);if(ArrayBuffer.isView(ne))return L(ne);if(ne==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ne);if(ye(ne,ArrayBuffer)||ne&&ye(ne.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ye(ne,SharedArrayBuffer)||ne&&ye(ne.buffer,SharedArrayBuffer)))return B(ne,W,k);if(typeof ne=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const he=ne.valueOf&&ne.valueOf();if(he!=null&&he!==ne)return b.from(he,W,k);const Re=F(ne);if(Re)return Re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ne[Symbol.toPrimitive]=="function")return b.from(ne[Symbol.toPrimitive]("string"),W,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ne)}b.from=function(ne,W,k){return x(ne,W,k)},Object.setPrototypeOf(b.prototype,Uint8Array.prototype),Object.setPrototypeOf(b,Uint8Array);function E(ne){if(typeof ne!="number")throw new TypeError('"size" argument must be of type number');if(ne<0)throw new RangeError('The value "'+ne+'" is invalid for option "size"')}function S(ne,W,k){return E(ne),ne<=0?v(ne):W!==void 0?typeof k=="string"?v(ne).fill(W,k):v(ne).fill(W):v(ne)}b.alloc=function(ne,W,k){return S(ne,W,k)};function M(ne){return E(ne),v(ne<0?0:D(ne)|0)}b.allocUnsafe=function(ne){return M(ne)},b.allocUnsafeSlow=function(ne){return M(ne)};function C(ne,W){if((typeof W!="string"||W==="")&&(W="utf8"),!b.isEncoding(W))throw new TypeError("Unknown encoding: "+W);const k=U(ne,W)|0;let he=v(k);const Re=he.write(ne,W);return Re!==k&&(he=he.slice(0,Re)),he}function T(ne){const W=ne.length<0?0:D(ne.length)|0,k=v(W);for(let he=0;he<W;he+=1)k[he]=ne[he]&255;return k}function L(ne){if(ye(ne,Uint8Array)){const W=new Uint8Array(ne);return B(W.buffer,W.byteOffset,W.byteLength)}return T(ne)}function B(ne,W,k){if(W<0||ne.byteLength<W)throw new RangeError('"offset" is outside of buffer bounds');if(ne.byteLength<W+(k||0))throw new RangeError('"length" is outside of buffer bounds');let he;return W===void 0&&k===void 0?he=new Uint8Array(ne):k===void 0?he=new Uint8Array(ne,W):he=new Uint8Array(ne,W,k),Object.setPrototypeOf(he,b.prototype),he}function F(ne){if(b.isBuffer(ne)){const W=D(ne.length)|0,k=v(W);return k.length===0||ne.copy(k,0,0,W),k}if(ne.length!==void 0)return typeof ne.length!="number"||De(ne.length)?v(0):T(ne);if(ne.type==="Buffer"&&Array.isArray(ne.data))return T(ne.data)}function D(ne){if(ne>=A)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A.toString(16)+" bytes");return ne|0}function P(ne){return+ne!=ne&&(ne=0),b.alloc(+ne)}b.isBuffer=function(W){return W!=null&&W._isBuffer===!0&&W!==b.prototype},b.compare=function(W,k){if(ye(W,Uint8Array)&&(W=b.from(W,W.offset,W.byteLength)),ye(k,Uint8Array)&&(k=b.from(k,k.offset,k.byteLength)),!b.isBuffer(W)||!b.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(W===k)return 0;let he=W.length,Re=k.length;for(let We=0,ve=Math.min(he,Re);We<ve;++We)if(W[We]!==k[We]){he=W[We],Re=k[We];break}return he<Re?-1:Re<he?1:0},b.isEncoding=function(W){switch(String(W).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(W,k){if(!Array.isArray(W))throw new TypeError('"list" argument must be an Array of Buffers');if(W.length===0)return b.alloc(0);let he;if(k===void 0)for(k=0,he=0;he<W.length;++he)k+=W[he].length;const Re=b.allocUnsafe(k);let We=0;for(he=0;he<W.length;++he){let ve=W[he];if(ye(ve,Uint8Array))We+ve.length>Re.length?(b.isBuffer(ve)||(ve=b.from(ve)),ve.copy(Re,We)):Uint8Array.prototype.set.call(Re,ve,We);else if(b.isBuffer(ve))ve.copy(Re,We);else throw new TypeError('"list" argument must be an Array of Buffers');We+=ve.length}return Re};function U(ne,W){if(b.isBuffer(ne))return ne.length;if(ArrayBuffer.isView(ne)||ye(ne,ArrayBuffer))return ne.byteLength;if(typeof ne!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ne);const k=ne.length,he=arguments.length>2&&arguments[2]===!0;if(!he&&k===0)return 0;let Re=!1;for(;;)switch(W){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return fn(ne).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k*2;case"hex":return k>>>1;case"base64":return _e(ne).length;default:if(Re)return he?-1:fn(ne).length;W=(""+W).toLowerCase(),Re=!0}}b.byteLength=U;function K(ne,W,k){let he=!1;if((W===void 0||W<0)&&(W=0),W>this.length||((k===void 0||k>this.length)&&(k=this.length),k<=0)||(k>>>=0,W>>>=0,k<=W))return"";for(ne||(ne="utf8");;)switch(ne){case"hex":return Oe(this,W,k);case"utf8":case"utf-8":return xe(this,W,k);case"ascii":return Ce(this,W,k);case"latin1":case"binary":return Je(this,W,k);case"base64":return oe(this,W,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,W,k);default:if(he)throw new TypeError("Unknown encoding: "+ne);ne=(ne+"").toLowerCase(),he=!0}}b.prototype._isBuffer=!0;function J(ne,W,k){const he=ne[W];ne[W]=ne[k],ne[k]=he}b.prototype.swap16=function(){const W=this.length;if(W%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let k=0;k<W;k+=2)J(this,k,k+1);return this},b.prototype.swap32=function(){const W=this.length;if(W%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let k=0;k<W;k+=4)J(this,k,k+3),J(this,k+1,k+2);return this},b.prototype.swap64=function(){const W=this.length;if(W%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let k=0;k<W;k+=8)J(this,k,k+7),J(this,k+1,k+6),J(this,k+2,k+5),J(this,k+3,k+4);return this},b.prototype.toString=function(){const W=this.length;return W===0?"":arguments.length===0?xe(this,0,W):K.apply(this,arguments)},b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=function(W){if(!b.isBuffer(W))throw new TypeError("Argument must be a Buffer");return this===W?!0:b.compare(this,W)===0},b.prototype.inspect=function(){let W="";const k=u.INSPECT_MAX_BYTES;return W=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(W+=" ... "),"<Buffer "+W+">"},p&&(b.prototype[p]=b.prototype.inspect),b.prototype.compare=function(W,k,he,Re,We){if(ye(W,Uint8Array)&&(W=b.from(W,W.offset,W.byteLength)),!b.isBuffer(W))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof W);if(k===void 0&&(k=0),he===void 0&&(he=W?W.length:0),Re===void 0&&(Re=0),We===void 0&&(We=this.length),k<0||he>W.length||Re<0||We>this.length)throw new RangeError("out of range index");if(Re>=We&&k>=he)return 0;if(Re>=We)return-1;if(k>=he)return 1;if(k>>>=0,he>>>=0,Re>>>=0,We>>>=0,this===W)return 0;let ve=We-Re,at=he-k;const At=Math.min(ve,at),Ct=this.slice(Re,We),Pt=W.slice(k,he);for(let $t=0;$t<At;++$t)if(Ct[$t]!==Pt[$t]){ve=Ct[$t],at=Pt[$t];break}return ve<at?-1:at<ve?1:0};function z(ne,W,k,he,Re){if(ne.length===0)return-1;if(typeof k=="string"?(he=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),k=+k,De(k)&&(k=Re?0:ne.length-1),k<0&&(k=ne.length+k),k>=ne.length){if(Re)return-1;k=ne.length-1}else if(k<0)if(Re)k=0;else return-1;if(typeof W=="string"&&(W=b.from(W,he)),b.isBuffer(W))return W.length===0?-1:j(ne,W,k,he,Re);if(typeof W=="number")return W=W&255,typeof Uint8Array.prototype.indexOf=="function"?Re?Uint8Array.prototype.indexOf.call(ne,W,k):Uint8Array.prototype.lastIndexOf.call(ne,W,k):j(ne,[W],k,he,Re);throw new TypeError("val must be string, number or Buffer")}function j(ne,W,k,he,Re){let We=1,ve=ne.length,at=W.length;if(he!==void 0&&(he=String(he).toLowerCase(),he==="ucs2"||he==="ucs-2"||he==="utf16le"||he==="utf-16le")){if(ne.length<2||W.length<2)return-1;We=2,ve/=2,at/=2,k/=2}function At(Pt,$t){return We===1?Pt[$t]:Pt.readUInt16BE($t*We)}let Ct;if(Re){let Pt=-1;for(Ct=k;Ct<ve;Ct++)if(At(ne,Ct)===At(W,Pt===-1?0:Ct-Pt)){if(Pt===-1&&(Pt=Ct),Ct-Pt+1===at)return Pt*We}else Pt!==-1&&(Ct-=Ct-Pt),Pt=-1}else for(k+at>ve&&(k=ve-at),Ct=k;Ct>=0;Ct--){let Pt=!0;for(let $t=0;$t<at;$t++)if(At(ne,Ct+$t)!==At(W,$t)){Pt=!1;break}if(Pt)return Ct}return-1}b.prototype.includes=function(W,k,he){return this.indexOf(W,k,he)!==-1},b.prototype.indexOf=function(W,k,he){return z(this,W,k,he,!0)},b.prototype.lastIndexOf=function(W,k,he){return z(this,W,k,he,!1)};function G(ne,W,k,he){k=Number(k)||0;const Re=ne.length-k;he?(he=Number(he),he>Re&&(he=Re)):he=Re;const We=W.length;he>We/2&&(he=We/2);let ve;for(ve=0;ve<he;++ve){const at=parseInt(W.substr(ve*2,2),16);if(De(at))return ve;ne[k+ve]=at}return ve}function H(ne,W,k,he){return Ne(fn(W,ne.length-k),ne,k,he)}function te(ne,W,k,he){return Ne(mt(W),ne,k,he)}function Z(ne,W,k,he){return Ne(_e(W),ne,k,he)}function ee(ne,W,k,he){return Ne(Ee(W,ne.length-k),ne,k,he)}b.prototype.write=function(W,k,he,Re){if(k===void 0)Re="utf8",he=this.length,k=0;else if(he===void 0&&typeof k=="string")Re=k,he=this.length,k=0;else if(isFinite(k))k=k>>>0,isFinite(he)?(he=he>>>0,Re===void 0&&(Re="utf8")):(Re=he,he=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const We=this.length-k;if((he===void 0||he>We)&&(he=We),W.length>0&&(he<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");Re||(Re="utf8");let ve=!1;for(;;)switch(Re){case"hex":return G(this,W,k,he);case"utf8":case"utf-8":return H(this,W,k,he);case"ascii":case"latin1":case"binary":return te(this,W,k,he);case"base64":return Z(this,W,k,he);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,W,k,he);default:if(ve)throw new TypeError("Unknown encoding: "+Re);Re=(""+Re).toLowerCase(),ve=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function oe(ne,W,k){return W===0&&k===ne.length?d.fromByteArray(ne):d.fromByteArray(ne.slice(W,k))}function xe(ne,W,k){k=Math.min(ne.length,k);const he=[];let Re=W;for(;Re<k;){const We=ne[Re];let ve=null,at=We>239?4:We>223?3:We>191?2:1;if(Re+at<=k){let At,Ct,Pt,$t;switch(at){case 1:We<128&&(ve=We);break;case 2:At=ne[Re+1],(At&192)===128&&($t=(We&31)<<6|At&63,$t>127&&(ve=$t));break;case 3:At=ne[Re+1],Ct=ne[Re+2],(At&192)===128&&(Ct&192)===128&&($t=(We&15)<<12|(At&63)<<6|Ct&63,$t>2047&&($t<55296||$t>57343)&&(ve=$t));break;case 4:At=ne[Re+1],Ct=ne[Re+2],Pt=ne[Re+3],(At&192)===128&&(Ct&192)===128&&(Pt&192)===128&&($t=(We&15)<<18|(At&63)<<12|(Ct&63)<<6|Pt&63,$t>65535&&$t<1114112&&(ve=$t))}}ve===null?(ve=65533,at=1):ve>65535&&(ve-=65536,he.push(ve>>>10&1023|55296),ve=56320|ve&1023),he.push(ve),Re+=at}return me(he)}const Pe=4096;function me(ne){const W=ne.length;if(W<=Pe)return String.fromCharCode.apply(String,ne);let k="",he=0;for(;he<W;)k+=String.fromCharCode.apply(String,ne.slice(he,he+=Pe));return k}function Ce(ne,W,k){let he="";k=Math.min(ne.length,k);for(let Re=W;Re<k;++Re)he+=String.fromCharCode(ne[Re]&127);return he}function Je(ne,W,k){let he="";k=Math.min(ne.length,k);for(let Re=W;Re<k;++Re)he+=String.fromCharCode(ne[Re]);return he}function Oe(ne,W,k){const he=ne.length;(!W||W<0)&&(W=0),(!k||k<0||k>he)&&(k=he);let Re="";for(let We=W;We<k;++We)Re+=ke[ne[We]];return Re}function $e(ne,W,k){const he=ne.slice(W,k);let Re="";for(let We=0;We<he.length-1;We+=2)Re+=String.fromCharCode(he[We]+he[We+1]*256);return Re}b.prototype.slice=function(W,k){const he=this.length;W=~~W,k=k===void 0?he:~~k,W<0?(W+=he,W<0&&(W=0)):W>he&&(W=he),k<0?(k+=he,k<0&&(k=0)):k>he&&(k=he),k<W&&(k=W);const Re=this.subarray(W,k);return Object.setPrototypeOf(Re,b.prototype),Re};function nt(ne,W,k){if(ne%1!==0||ne<0)throw new RangeError("offset is not uint");if(ne+W>k)throw new RangeError("Trying to access beyond buffer length")}b.prototype.readUintLE=b.prototype.readUIntLE=function(W,k,he){W=W>>>0,k=k>>>0,he||nt(W,k,this.length);let Re=this[W],We=1,ve=0;for(;++ve<k&&(We*=256);)Re+=this[W+ve]*We;return Re},b.prototype.readUintBE=b.prototype.readUIntBE=function(W,k,he){W=W>>>0,k=k>>>0,he||nt(W,k,this.length);let Re=this[W+--k],We=1;for(;k>0&&(We*=256);)Re+=this[W+--k]*We;return Re},b.prototype.readUint8=b.prototype.readUInt8=function(W,k){return W=W>>>0,k||nt(W,1,this.length),this[W]},b.prototype.readUint16LE=b.prototype.readUInt16LE=function(W,k){return W=W>>>0,k||nt(W,2,this.length),this[W]|this[W+1]<<8},b.prototype.readUint16BE=b.prototype.readUInt16BE=function(W,k){return W=W>>>0,k||nt(W,2,this.length),this[W]<<8|this[W+1]},b.prototype.readUint32LE=b.prototype.readUInt32LE=function(W,k){return W=W>>>0,k||nt(W,4,this.length),(this[W]|this[W+1]<<8|this[W+2]<<16)+this[W+3]*16777216},b.prototype.readUint32BE=b.prototype.readUInt32BE=function(W,k){return W=W>>>0,k||nt(W,4,this.length),this[W]*16777216+(this[W+1]<<16|this[W+2]<<8|this[W+3])},b.prototype.readBigUInt64LE=Ye(function(W){W=W>>>0,pt(W,"offset");const k=this[W],he=this[W+7];(k===void 0||he===void 0)&&Nt(W,this.length-8);const Re=k+this[++W]*2**8+this[++W]*2**16+this[++W]*2**24,We=this[++W]+this[++W]*2**8+this[++W]*2**16+he*2**24;return BigInt(Re)+(BigInt(We)<<BigInt(32))}),b.prototype.readBigUInt64BE=Ye(function(W){W=W>>>0,pt(W,"offset");const k=this[W],he=this[W+7];(k===void 0||he===void 0)&&Nt(W,this.length-8);const Re=k*2**24+this[++W]*2**16+this[++W]*2**8+this[++W],We=this[++W]*2**24+this[++W]*2**16+this[++W]*2**8+he;return(BigInt(Re)<<BigInt(32))+BigInt(We)}),b.prototype.readIntLE=function(W,k,he){W=W>>>0,k=k>>>0,he||nt(W,k,this.length);let Re=this[W],We=1,ve=0;for(;++ve<k&&(We*=256);)Re+=this[W+ve]*We;return We*=128,Re>=We&&(Re-=Math.pow(2,8*k)),Re},b.prototype.readIntBE=function(W,k,he){W=W>>>0,k=k>>>0,he||nt(W,k,this.length);let Re=k,We=1,ve=this[W+--Re];for(;Re>0&&(We*=256);)ve+=this[W+--Re]*We;return We*=128,ve>=We&&(ve-=Math.pow(2,8*k)),ve},b.prototype.readInt8=function(W,k){return W=W>>>0,k||nt(W,1,this.length),this[W]&128?(255-this[W]+1)*-1:this[W]},b.prototype.readInt16LE=function(W,k){W=W>>>0,k||nt(W,2,this.length);const he=this[W]|this[W+1]<<8;return he&32768?he|4294901760:he},b.prototype.readInt16BE=function(W,k){W=W>>>0,k||nt(W,2,this.length);const he=this[W+1]|this[W]<<8;return he&32768?he|4294901760:he},b.prototype.readInt32LE=function(W,k){return W=W>>>0,k||nt(W,4,this.length),this[W]|this[W+1]<<8|this[W+2]<<16|this[W+3]<<24},b.prototype.readInt32BE=function(W,k){return W=W>>>0,k||nt(W,4,this.length),this[W]<<24|this[W+1]<<16|this[W+2]<<8|this[W+3]},b.prototype.readBigInt64LE=Ye(function(W){W=W>>>0,pt(W,"offset");const k=this[W],he=this[W+7];(k===void 0||he===void 0)&&Nt(W,this.length-8);const Re=this[W+4]+this[W+5]*2**8+this[W+6]*2**16+(he<<24);return(BigInt(Re)<<BigInt(32))+BigInt(k+this[++W]*256+this[++W]*65536+this[++W]*16777216)}),b.prototype.readBigInt64BE=Ye(function(W){W=W>>>0,pt(W,"offset");const k=this[W],he=this[W+7];(k===void 0||he===void 0)&&Nt(W,this.length-8);const Re=(k<<24)+this[++W]*2**16+this[++W]*2**8+this[++W];return(BigInt(Re)<<BigInt(32))+BigInt(this[++W]*16777216+this[++W]*65536+this[++W]*256+he)}),b.prototype.readFloatLE=function(W,k){return W=W>>>0,k||nt(W,4,this.length),f.read(this,W,!0,23,4)},b.prototype.readFloatBE=function(W,k){return W=W>>>0,k||nt(W,4,this.length),f.read(this,W,!1,23,4)},b.prototype.readDoubleLE=function(W,k){return W=W>>>0,k||nt(W,8,this.length),f.read(this,W,!0,52,8)},b.prototype.readDoubleBE=function(W,k){return W=W>>>0,k||nt(W,8,this.length),f.read(this,W,!1,52,8)};function gt(ne,W,k,he,Re,We){if(!b.isBuffer(ne))throw new TypeError('"buffer" argument must be a Buffer instance');if(W>Re||W<We)throw new RangeError('"value" argument is out of bounds');if(k+he>ne.length)throw new RangeError("Index out of range")}b.prototype.writeUintLE=b.prototype.writeUIntLE=function(W,k,he,Re){if(W=+W,k=k>>>0,he=he>>>0,!Re){const at=Math.pow(2,8*he)-1;gt(this,W,k,he,at,0)}let We=1,ve=0;for(this[k]=W&255;++ve<he&&(We*=256);)this[k+ve]=W/We&255;return k+he},b.prototype.writeUintBE=b.prototype.writeUIntBE=function(W,k,he,Re){if(W=+W,k=k>>>0,he=he>>>0,!Re){const at=Math.pow(2,8*he)-1;gt(this,W,k,he,at,0)}let We=he-1,ve=1;for(this[k+We]=W&255;--We>=0&&(ve*=256);)this[k+We]=W/ve&255;return k+he},b.prototype.writeUint8=b.prototype.writeUInt8=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,1,255,0),this[k]=W&255,k+1},b.prototype.writeUint16LE=b.prototype.writeUInt16LE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,2,65535,0),this[k]=W&255,this[k+1]=W>>>8,k+2},b.prototype.writeUint16BE=b.prototype.writeUInt16BE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,2,65535,0),this[k]=W>>>8,this[k+1]=W&255,k+2},b.prototype.writeUint32LE=b.prototype.writeUInt32LE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,4,4294967295,0),this[k+3]=W>>>24,this[k+2]=W>>>16,this[k+1]=W>>>8,this[k]=W&255,k+4},b.prototype.writeUint32BE=b.prototype.writeUInt32BE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,4,4294967295,0),this[k]=W>>>24,this[k+1]=W>>>16,this[k+2]=W>>>8,this[k+3]=W&255,k+4};function Tt(ne,W,k,he,Re){Te(W,he,Re,ne,k,7);let We=Number(W&BigInt(4294967295));ne[k++]=We,We=We>>8,ne[k++]=We,We=We>>8,ne[k++]=We,We=We>>8,ne[k++]=We;let ve=Number(W>>BigInt(32)&BigInt(4294967295));return ne[k++]=ve,ve=ve>>8,ne[k++]=ve,ve=ve>>8,ne[k++]=ve,ve=ve>>8,ne[k++]=ve,k}function Ze(ne,W,k,he,Re){Te(W,he,Re,ne,k,7);let We=Number(W&BigInt(4294967295));ne[k+7]=We,We=We>>8,ne[k+6]=We,We=We>>8,ne[k+5]=We,We=We>>8,ne[k+4]=We;let ve=Number(W>>BigInt(32)&BigInt(4294967295));return ne[k+3]=ve,ve=ve>>8,ne[k+2]=ve,ve=ve>>8,ne[k+1]=ve,ve=ve>>8,ne[k]=ve,k+8}b.prototype.writeBigUInt64LE=Ye(function(W,k=0){return Tt(this,W,k,BigInt(0),BigInt("0xffffffffffffffff"))}),b.prototype.writeBigUInt64BE=Ye(function(W,k=0){return Ze(this,W,k,BigInt(0),BigInt("0xffffffffffffffff"))}),b.prototype.writeIntLE=function(W,k,he,Re){if(W=+W,k=k>>>0,!Re){const At=Math.pow(2,8*he-1);gt(this,W,k,he,At-1,-At)}let We=0,ve=1,at=0;for(this[k]=W&255;++We<he&&(ve*=256);)W<0&&at===0&&this[k+We-1]!==0&&(at=1),this[k+We]=(W/ve>>0)-at&255;return k+he},b.prototype.writeIntBE=function(W,k,he,Re){if(W=+W,k=k>>>0,!Re){const At=Math.pow(2,8*he-1);gt(this,W,k,he,At-1,-At)}let We=he-1,ve=1,at=0;for(this[k+We]=W&255;--We>=0&&(ve*=256);)W<0&&at===0&&this[k+We+1]!==0&&(at=1),this[k+We]=(W/ve>>0)-at&255;return k+he},b.prototype.writeInt8=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,1,127,-128),W<0&&(W=255+W+1),this[k]=W&255,k+1},b.prototype.writeInt16LE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,2,32767,-32768),this[k]=W&255,this[k+1]=W>>>8,k+2},b.prototype.writeInt16BE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,2,32767,-32768),this[k]=W>>>8,this[k+1]=W&255,k+2},b.prototype.writeInt32LE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,4,2147483647,-2147483648),this[k]=W&255,this[k+1]=W>>>8,this[k+2]=W>>>16,this[k+3]=W>>>24,k+4},b.prototype.writeInt32BE=function(W,k,he){return W=+W,k=k>>>0,he||gt(this,W,k,4,2147483647,-2147483648),W<0&&(W=4294967295+W+1),this[k]=W>>>24,this[k+1]=W>>>16,this[k+2]=W>>>8,this[k+3]=W&255,k+4},b.prototype.writeBigInt64LE=Ye(function(W,k=0){return Tt(this,W,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),b.prototype.writeBigInt64BE=Ye(function(W,k=0){return Ze(this,W,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function mn(ne,W,k,he,Re,We){if(k+he>ne.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function Ft(ne,W,k,he,Re){return W=+W,k=k>>>0,Re||mn(ne,W,k,4),f.write(ne,W,k,he,23,4),k+4}b.prototype.writeFloatLE=function(W,k,he){return Ft(this,W,k,!0,he)},b.prototype.writeFloatBE=function(W,k,he){return Ft(this,W,k,!1,he)};function Qt(ne,W,k,he,Re){return W=+W,k=k>>>0,Re||mn(ne,W,k,8),f.write(ne,W,k,he,52,8),k+8}b.prototype.writeDoubleLE=function(W,k,he){return Qt(this,W,k,!0,he)},b.prototype.writeDoubleBE=function(W,k,he){return Qt(this,W,k,!1,he)},b.prototype.copy=function(W,k,he,Re){if(!b.isBuffer(W))throw new TypeError("argument should be a Buffer");if(he||(he=0),!Re&&Re!==0&&(Re=this.length),k>=W.length&&(k=W.length),k||(k=0),Re>0&&Re<he&&(Re=he),Re===he||W.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(he<0||he>=this.length)throw new RangeError("Index out of range");if(Re<0)throw new RangeError("sourceEnd out of bounds");Re>this.length&&(Re=this.length),W.length-k<Re-he&&(Re=W.length-k+he);const We=Re-he;return this===W&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(k,he,Re):Uint8Array.prototype.set.call(W,this.subarray(he,Re),k),We},b.prototype.fill=function(W,k,he,Re){if(typeof W=="string"){if(typeof k=="string"?(Re=k,k=0,he=this.length):typeof he=="string"&&(Re=he,he=this.length),Re!==void 0&&typeof Re!="string")throw new TypeError("encoding must be a string");if(typeof Re=="string"&&!b.isEncoding(Re))throw new TypeError("Unknown encoding: "+Re);if(W.length===1){const ve=W.charCodeAt(0);(Re==="utf8"&&ve<128||Re==="latin1")&&(W=ve)}}else typeof W=="number"?W=W&255:typeof W=="boolean"&&(W=Number(W));if(k<0||this.length<k||this.length<he)throw new RangeError("Out of range index");if(he<=k)return this;k=k>>>0,he=he===void 0?this.length:he>>>0,W||(W=0);let We;if(typeof W=="number")for(We=k;We<he;++We)this[We]=W;else{const ve=b.isBuffer(W)?W:b.from(W,Re),at=ve.length;if(at===0)throw new TypeError('The value "'+W+'" is invalid for argument "value"');for(We=0;We<he-k;++We)this[We+k]=ve[We%at]}return this};const Xt={};function Tn(ne,W,k){Xt[ne]=class extends k{constructor(){super(),Object.defineProperty(this,"message",{value:W.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ne}]`,this.stack,delete this.name}get code(){return ne}set code(Re){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Re,writable:!0})}toString(){return`${this.name} [${ne}]: ${this.message}`}}}Tn("ERR_BUFFER_OUT_OF_BOUNDS",function(ne){return ne?`${ne} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Tn("ERR_INVALID_ARG_TYPE",function(ne,W){return`The "${ne}" argument must be of type number. Received type ${typeof W}`},TypeError),Tn("ERR_OUT_OF_RANGE",function(ne,W,k){let he=`The value of "${ne}" is out of range.`,Re=k;return Number.isInteger(k)&&Math.abs(k)>4294967296?Re=vn(String(k)):typeof k=="bigint"&&(Re=String(k),(k>BigInt(2)**BigInt(32)||k<-(BigInt(2)**BigInt(32)))&&(Re=vn(Re)),Re+="n"),he+=` It must be ${W}. Received ${Re}`,he},RangeError);function vn(ne){let W="",k=ne.length;const he=ne[0]==="-"?1:0;for(;k>=he+4;k-=3)W=`_${ne.slice(k-3,k)}${W}`;return`${ne.slice(0,k)}${W}`}function Fe(ne,W,k){pt(W,"offset"),(ne[W]===void 0||ne[W+k]===void 0)&&Nt(W,ne.length-(k+1))}function Te(ne,W,k,he,Re,We){if(ne>k||ne<W){const ve=typeof W=="bigint"?"n":"";let at;throw We>3?W===0||W===BigInt(0)?at=`>= 0${ve} and < 2${ve} ** ${(We+1)*8}${ve}`:at=`>= -(2${ve} ** ${(We+1)*8-1}${ve}) and < 2 ** ${(We+1)*8-1}${ve}`:at=`>= ${W}${ve} and <= ${k}${ve}`,new Xt.ERR_OUT_OF_RANGE("value",at,ne)}Fe(he,Re,We)}function pt(ne,W){if(typeof ne!="number")throw new Xt.ERR_INVALID_ARG_TYPE(W,"number",ne)}function Nt(ne,W,k){throw Math.floor(ne)!==ne?(pt(ne,k),new Xt.ERR_OUT_OF_RANGE(k||"offset","an integer",ne)):W<0?new Xt.ERR_BUFFER_OUT_OF_BOUNDS:new Xt.ERR_OUT_OF_RANGE(k||"offset",`>= ${k?1:0} and <= ${W}`,ne)}const zt=/[^+/0-9A-Za-z-_]/g;function Vt(ne){if(ne=ne.split("=")[0],ne=ne.trim().replace(zt,""),ne.length<2)return"";for(;ne.length%4!==0;)ne=ne+"=";return ne}function fn(ne,W){W=W||1/0;let k;const he=ne.length;let Re=null;const We=[];for(let ve=0;ve<he;++ve){if(k=ne.charCodeAt(ve),k>55295&&k<57344){if(!Re){if(k>56319){(W-=3)>-1&&We.push(239,191,189);continue}else if(ve+1===he){(W-=3)>-1&&We.push(239,191,189);continue}Re=k;continue}if(k<56320){(W-=3)>-1&&We.push(239,191,189),Re=k;continue}k=(Re-55296<<10|k-56320)+65536}else Re&&(W-=3)>-1&&We.push(239,191,189);if(Re=null,k<128){if((W-=1)<0)break;We.push(k)}else if(k<2048){if((W-=2)<0)break;We.push(k>>6|192,k&63|128)}else if(k<65536){if((W-=3)<0)break;We.push(k>>12|224,k>>6&63|128,k&63|128)}else if(k<1114112){if((W-=4)<0)break;We.push(k>>18|240,k>>12&63|128,k>>6&63|128,k&63|128)}else throw new Error("Invalid code point")}return We}function mt(ne){const W=[];for(let k=0;k<ne.length;++k)W.push(ne.charCodeAt(k)&255);return W}function Ee(ne,W){let k,he,Re;const We=[];for(let ve=0;ve<ne.length&&!((W-=2)<0);++ve)k=ne.charCodeAt(ve),he=k>>8,Re=k%256,We.push(Re),We.push(he);return We}function _e(ne){return d.toByteArray(Vt(ne))}function Ne(ne,W,k,he){let Re;for(Re=0;Re<he&&!(Re+k>=W.length||Re>=ne.length);++Re)W[Re+k]=ne[Re];return Re}function ye(ne,W){return ne instanceof W||ne!=null&&ne.constructor!=null&&ne.constructor.name!=null&&ne.constructor.name===W.name}function De(ne){return ne!==ne}const ke=function(){const ne="0123456789abcdef",W=new Array(256);for(let k=0;k<16;++k){const he=k*16;for(let Re=0;Re<16;++Re)W[he+Re]=ne[k]+ne[Re]}return W}();function Ye(ne){return typeof BigInt>"u"?Qe:ne}function Qe(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":c=>{c.exports=function(u){var h=[];return h.toString=function(){return this.map(function(f){var p="",A=typeof f[5]<"u";return f[4]&&(p+="@supports (".concat(f[4],") {")),f[2]&&(p+="@media ".concat(f[2]," {")),A&&(p+="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {")),p+=u(f),A&&(p+="}"),f[2]&&(p+="}"),f[4]&&(p+="}"),p}).join("")},h.i=function(f,p,A,g,v){typeof f=="string"&&(f=[[null,f,void 0]]);var b={};if(A)for(var x=0;x<this.length;x++){var E=this[x][0];E!=null&&(b[E]=!0)}for(var S=0;S<f.length;S++){var M=[].concat(f[S]);A&&b[M[0]]||(typeof v<"u"&&(typeof M[5]>"u"||(M[1]="@layer".concat(M[5].length>0?" ".concat(M[5]):""," {").concat(M[1],"}")),M[5]=v),p&&(M[2]&&(M[1]="@media ".concat(M[2]," {").concat(M[1],"}")),M[2]=p),g&&(M[4]?(M[1]="@supports (".concat(M[4],") {").concat(M[1],"}"),M[4]=g):M[4]="".concat(g)),h.push(M))}},h}},"./node_modules/css-loader/dist/runtime/getUrl.js":c=>{c.exports=function(u,h){return h||(h={}),u&&(u=String(u.__esModule?u.default:u),/^['"].*['"]$/.test(u)&&(u=u.slice(1,-1)),h.hash&&(u+=h.hash),/["'() \t\n]|(%20)/.test(u)||h.needQuotes?'"'.concat(u.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):u)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":c=>{c.exports=function(u){var h=u[1],d=u[3];if(!d)return h;if(typeof btoa=="function"){var f=btoa(unescape(encodeURIComponent(JSON.stringify(d)))),p="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(f),A="/*# ".concat(p," */");return[h].concat([A]).join(`
`)}return[h].join(`
`)}},"./node_modules/custom-event-polyfill/polyfill.js":()=>{(function(){if(!(typeof window>"u"))try{var c=new window.CustomEvent("test",{cancelable:!0});if(c.preventDefault(),c.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var u=function(d,f){var p,A;return f=f||{},f.bubbles=!!f.bubbles,f.cancelable=!!f.cancelable,p=document.createEvent("CustomEvent"),p.initCustomEvent(d,f.bubbles,f.cancelable,f.detail),A=p.preventDefault,p.preventDefault=function(){A.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},p};u.prototype=window.Event.prototype,window.CustomEvent=u}})()},"./node_modules/debug/browser.js":(c,u,h)=>{u=c.exports=h("./node_modules/debug/debug.js"),u.log=p,u.formatArgs=f,u.save=A,u.load=g,u.useColors=d,u.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:v(),u.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}u.formatters.j=function(b){return JSON.stringify(b)};function f(){var b=arguments,x=this.useColors;if(b[0]=(x?"%c":"")+this.namespace+(x?" %c":" ")+b[0]+(x?"%c ":" "),!x)return b;var E="color: "+this.color;b=[b[0],E,"color: inherit"].concat(Array.prototype.slice.call(b,1));var S=0,M=0;return b[0].replace(/%[a-z%]/g,function(C){C!=="%%"&&(S++,C==="%c"&&(M=S))}),b.splice(M,0,E),b}function p(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function A(b){try{b==null?u.storage.removeItem("debug"):u.storage.debug=b}catch{}}function g(){var b;try{b=u.storage.debug}catch{}return b}u.enable(g());function v(){try{return window.localStorage}catch{}}},"./node_modules/debug/debug.js":(c,u)=>{u=c.exports=f,u.coerce=v,u.disable=A,u.enable=p,u.enabled=g,u.names=[],u.skips=[],u.formatters={};var h=0;function d(){return u.colors[h++%u.colors.length]}function f(b){function x(){}x.enabled=!1;function E(){var M=E;M.useColors==null&&(M.useColors=u.useColors()),M.color==null&&M.useColors&&(M.color=d());var C=Array.prototype.slice.call(arguments);C[0]=u.coerce(C[0]),typeof C[0]!="string"&&(C=["%o"].concat(C));var T=0;C[0]=C[0].replace(/%([a-z%])/g,function(B,F){if(B==="%%")return B;T++;var D=u.formatters[F];if(typeof D=="function"){var P=C[T];B=D.call(M,P),C.splice(T,1),T--}return B}),typeof u.formatArgs=="function"&&(C=u.formatArgs.apply(M,C));var L=E.log||u.log||console.log.bind(console);L.apply(M,C)}E.enabled=!0;var S=u.enabled(b)?E:x;return S.namespace=b,S}function p(b){u.save(b);for(var x=(b||"").split(/[\s,]+/),E=x.length,S=0;S<E;S++)x[S]&&(b=x[S].replace(/\*/g,".*?"),b[0]==="-"?u.skips.push(new RegExp("^"+b.substr(1)+"$")):u.names.push(new RegExp("^"+b+"$")))}function A(){u.enable("")}function g(b){var x,E;for(x=0,E=u.skips.length;x<E;x++)if(u.skips[x].test(b))return!1;for(x=0,E=u.names.length;x<E;x++)if(u.names[x].test(b))return!0;return!1}function v(b){return b instanceof Error?b.stack||b.message:b}},"./node_modules/deep-assign/index.js":(c,u,h)=>{var d=h("./node_modules/is-obj/index.js"),f=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;function A(b){if(b==null)throw new TypeError("Sources cannot be null or undefined");return Object(b)}function g(b,x,E){var S=x[E];if(S!=null){if(f.call(b,E)&&(b[E]===void 0||b[E]===null))throw new TypeError("Cannot convert undefined or null to object ("+E+")");!f.call(b,E)||!d(S)?b[E]=S:b[E]=v(Object(b[E]),x[E])}}function v(b,x){if(b===x)return b;x=Object(x);for(var E in x)f.call(x,E)&&g(b,x,E);if(Object.getOwnPropertySymbols)for(var S=Object.getOwnPropertySymbols(x),M=0;M<S.length;M++)p.call(x,S[M])&&g(b,x,S[M]);return b}c.exports=function(x){x=A(x);for(var E=1;E<arguments.length;E++)v(x,arguments[E]);return x}},"./node_modules/dtype/index.js":c=>{c.exports=function(u){switch(u){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(c,u,h)=>{var d;typeof window<"u"?d=window:typeof h.g<"u"?d=h.g:typeof self<"u"?d=self:d={},c.exports=d},"./node_modules/ieee754/index.js":(c,u)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */u.read=function(h,d,f,p,A){var g,v,b=A*8-p-1,x=(1<<b)-1,E=x>>1,S=-7,M=f?A-1:0,C=f?-1:1,T=h[d+M];for(M+=C,g=T&(1<<-S)-1,T>>=-S,S+=b;S>0;g=g*256+h[d+M],M+=C,S-=8);for(v=g&(1<<-S)-1,g>>=-S,S+=p;S>0;v=v*256+h[d+M],M+=C,S-=8);if(g===0)g=1-E;else{if(g===x)return v?NaN:(T?-1:1)*(1/0);v=v+Math.pow(2,p),g=g-E}return(T?-1:1)*v*Math.pow(2,g-p)},u.write=function(h,d,f,p,A,g){var v,b,x,E=g*8-A-1,S=(1<<E)-1,M=S>>1,C=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=p?0:g-1,L=p?1:-1,B=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(b=isNaN(d)?1:0,v=S):(v=Math.floor(Math.log(d)/Math.LN2),d*(x=Math.pow(2,-v))<1&&(v--,x*=2),v+M>=1?d+=C/x:d+=C*Math.pow(2,1-M),d*x>=2&&(v++,x/=2),v+M>=S?(b=0,v=S):v+M>=1?(b=(d*x-1)*Math.pow(2,A),v=v+M):(b=d*Math.pow(2,M-1)*Math.pow(2,A),v=0));A>=8;h[f+T]=b&255,T+=L,b/=256,A-=8);for(v=v<<A|b,E+=A;E>0;h[f+T]=v&255,T+=L,v/=256,E-=8);h[f+T-L]|=B*128}},"./node_modules/is-buffer/index.js":c=>{/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */c.exports=function(d){return d!=null&&(u(d)||h(d)||!!d._isBuffer)};function u(d){return!!d.constructor&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)}function h(d){return typeof d.readFloatLE=="function"&&typeof d.slice=="function"&&u(d.slice(0,0))}},"./node_modules/is-function/index.js":c=>{c.exports=h;var u=Object.prototype.toString;function h(d){if(!d)return!1;var f=u.call(d);return f==="[object Function]"||typeof d=="function"&&f!=="[object RegExp]"||typeof window<"u"&&(d===window.setTimeout||d===window.alert||d===window.confirm||d===window.prompt)}},"./node_modules/is-obj/index.js":c=>{c.exports=function(u){var h=typeof u;return u!==null&&(h==="object"||h==="function")}},"./node_modules/layout-bmfont-text/index.js":(c,u,h)=>{var d=h("./node_modules/word-wrapper/index.js"),f=h("./node_modules/xtend/immutable.js"),p=h("./node_modules/as-number/index.js"),A=["x","e","a","o","n","s","r","c","u","m","v","w","z"],g=["m","w"],v=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],b=9,x=32,E=0,S=1,M=2;c.exports=function(j){return new C(j)};function C(z){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(z)}C.prototype.update=function(z){if(z=f({measure:this._measure},z),this._opt=z,this._opt.tabSize=p(this._opt.tabSize,4),!z.font)throw new Error("must provide a valid bitmap font");var j=this.glyphs,G=z.text||"",H=z.font;this._setupSpaceGlyphs(H);var te=d.lines(G,z),Z=z.width||0;j.length=0;var ee=te.reduce(function(gt,Tt){return Math.max(gt,Tt.width,Z)},0),oe=0,xe=0,Pe=p(z.lineHeight,H.common.lineHeight),me=H.common.base,Ce=Pe-me,Je=z.letterSpacing||0,Oe=Pe*te.length-Ce,$e=K(this._opt.align);xe-=Oe,this._width=ee,this._height=Oe,this._descender=Pe-me,this._baseline=me,this._xHeight=F(H),this._capHeight=P(H),this._lineHeight=Pe,this._ascender=Pe-Ce-this._xHeight;var nt=this;te.forEach(function(gt,Tt){for(var Ze=gt.start,mn=gt.end,Ft=gt.width,Qt,Xt=Ze;Xt<mn;Xt++){var Tn=G.charCodeAt(Xt),vn=nt.getGlyph(H,Tn);if(vn){Qt&&(oe+=U(H,Qt.id,vn.id));var Fe=oe;$e===S?Fe+=(ee-Ft)/2:$e===M&&(Fe+=ee-Ft),j.push({position:[Fe,xe],data:vn,index:Xt,line:Tt}),oe+=vn.xadvance+Je,Qt=vn}}xe+=Pe,oe=0}),this._linesTotal=te.length},C.prototype._setupSpaceGlyphs=function(z){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!z.chars||z.chars.length===0)){var j=B(z,x)||D(z)||z.chars[0],G=this._opt.tabSize*j.xadvance;this._fallbackSpaceGlyph=j,this._fallbackTabGlyph=f(j,{x:0,y:0,xadvance:G,id:b,xoffset:0,yoffset:0,width:0,height:0})}},C.prototype.getGlyph=function(z,j){var G=B(z,j);return G||(j===b?this._fallbackTabGlyph:j===x?this._fallbackSpaceGlyph:null)},C.prototype.computeMetrics=function(z,j,G,H){var te=this._opt.letterSpacing||0,Z=this._opt.font,ee=0,oe=0,xe=0,Pe,me;if(!Z.chars||Z.chars.length===0)return{start:j,end:j,width:0};G=Math.min(z.length,G);for(var Ce=j;Ce<G;Ce++){var Je=z.charCodeAt(Ce),Pe=this.getGlyph(Z,Je);if(Pe){Pe.xoffset;var Oe=me?U(Z,me.id,Pe.id):0;ee+=Oe;var $e=ee+Pe.xadvance+te,nt=ee+Pe.width;if(nt>=H||$e>=H)break;ee=$e,oe=nt,me=Pe}xe++}return me&&(oe+=me.xoffset),{start:j,end:j+xe,width:oe}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(T);function T(z){Object.defineProperty(C.prototype,z,{get:L(z),configurable:!0})}function L(z){return new Function(["return function "+z+"() {","  return this._"+z,"}"].join(`
`))()}function B(z,j){if(!z.chars||z.chars.length===0)return null;var G=J(z.chars,j);return G>=0?z.chars[G]:null}function F(z){for(var j=0;j<A.length;j++){var G=A[j].charCodeAt(0),H=J(z.chars,G);if(H>=0)return z.chars[H].height}return 0}function D(z){for(var j=0;j<g.length;j++){var G=g[j].charCodeAt(0),H=J(z.chars,G);if(H>=0)return z.chars[H]}return 0}function P(z){for(var j=0;j<v.length;j++){var G=v[j].charCodeAt(0),H=J(z.chars,G);if(H>=0)return z.chars[H].height}return 0}function U(z,j,G){if(!z.kernings||z.kernings.length===0)return 0;for(var H=z.kernings,te=0;te<H.length;te++){var Z=H[te];if(Z.first===j&&Z.second===G)return Z.amount}return 0}function K(z){return z==="center"?S:z==="right"?M:E}function J(z,j,G){G=G||0;for(var H=G;H<z.length;H++)if(z[H].id===j)return H;return-1}},"./node_modules/load-bmfont/browser.js":(c,u,h)=>{var d=h("./node_modules/buffer/index.js").Buffer,f=h("./node_modules/xhr/index.js"),p=function(){},A=h("./node_modules/parse-bmfont-ascii/index.js"),g=h("./node_modules/parse-bmfont-xml/lib/browser.js"),v=h("./node_modules/parse-bmfont-binary/index.js"),b=h("./node_modules/load-bmfont/lib/is-binary.js"),x=h("./node_modules/xtend/immutable.js"),E=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();c.exports=function(C,T){T=typeof T=="function"?T:p,typeof C=="string"?C={uri:C}:C||(C={});var L=C.binary;L&&(C=M(C)),f(C,function(B,F,D){if(B)return T(B);if(!/^2/.test(F.statusCode))return T(new Error("http status code: "+F.statusCode));if(!D)return T(new Error("no body result"));var P=!1;if(S(D)){var U=new Uint8Array(D);D=d.from(U,"binary")}b(D)&&(P=!0,typeof D=="string"&&(D=d.from(D,"binary"))),P||(d.isBuffer(D)&&(D=D.toString(C.encoding)),D=D.trim());var K;try{var J=F.headers["content-type"];P?K=v(D):/json/.test(J)||D.charAt(0)==="{"?K=JSON.parse(D):/xml/.test(J)||D.charAt(0)==="<"?K=g(D):K=A(D)}catch(z){T(new Error("error parsing font "+z.message)),T=p}T(null,K)})};function S(C){var T=Object.prototype.toString;return T.call(C)==="[object ArrayBuffer]"}function M(C){if(E)return x(C,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var T=new self.XMLHttpRequest;return T.overrideMimeType("text/plain; charset=x-user-defined"),x({xhr:T},C)}},"./node_modules/load-bmfont/lib/is-binary.js":(c,u,h)=>{var d=h("./node_modules/buffer/index.js").Buffer,f=h("./node_modules/buffer-equal/index.js"),p=d.from([66,77,70,3]);c.exports=function(A){return typeof A=="string"?A.substring(0,3)==="BMF":A.length>4&&f(A.slice(0,4),p)}},"./node_modules/object-assign/index.js":c=>{/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var u=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;function f(A){if(A==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(A)}function p(){try{if(!Object.assign)return!1;var A=new String("abc");if(A[5]="de",Object.getOwnPropertyNames(A)[0]==="5")return!1;for(var g={},v=0;v<10;v++)g["_"+String.fromCharCode(v)]=v;var b=Object.getOwnPropertyNames(g).map(function(E){return g[E]});if(b.join("")!=="0123456789")return!1;var x={};return"abcdefghijklmnopqrst".split("").forEach(function(E){x[E]=E}),Object.keys(Object.assign({},x)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}c.exports=p()?Object.assign:function(A,g){for(var v,b=f(A),x,E=1;E<arguments.length;E++){v=Object(arguments[E]);for(var S in v)h.call(v,S)&&(b[S]=v[S]);if(u){x=u(v);for(var M=0;M<x.length;M++)d.call(v,x[M])&&(b[x[M]]=v[x[M]])}}return b}},"./node_modules/parse-bmfont-ascii/index.js":c=>{c.exports=function(p){if(!p)throw new Error("no data provided");p=p.toString().trim();var A={pages:[],chars:[],kernings:[]},g=p.split(/\r\n?|\n/g);if(g.length===0)throw new Error("no data in BMFont file");for(var v=0;v<g.length;v++){var b=u(g[v],v);if(b)if(b.key==="page"){if(typeof b.data.id!="number")throw new Error("malformed file at line "+v+" -- needs page id=N");if(typeof b.data.file!="string")throw new Error("malformed file at line "+v+' -- needs page file="path"');A.pages[b.data.id]=b.data.file}else b.key==="chars"||b.key==="kernings"||(b.key==="char"?A.chars.push(b.data):b.key==="kerning"?A.kernings.push(b.data):A[b.key]=b.data)}return A};function u(f,p){if(f=f.replace(/\t+/g," ").trim(),!f)return null;var A=f.indexOf(" ");if(A===-1)throw new Error("no named row at line "+p);var g=f.substring(0,A);f=f.substring(A+1),f=f.replace(/letter=[\'\"]\S+[\'\"]/gi,""),f=f.split("="),f=f.map(function(S){return S.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var v=[],b=0;b<f.length;b++){var x=f[b];b===0?v.push({key:x[0],data:""}):b===f.length-1?v[v.length-1].data=h(x[0]):(v[v.length-1].data=h(x[0]),v.push({key:x[1],data:""}))}var E={key:g,data:{}};return v.forEach(function(S){E.data[S.key]=S.data}),E}function h(f){return!f||f.length===0?"":f.indexOf('"')===0||f.indexOf("'")===0?f.substring(1,f.length-1):f.indexOf(",")!==-1?d(f):parseInt(f,10)}function d(f){return f.split(",").map(function(p){return parseInt(p,10)})}},"./node_modules/parse-bmfont-binary/index.js":c=>{var u=[66,77,70];c.exports=function(E){if(E.length<6)throw new Error("invalid buffer length for BMFont");var S=u.every(function(B,F){return E.readUInt8(F)===B});if(!S)throw new Error("BMFont missing BMF byte header");var M=3,C=E.readUInt8(M++);if(C>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var T={kernings:[],chars:[]},L=0;L<5;L++)M+=h(T,E,M);return T};function h(x,E,S){if(S>E.length-1)return 0;var M=E.readUInt8(S++),C=E.readInt32LE(S);switch(S+=4,M){case 1:x.info=d(E,S);break;case 2:x.common=f(E,S);break;case 3:x.pages=p(E,S,C);break;case 4:x.chars=A(E,S,C);break;case 5:x.kernings=g(E,S,C);break}return 5+C}function d(x,E){var S={};S.size=x.readInt16LE(E);var M=x.readUInt8(E+2);return S.smooth=M>>7&1,S.unicode=M>>6&1,S.italic=M>>5&1,S.bold=M>>4&1,M>>3&1&&(S.fixedHeight=1),S.charset=x.readUInt8(E+3)||"",S.stretchH=x.readUInt16LE(E+4),S.aa=x.readUInt8(E+6),S.padding=[x.readInt8(E+7),x.readInt8(E+8),x.readInt8(E+9),x.readInt8(E+10)],S.spacing=[x.readInt8(E+11),x.readInt8(E+12)],S.outline=x.readUInt8(E+13),S.face=b(x,E+14),S}function f(x,E){var S={};return S.lineHeight=x.readUInt16LE(E),S.base=x.readUInt16LE(E+2),S.scaleW=x.readUInt16LE(E+4),S.scaleH=x.readUInt16LE(E+6),S.pages=x.readUInt16LE(E+8),x.readUInt8(E+10),S.packed=0,S.alphaChnl=x.readUInt8(E+11),S.redChnl=x.readUInt8(E+12),S.greenChnl=x.readUInt8(E+13),S.blueChnl=x.readUInt8(E+14),S}function p(x,E,S){for(var M=[],C=v(x,E),T=C.length+1,L=S/T,B=0;B<L;B++)M[B]=x.slice(E,E+C.length).toString("utf8"),E+=T;return M}function A(x,E,S){for(var M=[],C=S/20,T=0;T<C;T++){var L={},B=T*20;L.id=x.readUInt32LE(E+0+B),L.x=x.readUInt16LE(E+4+B),L.y=x.readUInt16LE(E+6+B),L.width=x.readUInt16LE(E+8+B),L.height=x.readUInt16LE(E+10+B),L.xoffset=x.readInt16LE(E+12+B),L.yoffset=x.readInt16LE(E+14+B),L.xadvance=x.readInt16LE(E+16+B),L.page=x.readUInt8(E+18+B),L.chnl=x.readUInt8(E+19+B),M[T]=L}return M}function g(x,E,S){for(var M=[],C=S/10,T=0;T<C;T++){var L={},B=T*10;L.first=x.readUInt32LE(E+0+B),L.second=x.readUInt32LE(E+4+B),L.amount=x.readInt16LE(E+8+B),M[T]=L}return M}function v(x,E){for(var S=E;S<x.length&&x[S]!==0;S++);return x.slice(E,S)}function b(x,E){return v(x,E).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(c,u,h)=>{var d=h("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),f=h("./node_modules/xml-parse-from-string/index.js"),p={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};c.exports=function(x){x=x.toString();var E=f(x),S={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(D){var P=E.getElementsByTagName(D)[0];P&&(S[D]=d(A(P)))});var M=E.getElementsByTagName("pages")[0];if(!M)throw new Error("malformed file -- no <pages> element");for(var C=M.getElementsByTagName("page"),T=0;T<C.length;T++){var L=C[T],B=parseInt(L.getAttribute("id"),10),F=L.getAttribute("file");if(isNaN(B))throw new Error('malformed file -- page "id" attribute is NaN');if(!F)throw new Error('malformed file -- needs page "file" attribute');S.pages[parseInt(B,10)]=F}return["chars","kernings"].forEach(function(D){var P=E.getElementsByTagName(D)[0];if(P)for(var U=D.substring(0,D.length-1),K=P.getElementsByTagName(U),J=0;J<K.length;J++){var z=K[J];S[D].push(d(A(z)))}}),S};function A(b){var x=g(b);return x.reduce(function(E,S){var M=v(S.nodeName);return E[M]=S.nodeValue,E},{})}function g(b){for(var x=[],E=0;E<b.attributes.length;E++)x.push(b.attributes[E]);return x}function v(b){return p[b.toLowerCase()]||b}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":c=>{var u="chasrset";c.exports=function(f){u in f&&(f.charset=f[u],delete f[u]);for(var p in f)p==="face"||p==="charset"||(p==="padding"||p==="spacing"?f[p]=h(f[p]):f[p]=parseInt(f[p],10));return f};function h(d){return d.split(",").map(function(f){return parseInt(f,10)})}},"./node_modules/parse-headers/parse-headers.js":c=>{var u=function(d){return d.replace(/^\s+|\s+$/g,"")},h=function(d){return Object.prototype.toString.call(d)==="[object Array]"};c.exports=function(d){if(!d)return{};for(var f={},p=u(d).split(`
`),A=0;A<p.length;A++){var g=p[A],v=g.indexOf(":"),b=u(g.slice(0,v)).toLowerCase(),x=u(g.slice(v+1));typeof f[b]>"u"?f[b]=x:h(f[b])?f[b].push(x):f[b]=[f[b],x]}return f}},"./node_modules/present/lib/present-browser.js":(c,u,h)=>{var d=h.g.performance||{},f=function(){for(var p=["now","webkitNow","msNow","mozNow","oNow"];p.length;){var A=p.shift();if(A in d)return d[A].bind(d)}var g=Date.now||function(){return new Date().getTime()},v=(d.timing||{}).navigationStart||g();return function(){return g()-v}}();f.performanceNow=d.now,f.noConflict=function(){d.now=f.performanceNow},f.conflict=function(){d.now=f},f.conflict(),c.exports=f},"./node_modules/process/browser.js":c=>{var u=c.exports={},h,d;function f(){throw new Error("setTimeout has not been defined")}function p(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?h=setTimeout:h=f}catch{h=f}try{typeof clearTimeout=="function"?d=clearTimeout:d=p}catch{d=p}})();function A(L){if(h===setTimeout)return setTimeout(L,0);if((h===f||!h)&&setTimeout)return h=setTimeout,setTimeout(L,0);try{return h(L,0)}catch{try{return h.call(null,L,0)}catch{return h.call(this,L,0)}}}function g(L){if(d===clearTimeout)return clearTimeout(L);if((d===p||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(L);try{return d(L)}catch{try{return d.call(null,L)}catch{return d.call(this,L)}}}var v=[],b=!1,x,E=-1;function S(){!b||!x||(b=!1,x.length?v=x.concat(v):E=-1,v.length&&M())}function M(){if(!b){var L=A(S);b=!0;for(var B=v.length;B;){for(x=v,v=[];++E<B;)x&&x[E].run();E=-1,B=v.length}x=null,b=!1,g(L)}}u.nextTick=function(L){var B=new Array(arguments.length-1);if(arguments.length>1)for(var F=1;F<arguments.length;F++)B[F-1]=arguments[F];v.push(new C(L,B)),v.length===1&&!b&&A(M)};function C(L,B){this.fun=L,this.array=B}C.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={};function T(){}u.on=T,u.addListener=T,u.once=T,u.off=T,u.removeListener=T,u.removeAllListeners=T,u.emit=T,u.prependListener=T,u.prependOnceListener=T,u.listeners=function(L){return[]},u.binding=function(L){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(L){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},"./node_modules/promise-polyfill/Promise.js":function(c){(function(u){var h=setTimeout,d=typeof setImmediate=="function"&&setImmediate||function(M){h(M,1)};function f(M,C){return function(){M.apply(C,arguments)}}var p=Array.isArray||function(M){return Object.prototype.toString.call(M)==="[object Array]"};function A(M){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof M!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],S(M,f(v,this),f(b,this))}function g(M){var C=this;if(this._state===null){this._deferreds.push(M);return}d(function(){var T=C._state?M.onFulfilled:M.onRejected;if(T===null){(C._state?M.resolve:M.reject)(C._value);return}var L;try{L=T(C._value)}catch(B){M.reject(B);return}M.resolve(L)})}function v(M){try{if(M===this)throw new TypeError("A promise cannot be resolved with itself.");if(M&&(typeof M=="object"||typeof M=="function")){var C=M.then;if(typeof C=="function"){S(f(C,M),f(v,this),f(b,this));return}}this._state=!0,this._value=M,x.call(this)}catch(T){b.call(this,T)}}function b(M){this._state=!1,this._value=M,x.call(this)}function x(){for(var M=0,C=this._deferreds.length;M<C;M++)g.call(this,this._deferreds[M]);this._deferreds=null}function E(M,C,T,L){this.onFulfilled=typeof M=="function"?M:null,this.onRejected=typeof C=="function"?C:null,this.resolve=T,this.reject=L}function S(M,C,T){var L=!1;try{M(function(B){L||(L=!0,C(B))},function(B){L||(L=!0,T(B))})}catch(B){if(L)return;L=!0,T(B)}}A.prototype.catch=function(M){return this.then(null,M)},A.prototype.then=function(M,C){var T=this;return new A(function(L,B){g.call(T,new E(M,C,L,B))})},A.all=function(){var M=Array.prototype.slice.call(arguments.length===1&&p(arguments[0])?arguments[0]:arguments);return new A(function(C,T){if(M.length===0)return C([]);var L=M.length;function B(D,P){try{if(P&&(typeof P=="object"||typeof P=="function")){var U=P.then;if(typeof U=="function"){U.call(P,function(K){B(D,K)},T);return}}M[D]=P,--L===0&&C(M)}catch(K){T(K)}}for(var F=0;F<M.length;F++)B(F,M[F])})},A.resolve=function(M){return M&&typeof M=="object"&&M.constructor===A?M:new A(function(C){C(M)})},A.reject=function(M){return new A(function(C,T){T(M)})},A.race=function(M){return new A(function(C,T){for(var L=0,B=M.length;L<B;L++)M[L].then(C,T)})},A._setImmediateFn=function(C){d=C},c.exports?c.exports=A:u.Promise||(u.Promise=A)})(this)},"./node_modules/quad-indices/index.js":(c,u,h)=>{var d=h("./node_modules/dtype/index.js"),f=h("./node_modules/an-array/index.js"),p=h("./node_modules/is-buffer/index.js"),A=[0,2,3],g=[2,1,3];c.exports=function(b,x){(!b||!(f(b)||p(b)))&&(x=b||{},b=null),typeof x=="number"?x={count:x}:x=x||{};for(var E=typeof x.type=="string"?x.type:"uint16",S=typeof x.count=="number"?x.count:1,M=x.start||0,C=x.clockwise!==!1?A:g,T=C[0],L=C[1],B=C[2],F=S*6,D=b||new(d(E))(F),P=0,U=0;P<F;P+=6,U+=4){var K=P+M;D[K+0]=U+0,D[K+1]=U+1,D[K+2]=U+2,D[K+3]=U+T,D[K+4]=U+L,D[K+5]=U+B}return D}},"./node_modules/super-animejs/lib/anime.es.js":(c,u,h)=>{h.r(u),h.d(u,{default:()=>yt});var d={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},f={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},p=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],A={CSS:{},springs:{}};function g(de,be,Ve){return Math.min(Math.max(de,be),Ve)}function v(de,be){return de.indexOf(be)>-1}function b(de,be){return de.apply(null,be)}var x=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,E=/^rgb/,S=/^hsl/,M={arr:function(de){return Array.isArray(de)},obj:function(de){return v(Object.prototype.toString.call(de),"Object")},pth:function(de){return M.obj(de)&&de.hasOwnProperty("totalLength")},svg:function(de){return de instanceof SVGElement},inp:function(de){return de instanceof HTMLInputElement},dom:function(de){return de.nodeType||M.svg(de)},str:function(de){return typeof de=="string"},fnc:function(de){return typeof de=="function"},und:function(de){return typeof de>"u"},hex:function(de){return x.test(de)},rgb:function(de){return E.test(de)},hsl:function(de){return S.test(de)},col:function(de){return M.hex(de)||M.rgb(de)||M.hsl(de)},key:function(de){return!d.hasOwnProperty(de)&&!f.hasOwnProperty(de)&&de!=="targets"&&de!=="keyframes"}},C=/\(([^)]+)\)/;function T(de){var be=C.exec(de);return be?be[1].split(",").map(function(Ve){return parseFloat(Ve)}):[]}function L(de,be){var Ve=T(de),dt=g(M.und(Ve[0])?1:Ve[0],.1,100),ut=g(M.und(Ve[1])?100:Ve[1],.1,100),_t=g(M.und(Ve[2])?10:Ve[2],.1,100),It=g(M.und(Ve[3])?0:Ve[3],.1,100),Zt=Math.sqrt(ut/dt),Wt=_t/(2*Math.sqrt(ut*dt)),Lt=Wt<1?Zt*Math.sqrt(1-Wt*Wt):0,Pn=1,Dn=Wt<1?(Wt*Zt+-It)/Lt:-It+Zt;function jn(Cn){var vi=be?be*Cn/1e3:Cn;return Wt<1?vi=Math.exp(-vi*Wt*Zt)*(Pn*Math.cos(Lt*vi)+Dn*Math.sin(Lt*vi)):vi=(Pn+Dn*vi)*Math.exp(-vi*Zt),Cn===0||Cn===1?Cn:1-vi}function di(){var Cn=A.springs[de];if(Cn)return Cn;for(var vi=1/6,Zn=0,nr=0;;)if(Zn+=vi,jn(Zn)===1){if(nr++,nr>=16)break}else nr=0;var Rr=Zn*vi*1e3;return A.springs[de]=Rr,Rr}return be?jn:di}function B(de,be){de===void 0&&(de=1),be===void 0&&(be=.5);var Ve=g(de,1,10),dt=g(be,.1,2);return function(ut){return ut===0||ut===1?ut:-Ve*Math.pow(2,10*(ut-1))*Math.sin((ut-1-dt/(Math.PI*2)*Math.asin(1/Ve))*(Math.PI*2)/dt)}}function F(de){return de===void 0&&(de=10),function(be){return Math.round(be*de)*(1/de)}}var D=function(){var de=11,be=1/(de-1);function Ve(Pn,Dn){return 1-3*Dn+3*Pn}function dt(Pn,Dn){return 3*Dn-6*Pn}function ut(Pn){return 3*Pn}function _t(Pn,Dn,jn){return((Ve(Dn,jn)*Pn+dt(Dn,jn))*Pn+ut(Dn))*Pn}function It(Pn,Dn,jn){return 3*Ve(Dn,jn)*Pn*Pn+2*dt(Dn,jn)*Pn+ut(Dn)}function Zt(Pn,Dn,jn,di,Cn){var vi,Zn,nr=0;do Zn=Dn+(jn-Dn)/2,vi=_t(Zn,di,Cn)-Pn,vi>0?jn=Zn:Dn=Zn;while(Math.abs(vi)>1e-7&&++nr<10);return Zn}function Wt(Pn,Dn,jn,di){for(var Cn=0;Cn<4;++Cn){var vi=It(Dn,jn,di);if(vi===0)return Dn;var Zn=_t(Dn,jn,di)-Pn;Dn-=Zn/vi}return Dn}function Lt(Pn,Dn,jn,di){if(!(0<=Pn&&Pn<=1&&0<=jn&&jn<=1))return;var Cn=new Float32Array(de);if(Pn!==Dn||jn!==di)for(var vi=0;vi<de;++vi)Cn[vi]=_t(vi*be,Pn,jn);function Zn(nr){for(var Rr=0,Rn=1,Kn=de-1;Rn!==Kn&&Cn[Rn]<=nr;++Rn)Rr+=be;--Rn;var zi=(nr-Cn[Rn])/(Cn[Rn+1]-Cn[Rn]),Si=Rr+zi*be,Y=It(Si,Pn,jn);return Y>=.001?Wt(nr,Si,Pn,jn):Y===0?Si:Zt(nr,Rr,Rr+be,Pn,jn)}return function(nr){return Pn===Dn&&jn===di||nr===0||nr===1?nr:_t(Zn(nr),Dn,di)}}return Lt}(),P=function(){var de=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],be={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],B],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(It,Zt){return function(Wt){return 1-B(It,Zt)(1-Wt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(It,Zt){return function(Wt){return Wt<.5?B(It,Zt)(Wt*2)/2:1-B(It,Zt)(Wt*-2+2)/2}}]},Ve={linear:[.25,.25,.75,.75]};for(var dt in be)for(var ut=0,_t=be[dt].length;ut<_t;ut++)Ve["ease"+dt+de[ut]]=be[dt][ut];return Ve}();function U(de,be){if(M.fnc(de))return de;var Ve=de.split("(")[0],dt=P[Ve],ut=T(de);switch(Ve){case"spring":return L(de,be);case"cubicBezier":return b(D,ut);case"steps":return b(F,ut);default:return M.fnc(dt)?b(dt,ut):b(D,dt)}}function K(de){try{var be=document.querySelectorAll(de);return be}catch{return}}var J=[];function z(de,be){for(var Ve=J,dt=de.length,ut=arguments.length>=2?arguments[1]:void 0,_t=0;_t<dt;_t++)if(_t in de){var It=de[_t];be.call(ut,It,_t,de)&&Ve.push(It)}return J=de,J.length=0,Ve}function j(de,be){be||(be=[]);for(var Ve=0,dt=de.length;Ve<dt;Ve++){var ut=de[Ve];Array.isArray(ut)?j(ut,be):be.push(ut)}return be}function G(de){return M.arr(de)?de:(M.str(de)&&(de=K(de)||de),de instanceof NodeList||de instanceof HTMLCollection?[].slice.call(de):[de])}function H(de,be){return de.some(function(Ve){return Ve===be})}function te(de){var be={};for(var Ve in de)be[Ve]=de[Ve];return be}function Z(de,be){var Ve=te(de);for(var dt in de)Ve[dt]=be.hasOwnProperty(dt)?be[dt]:de[dt];return Ve}function ee(de,be){var Ve=te(de);for(var dt in be)Ve[dt]=M.und(de[dt])?be[dt]:de[dt];return Ve}var oe=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function xe(de){var be=oe.exec(de);return be?"rgba("+be[1]+",1)":de}var Pe=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,me=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function Ce(de){var be=de.replace(Pe,function(It,Zt,Wt,Lt){return Zt+Zt+Wt+Wt+Lt+Lt}),Ve=me.exec(be),dt=parseInt(Ve[1],16),ut=parseInt(Ve[2],16),_t=parseInt(Ve[3],16);return"rgba("+dt+","+ut+","+_t+",1)"}var Je=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Oe=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function $e(de){var be=Je.exec(de)||Oe.exec(de),Ve=parseInt(be[1],10)/360,dt=parseInt(be[2],10)/100,ut=parseInt(be[3],10)/100,_t=be[4]||1;function It(jn,di,Cn){return Cn<0&&(Cn+=1),Cn>1&&(Cn-=1),Cn<.16666666666666666?jn+(di-jn)*6*Cn:Cn<.5?di:Cn<.6666666666666666?jn+(di-jn)*(.6666666666666666-Cn)*6:jn}var Zt,Wt,Lt;if(dt==0)Zt=Wt=Lt=ut;else{var Pn=ut<.5?ut*(1+dt):ut+dt-ut*dt,Dn=2*ut-Pn;Zt=It(Dn,Pn,Ve+.3333333333333333),Wt=It(Dn,Pn,Ve),Lt=It(Dn,Pn,Ve-.3333333333333333)}return"rgba("+Zt*255+","+Wt*255+","+Lt*255+","+_t+")"}function nt(de){if(M.rgb(de))return xe(de);if(M.hex(de))return Ce(de);if(M.hsl(de))return $e(de)}var gt=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function Tt(de){var be=gt.exec(de);if(be)return be[2]}function Ze(de){if(v(de,"translate")||de==="perspective")return"px";if(v(de,"rotate")||v(de,"skew"))return"deg"}function mn(de,be){return M.fnc(de)?de(be.target,be.id,be.total):de}function Ft(de,be){return de.getAttribute(be)}function Qt(de,be,Ve){var dt=Tt(be);if(H([Ve,"deg","rad","turn"],dt))return be;var ut=A.CSS[be+Ve];if(!M.und(ut))return ut;var _t=100,It=document.createElement(de.tagName),Zt=de.parentNode&&de.parentNode!==document?de.parentNode:document.body;Zt.appendChild(It),It.style.position="absolute",It.style.width=_t+Ve;var Wt=_t/It.offsetWidth;Zt.removeChild(It);var Lt=Wt*parseFloat(be);return A.CSS[be+Ve]=Lt,Lt}function Xt(de,be,Ve){if(be in de.style){var dt=be.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ut=de.style[be]||getComputedStyle(de).getPropertyValue(dt)||"0";return Ve?Qt(de,ut,Ve):ut}}function Tn(de,be){if(M.dom(de)&&!M.inp(de)&&(Ft(de,be)||M.svg(de)&&de[be]))return"attribute";if(M.dom(de)&&H(p,be))return"transform";if(M.dom(de)&&be!=="transform"&&Xt(de,be))return"css";if(de[be]!=null)return"object"}var vn=/(\w+)\(([^)]*)\)/g;function Fe(de){if(M.dom(de)){for(var be=de.style.transform||"",Ve=new Map,dt;dt=vn.exec(be);)Ve.set(dt[1],dt[2]);return Ve}}function Te(de,be,Ve,dt){var ut=v(be,"scale")?1:0+Ze(be),_t=Fe(de).get(be)||ut;return Ve&&(Ve.transforms.list.set(be,_t),Ve.transforms.last=be),dt?Qt(de,_t,dt):_t}function pt(de,be,Ve,dt){switch(Tn(de,be)){case"transform":return Te(de,be,dt,Ve);case"css":return Xt(de,be,Ve);case"attribute":return Ft(de,be);default:return de[be]||0}}var Nt=/^(\*=|\+=|-=)/;function zt(de,be){var Ve=Nt.exec(de);if(!Ve)return de;var dt=Tt(de)||0,ut=parseFloat(be),_t=parseFloat(de.replace(Ve[0],""));switch(Ve[0][0]){case"+":return ut+_t+dt;case"-":return ut-_t+dt;case"*":return ut*_t+dt}}var Vt=/\s/g;function fn(de,be){if(M.col(de))return nt(de);var Ve=Tt(de),dt=Ve?de.substr(0,de.length-Ve.length):de;return be&&!Vt.test(de)?dt+be:dt}function mt(de,be){return Math.sqrt(Math.pow(be.x-de.x,2)+Math.pow(be.y-de.y,2))}function Ee(de){return Math.PI*2*Ft(de,"r")}function _e(de){return Ft(de,"width")*2+Ft(de,"height")*2}function Ne(de){return mt({x:Ft(de,"x1"),y:Ft(de,"y1")},{x:Ft(de,"x2"),y:Ft(de,"y2")})}function ye(de){for(var be=de.points,Ve=0,dt,ut=0;ut<be.numberOfItems;ut++){var _t=be.getItem(ut);ut>0&&(Ve+=mt(dt,_t)),dt=_t}return Ve}function De(de){var be=de.points;return ye(de)+mt(be.getItem(be.numberOfItems-1),be.getItem(0))}function ke(de){if(de.getTotalLength)return de.getTotalLength();switch(de.tagName.toLowerCase()){case"circle":return Ee(de);case"rect":return _e(de);case"line":return Ne(de);case"polyline":return ye(de);case"polygon":return De(de)}}function Ye(de){var be=ke(de);return de.setAttribute("stroke-dasharray",be),be}function Qe(de){for(var be=de.parentNode;M.svg(be)&&(be=be.parentNode,!!M.svg(be.parentNode)););return be}function ne(de,be){var Ve=be||{},dt=Ve.el||Qe(de),ut=dt.getBoundingClientRect(),_t=Ft(dt,"viewBox"),It=ut.width,Zt=ut.height,Wt=Ve.viewBox||(_t?_t.split(" "):[0,0,It,Zt]);return{el:dt,viewBox:Wt,x:Wt[0]/1,y:Wt[1]/1,w:It/Wt[2],h:Zt/Wt[3]}}function W(de,be){var Ve=M.str(de)?K(de)[0]:de,dt=be||100;return function(ut){return{property:ut,el:Ve,svg:ne(Ve),totalLength:ke(Ve)*(dt/100)}}}function k(de,be){function Ve(Zt){Zt===void 0&&(Zt=0);var Wt=be+Zt>=1?be+Zt:0;return de.el.getPointAtLength(Wt)}var dt=ne(de.el,de.svg),ut=Ve(),_t=Ve(-1),It=Ve(1);switch(de.property){case"x":return(ut.x-dt.x)*dt.w;case"y":return(ut.y-dt.y)*dt.h;case"angle":return Math.atan2(It.y-_t.y,It.x-_t.x)*180/Math.PI}}var he=/-?\d*\.?\d+/g;function Re(de,be){var Ve=fn(M.pth(de)?de.totalLength:de,be)+"";return{original:Ve,numbers:Ve.match(he)?Ve.match(he).map(Number):[0],strings:M.str(de)||be?Ve.split(he):[]}}function We(de){var be=de?j(M.arr(de)?de.map(G):G(de)):[];return z(be,function(Ve,dt,ut){return ut.indexOf(Ve)===dt})}function ve(de){var be=We(de);return be.map(function(Ve,dt){return{target:Ve,id:dt,total:be.length,transforms:{list:Fe(Ve)}}})}var at=/^spring/;function At(de,be){var Ve=te(be);if(at.test(Ve.easing)&&(Ve.duration=L(Ve.easing)),M.arr(de)){var dt=de.length,ut=dt===2&&!M.obj(de[0]);ut?de={value:de}:M.fnc(be.duration)||(Ve.duration=be.duration/dt)}var _t=M.arr(de)?de:[de];return _t.map(function(It,Zt){var Wt=M.obj(It)&&!M.pth(It)?It:{value:It};return M.und(Wt.delay)&&(Wt.delay=Zt?0:be.delay),M.und(Wt.endDelay)&&(Wt.endDelay=Zt===_t.length-1?be.endDelay:0),Wt}).map(function(It){return ee(It,Ve)})}function Ct(de){for(var be=z(j(de.map(function(_t){return Object.keys(_t)})),function(_t){return M.key(_t)}).reduce(function(_t,It){return _t.indexOf(It)<0&&_t.push(It),_t},[]),Ve={},dt=function(_t){var It=be[_t];Ve[It]=de.map(function(Zt){var Wt={};for(var Lt in Zt)M.key(Lt)?Lt==It&&(Wt.value=Zt[Lt]):Wt[Lt]=Zt[Lt];return Wt})},ut=0;ut<be.length;ut++)dt(ut);return Ve}function Pt(de,be){var Ve=[],dt=be.keyframes;dt&&(be=ee(Ct(dt),be));for(var ut in be)M.key(ut)&&Ve.push({name:ut,tweens:At(be[ut],de)});return Ve}function $t(de,be){var Ve={};for(var dt in de){var ut=mn(de[dt],be);M.arr(ut)&&(ut=ut.map(function(_t){return mn(_t,be)}),ut.length===1&&(ut=ut[0])),Ve[dt]=ut}return Ve.duration=parseFloat(Ve.duration),Ve.delay=parseFloat(Ve.delay),Ve}function Bn(de,be){var Ve;return de.tweens.map(function(dt){var ut=$t(dt,be),_t=ut.value,It=M.arr(_t)?_t[1]:_t,Zt=Tt(It),Wt=pt(be.target,de.name,Zt,be),Lt=Ve?Ve.to.original:Wt,Pn=M.arr(_t)?_t[0]:Lt,Dn=Tt(Pn)||Tt(Wt),jn=Zt||Dn;return M.und(It)&&(It=Lt),ut.from=Re(Pn,jn),ut.to=Re(zt(It,Pn),jn),ut.start=Ve?Ve.end:0,ut.end=ut.start+ut.delay+ut.duration+ut.endDelay,ut.easing=U(ut.easing,ut.duration),ut.isPath=M.pth(_t),ut.isColor=M.col(ut.from.original),ut.isColor&&(ut.round=1),Ve=ut,ut})}var pi={css:function(de,be,Ve){return de.style[be]=Ve},attribute:function(de,be,Ve){return de.setAttribute(be,Ve)},object:function(de,be,Ve){return de[be]=Ve},transform:function(de,be,Ve,dt,ut){if(dt.list.set(be,Ve),be===dt.last||ut){var _t="";dt.list.forEach(function(It,Zt){_t+=Zt+"("+It+") "}),de.style.transform=_t}}};function Ri(de,be){for(var Ve=ve(de),dt=0,ut=Ve.length;dt<ut;dt++){var _t=Ve[dt];for(var It in be){var Zt=mn(be[It],_t),Wt=_t.target,Lt=Tt(Zt),Pn=pt(Wt,It,Lt,_t),Dn=Lt||Tt(Pn),jn=zt(fn(Zt,Dn),Pn),di=Tn(Wt,It);pi[di](Wt,It,jn,_t.transforms,!0)}}}function Fn(de,be){var Ve=Tn(de.target,be.name);if(Ve){var dt=Bn(be,de),ut=dt[dt.length-1];return{type:Ve,property:be.name,animatable:de,tweens:dt,duration:ut.end,delay:dt[0].delay,endDelay:ut.endDelay}}}function sn(de,be){return z(j(de.map(function(Ve){return be.map(function(dt){return Fn(Ve,dt)})})),function(Ve){return!M.und(Ve)})}function Rt(de,be){var Ve=de.length,dt=function(_t){return _t.timelineOffset?_t.timelineOffset:0},ut={};return ut.duration=Ve?Math.max.apply(Math,de.map(function(_t){return dt(_t)+_t.duration})):be.duration,ut.delay=Ve?Math.min.apply(Math,de.map(function(_t){return dt(_t)+_t.delay})):be.delay,ut.endDelay=Ve?ut.duration-Math.max.apply(Math,de.map(function(_t){return dt(_t)+_t.duration-_t.endDelay})):be.endDelay,ut}var gn=0;function si(de){var be=Z(d,de),Ve=Z(f,de),dt=Pt(Ve,de),ut=ve(de.targets),_t=sn(ut,dt),It=Rt(_t,Ve),Zt=gn;return gn++,ee(be,{id:Zt,children:[],animatables:ut,animations:_t,duration:It.duration,delay:It.delay,endDelay:It.endDelay})}var Ln=[],Jn=[],$n,Ei=function(){function de(){$n=requestAnimationFrame(be)}function be(Ve){var dt=Ln.length;if(dt){for(var ut=0;ut<dt;){var _t=Ln[ut];if(!_t.paused)_t.tick(Ve);else{var It=Ln.indexOf(_t);It>-1&&(Ln.splice(It,1),dt=Ln.length)}ut++}de()}else $n=cancelAnimationFrame($n)}return de}();function Fi(){if(document.hidden){for(var de=0,be=Ln.length;de<be;de++)activeInstance[de].pause();Jn=Ln.slice(0),Ln=[]}else for(var Ve=0,dt=Jn.length;Ve<dt;Ve++)Jn[Ve].play()}document.addEventListener("visibilitychange",Fi);function Vi(de){de===void 0&&(de={});var be=0,Ve=0,dt=0,ut,_t=0,It=null;function Zt(){return window.Promise&&new Promise(function(Rn){return It=Rn})}var Wt=Zt(),Lt=si(de);function Pn(){Lt.reversed=!Lt.reversed;for(var Rn=0,Kn=ut.length;Rn<Kn;Rn++)ut[Rn].reversed=Lt.reversed}function Dn(Rn){return Lt.reversed?Lt.duration-Rn:Rn}function jn(){be=0,Ve=Dn(Lt.currentTime)*(1/Vi.speed)}function di(Rn,Kn){Kn&&Kn.seek(Rn-Kn.timelineOffset)}function Cn(Rn){if(Lt.reversePlayback)for(var zi=_t;zi--;)di(Rn,ut[zi]);else for(var Kn=0;Kn<_t;Kn++)di(Rn,ut[Kn])}function vi(Rn){for(var Kn=0,zi=Lt.animations,Si=zi.length;Kn<Si;){var Y=zi[Kn],se=Y.animatable,pe=Y.tweens,we=pe.length-1,Ue=pe[we];we&&(Ue=z(pe,function(Vn){return Rn<Vn.end})[0]||Ue);for(var Ke=g(Rn-Ue.start-Ue.delay,0,Ue.duration)/Ue.duration,ft=isNaN(Ke)?1:Ue.easing(Ke),ae=Ue.to.strings,le=Ue.round,ce=[],ge=Ue.to.numbers.length,Ae=void 0,tt=0;tt<ge;tt++){var xt=void 0,Dt=Ue.to.numbers[tt],Yt=Ue.from.numbers[tt]||0;Ue.isPath?xt=k(Ue.value,ft*Dt):xt=Yt+ft*(Dt-Yt),le&&(Ue.isColor&&tt>2||(xt=Math.round(xt*le)/le)),ce.push(xt)}var on=ae.length;if(!on)Ae=ce[0];else{Ae=ae[0];for(var kt=0;kt<on;kt++){ae[kt];var bn=ae[kt+1],oi=ce[kt];isNaN(oi)||(bn?Ae+=oi+bn:Ae+=oi+" ")}}pi[Y.type](se.target,Y.property,Ae,se.transforms),Y.currentValue=Ae,Kn++}}function Zn(Rn){Lt[Rn]&&!Lt.passThrough&&Lt[Rn](Lt)}function nr(){Lt.remaining&&Lt.remaining!==!0&&Lt.remaining--}function Rr(Rn){var Kn=Lt.duration,zi=Lt.delay,Si=Kn-Lt.endDelay,Y=Dn(Rn);Lt.progress=g(Y/Kn*100,0,100),Lt.reversePlayback=Y<Lt.currentTime,ut&&Cn(Y),!Lt.began&&Lt.currentTime>0&&(Lt.began=!0,Zn("begin"),Zn("loopBegin")),Y<=zi&&Lt.currentTime!==0&&vi(0),(Y>=Si&&Lt.currentTime!==Kn||!Kn)&&vi(Kn),Y>zi&&Y<Si?(Lt.changeBegan||(Lt.changeBegan=!0,Lt.changeCompleted=!1,Zn("changeBegin")),Zn("change"),vi(Y)):Lt.changeBegan&&(Lt.changeCompleted=!0,Lt.changeBegan=!1,Zn("changeComplete")),Lt.currentTime=g(Y,0,Kn),Lt.began&&Zn("update"),Rn>=Kn&&(Ve=0,nr(),Lt.remaining?(be=dt,Zn("loopComplete"),Zn("loopBegin"),Lt.direction==="alternate"&&Pn()):(Lt.paused=!0,Lt.completed||(Lt.completed=!0,Zn("loopComplete"),Zn("complete"),"Promise"in window&&(It(),Wt=Zt()))))}return Lt.reset=function(){var Rn=Lt.direction;Lt.passThrough=!1,Lt.currentTime=0,Lt.progress=0,Lt.paused=!0,Lt.began=!1,Lt.changeBegan=!1,Lt.completed=!1,Lt.changeCompleted=!1,Lt.reversePlayback=!1,Lt.reversed=Rn==="reverse",Lt.remaining=Lt.loop,ut=Lt.children,_t=ut.length;for(var Kn=_t;Kn--;)Lt.children[Kn].reset();(Lt.reversed&&Lt.loop!==!0||Rn==="alternate"&&Lt.loop===1)&&Lt.remaining++,vi(0)},Lt.set=function(Rn,Kn){return Ri(Rn,Kn),Lt},Lt.tick=function(Rn){dt=Rn,be||(be=dt),Rr((dt+(Ve-be))*Vi.speed)},Lt.seek=function(Rn){Rr(Dn(Rn))},Lt.pause=function(){Lt.paused=!0,jn()},Lt.play=function(){Lt.paused&&(Lt.paused=!1,Ln.push(Lt),jn(),$n||Ei())},Lt.reverse=function(){Pn(),jn()},Lt.restart=function(){Lt.reset(),Lt.play()},Lt.finished=Wt,Lt.reset(),Lt.autoplay&&Lt.play(),Lt}function lr(de,be){for(var Ve=be.length;Ve--;)H(de,be[Ve].animatable.target)&&be.splice(Ve,1)}function cr(de){for(var be=We(de),Ve=Ln.length;Ve--;){var dt=Ln[Ve],ut=dt.animations,_t=dt.children;lr(be,ut);for(var It=_t.length;It--;){var Zt=_t[It],Wt=Zt.animations;lr(be,Wt),!Wt.length&&!Zt.children.length&&_t.splice(It,1)}!ut.length&&!_t.length&&dt.pause()}}function Le(de,be){be===void 0&&(be={});var Ve=be.direction||"normal",dt=be.easing?U(be.easing):null,ut=be.grid,_t=be.axis,It=be.from||0,Zt=It==="first",Wt=It==="center",Lt=It==="last",Pn=M.arr(de),Dn=parseFloat(Pn?de[0]:de),jn=Pn?parseFloat(de[1]):0,di=Tt(Pn?de[1]:de)||0,Cn=be.start||0+(Pn?Dn:0),vi=[],Zn=0;return function(nr,Rr,Rn){if(Zt&&(It=0),Wt&&(It=(Rn-1)/2),Lt&&(It=Rn-1),!vi.length){for(var Kn=0;Kn<Rn;Kn++){if(!ut)vi.push(Math.abs(It-Kn));else{var zi=Wt?(ut[0]-1)/2:It%ut[0],Si=Wt?(ut[1]-1)/2:Math.floor(It/ut[0]),Y=Kn%ut[0],se=Math.floor(Kn/ut[0]),pe=zi-Y,we=Si-se,Ue=Math.sqrt(pe*pe+we*we);_t==="x"&&(Ue=-pe),_t==="y"&&(Ue=-we),vi.push(Ue)}Zn=Math.max.apply(Math,vi)}dt&&(vi=vi.map(function(ft){return dt(ft/Zn)*Zn})),Ve==="reverse"&&(vi=vi.map(function(ft){return _t?ft<0?ft*-1:-ft:Math.abs(Zn-ft)}))}var Ke=Pn?(jn-Dn)/Zn:Dn;return Cn+Ke*(Math.round(vi[Rr]*100)/100)+di}}function ht(de){de===void 0&&(de={});var be=Vi(de);return be.duration=0,be.add=function(Ve,dt){var ut=Ln.indexOf(be),_t=be.children;ut>-1&&Ln.splice(ut,1);function It(jn){jn.passThrough=!0}for(var Zt=0;Zt<_t.length;Zt++)It(_t[Zt]);var Wt=ee(Ve,Z(f,de));Wt.targets=Wt.targets||de.targets;var Lt=be.duration;Wt.autoplay=!1,Wt.direction=be.direction,Wt.timelineOffset=M.und(dt)?Lt:zt(dt,Lt),It(be),be.seek(Wt.timelineOffset);var Pn=Vi(Wt);It(Pn),_t.push(Pn);var Dn=Rt(_t,de);return be.delay=Dn.delay,be.endDelay=Dn.endDelay,be.duration=Dn.duration,be.seek(0),be.reset(),be.autoplay&&be.play(),be},be}Vi.version="3.0.0",Vi.speed=1,Vi.running=Ln,Vi.remove=cr,Vi.get=pt,Vi.set=Ri,Vi.convertPx=Qt,Vi.path=W,Vi.setDashoffset=Ye,Vi.stagger=Le,Vi.timeline=ht,Vi.easing=U,Vi.penner=P,Vi.random=function(de,be){return Math.floor(Math.random()*(be-de+1))+de};const yt=Vi},"./node_modules/three-bmfont-text/index.js":(c,u,h)=>{var d=h("./node_modules/layout-bmfont-text/index.js"),f=h("./node_modules/quad-indices/index.js"),p=h("./node_modules/three-bmfont-text/lib/vertices.js"),A=h("./node_modules/three-bmfont-text/lib/utils.js");c.exports=function(b){return new g(b)};class g extends THREE.BufferGeometry{constructor(b){super(),typeof b=="string"&&(b={text:b}),this._opt=Object.assign({},b),b&&this.update(b)}update(b){if(typeof b=="string"&&(b={text:b}),b=Object.assign({},this._opt,b),!b.font)throw new TypeError("must specify a { font } in options");this.layout=d(b);var x=b.flipY!==!1,E=b.font,S=E.common.scaleW,M=E.common.scaleH,C=this.layout.glyphs.filter(function(D){var P=D.data;return P.width*P.height>0});this.visibleGlyphs=C;var T=p.positions(C),L=p.uvs(C,S,M,x),B=f([],{clockwise:!0,type:"uint16",count:C.length});if(this.setIndex(B),this.setAttribute("position",new THREE.BufferAttribute(T,2)),this.setAttribute("uv",new THREE.BufferAttribute(L,2)),!b.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(b.multipage){var F=p.pages(C);this.setAttribute("page",new THREE.BufferAttribute(F,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var b=this.attributes.position.array,x=this.attributes.position.itemSize;if(!b||!x||b.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}A.computeSphere(b,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var b=this.boundingBox,x=this.attributes.position.array,E=this.attributes.position.itemSize;if(!x||!E||x.length<2){b.makeEmpty();return}A.computeBox(x,b)}}},"./node_modules/three-bmfont-text/lib/utils.js":c=>{var u=2,h={min:[0,0],max:[0,0]};function d(f){var p=f.length/u;h.min[0]=f[0],h.min[1]=f[1],h.max[0]=f[0],h.max[1]=f[1];for(var A=0;A<p;A++){var g=f[A*u+0],v=f[A*u+1];h.min[0]=Math.min(g,h.min[0]),h.min[1]=Math.min(v,h.min[1]),h.max[0]=Math.max(g,h.max[0]),h.max[1]=Math.max(v,h.max[1])}}c.exports.computeBox=function(f,p){d(f),p.min.set(h.min[0],h.min[1],0),p.max.set(h.max[0],h.max[1],0)},c.exports.computeSphere=function(f,p){d(f);var A=h.min[0],g=h.min[1],v=h.max[0],b=h.max[1],x=v-A,E=b-g,S=Math.sqrt(x*x+E*E);p.center.set(A+x/2,g+E/2,0),p.radius=S/2}},"./node_modules/three-bmfont-text/lib/vertices.js":c=>{c.exports.pages=function(h){var d=new Float32Array(h.length*4*1),f=0;return h.forEach(function(p){var A=p.data.page||0;d[f++]=A,d[f++]=A,d[f++]=A,d[f++]=A}),d},c.exports.uvs=function(h,d,f,p){var A=new Float32Array(h.length*4*2),g=0;return h.forEach(function(v){var b=v.data,x=b.x+b.width,E=b.y+b.height,S=b.x/d,M=b.y/f,C=x/d,T=E/f;p&&(M=(f-b.y)/f,T=(f-E)/f),A[g++]=S,A[g++]=M,A[g++]=S,A[g++]=T,A[g++]=C,A[g++]=T,A[g++]=C,A[g++]=M}),A},c.exports.positions=function(h){var d=new Float32Array(h.length*4*2),f=0;return h.forEach(function(p){var A=p.data,g=p.position[0]+A.xoffset,v=p.position[1]+A.yoffset,b=A.width,x=A.height;d[f++]=g,d[f++]=v,d[f++]=g,d[f++]=v+x,d[f++]=g+b,d[f++]=v+x,d[f++]=g+b,d[f++]=v}),d}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(c,u,h){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(d,f){c.exports=f()})(this,function(){var d=typeof window<"u"?window:typeof h.g<"u"?h.g:typeof self<"u"?self:{};function f(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}function p(B,F){return F={exports:{}},B(F,F.exports),F.exports}var A=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},g=function(F,D){for(var P=0,U=F.length;P<U;P++)D[P]=F[P]},v=function(F,D){for(var P in D)D.hasOwnProperty(P)&&(F[P]=D[P]);return F},b=p(function(B,F){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(D,P){B.exports=P()})(d,function(){var D=function(Y,se){if(!(Y instanceof se))throw new TypeError("Cannot call a class as a function")},P=function(){function Y(se,pe){for(var we=0;we<pe.length;we++){var Ue=pe[we];Ue.enumerable=Ue.enumerable||!1,Ue.configurable=!0,"value"in Ue&&(Ue.writable=!0),Object.defineProperty(se,Ue.key,Ue)}}return function(se,pe,we){return pe&&Y(se.prototype,pe),we&&Y(se,we),se}}(),U=function(){function Y(se,pe){var we=[],Ue=!0,Ke=!1,ft=void 0;try{for(var ae=se[Symbol.iterator](),le;!(Ue=(le=ae.next()).done)&&(we.push(le.value),!(pe&&we.length===pe));Ue=!0);}catch(ce){Ke=!0,ft=ce}finally{try{!Ue&&ae.return&&ae.return()}finally{if(Ke)throw ft}}return we}return function(se,pe){if(Array.isArray(se))return se;if(Symbol.iterator in Object(se))return Y(se,pe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),K=.001,J=1,z=function(se,pe){return"data:"+se+","+encodeURIComponent(pe)},j=function(se,pe,we){return se+(pe-se)*we},G=function(){var Y=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return Y}}(),H=function(){var Y=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return Y}}(),te=function(){var Y=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return Y}}(),Z=function(){var Y=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return Y}}(),ee=function(){var Y=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),se=Y?parseInt(Y[1],10):null;return function(){return se}}(),oe=function(){var Y=!1;return Y=G()&&te()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return Y}}(),xe=function(){var Y=!1;if(ee()===65){var se=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(se){var pe=se[1].split("."),we=U(pe,4);we[0],we[1];var Ue=we[2],Ke=we[3];Y=parseInt(Ue,10)===3325&&parseInt(Ke,10)<148}}return function(){return Y}}(),Pe=function(){var Y=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return Y}}(),me=function(){var se=window.orientation==90||window.orientation==-90;return Pe()?!se:se},Ce=function(se){return!(isNaN(se)||se<=K||se>J)},Je=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Oe=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},$e=function(se){if(H())return!1;if(se.requestFullscreen)se.requestFullscreen();else if(se.webkitRequestFullscreen)se.webkitRequestFullscreen();else if(se.mozRequestFullScreen)se.mozRequestFullScreen();else if(se.msRequestFullscreen)se.msRequestFullscreen();else return!1;return!0},nt=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},gt=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Tt=function(se,pe,we,Ue){var Ke=se.createShader(se.VERTEX_SHADER);se.shaderSource(Ke,pe),se.compileShader(Ke);var ft=se.createShader(se.FRAGMENT_SHADER);se.shaderSource(ft,we),se.compileShader(ft);var ae=se.createProgram();se.attachShader(ae,Ke),se.attachShader(ae,ft);for(var le in Ue)se.bindAttribLocation(ae,Ue[le],le);return se.linkProgram(ae),se.deleteShader(Ke),se.deleteShader(ft),ae},Ze=function(se,pe){for(var we={},Ue=se.getProgramParameter(pe,se.ACTIVE_UNIFORMS),Ke="",ft=0;ft<Ue;ft++){var ae=se.getActiveUniform(pe,ft);Ke=ae.name.replace("[0]",""),we[Ke]=se.getUniformLocation(pe,Ke)}return we},mn=function(se,pe,we,Ue,Ke,ft,ae){var le=1/(pe-we),ce=1/(Ue-Ke),ge=1/(ft-ae);return se[0]=-2*le,se[1]=0,se[2]=0,se[3]=0,se[4]=0,se[5]=-2*ce,se[6]=0,se[7]=0,se[8]=0,se[9]=0,se[10]=2*ge,se[11]=0,se[12]=(pe+we)*le,se[13]=(Ke+Ue)*ce,se[14]=(ae+ft)*ge,se[15]=1,se},Ft=function(){var se=!1;return function(pe){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(pe)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(pe.substr(0,4)))&&(se=!0)}(navigator.userAgent||navigator.vendor||window.opera),se},Qt=function(se,pe){for(var we in pe)pe.hasOwnProperty(we)&&(se[we]=pe[we]);return se},Xt=function(se){if(G()){var pe=se.style.width,we=se.style.height;se.style.width=parseInt(pe)+1+"px",se.style.height=parseInt(we)+"px",setTimeout(function(){se.style.width=pe,se.style.height=we},100)}window.canvas=se},Tn=function(){var Y=Math.PI/180,se=Math.PI*.25;function pe(ce,ge,Ae,tt){var xt=Math.tan(ge?ge.upDegrees*Y:se),Dt=Math.tan(ge?ge.downDegrees*Y:se),Yt=Math.tan(ge?ge.leftDegrees*Y:se),on=Math.tan(ge?ge.rightDegrees*Y:se),kt=2/(Yt+on),bn=2/(xt+Dt);return ce[0]=kt,ce[1]=0,ce[2]=0,ce[3]=0,ce[4]=0,ce[5]=bn,ce[6]=0,ce[7]=0,ce[8]=-((Yt-on)*kt*.5),ce[9]=(xt-Dt)*bn*.5,ce[10]=tt/(Ae-tt),ce[11]=-1,ce[12]=0,ce[13]=0,ce[14]=tt*Ae/(Ae-tt),ce[15]=0,ce}function we(ce,ge,Ae){var tt=ge[0],xt=ge[1],Dt=ge[2],Yt=ge[3],on=tt+tt,kt=xt+xt,bn=Dt+Dt,oi=tt*on,Vn=tt*kt,Wn=tt*bn,Nn=xt*kt,ai=xt*bn,li=Dt*bn,xi=Yt*on,Bi=Yt*kt,hr=Yt*bn;return ce[0]=1-(Nn+li),ce[1]=Vn+hr,ce[2]=Wn-Bi,ce[3]=0,ce[4]=Vn-hr,ce[5]=1-(oi+li),ce[6]=ai+xi,ce[7]=0,ce[8]=Wn+Bi,ce[9]=ai-xi,ce[10]=1-(oi+Nn),ce[11]=0,ce[12]=Ae[0],ce[13]=Ae[1],ce[14]=Ae[2],ce[15]=1,ce}function Ue(ce,ge,Ae){var tt=Ae[0],xt=Ae[1],Dt=Ae[2],Yt,on,kt,bn,oi,Vn,Wn,Nn,ai,li,xi,Bi;return ge===ce?(ce[12]=ge[0]*tt+ge[4]*xt+ge[8]*Dt+ge[12],ce[13]=ge[1]*tt+ge[5]*xt+ge[9]*Dt+ge[13],ce[14]=ge[2]*tt+ge[6]*xt+ge[10]*Dt+ge[14],ce[15]=ge[3]*tt+ge[7]*xt+ge[11]*Dt+ge[15]):(Yt=ge[0],on=ge[1],kt=ge[2],bn=ge[3],oi=ge[4],Vn=ge[5],Wn=ge[6],Nn=ge[7],ai=ge[8],li=ge[9],xi=ge[10],Bi=ge[11],ce[0]=Yt,ce[1]=on,ce[2]=kt,ce[3]=bn,ce[4]=oi,ce[5]=Vn,ce[6]=Wn,ce[7]=Nn,ce[8]=ai,ce[9]=li,ce[10]=xi,ce[11]=Bi,ce[12]=Yt*tt+oi*xt+ai*Dt+ge[12],ce[13]=on*tt+Vn*xt+li*Dt+ge[13],ce[14]=kt*tt+Wn*xt+xi*Dt+ge[14],ce[15]=bn*tt+Nn*xt+Bi*Dt+ge[15]),ce}function Ke(ce,ge){var Ae=ge[0],tt=ge[1],xt=ge[2],Dt=ge[3],Yt=ge[4],on=ge[5],kt=ge[6],bn=ge[7],oi=ge[8],Vn=ge[9],Wn=ge[10],Nn=ge[11],ai=ge[12],li=ge[13],xi=ge[14],Bi=ge[15],hr=Ae*on-tt*Yt,Li=Ae*kt-xt*Yt,Fr=Ae*bn-Dt*Yt,bi=tt*kt-xt*on,eo=tt*bn-Dt*on,Kr=xt*bn-Dt*kt,qo=oi*li-Vn*ai,Ha=oi*xi-Wn*ai,ks=oi*Bi-Nn*ai,ja=Vn*xi-Wn*li,qr=Vn*Bi-Nn*li,Cr=Wn*Bi-Nn*xi,pr=hr*Cr-Li*qr+Fr*ja+bi*ks-eo*Ha+Kr*qo;return pr?(pr=1/pr,ce[0]=(on*Cr-kt*qr+bn*ja)*pr,ce[1]=(xt*qr-tt*Cr-Dt*ja)*pr,ce[2]=(li*Kr-xi*eo+Bi*bi)*pr,ce[3]=(Wn*eo-Vn*Kr-Nn*bi)*pr,ce[4]=(kt*ks-Yt*Cr-bn*Ha)*pr,ce[5]=(Ae*Cr-xt*ks+Dt*Ha)*pr,ce[6]=(xi*Fr-ai*Kr-Bi*Li)*pr,ce[7]=(oi*Kr-Wn*Fr+Nn*Li)*pr,ce[8]=(Yt*qr-on*ks+bn*qo)*pr,ce[9]=(tt*ks-Ae*qr-Dt*qo)*pr,ce[10]=(ai*eo-li*Fr+Bi*hr)*pr,ce[11]=(Vn*Fr-oi*eo-Nn*hr)*pr,ce[12]=(on*Ha-Yt*ja-kt*qo)*pr,ce[13]=(Ae*ja-tt*Ha+xt*qo)*pr,ce[14]=(li*Li-ai*bi-xi*hr)*pr,ce[15]=(oi*bi-Vn*Li+Wn*hr)*pr,ce):null}var ft=new Float32Array([0,0,0,1]),ae=new Float32Array([0,0,0]);function le(ce,ge,Ae,tt,xt,Dt){pe(ce,tt||null,Dt.depthNear,Dt.depthFar);var Yt=Ae.orientation||ft,on=Ae.position||ae;we(ge,Yt,on),xt&&Ue(ge,ge,xt),Ke(ge,ge)}return function(ce,ge,Ae){return!ce||!ge?!1:(ce.pose=ge,ce.timestamp=ge.timestamp,le(ce.leftProjectionMatrix,ce.leftViewMatrix,ge,Ae._getFieldOfView("left"),Ae._getEyeOffset("left"),Ae),le(ce.rightProjectionMatrix,ce.rightViewMatrix,ge,Ae._getFieldOfView("right"),Ae._getEyeOffset("right"),Ae),!0)}}(),vn=function(){var se=window.self!==window.top,pe=Fe(document.referrer),we=Fe(window.location.href);return se&&pe!==we},Fe=function(se){var pe,we=se.indexOf("://");we!==-1?pe=we+3:pe=0;var Ue=se.indexOf("/",pe);return Ue===-1&&(Ue=se.length),se.substring(0,Ue)},Te=function(se){if(se.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var pe=2*Math.acos(se.w);return pe},pt=function(){var Y={};return function(se,pe){Y[se]===void 0&&(console.warn("webvr-polyfill: "+pe),Y[se]=!0)}}(),Nt=function(se,pe){var we=pe?"Please use "+pe+" instead.":"";pt(se,se+" has been deprecated. This may not work on native WebVR displays. "+we)};function zt(Y,se,pe){if(!se){pe(Y);return}for(var we=[],Ue=null,Ke=0;Ke<se.length;++Ke){var ft=se[Ke];switch(ft){case Y.TEXTURE_BINDING_2D:case Y.TEXTURE_BINDING_CUBE_MAP:var ae=se[++Ke];if(ae<Y.TEXTURE0||ae>Y.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),we.push(null,null);break}Ue||(Ue=Y.getParameter(Y.ACTIVE_TEXTURE)),Y.activeTexture(ae),we.push(Y.getParameter(ft),null);break;case Y.ACTIVE_TEXTURE:Ue=Y.getParameter(Y.ACTIVE_TEXTURE),we.push(null);break;default:we.push(Y.getParameter(ft));break}}pe(Y);for(var Ke=0;Ke<se.length;++Ke){var ft=se[Ke],le=we[Ke];switch(ft){case Y.ACTIVE_TEXTURE:break;case Y.ARRAY_BUFFER_BINDING:Y.bindBuffer(Y.ARRAY_BUFFER,le);break;case Y.COLOR_CLEAR_VALUE:Y.clearColor(le[0],le[1],le[2],le[3]);break;case Y.COLOR_WRITEMASK:Y.colorMask(le[0],le[1],le[2],le[3]);break;case Y.CURRENT_PROGRAM:Y.useProgram(le);break;case Y.ELEMENT_ARRAY_BUFFER_BINDING:Y.bindBuffer(Y.ELEMENT_ARRAY_BUFFER,le);break;case Y.FRAMEBUFFER_BINDING:Y.bindFramebuffer(Y.FRAMEBUFFER,le);break;case Y.RENDERBUFFER_BINDING:Y.bindRenderbuffer(Y.RENDERBUFFER,le);break;case Y.TEXTURE_BINDING_2D:var ae=se[++Ke];if(ae<Y.TEXTURE0||ae>Y.TEXTURE31)break;Y.activeTexture(ae),Y.bindTexture(Y.TEXTURE_2D,le);break;case Y.TEXTURE_BINDING_CUBE_MAP:var ae=se[++Ke];if(ae<Y.TEXTURE0||ae>Y.TEXTURE31)break;Y.activeTexture(ae),Y.bindTexture(Y.TEXTURE_CUBE_MAP,le);break;case Y.VIEWPORT:Y.viewport(le[0],le[1],le[2],le[3]);break;case Y.BLEND:case Y.CULL_FACE:case Y.DEPTH_TEST:case Y.SCISSOR_TEST:case Y.STENCIL_TEST:le?Y.enable(ft):Y.disable(ft);break;default:console.log("No GL restore behavior for 0x"+ft.toString(16));break}Ue&&Y.activeTexture(Ue)}}var Vt=zt,fn=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),mt=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function Ee(Y,se,pe,we){this.gl=Y,this.cardboardUI=se,this.bufferScale=pe,this.dirtySubmitFrameBindings=we,this.ctxAttribs=Y.getContextAttributes(),this.instanceExt=Y.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=Y.drawingBufferWidth,this.bufferHeight=Y.drawingBufferHeight,this.realBindFramebuffer=Y.bindFramebuffer,this.realEnable=Y.enable,this.realDisable=Y.disable,this.realColorMask=Y.colorMask,this.realClearColor=Y.clearColor,this.realViewport=Y.viewport,G()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(Y.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(Y.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Tt(Y,fn,mt,this.attribs),this.uniforms=Ze(Y,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=Y.createBuffer(),this.indexBuffer=Y.createBuffer(),this.indexCount=0,this.renderTarget=Y.createTexture(),this.framebuffer=Y.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=Y.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=Y.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=Y.createRenderbuffer()),this.patch(),this.onResize()}Ee.prototype.destroy=function(){var Y=this.gl;this.unpatch(),Y.deleteProgram(this.program),Y.deleteBuffer(this.vertexBuffer),Y.deleteBuffer(this.indexBuffer),Y.deleteTexture(this.renderTarget),Y.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&Y.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&Y.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&Y.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},Ee.prototype.onResize=function(){var Y=this.gl,se=this,pe=[Y.RENDERBUFFER_BINDING,Y.TEXTURE_BINDING_2D,Y.TEXTURE0];Vt(Y,pe,function(we){se.realBindFramebuffer.call(we,we.FRAMEBUFFER,null),se.scissorTest&&se.realDisable.call(we,we.SCISSOR_TEST),se.realColorMask.call(we,!0,!0,!0,!0),se.realViewport.call(we,0,0,we.drawingBufferWidth,we.drawingBufferHeight),se.realClearColor.call(we,0,0,0,1),we.clear(we.COLOR_BUFFER_BIT),se.realBindFramebuffer.call(we,we.FRAMEBUFFER,se.framebuffer),we.bindTexture(we.TEXTURE_2D,se.renderTarget),we.texImage2D(we.TEXTURE_2D,0,se.ctxAttribs.alpha?we.RGBA:we.RGB,se.bufferWidth,se.bufferHeight,0,se.ctxAttribs.alpha?we.RGBA:we.RGB,we.UNSIGNED_BYTE,null),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MAG_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,se.renderTarget,0),se.ctxAttribs.depth&&se.ctxAttribs.stencil?(we.bindRenderbuffer(we.RENDERBUFFER,se.depthStencilBuffer),we.renderbufferStorage(we.RENDERBUFFER,we.DEPTH_STENCIL,se.bufferWidth,se.bufferHeight),we.framebufferRenderbuffer(we.FRAMEBUFFER,we.DEPTH_STENCIL_ATTACHMENT,we.RENDERBUFFER,se.depthStencilBuffer)):se.ctxAttribs.depth?(we.bindRenderbuffer(we.RENDERBUFFER,se.depthBuffer),we.renderbufferStorage(we.RENDERBUFFER,we.DEPTH_COMPONENT16,se.bufferWidth,se.bufferHeight),we.framebufferRenderbuffer(we.FRAMEBUFFER,we.DEPTH_ATTACHMENT,we.RENDERBUFFER,se.depthBuffer)):se.ctxAttribs.stencil&&(we.bindRenderbuffer(we.RENDERBUFFER,se.stencilBuffer),we.renderbufferStorage(we.RENDERBUFFER,we.STENCIL_INDEX8,se.bufferWidth,se.bufferHeight),we.framebufferRenderbuffer(we.FRAMEBUFFER,we.STENCIL_ATTACHMENT,we.RENDERBUFFER,se.stencilBuffer)),!we.checkFramebufferStatus(we.FRAMEBUFFER)===we.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),se.realBindFramebuffer.call(we,we.FRAMEBUFFER,se.lastBoundFramebuffer),se.scissorTest&&se.realEnable.call(we,we.SCISSOR_TEST),se.realColorMask.apply(we,se.colorMask),se.realViewport.apply(we,se.viewport),se.realClearColor.apply(we,se.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},Ee.prototype.patch=function(){if(!this.isPatched){var Y=this,se=this.gl.canvas,pe=this.gl;G()||(se.width=Je()*this.bufferScale,se.height=Oe()*this.bufferScale,Object.defineProperty(se,"width",{configurable:!0,enumerable:!0,get:function(){return Y.bufferWidth},set:function(Ue){Y.bufferWidth=Ue,Y.realCanvasWidth.set.call(se,Ue),Y.onResize()}}),Object.defineProperty(se,"height",{configurable:!0,enumerable:!0,get:function(){return Y.bufferHeight},set:function(Ue){Y.bufferHeight=Ue,Y.realCanvasHeight.set.call(se,Ue),Y.onResize()}})),this.lastBoundFramebuffer=pe.getParameter(pe.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(pe.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(we,Ue){Y.lastBoundFramebuffer=Ue||Y.framebuffer,Y.realBindFramebuffer.call(pe,we,Y.lastBoundFramebuffer)},this.cullFace=pe.getParameter(pe.CULL_FACE),this.depthTest=pe.getParameter(pe.DEPTH_TEST),this.blend=pe.getParameter(pe.BLEND),this.scissorTest=pe.getParameter(pe.SCISSOR_TEST),this.stencilTest=pe.getParameter(pe.STENCIL_TEST),pe.enable=function(we){switch(we){case pe.CULL_FACE:Y.cullFace=!0;break;case pe.DEPTH_TEST:Y.depthTest=!0;break;case pe.BLEND:Y.blend=!0;break;case pe.SCISSOR_TEST:Y.scissorTest=!0;break;case pe.STENCIL_TEST:Y.stencilTest=!0;break}Y.realEnable.call(pe,we)},pe.disable=function(we){switch(we){case pe.CULL_FACE:Y.cullFace=!1;break;case pe.DEPTH_TEST:Y.depthTest=!1;break;case pe.BLEND:Y.blend=!1;break;case pe.SCISSOR_TEST:Y.scissorTest=!1;break;case pe.STENCIL_TEST:Y.stencilTest=!1;break}Y.realDisable.call(pe,we)},this.colorMask=pe.getParameter(pe.COLOR_WRITEMASK),pe.colorMask=function(we,Ue,Ke,ft){Y.colorMask[0]=we,Y.colorMask[1]=Ue,Y.colorMask[2]=Ke,Y.colorMask[3]=ft,Y.realColorMask.call(pe,we,Ue,Ke,ft)},this.clearColor=pe.getParameter(pe.COLOR_CLEAR_VALUE),pe.clearColor=function(we,Ue,Ke,ft){Y.clearColor[0]=we,Y.clearColor[1]=Ue,Y.clearColor[2]=Ke,Y.clearColor[3]=ft,Y.realClearColor.call(pe,we,Ue,Ke,ft)},this.viewport=pe.getParameter(pe.VIEWPORT),pe.viewport=function(we,Ue,Ke,ft){Y.viewport[0]=we,Y.viewport[1]=Ue,Y.viewport[2]=Ke,Y.viewport[3]=ft,Y.realViewport.call(pe,we,Ue,Ke,ft)},this.isPatched=!0,Xt(se)}},Ee.prototype.unpatch=function(){if(this.isPatched){var Y=this.gl,se=this.gl.canvas;G()||(Object.defineProperty(se,"width",this.realCanvasWidth),Object.defineProperty(se,"height",this.realCanvasHeight)),se.width=this.bufferWidth,se.height=this.bufferHeight,Y.bindFramebuffer=this.realBindFramebuffer,Y.enable=this.realEnable,Y.disable=this.realDisable,Y.colorMask=this.realColorMask,Y.clearColor=this.realClearColor,Y.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&Y.bindFramebuffer(Y.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){Xt(se)},1)}},Ee.prototype.setTextureBounds=function(Y,se){Y||(Y=[0,0,.5,1]),se||(se=[.5,0,.5,1]),this.viewportOffsetScale[0]=Y[0],this.viewportOffsetScale[1]=Y[1],this.viewportOffsetScale[2]=Y[2],this.viewportOffsetScale[3]=Y[3],this.viewportOffsetScale[4]=se[0],this.viewportOffsetScale[5]=se[1],this.viewportOffsetScale[6]=se[2],this.viewportOffsetScale[7]=se[3]},Ee.prototype.submitFrame=function(){var Y=this.gl,se=this,pe=[];if(this.dirtySubmitFrameBindings||pe.push(Y.CURRENT_PROGRAM,Y.ARRAY_BUFFER_BINDING,Y.ELEMENT_ARRAY_BUFFER_BINDING,Y.TEXTURE_BINDING_2D,Y.TEXTURE0),Vt(Y,pe,function(Ue){se.realBindFramebuffer.call(Ue,Ue.FRAMEBUFFER,null);var Ke=0,ft=0;se.instanceExt&&(Ke=Ue.getVertexAttrib(se.attribs.position,se.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),ft=Ue.getVertexAttrib(se.attribs.texCoord,se.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),se.cullFace&&se.realDisable.call(Ue,Ue.CULL_FACE),se.depthTest&&se.realDisable.call(Ue,Ue.DEPTH_TEST),se.blend&&se.realDisable.call(Ue,Ue.BLEND),se.scissorTest&&se.realDisable.call(Ue,Ue.SCISSOR_TEST),se.stencilTest&&se.realDisable.call(Ue,Ue.STENCIL_TEST),se.realColorMask.call(Ue,!0,!0,!0,!0),se.realViewport.call(Ue,0,0,Ue.drawingBufferWidth,Ue.drawingBufferHeight),(se.ctxAttribs.alpha||G())&&(se.realClearColor.call(Ue,0,0,0,1),Ue.clear(Ue.COLOR_BUFFER_BIT)),Ue.useProgram(se.program),Ue.bindBuffer(Ue.ELEMENT_ARRAY_BUFFER,se.indexBuffer),Ue.bindBuffer(Ue.ARRAY_BUFFER,se.vertexBuffer),Ue.enableVertexAttribArray(se.attribs.position),Ue.enableVertexAttribArray(se.attribs.texCoord),Ue.vertexAttribPointer(se.attribs.position,2,Ue.FLOAT,!1,20,0),Ue.vertexAttribPointer(se.attribs.texCoord,3,Ue.FLOAT,!1,20,8),se.instanceExt&&(Ke!=0&&se.instanceExt.vertexAttribDivisorANGLE(se.attribs.position,0),ft!=0&&se.instanceExt.vertexAttribDivisorANGLE(se.attribs.texCoord,0)),Ue.activeTexture(Ue.TEXTURE0),Ue.uniform1i(se.uniforms.diffuse,0),Ue.bindTexture(Ue.TEXTURE_2D,se.renderTarget),Ue.uniform4fv(se.uniforms.viewportOffsetScale,se.viewportOffsetScale),Ue.drawElements(Ue.TRIANGLES,se.indexCount,Ue.UNSIGNED_SHORT,0),se.cardboardUI&&se.cardboardUI.renderNoState(),se.realBindFramebuffer.call(se.gl,Ue.FRAMEBUFFER,se.framebuffer),se.ctxAttribs.preserveDrawingBuffer||(se.realClearColor.call(Ue,0,0,0,0),Ue.clear(Ue.COLOR_BUFFER_BIT)),se.dirtySubmitFrameBindings||se.realBindFramebuffer.call(Ue,Ue.FRAMEBUFFER,se.lastBoundFramebuffer),se.cullFace&&se.realEnable.call(Ue,Ue.CULL_FACE),se.depthTest&&se.realEnable.call(Ue,Ue.DEPTH_TEST),se.blend&&se.realEnable.call(Ue,Ue.BLEND),se.scissorTest&&se.realEnable.call(Ue,Ue.SCISSOR_TEST),se.stencilTest&&se.realEnable.call(Ue,Ue.STENCIL_TEST),se.realColorMask.apply(Ue,se.colorMask),se.realViewport.apply(Ue,se.viewport),(se.ctxAttribs.alpha||!se.ctxAttribs.preserveDrawingBuffer)&&se.realClearColor.apply(Ue,se.clearColor),se.instanceExt&&(Ke!=0&&se.instanceExt.vertexAttribDivisorANGLE(se.attribs.position,Ke),ft!=0&&se.instanceExt.vertexAttribDivisorANGLE(se.attribs.texCoord,ft))}),G()){var we=Y.canvas;(we.width!=se.bufferWidth||we.height!=se.bufferHeight)&&(se.bufferWidth=we.width,se.bufferHeight=we.height,se.onResize())}},Ee.prototype.updateDeviceInfo=function(Y){var se=this.gl,pe=this,we=[se.ARRAY_BUFFER_BINDING,se.ELEMENT_ARRAY_BUFFER_BINDING];Vt(se,we,function(Ue){var Ke=pe.computeMeshVertices_(pe.meshWidth,pe.meshHeight,Y);if(Ue.bindBuffer(Ue.ARRAY_BUFFER,pe.vertexBuffer),Ue.bufferData(Ue.ARRAY_BUFFER,Ke,Ue.STATIC_DRAW),!pe.indexCount){var ft=pe.computeMeshIndices_(pe.meshWidth,pe.meshHeight);Ue.bindBuffer(Ue.ELEMENT_ARRAY_BUFFER,pe.indexBuffer),Ue.bufferData(Ue.ELEMENT_ARRAY_BUFFER,ft,Ue.STATIC_DRAW),pe.indexCount=ft.length}})},Ee.prototype.computeMeshVertices_=function(Y,se,pe){for(var we=new Float32Array(2*Y*se*5),Ue=pe.getLeftEyeVisibleTanAngles(),Ke=pe.getLeftEyeNoLensTanAngles(),ft=pe.getLeftEyeVisibleScreenRect(Ke),ae=0,le=0;le<2;le++){for(var ce=0;ce<se;ce++)for(var ge=0;ge<Y;ge++,ae++){var Ae=ge/(Y-1),tt=ce/(se-1),xt=Ae,Dt=tt,Yt=j(Ue[0],Ue[2],Ae),on=j(Ue[3],Ue[1],tt),kt=Math.sqrt(Yt*Yt+on*on),bn=pe.distortion.distortInverse(kt),oi=Yt*bn/kt,Vn=on*bn/kt;Ae=(oi-Ke[0])/(Ke[2]-Ke[0]),tt=(Vn-Ke[3])/(Ke[1]-Ke[3]),Ae=(ft.x+Ae*ft.width-.5)*2,tt=(ft.y+tt*ft.height-.5)*2,we[ae*5+0]=Ae,we[ae*5+1]=tt,we[ae*5+2]=xt,we[ae*5+3]=Dt,we[ae*5+4]=le}var Wn=Ue[2]-Ue[0];Ue[0]=-(Wn+Ue[0]),Ue[2]=Wn-Ue[2],Wn=Ke[2]-Ke[0],Ke[0]=-(Wn+Ke[0]),Ke[2]=Wn-Ke[2],ft.x=1-(ft.x+ft.width)}return we},Ee.prototype.computeMeshIndices_=function(Y,se){for(var pe=new Uint16Array(2*(Y-1)*(se-1)*6),we=Y/2,Ue=se/2,Ke=0,ft=0,ae=0;ae<2;ae++)for(var le=0;le<se;le++)for(var ce=0;ce<Y;ce++,Ke++)ce==0||le==0||(ce<=we==le<=Ue?(pe[ft++]=Ke,pe[ft++]=Ke-Y-1,pe[ft++]=Ke-Y,pe[ft++]=Ke-Y-1,pe[ft++]=Ke,pe[ft++]=Ke-1):(pe[ft++]=Ke-1,pe[ft++]=Ke-Y,pe[ft++]=Ke,pe[ft++]=Ke-Y,pe[ft++]=Ke-1,pe[ft++]=Ke-Y-1));return pe},Ee.prototype.getOwnPropertyDescriptor_=function(Y,se){var pe=Object.getOwnPropertyDescriptor(Y,se);return(pe.get===void 0||pe.set===void 0)&&(pe.configurable=!0,pe.enumerable=!0,pe.get=function(){return this.getAttribute(se)},pe.set=function(we){this.setAttribute(se,we)}),pe};var _e=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),Ne=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),ye=Math.PI/180,De=60,ke=12,Ye=20,Qe=1,ne=.75,W=.3125,k=4,he=28,Re=1.5;function We(Y){this.gl=Y,this.attribs={position:0},this.program=Tt(Y,_e,Ne,this.attribs),this.uniforms=Ze(Y,this.program),this.vertexBuffer=Y.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}We.prototype.destroy=function(){var Y=this.gl;this.listener&&Y.canvas.removeEventListener("click",this.listener,!1),Y.deleteProgram(this.program),Y.deleteBuffer(this.vertexBuffer)},We.prototype.listen=function(Y,se){var pe=this.gl.canvas;this.listener=function(we){var Ue=pe.clientWidth/2,Ke=he*Re;we.clientX>Ue-Ke&&we.clientX<Ue+Ke&&we.clientY>pe.clientHeight-Ke?Y(we):we.clientX<Ke&&we.clientY<Ke&&se(we)},pe.addEventListener("click",this.listener,!1)},We.prototype.onResize=function(){var Y=this.gl,se=this,pe=[Y.ARRAY_BUFFER_BINDING];Vt(Y,pe,function(we){var Ue=[],Ke=we.drawingBufferWidth/2,ft=Math.max(screen.width,screen.height)*window.devicePixelRatio,ae=we.drawingBufferWidth/ft,le=ae*window.devicePixelRatio,ce=k*le/2,ge=he*Re*le,Ae=he*le/2,tt=(he*Re-he)*le;Ue.push(Ke-ce,ge),Ue.push(Ke-ce,we.drawingBufferHeight),Ue.push(Ke+ce,ge),Ue.push(Ke+ce,we.drawingBufferHeight),se.gearOffset=Ue.length/2;function xt(bn,oi){var Vn=(90-bn)*ye,Wn=Math.cos(Vn),Nn=Math.sin(Vn);Ue.push(W*Wn*Ae+Ke,W*Nn*Ae+Ae),Ue.push(oi*Wn*Ae+Ke,oi*Nn*Ae+Ae)}for(var Dt=0;Dt<=6;Dt++){var Yt=Dt*De;xt(Yt,Qe),xt(Yt+ke,Qe),xt(Yt+Ye,ne),xt(Yt+(De-Ye),ne),xt(Yt+(De-ke),Qe)}se.gearVertexCount=Ue.length/2-se.gearOffset,se.arrowOffset=Ue.length/2;function on(bn,oi){Ue.push(tt+bn,we.drawingBufferHeight-tt-oi)}var kt=ce/Math.sin(45*ye);on(0,Ae),on(Ae,0),on(Ae+kt,kt),on(kt,Ae+kt),on(kt,Ae-kt),on(0,Ae),on(Ae,Ae*2),on(Ae+kt,Ae*2-kt),on(kt,Ae-kt),on(0,Ae),on(kt,Ae-ce),on(he*le,Ae-ce),on(kt,Ae+ce),on(he*le,Ae+ce),se.arrowVertexCount=Ue.length/2-se.arrowOffset,we.bindBuffer(we.ARRAY_BUFFER,se.vertexBuffer),we.bufferData(we.ARRAY_BUFFER,new Float32Array(Ue),we.STATIC_DRAW)})},We.prototype.render=function(){var Y=this.gl,se=this,pe=[Y.CULL_FACE,Y.DEPTH_TEST,Y.BLEND,Y.SCISSOR_TEST,Y.STENCIL_TEST,Y.COLOR_WRITEMASK,Y.VIEWPORT,Y.CURRENT_PROGRAM,Y.ARRAY_BUFFER_BINDING];Vt(Y,pe,function(we){we.disable(we.CULL_FACE),we.disable(we.DEPTH_TEST),we.disable(we.BLEND),we.disable(we.SCISSOR_TEST),we.disable(we.STENCIL_TEST),we.colorMask(!0,!0,!0,!0),we.viewport(0,0,we.drawingBufferWidth,we.drawingBufferHeight),se.renderNoState()})},We.prototype.renderNoState=function(){var Y=this.gl;Y.useProgram(this.program),Y.bindBuffer(Y.ARRAY_BUFFER,this.vertexBuffer),Y.enableVertexAttribArray(this.attribs.position),Y.vertexAttribPointer(this.attribs.position,2,Y.FLOAT,!1,8,0),Y.uniform4f(this.uniforms.color,1,1,1,1),mn(this.projMat,0,Y.drawingBufferWidth,0,Y.drawingBufferHeight,.1,1024),Y.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),Y.drawArrays(Y.TRIANGLE_STRIP,0,4),Y.drawArrays(Y.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),Y.drawArrays(Y.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function ve(Y){this.coefficients=Y}ve.prototype.distortInverse=function(Y){for(var se=0,pe=1,we=Y-this.distort(se);Math.abs(pe-se)>1e-4;){var Ue=Y-this.distort(pe),Ke=pe-Ue*((pe-se)/(Ue-we));se=pe,pe=Ke,we=Ue}return pe},ve.prototype.distort=function(Y){for(var se=Y*Y,pe=0,we=0;we<this.coefficients.length;we++)pe=se*(pe+this.coefficients[we]);return(pe+1)*Y};var at=Math.PI/180,At=180/Math.PI,Ct=function(se,pe,we){this.x=se||0,this.y=pe||0,this.z=we||0};Ct.prototype={constructor:Ct,set:function(se,pe,we){return this.x=se,this.y=pe,this.z=we,this},copy:function(se){return this.x=se.x,this.y=se.y,this.z=se.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var se=this.length();if(se!==0){var pe=1/se;this.multiplyScalar(pe)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(se){this.x*=se,this.y*=se,this.z*=se},applyQuaternion:function(se){var pe=this.x,we=this.y,Ue=this.z,Ke=se.x,ft=se.y,ae=se.z,le=se.w,ce=le*pe+ft*Ue-ae*we,ge=le*we+ae*pe-Ke*Ue,Ae=le*Ue+Ke*we-ft*pe,tt=-Ke*pe-ft*we-ae*Ue;return this.x=ce*le+tt*-Ke+ge*-ae-Ae*-ft,this.y=ge*le+tt*-ft+Ae*-Ke-ce*-ae,this.z=Ae*le+tt*-ae+ce*-ft-ge*-Ke,this},dot:function(se){return this.x*se.x+this.y*se.y+this.z*se.z},crossVectors:function(se,pe){var we=se.x,Ue=se.y,Ke=se.z,ft=pe.x,ae=pe.y,le=pe.z;return this.x=Ue*le-Ke*ae,this.y=Ke*ft-we*le,this.z=we*ae-Ue*ft,this}};var Pt=function(se,pe,we,Ue){this.x=se||0,this.y=pe||0,this.z=we||0,this.w=Ue!==void 0?Ue:1};Pt.prototype={constructor:Pt,set:function(se,pe,we,Ue){return this.x=se,this.y=pe,this.z=we,this.w=Ue,this},copy:function(se){return this.x=se.x,this.y=se.y,this.z=se.z,this.w=se.w,this},setFromEulerXYZ:function(se,pe,we){var Ue=Math.cos(se/2),Ke=Math.cos(pe/2),ft=Math.cos(we/2),ae=Math.sin(se/2),le=Math.sin(pe/2),ce=Math.sin(we/2);return this.x=ae*Ke*ft+Ue*le*ce,this.y=Ue*le*ft-ae*Ke*ce,this.z=Ue*Ke*ce+ae*le*ft,this.w=Ue*Ke*ft-ae*le*ce,this},setFromEulerYXZ:function(se,pe,we){var Ue=Math.cos(se/2),Ke=Math.cos(pe/2),ft=Math.cos(we/2),ae=Math.sin(se/2),le=Math.sin(pe/2),ce=Math.sin(we/2);return this.x=ae*Ke*ft+Ue*le*ce,this.y=Ue*le*ft-ae*Ke*ce,this.z=Ue*Ke*ce-ae*le*ft,this.w=Ue*Ke*ft+ae*le*ce,this},setFromAxisAngle:function(se,pe){var we=pe/2,Ue=Math.sin(we);return this.x=se.x*Ue,this.y=se.y*Ue,this.z=se.z*Ue,this.w=Math.cos(we),this},multiply:function(se){return this.multiplyQuaternions(this,se)},multiplyQuaternions:function(se,pe){var we=se.x,Ue=se.y,Ke=se.z,ft=se.w,ae=pe.x,le=pe.y,ce=pe.z,ge=pe.w;return this.x=we*ge+ft*ae+Ue*ce-Ke*le,this.y=Ue*ge+ft*le+Ke*ae-we*ce,this.z=Ke*ge+ft*ce+we*le-Ue*ae,this.w=ft*ge-we*ae-Ue*le-Ke*ce,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var se=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return se===0?(this.x=0,this.y=0,this.z=0,this.w=1):(se=1/se,this.x=this.x*se,this.y=this.y*se,this.z=this.z*se,this.w=this.w*se),this},slerp:function(se,pe){if(pe===0)return this;if(pe===1)return this.copy(se);var we=this.x,Ue=this.y,Ke=this.z,ft=this.w,ae=ft*se.w+we*se.x+Ue*se.y+Ke*se.z;if(ae<0?(this.w=-se.w,this.x=-se.x,this.y=-se.y,this.z=-se.z,ae=-ae):this.copy(se),ae>=1)return this.w=ft,this.x=we,this.y=Ue,this.z=Ke,this;var le=Math.acos(ae),ce=Math.sqrt(1-ae*ae);if(Math.abs(ce)<.001)return this.w=.5*(ft+this.w),this.x=.5*(we+this.x),this.y=.5*(Ue+this.y),this.z=.5*(Ke+this.z),this;var ge=Math.sin((1-pe)*le)/ce,Ae=Math.sin(pe*le)/ce;return this.w=ft*ge+this.w*Ae,this.x=we*ge+this.x*Ae,this.y=Ue*ge+this.y*Ae,this.z=Ke*ge+this.z*Ae,this},setFromUnitVectors:function(){var Y,se,pe=1e-6;return function(we,Ue){return Y===void 0&&(Y=new Ct),se=we.dot(Ue)+1,se<pe?(se=0,Math.abs(we.x)>Math.abs(we.z)?Y.set(-we.y,we.x,0):Y.set(0,-we.z,we.y)):Y.crossVectors(we,Ue),this.x=Y.x,this.y=Y.y,this.z=Y.z,this.w=se,this.normalize(),this}}()};function $t(Y){this.width=Y.width||Je(),this.height=Y.height||Oe(),this.widthMeters=Y.widthMeters,this.heightMeters=Y.heightMeters,this.bevelMeters=Y.bevelMeters}var Bn=new $t({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),pi=new $t({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Ri={CardboardV1:new sn({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new sn({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Fn(Y,se){this.viewer=Ri.CardboardV2,this.updateDeviceParams(Y),this.distortion=new ve(this.viewer.distortionCoefficients);for(var pe=0;pe<se.length;pe++){var we=se[pe];Ri[we.id]=new sn(we)}}Fn.prototype.updateDeviceParams=function(Y){this.device=this.determineDevice_(Y)||this.device},Fn.prototype.getDevice=function(){return this.device},Fn.prototype.setViewer=function(Y){this.viewer=Y,this.distortion=new ve(this.viewer.distortionCoefficients)},Fn.prototype.determineDevice_=function(Y){if(!Y)return G()?(console.warn("Using fallback iOS device measurements."),pi):(console.warn("Using fallback Android device measurements."),Bn);var se=.0254,pe=se/Y.xdpi,we=se/Y.ydpi,Ue=Je(),Ke=Oe();return new $t({widthMeters:pe*Ue,heightMeters:we*Ke,bevelMeters:Y.bevelMm*.001})},Fn.prototype.getDistortedFieldOfViewLeftEye=function(){var Y=this.viewer,se=this.device,pe=this.distortion,we=Y.screenLensDistance,Ue=(se.widthMeters-Y.interLensDistance)/2,Ke=Y.interLensDistance/2,ft=Y.baselineLensDistance-se.bevelMeters,ae=se.heightMeters-ft,le=At*Math.atan(pe.distort(Ue/we)),ce=At*Math.atan(pe.distort(Ke/we)),ge=At*Math.atan(pe.distort(ft/we)),Ae=At*Math.atan(pe.distort(ae/we));return{leftDegrees:Math.min(le,Y.fov),rightDegrees:Math.min(ce,Y.fov),downDegrees:Math.min(ge,Y.fov),upDegrees:Math.min(Ae,Y.fov)}},Fn.prototype.getLeftEyeVisibleTanAngles=function(){var Y=this.viewer,se=this.device,pe=this.distortion,we=Math.tan(-at*Y.fov),Ue=Math.tan(at*Y.fov),Ke=Math.tan(at*Y.fov),ft=Math.tan(-at*Y.fov),ae=se.widthMeters/4,le=se.heightMeters/2,ce=Y.baselineLensDistance-se.bevelMeters-le,ge=Y.interLensDistance/2-ae,Ae=-ce,tt=Y.screenLensDistance,xt=pe.distort((ge-ae)/tt),Dt=pe.distort((Ae+le)/tt),Yt=pe.distort((ge+ae)/tt),on=pe.distort((Ae-le)/tt),kt=new Float32Array(4);return kt[0]=Math.max(we,xt),kt[1]=Math.min(Ue,Dt),kt[2]=Math.min(Ke,Yt),kt[3]=Math.max(ft,on),kt},Fn.prototype.getLeftEyeNoLensTanAngles=function(){var Y=this.viewer,se=this.device,pe=this.distortion,we=new Float32Array(4),Ue=pe.distortInverse(Math.tan(-at*Y.fov)),Ke=pe.distortInverse(Math.tan(at*Y.fov)),ft=pe.distortInverse(Math.tan(at*Y.fov)),ae=pe.distortInverse(Math.tan(-at*Y.fov)),le=se.widthMeters/4,ce=se.heightMeters/2,ge=Y.baselineLensDistance-se.bevelMeters-ce,Ae=Y.interLensDistance/2-le,tt=-ge,xt=Y.screenLensDistance,Dt=(Ae-le)/xt,Yt=(tt+ce)/xt,on=(Ae+le)/xt,kt=(tt-ce)/xt;return we[0]=Math.max(Ue,Dt),we[1]=Math.min(Ke,Yt),we[2]=Math.min(ft,on),we[3]=Math.max(ae,kt),we},Fn.prototype.getLeftEyeVisibleScreenRect=function(Y){var se=this.viewer,pe=this.device,we=se.screenLensDistance,Ue=(pe.widthMeters-se.interLensDistance)/2,Ke=se.baselineLensDistance-pe.bevelMeters,ft=(Y[0]*we+Ue)/pe.widthMeters,ae=(Y[1]*we+Ke)/pe.heightMeters,le=(Y[2]*we+Ue)/pe.widthMeters,ce=(Y[3]*we+Ke)/pe.heightMeters;return{x:ft,y:ce,width:le-ft,height:ae-ce}},Fn.prototype.getFieldOfViewLeftEye=function(Y){return Y?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Fn.prototype.getFieldOfViewRightEye=function(Y){var se=this.getFieldOfViewLeftEye(Y);return{leftDegrees:se.rightDegrees,rightDegrees:se.leftDegrees,upDegrees:se.upDegrees,downDegrees:se.downDegrees}},Fn.prototype.getUndistortedFieldOfViewLeftEye=function(){var Y=this.getUndistortedParams_();return{leftDegrees:At*Math.atan(Y.outerDist),rightDegrees:At*Math.atan(Y.innerDist),downDegrees:At*Math.atan(Y.bottomDist),upDegrees:At*Math.atan(Y.topDist)}},Fn.prototype.getUndistortedViewportLeftEye=function(){var Y=this.getUndistortedParams_(),se=this.viewer,pe=this.device,we=se.screenLensDistance,Ue=pe.widthMeters/we,Ke=pe.heightMeters/we,ft=pe.width/Ue,ae=pe.height/Ke,le=Math.round((Y.eyePosX-Y.outerDist)*ft),ce=Math.round((Y.eyePosY-Y.bottomDist)*ae);return{x:le,y:ce,width:Math.round((Y.eyePosX+Y.innerDist)*ft)-le,height:Math.round((Y.eyePosY+Y.topDist)*ae)-ce}},Fn.prototype.getUndistortedParams_=function(){var Y=this.viewer,se=this.device,pe=this.distortion,we=Y.screenLensDistance,Ue=Y.interLensDistance/2/we,Ke=se.widthMeters/we,ft=se.heightMeters/we,ae=Ke/2-Ue,le=(Y.baselineLensDistance-se.bevelMeters)/we,ce=Y.fov,ge=pe.distortInverse(Math.tan(at*ce)),Ae=Math.min(ae,ge),tt=Math.min(Ue,ge),xt=Math.min(le,ge),Dt=Math.min(ft-le,ge);return{outerDist:Ae,innerDist:tt,topDist:Dt,bottomDist:xt,eyePosX:ae,eyePosY:le}};function sn(Y){this.id=Y.id,this.label=Y.label,this.fov=Y.fov,this.interLensDistance=Y.interLensDistance,this.baselineLensDistance=Y.baselineLensDistance,this.screenLensDistance=Y.screenLensDistance,this.distortionCoefficients=Y.distortionCoefficients,this.inverseCoefficients=Y.inverseCoefficients}Fn.Viewers=Ri;var Rt=1,gn="2019-11-09T17:36:14Z",si=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Ln={format:Rt,last_updated:gn,devices:si};function Jn(Y,se){if(this.dpdb=Ln,this.recalculateDeviceParams_(),Y){this.onDeviceParamsUpdated=se;var pe=new XMLHttpRequest,we=this;pe.open("GET",Y,!0),pe.addEventListener("load",function(){we.loading=!1,pe.status>=200&&pe.status<=299?(we.dpdb=JSON.parse(pe.response),we.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),pe.send()}}Jn.prototype.getDeviceParams=function(){return this.deviceParams},Jn.prototype.recalculateDeviceParams_=function(){var Y=this.calcDeviceParams_();Y?(this.deviceParams=Y,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Jn.prototype.calcDeviceParams_=function(){var Y=this.dpdb;if(!Y)return console.error("DPDB not available."),null;if(Y.format!=1)return console.error("DPDB has unexpected format version."),null;if(!Y.devices||!Y.devices.length)return console.error("DPDB does not have a devices section."),null;var se=navigator.userAgent||navigator.vendor||window.opera,pe=Je(),we=Oe();if(!Y.devices)return console.error("DPDB has no devices section."),null;for(var Ue=0;Ue<Y.devices.length;Ue++){var Ke=Y.devices[Ue];if(!Ke.rules){console.warn("Device["+Ue+"] has no rules section.");continue}if(Ke.type!="ios"&&Ke.type!="android"){console.warn("Device["+Ue+"] has invalid type.");continue}if(G()==(Ke.type=="ios")){for(var ft=!1,ae=0;ae<Ke.rules.length;ae++){var le=Ke.rules[ae];if(this.ruleMatches_(le,se,pe,we)){ft=!0;break}}if(ft){var ce=Ke.dpi[0]||Ke.dpi,ge=Ke.dpi[1]||Ke.dpi;return new $n({xdpi:ce,ydpi:ge,bevelMm:Ke.bw})}}}return console.warn("No DPDB device match."),null},Jn.prototype.ruleMatches_=function(Y,se,pe,we){if(!Y.ua&&!Y.res||(Y.ua&&Y.ua.substring(0,2)==="SM"&&(Y.ua=Y.ua.substring(0,7)),Y.ua&&se.indexOf(Y.ua)<0))return!1;if(Y.res){if(!Y.res[0]||!Y.res[1])return!1;var Ue=Y.res[0],Ke=Y.res[1];if(Math.min(pe,we)!=Math.min(Ue,Ke)||Math.max(pe,we)!=Math.max(Ue,Ke))return!1}return!0};function $n(Y){this.xdpi=Y.xdpi,this.ydpi=Y.ydpi,this.bevelMm=Y.bevelMm}function Ei(Y,se){this.set(Y,se)}Ei.prototype.set=function(Y,se){this.sample=Y,this.timestampS=se},Ei.prototype.copy=function(Y){this.set(Y.sample,Y.timestampS)};function Fi(Y,se){this.kFilter=Y,this.isDebug=se,this.currentAccelMeasurement=new Ei,this.currentGyroMeasurement=new Ei,this.previousGyroMeasurement=new Ei,G()?this.filterQ=new Pt(-1,0,0,1):this.filterQ=new Pt(1,0,0,1),this.previousFilterQ=new Pt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new Pt,this.isOrientationInitialized=!1,this.estimatedGravity=new Ct,this.measuredGravity=new Ct,this.gyroIntegralQ=new Pt}Fi.prototype.addAccelMeasurement=function(Y,se){this.currentAccelMeasurement.set(Y,se)},Fi.prototype.addGyroMeasurement=function(Y,se){this.currentGyroMeasurement.set(Y,se);var pe=se-this.previousGyroMeasurement.timestampS;Ce(pe)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},Fi.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var Y=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,se=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,Y);this.gyroIntegralQ.multiply(se),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(se);var pe=new Pt;pe.copy(this.filterQ),pe.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(pe),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var we=new Pt;we.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),we.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",At*Te(we),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Ue=new Pt;Ue.copy(this.filterQ),Ue.multiply(we),this.filterQ.slerp(Ue,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},Fi.prototype.getOrientation=function(){return this.filterQ},Fi.prototype.accelToQuaternion_=function(Y){var se=new Ct;se.copy(Y),se.normalize();var pe=new Pt;return pe.setFromUnitVectors(new Ct(0,0,-1),se),pe.inverse(),pe},Fi.prototype.gyroToQuaternionDelta_=function(Y,se){var pe=new Pt,we=new Ct;return we.copy(Y),we.normalize(),pe.setFromAxisAngle(we,Y.length()*se),pe};function Vi(Y,se){this.predictionTimeS=Y,this.isDebug=se,this.previousQ=new Pt,this.previousTimestampS=null,this.deltaQ=new Pt,this.outQ=new Pt}Vi.prototype.getPrediction=function(Y,se,pe){if(!this.previousTimestampS)return this.previousQ.copy(Y),this.previousTimestampS=pe,Y;var we=new Ct;we.copy(se),we.normalize();var Ue=se.length();if(Ue<at*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(At*Ue).toFixed(1)),this.outQ.copy(Y),this.previousQ.copy(Y),this.outQ;var Ke=Ue*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(we,Ke),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(Y),this.previousTimestampS=pe,this.outQ};function lr(Y,se,pe,we){this.yawOnly=pe,this.accelerometer=new Ct,this.gyroscope=new Ct,this.filter=new Fi(Y,we),this.posePredictor=new Vi(se,we),this.isFirefoxAndroid=Z(),this.isIOS=G();var Ue=ee();this.isDeviceMotionInRadians=!this.isIOS&&Ue&&Ue<66,this.isWithoutDeviceMotion=xe()||oe(),this.filterToWorldQ=new Pt,G()?this.filterToWorldQ.setFromAxisAngle(new Ct(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Ct(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new Pt,this.worldToScreenQ=new Pt,this.originalPoseAdjustQ=new Pt,this.originalPoseAdjustQ.setFromAxisAngle(new Ct(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),me()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new Pt,this.orientationOut_=new Float32Array(4),this.start()}lr.prototype.getPosition=function(){return null},lr.prototype.getOrientation=function(){var Y=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Ue=new Pt().setFromAxisAngle(new Ct(0,0,-1),0),Ke=new Pt;return window.orientation===-90?Ke.setFromAxisAngle(new Ct(0,1,0),Math.PI/-2):Ke.setFromAxisAngle(new Ct(0,1,0),Math.PI/2),Ue.multiply(Ke)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Ue=new Pt;return Ue.setFromAxisAngle(new Ct(1,0,0),-Math.PI/2),Ue}(),Y=this._deviceOrientationQ;var pe=new Pt;return pe.copy(Y),pe.multiply(this.deviceOrientationFilterToWorldQ),pe.multiply(this.resetQ),pe.multiply(this.worldToScreenQ),pe.multiplyQuaternions(this.deviceOrientationFixQ,pe),this.yawOnly&&(pe.x=0,pe.z=0,pe.normalize()),this.orientationOut_[0]=pe.x,this.orientationOut_[1]=pe.y,this.orientationOut_[2]=pe.z,this.orientationOut_[3]=pe.w,this.orientationOut_}else{var se=this.filter.getOrientation();Y=this.posePredictor.getPrediction(se,this.gyroscope,this.previousTimestampS)}var pe=new Pt;return pe.copy(this.filterToWorldQ),pe.multiply(this.resetQ),pe.multiply(Y),pe.multiply(this.worldToScreenQ),this.yawOnly&&(pe.x=0,pe.z=0,pe.normalize()),this.orientationOut_[0]=pe.x,this.orientationOut_[1]=pe.y,this.orientationOut_[2]=pe.z,this.orientationOut_[3]=pe.w,this.orientationOut_},lr.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),me()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},lr.prototype.onDeviceOrientation_=function(Y){this._deviceOrientationQ=this._deviceOrientationQ||new Pt;var se=Y.alpha,pe=Y.beta,we=Y.gamma;se=(se||0)*Math.PI/180,pe=(pe||0)*Math.PI/180,we=(we||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(pe,se,-we)},lr.prototype.onDeviceMotion_=function(Y){this.updateDeviceMotion_(Y)},lr.prototype.updateDeviceMotion_=function(Y){var se=Y.accelerationIncludingGravity,pe=Y.rotationRate,we=Y.timeStamp/1e3,Ue=we-this.previousTimestampS;if(Ue<0){pt("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=we;return}else if(Ue<=K||Ue>J){pt("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=we;return}this.accelerometer.set(-se.x,-se.y,-se.z),pe&&(Pe()?this.gyroscope.set(-pe.beta,pe.alpha,pe.gamma):this.gyroscope.set(pe.alpha,pe.beta,pe.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,we)),this.filter.addAccelMeasurement(this.accelerometer,we),this.previousTimestampS=we},lr.prototype.onOrientationChange_=function(Y){this.setScreenTransform_()},lr.prototype.onMessage_=function(Y){var se=Y.data;if(!(!se||!se.type)){var pe=se.type.toLowerCase();pe==="devicemotion"&&this.updateDeviceMotion_(se.deviceMotionEvent)}},lr.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new Ct(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new Ct(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},lr.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),G()&&vn()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},lr.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var cr=60,Le=new Ct(1,0,0),ht=new Ct(0,0,1),yt=new Pt;yt.setFromAxisAngle(Le,-Math.PI/2),yt.multiply(new Pt().setFromAxisAngle(ht,Math.PI/2));var de=function(){function Y(se){D(this,Y),this.config=se,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new Pt,this._outQ=new Pt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return P(Y,[{key:"init",value:function(){var pe=null;try{pe=new RelativeOrientationSensor({frequency:cr,referenceFrame:"screen"}),pe.addEventListener("error",this._onSensorError)}catch(we){this.errors.push(we),we.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):we.name==="ReferenceError"?this.useDeviceMotion():console.error(we)}pe&&(this.api="sensor",this.sensor=pe,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new lr(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var pe=this.sensor.quaternion;this._sensorQ.set(pe[0],pe[1],pe[2],pe[3]);var we=this._outQ;return we.copy(yt),we.multiply(this._sensorQ),this.config.YAW_ONLY&&(we.x=we.z=0,we.normalize()),this._out[0]=we.x,this._out[1]=we.y,this._out[2]=we.z,this._out[3]=we.w,this._out}},{key:"_onSensorError",value:function(pe){this.errors.push(pe.error),pe.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):pe.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(pe.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),Y}(),be="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function Ve(){this.loadIcon_();var Y=document.createElement("div"),ft=Y.style;ft.position="fixed",ft.top=0,ft.right=0,ft.bottom=0,ft.left=0,ft.backgroundColor="gray",ft.fontFamily="sans-serif",ft.zIndex=1e6;var se=document.createElement("img");se.src=this.icon;var ft=se.style;ft.marginLeft="25%",ft.marginTop="25%",ft.width="50%",Y.appendChild(se);var pe=document.createElement("div"),ft=pe.style;ft.textAlign="center",ft.fontSize="16px",ft.lineHeight="24px",ft.margin="24px 25%",ft.width="50%",pe.innerHTML="Place your phone into your Cardboard viewer.",Y.appendChild(pe);var we=document.createElement("div"),ft=we.style;ft.backgroundColor="#CFD8DC",ft.position="fixed",ft.bottom=0,ft.width="100%",ft.height="48px",ft.padding="14px 24px",ft.boxSizing="border-box",ft.color="#656A6B",Y.appendChild(we);var Ue=document.createElement("div");Ue.style.float="left",Ue.innerHTML="No Cardboard viewer?";var Ke=document.createElement("a");Ke.href="https://www.google.com/get/cardboard/get-cardboard/",Ke.innerHTML="get one",Ke.target="_blank";var ft=Ke.style;ft.float="right",ft.fontWeight=600,ft.textTransform="uppercase",ft.borderLeft="1px solid gray",ft.paddingLeft="24px",ft.textDecoration="none",ft.color="#656A6B",we.appendChild(Ue),we.appendChild(Ke),this.overlay=Y,this.text=pe,this.hide()}Ve.prototype.show=function(Y){!Y&&!this.overlay.parentElement?document.body.appendChild(this.overlay):Y&&(this.overlay.parentElement&&this.overlay.parentElement!=Y&&this.overlay.parentElement.removeChild(this.overlay),Y.appendChild(this.overlay)),this.overlay.style.display="block";var se=this.overlay.querySelector("img"),pe=se.style;me()?(pe.width="20%",pe.marginLeft="40%",pe.marginTop="3%"):(pe.width="50%",pe.marginLeft="25%",pe.marginTop="25%")},Ve.prototype.hide=function(){this.overlay.style.display="none"},Ve.prototype.showTemporarily=function(Y,se){this.show(se),this.timer=setTimeout(this.hide.bind(this),Y)},Ve.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},Ve.prototype.update=function(){this.disableShowTemporarily(),!me()&&Ft()?this.show():this.hide()},Ve.prototype.loadIcon_=function(){this.icon=z("image/svg+xml",be)};var dt="CardboardV1",ut="WEBVR_CARDBOARD_VIEWER",_t="webvr-polyfill-viewer-selector";function It(Y){try{this.selectedKey=localStorage.getItem(ut)}catch(se){console.error("Failed to load viewer profile: %s",se)}this.selectedKey||(this.selectedKey=Y||dt),this.dialog=this.createDialog_(Fn.Viewers),this.root=null,this.onChangeCallbacks_=[]}It.prototype.show=function(Y){this.root=Y,Y.appendChild(this.dialog);var se=this.dialog.querySelector("#"+this.selectedKey);se.checked=!0,this.dialog.style.display="block"},It.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},It.prototype.getCurrentViewer=function(){return Fn.Viewers[this.selectedKey]},It.prototype.getSelectedKey_=function(){var Y=this.dialog.querySelector("input[name=field]:checked");return Y?Y.id:null},It.prototype.onChange=function(Y){this.onChangeCallbacks_.push(Y)},It.prototype.fireOnChange_=function(Y){for(var se=0;se<this.onChangeCallbacks_.length;se++)this.onChangeCallbacks_[se](Y)},It.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Fn.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Fn.Viewers[this.selectedKey]);try{localStorage.setItem(ut,this.selectedKey)}catch(Y){console.error("Failed to save viewer profile: %s",Y)}this.hide()},It.prototype.createDialog_=function(Y){var se=document.createElement("div");se.classList.add(_t),se.style.display="none";var pe=document.createElement("div"),Ke=pe.style;Ke.position="fixed",Ke.left=0,Ke.top=0,Ke.width="100%",Ke.height="100%",Ke.background="rgba(0, 0, 0, 0.3)",pe.addEventListener("click",this.hide.bind(this));var we=280,Ue=document.createElement("div"),Ke=Ue.style;Ke.boxSizing="border-box",Ke.position="fixed",Ke.top="24px",Ke.left="50%",Ke.marginLeft=-we/2+"px",Ke.width=we+"px",Ke.padding="24px",Ke.overflow="hidden",Ke.background="#fafafa",Ke.fontFamily="'Roboto', sans-serif",Ke.boxShadow="0px 5px 20px #666",Ue.appendChild(this.createH1_("Select your viewer"));for(var ft in Y)Ue.appendChild(this.createChoice_(ft,Y[ft].label));return Ue.appendChild(this.createButton_("Save",this.onSave_.bind(this))),se.appendChild(pe),se.appendChild(Ue),se},It.prototype.createH1_=function(Y){var se=document.createElement("h1"),pe=se.style;return pe.color="black",pe.fontSize="20px",pe.fontWeight="bold",pe.marginTop=0,pe.marginBottom="24px",se.innerHTML=Y,se},It.prototype.createChoice_=function(Y,se){var pe=document.createElement("div");pe.style.marginTop="8px",pe.style.color="black";var we=document.createElement("input");we.style.fontSize="30px",we.setAttribute("id",Y),we.setAttribute("type","radio"),we.setAttribute("value",Y),we.setAttribute("name","field");var Ue=document.createElement("label");return Ue.style.marginLeft="4px",Ue.setAttribute("for",Y),Ue.innerHTML=se,pe.appendChild(we),pe.appendChild(Ue),pe},It.prototype.createButton_=function(Y,se){var pe=document.createElement("button");pe.innerHTML=Y;var we=pe.style;return we.float="right",we.textTransform="uppercase",we.color="#1094f7",we.fontSize="14px",we.letterSpacing=0,we.border=0,we.background="none",we.marginTop="16px",pe.addEventListener("click",se),pe};var Zt=typeof window<"u"?window:typeof d<"u"?d:typeof self<"u"?self:{};function Wt(Y){return Y&&Y.__esModule&&Object.prototype.hasOwnProperty.call(Y,"default")?Y.default:Y}function Lt(Y,se){return se={exports:{}},Y(se,se.exports),se.exports}var Pn=Lt(function(Y,se){(function(we,Ue){Y.exports=Ue()})(Zt,function(){return function(pe){var we={};function Ue(Ke){if(we[Ke])return we[Ke].exports;var ft=we[Ke]={i:Ke,l:!1,exports:{}};return pe[Ke].call(ft.exports,ft,ft.exports,Ue),ft.l=!0,ft.exports}return Ue.m=pe,Ue.c=we,Ue.d=function(Ke,ft,ae){Ue.o(Ke,ft)||Object.defineProperty(Ke,ft,{configurable:!1,enumerable:!0,get:ae})},Ue.n=function(Ke){var ft=Ke&&Ke.__esModule?function(){return Ke.default}:function(){return Ke};return Ue.d(ft,"a",ft),ft},Ue.o=function(Ke,ft){return Object.prototype.hasOwnProperty.call(Ke,ft)},Ue.p="",Ue(Ue.s=0)}([function(pe,we,Ue){var Ke=function(){function ge(Ae,tt){for(var xt=0;xt<tt.length;xt++){var Dt=tt[xt];Dt.enumerable=Dt.enumerable||!1,Dt.configurable=!0,"value"in Dt&&(Dt.writable=!0),Object.defineProperty(Ae,Dt.key,Dt)}}return function(Ae,tt,xt){return tt&&ge(Ae.prototype,tt),xt&&ge(Ae,xt),Ae}}();function ft(ge,Ae){if(!(ge instanceof Ae))throw new TypeError("Cannot call a class as a function")}var ae=Ue(1),le=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,ce=function(){function ge(){ft(this,ge),le?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",ae),this.noSleepVideo.addEventListener("timeupdate",function(Ae){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return Ke(ge,[{key:"enable",value:function(){le?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){le?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),ge}();pe.exports=ce},function(pe,we,Ue){pe.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),Dn=Wt(Pn),jn=1e3,di=[0,0,.5,1],Cn=[.5,0,.5,1],vi=window.requestAnimationFrame,Zn=window.cancelAnimationFrame;function nr(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function Rr(Y){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:Y.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:Y.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:Y.canPresent},maxLayers:{writable:!1,enumerable:!0,value:Y.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Nt("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),Y.hasOrientation}}})}function Rn(Y){Y=Y||{};var se="wakelock"in Y?Y.wakelock:!0;this.isPolyfilled=!0,this.displayId=jn++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Nt("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Rr({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,se&&Ft()&&(this.wakelock_=new Dn)}Rn.prototype.getFrameData=function(Y){return Tn(Y,this._getPose(),this)},Rn.prototype.getPose=function(){return Nt("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Rn.prototype.resetPose=function(){return Nt("VRDisplay.prototype.resetPose"),this._resetPose()},Rn.prototype.getImmediatePose=function(){return Nt("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Rn.prototype.requestAnimationFrame=function(Y){return vi(Y)},Rn.prototype.cancelAnimationFrame=function(Y){return Zn(Y)},Rn.prototype.wrapForFullscreen=function(Y){if(G())return Y;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var se=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",se.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==Y)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=Y,this.originalParent_=Y.parentElement,this.originalParent_||document.body.appendChild(Y),!this.fullscreenWrapper_.parentElement){var pe=this.fullscreenElement_.parentElement;pe.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),pe.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var we=this;function Ue(){if(we.fullscreenElement_){var Ke=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];we.fullscreenElement_.setAttribute("style",Ke.join("; ")+";")}}return Ue(),this.fullscreenWrapper_},Rn.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var Y=this.fullscreenElement_;this.fullscreenElementCachedStyle_?Y.setAttribute("style",this.fullscreenElementCachedStyle_):Y.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var se=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(Y),this.originalParent_===se?se.insertBefore(Y,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(Y),se.removeChild(this.fullscreenWrapper_),Y}},Rn.prototype.requestPresent=function(Y){var se=this.isPresenting,pe=this;return Y instanceof Array||(Nt("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),Y=[Y]),new Promise(function(we,Ue){if(!pe.capabilities.canPresent){Ue(new Error("VRDisplay is not capable of presenting."));return}if(Y.length==0||Y.length>pe.capabilities.maxLayers){Ue(new Error("Invalid number of layers."));return}var Ke=Y[0];if(!Ke.source){we();return}var ft=Ke.leftBounds||di,ae=Ke.rightBounds||Cn;if(se){var le=pe.layer_;le.source!==Ke.source&&(le.source=Ke.source);for(var ce=0;ce<4;ce++)le.leftBounds[ce]=ft[ce],le.rightBounds[ce]=ae[ce];pe.wrapForFullscreen(pe.layer_.source),pe.updatePresent_(),we();return}if(pe.layer_={predistorted:Ke.predistorted,source:Ke.source,leftBounds:ft.slice(0),rightBounds:ae.slice(0)},pe.waitingForPresent_=!1,pe.layer_&&pe.layer_.source){var ge=pe.wrapForFullscreen(pe.layer_.source),Ae=function(){var Dt=gt();pe.isPresenting=ge===Dt,pe.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Yt){console.error("screen.orientation.lock() failed due to",Yt.message)}),pe.waitingForPresent_=!1,pe.beginPresent_(),we()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),pe.removeFullscreenWrapper(),pe.disableWakeLock(),pe.endPresent_(),pe.removeFullscreenListeners_()),pe.fireVRDisplayPresentChange_()},tt=function(){pe.waitingForPresent_&&(pe.removeFullscreenWrapper(),pe.removeFullscreenListeners_(),pe.disableWakeLock(),pe.waitingForPresent_=!1,pe.isPresenting=!1,Ue(new Error("Unable to present.")))};pe.addFullscreenListeners_(ge,Ae,tt),$e(ge)?(pe.enableWakeLock(),pe.waitingForPresent_=!0):(G()||H())&&(pe.enableWakeLock(),pe.isPresenting=!0,pe.beginPresent_(),pe.fireVRDisplayPresentChange_(),we())}!pe.waitingForPresent_&&!G()&&(nt(),Ue(new Error("Unable to present.")))})},Rn.prototype.exitPresent=function(){var Y=this.isPresenting,se=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(pe,we){Y?(!nt()&&G()&&(se.endPresent_(),se.fireVRDisplayPresentChange_()),H()&&(se.removeFullscreenWrapper(),se.removeFullscreenListeners_(),se.endPresent_(),se.fireVRDisplayPresentChange_()),pe()):we(new Error("Was not presenting to VRDisplay."))})},Rn.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Rn.prototype.fireVRDisplayPresentChange_=function(){var Y=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(Y)},Rn.prototype.fireVRDisplayConnect_=function(){var Y=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(Y)},Rn.prototype.addFullscreenListeners_=function(Y,se,pe){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=Y,this.fullscreenChangeHandler_=se,this.fullscreenErrorHandler_=pe,se&&(document.fullscreenEnabled?Y.addEventListener("fullscreenchange",se,!1):document.webkitFullscreenEnabled?Y.addEventListener("webkitfullscreenchange",se,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",se,!1):document.msFullscreenEnabled&&Y.addEventListener("msfullscreenchange",se,!1)),pe&&(document.fullscreenEnabled?Y.addEventListener("fullscreenerror",pe,!1):document.webkitFullscreenEnabled?Y.addEventListener("webkitfullscreenerror",pe,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",pe,!1):document.msFullscreenEnabled&&Y.addEventListener("msfullscreenerror",pe,!1))},Rn.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var Y=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var se=this.fullscreenChangeHandler_;Y.removeEventListener("fullscreenchange",se,!1),Y.removeEventListener("webkitfullscreenchange",se,!1),document.removeEventListener("mozfullscreenchange",se,!1),Y.removeEventListener("msfullscreenchange",se,!1)}if(this.fullscreenErrorHandler_){var pe=this.fullscreenErrorHandler_;Y.removeEventListener("fullscreenerror",pe,!1),Y.removeEventListener("webkitfullscreenerror",pe,!1),document.removeEventListener("mozfullscreenerror",pe,!1),Y.removeEventListener("msfullscreenerror",pe,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Rn.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Rn.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Rn.prototype.beginPresent_=function(){},Rn.prototype.endPresent_=function(){},Rn.prototype.submitFrame=function(Y){},Rn.prototype.getEyeParameters=function(Y){return null};var Kn={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},zi={LEFT:"left",RIGHT:"right"};function Si(Y){var se=Qt({},Kn);Y=Qt(se,Y||{}),Rn.call(this,{wakelock:Y.MOBILE_WAKE_LOCK}),this.config=Y,this.displayName="Cardboard VRDisplay",this.capabilities=new Rr({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new de(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Jn(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Fn(this.dpdb_.getDeviceParams(),Y.ADDITIONAL_VIEWERS),this.viewerSelector_=new It(Y.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new Ve),G()&&window.addEventListener("resize",this.onResize_.bind(this))}return Si.prototype=Object.create(Rn.prototype),Si.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Si.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Si.prototype._getFieldOfView=function(Y){var se;if(Y==zi.LEFT)se=this.deviceInfo_.getFieldOfViewLeftEye();else if(Y==zi.RIGHT)se=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",Y),null;return se},Si.prototype._getEyeOffset=function(Y){var se;if(Y==zi.LEFT)se=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(Y==zi.RIGHT)se=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",Y),null;return se},Si.prototype.getEyeParameters=function(Y){var se=this._getEyeOffset(Y),pe=this._getFieldOfView(Y),we={offset:se,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(we,"fieldOfView",{enumerable:!0,get:function(){return Nt("VRFieldOfView","VRFrameData's projection matrices"),pe}}),we},Si.prototype.onDeviceParamsUpdated_=function(Y){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(Y),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Si.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Si.prototype.beginPresent_=function(){var Y=this.layer_.source.getContext("webgl");Y||(Y=this.layer_.source.getContext("experimental-webgl")),Y||(Y=this.layer_.source.getContext("webgl2")),Y&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(Y.canvas.width=Je()*this.bufferScale_,Y.canvas.height=Oe()*this.bufferScale_,this.cardboardUI_=new We(Y)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new We(Y)),this.distorter_=new Ee(Y,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(se){this.viewerSelector_.show(this.layer_.source.parentElement),se.stopPropagation(),se.preventDefault()}.bind(this),function(se){this.exitPresent(),se.stopPropagation(),se.preventDefault()}.bind(this)),this.rotateInstructions_&&(me()&&Ft()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Si.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Si.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Si.prototype.submitFrame=function(Y){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var se=this.layer_.source.getContext("webgl");se||(se=this.layer_.source.getContext("experimental-webgl")),se||(se=this.layer_.source.getContext("webgl2"));var pe=se.canvas;(pe.width!=this.lastWidth||pe.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=pe.width,this.lastHeight=pe.height,this.cardboardUI_.render()}},Si.prototype.onOrientationChange_=function(Y){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Si.prototype.onResize_=function(Y){if(this.layer_){var se=this.layer_.source.getContext("webgl");se||(se=this.layer_.source.getContext("experimental-webgl")),se||(se=this.layer_.source.getContext("webgl2"));var pe=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];se.canvas.setAttribute("style",pe.join("; ")+";"),Xt(se.canvas)}},Si.prototype.onViewerChanged_=function(Y){this.deviceInfo_.setViewer(Y),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Si.prototype.fireVRDisplayDeviceParamsChange_=function(){var Y=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(Y)},Si.VRFrameData=nr,Si.VRDisplay=Rn,Si})}),x=f(b),E="0.10.12",S={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function M(B){this.config=v(v({},S),B),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&A())&&(this.enable(),this.getVRDisplays().then(function(F){F&&F[0]&&F[0].fireVRDisplayConnect_&&F[0].fireVRDisplayConnect_()}))}M.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(A()){var B=new x({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(B)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},M.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var B=this.native.VRFrameData,F=new this.native.VRFrameData,D=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(P){if(P instanceof B){D.call(this,P);return}D.call(this,F),P.pose=F.pose,g(F.leftProjectionMatrix,P.leftProjectionMatrix),g(F.rightProjectionMatrix,P.rightProjectionMatrix),g(F.leftViewMatrix,P.leftViewMatrix),g(F.rightViewMatrix,P.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=x.VRDisplay,window.VRFrameData=x.VRFrameData},M.prototype.getVRDisplays=function(){var B=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(F){return F.length>0?F:B.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},M.version=E,M.VRFrameData=x.VRFrameData,M.VRDisplay=x.VRDisplay;var C=Object.freeze({default:M}),T=C&&M||C;typeof d<"u"&&d.window&&(d.document||(d.document=d.window.document),d.navigator||(d.navigator=d.window.navigator));var L=T;return L})},"./node_modules/word-wrapper/index.js":c=>{var u=/\n/,h=`
`,d=/\s/;c.exports=function(b,x){var E=c.exports.lines(b,x);return E.map(function(S){return b.substring(S.start,S.end)}).join(`
`)},c.exports.lines=function(x,E){if(E=E||{},E.width===0&&E.mode!=="nowrap")return[];x=x||"";var S=typeof E.width=="number"?E.width:Number.MAX_VALUE,M=Math.max(0,E.start||0),C=typeof E.end=="number"?E.end:x.length,T=E.mode,L=E.measure||v;return T==="pre"?A(L,x,M,C,S):g(L,x,M,C,S,T)};function f(b,x,E,S){var M=b.indexOf(x,E);return M===-1||M>S?S:M}function p(b){return d.test(b)}function A(b,x,E,S,M){for(var C=[],T=E,L=E;L<S&&L<x.length;L++){var B=x.charAt(L),F=u.test(B);if(F||L===S-1){var D=F?L:L+1,P=b(x,T,D,M);C.push(P),T=L+1}}return C}function g(b,x,E,S,M,C){var T=[],L=M;for(C==="nowrap"&&(L=Number.MAX_VALUE);E<S&&E<x.length;){for(var B=f(x,h,E,S);E<B&&p(x.charAt(E));)E++;var F=b(x,E,B,L),D=E+(F.end-F.start),P=D+h.length;if(D<B){for(;D>E&&!p(x.charAt(D));)D--;if(D===E)P>E+h.length&&P--,D=P;else for(P=D;D>E&&p(x.charAt(D-h.length));)D--}if(D>=E){var U=b(x,E,D,L);T.push(U)}E=P}return T}function v(b,x,E,S){var M=Math.min(S,E-x);return{start:x,end:x+M}}},"./node_modules/xhr/index.js":(c,u,h)=>{var d=h("./node_modules/global/window.js"),f=h("./node_modules/is-function/index.js"),p=h("./node_modules/parse-headers/parse-headers.js"),A=h("./node_modules/xtend/immutable.js");c.exports=x,c.exports.default=x,x.XMLHttpRequest=d.XMLHttpRequest||M,x.XDomainRequest="withCredentials"in new x.XMLHttpRequest?x.XMLHttpRequest:d.XDomainRequest,g(["get","put","post","patch","head","delete"],function(C){x[C==="delete"?"del":C]=function(T,L,B){return L=b(T,L,B),L.method=C.toUpperCase(),E(L)}});function g(C,T){for(var L=0;L<C.length;L++)T(C[L])}function v(C){for(var T in C)if(C.hasOwnProperty(T))return!1;return!0}function b(C,T,L){var B=C;return f(T)?(L=T,typeof C=="string"&&(B={uri:C})):B=A(T,{uri:C}),B.callback=L,B}function x(C,T,L){return T=b(C,T,L),E(T)}function E(C){if(typeof C.callback>"u")throw new Error("callback argument missing");var T=!1,L=function(Pe,me,Ce){T||(T=!0,C.callback(Pe,me,Ce))};function B(){U.readyState===4&&setTimeout(P,0)}function F(){var xe=void 0;if(U.response?xe=U.response:xe=U.responseText||S(U),Z)try{xe=JSON.parse(xe)}catch{}return xe}function D(xe){return clearTimeout(ee),xe instanceof Error||(xe=new Error(""+(xe||"Unknown XMLHttpRequest Error"))),xe.statusCode=0,L(xe,oe)}function P(){if(!J){var xe;clearTimeout(ee),C.useXDR&&U.status===void 0?xe=200:xe=U.status===1223?204:U.status;var Pe=oe,me=null;return xe!==0?(Pe={body:F(),statusCode:xe,method:j,headers:{},url:z,rawRequest:U},U.getAllResponseHeaders&&(Pe.headers=p(U.getAllResponseHeaders()))):me=new Error("Internal XMLHttpRequest Error"),L(me,Pe,Pe.body)}}var U=C.xhr||null;U||(C.cors||C.useXDR?U=new x.XDomainRequest:U=new x.XMLHttpRequest);var K,J,z=U.url=C.uri||C.url,j=U.method=C.method||"GET",G=C.body||C.data,H=U.headers=C.headers||{},te=!!C.sync,Z=!1,ee,oe={body:void 0,headers:{},statusCode:0,method:j,url:z,rawRequest:U};if("json"in C&&C.json!==!1&&(Z=!0,H.accept||H.Accept||(H.Accept="application/json"),j!=="GET"&&j!=="HEAD"&&(H["content-type"]||H["Content-Type"]||(H["Content-Type"]="application/json"),G=JSON.stringify(C.json===!0?G:C.json))),U.onreadystatechange=B,U.onload=P,U.onerror=D,U.onprogress=function(){},U.onabort=function(){J=!0},U.ontimeout=D,U.open(j,z,!te,C.username,C.password),te||(U.withCredentials=!!C.withCredentials),!te&&C.timeout>0&&(ee=setTimeout(function(){if(!J){J=!0,U.abort("timeout");var xe=new Error("XMLHttpRequest timeout");xe.code="ETIMEDOUT",D(xe)}},C.timeout)),U.setRequestHeader)for(K in H)H.hasOwnProperty(K)&&U.setRequestHeader(K,H[K]);else if(C.headers&&!v(C.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in C&&(U.responseType=C.responseType),"beforeSend"in C&&typeof C.beforeSend=="function"&&C.beforeSend(U),U.send(G||null),U}function S(C){try{if(C.responseType==="document")return C.responseXML;var T=C.responseXML&&C.responseXML.documentElement.nodeName==="parsererror";if(C.responseType===""&&!T)return C.responseXML}catch{}return null}function M(){}},"./node_modules/xml-parse-from-string/index.js":c=>{c.exports=function(){return typeof self.DOMParser<"u"?function(h){var d=new self.DOMParser;return d.parseFromString(h,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(h){var d=new self.ActiveXObject("Microsoft.XMLDOM");return d.async="false",d.loadXML(h),d}:function(h){var d=document.createElement("div");return d.innerHTML=h,d}}()},"./node_modules/xtend/immutable.js":c=>{c.exports=h;var u=Object.prototype.hasOwnProperty;function h(){for(var d={},f=0;f<arguments.length;f++){var p=arguments[f];for(var A in p)u.call(p,A)&&(d[A]=p[A])}return d}},"./src/components/anchored.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/index.js"),p=f.debug("components:anchored:warn");c.exports.Component=d("anchored",{schema:{persistent:{default:!1}},init:function(){var g=this.el.sceneEl,v=g.getAttribute("webxr"),b=v.optionalFeatures;b.indexOf("anchors")===-1&&(b.push("anchors"),this.el.sceneEl.setAttribute("webxr",v)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var g=this.el.sceneEl,v=g.renderer.xr,b,x,E,S=this.el.object3D;!g.is("ar-mode")&&!g.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),this.anchor&&(b=g.frame,x=v.getReferenceSpace(),E=b.getPose(this.anchor.anchorSpace,x),S.matrix.elements=E.transform.matrix,S.matrix.decompose(S.position,S.rotation,S.scale)))},createAnchor:async function(v,b){var x=this.el.sceneEl,E=x.renderer.xr,S,M,C,T,L=this.el.object3D;if(v=v||L.position,b=b||this.auxQuaternion.setFromEuler(L.rotation),!A(x)){p("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),S=x.frame,M=E.getReferenceSpace(),C=new XRRigidTransform({x:v.x,y:v.y,z:v.z},{x:b.x,y:b.y,z:b.z,w:b.w}),this.requestAnchorPending=!1,T=await S.createAnchor(C,M),this.data.persistent&&(this.el.id?(this.persistentHandle=await T.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):p("The anchor won't be persisted because the entity has no assigned id.")),x.object3D.attach(this.el.object3D),this.anchor=T},restorePersistentAnchor:async function(){var v=this.el.sceneEl.renderer.xr,b=v.getSession(),x=b.persistentAnchors,E;if(this.requestPersistentAnchorPending=!1,!this.el.id){p("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(x){E=localStorage.getItem(this.el.id);for(var S=0;S<x.length;++S)if(E===x[S]){this.anchor=await b.restorePersistentAnchor(x[S]),this.anchor&&(this.persistentHandle=x[S]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0},deleteAnchor:function(){var g,v,b=this.anchor;b&&(g=this.el.sceneEl.renderer.xr,v=g.getSession(),b.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&v.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function A(g){var v=g.renderer.xr,b=v.getSession();return b&&b.restorePersistentAnchor}},"./src/components/animation.js":(c,u,h)=>{var d=h("./node_modules/super-animejs/lib/anime.es.js").default,f=h("./src/core/component.js").components,p=h("./src/core/component.js").registerComponent,A=h("./src/lib/three.js"),g=h("./src/utils/index.js"),v=new A.Color,b=new A.Color,x=g.entity.getComponentProperty,E=g.entity.setComponentProperty,S={},M="color",C="position",T="rotation",L="scale",B="components",F="object3D";c.exports.Component=p("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(H){return H===!0||H==="true"?!0:H===!1||H==="false"?!1:parseInt(H,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var H=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){H.animationIsPlaying=!1,H.el.emit("animationcomplete",H.eventDetail,!1),H.id&&H.el.emit("animationcomplete__"+H.id,H.eventDetail,!1)}}},update:function(H){var te=this.config,Z=this.data;this.animationIsPlaying=!1,this.data.enabled&&Z.property&&(te.autoplay=!1,te.direction=Z.dir,te.duration=Z.dur,te.easing=Z.easing,te.elasticity=Z.elasticity,te.loop=Z.loop,te.round=Z.round,this.createAndStartAnimation())},tick:function(H,te){this.animationIsPlaying&&(this.time+=te,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var H=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=d(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!H.autoplay||H.startEvents&&H.startEvents.length)){if(H.delay){setTimeout(this.beginAnimation,H.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=d(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var H=this.config,te=this.data,Z=this.el,ee,oe,xe;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){ee=te.from===""?J(Z,te.property):te.from,xe=te.to,this.setColorConfig(ee,xe),ee=this.fromColor,xe=this.toColor,this.targetsArray.length=0,this.targetsArray.push(ee),H.targets=this.targetsArray;for(oe in xe)H[oe]=xe[oe];H.update=function(){var Pe={};return function(me){var Ce;Ce=me.animatables[0].target,!(Ce.r===Pe.r&&Ce.g===Pe.g&&Ce.b===Pe.b)&&z(Z,te.property,Ce,te.type)}}()}},updateConfigForDefault:function(){var H=this.config,te=this.data,Z=this.el,ee,oe,xe,Pe;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(te.from===""?ee=G(te)?J(Z,te.property):x(Z,te.property):ee=te.from,Pe=te.to,xe=!isNaN(ee||Pe),xe?(ee=parseFloat(ee),Pe=parseFloat(Pe)):(ee=ee&&ee.toString(),Pe=Pe&&Pe.toString()),oe=te.to==="true"||te.to==="false"||te.to===!0||te.to===!1,oe&&(ee=te.from==="true"||te.from===!0?1:0,Pe=te.to==="true"||te.to===!0?1:0),this.targets.aframeProperty=ee,H.targets=this.targets,H.aframeProperty=Pe,H.update=function(){var me;return function(Ce){var Je;Je=Ce.animatables[0].target.aframeProperty,Je!==me&&(me=Je,oe&&(Je=Je>=1),G(te)?z(Z,te.property,Je,te.type):E(Z,te.property,Je))}}())},updateConfigForVector:function(){var H=this.config,te=this.data,Z=this.el,ee,oe,xe;oe=te.from!==""?g.coordinates.parse(te.from):x(Z,te.property),xe=g.coordinates.parse(te.to),te.property===T&&(P(oe),P(xe)),this.targetsArray.length=0,this.targetsArray.push(oe),H.targets=this.targetsArray;for(ee in xe)H[ee]=xe[ee];if(te.property===C||te.property===T||te.property===L){H.update=function(){var Pe={};return function(me){var Ce=me.animatables[0].target;te.property===L&&(Ce.x=Math.max(1e-4,Ce.x),Ce.y=Math.max(1e-4,Ce.y),Ce.z=Math.max(1e-4,Ce.z)),!(Ce.x===Pe.x&&Ce.y===Pe.y&&Ce.z===Pe.z)&&(Pe.x=Ce.x,Pe.y=Ce.y,Pe.z=Ce.z,Z.object3D[te.property].set(Ce.x,Ce.y,Ce.z))}}();return}H.update=function(){var Pe={};return function(me){var Ce=me.animatables[0].target;Ce.x===Pe.x&&Ce.y===Pe.y&&Ce.z===Pe.z||(Pe.x=Ce.x,Pe.y=Ce.y,Pe.z=Ce.z,E(Z,te.property,Ce))}}()},updateConfig:function(){var H;H=D(this.el,this.data.property),G(this.data)&&this.data.type===M?this.updateConfigForRawColor():H==="vec2"||H==="vec3"||H==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(H){var te,Z=this.data,ee=this.el,oe=this;return Z.from!==""||!Z.property.startsWith(B)||(te=j(Z.property)[1],ee.components[te])?!1:(ee.addEventListener("componentinitialized",function xe(Pe){Pe.detail.name===te&&(H(),oe.animation=d(oe.config),ee.removeEventListener("componentinitialized",xe))}),!0)},stopRelatedAnimations:function(){var H,te;for(te in this.el.components)H=this.el.components[te],te!==this.attrName&&H.name==="animation"&&H.animationIsPlaying&&H.data.property===this.data.property&&(H.animationIsPlaying=!1)},addEventListeners:function(){var H=this.data,te=this.el;U(te,H.startEvents,this.onStartEvent),U(te,H.pauseEvents,this.pauseAnimation),U(te,H.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var H=this.data,te=this.el;K(te,H.startEvents,this.onStartEvent),K(te,H.pauseEvents,this.pauseAnimation),K(te,H.resumeEvents,this.resumeAnimation)},setColorConfig:function(H,te){v.set(H),b.set(te),H=this.fromColor,te=this.toColor,H.r=v.r,H.g=v.g,H.b=v.b,te.r=b.r,te.g=b.g,te.b=b.b}});function D(H,te){var Z,ee,oe,xe;return oe=te.split("."),ee=oe[0],xe=oe[1],Z=H.components[ee]||f[ee],!Z||xe&&!Z.schema[xe]?null:xe?Z.schema[xe].type:Z.schema.type}function P(H){H.x=A.MathUtils.degToRad(H.x),H.y=A.MathUtils.degToRad(H.y),H.z=A.MathUtils.degToRad(H.z)}function U(H,te,Z){var ee;for(ee=0;ee<te.length;ee++)H.addEventListener(te[ee],Z)}function K(H,te,Z){var ee;for(ee=0;ee<te.length;ee++)H.removeEventListener(te[ee],Z)}function J(H,te){var Z,ee,oe;for(ee=j(te),oe=H,Z=0;Z<ee.length;Z++)oe=oe[ee[Z]];if(oe===void 0)throw console.log(H),new Error("[animation] property ("+te+") could not be found");return oe}function z(H,te,Z,ee){var oe,xe,Pe,me;for(te.startsWith("object3D.rotation")&&(Z=A.MathUtils.degToRad(Z)),xe=j(te),me=H,oe=0;oe<xe.length-1;oe++)me=me[xe[oe]];if(Pe=xe[xe.length-1],ee===M){"r"in me[Pe]?(me[Pe].r=Z.r,me[Pe].g=Z.g,me[Pe].b=Z.b):(me[Pe].x=Z.r,me[Pe].y=Z.g,me[Pe].z=Z.b);return}me[Pe]=Z}function j(H){return H in S||(S[H]=H.split(".")),S[H]}function G(H){return H.isRawProperty||H.property.startsWith(B)||H.property.startsWith(F)}},"./src/components/camera.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js");c.exports.Component=d("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var p,A=this.el;p=this.camera=new f.PerspectiveCamera,A.setObject3D("camera",p)},update:function(p){var A=this.data,g=this.camera;g.aspect=A.aspect||window.innerWidth/window.innerHeight,g.far=A.far,g.fov=A.fov,g.near=A.near,g.zoom=A.zoom,g.updateProjectionMatrix(),this.updateActiveCamera(p),this.updateSpectatorCamera(p)},updateActiveCamera:function(p){var A=this.data,g=this.el,v=this.system;p&&p.active===A.active||A.spectator||(A.active&&v.activeCameraEl!==g?v.setActiveCamera(g):!A.active&&v.activeCameraEl===g&&v.disableActiveCamera())},updateSpectatorCamera:function(p){var A=this.data,g=this.el,v=this.system;p&&p.spectator===A.spectator||(A.spectator&&v.spectatorCameraEl!==g?v.setSpectatorCamera(g):!A.spectator&&v.spectatorCameraEl===g&&v.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/index.js"),p=f.bind,A={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},g={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},v={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},b={DOWN:["selectstart"],UP:["selectend"]},x="a-mouse-cursor-hover";c.exports.Component=d("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:f.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},multiple:!0,init:function(){var E=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=f.debounce(function(){E.canvasBounds=E.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=p(this.onCursorDown,this),this.onCursorUp=p(this.onCursorUp,this),this.onIntersection=p(this.onIntersection,this),this.onIntersectionCleared=p(this.onIntersectionCleared,this),this.onMouseMove=p(this.onMouseMove,this),this.onEnterVR=p(this.onEnterVR,this)},update:function(E){this.data.rayOrigin!==E.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var E=this.el.sceneEl.frame,S=this.activeXRInput;this.data.rayOrigin==="xrselect"&&E&&S&&this.onMouseMove({frame:E,inputSource:S,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var E=this.el;E.removeState(g.HOVERING),E.removeState(g.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(g.HOVERED),this.removeEventListeners()},addEventListeners:function(){var E,S=this.data,M=this.el,C=this;function T(){E=M.sceneEl.canvas,!(S.downEvents.length||S.upEvents.length)&&(v.DOWN.forEach(function(L){E.addEventListener(L,C.onCursorDown)}),v.UP.forEach(function(L){E.addEventListener(L,C.onCursorUp)}))}E=M.sceneEl.canvas,E?T():M.sceneEl.addEventListener("render-target-loaded",T),S.downEvents.forEach(function(L){M.addEventListener(L,C.onCursorDown)}),S.upEvents.forEach(function(L){M.addEventListener(L,C.onCursorUp)}),M.addEventListener("raycaster-intersection",this.onIntersection),M.addEventListener("raycaster-closest-entity-changed",this.onIntersection),M.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),M.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),M.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var E,S=this.data,M=this.el,C=this;E=M.sceneEl.canvas,E&&!S.downEvents.length&&!S.upEvents.length&&(v.DOWN.forEach(function(T){E.removeEventListener(T,C.onCursorDown)}),v.UP.forEach(function(T){E.removeEventListener(T,C.onCursorUp)})),S.downEvents.forEach(function(T){M.removeEventListener(T,C.onCursorDown)}),S.upEvents.forEach(function(T){M.removeEventListener(T,C.onCursorUp)}),M.removeEventListener("raycaster-intersection",this.onIntersection),M.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),E.removeEventListener("mousemove",this.onMouseMove),E.removeEventListener("touchstart",this.onMouseMove),E.removeEventListener("touchmove",this.onMouseMove),M.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),M.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var E,S=this.el;E=S.sceneEl.canvas,E.removeEventListener("mousemove",this.onMouseMove),E.removeEventListener("touchmove",this.onMouseMove),S.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(E.addEventListener("mousemove",this.onMouseMove,!1),E.addEventListener("touchmove",this.onMouseMove,!1),S.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var E=new THREE.Vector3,S=new THREE.Vector2,M=new THREE.Vector3,C={origin:M,direction:E};return function(T){var L=this.canvasBounds,B=this.el.sceneEl.camera,F,D,P,U,K,J,z,j;B.parent.updateMatrixWorld(),T.type==="touchmove"||T.type==="touchstart"?D=T.touches.item(0):D=T,F=D.clientX-L.left,P=D.clientY-L.top,S.x=F/L.width*2-1,S.y=-(P/L.height)*2+1,this.data.rayOrigin==="xrselect"&&(T.type==="selectstart"||T.type==="fakeselectevent")?(U=T.frame,K=T.inputSource,J=this.el.renderer.xr.getReferenceSpace(),z=U.getPose(K.targetRaySpace,J),j=z.transform,E.set(0,0,-1),E.applyQuaternion(j.orientation),M.copy(j.position)):T.type==="fakeselectout"?(E.set(0,1,0),M.set(0,9999,0)):B&&B.isPerspectiveCamera?(M.setFromMatrixPosition(B.matrixWorld),E.set(S.x,S.y,.5).unproject(B).sub(M).normalize()):B&&B.isOrthographicCamera?(M.set(S.x,S.y,(B.near+B.far)/(B.near-B.far)).unproject(B),E.set(0,0,-1).transformDirection(B.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+B.type),this.el.setAttribute("raycaster",C),T.type==="touchmove"&&T.preventDefault()}}(),onCursorDown:function(E){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&E.type==="touchstart"&&(this.onMouseMove(E),this.el.components.raycaster.checkIntersections(),E.preventDefault()),this.data.rayOrigin==="xrselect"&&E.type==="selectstart"&&(this.activeXRInput=E.inputSource,this.onMouseMove(E),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(A.MOUSEDOWN,E),this.cursorDownEl=this.intersectedEl},onCursorUp:function(E){if(this.isCursorDown){this.isCursorDown=!1;var S=this.data;this.twoWayEmit(A.MOUSEUP,E),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(A.MOUSEUP,this.intersectedEventDetail)),(!S.fuse||S.rayOrigin==="mouse"||S.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(A.CLICK,E),S.rayOrigin==="xrselect"&&this.activeXRInput===E.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,E.type==="touchend"&&E.preventDefault()}},onIntersection:function(E){var S,M=this.el,C,T,L;C=E.detail.els[0]===M?1:0,L=E.detail.intersections[C],T=E.detail.els[C],T&&this.intersectedEl!==T&&(this.intersectedEl&&(S=this.el.components.raycaster.getIntersection(this.intersectedEl),S&&S.distance<=L.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(T,L)))},onIntersectionCleared:function(E){var S=E.detail.clearedEls;S.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var E=this.el.sceneEl.xrSession,S=this;E&&this.data.rayOrigin!=="mouse"&&(b.DOWN.forEach(function(M){E.addEventListener(M,S.onCursorDown)}),b.UP.forEach(function(M){E.addEventListener(M,S.onCursorUp)}))},setIntersection:function(E,S){var M=this.el,C=this.data,T=this;this.intersectedEl!==E&&(this.intersectedEl=E,M.addState(g.HOVERING),E.addState(g.HOVERED),this.twoWayEmit(A.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(x),!(C.fuseTimeout===0||!C.fuse||C.rayOrigin==="xrselect"||C.rayOrigin==="mouse")&&(M.addState(g.FUSING),this.twoWayEmit(A.FUSING),this.fuseTimeout=setTimeout(function(){M.removeState(g.FUSING),T.twoWayEmit(A.CLICK)},C.fuseTimeout)))},clearCurrentIntersection:function(E){var S,M,C,T=this.el;this.intersectedEl&&(this.intersectedEl.removeState(g.HOVERED),T.removeState(g.HOVERING),T.removeState(g.FUSING),this.twoWayEmit(A.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(x),this.intersectedEl=null,clearTimeout(this.fuseTimeout),E!==!0&&(C=this.el.components.raycaster.intersections,C.length!==0&&(S=C[0].object.el===T?1:0,M=C[S],M&&this.setIntersection(M.object.el,M))))},twoWayEmit:function(E,S){var M=this.el,C=this.intersectedEl,T;function L(B,F){S instanceof MouseEvent?B.mouseEvent=S:typeof TouchEvent<"u"&&S instanceof TouchEvent&&(B.touchEvent=S)}T=this.el.components.raycaster.getIntersection(C),this.eventDetail.intersectedEl=C,this.eventDetail.intersection=T,L(this.eventDetail),M.emit(E,this.eventDetail),C&&(this.intersectedEventDetail.intersection=T,L(this.intersectedEventDetail),C.emit(E,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/bind.js"),p=h("./src/utils/tracked-controls.js"),A=p.checkControllerPresentAndSetup,g=p.emitIfAxesChanged,v=p.onButtonEvent,b="generic",x={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};c.exports.Component=d("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:x,bindMethods:function(){this.onControllersUpdate=f(this.onControllersUpdate,this),this.checkIfControllerPresent=f(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=f(this.removeControllersUpdateListener,this),this.onAxisMoved=f(this.onAxisMoved,this)},init:function(){var E=this;this.onButtonChanged=f(this.onButtonChanged,this),this.onButtonDown=function(S){v(S.detail.id,"down",E)},this.onButtonUp=function(S){v(S.detail.id,"up",E)},this.onButtonTouchStart=function(S){v(S.detail.id,"touchstart",E)},this.onButtonTouchEnd=function(S){v(S.detail.id,"touchend",E)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(S){S.detail.name!==E.name&&(E.wasControllerConnected=!0,E.removeEventListeners(),E.removeControllersUpdateListener())})},addEventListeners:function(){var E=this.el;E.addEventListener("buttonchanged",this.onButtonChanged),E.addEventListener("buttondown",this.onButtonDown),E.addEventListener("buttonup",this.onButtonUp),E.addEventListener("touchstart",this.onButtonTouchStart),E.addEventListener("touchend",this.onButtonTouchEnd),E.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var E=this.el;E.removeEventListener("buttonchanged",this.onButtonChanged),E.removeEventListener("buttondown",this.onButtonDown),E.removeEventListener("buttonup",this.onButtonUp),E.removeEventListener("touchstart",this.onButtonTouchStart),E.removeEventListener("touchend",this.onButtonTouchEnd),E.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var E=this.data,S=E.hand?E.hand:void 0;A(this,b,{hand:S,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var E=this.el,S=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}E.setAttribute("tracked-controls",{hand:S.hand,idPrefix:b,orientationOffset:S.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(E){var S=this.mapping.buttons[E.detail.id];S&&this.el.emit(S+"changed",E.detail.state)},onAxisMoved:function(E){g(this,this.mapping.axes,E)},initDefaultModel:function(){var E=this.modelEl=document.createElement("a-entity");E.setAttribute("geometry",{primitive:"sphere",radius:.03}),E.setAttribute("material",{color:this.data.color}),this.el.appendChild(E),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(c,u,h)=>{var d=h("./src/core/geometry.js").geometries,f=h("./src/core/geometry.js").geometryNames,p=h("./src/core/component.js").registerComponent,A=h("./src/lib/three.js"),g=new A.BufferGeometry;c.exports.Component=p("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:f,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(v){var b=this.data,x=this.el,E,S=this.system;this.geometry&&(S.unuseGeometry(v),this.geometry=null),this.geometry=S.getOrCreateGeometry(b),E=x.getObject3D("mesh"),E?E.geometry=this.geometry:(E=new A.Mesh,E.geometry=this.geometry,this.el.getAttribute("material")||(E.material=new A.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),x.setObject3D("mesh",E))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=g,this.geometry=null},updateSchema:function(v){var b=this.oldData&&this.oldData.primitive,x=v.primitive,E=d[x]&&d[x].schema;if(!E)throw new Error("Unknown geometry schema `"+x+"`");b&&b===x||this.extendSchema(E)}})},"./src/components/gltf-model.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js"),p=h("./src/utils/index.js"),A=p.debug("components:gltf-model:warn");c.exports.Component=d("gltf-model",{schema:{type:"model"},init:function(){var g=this,v=this.system.getDRACOLoader(),b=this.system.getMeshoptDecoder(),x=this.system.getKTX2Loader();this.model=null,this.loader=new f.GLTFLoader,v&&this.loader.setDRACOLoader(v),b?this.ready=b.then(function(E){g.loader.setMeshoptDecoder(E)}):this.ready=Promise.resolve(),x&&this.loader.setKTX2Loader(x)},update:function(){var g=this,v=this.el,b=this.data;b&&(this.remove(),this.ready.then(function(){g.loader.load(b,function(E){g.model=E.scene||E.scenes[0],g.model.animations=E.animations,v.setObject3D("mesh",g.model),v.emit("model-loaded",{format:"gltf",model:g.model})},void 0,function(E){var S=E&&E.message?E.message:"Failed to load glTF model";A(S),v.emit("model-error",{format:"gltf",src:b})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;d("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/constants/index.js").AFRAME_CDN_ROOT,p={toonLeft:f+"controllers/hands/leftHand.glb",toonRight:f+"controllers/hands/rightHand.glb",lowPolyLeft:f+"controllers/hands/leftHandLow.glb",lowPolyRight:f+"controllers/hands/rightHandLow.glb",highPolyLeft:f+"controllers/hands/leftHandHigh.glb",highPolyRight:f+"controllers/hands/rightHandHigh.glb"},A={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},g={};g[A.fist]="grip",g[A.thumbUp]="pistol",g[A.point]="pointing",c.exports.Component=d("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var x=this,E=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){x.handleButton("grip","down")},this.onGripUp=function(){x.handleButton("grip","up")},this.onTrackpadDown=function(){x.handleButton("trackpad","down")},this.onTrackpadUp=function(){x.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){x.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){x.handleButton("trackpad","touchend")},this.onTriggerDown=function(){x.handleButton("trigger","down")},this.onTriggerUp=function(){x.handleButton("trigger","up")},this.onTriggerTouchStart=function(){x.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){x.handleButton("trigger","touchend")},this.onGripTouchStart=function(){x.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){x.handleButton("grip","touchend")},this.onThumbstickDown=function(){x.handleButton("thumbstick","down")},this.onThumbstickUp=function(){x.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){x.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){x.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){x.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){x.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){x.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){x.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),E.addEventListener("controllerconnected",this.onControllerConnected),E.addEventListener("controllerdisconnected",this.onControllerDisconnected),E.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(x,E){var S=this.el.getObject3D("mesh");!S||!S.mixer||S.mixer.update(E/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var x=this.el;x.addEventListener("gripdown",this.onGripDown),x.addEventListener("gripup",this.onGripUp),x.addEventListener("trackpaddown",this.onTrackpadDown),x.addEventListener("trackpadup",this.onTrackpadUp),x.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),x.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),x.addEventListener("triggerdown",this.onTriggerDown),x.addEventListener("triggerup",this.onTriggerUp),x.addEventListener("triggertouchstart",this.onTriggerTouchStart),x.addEventListener("triggertouchend",this.onTriggerTouchEnd),x.addEventListener("griptouchstart",this.onGripTouchStart),x.addEventListener("griptouchend",this.onGripTouchEnd),x.addEventListener("thumbstickdown",this.onThumbstickDown),x.addEventListener("thumbstickup",this.onThumbstickUp),x.addEventListener("abuttontouchstart",this.onAorXTouchStart),x.addEventListener("abuttontouchend",this.onAorXTouchEnd),x.addEventListener("bbuttontouchstart",this.onBorYTouchStart),x.addEventListener("bbuttontouchend",this.onBorYTouchEnd),x.addEventListener("xbuttontouchstart",this.onAorXTouchStart),x.addEventListener("xbuttontouchend",this.onAorXTouchEnd),x.addEventListener("ybuttontouchstart",this.onBorYTouchStart),x.addEventListener("ybuttontouchend",this.onBorYTouchEnd),x.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),x.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var x=this.el;x.removeEventListener("gripdown",this.onGripDown),x.removeEventListener("gripup",this.onGripUp),x.removeEventListener("trackpaddown",this.onTrackpadDown),x.removeEventListener("trackpadup",this.onTrackpadUp),x.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),x.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),x.removeEventListener("triggerdown",this.onTriggerDown),x.removeEventListener("triggerup",this.onTriggerUp),x.removeEventListener("triggertouchstart",this.onTriggerTouchStart),x.removeEventListener("triggertouchend",this.onTriggerTouchEnd),x.removeEventListener("griptouchstart",this.onGripTouchStart),x.removeEventListener("griptouchend",this.onGripTouchEnd),x.removeEventListener("thumbstickdown",this.onThumbstickDown),x.removeEventListener("thumbstickup",this.onThumbstickUp),x.removeEventListener("abuttontouchstart",this.onAorXTouchStart),x.removeEventListener("abuttontouchend",this.onAorXTouchEnd),x.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),x.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),x.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),x.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),x.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),x.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),x.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),x.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(x){var E,S=this.el,M=this.data.hand,C=this.data.handModelStyle,T=this.data.color,L=this;if(E={hand:M,model:!1},M!==x){var B=p[C+M.charAt(0).toUpperCase()+M.slice(1)];this.loader.load(B,function(F){var D=F.scene.children[0],P=M==="left"?Math.PI/2:-Math.PI/2,U=S.sceneEl.hasWebXR?-Math.PI/2:0;D.mixer=new THREE.AnimationMixer(D),L.clips=F.animations,S.setObject3D("mesh",D),D.traverse(function(K){K.isMesh&&(K.material.color=new THREE.Color(T))}),D.position.set(0,0,0),D.rotation.set(U,0,P),S.setAttribute("magicleap-controls",E),S.setAttribute("vive-controls",E),S.setAttribute("oculus-touch-controls",E),S.setAttribute("pico-controls",E),S.setAttribute("windows-motion-controls",E),S.setAttribute("hp-mixed-reality-controls",E)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(x,E){var S,M=E==="down",C=E==="touchstart";if(E.indexOf("touch")===0){if(C===this.touchedButtons[x])return;this.touchedButtons[x]=C}else{if(M===this.pressedButtons[x])return;this.pressedButtons[x]=M}S=this.gesture,this.gesture=this.determineGesture(),this.gesture!==S&&(this.animateGesture(this.gesture,S),this.emitGestureEvents(this.gesture,S))},determineGesture:function(){var x,E=this.pressedButtons.grip,S=this.pressedButtons.surface||this.touchedButtons.surface,M=this.pressedButtons.trackpad||this.touchedButtons.trackpad,C=this.pressedButtons.trigger||this.touchedButtons.trigger,T=this.touchedButtons.AorX||this.touchedButtons.BorY,L=b(this.el.components["tracked-controls"]);return L?E||C?x=A.fist:M&&(x=A.point):E?S||T||M?x=C?A.fist:A.point:x=C?A.thumbUp:A.pointThumb:C&&(x=A.hold),x},getClip:function(x){var E,S;for(S=0;S<this.clips.length;S++)if(E=this.clips[S],E.name===x)return E},animateGesture:function(x,E){if(x){this.playAnimation(x||A.open,E,!1);return}this.playAnimation(E,E,!0)},emitGestureEvents:function(x,E){var S=this.el,M;E!==x&&(M=v(E,!1),M&&S.emit(M),M=v(x,!0),M&&S.emit(M))},playAnimation:function(x,E,S){var M,C,T=this.el.getObject3D("mesh"),L;if(T){if(M=this.getClip(x),L=T.mixer.clipAction(M),S){L.paused=!1,L.timeScale=-1;return}if(L.clampWhenFinished=!0,L.loop=THREE.LoopOnce,L.repetitions=0,L.timeScale=1,L.time=0,L.weight=1,!E){T.mixer.stopAllAction(),L.play();return}M=this.getClip(E),L.reset(),L.play(),C=T.mixer.clipAction(M),C.crossFadeTo(L,.15,!0)}}});function v(x,E){var S;if(x){if(S=g[x],S==="grip")return S+(E?"close":"open");if(S==="point")return S+(E?"up":"down");if(S==="pointing"||S==="pistol")return S+(E?"start":"end")}}function b(x){var E=x&&x.controller,S=E&&(E.id&&E.id.indexOf("OpenVR ")===0||E.profiles&&E.profiles[0]&&E.profiles[0]==="htc-vive");return S}},"./src/components/hand-tracking-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/bind.js"),p=h("./src/utils/tracked-controls.js"),A=p.checkControllerPresentAndSetup,g=h("./src/constants/index.js").AFRAME_CDN_ROOT,v=g+"controllers/oculus-hands/v4/left.glb",b=g+"controllers/oculus-hands/v4/right.glb",x=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],E=0,S=4,M=9,C=.015,T=.1;c.exports.Component=d("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=f(this.onControllersUpdate,this),this.checkIfControllerPresent=f(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=f(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var L=0;L<this.jointEls.length;++L)this.jointEls[L].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var L=0;L<this.jointEls.length;++L)this.jointEls[L].object3D.visible=!1},init:function(){var L=this.el.sceneEl,B=L.getAttribute("webxr"),F=B.optionalFeatures;F.indexOf("hand-tracking")===-1&&(F.push("hand-tracking"),L.setAttribute("webxr",B)),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*x.length),this.jointRadii=new Float32Array(x.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},update:function(){this.updateModelColor()},updateModelColor:function(){var L=this.jointEls,B=this.skinnedMesh;B&&this.skinnedMesh.material.color.set(this.data.modelColor);for(var F=0;F<L.length;F++)L[F].setAttribute("material","color",this.data.modelColor)},updateReferenceSpace:function(){var L=this,B=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!B){var F=L.el.sceneEl.systems.webxr.sessionReferenceSpaceType;B.requestReferenceSpace(F).then(function(D){L.referenceSpace=D}).catch(function(D){throw L.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(F,"tracked-controls-webxr uses reference space "+F),D})}},checkIfControllerPresent:function(){var L=this.data,B=L.hand?L.hand:void 0;A(this,"",{hand:B,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var L=this.el.sceneEl,B=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,F=L.frame,D=this.el.components["tracked-controls-webxr"],P=this.referenceSpace;!B||!F||!P||!D||(this.hasPoses=!1,B.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=F.fillPoses(B.hand.values(),P,this.jointPoses)&&F.fillJointRadii(B.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture()))},updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(L){for(var B=this.bones,F=0;F<B.length;F++)if(B[F].name===L)return B[F];return null},updateHandMeshModel:function(){var L=new THREE.Matrix4;return function(){var B=0,F=this.jointPoses,D=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!D||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var P of D.hand.values()){var U=this.getBone(P.jointName);U!=null&&(this.mesh.visible=!0,L.fromArray(F,B*16),U.position.setFromMatrixPosition(L),U.quaternion.setFromRotationMatrix(L)),B++}}}(),updateHandDotsModel:function(){for(var L=this.jointPoses,B=this.jointRadii,F=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,D,P,U=0;U<F.hand.size;U++)D=this.jointEls[U],P=D.object3D,D.object3D.visible=this.hasPoses,this.hasPoses&&(P.matrix.fromArray(L,U*16),P.matrix.decompose(P.position,P.rotation,P.scale),D.setAttribute("scale",{x:B[U],y:B[U],z:B[U]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var L=new THREE.Vector3,B=new THREE.Matrix4;return function(){var F=this.indexTipPosition,D=this.pinchEventDetail;if(this.hasPoses){L.setFromMatrixPosition(B.fromArray(this.jointPoses,S*16)),F.setFromMatrixPosition(B.fromArray(this.jointPoses,M*16)),D.wristRotation.setFromRotationMatrix(B.fromArray(this.jointPoses,E*16));var P=F.distanceTo(L);P<C&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=P,D.position.copy(F).add(L).multiplyScalar(.5),this.el.emit("pinchstarted",D)),P>this.pinchDistance+this.pinchDistance*T&&this.isPinched===!0&&(this.isPinched=!1,D.position.copy(F).add(L).multiplyScalar(.5),this.el.emit("pinchended",D)),this.isPinched&&(D.position.copy(F).add(L).multiplyScalar(.5),this.el.emit("pinchmoved",D))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var L=this.el,B=this.data;if(L.setAttribute("tracked-controls",{id:"",hand:B.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==L.getObject3D("mesh")&&L.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var L=this.el,B;this.checkIfControllerPresent(),B=L.components["tracked-controls"]&&L.components["tracked-controls"].controller,this.mesh&&B&&B.hand&&B.hand instanceof XRHand&&L.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var L=this.data;L.modelStyle==="dots"&&this.initDotsModel(),L.modelStyle==="mesh"&&this.initMeshHandModel()},initDotsModel:function(){if(this.jointEls.length===0)for(var L=0;L<x.length;++L){var B=this.jointEl=document.createElement("a-entity");B.setAttribute("geometry",{primitive:"sphere",radius:1}),B.setAttribute("material",{color:this.data.modelColor}),B.object3D.visible=!1,this.el.appendChild(B),this.jointEls.push(B)}},initMeshHandModel:function(){var L=this.data.hand==="left"?v:b;this.el.setAttribute("gltf-model",L)},onModelLoaded:function(){var L=this.mesh=this.el.getObject3D("mesh").children[0],B=this.skinnedMesh=L.getObjectByProperty("type","SkinnedMesh");this.skinnedMesh&&(this.bones=B.skeleton.bones,this.el.removeObject3D("mesh"),L.position.set(0,0,0),L.rotation.set(0,0,0),B.frustumCulled=!1,B.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",L))}})},"./src/components/hand-tracking-grab-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js");d("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var p=this.el,A=this.data,g;A.hand==="right"?g="components.hand-tracking-controls.bones.3":g="components.hand-tracking-controls.bones.21",p.setAttribute("hand-tracking-controls",{hand:A.hand}),p.setAttribute("obb-collider",{trackedObject3D:g,size:.04}),this.auxMatrix=new f.Matrix4,this.auxQuaternion=new f.Quaternion,this.auxQuaternion2=new f.Quaternion,this.auxVector=new f.Vector3,this.auxVector2=new f.Vector3,this.grabbingObjectPosition=new f.Vector3,this.grabbedObjectPosition=new f.Vector3,this.grabbedObjectPositionDelta=new f.Vector3,this.grabDeltaPosition=new f.Vector3,this.grabInitialRotation=new f.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var p,A=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),g=0;g<A.length;++g)p=A[g].components["hand-tracking-grab-controls"],p!==this&&this.grabbedEl&&this.grabbedEl===p.grabbedEl&&p.releaseGrabbedEntity();return!1},onCollisionStarted:function(p){var A=p.detail.withEl;this.collidedEl||A.getAttribute("grabbable")&&(this.collidedEl=A,this.grabbingObject3D=p.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(p){this.collidedEl&&(this.pinchPosition=p.detail.position,this.wristRotation=p.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(p){this.wristRotation=p.detail.wristRotation},releaseGrabbedEntity:function(){var p=this.grabbedEl;p&&(p.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,p.object3D.matrixAutoUpdate=!0,p.object3D.matrixWorldAutoUpdate=!0,p.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),p.object3D.position.copy(this.auxVector),p.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:p}),this.grabbedEl=void 0)},grab:function(){var p=this.grabbedEl,A;A=p.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(A).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=p.object3D.updateMatrixWorld,p.object3D.updateMatrixWorld=function(){},p.object3D.updateMatrixWorldChildren=function(g){for(var v=this.children,b=0,x=v.length;b<x;b++){var E=v[b];(E.matrixWorldAutoUpdate===!0||g===!0)&&E.updateMatrixWorld(!0)}},p.object3D.matrixAutoUpdate=!1,p.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:p})},tock:function(){var p=this.auxMatrix,A=this.auxQuaternion,g=this.auxQuaternion2,v,b=this.grabbedEl;b&&(v=b.object3D,v.getWorldQuaternion(g),v.matrixWorld.identity(),p.identity(),p.makeTranslation(this.pinchPosition),v.matrixWorld.multiply(p),p.identity(),p.makeRotationFromQuaternion(A.copy(this.wristRotation).multiply(this.grabInitialRotation)),v.matrixWorld.multiply(p),p.identity(),p.makeTranslation(this.grabDeltaPosition),v.matrixWorld.multiply(p),p.identity(),p.makeRotationFromQuaternion(g),v.matrixWorld.multiply(p),p.makeScale(b.object3D.scale.x,b.object3D.scale.y,b.object3D.scale.z),v.matrixWorld.multiply(p),v.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;c.exports.Component=d("hide-on-enter-ar",{init:function(){var f=this;this.el.sceneEl.addEventListener("enter-vr",function(){f.el.sceneEl.is("ar-mode")&&(f.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){f.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(c,u,h)=>{var d=h("./src/utils/bind.js"),f=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),A=h("./src/utils/tracked-controls.js"),g=A.checkControllerPresentAndSetup,v=A.emitIfAxesChanged,b=A.onButtonEvent,x="hp-mixed-reality",E=h("./src/constants/index.js").AFRAME_CDN_ROOT,S=E+"controllers/hp/mixed-reality/",M={x:0,y:0,z:.06},C={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},T={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};c.exports.Component=f("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:T,init:function(){var L=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=d(this.onButtonChanged,this),this.onButtonDown=function(B){b(B.detail.id,"down",L,L.data.hand)},this.onButtonUp=function(B){b(B.detail.id,"up",L,L.data.hand)},this.onButtonTouchEnd=function(B){b(B.detail.id,"touchend",L,L.data.hand)},this.onButtonTouchStart=function(B){b(B.detail.id,"touchstart",L,L.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var L=this.data;this.controllerIndex=L.hand==="right"?0:L.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=d(this.onModelLoaded,this),this.onControllersUpdate=d(this.onControllersUpdate,this),this.checkIfControllerPresent=d(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=d(this.removeControllersUpdateListener,this),this.onAxisMoved=d(this.onAxisMoved,this)},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("axismove",this.onAxisMoved),L.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("axismove",this.onAxisMoved),L.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var L=this.data;g(this,x,{index:this.controllerIndex,hand:L.hand})},injectTrackedControls:function(){var L=this.el,B=this.data;L.setAttribute("tracked-controls",{idPrefix:x,hand:B.hand,controller:this.controllerIndex,orientationOffset:B.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",S+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(L){var B=this.mapping[this.data.hand].buttons[L.detail.id],F;B&&(B==="trigger"&&(F=L.detail.state.value,console.log("analog value of trigger press: "+F)),this.el.emit(B+"changed",L.detail.state))},onModelLoaded:function(L){var B=L.detail.model;this.data.model&&(B.position.copy(M),B.rotation.copy(C),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new p.Vector3(0,0,0)}))},onAxisMoved:function(L){v(this,this.mapping.axes,L)}})},"./src/components/index.js":(c,u,h)=>{h("./src/components/animation.js"),h("./src/components/anchored.js"),h("./src/components/camera.js"),h("./src/components/cursor.js"),h("./src/components/geometry.js"),h("./src/components/generic-tracked-controller-controls.js"),h("./src/components/gltf-model.js"),h("./src/components/grabbable.js"),h("./src/components/hand-tracking-controls.js"),h("./src/components/hand-tracking-grab-controls.js"),h("./src/components/hand-controls.js"),h("./src/components/hide-on-enter-ar.js"),h("./src/components/hp-mixed-reality-controls.js"),h("./src/components/layer.js"),h("./src/components/laser-controls.js"),h("./src/components/light.js"),h("./src/components/line.js"),h("./src/components/link.js"),h("./src/components/look-controls.js"),h("./src/components/magicleap-controls.js"),h("./src/components/material.js"),h("./src/components/obb-collider.js"),h("./src/components/obj-model.js"),h("./src/components/oculus-go-controls.js"),h("./src/components/oculus-touch-controls.js"),h("./src/components/pico-controls.js"),h("./src/components/position.js"),h("./src/components/raycaster.js"),h("./src/components/rotation.js"),h("./src/components/scale.js"),h("./src/components/shadow.js"),h("./src/components/sound.js"),h("./src/components/text.js"),h("./src/components/tracked-controls.js"),h("./src/components/tracked-controls-webvr.js"),h("./src/components/tracked-controls-webxr.js"),h("./src/components/visible.js"),h("./src/components/valve-index-controls.js"),h("./src/components/vive-controls.js"),h("./src/components/vive-focus-controls.js"),h("./src/components/wasd-controls.js"),h("./src/components/windows-motion-controls.js"),h("./src/components/scene/ar-hit-test.js"),h("./src/components/scene/background.js"),h("./src/components/scene/debug.js"),h("./src/components/scene/device-orientation-permission-ui.js"),h("./src/components/scene/embedded.js"),h("./src/components/scene/inspector.js"),h("./src/components/scene/fog.js"),h("./src/components/scene/keyboard-shortcuts.js"),h("./src/components/scene/pool.js"),h("./src/components/scene/real-world-meshing.js"),h("./src/components/scene/reflection.js"),h("./src/components/scene/screenshot.js"),h("./src/components/scene/stats.js"),h("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/index.js");d("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var p=this.config,A=this.data,g=this.el,v=this,b={hand:A.hand,model:A.model};g.setAttribute("hp-mixed-reality-controls",b),g.setAttribute("magicleap-controls",b),g.setAttribute("oculus-go-controls",b),g.setAttribute("oculus-touch-controls",b),g.setAttribute("pico-controls",b),g.setAttribute("valve-index-controls",b),g.setAttribute("vive-controls",b),g.setAttribute("vive-focus-controls",b),g.setAttribute("windows-motion-controls",b),g.setAttribute("generic-tracked-controller-controls",{hand:b.hand}),g.addEventListener("controllerconnected",x),g.addEventListener("controllerdisconnected",E),g.addEventListener("controllermodelready",function(S){x(S),v.modelReady=!0});function x(S){var M=p[S.detail.name];if(M){var C=f.extend({showLine:!0},M.raycaster||{});S.detail.rayOrigin&&(C.origin=S.detail.rayOrigin.origin,C.direction=S.detail.rayOrigin.direction,C.showLine=!0),S.detail.rayOrigin||!v.modelReady?g.setAttribute("raycaster",C):g.setAttribute("raycaster","showLine",!0),g.setAttribute("cursor",f.extend({fuse:!1},M.cursor))}}function E(S){var M=p[S.detail.name];M&&g.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/index.js"),p=f.debug("components:layer:warn");c.exports.Component=d("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var g=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=g.createFramebuffer();var v=this.el.sceneEl.getAttribute("webxr"),b=v.optionalFeatures;b.indexOf("layers")===-1&&(b.push("laters"),this.el.sceneEl.setAttribute("webxr",v)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(g){this.data.src!==g.src&&this.updateSrc()},updateSrc:function(){var g=this.data.type;if(this.texture=void 0,g==="quad"){this.loadQuadImage();return}if(g==="monocubemap"||g==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var g,v=this.xrGLFactory,b=this.el.sceneEl.frame,x=this.data.src,E=this.data.type;this.visibilityChanged=!1,this.layer&&(E!=="monocubemap"&&E!=="stereocubemap"||(x.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,E==="monocubemap"?(g=v.getSubImage(this.layer,b),this.loadCubeMapImage(g.colorTexture,x,0)):(g=v.getSubImage(this.layer,b,"left"),this.loadCubeMapImage(g.colorTexture,x,0),g=v.getSubImage(this.layer,b,"right"),this.loadCubeMapImage(g.colorTexture,x,6))))},loadQuadImage:function(){var g=this.data.src,v=this;this.el.sceneEl.systems.material.loadTexture(g,{src:g},function(x){v.el.sceneEl.renderer.initTexture(x),v.texture=x,g.tagName==="VIDEO"&&setTimeout(function(){v.textureIsVideo=!0},1e3),v.layer&&(v.layer.height=v.data.height/2||v.texture.image.height/1e3,v.layer.width=v.data.width/2||v.texture.image.width/1e3,v.needsRedraw=!0),v.updateQuadPanel()})},preGenerateCubeMapTextures:function(g,v){this.data.type==="monocubemap"?this.generateCubeMapTextures(g,0,v):(this.generateCubeMapTextures(g,0,v),this.generateCubeMapTextures(g,6,v))},generateCubeMapTextures:function(g,v,b){for(var x=this.data,E=this.cubeFaceSize,S=Math.min(g.width,g.height),M=[],C,T,L=0;L<6;L++){var B=document.createElement("CANVAS");B.width=B.height=E;var F=B.getContext("2d");x.rotateCubemap&&(L===2||L===3)&&(F.save(),F.translate(E,E),F.rotate(Math.PI)),F.drawImage(g,(L+v)*S,0,S,S,0,0,E,E),F.restore(),b&&b(),M.push(B)}return x.rotateCubemap&&(C=M[0],T=M[1],M[0]=T,M[1]=C,C=M[4],T=M[5],M[4]=T,M[5]=C),b&&b(),M},loadCubeMapImage:function(g,v,b){var x=this.el.sceneEl.renderer.getContext(),E;x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,!1),x.bindTexture(x.TEXTURE_CUBE_MAP,g),!v.complete||this.loadingScreen?E=this.loadingScreenImages:E=this.generateCubeMapTextures(v,b);var S=0;E.forEach(function(M,C){x.texSubImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+C,0,0,0,x.RGBA,x.UNSIGNED_BYTE,M),S=x.getError()}),S!==0&&console.log("renderingError, WebGL Error Code: "+S),x.bindTexture(x.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var g=this,v=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(b){g.visibilityChanged=b.session.visibilityState!=="hidden"},v==="quad"){this.initQuadLayer();return}if(v==="monocubemap"||v==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var g=this.el.sceneEl,v=g.renderer.getContext(),b=this.xrGLFactory=new XRWebGLBinding(g.xrSession,v);this.texture&&(this.layer=b.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),g.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var g=this.data.src,v=this.el.sceneEl,b=v.renderer.getContext(),x=b.getParameter(b.MAX_CUBE_MAP_TEXTURE_SIZE),E=this.cubeFaceSize=Math.min(x,Math.min(g.width,g.height)),S=this.xrGLFactory=new XRWebGLBinding(v.xrSession,b);this.layer=S.createCubeLayer({space:this.referenceSpace,viewPixelWidth:E,viewPixelHeight:E,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),v.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var g=this.cubeFaceSize,v=this.loadingScreenImages=[],b=0;b<6;b++){var x=document.createElement("CANVAS");x.width=x.height=g;var E=x.getContext("2d");x.width=x.height=g,E.fillStyle="black",E.fillRect(0,0,g,g),b!==2&&b!==3&&(E.translate(g,0),E.scale(-1,1),E.fillStyle="white",E.font="30px Arial",E.fillText("Loading",g/2,g/2)),v.push(x)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(g){this.layerEnabled=g,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var g=this.quadPanelEl;this.quadPanelEl||(g=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(g)),g.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),g.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var g=this.el.sceneEl,v=this.el.sceneEl.renderer.getContext(),b=this.xrGLFactory.getSubImage(this.layer,g.frame),x=g.renderer.properties.get(this.texture).__webglTexture,E=v.getParameter(v.FRAMEBUFFER_BINDING);v.viewport(b.viewport.x,b.viewport.y,b.viewport.width,b.viewport.height),v.bindFramebuffer(v.FRAMEBUFFER,this.frameBuffer),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,b.colorTexture,0),A(v,x,b,this.data.src),v.bindFramebuffer(v.FRAMEBUFFER,E)},updateTransform:function(){var g=this.el,v=this.position,b=this.quaternion;g.object3D.updateMatrixWorld(),v.setFromMatrixPosition(g.object3D.matrixWorld),b.setFromRotationMatrix(g.object3D.matrixWorld),this.layerEnabled||v.set(0,0,1e8),this.layer.transform=new XRRigidTransform(v,b)},onEnterVR:function(){var g=this.el.sceneEl,v=g.xrSession;if(!g.hasWebXR||!XRWebGLBinding||!v){p("The layer component requires WebXR and the layers API enabled");return}v.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(g){this.referenceSpace=g}});function A(g,v,b,x){var E=g.createFramebuffer(),S=b.viewport.x,M=b.viewport.y,C=b.viewport.x+b.viewport.width,T=b.viewport.y+b.viewport.height;x.tagName==="VIDEO"&&(g.bindTexture(g.TEXTURE_2D,v),g.texSubImage2D(g.TEXTURE_2D,0,0,0,x.width,x.height,g.RGB,g.UNSIGNED_BYTE,x)),g.bindFramebuffer(g.READ_FRAMEBUFFER,E),g.framebufferTexture2D(g.READ_FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,v,0),g.readBuffer(g.COLOR_ATTACHMENT0),g.blitFramebuffer(0,0,x.width,x.height,S,M,C,T,g.COLOR_BUFFER_BIT,g.NEAREST),g.bindFramebuffer(g.READ_FRAMEBUFFER,null),g.deleteFramebuffer(E)}},"./src/components/light.js":(c,u,h)=>{var d=h("./src/utils/bind.js"),f=h("./src/utils/index.js"),p=f.diff,A=h("./src/utils/debug.js"),g=h("./src/core/component.js").registerComponent,v=h("./src/lib/three.js"),b=h("./src/utils/math.js"),x=v.MathUtils.degToRad,E=A("components:light:warn"),S=new v.CubeTextureLoader,M={};c.exports.Component=g("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var C=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(C)},update:function(C){var T=this.data,L=p(T,C),B=this.light,F=this;if(B&&!("type"in L)){var D=!1;Object.keys(L).forEach(function(P){var U=T[P];switch(P){case"color":{B.color.set(U);break}case"groundColor":{B.groundColor.set(U);break}case"angle":{B.angle=x(U);break}case"target":{U===null?(T.type==="spot"||T.type==="directional")&&(B.target=F.defaultTarget):U.hasLoaded?F.onSetTarget(U,B):U.addEventListener("loaded",d(F.onSetTarget,F,U,B));break}case"envMap":F.updateProbeMap(T,B);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":D||(F.updateShadow(),D=!0);break;case"shadowCameraAutomatic":T.shadowCameraAutomatic?F.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(T.shadowCameraAutomatic)):F.shadowCameraAutomaticEls=[];break;default:B[P]=U}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var C=new v.Box3,T=new v.Vector3,L=new v.Vector3,B=new v.Matrix4,F=new v.Sphere,D=new v.Vector3;return function(){if(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof v.OrthographicCamera&&this.shadowCameraAutomaticEls.length){var P=this.light.shadow.camera;P.getWorldDirection(T),P.getWorldPosition(L),B.copy(P.matrixWorld),B.invert(),P.near=1,P.left=1e5,P.right=-1e5,P.top=-1e5,P.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(U){C.setFromObject(U.object3D),C.getBoundingSphere(F);var K=b.distanceOfPointFromPlane(L,T,F.center),J=b.nearestPointInPlane(L,T,F.center,D),z=J.applyMatrix4(B);P.near=Math.min(-K-F.radius-1,P.near),P.left=Math.min(-F.radius+z.x,P.left),P.right=Math.max(F.radius+z.x,P.right),P.top=Math.max(F.radius+z.y,P.top),P.bottom=Math.min(-F.radius+z.y,P.bottom)}),P.updateProjectionMatrix()}}}(),setLight:function(C){var T=this.el,L=this.getLight(C);L&&(this.light&&T.removeObject3D("light"),this.light=L,this.light.el=T,T.setObject3D("light",this.light),(C.type==="spot"||C.type==="directional"||C.type==="hemisphere")&&T.getObject3D("light").translateY(-1),C.type==="spot"&&(T.setObject3D("light-target",this.defaultTarget),T.getObject3D("light-target").position.set(0,0,-1)),C.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(C.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var C=this.el,T=this.data,L=this.light;L.castShadow=T.castShadow;var B=C.getObject3D("cameraHelper");if(T.shadowCameraVisible&&!B?C.setObject3D("cameraHelper",new v.CameraHelper(L.shadow.camera)):!T.shadowCameraVisible&&B&&C.removeObject3D("cameraHelper"),!T.castShadow)return L;L.shadow.bias=T.shadowBias,L.shadow.radius=T.shadowRadius,L.shadow.mapSize.height=T.shadowMapHeight,L.shadow.mapSize.width=T.shadowMapWidth,L.shadow.camera.near=T.shadowCameraNear,L.shadow.camera.far=T.shadowCameraFar,L.shadow.camera instanceof v.OrthographicCamera?(L.shadow.camera.top=T.shadowCameraTop,L.shadow.camera.right=T.shadowCameraRight,L.shadow.camera.bottom=T.shadowCameraBottom,L.shadow.camera.left=T.shadowCameraLeft):L.shadow.camera.fov=T.shadowCameraFov,L.shadow.camera.updateProjectionMatrix(),B&&B.update()},getLight:function(C){var T=C.angle,L=new v.Color(C.color);L=L.getHex();var B=C.decay,F=C.distance,D=new v.Color(C.groundColor);D=D.getHex();var P=C.intensity,U=C.type,K=C.target,J=null;switch(U.toLowerCase()){case"ambient":return new v.AmbientLight(L,P);case"directional":return J=new v.DirectionalLight(L,P),this.defaultTarget=J.target,K&&(K.hasLoaded?this.onSetTarget(K,J):K.addEventListener("loaded",d(this.onSetTarget,this,K,J))),J;case"hemisphere":return new v.HemisphereLight(L,D,P);case"point":return new v.PointLight(L,P,F,B);case"spot":return J=new v.SpotLight(L,P,F,x(T),C.penumbra,B),this.defaultTarget=J.target,K&&(K.hasLoaded?this.onSetTarget(K,J):K.addEventListener("loaded",d(this.onSetTarget,this,K,J))),J;case"probe":return J=new v.LightProbe,this.updateProbeMap(C,J),J;default:E("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",U)}},updateProbeMap:function(C,T){C.envMap||T.copy(new v.LightProbe),M[C.envMap]instanceof window.Promise&&M[C.envMap].then(function(L){T.copy(L)}),M[C.envMap]instanceof v.LightProbe&&T.copy(M[C.envMap]),M[C.envMap]=new window.Promise(function(L){f.srcLoader.validateCubemapSrc(C.envMap,function(F){S.load(F,function(D){var P=v.LightProbeGenerator.fromCubeTexture(D);M[C.envMap]=P,T.copy(P)})})})},onSetTarget:function(C,T){T.target=C.object3D},remove:function(){var C=this.el;C.removeObject3D("light"),C.getObject3D("cameraHelper")&&C.removeObject3D("cameraHelper")}})},"./src/components/line.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;c.exports.Component=d("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var p=this.data,A,g;g=this.material=new THREE.LineBasicMaterial({color:p.color,opacity:p.opacity,transparent:p.opacity<1,visible:p.visible}),A=this.geometry=new THREE.BufferGeometry,A.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(A,g),this.el.setObject3D(this.attrName,this.line)},update:function(p){var A=this.data,g=this.geometry,v=!1,b=this.material,x=g.attributes.position.array;f(A.start,p.start)||(x[0]=A.start.x,x[1]=A.start.y,x[2]=A.start.z,v=!0),f(A.end,p.end)||(x[3]=A.end.x,x[4]=A.end.y,x[5]=A.end.z,v=!0),v&&(g.attributes.position.needsUpdate=!0,g.computeBoundingSphere()),b.color.setStyle(A.color),b.opacity=A.opacity,b.transparent=A.opacity<1,b.visible=A.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function f(p,A){return!p||!A?!1:p.x===A.x&&p.y===A.y&&p.z===A.z}},"./src/components/link.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/core/shader.js").registerShader,p=h("./src/lib/three.js");c.exports.Component=d("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new p.Quaternion,this.hiddenEls=[]},update:function(A){var g=this.data,v=this.el,b,x;g.visualAspectEnabled&&(this.initVisualAspect(),b=g.highlighted?g.highlightedColor:g.backgroundColor,x=g.highlighted?g.highlightedColor:g.borderColor,v.setAttribute("material","backgroundColor",b),v.setAttribute("material","strokeColor",x),g.on!==A.on&&this.updateEventListener(),A.peekMode!==void 0&&g.peekMode!==A.peekMode&&this.updatePeekMode(),!(!g.image||A.image===g.image)&&v.setAttribute("material","pano",typeof g.image=="string"?g.image:g.image.src))},updatePeekMode:function(){var A=this.el,g=this.sphereEl;this.data.peekMode?(this.hideAll(),A.getObject3D("mesh").visible=!1,g.setAttribute("visible",!0)):(this.showAll(),A.getObject3D("mesh").visible=!0,g.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var A=this.el;A.isPlaying&&(this.removeEventListener(),A.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var A=this.data.on;A&&this.el.removeEventListener(A,this.navigate)},initVisualAspect:function(){var A=this.el,g,v,b;!this.data.visualAspectEnabled||this.visualAspectInitialized||(b=this.textEl=this.textEl||document.createElement("a-entity"),v=this.sphereEl=this.sphereEl||document.createElement("a-entity"),g=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),A.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),A.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),b.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),b.setAttribute("position","0 1.5 0"),A.appendChild(b),g.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),g.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),g.setAttribute("rotation","0 180 0"),g.setAttribute("position","0 0 0"),g.setAttribute("visible",!1),A.appendChild(g),v.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),v.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),v.setAttribute("visible",!1),A.appendChild(v),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var A=new p.Vector3,g=new p.Vector3,v=new p.Quaternion,b=new p.Vector3;return function(){var x=this.el,E=x.object3D,S=x.sceneEl.camera,M,C,T=this.textEl;if(this.data.visualAspectEnabled)if(E.updateMatrixWorld(),S.parent.updateMatrixWorld(),S.updateMatrixWorld(),E.matrix.decompose(g,v,b),g.setFromMatrixPosition(E.matrixWorld),A.setFromMatrixPosition(S.matrixWorld),C=g.distanceTo(A),C>20)this.previousQuaternion||(this.quaternionClone.copy(v),this.previousQuaternion=this.quaternionClone),E.lookAt(A);else{if(M=this.calculateCameraPortalOrientation(),C<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;T.setAttribute("text","width",1.5),M<=0?(T.setAttribute("position","0 0 0.75"),T.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(T.setAttribute("position","0 0 -0.75"),T.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),x.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=M}else M<=0?T.setAttribute("rotation","0 180 0"):T.setAttribute("rotation","0 0 0"),T.setAttribute("text","width",5),T.setAttribute("position","0 1.5 0"),x.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(E.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var A=this.el,g=this.hiddenEls,v=this;g.length>0||A.sceneEl.object3D.traverse(function(b){b&&b.el&&b.el.hasAttribute("link-controls")||!b.el||b===A.sceneEl.object3D||b.el===A||b.el===v.sphereEl||b.el===A.sceneEl.cameraEl||b.el.getAttribute("visible")===!1||b.el===v.textEl||b.el===v.semiSphereEl||(b.el.setAttribute("visible",!1),g.push(b.el))})},showAll:function(){this.hiddenEls.forEach(function(A){A.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var A=new p.Matrix4,g=new p.Vector3,v=new p.Vector3(0,0,1),b=new p.Vector3(0,0,0);return function(){var x=this.el,E=x.sceneEl.camera;return g.set(0,0,0),v.set(0,0,1),b.set(0,0,0),x.object3D.matrixWorld.extractRotation(A),v.applyMatrix4(A),x.object3D.updateMatrixWorld(),x.object3D.localToWorld(b),E.parent.parent.updateMatrixWorld(),E.parent.updateMatrixWorld(),E.updateMatrixWorld(),E.localToWorld(g),g.sub(b).normalize(),v.normalize(),Math.sign(v.dot(g))}}(),remove:function(){this.removeEventListener()}}),f("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js"),p=h("./src/utils/index.js"),A=p.bind,g=Math.PI/2;c.exports.Component=d("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new f.Vector3,this.hmdQuaternion=new f.Quaternion,this.magicWindowAbsoluteEuler=new f.Euler,this.magicWindowDeltaEuler=new f.Euler,this.position=new f.Vector3,this.magicWindowObject=new f.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new f.Vector3,rotation:new f.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var v,b=this.data;(p.device.isMobile()||p.device.isMobileDeviceRequestingDesktopSite())&&(v=this.magicWindowControls=new f.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(v.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?v.enabled=b.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){v.enabled=b.magicWindowTrackingEnabled})))},update:function(v){var b=this.data;b.enabled!==v.enabled&&this.updateGrabCursor(b.enabled),v&&!b.magicWindowTrackingEnabled&&v.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=b.magicWindowTrackingEnabled),v&&!b.pointerLockEnabled!==v.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(v){var b=this.data;b.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=A(this.onMouseDown,this),this.onMouseMove=A(this.onMouseMove,this),this.onMouseUp=A(this.onMouseUp,this),this.onTouchStart=A(this.onTouchStart,this),this.onTouchMove=A(this.onTouchMove,this),this.onTouchEnd=A(this.onTouchEnd,this),this.onEnterVR=A(this.onEnterVR,this),this.onExitVR=A(this.onExitVR,this),this.onPointerLockChange=A(this.onPointerLockChange,this),this.onPointerLockError=A(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new f.Object3D,this.yawObject=new f.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var v=this.el.sceneEl,b=v.canvas;if(!b){v.addEventListener("render-target-loaded",A(this.addEventListeners,this));return}b.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),b.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),v.addEventListener("enter-vr",this.onEnterVR),v.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var v=this.el.sceneEl,b=v&&v.canvas;b&&(b.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),b.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),v.removeEventListener("enter-vr",this.onEnterVR),v.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var v=this.el.object3D,b=this.pitchObject,x=this.yawObject,E=this.el.sceneEl;(E.is("vr-mode")||E.is("ar-mode"))&&E.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),v.rotation.x=this.magicWindowDeltaEuler.x+b.rotation.x,v.rotation.y=this.magicWindowDeltaEuler.y+x.rotation.y,v.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var v=this.magicWindowAbsoluteEuler,b=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),v.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&v.y!==0&&(this.previousMagicWindowYaw=v.y),this.previousMagicWindowYaw&&(b.x=v.x,b.y+=v.y-this.previousMagicWindowYaw,b.z=v.z,this.previousMagicWindowYaw=v.y))},onMouseMove:function(v){var b,x,E,S=this.pitchObject,M=this.previousMouseEvent,C=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(x=v.movementX||v.mozMovementX||0,E=v.movementY||v.mozMovementY||0):(x=v.screenX-M.screenX,E=v.screenY-M.screenY),this.previousMouseEvent.screenX=v.screenX,this.previousMouseEvent.screenY=v.screenY,b=this.data.reverseMouseDrag?1:-1,C.rotation.y+=x*.002*b,S.rotation.x+=E*.002*b,S.rotation.x=Math.max(-g,Math.min(g,S.rotation.x)))},onMouseDown:function(v){var b=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(b.is("vr-mode")||b.is("ar-mode"))&&b.checkHeadsetConnected())&&v.button===0){var x=b&&b.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=v.screenX,this.previousMouseEvent.screenY=v.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(x.requestPointerLock?x.requestPointerLock():x.mozRequestPointerLock&&x.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(v){v.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:v.touches[0].pageX,y:v.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(v){var b,x=this.el.sceneEl.canvas,E,S=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(E=2*Math.PI*(v.touches[0].pageX-this.touchStart.x)/x.clientWidth,b=this.data.reverseTouchDrag?1:-1,S.rotation.y-=E*.5*b,this.touchStart={x:v.touches[0].pageX,y:v.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var v=this.el.sceneEl;v.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),v.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(v){var b=this.el.sceneEl;function x(){b.canvas.classList.add("a-grab-cursor")}function E(){b.canvas.classList.remove("a-grab-cursor")}if(!b.canvas){v?b.addEventListener("render-target-loaded",x):b.addEventListener("render-target-loaded",E);return}if(v){x();return}E()},saveCameraPose:function(){var v=this.el;this.savedPose.position.copy(v.object3D.position),this.savedPose.rotation.copy(v.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var v=this.el,b=this.savedPose;this.hasSavedPose&&(v.object3D.position.copy(b.position),v.object3D.rotation.copy(b.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(c,u,h)=>{var d=h("./src/utils/bind.js"),f=h("./src/core/component.js").registerComponent,p=h("./src/utils/tracked-controls.js"),A=p.checkControllerPresentAndSetup,g=p.emitIfAxesChanged,v=p.onButtonEvent,b="magicleap",x="-one",E=b+x,S=h("./src/constants/index.js").AFRAME_CDN_ROOT,M=S+"controllers/magicleap/magicleap-one-controller.glb",C={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};c.exports.Component=f("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:C,init:function(){var T=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=d(this.onButtonChanged,this),this.onButtonDown=function(L){v(L.detail.id,"down",T)},this.onButtonUp=function(L){v(L.detail.id,"up",T)},this.onButtonTouchEnd=function(L){v(L.detail.id,"touchend",T)},this.onButtonTouchStart=function(L){v(L.detail.id,"touchstart",T)},this.previousButtonValues={},this.bindMethods()},update:function(){var T=this.data;this.controllerIndex=T.hand==="right"?0:T.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=d(this.onModelLoaded,this),this.onControllersUpdate=d(this.onControllersUpdate,this),this.checkIfControllerPresent=d(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=d(this.removeControllersUpdateListener,this),this.onAxisMoved=d(this.onAxisMoved,this)},addEventListeners:function(){var T=this.el;T.addEventListener("buttonchanged",this.onButtonChanged),T.addEventListener("buttondown",this.onButtonDown),T.addEventListener("buttonup",this.onButtonUp),T.addEventListener("touchstart",this.onButtonTouchStart),T.addEventListener("touchend",this.onButtonTouchEnd),T.addEventListener("axismove",this.onAxisMoved),T.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var T=this.el;T.removeEventListener("buttonchanged",this.onButtonChanged),T.removeEventListener("buttondown",this.onButtonDown),T.removeEventListener("buttonup",this.onButtonUp),T.removeEventListener("touchstart",this.onButtonTouchStart),T.removeEventListener("touchend",this.onButtonTouchEnd),T.removeEventListener("axismove",this.onAxisMoved),T.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var T=this.data;A(this,E,{index:this.controllerIndex,hand:T.hand})},injectTrackedControls:function(){var T=this.el,L=this.data;T.setAttribute("tracked-controls",{idPrefix:E,hand:L.hand,controller:this.controllerIndex,orientationOffset:L.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",M)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(T){var L=this.mapping.buttons[T.detail.id],B;L&&(L==="trigger"&&(B=T.detail.state.value,console.log("analog value of trigger press: "+B)),this.el.emit(L+"changed",T.detail.state))},onModelLoaded:function(T){var L=T.detail.model;L.scale.set(.01,.01,.01)},onAxisMoved:function(T){g(this,this.mapping.axes,T)},updateModel:function(T,L){},setButtonColor:function(T,L){}})},"./src/components/material.js":(c,u,h)=>{var d=h("./src/utils/index.js"),f=h("./src/core/component.js"),p=h("./src/lib/three.js"),A=h("./src/core/shader.js"),g=d.debug("components:material:error"),v=f.registerComponent,b=A.shaders,x=A.shaderNames;c.exports.Component=v("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:x,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(C){var T=this.data;(!this.shader||T.shader!==C.shader)&&this.updateShader(T.shader),this.shader.update(this.data),this.updateMaterial(C)},updateSchema:function(C){var T,L,B,F;L=C&&C.shader,T=this.oldData&&this.oldData.shader,F=L||T,B=b[F]&&b[F].schema,B||g("Unknown shader schema "+F),!(T&&L===T)&&(this.extendSchema(B),this.updateBehavior())},updateBehavior:function(){var C,T=this.el.sceneEl,L=this.schema,B=this,F;function D(P,U){var K;for(K in F)F[K]=P;B.shader.update(F)}this.tick=void 0,F={};for(C in L)L[C].type==="time"&&(this.tick=D,F[C]=!0);T&&(this.tick?T.addBehavior(this):T.removeBehavior(this))},updateShader:function(C){var T=this.data,L=b[C]&&b[C].Shader,B;if(!L)throw new Error("Unknown shader "+C);B=this.shader=new L,B.el=this.el,B.init(T),this.setMaterial(B.material),this.updateSchema(T)},updateMaterial:function(C){var T=this.data,L=this.material,B;L.alphaTest=T.alphaTest,L.depthTest=T.depthTest!==!1,L.depthWrite=T.depthWrite!==!1,L.opacity=T.opacity,L.flatShading=T.flatShading,L.side=E(T.side),L.transparent=T.transparent!==!1||T.opacity<1,L.vertexColors=T.vertexColorsEnabled,L.visible=T.visible,L.blending=S(T.blending),L.dithering=T.dithering;for(B in C)break;B&&(C.alphaTest!==T.alphaTest||C.side!==T.side||C.vertexColorsEnabled!==T.vertexColorsEnabled)&&(L.needsUpdate=!0)},remove:function(){var C=new p.MeshBasicMaterial,T=this.material,L=this.el.getObject3D("mesh");L&&(L.material=C),M(T,this.system)},setMaterial:function(C){var T=this.el,L,B=this.system;this.material&&M(this.material,B),this.material=C,B.registerMaterial(C),L=T.getObject3D("mesh"),L?L.material=C:T.addEventListener("object3dset",function F(D){D.detail.type!=="mesh"||D.target!==T||(T.getObject3D("mesh").material=C,T.removeEventListener("object3dset",F))})}});function E(C){switch(C){case"back":return p.BackSide;case"double":return p.DoubleSide;default:return p.FrontSide}}function S(C){switch(C){case"none":return p.NoBlending;case"additive":return p.AdditiveBlending;case"subtractive":return p.SubtractiveBlending;case"multiply":return p.MultiplyBlending;default:return p.NormalBlending}}function M(C,T){C.dispose(),T.unregisterMaterial(C)}},"./src/components/obb-collider.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js");d("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new f.Vector3,this.auxEuler=new f.Euler,this.boundingBox=new f.Box3,this.boundingBoxSize=new f.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var p=this.el,A=p.components["gltf-model"]&&p.components["gltf-model"].model,g,v;A&&(this.el.removeObject3D("mesh"),g=new f.Box3().setFromObject(A),v=g.getCenter(new f.Vector3),A.position.x+=A.position.x-v.x,A.position.y+=A.position.y-v.y,A.position.z+=A.position.z-v.z,this.el.setObject3D("mesh",A))},updateCollider:function(){var p=this.el,A=this.boundingBoxSize,g=this.aabb=this.aabb||new f.OBB;if(this.obb=this.obb||new f.OBB,!p.hasLoaded){p.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),g.halfSize.copy(A).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var p=this.renderColliderMesh,A=this.boundingBoxSize;if(!p){this.initColliderMesh();return}p.geometry.dispose(),p.geometry=new f.BoxGeometry(A.x,A.y,A.z)},hideCollider:function(){this.renderColliderMesh&&(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var p,A,g;p=this.boundingBoxSize,A=this.renderColliderGeometry=new f.BoxGeometry(p.x,p.y,p.z),g=this.renderColliderMesh=new f.Mesh(A,new f.MeshLambertMaterial({color:65280,side:f.DoubleSide})),g.matrixAutoUpdate=!1,g.matrixWorldAutoUpdate=!1,g.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(g)},updateBoundingBox:function(){var p=this.auxEuler,A=this.boundingBox,g=this.data.size,v=this.trackedObject3D||this.el.object3D,b=this.boundingBoxSize,x=this.data.minimumColliderDimension;if(g){this.boundingBoxSize.x=g,this.boundingBoxSize.y=g,this.boundingBoxSize.z=g;return}this.previousScale.copy(v.scale),p.copy(v.rotation),v.rotation.set(0,0,0),v.updateMatrixWorld(!0),A.setFromObject(v,!0),A.getSize(b),b.x=b.x<x?x:b.x,b.y=b.y<x?x:b.y,b.z=b.z<x?x:b.z,this.el.object3D.rotation.copy(p)},checkTrackedObject:function(){var p=this.trackedObject3DPath,A;if(p&&p.length&&!this.trackedObject3D){A=this.el;for(var g=0;g<p.length&&(A=A[p[g]],!!A);g++);A&&(this.trackedObject3D=A,this.updateCollider())}return this.trackedObject3D},tick:function(){var p=new f.Vector3,A=new f.Vector3,g=new f.Quaternion,v=new f.Matrix4;return function(){var b=this.obb,x=this.renderColliderMesh,E=this.checkTrackedObject()||this.el.object3D;E&&((E.scale.x!==this.previousScale.x||E.scale.y!==this.previousScale.y||E.scale.z!==this.previousScale.z)&&this.updateCollider(),E.updateMatrix(),E.updateMatrixWorld(),E.matrixWorld.decompose(p,g,A),A.set(1,1,1),v.compose(p,g,A),x&&x.matrixWorld.copy(v),b.copy(this.aabb),b.applyMatrix4(v))}}()})},"./src/components/obj-model.js":(c,u,h)=>{var d=h("./src/utils/debug.js"),f=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),A=d("components:obj-model:warn");c.exports.Component=f("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var g=this;this.model=null,this.objLoader=new p.OBJLoader,this.mtlLoader=new p.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(v){g.model&&v.detail.name==="material"&&g.applyMaterial()})},update:function(){var g=this.data;g.obj&&(this.resetMesh(),this.loadObj(g.obj,g.mtl))},remove:function(){this.model&&this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(g,v){var b=this,x=this.el,E=this.mtlLoader,S=this.objLoader,M=this.el.sceneEl.systems.renderer,C=v.substr(0,v.lastIndexOf("/")+1);if(v){x.hasAttribute("material")&&A("Material component properties are ignored when a .MTL is provided"),E.setResourcePath(C),E.load(v,function(T){T.preload(),S.setMaterials(T),S.load(g,function(L){b.model=L,b.model.traverse(function(B){if(B.isMesh){var F=B.material;F.map&&M.applyColorCorrection(F.map),F.emissiveMap&&M.applyColorCorrection(F.emissiveMap)}}),x.setObject3D("mesh",L),x.emit("model-loaded",{format:"obj",model:L})})});return}S.load(g,function(L){b.model=L,b.applyMaterial(),x.setObject3D("mesh",L),x.emit("model-loaded",{format:"obj",model:L})})},applyMaterial:function(){var g=this.el.components.material;g&&this.model.traverse(function(v){v instanceof p.Mesh&&(v.material=g.material)})}})},"./src/components/oculus-go-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/bind.js"),p=h("./src/utils/tracked-controls.js"),A=p.checkControllerPresentAndSetup,g=p.emitIfAxesChanged,v=p.onButtonEvent,b=h("./src/utils/index.js").device.isWebXRAvailable,x="oculus-go",E="Oculus Go",S=h("./src/constants/index.js").AFRAME_CDN_ROOT,M=S+"controllers/oculus/go/oculus-go-controller.gltf",C=b?x:E,T={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},L={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},B=b?L:T;c.exports.Component=d("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:B,bindMethods:function(){this.onModelLoaded=f(this.onModelLoaded,this),this.onControllersUpdate=f(this.onControllersUpdate,this),this.checkIfControllerPresent=f(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=f(this.removeControllersUpdateListener,this),this.onAxisMoved=f(this.onAxisMoved,this)},init:function(){var F=this;this.onButtonChanged=f(this.onButtonChanged,this),this.onButtonDown=function(D){v(D.detail.id,"down",F)},this.onButtonUp=function(D){v(D.detail.id,"up",F)},this.onButtonTouchStart=function(D){v(D.detail.id,"touchstart",F)},this.onButtonTouchEnd=function(D){v(D.detail.id,"touchend",F)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var F=this.el;F.addEventListener("buttonchanged",this.onButtonChanged),F.addEventListener("buttondown",this.onButtonDown),F.addEventListener("buttonup",this.onButtonUp),F.addEventListener("touchstart",this.onButtonTouchStart),F.addEventListener("touchend",this.onButtonTouchEnd),F.addEventListener("model-loaded",this.onModelLoaded),F.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var F=this.el;F.removeEventListener("buttonchanged",this.onButtonChanged),F.removeEventListener("buttondown",this.onButtonDown),F.removeEventListener("buttonup",this.onButtonUp),F.removeEventListener("touchstart",this.onButtonTouchStart),F.removeEventListener("touchend",this.onButtonTouchEnd),F.removeEventListener("model-loaded",this.onModelLoaded),F.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){A(this,C,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var F=this.el,D=this.data;F.setAttribute("tracked-controls",{armModel:D.armModel,hand:D.hand,idPrefix:C,orientationOffset:D.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",M)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(F){var D=F.detail.model,P;this.data.model&&(P=this.buttonMeshes={},P.trigger=D.getObjectByName("oculus_go_button_trigger"),P.trackpad=D.getObjectByName("oculus_go_touchpad"),P.touchpad=D.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(F){var D=this.mapping.buttons[F.detail.id];D&&this.el.emit(D+"changed",F.detail.state)},onAxisMoved:function(F){g(this,this.mapping.axes,F)},updateModel:function(F,D){this.data.model&&this.updateButtonModel(F,D)},updateButtonModel:function(F,D){var P=this.buttonMeshes;if(!(!P||!P[F])){var U,K;switch(D){case"down":U=this.data.buttonHighlightColor;break;case"touchstart":U=this.data.buttonTouchedColor;break;default:U=this.data.buttonColor}K=P[F],K.material.color.set(U)}}})},"./src/components/oculus-touch-controls.js":(c,u,h)=>{var d=h("./src/utils/bind.js"),f=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),A=h("./src/utils/tracked-controls.js"),g=A.checkControllerPresentAndSetup,v=A.emitIfAxesChanged,b=A.onButtonEvent,x=h("./src/utils/index.js").device.isWebXRAvailable,E="oculus-touch",S="Oculus Touch",M=x?E:S,C=h("./src/constants/index.js").AFRAME_CDN_ROOT,T=C+"controllers/oculus/oculus-touch-controller-",L=C+"controllers/meta/",B={left:{modelUrl:T+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(-.005,.003,-.055),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:T+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(.005,.003,-.055),modelPivotRotation:new p.Euler(0,0,0)}},F={left:{modelUrl:T+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(-.005,.036,-.037),modelPivotRotation:new p.Euler(Math.PI/4.5,0,0)},right:{modelUrl:T+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new p.Vector3(.005,.036,-.037),modelPivotRotation:new p.Euler(Math.PI/4.5,0,0)}},D=x?F:B,P="oculus-touch",U={"oculus-touch":D,"oculus-touch-v2":{left:{modelUrl:T+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new p.Vector3(0,-.007,-.021),modelPivotRotation:new p.Euler(-Math.PI/4,0,0)},right:{modelUrl:T+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new p.Vector3(0,-.007,-.021),modelPivotRotation:new p.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:T+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:T+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:L+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:L+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:L+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)},right:{modelUrl:L+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new p.Vector3(0,0,0),modelPivotRotation:new p.Euler(0,0,0)}}},K={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},J={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},z=x?J:K;c.exports.Component=f("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:z,bindMethods:function(){this.onButtonChanged=d(this.onButtonChanged,this),this.onThumbstickMoved=d(this.onThumbstickMoved,this),this.onModelLoaded=d(this.onModelLoaded,this),this.onControllersUpdate=d(this.onControllersUpdate,this),this.checkIfControllerPresent=d(this.checkIfControllerPresent,this),this.onAxisMoved=d(this.onAxisMoved,this)},init:function(){var G=this;this.onButtonDown=function(H){b(H.detail.id,"down",G,G.data.hand)},this.onButtonUp=function(H){b(H.detail.id,"up",G,G.data.hand)},this.onButtonTouchStart=function(H){b(H.detail.id,"touchstart",G,G.data.hand)},this.onButtonTouchEnd=function(H){b(H.detail.id,"touchend",G,G.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new p.Euler},addEventListeners:function(){var G=this.el;G.addEventListener("buttonchanged",this.onButtonChanged),G.addEventListener("buttondown",this.onButtonDown),G.addEventListener("buttonup",this.onButtonUp),G.addEventListener("touchstart",this.onButtonTouchStart),G.addEventListener("touchend",this.onButtonTouchEnd),G.addEventListener("axismove",this.onAxisMoved),G.addEventListener("model-loaded",this.onModelLoaded),G.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var G=this.el;G.removeEventListener("buttonchanged",this.onButtonChanged),G.removeEventListener("buttondown",this.onButtonDown),G.removeEventListener("buttonup",this.onButtonUp),G.removeEventListener("touchstart",this.onButtonTouchStart),G.removeEventListener("touchend",this.onButtonTouchEnd),G.removeEventListener("axismove",this.onAxisMoved),G.removeEventListener("model-loaded",this.onModelLoaded),G.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){g(this,M,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(G){var H=this.data,te;if(H.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=U[H.controllerType]||U[P],H.controllerType==="auto"){var Z=this.el.sceneEl.systems["tracked-controls-webvr"];if(Z&&Z.vrDisplay){var ee=Z.vrDisplay.displayName;/^Oculus Quest$/.test(ee)&&(this.displayModel=U["oculus-touch-v2"])}else{te=P;for(var oe=Object.keys(U),xe=0;xe<G.profiles.length;xe++)if(oe.indexOf(G.profiles[xe])!==-1){te=G.profiles[xe];break}this.displayModel=U[te]}}var Pe=this.displayModel[H.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===U["oculus-touch-v3"]||this.displayModel===U["meta-quest-touch-pro"]||this.displayModel===U["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",Pe)}},injectTrackedControls:function(G){var H=this.data,te=E,Z=H.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",ee=x?te:Z;this.el.setAttribute("tracked-controls",{id:ee,hand:H.hand,orientationOffset:H.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel(G)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(G){var H=this.mapping[this.data.hand].buttons[G.detail.id];if(H){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(G);else{var te=this.buttonMeshes,Z;(H==="trigger"||H==="grip")&&(Z=G.detail.state.value),te&&(H==="trigger"&&te.trigger&&(te.trigger.rotation.x=this.originalXRotationTrigger-Z*(Math.PI/26)),H==="grip"&&te.grip&&(Z*=this.data.hand==="left"?-1:1,te.grip.position.x=this.originalXPositionGrip+Z*.004))}this.el.emit(H+"changed",G.detail.state)}},onButtonChangedV3orPROorPlus:function(G){var H=this.mapping[this.data.hand].buttons[G.detail.id],te=this.buttonObjects,Z;te&&(Z=G.detail.state.value,te[H].quaternion.slerpQuaternions(this.buttonRanges[H].min.quaternion,this.buttonRanges[H].max.quaternion,Z),te[H].position.lerpVectors(this.buttonRanges[H].min.position,this.buttonRanges[H].max.position,Z))},onModelLoaded:function(G){if(this.data.model){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(G);else{var H=this.controllerObject3D=G.detail.model,te;te=this.buttonMeshes={},te.grip=H.getObjectByName("buttonHand"),this.originalXPositionGrip=te.grip&&te.grip.position.x,te.trigger=H.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=te.trigger&&te.trigger.rotation.x,te.thumbstick=H.getObjectByName("stick"),te.xbutton=H.getObjectByName("buttonX"),te.abutton=H.getObjectByName("buttonA"),te.ybutton=H.getObjectByName("buttonY"),te.bbutton=H.getObjectByName("buttonB")}for(var Z in this.buttonMeshes)this.buttonMeshes[Z]&&j(this.buttonMeshes[Z]);this.applyOffset(G.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function(G){G.position.copy(this.displayModel[this.data.hand].modelPivotOffset),G.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(G){var H=this.controllerObject3D=G.detail.model,te=this.buttonObjects={},Z=this.buttonMeshes={},ee=this.buttonRanges={};Z.grip=H.getObjectByName("squeeze"),te.grip=H.getObjectByName("xr_standard_squeeze_pressed_value"),ee.grip={min:H.getObjectByName("xr_standard_squeeze_pressed_min"),max:H.getObjectByName("xr_standard_squeeze_pressed_max")},te.grip.minX=te.grip.position.x,Z.thumbstick=H.getObjectByName("thumbstick"),te.thumbstick=H.getObjectByName("xr_standard_thumbstick_pressed_value"),ee.thumbstick={min:H.getObjectByName("xr_standard_thumbstick_pressed_min"),max:H.getObjectByName("xr_standard_thumbstick_pressed_max")},te.thumbstickXAxis=H.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),ee.thumbstickXAxis={min:H.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:H.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},te.thumbstickYAxis=H.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),ee.thumbstickYAxis={min:H.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:H.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},Z.trigger=H.getObjectByName("trigger"),te.trigger=H.getObjectByName("xr_standard_trigger_pressed_value"),ee.trigger={min:H.getObjectByName("xr_standard_trigger_pressed_min"),max:H.getObjectByName("xr_standard_trigger_pressed_max")},ee.trigger.diff={x:Math.abs(ee.trigger.max.rotation.x)-Math.abs(ee.trigger.min.rotation.x),y:Math.abs(ee.trigger.max.rotation.y)-Math.abs(ee.trigger.min.rotation.y),z:Math.abs(ee.trigger.max.rotation.z)-Math.abs(ee.trigger.min.rotation.z)};var oe=this.data.hand==="left"?"x":"a",xe=this.data.hand==="left"?"y":"b",Pe=oe+"button",me=xe+"button";Z[Pe]=H.getObjectByName(oe+"_button"),te[Pe]=H.getObjectByName(oe+"_button_pressed_value"),ee[Pe]={min:H.getObjectByName(oe+"_button_pressed_min"),max:H.getObjectByName(oe+"_button_pressed_max")},Z[me]=H.getObjectByName(xe+"_button"),te[me]=H.getObjectByName(xe+"_button_pressed_value"),ee[me]={min:H.getObjectByName(xe+"_button_pressed_min"),max:H.getObjectByName(xe+"_button_pressed_max")}},onAxisMoved:function(G){v(this,this.mapping[this.data.hand].axes,G)},onThumbstickMoved:function(G){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus(G);return}for(var H in G.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[H]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[H]]-Math.PI/8*G.detail[H]*(H==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(G){var H=(G.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,H);var te=(G.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,te)},updateModel:function(G,H){this.data.model&&this.updateButtonModel(G,H)},updateButtonModel:function(G,H){var te=this.buttonMeshes,Z,ee;te&&te[G]&&(ee=H==="up"||H==="touchend"?te[G].originalColor||this.data.buttonColor:H==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,Z=te[G],Z.material.color.set(ee))}});function j(G){G.traverse(function(H){var te;H.type==="Mesh"&&(te=H.material.clone(),G.originalColor=H.material.color,H.material.dispose(),H.material=te)})}},"./src/components/pico-controls.js":(c,u,h)=>{var d=h("./src/utils/bind.js"),f=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),A=h("./src/utils/tracked-controls.js"),g=A.checkControllerPresentAndSetup,v=A.emitIfAxesChanged,b=A.onButtonEvent,x="pico-4",E=h("./src/constants/index.js").AFRAME_CDN_ROOT,S=E+"controllers/pico/pico4/",M={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};c.exports.Component=f("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:M,init:function(){var C=this;this.onButtonChanged=d(this.onButtonChanged,this),this.onButtonDown=function(T){b(T.detail.id,"down",C,C.data.hand)},this.onButtonUp=function(T){b(T.detail.id,"up",C,C.data.hand)},this.onButtonTouchEnd=function(T){b(T.detail.id,"touchend",C,C.data.hand)},this.onButtonTouchStart=function(T){b(T.detail.id,"touchstart",C,C.data.hand)},this.bindMethods()},update:function(){var C=this.data;this.controllerIndex=C.hand==="right"?0:C.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=d(this.onModelLoaded,this),this.onControllersUpdate=d(this.onControllersUpdate,this),this.checkIfControllerPresent=d(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=d(this.removeControllersUpdateListener,this),this.onAxisMoved=d(this.onAxisMoved,this)},addEventListeners:function(){var C=this.el;C.addEventListener("buttonchanged",this.onButtonChanged),C.addEventListener("buttondown",this.onButtonDown),C.addEventListener("buttonup",this.onButtonUp),C.addEventListener("touchstart",this.onButtonTouchStart),C.addEventListener("touchend",this.onButtonTouchEnd),C.addEventListener("axismove",this.onAxisMoved),C.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var C=this.el;C.removeEventListener("buttonchanged",this.onButtonChanged),C.removeEventListener("buttondown",this.onButtonDown),C.removeEventListener("buttonup",this.onButtonUp),C.removeEventListener("touchstart",this.onButtonTouchStart),C.removeEventListener("touchend",this.onButtonTouchEnd),C.removeEventListener("axismove",this.onAxisMoved),C.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var C=this.data;g(this,x,{index:this.controllerIndex,hand:C.hand})},injectTrackedControls:function(){var C=this.el,T=this.data;C.setAttribute("tracked-controls",{idPrefix:x,hand:T.hand,controller:this.controllerIndex,orientationOffset:T.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",S+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(C){var T=this.mapping[this.data.hand].buttons[C.detail.id],L;T&&(T==="trigger"&&(L=C.detail.state.value,console.log("analog value of trigger press: "+L)),this.el.emit(T+"changed",C.detail.state))},onModelLoaded:function(C){this.data.model&&this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new p.Vector3(0,0,0)})},onAxisMoved:function(C){v(this,this.mapping.axes,C)}})},"./src/components/position.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;c.exports.Component=d("position",{schema:{type:"vec3"},update:function(){var f=this.el.object3D,p=this.data;f.position.set(p.x,p.y,p.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js"),p=h("./src/utils/index.js"),A=p.debug("components:raycaster:warn"),g=/^[\w\s-.,[\]#]*$/,v={childList:!0,attributes:!0,subtree:!0},b={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};c.exports.Component=d("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new f.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new f.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new f.Vector3,this.otherLineEndVec3=new f.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(E){var S=this.data,M=this.el,C=this.raycaster;C.far=S.far,C.near=S.near,S.showLine&&(S.far!==E.far||S.origin!==E.origin||S.direction!==E.direction||!E.showLine)&&(this.unitLineEndVec3.copy(S.direction).normalize(),this.drawLine()),!S.showLine&&E.showLine&&M.removeAttribute("line"),S.objects!==E.objects&&!g.test(S.objects)&&A('[raycaster] Selector "'+S.objects+'" may not update automatically with DOM changes.'),S.objects||A('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),S.autoRefresh!==E.autoRefresh&&M.isPlaying&&(S.autoRefresh?this.addEventListeners():this.removeEventListeners()),E.enabled&&!S.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,v),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var E=this.data,S;S=E.objects?this.el.sceneEl.querySelectorAll(E.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(S),this.dirty=!1},tock:function(E){var S=this.data,M=this.prevCheckTime;S.enabled&&(M&&E-M<S.interval||(this.prevCheckTime=E,this.checkIntersections()))},checkIntersections:function(){var E=this.clearedIntersectedEls,S=this.el,M=this.data,C,T=this.intersectedEls,L,B=this.intersections,F=this.newIntersectedEls,D=this.newIntersections,P=this.prevIntersectedEls,U=this.rawIntersections;for(this.dirty&&this.refreshObjects(),x(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),U.length=0,this.raycaster.intersectObjects(this.objects,!0,U),B.length=0,T.length=0,C=0;C<U.length;C++)L=U[C],!(M.showLine&&L.object===S.getObject3D("line"))&&L.object.el&&(B.push(L),T.push(L.object.el));for(D.length=0,F.length=0,C=0;C<B.length;C++)P.indexOf(B[C].object.el)===-1&&(D.push(B[C]),F.push(B[C].object.el));for(E.length=0,C=0;C<P.length;C++)T.indexOf(P[C])===-1&&(P[C].emit(b.INTERSECT_CLEAR,this.intersectedClearedDetail),E.push(P[C]));for(E.length&&S.emit(b.INTERSECTION_CLEAR,this.intersectionClearedDetail),C=0;C<F.length;C++)F[C].emit(b.INTERSECT,this.intersectedDetail);D.length&&(this.intersectionDetail.els=F,this.intersectionDetail.intersections=D,S.emit(b.INTERSECTION,this.intersectionDetail)),(P.length===0&&B.length>0||P.length>0&&B.length===0||P.length&&B.length&&P[0]!==B[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=B,S.emit(b.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),M.showLine&&setTimeout(this.updateLine)},updateLine:function(){var E=this.el,S=this.intersections,M;S.length&&(S[0].object.el===E&&S[1]?M=S[1].distance:M=S[0].distance),this.drawLine(M)},getIntersection:function(E){var S,M;for(S=0;S<this.intersections.length;S++)if(M=this.intersections[S],M.object.el===E)return M;return null},updateOriginDirection:function(){var E=new f.Vector3,S=new f.Vector3;return function(){var C=this.el,T=this.data;if(T.useWorldCoordinates){this.raycaster.set(T.origin,T.direction);return}C.object3D.updateMatrixWorld(),S.setFromMatrixPosition(C.object3D.matrixWorld),(T.origin.x!==0||T.origin.y!==0||T.origin.z!==0)&&(S=C.object3D.localToWorld(S.copy(T.origin))),E.copy(T.direction).transformDirection(C.object3D.matrixWorld).normalize(),this.raycaster.set(S,E)}}(),drawLine:function(E){var S=this.data,M=this.el,C;C=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,E===void 0&&(E=S.far===1/0?1e3:S.far),this.lineData.start=S.origin,this.lineData.end=C.copy(this.unitLineEndVec3).multiplyScalar(E).add(S.origin),this.lineData.color=S.lineColor,this.lineData.opacity=S.lineOpacity,M.setAttribute("line",this.lineData)},flattenObject3DMaps:function(E){var S,M,C=this.objects,T=this.el.sceneEl.object3D;function L(F){return F.parent?L(F.parent):F===T}for(C.length=0,M=0;M<E.length;M++){var B=E[M];if(B.isEntity&&B.object3D&&L(B.object3D))for(S in B.object3DMap)C.push(B.getObject3D(S))}return C},clearAllIntersections:function(){var E;for(E=0;E<this.intersectedEls.length;E++)this.intersectedEls[E].emit(b.INTERSECT_CLEAR,this.intersectedClearedDetail);x(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(b.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function x(E,S){var M;for(E.length=S.length,M=0;M<S.length;M++)E[M]=S[M]}},"./src/components/rotation.js":(c,u,h)=>{var d=h("./src/lib/three.js").MathUtils.degToRad,f=h("./src/core/component.js").registerComponent;c.exports.Component=f("rotation",{schema:{type:"vec3"},update:function(){var p=this.data,A=this.el.object3D;A.rotation.set(d(p.x),d(p.y),d(p.z)),A.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=1e-5;c.exports.Component=d("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var p=this.data,A=this.el.object3D,g=p.x===0?f:p.x,v=p.y===0?f:p.y,b=p.z===0?f:p.z;A.scale.set(g,v,b)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(c,u,h)=>{var d="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",f=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),A=21,g=function(){var E=new p.Quaternion,S=new p.Vector3;function M(C,T,L){T.position.copy(C.transform.position),T.quaternion.copy(C.transform.orientation),S.copy(L),E.copy(C.transform.orientation),S.applyQuaternion(E),T.position.sub(S)}return M}();g.tempFakePose={transform:{orientation:new p.Quaternion,position:new p.Vector3}};function v(E,S){this.renderer=E,this.xrHitTestSource=null,E.xr.addEventListener("sessionend",function(){this.xrHitTestSource=null}.bind(this)),E.xr.addEventListener("sessionstart",function(){this.sessionStart(S)}.bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(S)}v.prototype.previousFrameAnchors=new Set,v.prototype.anchorToObject3D=new Map;function b(E){console.warn(E.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}v.prototype.sessionStart=function(S){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){b({message:"No requestHitTestSource on the session."});return}S.space?this.session.requestHitTestSource(S).then(function(M){this.xrHitTestSource=M}.bind(this)).catch(b):S.profile&&this.session.requestHitTestSourceForTransientInput(S).then(function(M){this.xrHitTestSource=M,this.transient=!0}.bind(this)).catch(b)},v.prototype.anchorFromLastHitTestResult=function(E,S){var M=this.lastHitTest;if(M){var C={object3D:E,offset:S};Array.from(this.anchorToObject3D.entries()).forEach(function(T){var L=T[1].object3D,B=T[0];L===E&&(this.anchorToObject3D.delete(B),B.delete())}.bind(this)),M.createAnchor&&M.createAnchor().then(function(T){this.anchorToObject3D.set(T,C)}.bind(this)).catch(function(T){console.warn(T.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},v.prototype.doHit=function(S){if(this.renderer.xr.isPresenting){var M=this.renderer.xr.getReferenceSpace(),C=S.getViewerPose(M),T,L;if(this.xrHitTestSource&&C)return this.transient?(T=S.getHitTestResultsForTransientInput(this.xrHitTestSource),T.length>0?(L=T[0].results,L.length>0?(this.lastHitTest=L[0],L[0].getPose(M)):!1):!1):(T=S.getHitTestResults(this.xrHitTestSource),T.length>0?(this.lastHitTest=T[0],T[0].getPose(M)):!1)}},v.updateAnchorPoses=function(E,S){var M=E.trackedAnchors||v.prototype.previousFrameAnchors;v.prototype.previousFrameAnchors.forEach(function(C){M.has(C)||v.prototype.anchorToObject3D.delete(C)}),M.forEach(function(C){var T,L,B,F;try{T=E.getPose(C.anchorSpace,S)}catch{}T&&(L=v.prototype.anchorToObject3D.get(C),B=L.offset,F=L.object3D,g(T,F,B))})};var x;c.exports.Component=f("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:d,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(1048576),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new p.OrthographicCamera,this.orthoCam.layers.set(A),this.textureTarget=new p.WebGLRenderTarget(512,512,{}),this.basicMaterial=new p.MeshBasicMaterial({color:0,side:p.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new p.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var E=this.el.getAttribute("webxr"),S=E.optionalFeatures;(!S.includes("hit-test")||!S.includes("anchors"))&&(S.push("hit-test"),S.push("anchors"),this.el.setAttribute("webxr",E)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",function(){this.hitTest=null}.bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",function(){if(this.el.is("ar-mode")){var M=this.el.sceneEl.renderer,C=this.session=M.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,x||(x=new Map),C.requestReferenceSpace("viewer").then(function(B){this.hitTest=new v(M,{space:B}),x.set(B,this.hitTest),this.el.emit("ar-hit-test-start")}.bind(this));var T="generic-touchscreen",L=new v(M,{profile:T});C.addEventListener("selectstart",function(B){if(this.data.enabled===!0){var F=B.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:F,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),F.profiles[0]===T?this.hitTest=L:(this.hitTest=x.get(F)||new v(M,{space:F.targetRaySpace}),x.set(F,this.hitTest)))}}.bind(this)),C.addEventListener("selectend",function(B){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var F=B.inputSource,D;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(D=this.data.target.object3D,D&&(g.tempFakePose.transform.position.copy(this.bboxMesh.position),g.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),g(g.tempFakePose,D,this.bboxOffset),D.visible=!0,this.hitTest.anchorFromLastHitTestResult(D,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:F,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}.bind(this))}}.bind(this)),this.bboxOffset=new p.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(A),this.data.target.object3D.traverse(function(E){E.layers.enable(A)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var E=new p.PlaneGeometry(1,1),S=new p.MeshBasicMaterial({transparent:!0,color:16777215});E.rotateX(-Math.PI/2),E.rotateY(-Math.PI/2),this.bbox=new p.Box3,this.bboxMesh=new p.Mesh(E,S),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var E,S=this.el.sceneEl.renderer,M,C,T=S.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),M=S.getRenderTarget(),S.setRenderTarget(this.textureTarget),S.xr.enabled=!1,C=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,S.render(this.el.object3D,this.orthoCam),this.el.object3D.background=C,this.el.object3D.overrideMaterial=null,S.xr.enabled=T,S.setRenderTarget(M),S.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),E=this.context.getImageData(0,0,512,512);for(var L=0;L<262144;L++)E.data[L*4+3]!==0&&E.data[L*4+3]!==255&&(E.data[L*4+3]=128);this.context.putImageData(E,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var E,S=this.el.sceneEl.frame,M=this.el.sceneEl.renderer;if(S&&v.updateAnchorPoses(S,M.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var C;this.textureCache.has(this.data.src)?C=this.textureCache.get(this.data.src):(C=new p.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,C)),this.bboxMesh.material.map=C,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(E=this.hitTest.doHit(S),E&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(E.transform.position),this.bboxMesh.quaternion.copy(E.transform.orientation)))}})},"./src/components/scene/background.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/core/component.js").components;c.exports.Component=d("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var p=this.data,A=this.el.object3D;p.transparent?A.background=null:A.background=new THREE.Color(p.color)},remove:function(){var p=this.data,A=this.el.object3D;if(p.transparent){A.background=null;return}A.background=f[this.name].schema.color.default}})},"./src/components/scene/debug.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;c.exports.Component=d("debug",{schema:{default:!0}})},"./src/components/scene/device-orientation-permission-ui.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/index.js"),p=f.bind,A=h("./src/constants/index.js"),g="a-modal",v="a-dialog",b="a-dialog-text",x="a-dialog-text-container",E="a-dialog-buttons-container",S="a-dialog-button",M="a-dialog-allow-button",C="a-dialog-deny-button",T="a-dialog-ok-button";c.exports.Component=d("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var D=this;if(this.data.enabled){if(location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&location.protocol==="http:"&&this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=p(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=p(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().then(function(){D.el.emit("deviceorientationpermissiongranted"),D.permissionGranted=!0}).catch(function(){D.devicePermissionDialogEl=L(D.data.denyButtonText,D.data.allowButtonText,D.data.deviceMotionMessage,D.onDeviceMotionDialogAllowClicked,D.onDeviceMotionDialogDenyClicked),D.el.appendChild(D.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var D=this,P=B(D.data.cancelButtonText,D.data.httpsMessage,function(){D.el.removeChild(P)});this.el.appendChild(P)},onDeviceMotionDialogAllowClicked:function(){var D=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(P){P==="granted"?(D.el.emit("deviceorientationpermissiongranted"),D.permissionGranted=!0):D.el.emit("deviceorientationpermissionrejected"),D.remove()}).catch(console.error)}});function L(D,P,U,K,J){var z,j,G;return z=document.createElement("div"),z.classList.add(E),j=document.createElement("button"),j.classList.add(S,C),j.setAttribute(A.AFRAME_INJECTED,""),j.innerHTML=D,z.appendChild(j),G=document.createElement("button"),G.classList.add(S,M),G.setAttribute(A.AFRAME_INJECTED,""),G.innerHTML=P,z.appendChild(G),G.addEventListener("click",function(H){H.stopPropagation(),K()}),j.addEventListener("click",function(H){H.stopPropagation(),J()}),F(U,z)}function B(D,P,U){var K,J;return K=document.createElement("div"),K.classList.add(E),J=document.createElement("button"),J.classList.add(S,T),J.setAttribute(A.AFRAME_INJECTED,""),J.innerHTML=D,K.appendChild(J),J.addEventListener("click",function(z){z.stopPropagation(),U()}),F(P,K)}function F(D,P){var U,K,J,z;return U=document.createElement("div"),U.classList.add(g),U.setAttribute(A.AFRAME_INJECTED,""),K=document.createElement("div"),K.className=v,K.setAttribute(A.AFRAME_INJECTED,""),U.appendChild(K),J=document.createElement("div"),J.classList.add(x),K.appendChild(J),z=document.createElement("div"),z.classList.add(b),z.innerHTML=D,J.appendChild(z),K.appendChild(P),U}},"./src/components/scene/embedded.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;c.exports.Component=d("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},update:function(){var f=this.el,p=f.querySelector(".a-enter-vr");this.data===!0?(p&&p.classList.add("embedded"),f.removeFullScreenStyles()):(p&&p.classList.remove("embedded"),f.addFullScreenStyles())}})},"./src/components/scene/fog.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js"),p=h("./src/utils/debug.js"),A=p("components:fog:warn");c.exports.Component=d("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var v=this.data,b=this.el,x=this.el.object3D.fog;if(!b.isScene){A("Fog component can only be applied to <a-scene>");return}if(!x||v.type!==x.name){b.object3D.fog=g(v),b.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(E){var S=v[E];E==="color"&&(S=new f.Color(S)),x[E]=S})},remove:function(){var v=this.el.object3D.fog;v&&(v.far=0,v.near=.1)}});function g(v){var b;return v.type==="exponential"?b=new f.FogExp2(v.color,v.density):b=new f.Fog(v.color,v.near,v.far),b.name=v.type,b}},"./src/components/scene/inspector.js":(c,u,h)=>{var d=h("./src/constants/index.js").AFRAME_INJECTED,f=h("./package.json"),p=h("./src/core/component.js").registerComponent,A=h("./src/utils/index.js");function g(S){var M=S.split(".");return M[2]="x",M.join(".")}var v="https://unpkg.com/aframe-inspector@"+g(f.version)+"/dist/aframe-inspector.min.js",b=v,x="Loading Inspector",E="Error loading Inspector";c.exports.Component=p("inspector",{schema:{url:{default:b}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var S;this.firstPlay&&(S=A.getUrlParameter("inspector"),S!=="false"&&S&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var S='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=x+S},remove:function(){this.removeEventListeners()},onKeydown:function(S){var M=S.keyCode===73&&(S.ctrlKey&&S.altKey||S.getModifierState("AltGraph"));M&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(S){S.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(S){var M=this,C;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(S);return}this.showLoader(),C=document.createElement("script"),C.src=this.data.url,C.setAttribute("data-name","aframe-inspector"),C.setAttribute(d,""),C.onload=function(){AFRAME.INSPECTOR.open(S),M.hideLoader(),M.removeEventListeners()},C.onerror=function(){M.loadingMessageEl.innerHTML=E},document.head.appendChild(C),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/index.js").shouldCaptureKeyEvent;c.exports.Component=d("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(p){var A=this.data;this.enterVREnabled=A.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(p){var A=this.el;f(p)&&(this.enterVREnabled&&p.keyCode===70&&A.enterVR(),this.enterVREnabled&&p.keyCode===27&&A.exitVR())}})},"./src/components/scene/pool.js":(c,u,h)=>{var d=h("./src/utils/debug.js"),f=h("./src/core/component.js").registerComponent,p=d("components:pool:warn");c.exports.Component=f("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var A;for(this.availableEls=[],this.usedEls=[],this.data.mixin||p("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||p("Container "+this.data.container+" not found.")),this.container=this.container||this.el,A=0;A<this.data.size;++A)this.createEntity()},update:function(A){var g=this.data;(A.mixin!==g.mixin||A.size!==g.size)&&this.initPool()},createEntity:function(){var A;A=document.createElement("a-entity"),A.play=this.wrapPlay(A.play),A.setAttribute("mixin",this.data.mixin),A.object3D.visible=!1,A.pause(),this.container.appendChild(A),this.availableEls.push(A);var g=this.usedEls;A.addEventListener("loaded",function(){g.indexOf(A)===-1&&(A.object3DParent=A.object3D.parent,A.object3D.parent.remove(A.object3D))})},wrapPlay:function(A){var g=this.usedEls;return function(){g.indexOf(this)!==-1&&A.call(this)}},requestEntity:function(){var A;if(this.availableEls.length===0){if(this.data.dynamic===!1){p("Requested entity from empty pool: "+this.attrName);return}else p("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return A=this.availableEls.shift(),this.usedEls.push(A),A.object3DParent&&(A.object3DParent.add(A.object3D),this.updateRaycasters()),A.object3D.visible=!0,A},returnEntity:function(A){var g=this.usedEls.indexOf(A);if(g===-1){p("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(g,1),this.availableEls.push(A),A.object3DParent=A.object3D.parent,A.object3D.parent.remove(A.object3D),this.updateRaycasters(),A.object3D.visible=!1,A.pause(),A},updateRaycasters:function(){var A=document.querySelectorAll("[raycaster]");A.forEach(function(g){g.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js");c.exports.Component=d("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},init:function(){var p=this.el.getAttribute("webxr"),A=p.requiredFeatures;A.indexOf("mesh-detection")===-1&&(A.push("mesh-detection"),this.el.setAttribute("webxr",p)),A.indexOf("plane-detection")===-1&&(A.push("plane-detection"),this.el.setAttribute("webxr",p)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){this.el.is("ar-mode")&&(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var p=this.data,A,g,v=this.el;v.renderer.xr;var b,x=this.meshEntities,E=!1,S=[],M=this.data.filterLabels;b=v.frame,A=b.detectedMeshes,g=b.detectedPlanes;for(var C=0;C<x.length;C++)x[C].present=!1;if(p.meshesEnabled){for(var T of A.values())if(!(M.length&&M.indexOf(T.semanticLabel)===-1)){for(C=0;C<x.length;C++)if(T===x[C].mesh){E=!0,x[C].present=!0,x[C].lastChangedTime<T.lastChangedTime&&this.updateMeshGeometry(x[C].el,T),x[C].lastChangedTime=T.lastChangedTime;break}E||S.push(T),E=!1}}if(p.planesEnabled){for(T of g.values())if(!(M.length&&M.indexOf(T.semanticLabel)===-1)){for(C=0;C<x.length;C++)if(T===x[C].mesh){E=!0,x[C].present=!0,x[C].lastChangedTime<T.lastChangedTime&&this.updateMeshGeometry(x[C].el,T),x[C].lastChangedTime=T.lastChangedTime;break}E||S.push(T),E=!1}}this.deleteMeshes(),this.createNewMeshes(S)},updateMeshes:function(){var p=new f.Matrix4;return function(){for(var A,g=this.el,v,b=g.frame,x=this.meshEntities,E=g.renderer.xr.getReferenceSpace(),S,M=0;M<x.length;M++)S=x[M].mesh.meshSpace||x[M].mesh.planeSpace,A=b.getPose(S,E),v=x[M].el,v.hasLoaded&&(p.fromArray(A.transform.matrix),p.decompose(v.object3D.position,v.object3D.quaternion,v.object3D.scale))}}(),deleteMeshes:function(){for(var p=this.meshEntities,A=[],g=0;g<p.length;g++)p[g].present?A.push(p[g]):this.el.removeChild(p[g]);this.meshEntities=A},createNewMeshes:function(p){for(var A,g=0;g<p.length;g++)A=document.createElement("a-entity"),this.meshEntities.push({mesh:p[g],el:A}),A.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(A)},initMeshGeometry:function(p){var A,g,v;if(p instanceof XRPlane){g=new f.Shape,v=p.polygon;for(var b=0;b<v.length;++b)b===0?g.moveTo(v[b].x,v[b].z):g.lineTo(v[b].x,v[b].z);return A=new f.ShapeGeometry(g),A.rotateX(Math.PI/2),A}return A=new f.BufferGeometry,A.setAttribute("position",new f.BufferAttribute(p.vertices,3)),A.setIndex(new f.BufferAttribute(p.indices,1)),A},initWorldMeshEntity:function(p){for(var A=p.target,g,v,b,x=this.meshEntities,E=0;E<x.length;E++)if(x[E].el===A){b=x[E];break}g=this.initMeshGeometry(b.mesh),v=new f.Mesh(g,new f.MeshBasicMaterial({color:Math.random()*16777215,side:f.DoubleSide})),A.setObject3D("mesh",v),b.mesh instanceof XRPlane&&this.data.planeMixin?A.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&A.setAttribute("mixin",this.data.meshMixin),A.setAttribute("data-world-mesh",b.mesh.semanticLabel)},updateMeshGeometry:function(p,A){var g=p.getObject3D("mesh");g.geometry.dispose(),g.geometry=this.initMeshGeometry(A)}})},"./src/components/scene/reflection.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;function f(p,A,g,v){var b=Math.max(p.primaryLightIntensity.x,Math.max(p.primaryLightIntensity.y,p.primaryLightIntensity.z));A.sh.fromArray(p.sphericalHarmonicsCoefficients),A.intensity=1,g&&(g.color.setRGB(p.primaryLightIntensity.x/b,p.primaryLightIntensity.y/b,p.primaryLightIntensity.z/b),g.intensity=b,v.copy(p.primaryLightDirection))}c.exports.Component=d("reflection",{schema:{directionalLight:{type:"selector"}},init:function(){var p=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var A=this.el.getAttribute("webxr"),g=A.optionalFeatures;g.includes("light-estimation")||(g.push("light-estimation"),this.el.setAttribute("webxr",A)),this.el.addEventListener("enter-vr",function(){var v=p.el.renderer,b=v.xr.getSession();b.requestLightProbe&&p.el.is("ar-mode")&&p.startLightProbe()}),this.el.addEventListener("exit-vr",function(){p.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var p=this.el.renderer,A=p.xr.getSession(),g=this,v=p.getContext();if(!this.probeLight){var b=document.createElement("a-light");b.setAttribute("type","probe"),b.setAttribute("intensity",0),this.el.appendChild(b),this.probeLight=b}switch(A.preferredReflectionFormat){case"srgba8":v.getExtension("EXT_sRGB");break;case"rgba16f":v.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(A,v),v.getExtension("EXT_sRGB"),v.getExtension("OES_texture_half_float"),A.requestLightProbe().then(function(x){g.xrLightProbe=x,x.addEventListener("reflectionchange",g.updateXRCubeMap.bind(g))}).catch(function(x){console.warn("Lighting estimation not supported: "+x.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var p=this.el.renderer,A=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(A){var g=p.properties.get(this.lightingEstimationTexture);g.__webglTexture=A,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var p=this.el.object3D,A=this.el.renderer,g=this.el.frame;if(g&&this.xrLightProbe){var v=g.getLightEstimate(this.xrLightProbe);v&&f(v,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(p.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(A,p),p.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&g&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js"),p=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),A=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);c.exports.Component=d("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var g=this.el,v=this;g.renderer?b():g.addEventListener("render-target-loaded",b);function b(){var x=g.renderer.getContext();x&&(v.cubeMapSize=x.getParameter(x.MAX_CUBE_MAP_TEXTURE_SIZE),v.material=new f.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:p,fragmentShader:A,side:f.DoubleSide}),v.quad=new f.Mesh(new f.PlaneGeometry(1,1),v.material),v.quad.visible=!1,v.camera=new f.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),v.canvas=document.createElement("canvas"),v.ctx=v.canvas.getContext("2d"),g.object3D.add(v.quad),v.onKeyDown=v.onKeyDown.bind(v))}},getRenderTarget:function(g,v){return new f.WebGLRenderTarget(g,v,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:f.LinearFilter,magFilter:f.LinearFilter,wrapS:f.ClampToEdgeWrapping,wrapT:f.ClampToEdgeWrapping,format:f.RGBAFormat,type:f.UnsignedByteType})},resize:function(g,v){this.quad.scale.set(g,v,1),this.camera.left=-1*g/2,this.camera.right=g/2,this.camera.top=v/2,this.camera.bottom=-1*v/2,this.camera.updateProjectionMatrix(),this.canvas.width=g,this.canvas.height=v},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(g){var v=g.keyCode===83&&g.ctrlKey&&g.altKey;if(!(!this.data||!v)){var b=g.shiftKey?"equirectangular":"perspective";this.capture(b)}},setCapture:function(g){var v=this.el,b,x,E,S;return g==="perspective"?(this.quad.visible=!1,x=this.data.camera&&this.data.camera.components.camera.camera||v.camera,b={width:this.data.width,height:this.data.height}):(x=this.camera,S=new f.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:f.RGBFormat,generateMipmaps:!0,minFilter:f.LinearMipmapLinearFilter,colorSpace:f.SRGBColorSpace}),E=new f.CubeCamera(v.camera.near,v.camera.far,S),v.camera.getWorldPosition(E.position),v.camera.getWorldQuaternion(E.quaternion),E.update(v.renderer,v.object3D),this.quad.material.uniforms.map.value=E.renderTarget.texture,b={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:x,size:b,projection:g}},capture:function(g){var v=this.el.renderer.xr.enabled,b=this.el.renderer,x;b.xr.enabled=!1,x=this.setCapture(g),this.renderCapture(x.camera,x.size,x.projection),this.saveCapture(),b.xr.enabled=v},getCanvas:function(g){var v=this.el.renderer.xr.enabled,b=this.el.renderer,x=this.setCapture(g);return b.xr.enabled=!1,this.renderCapture(x.camera,x.size,x.projection),b.xr.enabled=v,this.canvas},renderCapture:function(g,v,b){var x=this.el.renderer.autoClear,E=this.el,S,M,C,T=E.renderer;M=this.getRenderTarget(v.width,v.height),C=new Uint8Array(4*v.width*v.height),this.resize(v.width,v.height),T.autoClear=!0,T.clear(),T.setRenderTarget(M),T.render(E.object3D,g),T.autoClear=x,T.readRenderTargetPixels(M,0,0,v.width,v.height,C),T.setRenderTarget(null),b==="perspective"&&(C=this.flipPixelsVertically(C,v.width,v.height)),S=new ImageData(new Uint8ClampedArray(C),v.width,v.height),this.quad.visible=!1,this.ctx.putImageData(S,0,0)},flipPixelsVertically:function(g,v,b){for(var x=g.slice(0),E=0;E<v;++E)for(var S=0;S<b;++S)x[E*4+S*v*4]=g[E*4+(b-S)*v*4],x[E*4+1+S*v*4]=g[E*4+1+(b-S)*v*4],x[E*4+2+S*v*4]=g[E*4+2+(b-S)*v*4],x[E*4+3+S*v*4]=g[E*4+3+(b-S)*v*4];return x},saveCapture:function(){this.canvas.toBlob(function(g){var v="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",b=document.createElement("a"),x=URL.createObjectURL(g);b.href=x,b.setAttribute("download",v),b.innerHTML="downloading...",b.style.display="none",document.body.appendChild(b),setTimeout(function(){b.click(),document.body.removeChild(b)},1)},"image/png")}})},"./src/components/scene/stats.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./vendor/rStats.js"),p=h("./src/utils/index.js");h("./vendor/rStats.extras.js"),h("./src/lib/rStatsAframe.js");var A=window.aframeStats,g=p.bind,v="a-hidden",b=window.threeStats;c.exports.Component=d("stats",{schema:{default:!0},init:function(){var E=this.el;p.getUrlParameter("stats")!=="false"&&(this.stats=x(E),this.statsEl=document.querySelector(".rs-base"),this.hideBound=g(this.hide,this),this.showBound=g(this.show,this),E.addEventListener("enter-vr",this.hideBound),E.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var E=this.stats;E&&(E("rAF").tick(),E("FPS").frame(),E().update())},hide:function(){this.statsEl.classList.add(v)},show:function(){this.statsEl.classList.remove(v)}});function x(E){var S=new b(E.renderer),M=new A(E),C=E.isMobile?[]:[S,M];return new f({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:C})}},"./src/components/scene/xr-mode-ui.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/constants/index.js"),p=h("./src/utils/index.js"),A=p.bind,g="a-enter-vr",v="a-enter-ar",b="a-enter-vr-button",x="a-enter-ar-button",E="a-hidden",S="a-orientation-modal";c.exports.Component=d("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},init:function(){var B=this,F=this.el;p.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),F.addEventListener("enter-vr",this.updateEnterInterfaces),F.addEventListener("exit-vr",this.updateEnterInterfaces),F.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(D){D.data.type==="loaderReady"&&(B.insideLoader=!0,B.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=A(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=A(this.onEnterARButtonClick,this),this.onModalClick=A(this.onModalClick,this),this.toggleOrientationModalIfNeeded=A(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=A(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var B=this.data,F=this.el;if(!B.enabled||this.insideLoader||p.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&B.enterVREnabled&&(B.XRMode==="xr"||B.XRMode==="vr")&&(B.enterVRButton?(this.enterVREl=document.querySelector(B.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=M(this.onEnterVRButtonClick),F.appendChild(this.enterVREl))),!this.enterAREl&&B.enterAREnabled&&(B.XRMode==="xr"||B.XRMode==="ar")&&(B.enterARButton?(this.enterAREl=document.querySelector(B.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=C(this.onEnterARButtonClick,B.XRMode==="xr"),F.appendChild(this.enterAREl))),this.orientationModalEl=T(this.onModalClick),F.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(B){B&&B.parentNode&&B.parentNode.removeChild(B)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var B=this.el;this.enterVREl&&(B.is("vr-mode")||(B.isMobile||p.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!p.device.checkVRSupport()?this.enterVREl.classList.add(E):(p.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(E)))},toggleEnterARButtonIfNeeded:function(){var B=this.el;this.enterAREl&&(B.is("vr-mode")||!p.device.checkARSupport()?this.enterAREl.classList.add(E):this.enterAREl.classList.remove(E))},toggleOrientationModalIfNeeded:function(){var B=this.el,F=this.orientationModalEl;!F||!B.isMobile||(!p.device.isLandscape()&&B.is("vr-mode")?F.classList.remove(E):F.classList.add(E))}});function M(B){var F,D;return D=document.createElement("div"),D.classList.add(g),D.setAttribute(f.AFRAME_INJECTED,""),F=document.createElement("button"),F.className=b,F.setAttribute("title","Enter VR mode with a headset or fullscreen without"),F.setAttribute(f.AFRAME_INJECTED,""),p.device.isMobile()&&L(F),D.appendChild(F),F.addEventListener("click",function(P){B(),P.stopPropagation()}),D}function C(B,F){var D,P;return P=document.createElement("div"),P.classList.add(v),F&&P.classList.add("xr"),P.setAttribute(f.AFRAME_INJECTED,""),D=document.createElement("button"),D.className=x,D.setAttribute("title","Enter AR mode with a headset or handheld device."),D.setAttribute(f.AFRAME_INJECTED,""),p.device.isMobile()&&L(D),P.appendChild(D),D.addEventListener("click",function(U){B(),U.stopPropagation()}),P}function T(B){var F=document.createElement("div");F.className=S,F.classList.add(E),F.setAttribute(f.AFRAME_INJECTED,"");var D=document.createElement("button");return D.setAttribute(f.AFRAME_INJECTED,""),D.innerHTML="Exit VR",D.addEventListener("click",B),F.appendChild(D),F}function L(B){B.addEventListener("touchstart",function(){B.classList.remove("resethover")}),B.addEventListener("touchend",function(){B.classList.add("resethover")})}},"./src/components/shadow.js":(c,u,h)=>{var d=h("./src/core/component.js"),f=h("./src/lib/three.js"),p=h("./src/utils/bind.js"),A=d.registerComponent;c.exports.Component=A("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=p(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var g=this.data;this.updateDescendants(g.cast,g.receive)},remove:function(){var g=this.el;g.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(g,v){var b=this.el.sceneEl;this.el.object3D.traverse(function(x){if(x instanceof f.Mesh&&(x.castShadow=g,x.receiveShadow=v,b.hasLoaded&&x.material))for(var E=Array.isArray(x.material)?x.material:[x.material],S=0;S<E.length;S++)E[S].needsUpdate=!0})}})},"./src/components/sound.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/debug.js"),p=h("./src/lib/three.js"),A=f("components:sound:warn");c.exports.Component=d("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var g=this;this.listener=null,this.audioLoader=new p.AudioLoader,this.pool=new p.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){g.playSound()}},update:function(g){var v=this.data,b,x,E=v.src!==g.src;if(E){if(!v.src)return;this.setupSound()}for(b=0;b<this.pool.children.length;b++)x=this.pool.children[b],v.positional&&(x.setDistanceModel(v.distanceModel),x.setMaxDistance(v.maxDistance),x.setRefDistance(v.refDistance),x.setRolloffFactor(v.rolloffFactor)),x.setLoop(v.loop),x.setLoopStart(v.loopStart),v.loopStart!==0&&v.loopEnd===0?x.setLoopEnd(x.buffer.duration):x.setLoopEnd(v.loopEnd),x.setVolume(v.volume),x.isPaused=!1;if(v.on!==g.on&&this.updateEventListener(g.on),E){var S=this;this.loaded=!1,this.audioLoader.load(v.src,function(M){for(b=0;b<S.pool.children.length;b++)x=S.pool.children[b],x.setBuffer(M);S.loaded=!0,p.Cache.remove(v.src),(S.data.autoplay||S.mustPlay)&&S.playSound(this.processSound),S.el.emit("sound-loaded",S.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var g,v;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(g=0;g<this.pool.children.length;g++)v=this.pool.children[g],v.disconnect()}catch{A("Audio source not properly disconnected")}},updateEventListener:function(g){var v=this.el;g&&v.removeEventListener(g,this.playSoundBound),v.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var g=this.el,v,b=g.sceneEl,x=this,E;this.pool.children.length>0&&(this.stopSound(),g.removeObject3D("sound"));var S=this.listener=b.audioListener||new p.AudioListener;for(b.audioListener=S,b.camera&&b.camera.add(S),b.addEventListener("camera-set-active",function(M){M.detail.cameraEl.getObject3D("camera").add(S)}),this.pool=new p.Group,v=0;v<this.data.poolSize;v++)E=this.data.positional?new p.PositionalAudio(S):new p.Audio(S),this.pool.add(E);for(g.setObject3D(this.attrName,this.pool),v=0;v<this.pool.children.length;v++)E=this.pool.children[v],E.onEnded=function(){this.isPlaying=!1,x.el.emit("sound-ended",x.evtDetail,!1)}},pauseSound:function(){var g,v;for(this.isPlaying=!1,g=0;g<this.pool.children.length;g++)v=this.pool.children[g],!(!v.source||!v.source.buffer||!v.isPlaying||v.isPaused)&&(v.isPaused=!0,v.pause())},playSound:function(g){var v,b,x;if(!this.loaded){A("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=g;return}for(v=!1,this.isPlaying=!0,b=0;b<this.pool.children.length;b++)if(x=this.pool.children[b],!x.isPlaying&&x.buffer&&!v){g&&g(x),x.play(),x.isPaused=!1,v=!0;continue}if(!v){A("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var g,v;for(this.isPlaying=!1,g=0;g<this.pool.children.length;g++){if(v=this.pool.children[g],!v.source||!v.source.buffer)return;v.stop()}}})},"./src/components/text.js":(c,u,h)=>{var d=h("./node_modules/three-bmfont-text/index.js"),f=h("./node_modules/load-bmfont/browser.js"),p=h("./src/core/component.js").registerComponent,A=h("./src/core/shader.js"),g=h("./src/lib/three.js"),v=h("./src/utils/index.js"),b=v.debug("components:text:error"),x=A.shaders,E=v.debug("components:text:warn"),S=1,M=16,C=h("./src/constants/index.js").AFRAME_CDN_ROOT,T=C+"fonts/",L={aileronsemibold:T+"Aileron-Semibold.fnt",dejavu:T+"DejaVu-sdf.fnt",exo2bold:T+"Exo2Bold.fnt",exo2semibold:T+"Exo2SemiBold.fnt",kelsonsans:T+"KelsonSans.fnt",monoid:T+"Monoid.fnt",mozillavr:T+"mozillavr.fnt",roboto:T+"Roboto-msdf.json",sourcecodepro:T+"SourceCodePro.fnt"},B=["roboto"],F="roboto";c.exports.FONTS=L;var D=new Z,P={},U={},K=/^\w+:/;c.exports.Component=p("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:F},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:x},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=d(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(ee){var oe=this.data,xe=this.currentFont;if(U[oe.font]?this.texture=U[oe.font]:(this.texture=U[oe.font]=new g.Texture,this.texture.anisotropy=M),this.createOrUpdateMaterial(),ee.font!==oe.font){this.updateFont();return}xe&&(this.updateGeometry(this.geometry,xe),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var ee=this.data,oe,xe=this.material,Pe,me=this.shaderData,Ce;if(Ce=ee.shader,B.indexOf(ee.font)!==-1||ee.font.indexOf("-msdf.")>=0?Ce="msdf":ee.font in L&&B.indexOf(ee.font)===-1&&(Ce="sdf"),oe=(this.shaderObject&&this.shaderObject.name)!==Ce,me.alphaTest=ee.alphaTest,me.color=ee.color,me.map=this.texture,me.opacity=ee.opacity,me.side=J(ee.side),me.transparent=ee.transparent,me.negate=ee.negate,!oe){this.shaderObject.update(me),xe.transparent=me.transparent,xe.side=me.side;return}Pe=G(this.el,Ce,me),this.material=Pe.material,this.shaderObject=Pe.shader,this.material.side=me.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var ee=this.data,oe=this.el,xe,Pe=this.geometry,me=this;ee.font||E("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),xe=this.lookupFont(ee.font||F)||ee.font,D.get(xe,function(){return z(xe,ee.yOffset)}).then(function(Je){var Oe;if(Je.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");P[xe]||(Je.widthFactor=P[Je]=te(Je)),me.currentFont=Je,Oe=me.getFontImageSrc(),D.get(Oe,function(){return j(Oe)}).then(function($e){var nt=me.texture;nt&&(nt.image=$e,nt.needsUpdate=!0,U[ee.font]=nt,me.texture=nt,me.initMesh(),me.currentFont=Je,me.updateGeometry(Pe,Je),me.updateLayout(),me.mesh.visible=!0,oe.emit("textfontset",{font:ee.font,fontObj:Je}))}).catch(function($e){b($e.message),b($e.stack)})}).catch(function(Ce){b(Ce.message),b(Ce.stack)})},initMesh:function(){this.mesh||(this.mesh=new g.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var ee=this.lookupFont(this.data.font||F)||this.data.font,oe=this.currentFont.pages[0];return oe.match(K)&&oe.indexOf("http")!==0?ee.replace(/(\.fnt)|(\.json)/,".png"):g.LoaderUtils.extractUrlBase(ee)+oe},updateLayout:function(){var ee,oe,xe=this.el,Pe=this.data,me=this.geometry,Ce,Je,Oe,$e=this.mesh,nt,gt,Tt,Ze,mn;if(!(!$e||!me.layout)){if(Ce=xe.getAttribute("geometry"),Tt=Pe.width||Ce&&Ce.width||S,nt=H(Pe.wrapPixels,Pe.wrapCount,this.currentFont.widthFactor),gt=Tt/nt,Oe=me.layout,Je=gt*(Oe.height+Oe.descender),Ce&&Ce.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!Ce.width,this.hasExplicitGeoHeight=!!Ce.height),this.hasExplicitGeoWidth||xe.setAttribute("geometry","width",Tt),this.hasExplicitGeoHeight||xe.setAttribute("geometry","height",Je)),ee=Pe.anchor==="align"?Pe.align:Pe.anchor,ee==="left")Ze=0;else if(ee==="right")Ze=-1*Oe.width;else if(ee==="center")Ze=-1*Oe.width/2;else throw new TypeError("Invalid text.anchor property value",ee);if(oe=Pe.baseline,oe==="bottom")mn=0;else if(oe==="top")mn=-1*Oe.height+Oe.ascender;else if(oe==="center")mn=-1*Oe.height/2;else throw new TypeError("Invalid text.baseline property value",oe);$e.position.x=Ze*gt+Pe.xOffset,$e.position.y=mn*gt,$e.position.z=Pe.zOffset,$e.scale.set(gt,-1*gt,gt)}},lookupFont:function(ee){return L[ee]},updateGeometry:function(){var ee={},oe={},xe=/\\n/g,Pe=/\\t/g;return function(me,Ce){var Je=this.data;oe.font=Ce,oe.lineHeight=Je.lineHeight&&isFinite(Je.lineHeight)?Je.lineHeight:Ce.common.lineHeight,oe.text=Je.value.toString().replace(xe,`
`).replace(Pe,"	"),oe.width=H(Je.wrapPixels,Je.wrapCount,Ce.widthFactor),me.update(v.extend(ee,Je,oe))}}()});function J(ee){switch(ee){case"back":return g.FrontSide;case"double":return g.DoubleSide;default:return g.BackSide}}function z(ee,oe){return new Promise(function(xe,Pe){f(ee,function(me,Ce){if(me){b("Error loading font",ee),Pe(me);return}ee.indexOf("/Roboto-msdf.json")>=0&&(oe=30),oe&&Ce.chars.map(function(Oe){Oe.yoffset+=oe}),xe(Ce)})})}function j(ee){return new Promise(function(oe,xe){new g.ImageLoader().load(ee,function(Pe){oe(Pe)},void 0,function(){b("Error loading font image",ee),xe(null)})})}function G(ee,oe,xe){var Pe,me;return me=new x[oe].Shader,me.el=ee,me.init(xe),me.update(xe),Pe=me.material,Pe.transparent=xe.transparent,{material:Pe,shader:me}}function H(ee,oe,xe){return ee||(.5+oe)*xe}function te(ee){var oe=0,xe=0,Pe=0;return ee.chars.map(function(me){oe+=me.xadvance,me.id>=48&&me.id<=57&&(Pe++,xe+=me.xadvance)}),Pe?xe/Pe:oe/ee.chars.length}function Z(){var ee=this.cache={};this.get=function(oe,xe){return oe in ee||(ee[oe]=xe()),ee[oe]}}},"./src/components/tracked-controls-webvr.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/tracked-controls.js"),p=h("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,A=h("./src/lib/three.js"),g=h("./src/constants/index.js").DEFAULT_HANDEDNESS,v={x:.175,y:-.3,z:-.03},b={x:0,y:0,z:-.175},x={touches:[]},E={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};c.exports.Component=d("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new A.Vector3,this.controllerQuaternion=new A.Quaternion,this.controllerEuler=new A.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(S,M){var C=this.el.getObject3D("mesh");C&&C.update&&C.update(M/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return p},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var S=this.data,M=f.findMatchingControllerWebVR(this.system.controllers,S.id,S.idPrefix,S.hand,S.controller);this.controller=M,this.el.components["tracked-controls"].controller=M,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(S){var M=this.controller,C=this.controllerEuler,T=this.controllerQuaternion,L=this.deltaControllerPosition,B,F,D,P,U;F=this.getHeadElement(),D=F.object3D,U=this.defaultUserHeight(),P=M.pose,B=(M?M.hand:void 0)||g,S.copy(D.position),L.set(v.x*(B==="left"?-1:B==="right"?1:0),v.y,v.z),L.multiplyScalar(U),L.applyAxisAngle(D.up,D.rotation.y),S.add(L),L.set(b.x,b.y,b.z),L.multiplyScalar(U),P.orientation?T.fromArray(P.orientation):T.copy(D.quaternion),C.setFromQuaternion(T),C.set(C.x,C.y,0),L.applyEuler(C),S.add(L)},updatePose:function(){var S=this.controller,M=this.data,C=this.el.object3D,T,L=this.system.vrDisplay,B;S&&(T=S.pose,T.position?C.position.fromArray(T.position):M.armModel&&this.applyArmModel(C.position),T.orientation&&C.quaternion.fromArray(T.orientation),L&&T.position&&(B=this.el.sceneEl.renderer.xr.getStandingMatrix(),C.matrix.compose(C.position,C.quaternion,C.scale),C.matrix.multiplyMatrices(B,C.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),C.rotateX(this.data.orientationOffset.x*A.MathUtils.DEG2RAD),C.rotateY(this.data.orientationOffset.y*A.MathUtils.DEG2RAD),C.rotateZ(this.data.orientationOffset.z*A.MathUtils.DEG2RAD))},updateButtons:function(){var S,M=this.controller,C;if(M){for(C=0;C<M.buttons.length;++C)this.buttonStates[C]||(this.buttonStates[C]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[C]||(this.buttonEventDetails[C]={id:C,state:this.buttonStates[C]}),S=M.buttons[C],this.handleButton(C,S);this.handleAxes()}},handleButton:function(S,M){var C;return C=this.handlePress(S,M)|this.handleTouch(S,M)|this.handleValue(S,M),C?(this.el.emit(E.BUTTONCHANGED,this.buttonEventDetails[S],!1),!0):!1},handleAxes:function(){var S=!1,M=this.controller.axes,C,T=this.axis,L=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),C=0;C<M.length;++C)L.push(T[C]!==M[C]),L[C]&&(S=!0);if(!S)return!1;for(this.axis.splice(0,this.axis.length),C=0;C<M.length;C++)this.axis.push(M[C]);return this.el.emit(E.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(S,M){var C,T=this.buttonStates[S];return M.pressed===T.pressed?!1:(C=M.pressed?E.BUTTONDOWN:E.BUTTONUP,this.el.emit(C,this.buttonEventDetails[S],!1),T.pressed=M.pressed,!0)},handleTouch:function(S,M){var C,T=this.buttonStates[S];return M.touched===T.touched?!1:(C=M.touched?E.TOUCHSTART:E.TOUCHEND,this.el.emit(C,this.buttonEventDetails[S],!1,x),T.touched=M.touched,!0)},handleValue:function(S,M){var C=this.buttonStates[S];return M.value===C.value?!1:(C.value=M.value,!0)}})},"./src/components/tracked-controls-webxr.js":(c,u,h)=>{var d=h("./src/utils/tracked-controls.js"),f=h("./src/core/component.js").registerComponent,p={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};c.exports.Component=f("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var A=this.el.sceneEl;this.updateController(),A.addEventListener("controllersupdated",this.updateController)},pause:function(){var A=this.el.sceneEl;A.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(A){return!(!this.controller||this.controller.gamepad||A.inputSource.handedness!=="none"&&A.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=d.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var A=this.el.sceneEl,g=this.controller,v=A.frame;!g||!A.frame||!this.system.referenceSpace||g.hand||(this.pose=v.getPose(g[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var A=this.el.object3D,g=this.pose;g&&(A.matrix.elements=g.transform.matrix,A.matrix.decompose(A.position,A.rotation,A.scale))},updateButtons:function(){var A,g,v=this.controller,b;if(!(!v||!v.gamepad)){for(b=v.gamepad,g=0;g<b.buttons.length;++g)this.buttonStates[g]||(this.buttonStates[g]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[g]||(this.buttonEventDetails[g]={id:g,state:this.buttonStates[g]}),A=b.buttons[g],this.handleButton(g,A);this.handleAxes()}},handleButton:function(A,g){var v;return v=this.handlePress(A,g)|this.handleTouch(A,g)|this.handleValue(A,g),v?(this.el.emit(p.BUTTONCHANGED,this.buttonEventDetails[A],!1),!0):!1},handleAxes:function(){var A=!1,g=this.controller.gamepad.axes,v,b=this.axis,x=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),v=0;v<g.length;++v)x.push(b[v]!==g[v]),x[v]&&(A=!0);if(!A)return!1;for(this.axis.splice(0,this.axis.length),v=0;v<g.length;v++)this.axis.push(g[v]);return this.el.emit(p.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(A,g){var v,b=this.buttonStates[A];return g.pressed===b.pressed?!1:(v=g.pressed?p.BUTTONDOWN:p.BUTTONUP,this.el.emit(v,this.buttonEventDetails[A],!1),b.pressed=g.pressed,!0)},handleTouch:function(A,g){var v,b=this.buttonStates[A];return g.touched===b.touched?!1:(v=g.touched?p.TOUCHSTART:p.TOUCHEND,this.el.emit(v,this.buttonEventDetails[A],!1),b.touched=g.touched,!0)},handleValue:function(A,g){var v=this.buttonStates[A];return g.value===v.value?!1:(v.value=g.value,!0)}})},"./src/components/tracked-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;c.exports.Component=d("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},update:function(){var f=this.data,p=this.el;p.sceneEl.hasWebXR?p.setAttribute("tracked-controls-webxr",{id:f.id,hand:f.hand,index:f.controller,iterateControllerProfiles:f.iterateControllerProfiles,handTrackingEnabled:f.handTrackingEnabled,space:f.space}):p.setAttribute("tracked-controls-webvr",f)}})},"./src/components/valve-index-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/bind.js"),p=h("./src/lib/three.js"),A=h("./src/utils/tracked-controls.js"),g=A.checkControllerPresentAndSetup,v=A.emitIfAxesChanged,b=A.onButtonEvent,x=h("./src/constants/index.js").AFRAME_CDN_ROOT,E=x+"controllers/valve/index/valve-index-",S={left:E+"left.glb",right:E+"right.glb"},M="valve",C=h("./src/utils/index.js").device.isWebXRAvailable,T={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},L={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},B={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},F={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},D=C?F:B,P=C?L:T;c.exports.Component=d("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var U=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=f(this.onButtonChanged,this),this.onButtonDown=function(K){b(K.detail.id,"down",U)},this.onButtonUp=function(K){b(K.detail.id,"up",U)},this.onButtonTouchEnd=function(K){b(K.detail.id,"touchend",U)},this.onButtonTouchStart=function(K){b(K.detail.id,"touchstart",U)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=f(this.onModelLoaded,this),this.onControllersUpdate=f(this.onControllersUpdate,this),this.checkIfControllerPresent=f(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=f(this.removeControllersUpdateListener,this),this.onAxisMoved=f(this.onAxisMoved,this)},addEventListeners:function(){var U=this.el;U.addEventListener("buttonchanged",this.onButtonChanged),U.addEventListener("buttondown",this.onButtonDown),U.addEventListener("buttonup",this.onButtonUp),U.addEventListener("touchend",this.onButtonTouchEnd),U.addEventListener("touchstart",this.onButtonTouchStart),U.addEventListener("model-loaded",this.onModelLoaded),U.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var U=this.el;U.removeEventListener("buttonchanged",this.onButtonChanged),U.removeEventListener("buttondown",this.onButtonDown),U.removeEventListener("buttonup",this.onButtonUp),U.removeEventListener("touchend",this.onButtonTouchEnd),U.removeEventListener("touchstart",this.onButtonTouchStart),U.removeEventListener("model-loaded",this.onModelLoaded),U.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var U=this.data,K=U.hand==="right"?0:U.hand==="left"?1:2;g(this,M,{index:K,iterateControllerProfiles:!0,hand:U.hand})},injectTrackedControls:function(){var U=this.el,K=this.data;U.setAttribute("tracked-controls",{idPrefix:M,controller:K.hand==="right"?1:K.hand==="left"?0:2,hand:K.hand,orientationOffset:K.orientationOffset}),this.loadModel()},loadModel:function(){var U=this.data;U.model&&this.el.setAttribute("gltf-model",""+S[U.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(U){var K=this.mapping.buttons[U.detail.id],J=this.buttonMeshes,z;K&&(K==="trigger"&&(z=U.detail.state.value,J&&J.trigger&&(J.trigger.rotation.x=this.triggerOriginalRotationX-z*(Math.PI/40))),this.el.emit(K+"changed",U.detail.state))},onModelLoaded:function(U){var K,J=U.detail.model,z=this;this.data.model&&(K=this.buttonMeshes={},K.grip={left:J.getObjectByName("leftgrip"),right:J.getObjectByName("rightgrip")},K.menu=J.getObjectByName("menubutton"),K.system=J.getObjectByName("systembutton"),K.trackpad=J.getObjectByName("touchpad"),K.trigger=J.getObjectByName("trigger"),this.triggerOriginalRotationX=K.trigger.rotation.x,Object.keys(K).forEach(function(j){z.setButtonColor(j,z.data.buttonColor)}),J.position.copy(P[this.data.hand]),J.rotation.copy(D[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new p.Vector3(0,0,0)}))},onAxisMoved:function(U){v(this,this.mapping.axes,U)},updateModel:function(U,K){var J,z;this.data.model&&(z=K.indexOf("touch")!==-1,!z&&(J=K==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(U,J)))},setButtonColor:function(U,K){}})},"./src/components/visible.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent;c.exports.Component=d("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/bind.js"),p=h("./src/utils/tracked-controls.js"),A=p.checkControllerPresentAndSetup,g=p.emitIfAxesChanged,v=p.onButtonEvent,b=h("./src/constants/index.js").AFRAME_CDN_ROOT,x=b+"controllers/vive/vr_controller_vive.obj",E=b+"controllers/vive/vr_controller_vive.mtl",S=h("./src/utils/index.js").device.isWebXRAvailable,M="htc-vive",C="OpenVR ",T=S?M:C,L={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},B={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]},F=S?B:L;c.exports.Component=d("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:F,init:function(){var D=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=f(this.onButtonChanged,this),this.onButtonDown=function(P){v(P.detail.id,"down",D)},this.onButtonUp=function(P){v(P.detail.id,"up",D)},this.onButtonTouchEnd=function(P){v(P.detail.id,"touchend",D)},this.onButtonTouchStart=function(P){v(P.detail.id,"touchstart",D)},this.previousButtonValues={},this.bindMethods()},update:function(){var D=this.data;this.controllerIndex=D.hand==="right"?0:D.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=f(this.onModelLoaded,this),this.onControllersUpdate=f(this.onControllersUpdate,this),this.checkIfControllerPresent=f(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=f(this.removeControllersUpdateListener,this),this.onAxisMoved=f(this.onAxisMoved,this)},addEventListeners:function(){var D=this.el;D.addEventListener("buttonchanged",this.onButtonChanged),D.addEventListener("buttondown",this.onButtonDown),D.addEventListener("buttonup",this.onButtonUp),D.addEventListener("touchend",this.onButtonTouchEnd),D.addEventListener("touchstart",this.onButtonTouchStart),D.addEventListener("model-loaded",this.onModelLoaded),D.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var D=this.el;D.removeEventListener("buttonchanged",this.onButtonChanged),D.removeEventListener("buttondown",this.onButtonDown),D.removeEventListener("buttonup",this.onButtonUp),D.removeEventListener("touchend",this.onButtonTouchEnd),D.removeEventListener("touchstart",this.onButtonTouchStart),D.removeEventListener("model-loaded",this.onModelLoaded),D.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var D=this.data;A(this,T,{index:this.controllerIndex,hand:D.hand})},injectTrackedControls:function(){var D=this.el,P=this.data;D.setAttribute("tracked-controls",{idPrefix:T,hand:P.hand,controller:this.controllerIndex,orientationOffset:P.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:x,mtl:E})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(D){var P=this.mapping.buttons[D.detail.id],U=this.buttonMeshes,K;P&&(P==="trigger"&&(K=D.detail.state.value,U&&U.trigger&&(U.trigger.rotation.x=-K*(Math.PI/12))),this.el.emit(P+"changed",D.detail.state))},onModelLoaded:function(D){var P,U=D.detail.model,K=this;this.data.model&&(P=this.buttonMeshes={},P.grip={left:U.getObjectByName("leftgrip"),right:U.getObjectByName("rightgrip")},P.menu=U.getObjectByName("menubutton"),P.system=U.getObjectByName("systembutton"),P.trackpad=U.getObjectByName("touchpad"),P.trigger=U.getObjectByName("trigger"),Object.keys(P).forEach(function(J){K.setButtonColor(J,K.data.buttonColor)}),U.position.set(0,-.015,.04))},onAxisMoved:function(D){g(this,this.mapping.axes,D)},updateModel:function(D,P){var U,K;this.data.model&&(K=P.indexOf("touch")!==-1,!K&&(U=P==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(D,U)))},setButtonColor:function(D,P){var U=this.buttonMeshes;if(U){if(D==="grip"){U.grip.left.material.color.set(P),U.grip.right.material.color.set(P);return}U[D].material.color.set(P)}}})},"./src/components/vive-focus-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/bind.js"),p=h("./src/utils/tracked-controls.js"),A=p.checkControllerPresentAndSetup,g=p.emitIfAxesChanged,v=p.onButtonEvent,b="HTC Vive Focus",x=h("./src/constants/index.js").AFRAME_CDN_ROOT,E=x+"controllers/vive/focus-controller/focus-controller.gltf";c.exports.Component=d("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=f(this.onModelLoaded,this),this.onControllersUpdate=f(this.onControllersUpdate,this),this.checkIfControllerPresent=f(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=f(this.removeControllersUpdateListener,this),this.onAxisMoved=f(this.onAxisMoved,this)},init:function(){var S=this;this.onButtonChanged=f(this.onButtonChanged,this),this.onButtonDown=function(M){v(M.detail.id,"down",S)},this.onButtonUp=function(M){v(M.detail.id,"up",S)},this.onButtonTouchStart=function(M){v(M.detail.id,"touchstart",S)},this.onButtonTouchEnd=function(M){v(M.detail.id,"touchend",S)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var S=this.el;S.addEventListener("buttonchanged",this.onButtonChanged),S.addEventListener("buttondown",this.onButtonDown),S.addEventListener("buttonup",this.onButtonUp),S.addEventListener("touchstart",this.onButtonTouchStart),S.addEventListener("touchend",this.onButtonTouchEnd),S.addEventListener("model-loaded",this.onModelLoaded),S.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var S=this.el;S.removeEventListener("buttonchanged",this.onButtonChanged),S.removeEventListener("buttondown",this.onButtonDown),S.removeEventListener("buttonup",this.onButtonUp),S.removeEventListener("touchstart",this.onButtonTouchStart),S.removeEventListener("touchend",this.onButtonTouchEnd),S.removeEventListener("model-loaded",this.onModelLoaded),S.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){A(this,b,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var S=this.el,M=this.data;S.setAttribute("tracked-controls",{armModel:M.armModel,idPrefix:b,orientationOffset:M.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",E)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(S){var M=S.detail.model,C;this.data.model&&(C=this.buttonMeshes={},C.trigger=M.getObjectByName("BumperKey"),C.triggerPressed=M.getObjectByName("BumperKey_Press"),C.triggerPressed&&(C.triggerPressed.visible=!1),C.trackpad=M.getObjectByName("TouchPad"),C.trackpadPressed=M.getObjectByName("TouchPad_Press"),C.trackpadPressed&&(C.trackpadPressed.visible=!1))},onButtonChanged:function(S){var M=this.mapping.buttons[S.detail.id];M&&this.el.emit(M+"changed",S.detail.state)},onAxisMoved:function(S){g(this,this.mapping.axes,S)},updateModel:function(S,M){this.data.model&&this.updateButtonModel(S,M)},updateButtonModel:function(S,M){var C=this.buttonMeshes,T=S+"Pressed";if(!(!C||!C[S]||!C[T])){var L;switch(M){case"down":L=this.data.buttonHighlightColor;break;case"touchstart":L=this.data.buttonTouchedColor;break}L&&C[T].material.color.set(L),C[T].visible=!!L,C[S].visible=!L}}})},"./src/components/wasd-controls.js":(c,u,h)=>{var d=h("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,f=h("./src/core/component.js").registerComponent,p=h("./src/lib/three.js"),A=h("./src/utils/index.js"),g=A.bind,v=A.shouldCaptureKeyEvent,b=1e-5,x=.2,E=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];c.exports.Component=f("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new p.Vector3,this.onBlur=g(this.onBlur,this),this.onContextMenu=g(this.onContextMenu,this),this.onFocus=g(this.onFocus,this),this.onKeyDown=g(this.onKeyDown,this),this.onKeyUp=g(this.onKeyUp,this),this.onVisibilityChange=g(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(M,C){var T=this.data,L=this.el,B=this.velocity;!B[T.adAxis]&&!B[T.wsAxis]&&S(this.keys)||(C=C/1e3,this.updateVelocity(C),!(!B[T.adAxis]&&!B[T.wsAxis])&&L.object3D.position.add(this.getMovementVector(C)))},update:function(M){M.adAxis!==this.data.adAxis&&(this.velocity[M.adAxis]=0),M.wsAxis!==this.data.wsAxis&&(this.velocity[M.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(M){var C,T,L,B=this.data,F=this.keys,D=this.velocity,P,U;if(T=B.adAxis,P=B.wsAxis,M>x){D[T]=0,D[P]=0;return}var K=Math.pow(1/this.easing,M*60);D[T]!==0&&(D[T]=D[T]*K),D[P]!==0&&(D[P]=D[P]*K),Math.abs(D[T])<b&&(D[T]=0),Math.abs(D[P])<b&&(D[P]=0),B.enabled&&(C=B.acceleration,B.adEnabled&&(L=B.adInverted?-1:1,(F.KeyA||F.ArrowLeft)&&(D[T]-=L*C*M),(F.KeyD||F.ArrowRight)&&(D[T]+=L*C*M)),B.wsEnabled&&(U=B.wsInverted?-1:1,(F.KeyW||F.ArrowUp)&&(D[P]-=U*C*M),(F.KeyS||F.ArrowDown)&&(D[P]+=U*C*M)))},getMovementVector:function(){var M=new p.Vector3(0,0,0),C=new p.Euler(0,0,0,"YXZ");return function(T){var L=this.el.getAttribute("rotation"),B=this.velocity,F;return M.copy(B),M.multiplyScalar(T),L&&(F=this.data.fly?L.x:0,C.set(p.MathUtils.degToRad(F),p.MathUtils.degToRad(L.y),0),M.applyEuler(C)),M}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var M=Object.keys(this.keys),C=0;C<M.length;C++)delete this.keys[M[C]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(M){var C;v(M)&&(C=M.code||d[M.keyCode],E.indexOf(C)!==-1&&(this.keys[C]=!0))},onKeyUp:function(M){var C;C=M.code||d[M.keyCode],delete this.keys[C]}});function S(M){var C;for(C in M)return!1;return!0}},"./src/components/windows-motion-controls.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/utils/bind.js"),p=h("./src/utils/tracked-controls.js"),A=p.checkControllerPresentAndSetup,g=p.emitIfAxesChanged,v=p.onButtonEvent,b=h("./src/utils/index.js"),x=b.debug("components:windows-motion-controls:debug"),E=b.debug("components:windows-motion-controls:warn"),S=h("./src/constants/index.js").DEFAULT_HANDEDNESS,M=h("./src/constants/index.js").AFRAME_CDN_ROOT,C=M+"controllers/microsoft/",T={left:"left.glb",right:"right.glb",default:"universal.glb"},L=h("./src/utils/index.js").device.isWebXRAvailable,B="windows-mixed-reality",F="Spatial Controller (Spatial Interaction Source) ",D=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,P=L?B:F,U={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},K={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},J=L?K:U;c.exports.Component=d("windows-motion-controls",{schema:{hand:{default:S},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:J,bindMethods:function(){this.onModelError=f(this.onModelError,this),this.onModelLoaded=f(this.onModelLoaded,this),this.onControllersUpdate=f(this.onControllersUpdate,this),this.checkIfControllerPresent=f(this.checkIfControllerPresent,this),this.onAxisMoved=f(this.onAxisMoved,this)},init:function(){var z=this,j=this.el;this.onButtonChanged=f(this.onButtonChanged,this),this.onButtonDown=function(G){v(G.detail.id,"down",z)},this.onButtonUp=function(G){v(G.detail.id,"up",z)},this.onButtonTouchStart=function(G){v(G.detail.id,"touchstart",z)},this.onButtonTouchEnd=function(G){v(G.detail.id,"touchend",z)},this.onControllerConnected=function(){z.setModelVisibility(!0)},this.onControllerDisconnected=function(){z.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},j.addEventListener("controllerconnected",this.onControllerConnected),j.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var z=this.el;z.addEventListener("buttonchanged",this.onButtonChanged),z.addEventListener("buttondown",this.onButtonDown),z.addEventListener("buttonup",this.onButtonUp),z.addEventListener("touchstart",this.onButtonTouchStart),z.addEventListener("touchend",this.onButtonTouchEnd),z.addEventListener("axismove",this.onAxisMoved),z.addEventListener("model-error",this.onModelError),z.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var z=this.el;z.removeEventListener("buttonchanged",this.onButtonChanged),z.removeEventListener("buttondown",this.onButtonDown),z.removeEventListener("buttonup",this.onButtonUp),z.removeEventListener("touchstart",this.onButtonTouchStart),z.removeEventListener("touchend",this.onButtonTouchEnd),z.removeEventListener("axismove",this.onAxisMoved),z.removeEventListener("model-error",this.onModelError),z.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){A(this,P,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var z=this.createControllerModelUrl();this.loadModel(z)},createControllerModelUrl:function(z){var j=this.el.components["tracked-controls"],G=j?j.controller:null,H="default",te=this.data.hand,Z;if(G&&!window.hasNativeWebXRImplementation&&(te=G.hand,!z)){var ee=G.id.match(D);H=ee&&ee[0]||H}return Z=T[te]||T.default,C+H+"/"+Z},injectTrackedControls:function(){var z=this.data;this.el.setAttribute("tracked-controls",{idPrefix:P,controller:z.pair,hand:z.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(z){var j=this.createControllerModelUrl(!0);z.detail.src!==j?(E("Failed to load controller model for device, attempting to load default."),this.loadModel(j)):E("Failed to load default controller model.")},loadModel:function(z){this.el.setAttribute("gltf-model","url("+z+")")},onModelLoaded:function(z){var j=this.controllerModel=z.detail.model,G=this.loadedMeshInfo,H,te,Z,ee;if(x("Processing model"),G.buttonMeshes={},G.axisMeshes={},j){for(H=0;H<this.mapping.buttons.length;H++){if(te=this.mapping.buttonMeshNames[this.mapping.buttons[H]],!te){x("Skipping unknown button at index: "+H+" with mapped name: "+this.mapping.buttons[H]);continue}if(Z=j.getObjectByName(te),!Z){E("Missing button mesh with name: "+te);continue}ee={index:H,value:oe(Z,"VALUE"),pressed:oe(Z,"PRESSED"),unpressed:oe(Z,"UNPRESSED")},ee.value&&ee.pressed&&ee.unpressed?G.buttonMeshes[this.mapping.buttons[H]]=ee:E("Missing button submesh under mesh with name: "+te+"(VALUE: "+!!ee.value+", PRESSED: "+!!ee.pressed+", UNPRESSED:"+!!ee.unpressed+")")}for(H=0;H<this.mapping.axisMeshNames.length;H++){if(te=this.mapping.axisMeshNames[H],!te){x("Skipping unknown axis at index: "+H);continue}if(Z=j.getObjectByName(te),!Z){E("Missing axis mesh with name: "+te);continue}ee={index:H,value:oe(Z,"VALUE"),min:oe(Z,"MIN"),max:oe(Z,"MAX")},ee.value&&ee.min&&ee.max?G.axisMeshes[H]=ee:E("Missing axis submesh under mesh with name: "+te+"(VALUE: "+!!ee.value+", MIN: "+!!ee.min+", MAX:"+!!ee.max+")")}this.calculateRayOriginFromMesh(j),this.setModelVisibility()}x("Model load complete.");function oe(xe,Pe){for(var me=0,Ce=xe.children.length;me<Ce;me++){var Je=xe.children[me];if(Je&&Je.name===Pe)return Je}}},calculateRayOriginFromMesh:function(){var z=new THREE.Quaternion;return function(j){var G;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,G=j.getObjectByName(this.mapping.pointingPoseMeshName),G){var H=j.parent;H&&(j.parent=null,j.updateMatrixWorld(!0),j.parent=H),G.getWorldPosition(this.rayOrigin.origin),G.getWorldQuaternion(z),this.rayOrigin.direction.applyQuaternion(z),H&&j.updateMatrixWorld(!0)}else x("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var z=new THREE.Quaternion;return function(j,G){var H=this.loadedMeshInfo.axisMeshes[j];if(H){var te=H.min,Z=H.max,ee=H.value,oe=G*.5+.5;ee.setRotationFromQuaternion(z.copy(te.quaternion).slerp(Z.quaternion,oe)),ee.position.lerpVectors(te.position,Z.position,oe)}}}(),lerpButtonTransform:function(){var z=new THREE.Quaternion;return function(j,G){var H=this.loadedMeshInfo.buttonMeshes[j];if(H){var te=H.unpressed,Z=H.pressed,ee=H.value;ee.setRotationFromQuaternion(z.copy(te.quaternion).slerp(Z.quaternion,G)),ee.position.lerpVectors(te.position,Z.position,G)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(z){var j=this.mapping.buttons[z.detail.id];j&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(j,z.detail.state.value),this.el.emit(j+"changed",z.detail.state))},onAxisMoved:function(z){var j=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var G=0;G<j;G++)this.lerpAxisTransform(G,z.detail.axis[G]||0);g(this,this.mapping.axes,z)},setModelVisibility:function(z){var j=this.el.getObject3D("mesh");this.controllerPresent&&(z=z!==void 0?z:this.modelVisible,this.modelVisible=z,j&&(j.visible=z))}})},"./src/constants/index.js":(c,u,h)=>{c.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:h("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":c=>{c.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},"./src/core/a-assets.js":(c,u,h)=>{var d=h("./src/core/a-node.js").ANode,f=h("./src/utils/bind.js"),p=h("./src/utils/debug.js"),A=h("./src/lib/three.js"),g=new A.FileLoader,v=p("core:a-assets:warn");class b extends d{constructor(){super(),this.isAssets=!0,this.fileLoader=g,this.timeout=null}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var F=this,D,P=[],U,K,J,z,j;if(super.connectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(z=this.querySelectorAll("img"),D=0;D<z.length;D++)J=S(z[D]),P.push(new Promise(function(G,H){if(A.Cache.add(z[D].getAttribute("src"),J),J.complete){G();return}J.onload=G,J.onerror=H}));for(K=this.querySelectorAll("audio, video"),D=0;D<K.length;D++)U=S(K[D]),!U.src&&!U.srcObject&&v("Audio/video asset has neither `src` nor `srcObject` attributes."),P.push(E(U));Promise.allSettled(P).then(f(this.load,this)),j=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){F.hasLoaded||(v("Asset loading timed out in ",j,"ms"),F.emit("timeout"),F.load())},j)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(D){return D.isAssetItem&&D.hasAttribute("src")})}}customElements.define("a-assets",b);class x extends d{constructor(){super(),this.data=null,this.isAssetItem=!0}connectedCallback(){var F=this,D=this.getAttribute("src");g.setResponseType(this.getAttribute("response-type")||T(D)),g.load(D,function(U){F.data=U,d.prototype.load.call(F)},function(U){F.emit("progress",{loadedBytes:U.loaded,totalBytes:U.total,xhr:U})},function(U){F.emit("error",{xhr:U})})}}customElements.define("a-asset-item",x);function E(B){if(!(!B.hasAttribute("autoplay")&&B.getAttribute("preload")!=="auto"))return new Promise(function(F,D){if(B.readyState===4)return F();if(B.error)return D();B.addEventListener("loadeddata",P,!1),B.addEventListener("progress",P,!1),B.addEventListener("error",D,!1);function P(){for(var U=0,K=0;K<B.buffered.length;K++)U+=B.buffered.end(K)-B.buffered.start(K);U>=B.duration&&(B.tagName==="VIDEO"&&A.Cache.add(B.getAttribute("src"),B),F())}})}function S(B){var F=M(B);return F.tagName&&F.tagName.toLowerCase()==="video"&&(F.setAttribute("playsinline",""),F.setAttribute("webkit-playsinline","")),F!==B&&(B.parentNode.appendChild(F),B.parentNode.removeChild(B)),F}function M(B){var F,D;return B.hasAttribute("crossorigin")||(D=B.getAttribute("src"),D!==null&&(D.indexOf("://")===-1||C(D)===window.location.host))?B:(v('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',D),B.crossOrigin="anonymous",F=B.cloneNode(!0),F)}function C(B){var F=B.indexOf("://")>-1?B.split("/")[2]:B.split("/")[0];return F.substring(0,F.indexOf(":"))}function T(B){var F=L(B),D=F.lastIndexOf(".");if(D>=0){var P=F.slice(D,B.search(/\?|#|$/));if(P===".glb")return"arraybuffer"}return"text"}c.exports.inferResponseType=T;function L(B){var F=document.createElement("a");F.href=B;var D=F.search.replace(/^\?/,""),P=B.replace(D,"").replace("?","");return P.substring(P.lastIndexOf("/")+1)}c.exports.getFileNameFromURL=L},"./src/core/a-cubemap.js":(c,u,h)=>{var d=h("./src/utils/debug.js"),f=d("core:cubemap:warn");class p extends HTMLElement{constructor(g){return g=super(g),g}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}p.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var g=this.querySelectorAll("[src]"),v,b=[];if(g.length===6){for(v=0;v<g.length;v++)b.push(g[v].getAttribute("src"));return b}f("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",p)},"./src/core/a-entity.js":(c,u,h)=>{var d=h("./src/core/a-node.js").ANode,f=h("./src/core/component.js").components,p=h("./src/lib/three.js"),A=h("./src/utils/index.js"),g=A.debug("core:a-entity:debug"),v=A.debug("core:a-entity:warn"),b="__",x=["position","rotation","scale","visible"],E={once:!0};class S extends d{constructor(){super(),this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new p.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(D,P,U){var K=this.components[D];if(super.attributeChangedCallback(),K&&K.justInitialized&&U===""){delete K.justInitialized;return}!K&&U===null||this.setEntityAttribute(D,P,U)}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}S.prototype.doConnectedCallback.call(this)}doConnectedCallback(){var D=this,P,U;if(super.connectedCallback(),U=this.sceneEl,this.addToParent(),!this.isScene){if(!U){this.load();return}if(P=U.querySelector("a-assets"),P&&!P.hasLoaded){P.addEventListener("loaded",function(){D.load()});return}this.load()}}disconnectedCallback(){var D;if(this.parentEl){for(D in this.components)this.removeComponent(D,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(D){return this.object3DMap[D]}setObject3D(D,P){var U,K=this;if(!(P instanceof p.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");U=this.getObject3D(D),U&&this.object3D.remove(U),P.el=this,P.children.length&&P.traverse(function(z){z.el=K}),this.object3D.add(P),this.object3DMap[D]=P,this.emit("object3dset",{object:P,type:D})}removeObject3D(D){var P=this.getObject3D(D);if(!P){v("Tried to remove `Object3D` of type:",D,"which was not defined.");return}this.object3D.remove(P),delete this.object3DMap[D],this.emit("object3dremove",{type:D})}getOrCreateObject3D(D,P){var U=this.getObject3D(D);return!U&&P&&(U=new P,this.setObject3D(D,U)),v("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),U}add(D){if(!D.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(D.object3D),this.emit("child-attached",{el:D})}addToParent(){var D=this.parentEl=this.parentNode;!D||!D.add||this.attachedToParent||(D.add(this),this.attachedToParent=!0)}removeFromParent(){var D=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,D.emit("child-detached",{el:this})}load(){var D=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){D.parentEl&&(D.updateComponents(),(D.isScene||D.parentEl.isPlaying)&&D.play())})}remove(D){D?this.object3D.remove(D.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var D=this.children,P=[],U=0;U<D.length;U++){var K=D[U];K instanceof S&&P.push(K)}return P}initComponent(D,P,U){var K,J,z,j,G;if(z=A.split(D,b),j=z[0],J=z.length>2?z.slice(1).join("__"):z[1],!!f[j]&&(G=M(this,D)||P!==void 0,!(!G&&!U)&&!(D in this.components))){if(this.initComponentDependencies(j),J&&!f[j].multiple)throw new Error("Trying to initialize multiple components of type `"+j+"`. There can only be one component of this type per entity.");K=new f[j].Component(this,P,J),this.isPlaying&&K.play(),this.hasAttribute(D)||(K.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,D,"")),g("Component initialized: %s",D)}}initComponentDependencies(D){var P=this,U=f[D],K,J;if(U&&(K=f[D].dependencies,!!K))for(J=0;J<K.length;J++)P.initComponent(K[J],window.HTMLElement.prototype.getAttribute.call(P,K[J])||void 0,!0)}removeComponent(D,P){var U;if(U=this.components[D],!!U){if(!U.initialized){this.addEventListener("componentinitialized",function K(J){J.detail.name===D&&(this.removeComponent(D,P),this.removeEventListener("componentinitialized",K))});return}U.pause(),U.remove(),P&&(U.destroy(),delete this.components[D]),this.emit("componentremoved",U.evtDetail,!1)}}updateComponents(){var D,P,U,K,J=this.componentsToUpdate;if(this.hasLoaded){for(U=0;U<this.mixinEls.length;U++)for(K in this.mixinEls[U].componentCache)L(K)&&(J[K]=!0);if(this.getExtraComponents){P=this.getExtraComponents();for(K in P)L(K)&&(J[K]=!0)}for(U=0;U<this.attributes.length;++U)K=this.attributes[U].name,x.indexOf(K)===-1&&L(K)&&(J[K]=!0);for(U=0;U<x.length;U++)K=x[U],this.hasAttribute(K)&&this.updateComponent(K,this.getDOMAttribute(K));for(K in J)D=T(this.getDOMAttribute(K),P&&P[K]),this.updateComponent(K,D),delete J[K]}}updateComponent(D,P,U){var K=this.components[D];if(K){if(P===null&&!M(this,D)){this.removeComponent(D,!0);return}K.updateProperties(P,U);return}this.initComponent(D,P,!1)}removeAttribute(D,P){var U=this.components[D];if(U&&P===void 0&&this.removeComponent(D,!0),U&&P!==void 0){U.resetProperty(P);return}D==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,D)}play(){var D,P,U;if(!(this.isPlaying||!this.hasLoaded)){this.isPlaying=!0;for(U in this.components)this.components[U].play();for(D=this.getChildEntities(),P=0;P<D.length;P++)D[P].play();this.emit("play")}}pause(){var D,P,U;if(this.isPlaying){this.isPlaying=!1;for(U in this.components)this.components[U].pause();for(D=this.getChildEntities(),P=0;P<D.length;P++)D[P].pause();this.emit("pause")}}setEntityAttribute(D,P,U){if(f[D]||this.components[D]){this.updateComponent(D,U);return}if(D==="mixin"){if(U===this.computedMixinStr)return;this.mixinUpdate(U,P)}}mixinUpdate(D,P){var U=S.componentsUpdated,K,J,z,j,G=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){G.mixinUpdate(D,P)},E);return}for(P=P||this.getAttribute("mixin"),z=this.updateMixins(D,P),U.length=0,j=0;j<this.mixinEls.length;j++)for(K in this.mixinEls[j].componentCache)U.indexOf(K)===-1&&(this.components[K]?this.components[K].handleMixinUpdate():this.initComponent(K,null),U.push(K));for(j=0;j<z.oldMixinIds.length;j++)if(J=document.getElementById(z.oldMixinIds[j]),!!J)for(K in J.componentCache)U.indexOf(K)===-1&&this.components[K]&&(this.getDOMAttribute(K)?this.components[K].handleMixinUpdate():this.removeComponent(K,!0))}setAttribute(D,P,U){var K=S.singlePropUpdate,J,z,j,G,H,te;if(G=D.indexOf(b),j=G>0?D.substring(0,G):D,!f[j]){D==="mixin"&&this.mixinUpdate(P),super.setAttribute.call(this,D,P);return}if(!this.components[D]&&this.hasAttribute(D)&&this.updateComponent(D,window.HTMLElement.prototype.getAttribute.call(this,D)),typeof U<"u"&&typeof P=="string"&&P.length>0&&typeof A.styleParser.parse(P)=="string"){for(te in K)delete K[te];J=K,J[P]=U,z=!1}else J=P,z=U===!0;this.updateComponent(D,J,z),H=this.sceneEl&&this.sceneEl.getAttribute("debug"),H&&this.components[D].flushToDOM()}flushToDOM(D){var P=this.components,U,K=this.children,J,z;for(z in P)P[z].flushToDOM();if(D)for(J=0;J<K.length;++J)U=K[J],U.flushToDOM&&U.flushToDOM(D)}getAttribute(D){var P;return D==="position"?this.object3D.position:D==="rotation"?B(this):D==="scale"?this.object3D.scale:D==="visible"?this.object3D.visible:(P=this.components[D],P?P.data:window.HTMLElement.prototype.getAttribute.call(this,D))}getDOMAttribute(D){var P=this.components[D];return P?P.attrValue:window.HTMLElement.prototype.getAttribute.call(this,D)}addState(D){this.is(D)||(this.states.push(D),this.emit("stateadded",D))}removeState(D){var P=this.states.indexOf(D);P!==-1&&(this.states.splice(P,1),this.emit("stateremoved",D))}is(D){return this.states.indexOf(D)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var D;if(this.parentNode){v("Entity can only be destroyed if detached from scenegraph.");return}for(D in this.components)this.components[D].destroy()}}function M(F,D){return F.components[D]&&F.components[D].attrValue?!0:C(D,F.mixinEls)}function C(F,D){var P,U=!1;for(P=0;P<D.length&&(U=D[P].hasAttribute(F),!U);++P);return U}function T(F,D){return D?D.constructor===Object?A.extend(D,A.styleParser.parse(F||{})):F||D:F}function L(F){return F.indexOf(b)!==-1&&(F=A.split(F,b)[0]),!!f[F]}function B(F){var D=p.MathUtils.radToDeg,P=F.object3D.rotation,U=F.rotationObj;return U.x=D(P.x),U.y=D(P.y),U.z=D(P.z),U}S.componentsUpdated=[],S.singlePropUpdate={},customElements.define("a-entity",S),c.exports.AEntity=S},"./src/core/a-mixin.js":(c,u,h)=>{var d=h("./src/core/a-node.js").ANode,f=h("./src/core/component.js").components,p=h("./src/utils/index.js"),A="__";class g extends d{constructor(){super(),this.componentCache={},this.isMixin=!0}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){super.connectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(b,x,E){super.attributeChangedCallback(),this.cacheAttribute(b,E),this.updateEntities()}setAttribute(b,x){window.HTMLElement.prototype.setAttribute.call(this,b,x),this.cacheAttribute(b,x)}cacheAttribute(b,x){var E,S;S=p.split(b,A)[0],E=f[S],E&&(x===void 0&&(x=window.HTMLElement.prototype.getAttribute.call(this,b)),this.componentCache[b]=E.parseAttrValueForCache(x))}getAttribute(b){return this.componentCache[b]||window.HTMLElement.prototype.getAttribute.call(this,b)}cacheAttributes(){var b=this.attributes,x,E;for(E=0;E<b.length;E++)x=b[E].name,this.cacheAttribute(x)}updateEntities(){var b,x,E;if(this.sceneEl)for(x=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),E=0;E<x.length;E++)b=x[E],!(!b.hasLoaded||b.isMixin)&&b.mixinUpdate(this.id)}}customElements.define("a-mixin",g)},"./src/core/a-node.js":(c,u,h)=>{var d=h("./src/utils/index.js"),f=d.debug("core:a-node:warn"),p={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function A(v){return v.tagName.toLowerCase()in p||v.isNode}class g extends HTMLElement{constructor(){super(),this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}g.prototype.doConnectedCallback.call(this)}doConnectedCallback(){var b;this.sceneEl=this.closestScene(),this.sceneEl||f("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(b=this.getAttribute("mixin"),b&&this.updateMixins(b))}attributeChangedCallback(b,x,E){E!==this.computedMixinStr&&b==="mixin"&&!this.isMixin&&this.updateMixins(E,x)}closestScene(){for(var b=this;b&&!b.isScene;)b=b.parentElement;return b}closest(b){for(var x=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,E=this;E&&!x.call(E,b);)E=E.parentElement;return E}disconnectedCallback(){this.hasLoaded=!1}load(b,x){var E,S,M=this;this.hasLoaded||(x=x||A,E=this.getChildren(),S=E.filter(x).map(function(C){return new Promise(function(L,B){if(C.hasLoaded)return L();C.addEventListener("loaded",L),C.addEventListener("error",B)})}),Promise.allSettled(S).then(function(T){T.forEach(function(B){B.status==="rejected"&&f("Rendering scene with errors on node: ",B.reason.target)}),M.hasLoaded=!0,M.setupMutationObserver(),b&&b(),M.emit("loaded",void 0,!1)}))}setupMutationObserver(){var b=this,x={attributes:!0,attributeOldValue:!0},E=new MutationObserver(function(M){var C;for(C=0;C<M.length;C++)if(M[C].type==="attributes"){var T=M[C].attributeName,L=window.HTMLElement.prototype.getAttribute.call(b,T),B=M[C].oldValue;b.attributeChangedCallback(T,B,L)}});E.observe(this,x)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(b,x){var E=g.newMixinIdArray,S=g.oldMixinIdArray,M=g.mixinIds,C,T,L;for(E.length=0,S.length=0,T=b?d.split(b.trim(),/\s+/):E,L=x?d.split(x.trim(),/\s+/):S,M.newMixinIds=T,M.oldMixinIds=L,C=0;C<L.length;C++)T.indexOf(L[C])===-1&&this.unregisterMixin(L[C]);for(this.computedMixinStr="",this.mixinEls.length=0,C=0;C<T.length;C++)this.registerMixin(document.getElementById(T[C]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),M}registerMixin(b){var x,E,S;if(b){if(S=b.getAttribute("mixin"),S)for(x=d.split(S.trim(),/\s+/),E=0;E<x.length;E++)this.registerMixin(document.getElementById(x[E]));this.computedMixinStr=this.computedMixinStr+" "+b.id,this.mixinEls.push(b)}}setAttribute(b,x){b==="mixin"&&this.updateMixins(x),window.HTMLElement.prototype.setAttribute.call(this,b,x)}unregisterMixin(b){var x,E=this.mixinEls,S;for(x=0;x<E.length;++x)if(S=E[x],b===S.id){E.splice(x,1);break}}emit(b,x,E,S){var M=g.evtData;E===void 0&&(E=!0),M.bubbles=!!E,M.detail=x,S&&(M=d.extend({},S,M)),this.dispatchEvent(new CustomEvent(b,M))}}g.evtData={},g.newMixinIdArray=[],g.oldMixinIdArray=[],g.mixinIds={},customElements.define("a-node",g),c.exports.ANode=g,c.exports.knownTags=p},"./src/core/component.js":(c,u,h)=>{var d=h("./src/core/schema.js"),f=h("./src/core/scene/scenes.js"),p=h("./src/core/system.js"),A=h("./src/utils/index.js"),g=c.exports.components={},v=d.parseProperties,b=d.parseProperty,x=d.process,E=d.isSingleProperty,S=d.stringifyProperties,M=d.stringifyProperty,C=A.styleParser,T=A.debug("core:component:warn"),L=document.currentScript,B=new RegExp("[A-Z]+"),F={},D=c.exports.Component=function(Z,ee,oe){var xe=this;this.el=Z,this.id=oe,this.attrName=this.name+(oe?"__"+oe:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=F[this.name];var Pe=this.events;this.events={},P(this,Pe),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),A.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),A.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),A.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),A.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=A.throttleLeadingAndTrailing(function(){Z.emit("componentchanged",xe.evtDetail,!1)},200),this.updateProperties(ee)};D.prototype={schema:{},init:function(){},events:{},update:function(Z){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(Z,ee){var oe=this.schema;return this.isSingleProperty?b(Z,oe):v(C.parse(Z),oe,!0,this.name,ee)},stringify:function(Z){var ee=this.schema;return typeof Z=="string"?Z:this.isSingleProperty?M(Z,ee):(Z=S(Z,ee),C.stringify(Z))},updateCachedAttrValue:function(Z,ee){var oe,xe,Pe;if(Z!==void 0){if(Z===null){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(Z instanceof Object&&!(Z instanceof window.HTMLElement)?(xe=this.objectPool.use(),oe=A.extend(xe,Z)):oe=this.parseAttrValueForCache(Z),this.isObjectBased&&!ee&&this.attrValue)for(Pe in this.attrValue)oe[Pe]===void 0&&(oe[Pe]=this.attrValue[Pe]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),A.objectPool.clearObject(this.attrValue),this.attrValue=J(this.attrValue,oe,this.isObjectBased),A.objectPool.clearObject(xe)}},parseAttrValueForCache:function(Z){var ee;return typeof Z!="string"?Z:(this.isSingleProperty?(ee=this.schema.parse(Z),typeof ee=="string"&&(ee=Z)):(A.objectPool.clearObject(this.parsingAttrValue),ee=C.parse(Z,this.parsingAttrValue)),ee)},flushToDOM:function(Z){var ee=Z?this.data:this.attrValue;ee!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(ee))},updateProperties:function(Z,ee){var oe=this.el;if(!oe.hasLoaded){this.updateCachedAttrValue(Z);return}Z!==null&&(Z=this.parseAttrValueForCache(Z)),this.updateCachedAttrValue(Z,ee),this.initialized?(this.updateComponent(Z,ee),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var Z=this.el,ee;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),!Z.initializingComponents[this.name]&&(Z.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete Z.initializingComponents[this.name],this.oldData=J(this.oldData,this.data,this.isObjectBased),ee=this.isObjectBased?this.objectPool.use():void 0,this.update(ee),this.isObjectBased&&this.objectPool.recycle(ee),Z.isPlaying&&this.play(),Z.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(Z,ee){var oe,xe;if(ee){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&b(Z,this.schema),this.data=Z;return}if(v(Z,this.schema,!0,this.name),this.schemaChangeKeys.length){for(oe in Z)if(this.schema[oe].schemaChange){xe=!0;break}}if(xe){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for(oe in Z)Z[oe]!==void 0&&(this.data[oe]=Z[oe])},callUpdateHandler:function(){var Z;this.previousOldData instanceof Object&&A.objectPool.clearObject(this.previousOldData),this.isObjectBased?K(this.previousOldData,this.oldData):this.previousOldData=this.oldData,Z=!A.deepEqual(this.oldData,this.data),!(!this.isPositionRotationScale&&!Z)&&(this.oldData instanceof Object&&A.objectPool.clearObject(this.oldData),this.oldData=J(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(Z){if(this.isObjectBased){if(!(Z in this.attrValue))return;delete this.attrValue[Z],this.data[Z]=this.schema[Z].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(Z){var ee;ee=A.extend({},g[this.name].schema),A.extend(ee,Z),this.schema=x(ee),this.el.emit("schemachanged",this.evtDetail)},buildData:function(Z,ee,oe){var xe,Pe,me,Ce,Je,Oe=this.nextData,$e=this.schema,nt,gt=this.el.mixinEls,Tt;if(xe=Z&&Z.constructor===Array?Z.length:Z!=null,this.isObjectBased&&A.objectPool.clearObject(Oe),this.isSingleProperty)this.isObjectBased?Pe=K(Oe,$e.default):Pe=te($e.default)?A.clone($e.default):$e.default;else{Tt=!ee&&this.attrValue,Pe=Tt instanceof Object?K(Oe,Tt):Oe;for(Ce in $e)me=$e[Ce].default,Pe[Ce]===void 0&&(Pe[Ce]=te(me)?A.clone(me):me)}for(nt=0;nt<gt.length;nt++)Je=gt[nt].getAttribute(this.attrName),Je&&(Pe=J(Pe,Je,this.isObjectBased));if(xe){if(this.isSingleProperty)return H(Z)?(K(this.parsingAttrValue,Z),b(this.parsingAttrValue,$e)):b(Z,$e);Pe=J(Pe,Z,this.isObjectBased)}else if(this.isSingleProperty)return b(Pe,$e);return v(Pe,$e,void 0,this.name,oe)},eventsAttach:function(){var Z;this.eventsDetach();for(Z in this.events)this.el.addEventListener(Z,this.events[Z])},eventsDetach:function(){var Z;for(Z in this.events)this.el.removeEventListener(Z,this.events[Z])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}};function P(Z,ee){var oe;for(oe in ee)Z.events[oe]=ee[oe].bind(Z)}if(window.debug)var U=c.exports.registrationOrderWarnings={};c.exports.registerComponent=function(Z,ee){var oe,xe,Pe={},me,Ce,Je;if(document.currentScript&&document.currentScript!==L&&f.forEach(function($e){$e.hasLoaded||document.currentScript.compareDocumentPosition($e)!==Node.DOCUMENT_POSITION_FOLLOWING&&(T("The component `"+Z+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(U[Z]=!0))}),B.test(Z)===!0&&T("The component name `"+Z+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+Z.toLowerCase()+"`"),Z.indexOf("__")!==-1)throw new Error("The component name `"+Z+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(ee).forEach(function(Oe){Pe[Oe]={value:ee[Oe],writable:!0}}),g[Z])throw new Error("The component `"+Z+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(oe=function(Oe,$e,nt){D.call(this,Oe,$e,nt)},oe.prototype=Object.create(D.prototype,Pe),oe.prototype.name=Z,oe.prototype.isPositionRotationScale=Z==="position"||Z==="rotation"||Z==="scale",oe.prototype.constructor=oe,oe.prototype.system=p&&p.systems[Z],oe.prototype.play=G(oe.prototype.play),oe.prototype.pause=j(oe.prototype.pause),me=A.extend(x(oe.prototype.schema,oe.prototype.name)),oe.prototype.isSingleProperty=Ce=E(oe.prototype.schema),oe.prototype.isSinglePropertyObject=Je=Ce&&H(b(void 0,me))&&!(me.default instanceof window.HTMLElement),oe.prototype.isObjectBased=!Ce||Je,!Ce){oe.prototype.schemaChangeKeys=[];for(xe in me)me[xe].schemaChange&&oe.prototype.schemaChangeKeys.push(xe)}return F[Z]=A.objectPool.createPool(),g[Z]={Component:oe,dependencies:oe.prototype.dependencies,isSingleProperty:oe.prototype.isSingleProperty,isSinglePropertyObject:oe.prototype.isSinglePropertyObject,isObjectBased:oe.prototype.isObjectBased,multiple:oe.prototype.multiple,name:Z,parse:oe.prototype.parse,parseAttrValueForCache:oe.prototype.parseAttrValueForCache,schema:me,stringify:oe.prototype.stringify,type:oe.prototype.type},oe};function K(Z,ee){var oe,xe;for(xe in ee)ee[xe]!==void 0&&(oe=ee[xe],Z[xe]=te(oe)?A.clone(oe):oe);return Z}function J(Z,ee,oe){var xe;if(oe&&ee.constructor===Object){for(xe in ee)ee[xe]!==void 0&&(ee[xe]&&ee[xe].constructor===Object?Z[xe]=A.clone(ee[xe]):Z[xe]=ee[xe]);return Z}return ee}function z(Z){return Z.tick||Z.tock}function j(Z){return function(){var oe=this.el.sceneEl;this.isPlaying&&(Z.call(this),this.isPlaying=!1,this.eventsDetach(),z(this)&&oe.removeBehavior(this))}}function G(Z){return function(){var oe=this.el.sceneEl,xe=this.el.isPlaying&&!this.isPlaying;!this.initialized||!xe||(Z.call(this),this.isPlaying=!0,this.eventsAttach(),z(this)&&oe.addBehavior(this))}}function H(Z){return Z&&Z.constructor===Object&&!(Z instanceof window.HTMLElement)}function te(Z){return Z&&(Z.constructor===Object||Z.constructor===Array)&&!(Z instanceof window.HTMLElement)}},"./src/core/geometry.js":(c,u,h)=>{var d=h("./src/core/schema.js"),f=d.process,p=c.exports.geometries={},A=c.exports.geometryNames=[],g=h("./src/lib/three.js"),v=c.exports.Geometry=function(){};v.prototype={schema:{},init:function(b){return this.geometry=new g.BufferGeometry,this.geometry},update:function(b){}},c.exports.registerGeometry=function(b,x){var E,S={};if(Object.keys(x).forEach(function(C){S[C]={value:x[C],writable:!0}}),p[b])throw new Error("The geometry `"+b+"` has been already registered");return E=function(){v.call(this)},E.prototype=Object.create(v.prototype,S),E.prototype.name=b,E.prototype.constructor=E,p[b]={Geometry:E,schema:f(E.prototype.schema)},A.push(b),E}},"./src/core/propertyTypes.js":(c,u,h)=>{var d=h("./src/utils/coordinates.js"),f=h("./node_modules/debug/browser.js"),p=f("core:propertyTypes:warn"),A=f("core:propertyTypes:warn"),g=c.exports.propertyTypes={},v=/[,> .[\]:]/,b=/\url\((.+)\)/;x("audio","",M),x("array",[],E,S),x("asset","",M),x("boolean",!1,L),x("color","#FFF",C,T),x("int",0,B),x("number",0,F),x("map","",M),x("model","",M),x("selector",null,D,U),x("selectorAll",null,P,K),x("src","",J),x("string","",C,T),x("time",0,B),x("vec2",{x:0,y:0},z,d.stringify),x("vec3",{x:0,y:0,z:0},z,d.stringify),x("vec4",{x:0,y:0,z:0,w:1},z,d.stringify);function x(H,te,Z,ee){if("type"in g){p("Property type "+H+" is already registered.");return}g[H]={default:te,parse:Z||C,stringify:ee||T}}c.exports.registerPropertyType=x;function E(H){if(Array.isArray(H))return H;if(!H||typeof H!="string")return[];return H.split(",").map(te);function te(Z){return Z.trim()}}function S(H){return H.join(", ")}function M(H){var te,Z;if(typeof H!="string")return H;if(Z=H.match(b),Z)return Z[1];if(H.charAt(0)==="#"){if(te=document.getElementById(H.substring(1)),te)return te.tagName==="CANVAS"||te.tagName==="VIDEO"||te.tagName==="IMG"?te:te.getAttribute("src");A('"'+H+'" asset not found.');return}return H}function C(H){return H}function T(H){return H===null?"null":H.toString()}function L(H){return H!=="false"&&H!==!1}function B(H){return parseInt(H,10)}function F(H){return parseFloat(H,10)}function D(H){return H?typeof H!="string"?H:H[0]==="#"&&!v.test(H)?document.getElementById(H.substring(1)):document.querySelector(H):null}function P(H){return H?typeof H!="string"?H:Array.prototype.slice.call(document.querySelectorAll(H),0):null}function U(H){return H.getAttribute?"#"+H.getAttribute("id"):T(H)}function K(H){return H instanceof Array?H.map(function(te){return"#"+te.getAttribute("id")}).join(", "):T(H)}function J(H){return A("`src` property type is deprecated. Use `asset` instead."),M(H)}function z(H){return d.parse(H,this.default)}function j(H,te){return H==="audio"&&typeof te!="string"||H==="array"&&!Array.isArray(te)||H==="asset"&&typeof te!="string"||H==="boolean"&&typeof te!="boolean"||H==="color"&&typeof te!="string"||H==="int"&&typeof te!="number"||H==="number"&&typeof te!="number"||H==="map"&&typeof te!="string"||H==="model"&&typeof te!="string"||H==="selector"&&typeof te!="string"&&te!==null||H==="selectorAll"&&typeof te!="string"&&te!==null||H==="src"&&typeof te!="string"||H==="string"&&typeof te!="string"||H==="time"&&typeof te!="number"?!1:H==="vec2"?G(te,2):H==="vec3"?G(te,3):H==="vec4"?G(te,4):!0}c.exports.isValidDefaultValue=j;function G(H,te){if(H===null)return!0;if(typeof H!="object"||Object.keys(H).length!==te)return!1;var Z=H.x,ee=H.y,oe=H.z,xe=H.w;return!(typeof Z!="number"||typeof ee!="number"||te>2&&typeof oe!="number"||te>3&&typeof xe!="number")}c.exports.isValidDefaultCoordinate=G},"./src/core/scene/a-scene.js":(c,u,h)=>{var d=h("./src/core/scene/metaTags.js").inject,f=h("./src/core/scene/wakelock.js"),p=h("./src/core/scene/loadingScreen.js"),A=h("./src/core/scene/scenes.js"),g=h("./src/core/system.js").systems,v=h("./src/lib/three.js"),b=h("./src/utils/index.js"),x=h("./src/core/a-entity.js").AEntity,E=h("./src/core/a-node.js").ANode,S=h("./src/core/scene/postMessage.js"),M=b.bind,C=b.device.isIOS(),T=b.device.isMobile(),L=b.device.isWebXRAvailable,B=b.debug("core:a-scene:warn");C&&h("./src/utils/ios-orientationchange-blank-bug.js");class F extends x{constructor(){var G;super(),G=this,G.clock=new v.Clock,G.isIOS=C,G.isMobile=T,G.hasWebXR=L,G.isAR=!1,G.isScene=!0,G.object3D=new v.Scene,G.object3D.onAfterRender=function(H,te,Z){G.isPlaying&&G.tock(G.time,G.delta,Z)},G.resize=M(G.resize,G),G.render=M(G.render,G),G.systems={},G.systemNames=[],G.time=G.delta=0,G.behaviors={tick:[],tock:[]},G.hasLoaded=!1,G.isPlaying=!1,G.originalHTML=G.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var G=this,H=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.connectedCallback(),z(this),this.setupRenderer(),p.setup(this,P),this.resize(),H||this.addFullScreenStyles(),S(this),d(this),f(this),this.onVRPresentChangeBound=M(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){G.enterVR()},this.exitVRBound=function(){G.exitVR()},this.exitVRTrueBound=function(){G.exitVR(!0)},this.pointerRestrictedBound=function(){G.pointerRestricted()},this.pointerUnrestrictedBound=function(){G.pointerUnrestricted()},G.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){G.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){G.enterVR()})}attachedCallbackPostCamera(){var G,H=this;window.addEventListener("load",G),window.addEventListener("resize",function(){H.isIOS?setTimeout(H.resize,100):H.resize()}),this.play(),A.push(this)}initSystems(){var G;this.initSystem("camera");for(G in g)G!=="camera"&&this.initSystem(G)}initSystem(G){this.systems[G]||(this.systems[G]=new g[G](this),this.systemNames.push(G))}disconnectedCallback(){var G=A.indexOf(this);super.disconnectedCallback(),A.splice(G,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(G){var H,te=this.behaviors,Z;for(Z in te)G[Z]&&(H=this.behaviors[Z],H.indexOf(G)===-1&&H.push(G))}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return b.device.checkHeadsetConnected()}enterAR(){var G;if(!this.hasWebXR)throw G="Failed to enter AR mode, WebXR not supported.",new Error(G);if(!b.device.checkARSupport())throw G="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(G);return this.enterVR(!0)}enterVR(G){var H=this,te,Z=H.renderer.xr,ee;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var oe=H.getAttribute("renderer");if(Z.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var xe=this.sceneEl.systems.webxr.sessionReferenceSpaceType;Z.setReferenceSpaceType(xe);var Pe=G?"immersive-ar":"immersive-vr";return ee=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(Oe,$e){navigator.xr.requestSession(Pe,ee).then(function(gt){H.xrSession=gt,Z.layersEnabled=ee.requiredFeatures.indexOf("layers")!==-1,Z.setSession(gt).then(function(){Z.setFoveation(oe.foveationLevel)}),H.systems.renderer.setWebXRFrameRate(gt),gt.addEventListener("end",H.exitVRBound),Ce(Oe)},function(gt){var Tt=Pe==="immersive-ar",Ze=Tt?"AR":"VR";$e(new Error("Failed to enter "+Ze+" mode (`requestSession`)",{cause:gt}))})})}else{if(te=b.device.getVRDisplay(),Z.setDevice(te),te.isPresenting&&!window.hasNativeWebVRImplementation)return Ce(),Promise.resolve();var me={highRefreshRate:oe.highRefreshRate};return te.requestPresent([{source:this.canvas,attributes:me}]).then(Ce,Je)}}return Ce(),Promise.resolve();function Ce(Oe){var $e;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&($e=new CustomEvent("vrdisplaypresentchange",{detail:{display:b.device.getVRDisplay()}}),window.dispatchEvent($e)),G?H.addState("ar-mode"):H.addState("vr-mode"),H.emit("enter-vr",{target:H}),!H.hasWebXR&&H.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),H.addFullScreenStyles(),!H.isMobile&&!H.checkHeadsetConnected()&&K(H.canvas),H.resize(),Oe&&Oe()}function Je(Oe){throw H.removeState("vr-mode"),Oe&&Oe.message?new Error("Failed to enter VR mode (`requestPresent`): "+Oe.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var G=this,H,te=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(te.enabled=!1,H=b.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(H.isPresenting)return H.exitPresent().then(Z,ee)}else J();return Z(),Promise.resolve();function Z(){G.removeState("vr-mode"),G.removeState("ar-mode"),G.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),G.hasAttribute("embedded")&&G.removeFullScreenStyles(),G.resize(),G.isIOS&&b.forceCanvasResizeSafariMobile(G.canvas),G.renderer.setPixelRatio(window.devicePixelRatio),G.emit("exit-vr",{target:G})}function ee(oe){throw oe&&oe.message?new Error("Failed to exit VR mode (`exitPresent`): "+oe.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var G=this.getPointerLockElement();G&&G!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var G=this.getPointerLockElement();G&&G===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(G){var H=G.display||G.detail.display;if(H&&H.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(G){var H=this.systems[G];return H?H.data:x.prototype.getAttribute.call(this,G)}getComputedAttribut(G){B("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(G)}getDOMAttribute(G){var H=this.systems[G];return H?H.data:x.prototype.getDOMAttribute.call(this,G)}setAttribute(G,H,te){var Z=this.systems[G];if(Z){E.prototype.setAttribute.call(this,G,H),Z.updateProperties(H);return}x.prototype.setAttribute.call(this,G,H,te)}removeBehavior(G){var H,te,Z=this.behaviors,ee;for(te in Z)G[te]&&(H=this.behaviors[te],ee=H.indexOf(G),ee!==-1&&H.splice(ee,1))}resize(){var G=this.camera,H=this.canvas,te,Z,ee,oe=this.renderer.xr.isPresenting;Z=this.renderer.xr.enabled&&oe,!(!G||!H||this.is("vr-mode")&&(this.isMobile||Z))&&(te=this.getAttribute("embedded")&&!this.is("vr-mode"),ee=P(H,te,this.maxCanvasSize,this.is("vr-mode")),G.aspect=ee.width/ee.height,G.updateProjectionMatrix(),this.renderer.setSize(ee.width,ee.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var G=this,H,te,Z,ee;ee={alpha:!0,antialias:!T,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(Z=this.getAttribute("renderer"),te=b.styleParser.parse(Z),te.precision&&(ee.precision=te.precision+"p"),te.antialias&&te.antialias!=="auto"&&(ee.antialias=te.antialias==="true"),te.logarithmicDepthBuffer&&te.logarithmicDepthBuffer!=="auto"&&(ee.logarithmicDepthBuffer=te.logarithmicDepthBuffer==="true"),te.alpha&&(ee.alpha=te.alpha==="true"),te.multiviewStereo&&(ee.multiviewStereo=te.multiviewStereo==="true"),this.maxCanvasSize={width:te.maxCanvasWidth?parseInt(te.maxCanvasWidth):this.maxCanvasSize.width,height:te.maxCanvasHeight?parseInt(te.maxCanvasHeight):this.maxCanvasSize.height}),H=this.renderer=new v.WebGLRenderer(ee),H.setPixelRatio(window.devicePixelRatio),this.camera&&H.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){H.xr.setPoseTarget(G.camera.el.object3D)})}play(){var G=this,H=this;if(this.renderStarted){x.prototype.play.call(this);return}this.addEventListener("loaded",function(){var te=this.renderer,Z,ee=this.renderer.xr;x.prototype.play.call(this),!H.renderStarted&&(H.resize(),H.renderer&&(window.performance&&window.performance.mark("render-started"),p.remove(),Z=b.device.getVRDisplay(),Z&&Z.isPresenting&&(ee.setDevice(Z),ee.enabled=!0,H.enterVR()),te.setAnimationLoop(this.render),H.renderStarted=!0,H.emit("renderstart")))}),setTimeout(function(){x.prototype.load.call(G)})}updateComponent(G){G in g||x.prototype.updateComponent.apply(this,arguments)}tick(G,H){var te,Z=this.systems;for(te=0;te<this.behaviors.tick.length;te++)this.behaviors.tick[te].el.isPlaying&&this.behaviors.tick[te].tick(G,H);for(te=0;te<this.systemNames.length;te++)Z[this.systemNames[te]].tick&&Z[this.systemNames[te]].tick(G,H)}tock(G,H,te){var Z,ee=this.systems;for(Z=0;Z<this.behaviors.tock.length;Z++)this.behaviors.tock[Z].el.isPlaying&&this.behaviors.tock[Z].tock(G,H,te);for(Z=0;Z<this.systemNames.length;Z++)ee[this.systemNames[Z]].tock&&ee[this.systemNames[Z]].tock(G,H,te)}render(G,H){var te=this.renderer;this.frame=H,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var Z=null;this.is("ar-mode")&&(Z=this.object3D.background,this.object3D.background=null),te.render(this.object3D,this.camera),Z&&(this.object3D.background=Z)}}function D(j,G){var H,te=window.devicePixelRatio;return!G||G.width===-1&&G.height===-1||j.width*te<G.width&&j.height*te<G.height||(H=j.width/j.height,j.width*te>G.width&&G.width!==-1&&(j.width=Math.round(G.width/te),j.height=Math.round(G.width/H/te)),j.height*te>G.height&&G.height!==-1&&(j.height=Math.round(G.height/te),j.width=Math.round(G.height*H/te))),j}window.customElements.define("a-scene",F);function P(j,G,H,te){if(!j.parentElement)return{height:0,width:0};if(G){var Z;return Z={height:j.parentElement.offsetHeight,width:j.parentElement.offsetWidth},D(Z,H)}return U(H,te)}function U(j,G){var H;return H={height:document.body.offsetHeight,width:document.body.offsetWidth},G?H:D(H,j)}function K(j){var G=j.requestFullscreen||j.webkitRequestFullscreen||j.mozRequestFullScreen||j.msRequestFullscreen;G.apply(j,[{navigationUI:"hide"}])}function J(){var j=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;j&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function z(j){var G;G=document.createElement("canvas"),G.classList.add("a-canvas"),G.dataset.aframeCanvas=!0,j.appendChild(G),document.addEventListener("fullscreenchange",H),document.addEventListener("mozfullscreenchange",H),document.addEventListener("webkitfullscreenchange",H),document.addEventListener("MSFullscreenChange",H),G.addEventListener("touchmove",function(te){te.preventDefault()}),j.canvas=G,j.emit("render-target-loaded",{target:G}),setTimeout(M(j.resize,j),0);function H(){var te=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;te||j.exitVR(),document.activeElement.blur(),document.body.focus()}}c.exports.setupCanvas=z,c.exports.AScene=F},"./src/core/scene/loadingScreen.js":(c,u,h)=>{var d=h("./src/utils/index.js"),f=d.styleParser,p,A,g,v="loading-screen",b="a-loader-title";c.exports.setup=function(M,C){p=M,g=C;var T=p.hasAttribute(v)?f.parse(p.getAttribute(v)):void 0,L=T&&T.dotsColor||"white",B=T&&T.backgroundColor||"#24CAFF",F=T===void 0||T.enabled==="true"||T.enabled===void 0,D,P,U,K,J,z,j,G,H,te;F&&(D=new THREE.Scene,P=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),U=new THREE.MeshBasicMaterial({color:L}),K=new THREE.Mesh(P,U),J=K.clone(),z=K.clone(),j=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),G=new THREE.Clock,H=0,te=function(){p.renderer.render(D,j),H=G.getElapsedTime()%4,K.visible=H>=1,J.visible=H>=2,z.visible=H>=3},D.background=new THREE.Color(B),D.add(j),K.position.set(-1,0,-15),J.position.set(0,0,-15),z.position.set(1,0,-15),j.add(K),j.add(J),j.add(z),E(),setTimeout(function(){p.hasLoaded||(x(j),A.style.display="block",window.addEventListener("resize",function(){x(j)}),p.renderer.setAnimationLoop(te))},200))},c.exports.remove=function(){window.removeEventListener("resize",x),A&&(A.style.display="none")};function x(S){var M=p.hasAttribute("embedded"),C=g(p.canvas,M,p.maxCanvasSize,p.is("vr-mode"));S.aspect=C.width/C.height,S.updateProjectionMatrix(),p.renderer.setSize(C.width,C.height,!1)}function E(){A=document.createElement("div"),A.className=b,A.innerHTML=document.title,A.style.display="none",p.appendChild(A)}},"./src/core/scene/metaTags.js":(c,u,h)=>{var d=h("./src/constants/index.js"),f=h("./src/utils/index.js").extend,p=c.exports.MOBILE_HEAD_TAGS=[g({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),g({name:"mobile-web-app-capable",content:"yes"}),g({name:"theme-color",content:"black"})],A=[g({name:"apple-mobile-web-app-capable",content:"yes"}),g({name:"apple-mobile-web-app-status-bar-style",content:"black"}),v({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function g(x){return{tagName:"meta",attributes:x,exists:function(){return document.querySelector('meta[name="'+x.name+'"]')}}}function v(x){return{tagName:"link",attributes:x,exists:function(){return document.querySelector('link[rel="'+x.rel+'"]')}}}c.exports.inject=function(E){var S=document.head,M=S.querySelector("script"),C,T=[];return p.forEach(L),E.isIOS&&A.forEach(L),T;function L(B){!B||B.exists()||(C=b(B),C&&(M?M.parentNode.insertBefore(C,M):S.appendChild(C),T.push(C)))}};function b(x){if(!(!x||!x.tagName)){var E=document.createElement(x.tagName);return E.setAttribute(d.AFRAME_INJECTED,""),f(E,x.attributes)}}},"./src/core/scene/postMessage.js":(c,u,h)=>{var d=h("./src/utils/bind.js"),f=h("./src/utils/index.js").isIframed;c.exports=function(g){f()&&window.addEventListener("message",d(p,g))};function p(A){var g=this;if(A.data)switch(A.data.type){case"vr":switch(A.data.data){case"enter":g.enterVR();break;case"exit":g.exitVR();break}}}},"./src/core/scene/scenes.js":c=>{c.exports=[]},"./src/core/scene/wakelock.js":(c,u,h)=>{var d=h("./vendor/wakelock/wakelock.js");c.exports=function(p){if(p.isMobile){var A=p.wakelock=new d;p.addEventListener("enter-vr",function(){A.request()}),p.addEventListener("exit-vr",function(){A.release()})}}},"./src/core/schema.js":(c,u,h)=>{var d=h("./src/utils/index.js"),f=h("./src/core/propertyTypes.js"),p=d.debug,A=f.isValidDefaultValue,g=f.propertyTypes,v=p("core:schema:warn");function b(M){return"type"in M?typeof M.type=="string":"default"in M}c.exports.isSingleProperty=b,c.exports.process=function(M,C){var T;if(b(M))return x(M,C);for(T in M)M[T]=x(M[T],C);return M};function x(M,C){var T=M.default,L,B,F=M.type;return M.type?M.type==="bool"?F="boolean":M.type==="float"&&(F="number"):T!==void 0&&(typeof T=="boolean"||typeof T=="number")?F=typeof T:Array.isArray(T)?F="array":F="string",B=g[F],B||v("Unknown property type for component `"+C+"`: "+F),L=!!M.parse,M.parse=M.parse||B.parse,M.stringify=M.stringify||B.stringify,M.type=F,"default"in M?!L&&!A(F,T)&&v("Default value `"+T+"` does not match type `"+F+"` in component `"+C+"`"):M.default=B.default,M}c.exports.processPropertyDefinition=x,c.exports.parseProperties=function(){var M=[];return function(C,T,L,B,F){var D,P,U,K;M.length=0;for(P in L?C:T)L&&C[P]===void 0||M.push(P);if(C===null||typeof C!="object")return C;for(P in C)C[P]!==void 0&&!T[P]&&!F&&v("Unknown property `"+P+"` for component/system `"+B+"`.");for(D=0;D<M.length;D++){if(P=M[D],U=T[P],K=C[P],!T[P])return;C[P]=E(K,U)}return C}}();function E(M,C){return(M==null||M==="")&&(M=C.default,Array.isArray(M)&&(M=M.slice())),C.parse(M,C.default)}c.exports.parseProperty=E,c.exports.stringifyProperties=function(M,C){var T,L,B,F={},D;for(T in M)L=C[T],B=M[T],D=B,typeof D=="object"&&(D=S(B,L),L||v("Unknown component property: "+T)),F[T]=D;return F};function S(M,C){return typeof M!="object"?M:!C||M===null?JSON.stringify(M):C.stringify(M)}c.exports.stringifyProperty=S},"./src/core/shader.js":(c,u,h)=>{var d=h("./src/core/schema.js"),f=d.process,p=c.exports.shaders={},A=c.exports.shaderNames=[],g=h("./src/lib/three.js"),v=h("./src/utils/index.js"),b={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},x=c.exports.Shader=function(){};x.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(E){return this.attributes=this.initVariables(E,"attribute"),this.uniforms=this.initVariables(E,"uniform"),this.material=new(this.raw?g.RawShaderMaterial:g.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw?g.GLSL3:void 0,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(E,S){var M,C=this.schema,T={},L;for(M in C)C[M].is===S&&(L=b[C[M].type],T[M]={type:L,value:void 0});return T},update:function(E){this.updateVariables(E,"attribute"),this.updateVariables(E,"uniform")},updateVariables:function(E,S){var M,C,T=this.schema,L;L=S==="uniform"?this.uniforms:this.attributes;for(M in E)if(!(!T[M]||T[M].is!==S)){if(T[M].type==="map"){if(!L[M]||L[M].value===E[M])continue;C="_texture_"+M,this.setMapOnTextureLoad(L,M,C),v.material.updateMapMaterialFromData(C,M,this,E);continue}L[M].value=this.parseValue(T[M].type,E[M]),L[M].needsUpdate=!0}},parseValue:function(E,S){var M;switch(E){case"vec2":return new g.Vector2(S.x,S.y);case"vec3":return new g.Vector3(S.x,S.y,S.z);case"vec4":return new g.Vector4(S.x,S.y,S.z,S.w);case"color":return M=new g.Color(S),new g.Vector3(M.r,M.g,M.b);case"map":return g.ImageUtils.loadTexture(S);default:return S}},setMapOnTextureLoad:function(E,S,M){var C=this;this.el.addEventListener("materialtextureloaded",function(){E[S].value=C.material[M],E[S].needsUpdate=!0})}},c.exports.registerShader=function(E,S){var M,C={};if(Object.keys(S).forEach(function(T){C[T]={value:S[T],writable:!0}}),p[E])throw new Error("The shader "+E+" has been already registered");return M=function(){x.call(this)},M.prototype=Object.create(x.prototype,C),M.prototype.name=E,M.prototype.constructor=M,p[E]={Shader:M,schema:f(M.prototype.schema)},A.push(E),M}},"./src/core/system.js":(c,u,h)=>{var d=h("./src/core/component.js"),f=h("./src/core/schema.js"),p=h("./src/utils/index.js"),A=f.parseProperties,g=f.parseProperty,v=f.process,b=f.isSingleProperty,x=p.styleParser,E=c.exports.systems={},S=c.exports.System=function(M){var C=d&&d.components[this.name];this.el=M,this.sceneEl=M,C&&(C.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};S.prototype={schema:{},init:function(){},update:function(M){},updateProperties:function(M){var C=this.data;Object.keys(f).length&&(this.buildData(M),this.update(C))},buildData:function(M){var C=this.schema;Object.keys(C).length&&(M=M||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),b(C)?this.data=g(M,C):this.data=A(x.parse(M)||{},C))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},c.exports.registerSystem=function(M,C){var T,L,B={},F=p.findAllScenes(document);if(Object.keys(C).forEach(function(D){B[D]={value:C[D],writable:!0}}),E[M])throw new Error("The system `"+M+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(L=function(D){S.call(this,D)},L.prototype=Object.create(S.prototype,B),L.prototype.name=M,L.prototype.constructor=L,L.prototype.schema=p.extend(v(L.prototype.schema)),E[M]=L,T=0;T<F.length;T++)F[T].initSystem(M)}},"./src/extras/components/index.js":(c,u,h)=>{h("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(c,u,h)=>{var d=h("./src/core/component.js").registerComponent,f=h("./src/lib/three.js"),p=new f.Vector3,A=new f.Vector3;d("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var g=this.data,v=this.el,b=v.object3D.parent,x=v.object3D,E=new f.Group;p.copy(x.position),A.copy(x.rotation),b.remove(x),E.add(x),b.add(E),v.object3D=E,x.position.set(-1*g.x,-1*g.y,-1*g.z),E.position.set(g.x+p.x,g.y+p.y,g.z+p.z),E.rotation.copy(x.rotation),x.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(c,u,h)=>{var d=h("./src/core/component.js").components,f=h("./src/core/shader.js").shaders,p=h("./src/utils/index.js"),A={};Object.keys(d.material.schema).forEach(g),Object.keys(f.standard.schema).forEach(g);function g(v){var b=v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();v==="fog"&&(b="material-fog"),v==="visible"&&(b="material-visible"),A[b]="material."+v}c.exports=function(){return{defaultComponents:{material:{}},mappings:p.extend({},A)}}},"./src/extras/primitives/index.js":(c,u,h)=>{h("./src/extras/primitives/primitives/a-camera.js"),h("./src/extras/primitives/primitives/a-cursor.js"),h("./src/extras/primitives/primitives/a-curvedimage.js"),h("./src/extras/primitives/primitives/a-gltf-model.js"),h("./src/extras/primitives/primitives/a-image.js"),h("./src/extras/primitives/primitives/a-light.js"),h("./src/extras/primitives/primitives/a-link.js"),h("./src/extras/primitives/primitives/a-obj-model.js"),h("./src/extras/primitives/primitives/a-sky.js"),h("./src/extras/primitives/primitives/a-sound.js"),h("./src/extras/primitives/primitives/a-text.js"),h("./src/extras/primitives/primitives/a-video.js"),h("./src/extras/primitives/primitives/a-videosphere.js"),h("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(c,u,h)=>{var d=h("./src/core/a-node.js").knownTags,f=h("./src/core/a-entity.js").AEntity,p=h("./src/core/component.js").components,A=h("./src/utils/index.js"),g=A.debug,v=A.entity.setComponentProperty,b=g("extras:primitives:debug"),x=g("extras:primitives:warn"),E=g("extras:primitives:error"),S=c.exports.primitives={};c.exports.registerPrimitive=function(L,B){if(L=L.toLowerCase(),d[L]){E("Trying to register primitive "+L+" that has been already previously registered");return}d[L]=!0,b("Registering <%s>",L),B.defaultAttributes&&x("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var F=B.mappings||{},D=class extends f{constructor(){super(),this.defaultComponentsFromPrimitive=B.defaultComponents||B.defaultAttributes||{},this.deprecated=B.deprecated||null,this.deprecatedMappings=B.deprecatedMappings||{},this.mappings=F,B.deprecated&&console.warn(B.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var P=this.mappings,U=this;Object.keys(P).forEach(function(J){var z;J!==J.toLowerCase()&&x("Mapping keys should be specified in lower case. The mapping key "+J+" may not be recognized"),p[J]&&(z=P[J].replace(".","-"),P[z]=P[J],delete P[J],console.warn("The primitive "+U.tagName.toLowerCase()+" has a mapping collision. The attribute "+J+" has the same name as a registered component and has been renamed to "+z))})}getExtraComponents(){var P,U,K,J,z,j,G=this;for(U=A.clone(this.defaultComponentsFromPrimitive),z=this.getAttribute("mixin"),z&&(z=z.trim().split(" "),z.forEach(function(xe){var Pe=G.sceneEl.querySelector("#"+xe).componentCache;Object.keys(Pe).forEach(function(Ce){U[Ce]=H(U[Ce],Pe[Ce])})})),K=0;K<this.attributes.length;K++)if(P=this.attributes[K],J=this.mappings[P.name],J){j=A.entity.getComponentPropertyPath(J),j.constructor===Array?(U[j[0]]=U[j[0]]||{},U[j[0]][j[1]]=P.value.trim()):U[j]=P.value.trim();continue}return U;function H(oe,xe){return te(oe)?Z(xe):te(xe)?Z(oe):ee(oe)&&ee(xe)?A.extendDeep(oe,xe):Z(xe)}function te(oe){return typeof oe>"u"}function Z(oe){return ee(oe)?A.extendDeep({},oe):oe}function ee(oe){return oe!==null&&oe.constructor===Object}}attributeChangedCallback(P,U,K){var J=this.mappings[P];if(P in this.deprecatedMappings&&console.warn(this.deprecatedMappings[P]),!P||!J){super.attributeChangedCallback(P,U,K);return}v(this,J,K)}};return customElements.define(L,D),D.mappings=F,S[L]=D,D};function M(T,L){var B=p[T].schema;Object.keys(B).map(function(F){var D=F.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();L[D]!==void 0&&(D=T+"-"+F),L[D]=T+"."+F})}function C(T,L,B){B=B||{},Object.keys(L).map(function(D){M(D,B)}),c.exports.registerPrimitive(T,A.extendDeep({},null,{defaultComponents:L,mappings:B}))}c.exports.definePrimitive=C},"./src/extras/primitives/primitives/a-camera.js":(c,u,h)=>{var d=h("./src/extras/primitives/primitives.js").registerPrimitive;d("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js"),f=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");f("a-cursor",p.extendDeep({},d(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js"),f=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");f("a-curvedimage",p.extendDeep({},d(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(c,u,h)=>{var d=h("./src/extras/primitives/primitives.js").registerPrimitive;d("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js"),f=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");f("a-image",p.extendDeep({},d(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(c,u,h)=>{var d=h("./src/extras/primitives/primitives.js").registerPrimitive;d("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(c,u,h)=>{var d=h("./src/extras/primitives/primitives.js").registerPrimitive;d("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js")(),f=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");f("a-obj-model",p.extendDeep({},d,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js"),f=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js"),A=h("./src/extras/primitives/primitives/meshPrimitives.js");f("a-sky",p.extendDeep({},d(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:p.extendDeep({},A["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(c,u,h)=>{var d=h("./src/extras/primitives/primitives.js").registerPrimitive;d("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(c,u,h)=>{var d=h("./src/extras/primitives/primitives.js").definePrimitive;d("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js"),f=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");f("a-video",p.extendDeep({},d(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js"),f=h("./src/extras/primitives/primitives.js").registerPrimitive,p=h("./src/utils/index.js");f("a-videosphere",p.extendDeep({},d(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(c,u,h)=>{var d=h("./src/extras/primitives/getMeshMixin.js"),f=h("./src/core/geometry.js").geometries,p=h("./src/core/geometry.js").geometryNames,A=h("./src/extras/primitives/primitives.js").registerPrimitive,g=h("./src/utils/index.js"),v=c.exports={};p.forEach(function(E){var S=f[E],M=b(E),C={};Object.keys(S.schema).forEach(function(F){C[b(F)]="geometry."+F});var T="a-"+M,L=A(T,g.extendDeep({},d(),{defaultComponents:{geometry:{primitive:E}},mappings:C}));v[T]=L});function b(x){return x.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js");d("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(p){this.geometry=new f.BoxGeometry(p.width,p.height,p.depth,p.segmentsWidth,p.segmentsHeight,p.segmentsDepth)}})},"./src/geometries/circle.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js"),p=f.MathUtils.degToRad;d("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(A){this.geometry=new f.CircleGeometry(A.radius,A.segments,p(A.thetaStart),p(A.thetaLength))}})},"./src/geometries/cone.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js"),p=f.MathUtils.degToRad;d("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(A){this.geometry=new f.CylinderGeometry(A.radiusTop,A.radiusBottom,A.height,A.segmentsRadial,A.segmentsHeight,A.openEnded,p(A.thetaStart),p(A.thetaLength))}})},"./src/geometries/cylinder.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js"),p=f.MathUtils.degToRad;d("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(A){this.geometry=new f.CylinderGeometry(A.radius,A.radius,A.height,A.segmentsRadial,A.segmentsHeight,A.openEnded,p(A.thetaStart),p(A.thetaLength))}})},"./src/geometries/dodecahedron.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js");d("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new f.DodecahedronGeometry(p.radius,p.detail)}})},"./src/geometries/icosahedron.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js");d("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new f.IcosahedronGeometry(p.radius,p.detail)}})},"./src/geometries/index.js":(c,u,h)=>{h("./src/geometries/box.js"),h("./src/geometries/circle.js"),h("./src/geometries/cone.js"),h("./src/geometries/cylinder.js"),h("./src/geometries/dodecahedron.js"),h("./src/geometries/icosahedron.js"),h("./src/geometries/octahedron.js"),h("./src/geometries/plane.js"),h("./src/geometries/ring.js"),h("./src/geometries/sphere.js"),h("./src/geometries/tetrahedron.js"),h("./src/geometries/torus.js"),h("./src/geometries/torusKnot.js"),h("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js");d("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new f.OctahedronGeometry(p.radius,p.detail)}})},"./src/geometries/plane.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js");d("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(p){this.geometry=new f.PlaneGeometry(p.width,p.height,p.segmentsWidth,p.segmentsHeight)}})},"./src/geometries/ring.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js"),p=f.MathUtils.degToRad;d("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(A){this.geometry=new f.RingGeometry(A.radiusInner,A.radiusOuter,A.segmentsTheta,A.segmentsPhi,p(A.thetaStart),p(A.thetaLength))}})},"./src/geometries/sphere.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js"),p=f.MathUtils.degToRad;d("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(A){this.geometry=new f.SphereGeometry(A.radius,A.segmentsWidth,A.segmentsHeight,p(A.phiStart),p(A.phiLength),p(A.thetaStart),p(A.thetaLength))}})},"./src/geometries/tetrahedron.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js");d("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(p){this.geometry=new f.TetrahedronGeometry(p.radius,p.detail)}})},"./src/geometries/torus.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js"),p=f.MathUtils.degToRad;d("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(A){this.geometry=new f.TorusGeometry(A.radius,A.radiusTubular*2,A.segmentsRadial,A.segmentsTubular,p(A.arc))}})},"./src/geometries/torusKnot.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js");d("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(p){this.geometry=new f.TorusKnotGeometry(p.radius,p.radiusTubular*2,p.segmentsTubular,p.segmentsRadial,p.p,p.q)}})},"./src/geometries/triangle.js":(c,u,h)=>{var d=h("./src/core/geometry.js").registerGeometry,f=h("./src/lib/three.js"),p=new f.Quaternion,A=new f.Vector3(0,0,1),g=new f.Vector2,v=new f.Vector2,b=new f.Vector2;d("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(x){var E,S,M,C,T,L,B,F,D;M=new f.Triangle,M.a.set(x.vertexA.x,x.vertexA.y,x.vertexA.z),M.b.set(x.vertexB.x,x.vertexB.y,x.vertexB.z),M.c.set(x.vertexC.x,x.vertexC.y,x.vertexC.z),S=M.getNormal(new f.Vector3),p.setFromUnitVectors(S,A),C=M.a.clone().applyQuaternion(p),T=M.b.clone().applyQuaternion(p),L=M.c.clone().applyQuaternion(p),g.set(Math.min(C.x,T.x,L.x),Math.min(C.y,T.y,L.y)),v.set(Math.max(C.x,T.x,L.x),Math.max(C.y,T.y,L.y)),b.set(0,0).subVectors(v,g),C=new f.Vector2().subVectors(C,g).divide(b),T=new f.Vector2().subVectors(T,g).divide(b),L=new f.Vector2().subVectors(L,g).divide(b),E=this.geometry=new f.BufferGeometry,B=[M.a.x,M.a.y,M.a.z,M.b.x,M.b.y,M.b.z,M.c.x,M.c.y,M.c.z],F=[S.x,S.y,S.z,S.x,S.y,S.z,S.x,S.y,S.z],D=[C.x,C.y,T.x,T.y,L.x,L.y],E.setAttribute("position",new f.Float32BufferAttribute(B,3)),E.setAttribute("normal",new f.Float32BufferAttribute(F,3)),E.setAttribute("uv",new f.Float32BufferAttribute(D,2))}})},"./src/index.js":(c,u,h)=>{if(window.Promise=window.Promise||h("./node_modules/promise-polyfill/Promise.js"),h("./node_modules/@ungap/custom-elements/index.js"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var d=h("./src/utils/isIOSOlderThan10.js"),f=d(window.navigator.userAgent)?1/window.devicePixelRatio:1,p=h("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),A={BUFFER_SCALE:f,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new p(A)}var g=h("./src/utils/index.js"),v=g.debug;g.isIE11&&(h("./node_modules/custom-event-polyfill/polyfill.js"),h("./vendor/starts-with-polyfill.js"));var b=v("A-Frame:error"),x=v("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&x("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&b("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),h("./node_modules/present/lib/present-browser.js"),g.device.isBrowserEnvironment&&(h("./src/style/aframe.css"),h("./src/style/rStats.css"));var E=h("./src/core/scene/a-scene.js").AScene,S=h("./src/core/component.js").components,M=h("./src/core/component.js").registerComponent,C=h("./src/core/geometry.js").registerGeometry,T=h("./src/extras/primitives/primitives.js").registerPrimitive,L=h("./src/core/shader.js").registerShader,B=h("./src/core/system.js").registerSystem,F=h("./src/core/shader.js").shaders,D=h("./src/core/system.js").systems,P=window.THREE=h("./src/lib/three.js"),U=h("./package.json");h("./src/components/index.js"),h("./src/geometries/index.js"),h("./src/shaders/index.js"),h("./src/systems/index.js");var K=h("./src/core/a-node.js").ANode,J=h("./src/core/a-entity.js").AEntity;h("./src/core/a-assets.js"),h("./src/core/a-cubemap.js"),h("./src/core/a-mixin.js"),h("./src/extras/components/index.js"),h("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.5.0 (Date 2023-11-14, Commit #7856a058)"),console.log("THREE Version (https://github.com/supermedium/three.js):",U.dependencies["super-three"]),console.log("WebVR Polyfill Version:",U.dependencies["webvr-polyfill"]),c.exports=window.AFRAME={AComponent:h("./src/core/component.js").Component,AEntity:J,ANode:K,ANIME:h("./node_modules/super-animejs/lib/anime.es.js").default,AScene:E,components:S,coreComponents:Object.keys(S),geometries:h("./src/core/geometry.js").geometries,registerComponent:M,registerGeometry:C,registerPrimitive:T,registerShader:L,registerSystem:B,primitives:{getMeshMixin:h("./src/extras/primitives/getMeshMixin.js"),primitives:h("./src/extras/primitives/primitives.js").primitives},scenes:h("./src/core/scene/scenes.js"),schema:h("./src/core/schema.js"),shaders:F,systems:D,THREE:P,utils:g,version:U.version}},"./src/lib/rStatsAframe.js":c=>{window.aframeStats=function(u){var h=null,d=u,f={te:{caption:"Entities"},lt:{caption:"Load Time"}},p=[{caption:"A-Frame",values:["te","lt"]}];function A(){h("te").set(g()),window.performance.getEntriesByName&&h("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function g(){var E=d.querySelectorAll("*");return Array.prototype.slice.call(E).filter(function(S){return S.isEntity}),E.length}function v(){}function b(){}function x(E){h=E}return{update:A,start:v,end:b,attach:x,values:f,groups:p,fractions:[]}},c.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(c,u,h)=>{var d=h("./src/lib/three.module.js").default;d.TextureLoader&&(d.TextureLoader.prototype.crossOrigin="anonymous"),d.ImageLoader&&(d.ImageLoader.prototype.crossOrigin="anonymous"),d.Cache&&(d.Cache.enabled=!0),d.DRACOLoader.prototype.crossOrigin="anonymous",d.GLTFLoader.prototype.crossOrigin="anonymous",d.KTX2Loader.prototype.crossOrigin="anonymous",d.MTLLoader.prototype.crossOrigin="anonymous",d.OBJLoader.prototype.crossOrigin="anonymous",c.exports=d},"./src/lib/three.module.js":(c,u,h)=>{h.r(u),h.d(u,{default:()=>C});var d=h("./node_modules/super-three/build/three.module.js"),f=h("./node_modules/super-three/examples/jsm/loaders/DRACOLoader.js"),p=h("./node_modules/super-three/examples/jsm/loaders/GLTFLoader.js"),A=h("./node_modules/super-three/examples/jsm/loaders/KTX2Loader.js"),g=h("./node_modules/super-three/examples/jsm/math/OBB.js"),v=h("./node_modules/super-three/examples/jsm/loaders/OBJLoader.js"),b=h("./node_modules/super-three/examples/jsm/loaders/MTLLoader.js"),x=h("./node_modules/super-three/examples/jsm/utils/BufferGeometryUtils.js"),E=h("./node_modules/super-three/examples/jsm/lights/LightProbeGenerator.js"),S=h("./node_modules/object-assign/index.js"),M=window.THREE=S({},d);h("./vendor/DeviceOrientationControls.js"),M.DRACOLoader=f.DRACOLoader,M.GLTFLoader=p.GLTFLoader,M.KTX2Loader=A.KTX2Loader,M.OBJLoader=v.OBJLoader,M.MTLLoader=b.MTLLoader,M.OBB=g.OBB,M.BufferGeometryUtils=x,M.LightProbeGenerator=E.LightProbeGenerator;const C=M},"./src/shaders/flat.js":(c,u,h)=>{var d=h("./src/core/shader.js").registerShader,f=h("./src/lib/three.js"),p=h("./src/utils/index.js");c.exports.Shader=d("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(g){this.materialData={color:new f.Color},this.textureSrc=null,A(g,this.materialData),this.material=new f.MeshBasicMaterial(this.materialData)},update:function(g){this.updateMaterial(g),p.material.updateMap(this,g)},updateMaterial:function(g){var v;A(g,this.materialData);for(v in this.materialData)this.material[v]=this.materialData[v]}});function A(g,v){return v.color.set(g.color),v.fog=g.fog,v.wireframe=g.wireframe,v.toneMapped=g.toneMapped,v.wireframeLinewidth=g.wireframeLinewidth,v}},"./src/shaders/index.js":(c,u,h)=>{h("./src/shaders/flat.js"),h("./src/shaders/standard.js"),h("./src/shaders/phong.js"),h("./src/shaders/sdf.js"),h("./src/shaders/msdf.js"),h("./src/shaders/ios10hls.js"),h("./src/shaders/shadow.js")},"./src/shaders/ios10hls.js":(c,u,h)=>{var d=h("./src/core/shader.js").registerShader;c.exports.Shader=d("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join(`
`)})},"./src/shaders/msdf.js":(c,u,h)=>{var d=h("./src/core/shader.js").registerShader,f=["in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),p=["precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  fragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`);c.exports.Shader=d("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:f,fragmentShader:p})},"./src/shaders/phong.js":(c,u,h)=>{var d=h("./src/core/shader.js").registerShader,f=h("./src/lib/three.js"),p=h("./src/utils/index.js"),A=new f.CubeTextureLoader,g={};c.exports.Shader=d("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(b){this.materialData={color:new f.Color,specular:new f.Color,emissive:new f.Color},this.textureSrc=null,v(b,this.materialData),this.material=new f.MeshPhongMaterial(this.materialData),p.material.updateMap(this,b)},update:function(b){this.updateMaterial(b),p.material.updateMap(this,b),b.normalMap&&p.material.updateDistortionMap("normal",this,b),b.displacementMap&&p.material.updateDistortionMap("displacement",this,b),b.ambientOcclusionMap&&p.material.updateDistortionMap("ambientOcclusion",this,b),b.bump&&p.material.updateDistortionMap("bump",this,b),this.updateEnvMap(b)},updateMaterial:function(b){var x;v(b,this.materialData);for(x in this.materialData)this.material[x]=this.materialData[x]},updateEnvMap:function(b){var x=this,E=this.material,S=b.envMap,M=b.sphericalEnvMap,C=b.refract,T=this.el.sceneEl;if(!S&&!M||this.isLoadingEnvMap){Object.defineProperty(E,"envMap",{get:function(){return T.object3D.environment},set:function(L){delete this.envMap,this.envMap=L}}),E.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,delete E.envMap,M){this.el.sceneEl.systems.material.loadTexture(M,{src:M},function(B){x.isLoadingEnvMap=!1,B.mapping=C?f.EquirectangularRefractionMapping:f.EquirectangularReflectionMapping,E.envMap=B,p.material.handleTextureEvents(x.el,B),E.needsUpdate=!0});return}if(g[S]){g[S].then(function(L){x.isLoadingEnvMap=!1,E.envMap=L,p.material.handleTextureEvents(x.el,L),E.needsUpdate=!0});return}g[S]=new Promise(function(L){p.srcLoader.validateCubemapSrc(S,function(F){A.load(F,function(D){x.isLoadingEnvMap=!1,E.envMap=D,D.mapping=C?f.CubeRefractionMapping:f.CubeReflectionMapping,p.material.handleTextureEvents(x.el,D),L(D)})})})}});function v(b,x){switch(x.color.set(b.color),x.specular.set(b.specular),x.emissive.set(b.emissive),x.emissiveIntensity=b.emissiveIntensity,x.fog=b.fog,x.transparent=b.transparent,x.wireframe=b.wireframe,x.wireframeLinewidth=b.wireframeLinewidth,x.shininess=b.shininess,x.flatShading=b.flatShading,x.wireframe=b.wireframe,x.wireframeLinewidth=b.wireframeLinewidth,x.reflectivity=b.reflectivity,x.refractionRatio=b.refractionRatio,b.combine){case"mix":x.combine=f.MixOperation;break;case"multiply":x.combine=f.MultiplyOperation;break;case"add":x.combine=f.AddOperation;break}return b.normalMap&&(x.normalScale=b.normalScale),b.ambientOcclusionMap&&(x.aoMapIntensity=b.ambientOcclusionMapIntensity),b.bumpMap&&(x.aoMapIntensity=b.bumpMapScale),b.displacementMap&&(x.displacementScale=b.displacementScale,x.displacementBias=b.displacementBias),x}},"./src/shaders/sdf.js":(c,u,h)=>{var d=h("./src/core/shader.js").registerShader,f=["in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),p=["precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture(map, box.xy).a, width)","        + contour(texture(map, box.zw).a, width)","        + contour(texture(map, box.xw).a, width)","        + contour(texture(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  fragColor = vec4(color, opacity * alpha);","}"].join(`
`);c.exports.Shader=d("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:f,fragmentShader:p})},"./src/shaders/shadow.js":(c,u,h)=>{var d=h("./src/core/shader.js").registerShader,f=h("./src/lib/three.js");c.exports.Shader=d("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(p){this.material=new f.ShadowMaterial},update:function(p){this.material.opacity=p.opacity,this.material.alphaToCoverage=p.alphaToCoverage,this.material.transparent=p.transparent}})},"./src/shaders/standard.js":(c,u,h)=>{var d=h("./src/core/shader.js").registerShader,f=h("./src/lib/three.js"),p=h("./src/utils/index.js"),A=new f.CubeTextureLoader,g={};c.exports.Shader=d("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(b){this.materialData={color:new f.Color,emissive:new f.Color},v(b,this.materialData),this.material=new f.MeshStandardMaterial(this.materialData)},update:function(b){this.updateMaterial(b),p.material.updateMap(this,b),b.normalMap&&p.material.updateDistortionMap("normal",this,b),b.displacementMap&&p.material.updateDistortionMap("displacement",this,b),b.ambientOcclusionMap&&p.material.updateDistortionMap("ambientOcclusion",this,b),b.metalnessMap&&p.material.updateDistortionMap("metalness",this,b),b.roughnessMap&&p.material.updateDistortionMap("roughness",this,b),this.updateEnvMap(b)},updateMaterial:function(b){var x,E=this.material;v(b,this.materialData);for(x in this.materialData)E[x]=this.materialData[x]},updateEnvMap:function(b){var x=this,E=this.material,S=b.envMap,M=b.sphericalEnvMap;if(!S&&!M||this.isLoadingEnvMap){E.envMap=null,E.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,M){this.el.sceneEl.systems.material.loadTexture(M,{src:M},function(T){x.isLoadingEnvMap=!1,T.mapping=f.EquirectangularReflectionMapping,E.envMap=T,p.material.handleTextureEvents(x.el,T),E.needsUpdate=!0});return}if(g[S]){g[S].then(function(C){x.isLoadingEnvMap=!1,E.envMap=C,p.material.handleTextureEvents(x.el,C),E.needsUpdate=!0});return}g[S]=new Promise(function(C){p.srcLoader.validateCubemapSrc(S,function(L){A.load(L,function(B){x.isLoadingEnvMap=!1,E.envMap=B,p.material.handleTextureEvents(x.el,B),C(B)})})})}});function v(b,x){return x.color.set(b.color),x.emissive.set(b.emissive),x.emissiveIntensity=b.emissiveIntensity,x.fog=b.fog,x.metalness=b.metalness,x.roughness=b.roughness,x.wireframe=b.wireframe,x.wireframeLinewidth=b.wireframeLinewidth,b.normalMap&&(x.normalScale=b.normalScale),b.ambientOcclusionMap&&(x.aoMapIntensity=b.ambientOcclusionMapIntensity),b.displacementMap&&(x.displacementScale=b.displacementScale,x.displacementBias=b.displacementBias),x}},"./src/systems/camera.js":(c,u,h)=>{var d=h("./src/constants/index.js"),f=h("./src/core/system.js").registerSystem,p="data-aframe-default-camera";c.exports.System=f("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var g,v,b=this.sceneEl,x=this;if(b.camera&&!b.camera.el.getAttribute("camera").spectator){b.emit("cameraready",{cameraEl:b.camera.el});return}if(g=b.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!g.length){this.createDefaultCamera();return}for(this.numUserCameras=g.length,v=0;v<g.length;v++)g[v].addEventListener("object3dset",function(E){E.detail.type==="camera"&&x.checkUserCamera(this)}),g[v].isNode?g[v].load():g[v].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(g){var v,b=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(v=g.getAttribute("camera"),!v.active||v.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,b.camera=g.getObject3D("camera"),b.emit("cameraready",{cameraEl:g})}},createDefaultCamera:function(){var g,v=this.sceneEl;g=document.createElement("a-entity"),g.setAttribute("camera",{active:!0}),g.setAttribute("position",{x:0,y:d.DEFAULT_CAMERA_HEIGHT,z:0}),g.setAttribute("wasd-controls",""),g.setAttribute("look-controls",""),g.setAttribute(d.AFRAME_INJECTED,""),g.addEventListener("object3dset",function(b){b.detail.type==="camera"&&(v.camera=b.detail.object,v.emit("cameraready",{cameraEl:g}))}),v.appendChild(g)},disableActiveCamera:function(){var g,v;g=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),v=g[g.length-1],v.setAttribute("camera","active",!0)},setActiveCamera:function(g){var v,b,x,E,S=this.activeCameraEl,M=this.sceneEl;if(E=g.getObject3D("camera"),!(!E||g===this.activeCameraEl)){var C=M.querySelector("["+p+"]"),T=C&&C.querySelector(":not(a-mixin)[camera]");for(g!==T&&A(M),this.activeCameraEl=g,this.activeCameraEl.play(),M.camera=E,S&&S.setAttribute("camera","active",!1),b=M.querySelectorAll(":not(a-mixin)[camera]"),x=0;x<b.length;x++)v=b[x],!(!v.isEntity||g===v)&&(v.setAttribute("camera","active",!1),v.pause());M.emit("camera-set-active",{cameraEl:g})}},setSpectatorCamera:function(g){var v,b=this.spectatorCameraEl,x=this.sceneEl,E;v=g.getObject3D("camera"),!(!v||g===this.spectatorCameraEl)&&(b&&b.setAttribute("camera","spectator",!1),E=this.spectatorCameraEl=g,x.addEventListener("enter-vr",this.wrapRender),x.addEventListener("exit-vr",this.unwrapRender),E.setAttribute("camera","active",!1),E.play(),x.emit("camera-set-spectator",{cameraEl:g}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(g,v){var b,x=this.sceneEl,E;b=x.renderer.xr.enabled,this.originalRender.call(x.renderer,g,v),!(!this.spectatorCameraEl||x.isMobile||!b)&&(E=this.spectatorCameraEl.components.camera.camera,x.renderer.xr.enabled=!1,this.originalRender.call(x.renderer,g,E),x.renderer.xr.enabled=b)}});function A(g){var v,b=g.camera;b&&(v=g.querySelector("["+p+"]"),v&&g.removeChild(v))}},"./src/systems/geometry.js":(c,u,h)=>{var d=h("./src/core/geometry.js").geometries,f=h("./src/core/system.js").registerSystem;c.exports.System=f("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(v){var b=this.cache,x,E;return v.skipCache?p(v):(E=this.hash(v),x=b[E],g(this.cacheCount,E),x||(x=p(v),b[E]=x,x))},unuseGeometry:function(v){var b=this.cache,x=this.cacheCount,E,S;v.skipCache||(S=this.hash(v),b[S]&&(A(x,S),!(x[S]>0)&&(E=b[S],E.dispose(),delete b[S],delete x[S])))},hash:function(v){return JSON.stringify(v)}});function p(v){var b=v.primitive,x=d[b]&&d[b].Geometry,E=new x;if(!x)throw new Error("Unknown geometry `"+b+"`");return E.init(v),E.geometry}function A(v,b){v[b]--}function g(v,b){v[b]=v[b]===void 0?1:v[b]+1}},"./src/systems/gltf-model.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/lib/three.js");function p(A){return new Promise(function(g,v){var b=document.createElement("script");document.body.appendChild(b),b.onload=g,b.onerror=v,b.async=!0,b.src=A})}c.exports.System=d("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var A=this.data.dracoDecoderPath,g=this.data.basisTranscoderPath,v=this.data.meshoptDecoderPath;!this.dracoLoader&&A&&(this.dracoLoader=new f.DRACOLoader,this.dracoLoader.setDecoderPath(A)),!this.ktx2Loader&&g&&(this.ktx2Loader=new f.KTX2Loader,this.ktx2Loader.setTranscoderPath(g).detectSupport(this.el.renderer)),!this.meshoptDecoder&&v&&(this.meshoptDecoder=p(v).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(c,u,h)=>{h("./src/systems/camera.js"),h("./src/systems/geometry.js"),h("./src/systems/gltf-model.js"),h("./src/systems/light.js"),h("./src/systems/material.js"),h("./src/systems/obb-collider.js"),h("./src/systems/renderer.js"),h("./src/systems/shadow.js"),h("./src/systems/tracked-controls-webvr.js"),h("./src/systems/tracked-controls-webxr.js"),h("./src/systems/webxr.js")},"./src/systems/light.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/utils/bind.js"),p=h("./src/constants/index.js"),A="data-aframe-default-light";c.exports.System=d("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",f(this.setupDefaultLights,this))},registerLight:function(g){g.hasAttribute(A)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var g,v=this.sceneEl;if(this.defaultLights){g=document.querySelectorAll("["+A+"]");for(var b=0;b<g.length;b++)v.removeChild(g[b]);this.defaultLights=!1}},setupDefaultLights:function(){var g=this.sceneEl,v,b;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(v=document.createElement("a-entity"),v.setAttribute("light",{color:"#BBB",type:"ambient"}),v.setAttribute(A,""),v.setAttribute(p.AFRAME_INJECTED,""),g.appendChild(v),b=document.createElement("a-entity"),b.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),b.setAttribute("position",{x:-.5,y:1,z:1}),b.setAttribute(A,""),b.setAttribute(p.AFRAME_INJECTED,""),g.appendChild(b),this.defaultLights=!0)}})},"./src/systems/material.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/lib/three.js"),p=h("./src/utils/index.js"),A=h("./src/utils/material.js").isHLS,g=h("./src/utils/material.js").setTextureProperties,v=p.bind,b=p.debug,x=b("components:texture:error"),E=new f.TextureLoader,S=b("components:texture:warn");E.setCrossOrigin("anonymous"),c.exports.System=d("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",v(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(B,F,D){var P=this;if(B.tagName==="CANVAS"){this.loadCanvas(B,F,D);return}if(B.tagName==="VIDEO"){!B.src&&!B.srcObject&&!B.childElementCount&&S("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(B,F,D);return}p.srcLoader.validateSrc(B,U,K);function U(J){P.loadImage(J,F,D)}function K(J){P.loadVideo(J,F,D)}},loadImage:function(B,F,D){var P=this.hash(F),U=this.textureCache;if(U[P]){U[P].then(D);return}U[P]=C(B,F),U[P].then(D)},loadCanvas:function(B,F,D){var P;P=new f.CanvasTexture(B),g(P,F),D(P)},loadVideo:function(B,F,D){var P,U,K=this.textureCache,J,z;function j(G){G.texture.needsUpdate=!0,D(G.texture,G.videoEl)}if(typeof B!="string"){if(J=B,P=this.hashVideo(F,J),K[P]){K[P].then(j);return}L(J)}if(J=J||T(B,F.width,F.height),P=this.hashVideo(F,J),K[P]){K[P].then(j);return}U=new f.VideoTexture(J),U.minFilter=f.LinearFilter,g(U,F),this.sceneEl.isIOS&&A(J.src||J.getAttribute("src"),J.type||J.getAttribute("type"))&&(U.format=f.RGBAFormat,U.needsCorrectionBGRA=!0,U.flipY=!1,U.needsCorrectionFlipY=!0),z={texture:U,videoEl:J},K[P]=Promise.resolve(z),j(z)},hash:function(B){return B.src.tagName&&(B=p.extendDeep({},B),B.src=B.src.src),JSON.stringify(B)},hashVideo:function(B,F){return M(B,F)},registerMaterial:function(B){this.materials[B.uuid]=B},unregisterMaterial:function(B){delete this.materials[B.uuid];var F=this.textureCounts;Object.keys(B).filter(function(D){return B[D]&&B[D].isTexture}).forEach(function(D){F[B[D].uuid]--,F[B[D].uuid]<=0&&B[D].dispose()})},updateMaterials:function(B){var F=this.materials;Object.keys(F).forEach(function(D){F[D].needsUpdate=!0})},onMaterialTextureLoaded:function(B){this.textureCounts[B.detail.texture.uuid]||(this.textureCounts[B.detail.texture.uuid]=0),this.textureCounts[B.detail.texture.uuid]++}});function M(B,F){var D,P=F.getAttribute("id"),U,K;if(P)return P;for(U="",K=B||{},D=0;D<F.attributes.length;D++)K[F.attributes[D].name]=F.attributes[D].value;return Object.keys(K).sort().forEach(function(J){U+=J+":"+K[J]+";"}),U}function C(B,F){return new Promise(D);function D(P,U){var K=typeof B!="string";function J(z){g(z,F),z.needsUpdate=!0,P(z)}if(K){J(new f.Texture(B));return}E.load(B,J,function(){},function(z){x("`$s` could not be fetched (Error code: %s; Response: %s)",z.status,z.statusText)})}}function T(B,F,D){var P=document.createElement("video");return P.width=F,P.height=D,P.setAttribute("playsinline",""),P.setAttribute("webkit-playsinline",""),P.autoplay=!0,P.loop=!0,P.crossOrigin="anonymous",P.addEventListener("error",function(){S("`$s` is not a valid video",B)},!0),P.src=B,P}function L(B){return B.autoplay=B.hasAttribute("autoplay")&&B.getAttribute("autoplay")!=="false",B.controls=B.hasAttribute("controls")&&B.getAttribute("controls")!=="false",B.getAttribute("loop")==="false"&&B.removeAttribute("loop"),B.getAttribute("preload")==="false"&&(B.preload="none"),B.crossOrigin=B.crossOrigin||"anonymous",B.setAttribute("playsinline",""),B.setAttribute("webkit-playsinline",""),B}},"./src/systems/obb-collider.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem;d("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(f){this.colliderEls.push(f),this.data.showColliders?f.components["obb-collider"].showCollider():f.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(f){var p=this.colliderEls,A=p.indexOf(f);f.hideCollider(),A>-1&&p.splice(A,1),p.length===0&&(this.tick=void 0)},registerCollision:function(f,p){var A=this.collisions,g=!1,v=f.obb,b=p.obb,x=f.renderColliderMesh,E=p.renderColliderMesh;x&&x.material.color.set(16711680),E&&E.material.color.set(16711680);for(var S=0;S<A.length;S++)if(A[S].componentA.obb===v&&A[S].componentB.obb===b||A[S].componentA.obb===b&&A[S].componentB.obb===v){g=!0,A[S].detected=!0;break}g||(A.push({componentA:f,componentB:p,detected:!0}),f.el.emit("obbcollisionstarted",{trackedObject3D:f.trackedObject3D,withEl:p.el}),p.el.emit("obbcollisionstarted",{trackedObject3D:p.trackedObject3D,withEl:f.el}))},resetCollisions:function(){for(var f=this.collisions,p=0;p<f.length;p++)f[p].detected=!1},clearCollisions:function(){for(var f=this.collisions,p=[],A,g,v,b,x=0;x<f.length;x++)f[x].detected?p.push(f[x]):(A=f[x].componentA,g=f[x].componentB,v=A.renderColliderMesh,b=g.renderColliderMesh,v&&v.material.color.set(65280),A.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:g.el}),b&&b.material.color.set(65280),g.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:A.el}));this.collisions=p},detectCollisions:function(){var f,p,A,g,v=this.colliderEls;if(!(v.length<2)){this.resetCollisions();for(var b=0;b<v.length;b++)if(A=v[b].components["obb-collider"],f=v[b].components["obb-collider"].obb,!(f.halfSize.x===0||f.halfSize.y===0||f.halfSize.z===0))for(var x=b+1;x<v.length;x++)g=v[x].components["obb-collider"],p=g.obb,!(p.halfSize.x===0||p.halfSize.y===0||p.halfSize.z===0)&&f.intersectsOBB(p)&&this.registerCollision(A,g);this.clearCollisions()}}})},"./src/systems/renderer.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/utils/index.js"),p=h("./src/lib/three.js"),A=f.debug,g=A("components:renderer:warn");c.exports.System=d("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:f.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},foveationLevel:{default:1}},init:function(){var E=this.data,S=this.el,M=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),C=S.renderer;C.useLegacyLights=!E.physicallyCorrectLights,C.toneMapping=p[M+"ToneMapping"],p.Texture.DEFAULT_ANISOTROPY=E.anisotropy,p.ColorManagement.enabled=E.colorManagement,C.outputColorSpace=E.colorManagement?p.SRGBColorSpace:p.LinearSRGBColorSpace,S.hasAttribute("antialias")&&g('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),S.hasAttribute("logarithmicDepthBuffer")&&g('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),C.sortObjects=!0,C.setOpaqueSort(v)},update:function(){var E=this.data,S=this.el,M=S.renderer,C=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);M.toneMapping=p[C+"ToneMapping"],M.toneMappingExposure=E.exposure,M.xr.setFoveation(E.foveationLevel),E.sortObjects&&g('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),E.sortTransparentObjects?M.setTransparentSort(x):M.setTransparentSort(b)},applyColorCorrection:function(E){!this.data.colorManagement||!E||E.isTexture&&(E.colorSpace=p.SRGBColorSpace)},setWebXRFrameRate:function(E){var S=this.data,M=E.supportedFrameRates;if(M&&E.updateTargetFrameRate){var C;M.includes(90)?C=S.highRefreshRate?90:72:C=S.highRefreshRate?72:60,E.updateTargetFrameRate(C).catch(function(T){console.warn("failed to set target frame rate of "+C+". Error info: "+T)})}}});function v(E,S){return E.groupOrder!==S.groupOrder?E.groupOrder-S.groupOrder:E.renderOrder!==S.renderOrder?E.renderOrder-S.renderOrder:E.z-S.z}function b(E,S){return E.groupOrder!==S.groupOrder?E.groupOrder-S.groupOrder:E.renderOrder-S.renderOrder}function x(E,S){return E.groupOrder!==S.groupOrder?E.groupOrder-S.groupOrder:E.renderOrder!==S.renderOrder?E.renderOrder-S.renderOrder:S.z-E.z}c.exports.sortFrontToBack=v,c.exports.sortRenderOrderOnly=b,c.exports.sortBackToFront=x},"./src/systems/shadow.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/lib/three.js"),p={basic:f.BasicShadowMap,pcf:f.PCFShadowMap,pcfsoft:f.PCFSoftShadowMap};c.exports.System=d("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var A=this.sceneEl,g=this.data;this.shadowMapEnabled=!1,A.renderer&&(A.renderer.shadowMap.type=p[g.type],A.renderer.shadowMap.autoUpdate=g.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(A){A.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(A){var g=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&A,g&&(g.shadowMap.enabled=this.shadowMapEnabled)}})},"./src/systems/tracked-controls-webvr.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/utils/index.js"),p=f.device.isWebXRAvailable;c.exports.System=d("tracked-controls-webvr",{init:function(){var A=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=f.throttle(this.updateControllerList,500,this),!p&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(g){g.length&&(A.vrDisplay=g[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var A=this.controllers,g,v,b,x;if(v=navigator.getGamepads&&navigator.getGamepads(),!!v){for(x=A.length,A.length=0,b=0;b<v.length;++b)g=v[b],g&&g.pose&&A.push(g);A.length!==x&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/utils/index.js");c.exports.System=d("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=f.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var p=this,A=this.el.xrSession;if(!A){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var g=p.el.sceneEl.systems.webxr.sessionReferenceSpaceType;A.requestReferenceSpace(g).then(function(v){p.referenceSpace=v}).catch(function(v){throw p.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(g,'tracked-controls-webxr uses reference space "'+g+'".'),v})},updateControllerList:function(){var p=this.el.xrSession,A=this.oldControllers,g;if(!p){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(p.inputSources){if(this.controllers=p.inputSources,this.oldControllersLength===this.controllers.length){var v=!0;for(g=0;g<this.controllers.length;++g)if(!(this.controllers[g]===A[g]&&this.controllers[g].gamepad===A[g].gamepad)){v=!1;break}if(v)return}for(A.length=0,g=0;g<this.controllers.length;g++)A.push(this.controllers[g]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(c,u,h)=>{var d=h("./src/core/system.js").registerSystem,f=h("./src/utils/index.js"),p=f.debug("systems:webxr:warn");c.exports.System=d("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var A=this.data;this.sessionConfiguration={requiredFeatures:A.requiredFeatures,optionalFeatures:A.optionalFeatures},this.sessionReferenceSpaceType=A.referenceSpaceType,A.overlayElement&&(A.overlayElement.classList.remove("a-dom-overlay"),A.optionalFeatures.includes("dom-overlay")||(A.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",A)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:A.overlayElement},A.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(A){return!!(A==="viewer"||A==="local"||this.sessionConfiguration.requiredFeatures.includes(A)||this.sessionConfiguration.optionalFeatures.includes(A))},warnIfFeatureNotRequested:function(A,g){if(!this.wasFeatureRequested(A)){var v='Please add the feature "'+A+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;p((g?g+" ":"")+v)}}})},"./src/utils/bind.js":c=>{c.exports=function(h,d){return function(f){return function(){var A=f.concat(Array.prototype.slice.call(arguments,0));return h.apply(d,A)}}(Array.prototype.slice.call(arguments,2))}},"./src/utils/coordinates.js":(c,u,h)=>{var d=h("./src/utils/debug.js"),f=h("./node_modules/object-assign/index.js"),p=d("utils:coordinates:warn"),A=["x","y","z","w"],g=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;c.exports.regex=g;var v=/\s+/g;function b(M,C){var T,L,B,F,D,P,U,K,J;if(M&&M instanceof Object)return P=M.x===void 0?C&&C.x:M.x,U=M.y===void 0?C&&C.y:M.y,K=M.z===void 0?C&&C.z:M.z,J=M.w===void 0?C&&C.w:M.w,P!=null&&(M.x=S(P)),U!=null&&(M.y=S(U)),K!=null&&(M.z=S(K)),J!=null&&(M.w=S(J)),M;if(M==null)return typeof C=="object"?f({},C):C;for(T=M.trim().split(v),D={},F=0;F<A.length;F++)if(B=A[F],T[F])D[B]=parseFloat(T[F],10);else{if(L=C&&C[B],L===void 0)continue;D[B]=S(L)}return D}c.exports.parse=b;function x(M){var C;return typeof M!="object"?M:(C=M.x+" "+M.y,M.z!=null&&(C+=" "+M.z),M.w!=null&&(C+=" "+M.w),C)}c.exports.stringify=x;function E(M){return g.test(M)}c.exports.isCoordinates=E,c.exports.isCoordinate=function(M){return p("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),E(M)};function S(M){return M!=null&&M.constructor===String?parseFloat(M,10):M}c.exports.toVector3=function(M){return new THREE.Vector3(M.x,M.y,M.z)}},"./src/utils/debug.js":(c,u,h)=>{var d=h("./node_modules/process/browser.js"),f=h("./node_modules/debug/browser.js"),p=h("./node_modules/object-assign/index.js"),A={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},g=function(S){var M=f(S);return M.color=b(S),M};p(g,f);function v(S){var M=S.split(":");return M[M.length-1]}function b(S){var M=v(S),C=A.colors&&A.colors[M];return C||null}function x(){try{return window.localStorage}catch{}}var E=x();E&&(parseInt(E.logs,10)||E.logs==="true")?g.enable("*"):g.enable("*:error,*:info,*:warn"),d.browser&&(window.logs=g),c.exports=g},"./src/utils/device.js":(c,u,h)=>{var d=h("./node_modules/process/browser.js"),f=h("./node_modules/debug/browser.js")("device:error"),p,A=!1,g=!1,v=c.exports.isWebXRAvailable=!window.debug&&navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(J){var z;v||(z=document.createElement("canvas"),p=J.display,z.getContext("webgl",{}),p.requestPresent([{source:z}]).then(function(){},function(){}))}),v){var b=function(){var J=document.querySelector("a-scene");if(!J){window.addEventListener("DOMContentLoaded",b);return}J.hasLoaded?J.components["xr-mode-ui"].updateEnterInterfaces():J.addEventListener("loaded",b)},x=function(J){f("WebXR session support error: "+J.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(J){A=J,b()}).catch(x),navigator.xr.isSessionSupported("immersive-ar").then(function(J){g=J,b()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){A=!0,b()}).catch(x),navigator.xr.supportsSession("immersive-ar").then(function(){g=!0,b()}).catch(function(){})):f("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(J){var z=document.querySelector("a-scene");p=J.length&&J[0],z&&z.emit("displayconnected",{vrDisplay:p})});function E(){return p}c.exports.getVRDisplay=E;function S(){return A||g||!!E()}c.exports.checkHeadsetConnected=S;function M(){return g}c.exports.checkARSupport=M;function C(){return A}c.exports.checkVRSupport=C;var T=function(){var J=!1;return function(z){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(z)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(z.substr(0,4)))&&(J=!0),(B()||L()||K())&&(J=!0),U()&&(J=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return J}}();c.exports.isMobile=T;function L(J){var z=J||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(z)}c.exports.isTablet=L;function B(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}c.exports.isIOS=B;function F(){return!T()&&!U()&&window.orientation!==void 0}c.exports.isMobileDeviceRequestingDesktopSite=F;function D(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}c.exports.isOculusBrowser=D;function P(){return/(Mobile VR)/i.test(window.navigator.userAgent)}c.exports.isFirefoxReality=P;function U(){return D()||P()}c.exports.isMobileVR=U;function K(){return/R7 Build/.test(window.navigator.userAgent)}c.exports.isR7=K,c.exports.isLandscape=function(){var J=window.orientation;return K()&&(J+=90),J===90||J===-90},c.exports.isBrowserEnvironment=!!(!d||d.browser),c.exports.isNodeEnvironment=!c.exports.isBrowserEnvironment},"./src/utils/entity.js":c=>{var u={};function h(d,f){return f=f||".",u[f]||(u[f]={}),d.indexOf(f)!==-1?u[f][d]=d.split(f):u[f][d]=d,u[f][d]}c.exports.getComponentPropertyPath=h,c.exports.propertyPathCache=u,c.exports.getComponentProperty=function(d,f,p){var A;return p=p||".",f.indexOf(p)!==-1?(A=h(f,p),A.constructor===String?d.getAttribute(A):d.getAttribute(A[0])[A[1]]):d.getAttribute(f)},c.exports.setComponentProperty=function(d,f,p,A){var g;if(A=A||".",f.indexOf(A)!==-1){g=h(f,A),g.constructor===String?d.setAttribute(g,p):d.setAttribute(g[0],g[1],p);return}d.setAttribute(f,p)}},"./src/utils/forceCanvasResizeSafariMobile.js":c=>{c.exports=function(h){var d=h.style.width,f=h.style.height;h.style.width=parseInt(d,10)+1+"px",h.style.height=parseInt(f,10)+1+"px",setTimeout(function(){h.style.width=d,h.style.height=f},200)}},"./src/utils/index.js":(c,u,h)=>{var d=h("./src/utils/debug.js"),f=h("./node_modules/deep-assign/index.js"),p=h("./src/utils/device.js"),A=h("./node_modules/object-assign/index.js"),g=h("./src/utils/object-pool.js"),v=d("utils:warn");c.exports.bind=h("./src/utils/bind.js"),c.exports.coordinates=h("./src/utils/coordinates.js"),c.exports.debug=d,c.exports.device=p,c.exports.entity=h("./src/utils/entity.js"),c.exports.forceCanvasResizeSafariMobile=h("./src/utils/forceCanvasResizeSafariMobile.js"),c.exports.isIE11=h("./src/utils/is-ie11.js"),c.exports.material=h("./src/utils/material.js"),c.exports.objectPool=g,c.exports.split=h("./src/utils/split.js").split,c.exports.styleParser=h("./src/utils/styleParser.js"),c.exports.trackedControls=h("./src/utils/tracked-controls.js"),c.exports.checkHeadsetConnected=function(){return v("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),p.checkHeadsetConnected(arguments)},c.exports.isGearVR=c.exports.device.isGearVR=function(){v("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},c.exports.isIOS=function(){return v("`utils.isIOS` has moved to `utils.device.isIOS`"),p.isIOS(arguments)},c.exports.isOculusGo=c.exports.device.isOculusGo=function(){v("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},c.exports.isMobile=function(){return v("`utils.isMobile has moved to `utils.device.isMobile`"),p.isMobile(arguments)},c.exports.throttle=function(x,E,S){var M;return S&&(x=c.exports.bind(x,S)),function(){var C=Date.now(),T=typeof M>"u"?E:C-M;(typeof M>"u"||T>=E)&&(M=C,x.apply(null,arguments))}},c.exports.throttleLeadingAndTrailing=function(x,E,S){var M,C;return S&&(x=c.exports.bind(x,S)),function(){var T=Date.now(),L=typeof M>"u"?E:T-M,B=arguments;typeof M>"u"||L>=E?(clearTimeout(C),M=T,x.apply(null,B)):(clearTimeout(C),C=setTimeout(function(){M=Date.now(),x.apply(this,B)},E-L))}},c.exports.throttleTick=function(x,E,S){var M;return S&&(x=c.exports.bind(x,S)),function(C,T){var L=typeof M>"u"?T:C-M;(typeof M>"u"||L>=E)&&(M=C,x(C,L))}},c.exports.debounce=function(x,E,S){var M;return function(){var C=this,T=arguments,L=function(){M=null,S||x.apply(C,T)},B=S&&!M;clearTimeout(M),M=setTimeout(L,E),B&&x.apply(C,T)}},c.exports.extend=A,c.exports.extendDeep=f,c.exports.clone=function(x){return JSON.parse(JSON.stringify(x))};var b=function(){var x=g.createPool(function(){return[]});return function(E,S){var M,C,T,L,B,F;if(E===void 0||S===void 0||E===null||S===null||!(E&&S&&E.constructor===Object&&S.constructor===Object||E.constructor===Array&&S.constructor===Array))return E===S;C=x.use(),T=x.use(),C.length=0,T.length=0;for(M in E)C.push(M);for(M in S)T.push(M);if(C.length!==T.length)return x.recycle(C),x.recycle(T),!1;for(L=0;L<C.length;++L)if(B=E[C[L]],F=S[C[L]],typeof B=="object"||typeof F=="object"||Array.isArray(B)&&Array.isArray(F)){if(B===F)continue;if(!b(B,F))return x.recycle(C),x.recycle(T),!1}else if(B!==F)return x.recycle(C),x.recycle(T),!1;return x.recycle(C),x.recycle(T),!0}}();c.exports.deepEqual=b,c.exports.diff=function(){var x=[];return function(E,S,M){var C,T,L,B,F,D,P;B=M||{},x.length=0;for(F in E)x.push(F);if(!S)return B;for(L in S)x.indexOf(L)===-1&&x.push(L);for(D=0;D<x.length;D++)F=x[D],C=E[F],T=S[F],P=C&&T&&C.constructor===Object&&T.constructor===Object,(P&&!b(C,T)||!P&&C!==T)&&(B[F]=T);return B}}(),c.exports.shouldCaptureKeyEvent=function(x){return x.metaKey?!1:document.activeElement===document.body},c.exports.splitString=function(x,E){typeof E>"u"&&(E=" ");var S=new RegExp(E,"g");return x=(x||"").replace(S,E),x.split(E)},c.exports.getElData=function(x,E){E=E||{};var S={};Object.keys(E).forEach(M);function M(C){x.hasAttribute(C)&&(S[C]=x.getAttribute(C))}return S},c.exports.getUrlParameter=function(x){x=x.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var E=new RegExp("[\\?&]"+x+"=([^&#]*)"),S=E.exec(location.search);return S===null?"":decodeURIComponent(S[1].replace(/\+/g," "))},c.exports.isIframed=function(){return window.top!==window.self},c.exports.findAllScenes=function(x){for(var E=[],S=x.getElementsByTagName("*"),M=0,C=S.length;M<C;M++)S[M].isScene&&E.push(S[M]);return E},c.exports.srcLoader=h("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/is-ie11.js":c=>{function u(){var h=-1,d=navigator.userAgent,f;return navigator.appName==="Microsoft Internet Explorer"?(f=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),f.exec(d)!=null&&(h=parseFloat(RegExp.$1))):navigator.appName==="Netscape"&&(f=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),f.exec(d)!=null&&(h=parseFloat(RegExp.$1))),h}c.exports=u()===11},"./src/utils/isIOSOlderThan10.js":c=>{c.exports=function(h){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(h)}},"./src/utils/material.js":(c,u,h)=>{var d=h("./src/lib/three.js"),f=["application/x-mpegurl","application/vnd.apple.mpegurl"],p=new Set(["emissiveMap","envMap","map","specularMap"]);function A(v,b){var x=b.offset||{x:0,y:0},E=b.repeat||{x:1,y:1},S=b.npot||!1,M=b.anisotropy||0;S&&(v.wrapS=d.ClampToEdgeWrapping,v.wrapT=d.ClampToEdgeWrapping,v.magFilter=d.LinearFilter,v.minFilter=d.LinearFilter),(E.x!==1||E.y!==1)&&(v.wrapS=d.RepeatWrapping,v.wrapT=d.RepeatWrapping,v.repeat.set(E.x,E.y)),(x.x!==0||x.y!==0)&&v.offset.set(x.x,x.y),M!==0&&(v.anisotropy=M)}c.exports.setTextureProperties=A,c.exports.updateMapMaterialFromData=function(v,b,x,E){var S=x.el,M=x.material,C=S.sceneEl.systems.renderer,T=E[b];if(x.materialSrcs||(x.materialSrcs={}),!T){delete x.materialSrcs[v],B(null);return}if(T===x.materialSrcs[v]&&M[v]){A(M[v],E);return}x.materialSrcs[v]=T,T instanceof d.Texture?B(T):S.sceneEl.systems.material.loadTexture(T,{src:T,repeat:E.repeat,offset:E.offset,npot:E.npot,anisotropy:E.anisotropy},L);function L(F){x.materialSrcs[v]===T&&B(F)}function B(F){M[v]=F,F&&p.has(v)&&C.applyColorCorrection(F),M.needsUpdate=!0,g(S,F)}},c.exports.updateMap=function(v,b){return c.exports.updateMapMaterialFromData("map","src",v,b)},c.exports.updateDistortionMap=function(v,b,x){var E=v;v==="ambientOcclusion"&&(E="ao");var S=b.el,M=b.material,C=S.sceneEl.systems.renderer,T=x[v+"Map"],L={};if(L.src=T,L.offset=x[v+"TextureOffset"],L.repeat=x[v+"TextureRepeat"],L.wrap=x[v+"TextureWrap"],T){if(T===b[v+"TextureSrc"])return;b[v+"TextureSrc"]=T,S.sceneEl.systems.material.loadTexture(T,L,B);return}if(!M.map)return;B(null);function B(F){var D=E+"Map";M[D]=F,F&&p.has(D)&&C.applyColorCorrection(F),F&&A(F,x),M.needsUpdate=!0,g(S,F)}};function g(v,b){b&&(v.emit("materialtextureloaded",{src:b.image,texture:b}),!(!b.image||b.image.tagName!=="VIDEO")&&(b.image.addEventListener("loadeddata",function(){!v.components||!v.components.material||(b.needsCorrectionBGRA&&b.needsCorrectionFlipY&&["standard","flat"].indexOf(v.components.material.data.shader)!==-1&&v.setAttribute("material","shader","ios10hls"),v.emit("materialvideoloadeddata",{src:b.image,texture:b}))}),b.image.addEventListener("ended",function(){v.emit("materialvideoended",{src:b.image,texture:b})})))}c.exports.handleTextureEvents=g,c.exports.isHLS=function(v,b){return!!(b&&f.includes(b.toLowerCase())||v&&v.toLowerCase().indexOf(".m3u8")>0)}},"./src/utils/math.js":c=>{function u(d,f,p){var A=f.dot(d);return(A-f.dot(p))/f.length()}function h(d,f,p,A){var g=u(d,f,p);return A.copy(f),A.multiplyScalar(g),A.add(p),A}c.exports.distanceOfPointFromPlane=u,c.exports.nearestPointInPlane=h},"./src/utils/object-pool.js":c=>{var u=Object.freeze(Object.create(null));function h(){return{}}c.exports.createPool=function(A){var g=[],v=null;A=A||h;function b(){var M;return(v===null||v===g.length)&&E(g.length||5),M=g[v],g[v++]=u,d(M),M}function x(M){if(M instanceof Object){if(v===null||v===-1){g[g.length]=M;return}g[--v]=M}}function E(M){var C,T;if(M=M===void 0?g.length:M,M>0&&v==null&&(v=0),M>0)for(C=g.length,g.length+=Number(M),T=C;T<g.length;T++)g[T]=A();return g.length}function S(){return g.length}return{grow:E,pool:g,recycle:x,size:S,use:b}};function d(p){var A;if(!(!p||p.constructor!==Object))for(A in p)p[A]=void 0}c.exports.clearObject=d;function f(p,A){var g;if(!(!p||p.constructor!==Object))for(g in p)g in A||delete p[g]}c.exports.removeUnusedKeys=f},"./src/utils/split.js":c=>{c.exports.split=function(){var u={};return function(h,d){return d in u||(u[d]={}),h in u[d]||(u[d][h]=h.split(d)),u[d][h]}}()},"./src/utils/src-loader.js":(c,u,h)=>{var d=h("./src/utils/debug.js"),f=d("utils:src-loader:warn");function p(E,S,M){v(E,function(T){if(T){S(E);return}M(E)})}function A(E,S){var M,C="",T,L,B=[];for(T=0;T<5;T++)C+="(url\\((?:[^\\)]+)\\),\\s*)";C+="(url\\((?:[^\\)]+)\\)\\s*)",L=E.match(new RegExp(C));function F(D){B.push(D),B.length===6&&S(B)}if(L){for(T=1;T<7;T++)p(g(L[T]),F);return}if(M=x(E),!!M){if(M.tagName==="A-CUBEMAP"&&M.srcs)return S(M.srcs);f('Selector "%s" does not point to <a-cubemap>',E)}}function g(E){var S=E.match(/\url\((.+)\)/);if(S)return S[1]}function v(E,S){var M;if(E.tagName){S(E.tagName==="IMG");return}M=new XMLHttpRequest,M.open("HEAD",E),M.addEventListener("load",function(C){var T;M.status>=200&&M.status<300?(T=M.getResponseHeader("Content-Type"),T==null?b(E,S):T.startsWith("image")?S(!0):S(!1)):b(E,S),M.abort()}),M.send()}function b(E,S){var M=new Image;M.addEventListener("load",C);function C(){S(!0)}M.addEventListener("error",T);function T(){S(!1)}M.src=E}function x(E){try{var S=document.querySelector(E);return S||f('No element was found matching the selector: "%s"',E),S}catch{f('"%s" is not a valid selector',E);return}}c.exports={parseUrl:g,validateSrc:p,validateCubemapSrc:A}},"./src/utils/styleParser.js":c=>{var u=/-([a-z])/g;c.exports.parse=function(v,b){var x;return typeof v!="string"||(x=p(v,b),x[""])?v:d(x)},c.exports.stringify=function(v){return typeof v=="string"?v:A(v)};function h(v){return v.replace(u,g)}c.exports.toCamelCase=h;function d(v){var b,x;for(x in v)b=h(x),x!==b&&(v[b]=v[x],delete v[x]);return v}c.exports.transformKeysToCamelCase=d;var f=function(){var v=[],b=/url\([^)]+$/;return function(E){var S="",M,C=0,T=";";for(v.length=0;C<E.length;){if(M=E.indexOf(T,C),M===-1&&(M=E.length),S+=E.substring(C,M),b.test(S)){S+=";",C=M+1;continue}v.push(S.trim()),S="",C=M+1}return v}}();function p(v,b){var x,E,S,M,C,T;for(b=b||{},x=f(v),E=0;E<x.length;E++)S=x[E],S&&(M=S.indexOf(":"),C=S.substr(0,M).trim(),T=S.substr(M+1).trim(),b[C]=T);return b}function A(v){var b,x=0,E=0,S="";for(b in v)x++;for(b in v)S+=b+": "+v[b],E<x-1&&(S+="; "),E++;return S}function g(v){return v[1].toUpperCase()}},"./src/utils/tracked-controls.js":(c,u,h)=>{var d=h("./src/constants/index.js").DEFAULT_HANDEDNESS,f=["x","y","z","w"],p=2;c.exports.checkControllerPresentAndSetup=function(x,E,S){var M=x.el,C,T=M.sceneEl.hasWebXR,L=T?g:A,B;if(C=L(x,E,S),B=!!C,x.controllerPresent&&!x.controllerEventsActive&&!T&&x.addEventListeners(),B===x.controllerPresent)return B;x.controllerPresent=B,B?(x.addEventListeners(),x.injectTrackedControls(C),M.emit("controllerconnected",{name:x.name,component:x})):(x.removeEventListeners(),M.emit("controllerdisconnected",{name:x.name,component:x}))};function A(x,E,S){var M,C=x.el.sceneEl,T,L=S.index||0;return!E||(T=C&&C.systems["tracked-controls-webvr"],!T)||(M=T.controllers,!M.length)?!1:!!v(M,null,E,S.hand,L)}function g(x,E,S){var M,C=x.el.sceneEl,T=C&&C.systems["tracked-controls-webxr"];return!T||(M=T.controllers,!M||!M.length)?!1:b(M,E,S.hand,S.index,S.iterateControllerProfiles,S.handTracking)}c.exports.isControllerPresentWebVR=A,c.exports.isControllerPresentWebXR=g;function v(x,E,S,M,C){var T,L,B=0,F=C>=0?C:0;for(L=0;L<x.length;L++)if(T=x[L],!(S&&!T.id.startsWith(S))&&!(!S&&T.id!==E)&&!(M&&T.hand&&M!==T.hand)){if(M&&!T.hand)F=p*C+(M===d?0:1);else return T;if(B===F)return T;++B}}function b(x,E,S,M,C,T){var L,B,F,D=!1,P,U;for(L=0;L<x.length;L++){if(F=x[L],U=F.profiles,T)D=F.hand;else if(C)for(B=0;B<U.length&&(D=U[B].startsWith(E),!D);B++);else D=U.length>0&&U[0].startsWith(E);if(D){if(P=F.handedness==="right"||F.handedness==="left",P){if(F.handedness===S)return x[L]}else if(L===M)return x[L]}}}c.exports.findMatchingControllerWebVR=v,c.exports.findMatchingControllerWebXR=b,c.exports.emitIfAxesChanged=function(x,E,S){var M,C,T,L,B;for(C in E){for(M=E[C],T=!1,B=0;B<M.length;B++)S.detail.changed[M[B]]&&(T=!0);if(T){for(L={},B=0;B<M.length;B++)L[f[B]]=S.detail.axis[M[B]];x.el.emit(C+"moved",L)}}},c.exports.onButtonEvent=function(x,E,S,M){var C=M?S.mapping[M]:S.mapping,T=C.buttons[x];S.el.emit(T+E),S.updateModel&&S.updateModel(T,E)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(c){var u=this;this.object=c,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var h=function(p){u.deviceOrientation=p},d=function(){u.screenOrientation=window.orientation||0},f=function(){var p=new THREE.Vector3(0,0,1),A=new THREE.Euler,g=new THREE.Quaternion,v=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(b,x,E,S,M){A.set(E,x,-S,"YXZ"),b.setFromEuler(A),b.multiply(v),b.multiply(g.setFromAxisAngle(p,-M))}}();this.connect=function(){d(),window.addEventListener("orientationchange",d,!1),window.addEventListener("deviceorientation",h,!1),u.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",d,!1),window.removeEventListener("deviceorientation",h,!1),u.enabled=!1},this.update=function(){if(u.enabled!==!1){var p=u.deviceOrientation;if(p){var A=p.alpha?THREE.MathUtils.degToRad(p.alpha)+u.alphaOffset:0,g=p.beta?THREE.MathUtils.degToRad(p.beta):0,v=p.gamma?THREE.MathUtils.degToRad(p.gamma):0,b=u.screenOrientation?THREE.MathUtils.degToRad(u.screenOrientation):0;f(u.object.quaternion,A,g,v,b)}}},this.dispose=function(){u.disconnect()},this.connect()}},"./vendor/rStats.extras.js":c=>{window.glStats=function(){var u=null,h=0,d=0,f=0,p=0,A=0,g=0,v=0;function b(B,F){return function(){F.apply(this,arguments),B.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=b(WebGLRenderingContext.prototype.drawArrays,function(){h++,arguments[0]==this.POINTS?g+=arguments[2]:A+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=b(WebGLRenderingContext.prototype.drawElements,function(){d++,p+=arguments[1]/3,A+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=b(WebGLRenderingContext.prototype.useProgram,function(){f++}),WebGLRenderingContext.prototype.bindTexture=b(WebGLRenderingContext.prototype.bindTexture,function(){v++});var x={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},E=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],S=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function M(){u("allcalls").set(h+d),u("drawElements").set(d),u("drawArrays").set(h),u("bindTexture").set(v),u("useProgram").set(f),u("glfaces").set(p),u("glvertices").set(A),u("glpoints").set(g)}function C(){h=0,d=0,f=0,p=0,A=0,g=0,v=0}function T(){}function L(B){u=B}return{update:M,start:C,end:T,attach:L,values:x,groups:E,fractions:S}},window.threeStats=function(u){var h=null,d={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},f=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],p=[];function A(){h("renderer.info.memory.geometries").set(u.info.memory.geometries),h("renderer.info.programs").set(u.info.programs.length),h("renderer.info.memory.textures").set(u.info.memory.textures),h("renderer.info.render.calls").set(u.info.render.calls),h("renderer.info.render.triangles").set(u.info.render.triangles),h("renderer.info.render.points").set(u.info.render.points)}function g(){}function v(){}function b(x){h=x}return{update:A,start:g,end:v,attach:b,values:d,groups:f,fractions:p}},window.BrowserStats=function(){var u=null,h=0,d=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var f={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},p=[{caption:"Browser",values:["memory","total"]}],A=[{base:"total",steps:["memory"]}],g=Math.log(1024);function v(M){var C=100,T=Math.floor(Math.log(M)/g);return Math.round(M*C/Math.pow(1024,T))/C}function b(){h=v(performance.memory.usedJSHeapSize),d=v(performance.memory.totalJSHeapSize),u("memory").set(h),u("total").set(d)}function x(){h=0}function E(){}function S(M){u=M}return{update:b,start:x,end:E,attach:S,values:f,groups:p,fractions:A}},c.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":c=>{(function(){"performance"in window||(window.performance={});var u=window.performance;if(!("now"in u)){var h=Date.now();u.timing&&u.timing.navigationStart&&(h=u.timing.navigationStart),u.now=function(){return Date.now()-h}}u.mark||(u.mark=function(){}),u.measure||(u.measure=function(){})})(),window.rStats=function(h){function d(U,K){for(var J=Object.keys(U),z=0,j=J.length;z<j;z++)K(J[z])}function f(U){var K=document.createElement("link");K.href=U,K.rel="stylesheet",K.type="text/css",document.getElementsByTagName("head")[0].appendChild(K)}var p=h||{},A=p.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],g="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",v=(p.CSSPath?p.CSSPath:"")+"rStats.css",b=p.css||[g,v];b.forEach(function(U){f(U)}),p.values||(p.values={});var x,E,S=10,M=200,C={};function T(U,K,J){var z=J||{},j=document.createElement("canvas"),G=j.getContext("2d"),H=0,te=0,Z=z.color?z.color:"#666666",ee=document.createElement("canvas"),oe=ee.getContext("2d");ee.width=1,ee.height=2*S,oe.fillStyle="#444444",oe.fillRect(0,0,1,2*S),oe.fillStyle=Z,oe.fillRect(0,S,1,S),oe.fillStyle="#ffffff",oe.globalAlpha=.5,oe.fillRect(0,S,1,1),oe.globalAlpha=1;var xe=document.createElement("canvas"),Pe=xe.getContext("2d");xe.width=1,xe.height=2*S,Pe.fillStyle="#444444",Pe.fillRect(0,0,1,2*S),Pe.fillStyle="#b70000",Pe.fillRect(0,S,1,S),Pe.globalAlpha=.5,Pe.fillStyle="#ffffff",Pe.fillRect(0,S,1,1),Pe.globalAlpha=1;function me(){j.width=M,j.height=S,j.style.width=j.width+"px",j.style.height=j.height+"px",j.className="rs-canvas",U.appendChild(j),G.fillStyle="#444444",G.fillRect(0,0,j.width,j.height)}function Ce(Je,Oe){te+=(Je-te)*.1,H*=.99,te>H&&(H=te),G.drawImage(j,1,0,j.width-1,j.height,0,0,j.width-1,j.height),Oe?G.drawImage(xe,j.width-1,j.height-te*j.height/H-S):G.drawImage(ee,j.width-1,j.height-te*j.height/H-S)}return me(),{draw:Ce}}function L(U,K){var J=document.createElement("canvas"),z=J.getContext("2d");function j(){J.width=M,J.height=S*K,J.style.width=J.width+"px",J.style.height=J.height+"px",J.className="rs-canvas",U.appendChild(J),z.fillStyle="#444444",z.fillRect(0,0,J.width,J.height)}function G(H){z.drawImage(J,1,0,J.width-1,J.height,0,0,J.width-1,J.height);var te=0;d(H,function(Z){var ee=H[Z]*J.height;z.fillStyle=A[Z],z.fillRect(J.width-1,te,1,ee),te+=ee})}return j(),{draw:G}}function B(U,K){var J=U,z,j=0,G=0,H=0,te=0,Z=performance.now(),ee=0,oe=document.createElement("div"),xe=document.createElement("span"),Pe=document.createElement("div"),me=document.createTextNode(""),Ce=p?p.values[J.toLowerCase()]:null,Je=new T(oe,J,Ce),Oe=!1;xe.className="rs-counter-id",xe.textContent=Ce&&Ce.caption?Ce.caption:J,Pe.className="rs-counter-value",Pe.appendChild(me),oe.appendChild(xe),oe.appendChild(Pe),K?K.div.appendChild(oe):E.appendChild(oe),z=performance.now();function $e(Qt){if(Ce&&Ce.average){te+=Qt,ee++;var Xt=performance.now();Xt-Z>=(Ce.avgMs||1e3)&&(H=te/ee,te=0,Z=Xt,ee=0)}}function nt(){z=performance.now(),p.userTimingAPI&&performance.mark(J+"-start"),Oe=!0}function gt(){j=performance.now()-z,p.userTimingAPI&&(performance.mark(J+"-end"),Oe&&performance.measure(J,J+"-start",J+"-end")),$e(j)}function Tt(){gt(),nt()}function Ze(){var Qt=Ce&&Ce.average?H:j;me.nodeValue=Math.round(Qt*100)/100;var Xt=Ce&&(Ce.below&&j<Ce.below||Ce.over&&j>Ce.over);Je.draw(j,Xt),oe.className=Xt?"rs-counter-base alarm":"rs-counter-base"}function mn(){var Qt=performance.now(),Xt=Qt-z;G++,Xt>1e3&&(Ce&&Ce.interpolate===!1?j=G:j=G*1e3/Xt,G=0,z=Qt,$e(j))}function Ft(Qt){j=Qt,$e(j)}return{set:Ft,start:nt,tick:Tt,end:gt,frame:mn,value:function(){return j},draw:Ze}}function F(U){var K=U.toLowerCase();if(K===void 0&&(K="default"),C[K])return C[K];var J=null;p&&p.groups&&d(p.groups,function(j){var G=p.groups[parseInt(j,10)];!J&&G.values.indexOf(K.toLowerCase())!==-1&&(J=G)});var z=new B(K,J);return C[K]=z,z}function D(){if(p.plugins){p.values||(p.values={}),p.groups||(p.groups=[]),p.fractions||(p.fractions=[]);for(var U=0;U<p.plugins.length;U++)p.plugins[U].attach(F),d(p.plugins[U].values,function(K){p.values[K]=p.plugins[U].values[K]}),p.groups=p.groups.concat(p.plugins[U].groups),p.fractions=p.fractions.concat(p.plugins[U].fractions)}else p.plugins={};x=document.createElement("div"),x.className="rs-base",E=document.createElement("div"),E.className="rs-container",E.style.height="auto",x.appendChild(E),document.body.appendChild(x),p&&(p.groups&&d(p.groups,function(K){var J=p.groups[parseInt(K,10)],z=document.createElement("div");z.className="rs-group",J.div=z;var j=document.createElement("h1");j.textContent=J.caption,j.addEventListener("click",function(G){this.classList.toggle("hidden"),G.preventDefault()}.bind(z)),E.appendChild(j),E.appendChild(z)}),p.fractions&&d(p.fractions,function(K){var J=p.fractions[parseInt(K,10)],z=document.createElement("div");z.className="rs-fraction";var j=document.createElement("div");j.className="rs-legend";var G=0;d(p.fractions[K].steps,function(te){var Z=document.createElement("p");Z.textContent=p.fractions[K].steps[te],Z.style.color=A[G],j.appendChild(Z),G++}),z.appendChild(j),z.style.height=G*S+"px",J.div=z;var H=new L(z,G);J.graph=H,E.appendChild(z)}))}function P(){d(p.plugins,function(U){p.plugins[U].update()}),d(C,function(U){C[U].draw()}),p&&p.fractions&&d(p.fractions,function(U){var K=p.fractions[parseInt(U,10)],J=[],z=C[K.base.toLowerCase()];z&&(z=z.value(),d(p.fractions[U].steps,function(j){var G=p.fractions[U].steps[parseInt(j,10)].toLowerCase(),H=C[G];H&&J.push(H.value()/z)})),K.graph.draw(J)})}return D(),function(U){return U?F(U):{element:x,update:P}}},c.exports=window.rStats},"./vendor/starts-with-polyfill.js":()=>{String.prototype.startsWith||(String.prototype.startsWith=function(c,u){return u=u||0,this.substr(u,c.length)===c})},"./vendor/wakelock/util.js":c=>{var u={};u.base64=function(h,d){return"data:"+h+";base64,"+d},u.isMobile=function(){var h=!1;return function(d){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(d)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(d.substr(0,4)))&&(h=!0)}(navigator.userAgent||navigator.vendor||window.opera),h},u.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},u.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},u.appendQueryParameter=function(h,d,f){var p=h.indexOf("?")<0?"?":"&";return h+=p+d+"="+f,h},u.getQueryParameter=function(h){h=h.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d=new RegExp("[\\?&]"+h+"=([^&#]*)"),f=d.exec(location.search);return f===null?"":decodeURIComponent(f[1].replace(/\+/g," "))},u.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},c.exports=u},"./vendor/wakelock/wakelock.js":(c,u,h)=>{var d=h("./vendor/wakelock/util.js");function f(){var g=document.createElement("video");g.addEventListener("ended",function(){g.play()}),this.request=function(){g.paused&&(g.src=d.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),g.play())},this.release=function(){g.pause(),g.src=""}}function p(){var g=null;this.request=function(){g||(g=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){g&&(clearInterval(g),g=null)}}function A(){var g=navigator.userAgent||navigator.vendor||window.opera;return g.match(/iPhone/i)||g.match(/iPod/i)?p:f}c.exports=A()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(c,u,h)=>{h.r(u),h.d(u,{default:()=>P});var d=h("./node_modules/css-loader/dist/runtime/sourceMaps.js"),f=h.n(d),p=h("./node_modules/css-loader/dist/runtime/api.js"),A=h.n(p),g=h("./node_modules/css-loader/dist/runtime/getUrl.js"),v=h.n(g),b=new URL(h("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),h.b),x=new URL(h("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),h.b),E=new URL(h("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),h.b),S=new URL(h("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),h.b),M=new URL(h("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),h.b),C=A()(f()),T=v()(b),L=v()(x),B=v()(E),F=v()(S),D=v()(M);C.push([c.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(`+T+`) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(`+L+`) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(`+B+`);
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(`+F+`) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(`+D+`) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);const P=C},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(c,u,h)=>{h.r(u),h.d(u,{default:()=>v});var d=h("./node_modules/css-loader/dist/runtime/sourceMaps.js"),f=h.n(d),p=h("./node_modules/css-loader/dist/runtime/api.js"),A=h.n(p),g=A()(f());g.push([c.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);const v=g},"./src/style/aframe.css":(c,u,h)=>{h.r(u),h.d(u,{default:()=>B});var d=h("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),f=h.n(d),p=h("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),A=h.n(p),g=h("./node_modules/style-loader/dist/runtime/insertBySelector.js"),v=h.n(g),b=h("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),x=h.n(b),E=h("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),S=h.n(E),M=h("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),C=h.n(M),T=h("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),L={};L.styleTagTransform=C(),L.setAttributes=x(),L.insert=v().bind(null,"head"),L.domAPI=A(),L.insertStyleElement=S(),f()(T.default,L);const B=T.default&&T.default.locals?T.default.locals:void 0},"./src/style/rStats.css":(c,u,h)=>{h.r(u),h.d(u,{default:()=>B});var d=h("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),f=h.n(d),p=h("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),A=h.n(p),g=h("./node_modules/style-loader/dist/runtime/insertBySelector.js"),v=h.n(g),b=h("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),x=h.n(b),E=h("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),S=h.n(E),M=h("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),C=h.n(M),T=h("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),L={};L.styleTagTransform=C(),L.setAttributes=x(),L.insert=v().bind(null,"head"),L.domAPI=A(),L.insertStyleElement=S(),f()(T.default,L);const B=T.default&&T.default.locals?T.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":c=>{var u=[];function h(p){for(var A=-1,g=0;g<u.length;g++)if(u[g].identifier===p){A=g;break}return A}function d(p,A){for(var g={},v=[],b=0;b<p.length;b++){var x=p[b],E=A.base?x[0]+A.base:x[0],S=g[E]||0,M="".concat(E," ").concat(S);g[E]=S+1;var C=h(M),T={css:x[1],media:x[2],sourceMap:x[3],supports:x[4],layer:x[5]};if(C!==-1)u[C].references++,u[C].updater(T);else{var L=f(T,A);A.byIndex=b,u.splice(b,0,{identifier:M,updater:L,references:1})}v.push(M)}return v}function f(p,A){var g=A.domAPI(A);g.update(p);var v=function(x){if(x){if(x.css===p.css&&x.media===p.media&&x.sourceMap===p.sourceMap&&x.supports===p.supports&&x.layer===p.layer)return;g.update(p=x)}else g.remove()};return v}c.exports=function(p,A){A=A||{},p=p||[];var g=d(p,A);return function(b){b=b||[];for(var x=0;x<g.length;x++){var E=g[x],S=h(E);u[S].references--}for(var M=d(b,A),C=0;C<g.length;C++){var T=g[C],L=h(T);u[L].references===0&&(u[L].updater(),u.splice(L,1))}g=M}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":c=>{var u={};function h(f){if(typeof u[f]>"u"){var p=document.querySelector(f);if(window.HTMLIFrameElement&&p instanceof window.HTMLIFrameElement)try{p=p.contentDocument.head}catch{p=null}u[f]=p}return u[f]}function d(f,p){var A=h(f);if(!A)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");A.appendChild(p)}c.exports=d},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":c=>{function u(h){var d=document.createElement("style");return h.setAttributes(d,h.attributes),h.insert(d,h.options),d}c.exports=u},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(c,u,h)=>{function d(f){var p=h.nc;p&&f.setAttribute("nonce",p)}c.exports=d},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":c=>{function u(f,p,A){var g="";A.supports&&(g+="@supports (".concat(A.supports,") {")),A.media&&(g+="@media ".concat(A.media," {"));var v=typeof A.layer<"u";v&&(g+="@layer".concat(A.layer.length>0?" ".concat(A.layer):""," {")),g+=A.css,v&&(g+="}"),A.media&&(g+="}"),A.supports&&(g+="}");var b=A.sourceMap;b&&typeof btoa<"u"&&(g+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(b))))," */")),p.styleTagTransform(g,f,p.options)}function h(f){if(f.parentNode===null)return!1;f.parentNode.removeChild(f)}function d(f){if(typeof document>"u")return{update:function(){},remove:function(){}};var p=f.insertStyleElement(f);return{update:function(g){u(p,f,g)},remove:function(){h(p)}}}c.exports=d},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":c=>{function u(h,d){if(d.styleSheet)d.styleSheet.cssText=h;else{for(;d.firstChild;)d.removeChild(d.firstChild);d.appendChild(document.createTextNode(h))}}c.exports=u},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":c=>{c.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":c=>{c.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":c=>{c.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":c=>{c.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":c=>{c.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/super-three/build/three.module.js":(c,u,h)=>{h.r(u),h.d(u,{ACESFilmicToneMapping:()=>Ne,AddEquation:()=>z,AddOperation:()=>Vt,AdditiveAnimationBlendMode:()=>hr,AdditiveBlending:()=>P,AlphaFormat:()=>Le,AlwaysCompare:()=>Gm,AlwaysDepth:()=>Qt,AlwaysStencilFunc:()=>Mf,AmbientLight:()=>T2,AnimationAction:()=>j2,AnimationClip:()=>rp,AnimationLoader:()=>RN,AnimationMixer:()=>r5,AnimationObjectGroup:()=>n5,AnimationUtils:()=>MN,ArcCurve:()=>jM,ArrayCamera:()=>fx,ArrowHelper:()=>C5,AttachedBindMode:()=>De,Audio:()=>G2,AudioAnalyser:()=>QN,AudioContext:()=>Wx,AudioListener:()=>HN,AudioLoader:()=>zN,AxesHelper:()=>S5,BackSide:()=>T,BasicDepthPacking:()=>qo,BasicShadowMap:()=>x,Bone:()=>yx,BooleanKeyframeTrack:()=>bh,Box2:()=>d5,Box3:()=>er,Box3Helper:()=>w5,BoxGeometry:()=>fh,BoxHelper:()=>_5,BufferAttribute:()=>Sr,BufferGeometry:()=>Yi,BufferGeometryLoader:()=>P2,ByteType:()=>gn,Cache:()=>wh,Camera:()=>ug,CameraHelper:()=>b5,CanvasTexture:()=>qF,CapsuleGeometry:()=>Fg,CatmullRomCurve3:()=>WM,CineonToneMapping:()=>_e,CircleGeometry:()=>Ng,ClampToEdgeWrapping:()=>We,Clock:()=>U2,Color:()=>Hn,ColorKeyframeTrack:()=>kx,ColorManagement:()=>vr,CompressedArrayTexture:()=>XF,CompressedCubeTexture:()=>KF,CompressedTexture:()=>Lg,CompressedTextureLoader:()=>IN,ConeGeometry:()=>Ug,ConstantAlphaFactor:()=>Ze,ConstantColorFactor:()=>gt,CubeCamera:()=>Nw,CubeReflectionMapping:()=>Qe,CubeRefractionMapping:()=>ne,CubeTexture:()=>Uf,CubeTextureLoader:()=>BN,CubeUVReflectionMapping:()=>he,CubicBezierCurve:()=>Sx,CubicBezierCurve3:()=>XM,CubicInterpolant:()=>A2,CullFaceBack:()=>g,CullFaceFront:()=>v,CullFaceFrontBack:()=>b,CullFaceNone:()=>A,Curve:()=>pa,CurvePath:()=>qM,CustomBlending:()=>J,CustomToneMapping:()=>ye,CylinderGeometry:()=>Hu,Cylindrical:()=>u5,Data3DTexture:()=>Pi,DataArrayTexture:()=>yu,DataTexture:()=>zu,DataTextureLoader:()=>LN,DataUtils:()=>LP,DecrementStencilOp:()=>hy,DecrementWrapStencilOp:()=>dy,DefaultLoadingManager:()=>x2,DepthFormat:()=>be,DepthStencilFormat:()=>Ve,DepthTexture:()=>mM,DetachedBindMode:()=>ke,DirectionalLight:()=>S2,DirectionalLightHelper:()=>E5,DiscreteInterpolant:()=>v2,DisplayP3ColorSpace:()=>fu,DodecahedronGeometry:()=>kg,DoubleSide:()=>L,DstAlphaFactor:()=>Ce,DstColorFactor:()=>Oe,DynamicCopyUsage:()=>Sy,DynamicDrawUsage:()=>Ey,DynamicReadUsage:()=>wy,EdgesGeometry:()=>YM,EllipseCurve:()=>Pg,EqualCompare:()=>Fm,EqualDepth:()=>vn,EqualStencilFunc:()=>gy,EquirectangularReflectionMapping:()=>W,EquirectangularRefractionMapping:()=>k,Euler:()=>Df,EventDispatcher:()=>to,ExtrudeGeometry:()=>Qg,FileLoader:()=>gl,Float16BufferAttribute:()=>UP,Float32BufferAttribute:()=>ni,Float64BufferAttribute:()=>kP,FloatType:()=>Ei,Fog:()=>xg,FogExp2:()=>yg,FramebufferTexture:()=>QF,FrontSide:()=>C,Frustum:()=>fg,GLBufferAttribute:()=>l5,GLSL1:()=>Ry,GLSL3:()=>Cf,GreaterCompare:()=>Um,GreaterDepth:()=>Te,GreaterEqualCompare:()=>zm,GreaterEqualDepth:()=>Fe,GreaterEqualStencilFunc:()=>xy,GreaterStencilFunc:()=>vy,GridHelper:()=>y5,Group:()=>Ah,HalfFloatType:()=>Fi,HemisphereLight:()=>E2,HemisphereLightHelper:()=>v5,IcosahedronGeometry:()=>Xg,ImageBitmapLoader:()=>kN,ImageLoader:()=>sp,ImageUtils:()=>cl,IncrementStencilOp:()=>cy,IncrementWrapStencilOp:()=>uy,InstancedBufferAttribute:()=>Gu,InstancedBufferGeometry:()=>L2,InstancedInterleavedBuffer:()=>a5,InstancedMesh:()=>DM,Int16BufferAttribute:()=>FP,Int32BufferAttribute:()=>NP,Int8BufferAttribute:()=>PP,IntType:()=>Jn,InterleavedBuffer:()=>Eg,InterleavedBufferAttribute:()=>vh,Interpolant:()=>tp,InterpolateDiscrete:()=>Vn,InterpolateLinear:()=>Wn,InterpolateSmooth:()=>Nn,InvertStencilOp:()=>fy,KeepStencilOp:()=>ol,KeyframeTrack:()=>ma,LOD:()=>wM,LatheGeometry:()=>qf,Layers:()=>Jm,LessCompare:()=>Om,LessDepth:()=>Xt,LessEqualCompare:()=>Nm,LessEqualDepth:()=>Tn,LessEqualStencilFunc:()=>Ay,LessStencilFunc:()=>my,Light:()=>mc,LightProbe:()=>B2,Line:()=>fc,Line3:()=>f5,LineBasicMaterial:()=>oo,LineCurve:()=>Tx,LineCurve3:()=>KM,LineDashedMaterial:()=>p2,LineLoop:()=>zM,LineSegments:()=>qa,LinearDisplayP3ColorSpace:()=>ih,LinearEncoding:()=>eo,LinearFilter:()=>Bn,LinearInterpolant:()=>Ux,LinearMipMapLinearFilter:()=>sn,LinearMipMapNearestFilter:()=>Ri,LinearMipmapLinearFilter:()=>Fn,LinearMipmapNearestFilter:()=>pi,LinearSRGBColorSpace:()=>pr,LinearToneMapping:()=>mt,LinearTransfer:()=>rh,Loader:()=>wo,LoaderUtils:()=>jx,LoadingManager:()=>zx,LoopOnce:()=>kt,LoopPingPong:()=>oi,LoopRepeat:()=>bn,LuminanceAlphaFormat:()=>de,LuminanceFormat:()=>yt,MOUSE:()=>f,Material:()=>js,MaterialLoader:()=>eA,MathUtils:()=>Hy,Matrix3:()=>Ui,Matrix4:()=>_i,MaxEquation:()=>te,Mesh:()=>Os,MeshBasicMaterial:()=>uc,MeshDepthMaterial:()=>ux,MeshDistanceMaterial:()=>dx,MeshLambertMaterial:()=>d2,MeshMatcapMaterial:()=>f2,MeshNormalMaterial:()=>u2,MeshPhongMaterial:()=>c2,MeshPhysicalMaterial:()=>l2,MeshStandardMaterial:()=>Ox,MeshToonMaterial:()=>h2,MinEquation:()=>H,MirroredRepeatWrapping:()=>ve,MixOperation:()=>zt,MultiplyBlending:()=>K,MultiplyOperation:()=>Nt,NearestFilter:()=>at,NearestMipMapLinearFilter:()=>$t,NearestMipMapNearestFilter:()=>Ct,NearestMipmapLinearFilter:()=>Pt,NearestMipmapNearestFilter:()=>At,NeverCompare:()=>Dm,NeverDepth:()=>Ft,NeverStencilFunc:()=>py,NoBlending:()=>F,NoColorSpace:()=>qr,NoToneMapping:()=>fn,NormalAnimationBlendMode:()=>Bi,NormalBlending:()=>D,NotEqualCompare:()=>km,NotEqualDepth:()=>pt,NotEqualStencilFunc:()=>yy,NumberKeyframeTrack:()=>np,Object3D:()=>mr,ObjectLoader:()=>NN,ObjectSpaceNormalMap:()=>ja,OctahedronGeometry:()=>Zf,OneFactor:()=>ee,OneMinusConstantAlphaFactor:()=>mn,OneMinusConstantColorFactor:()=>Tt,OneMinusDstAlphaFactor:()=>Je,OneMinusDstColorFactor:()=>$e,OneMinusSrcAlphaFactor:()=>me,OneMinusSrcColorFactor:()=>xe,OrthographicCamera:()=>mg,P3Primaries:()=>oh,PCFShadowMap:()=>E,PCFSoftShadowMap:()=>S,PMREMGenerator:()=>ax,Path:()=>Kf,PerspectiveCamera:()=>hs,Plane:()=>dc,PlaneGeometry:()=>kf,PlaneHelper:()=>M5,PointLight:()=>C2,PointLightHelper:()=>g5,Points:()=>VM,PointsMaterial:()=>Ex,PolarGridHelper:()=>x5,PolyhedronGeometry:()=>pc,PositionalAudio:()=>WN,PropertyBinding:()=>dr,PropertyMixer:()=>H2,QuadraticBezierCurve:()=>Rx,QuadraticBezierCurve3:()=>Ix,Quaternion:()=>Ti,QuaternionKeyframeTrack:()=>Wu,QuaternionLinearInterpolant:()=>y2,RED_GREEN_RGTC2_Format:()=>Yt,RED_RGTC1_Format:()=>xt,REVISION:()=>d,RGBADepthPacking:()=>Ha,RGBAFormat:()=>ht,RGBAIntegerFormat:()=>Zt,RGBA_ASTC_10x10_Format:()=>ae,RGBA_ASTC_10x5_Format:()=>Ue,RGBA_ASTC_10x6_Format:()=>Ke,RGBA_ASTC_10x8_Format:()=>ft,RGBA_ASTC_12x10_Format:()=>le,RGBA_ASTC_12x12_Format:()=>ce,RGBA_ASTC_4x4_Format:()=>Rn,RGBA_ASTC_5x4_Format:()=>Kn,RGBA_ASTC_5x5_Format:()=>zi,RGBA_ASTC_6x5_Format:()=>Si,RGBA_ASTC_6x6_Format:()=>Y,RGBA_ASTC_8x5_Format:()=>se,RGBA_ASTC_8x6_Format:()=>pe,RGBA_ASTC_8x8_Format:()=>we,RGBA_BPTC_Format:()=>ge,RGBA_ETC2_EAC_Format:()=>Rr,RGBA_PVRTC_2BPPV1_Format:()=>vi,RGBA_PVRTC_4BPPV1_Format:()=>Cn,RGBA_S3TC_DXT1_Format:()=>Lt,RGBA_S3TC_DXT3_Format:()=>Pn,RGBA_S3TC_DXT5_Format:()=>Dn,RGB_BPTC_SIGNED_Format:()=>Ae,RGB_BPTC_UNSIGNED_Format:()=>tt,RGB_ETC1_Format:()=>Zn,RGB_ETC2_Format:()=>nr,RGB_PVRTC_2BPPV1_Format:()=>di,RGB_PVRTC_4BPPV1_Format:()=>jn,RGB_S3TC_DXT1_Format:()=>Wt,RGFormat:()=>_t,RGIntegerFormat:()=>It,RawShaderMaterial:()=>a2,Ray:()=>Vs,Raycaster:()=>c5,Rec709Primaries:()=>sh,RectAreaLight:()=>R2,RedFormat:()=>dt,RedIntegerFormat:()=>ut,ReinhardToneMapping:()=>Ee,RenderTarget:()=>vu,RepeatWrapping:()=>Re,ReplaceStencilOp:()=>ly,ReverseSubtractEquation:()=>G,RingGeometry:()=>Kg,SIGNED_RED_GREEN_RGTC2_Format:()=>on,SIGNED_RED_RGTC1_Format:()=>Dt,SRGBColorSpace:()=>Cr,SRGBTransfer:()=>wr,Scene:()=>vM,ShaderChunk:()=>Wi,ShaderLib:()=>fa,ShaderMaterial:()=>Ka,ShadowMaterial:()=>o2,Shape:()=>yh,ShapeGeometry:()=>qg,ShapePath:()=>T5,ShapeUtils:()=>Ya,ShortType:()=>si,Skeleton:()=>Sg,SkeletonHelper:()=>m5,SkinnedMesh:()=>IM,Source:()=>Br,Sphere:()=>Eo,SphereGeometry:()=>ep,Spherical:()=>h5,SphericalHarmonics3:()=>I2,SplineCurve:()=>Bx,SpotLight:()=>w2,SpotLightHelper:()=>p5,Sprite:()=>bM,SpriteMaterial:()=>mx,SrcAlphaFactor:()=>Pe,SrcAlphaSaturateFactor:()=>nt,SrcColorFactor:()=>oe,StaticCopyUsage:()=>Cy,StaticDrawUsage:()=>ah,StaticReadUsage:()=>_y,StereoCamera:()=>GN,StreamCopyUsage:()=>Ty,StreamDrawUsage:()=>by,StreamReadUsage:()=>My,StringKeyframeTrack:()=>_h,SubtractEquation:()=>j,SubtractiveBlending:()=>U,TOUCH:()=>p,TangentSpaceNormalMap:()=>ks,TetrahedronGeometry:()=>Yg,Texture:()=>Ir,TextureLoader:()=>PN,TorusGeometry:()=>$g,TorusKnotGeometry:()=>Jg,Triangle:()=>bo,TriangleFanDrawMode:()=>bi,TriangleStripDrawMode:()=>Fr,TrianglesDrawMode:()=>Li,TubeGeometry:()=>Zg,TwoPassDoubleSide:()=>B,UVMapping:()=>Ye,Uint16BufferAttribute:()=>$y,Uint32BufferAttribute:()=>Jy,Uint8BufferAttribute:()=>DP,Uint8ClampedBufferAttribute:()=>OP,Uniform:()=>Kx,UniformsGroup:()=>o5,UniformsLib:()=>Un,UniformsUtils:()=>Fw,UnsignedByteType:()=>Rt,UnsignedInt248Type:()=>cr,UnsignedIntType:()=>$n,UnsignedShort4444Type:()=>Vi,UnsignedShort5551Type:()=>lr,UnsignedShortType:()=>Ln,VSMShadowMap:()=>M,Vector2:()=>en,Vector3:()=>je,Vector4:()=>ur,VectorKeyframeTrack:()=>ip,VideoTexture:()=>WF,WebGL1Renderer:()=>AM,WebGL3DRenderTarget:()=>ar,WebGLArrayRenderTarget:()=>qn,WebGLCoordinateSystem:()=>Yo,WebGLCubeRenderTarget:()=>Uw,WebGLMultipleRenderTargets:()=>bs,WebGLRenderTarget:()=>yo,WebGLRenderer:()=>gM,WebGLUtils:()=>hM,WebGPUCoordinateSystem:()=>lh,WireframeGeometry:()=>i2,WrapAroundEnding:()=>xi,ZeroCurvatureEnding:()=>ai,ZeroFactor:()=>Z,ZeroSlopeEnding:()=>li,ZeroStencilOp:()=>ay,_SRGBAFormat:()=>pu,createCanvasElement:()=>Wm,sRGBEncoding:()=>Kr});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const d="158",f={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},p={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},A=0,g=1,v=2,b=3,x=0,E=1,S=2,M=3,C=0,T=1,L=2,B=2,F=0,D=1,P=2,U=3,K=4,J=5,z=100,j=101,G=102,H=103,te=104,Z=200,ee=201,oe=202,xe=203,Pe=204,me=205,Ce=206,Je=207,Oe=208,$e=209,nt=210,gt=211,Tt=212,Ze=213,mn=214,Ft=0,Qt=1,Xt=2,Tn=3,vn=4,Fe=5,Te=6,pt=7,Nt=0,zt=1,Vt=2,fn=0,mt=1,Ee=2,_e=3,Ne=4,ye=5,De="attached",ke="detached",Ye=300,Qe=301,ne=302,W=303,k=304,he=306,Re=1e3,We=1001,ve=1002,at=1003,At=1004,Ct=1004,Pt=1005,$t=1005,Bn=1006,pi=1007,Ri=1007,Fn=1008,sn=1008,Rt=1009,gn=1010,si=1011,Ln=1012,Jn=1013,$n=1014,Ei=1015,Fi=1016,Vi=1017,lr=1018,cr=1020,Le=1021,ht=1023,yt=1024,de=1025,be=1026,Ve=1027,dt=1028,ut=1029,_t=1030,It=1031,Zt=1033,Wt=33776,Lt=33777,Pn=33778,Dn=33779,jn=35840,di=35841,Cn=35842,vi=35843,Zn=36196,nr=37492,Rr=37496,Rn=37808,Kn=37809,zi=37810,Si=37811,Y=37812,se=37813,pe=37814,we=37815,Ue=37816,Ke=37817,ft=37818,ae=37819,le=37820,ce=37821,ge=36492,Ae=36494,tt=36495,xt=36283,Dt=36284,Yt=36285,on=36286,kt=2200,bn=2201,oi=2202,Vn=2300,Wn=2301,Nn=2302,ai=2400,li=2401,xi=2402,Bi=2500,hr=2501,Li=0,Fr=1,bi=2,eo=3e3,Kr=3001,qo=3200,Ha=3201,ks=0,ja=1,qr="",Cr="srgb",pr="srgb-linear",fu="display-p3",ih="display-p3-linear",rh="linear",wr="srgb",sh="rec709",oh="p3",ay=0,ol=7680,ly=7681,cy=7682,hy=7683,uy=34055,dy=34056,fy=5386,py=512,my=513,gy=514,Ay=515,vy=516,yy=517,xy=518,Mf=519,Dm=512,Om=513,Fm=514,Nm=515,Um=516,km=517,zm=518,Gm=519,ah=35044,Ey=35048,by=35040,_y=35045,wy=35049,My=35041,Cy=35046,Sy=35050,Ty=35042,Ry="100",Cf="300 es",pu=1035,Yo=2e3,lh=2001;class to{addEventListener(r,l){this._listeners===void 0&&(this._listeners={});const m=this._listeners;m[r]===void 0&&(m[r]=[]),m[r].indexOf(l)===-1&&m[r].push(l)}hasEventListener(r,l){if(this._listeners===void 0)return!1;const m=this._listeners;return m[r]!==void 0&&m[r].indexOf(l)!==-1}removeEventListener(r,l){if(this._listeners===void 0)return;const y=this._listeners[r];if(y!==void 0){const _=y.indexOf(l);_!==-1&&y.splice(_,1)}}dispatchEvent(r){if(this._listeners===void 0)return;const m=this._listeners[r.type];if(m!==void 0){r.target=this;const y=m.slice(0);for(let _=0,R=y.length;_<R;_++)y[_].call(this,r);r.target=null}}}const Es=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Vm=1234567;const al=Math.PI/180,sc=180/Math.PI;function no(){const w=Math.random()*4294967295|0,r=Math.random()*4294967295|0,l=Math.random()*4294967295|0,m=Math.random()*4294967295|0;return(Es[w&255]+Es[w>>8&255]+Es[w>>16&255]+Es[w>>24&255]+"-"+Es[r&255]+Es[r>>8&255]+"-"+Es[r>>16&15|64]+Es[r>>24&255]+"-"+Es[l&63|128]+Es[l>>8&255]+"-"+Es[l>>16&255]+Es[l>>24&255]+Es[m&255]+Es[m>>8&255]+Es[m>>16&255]+Es[m>>24&255]).toLowerCase()}function Nr(w,r,l){return Math.max(r,Math.min(l,w))}function Sf(w,r){return(w%r+r)%r}function Iy(w,r,l,m,y){return m+(w-r)*(y-m)/(l-r)}function By(w,r,l){return w!==r?(l-w)/(r-w):0}function ch(w,r,l){return(1-l)*w+l*r}function Ly(w,r,l,m){return ch(w,r,1-Math.exp(-l*m))}function Py(w,r=1){return r-Math.abs(Sf(w,r*2)-r)}function Dy(w,r,l){return w<=r?0:w>=l?1:(w=(w-r)/(l-r),w*w*(3-2*w))}function Oy(w,r,l){return w<=r?0:w>=l?1:(w=(w-r)/(l-r),w*w*w*(w*(w*6-15)+10))}function Fy(w,r){return w+Math.floor(Math.random()*(r-w+1))}function Ny(w,r){return w+Math.random()*(r-w)}function Uy(w){return w*(.5-Math.random())}function ky(w){w!==void 0&&(Vm=w);let r=Vm+=1831565813;return r=Math.imul(r^r>>>15,r|1),r^=r+Math.imul(r^r>>>7,r|61),((r^r>>>14)>>>0)/4294967296}function zy(w){return w*al}function Gy(w){return w*sc}function Tf(w){return(w&w-1)===0&&w!==0}function Hm(w){return Math.pow(2,Math.ceil(Math.log(w)/Math.LN2))}function mu(w){return Math.pow(2,Math.floor(Math.log(w)/Math.LN2))}function Vy(w,r,l,m,y){const _=Math.cos,R=Math.sin,I=_(l/2),O=R(l/2),N=_((r+m)/2),V=R((r+m)/2),Q=_((r-m)/2),X=R((r-m)/2),$=_((m-r)/2),ie=R((m-r)/2);switch(y){case"XYX":w.set(I*V,O*Q,O*X,I*N);break;case"YZY":w.set(O*X,I*V,O*Q,I*N);break;case"ZXZ":w.set(O*Q,O*X,I*V,I*N);break;case"XZX":w.set(I*V,O*ie,O*$,I*N);break;case"YXY":w.set(O*$,I*V,O*ie,I*N);break;case"ZYZ":w.set(O*ie,O*$,I*V,I*N);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+y)}}function zs(w,r){switch(r.constructor){case Float32Array:return w;case Uint32Array:return w/4294967295;case Uint16Array:return w/65535;case Uint8Array:return w/255;case Int32Array:return Math.max(w/2147483647,-1);case Int16Array:return Math.max(w/32767,-1);case Int8Array:return Math.max(w/127,-1);default:throw new Error("Invalid component type.")}}function Ni(w,r){switch(r.constructor){case Float32Array:return w;case Uint32Array:return Math.round(w*4294967295);case Uint16Array:return Math.round(w*65535);case Uint8Array:return Math.round(w*255);case Int32Array:return Math.round(w*2147483647);case Int16Array:return Math.round(w*32767);case Int8Array:return Math.round(w*127);default:throw new Error("Invalid component type.")}}const Hy={DEG2RAD:al,RAD2DEG:sc,generateUUID:no,clamp:Nr,euclideanModulo:Sf,mapLinear:Iy,inverseLerp:By,lerp:ch,damp:Ly,pingpong:Py,smoothstep:Dy,smootherstep:Oy,randInt:Fy,randFloat:Ny,randFloatSpread:Uy,seededRandom:ky,degToRad:zy,radToDeg:Gy,isPowerOfTwo:Tf,ceilPowerOfTwo:Hm,floorPowerOfTwo:mu,setQuaternionFromProperEuler:Vy,normalize:Ni,denormalize:zs};class en{constructor(r=0,l=0){en.prototype.isVector2=!0,this.x=r,this.y=l}get width(){return this.x}set width(r){this.x=r}get height(){return this.y}set height(r){this.y=r}set(r,l){return this.x=r,this.y=l,this}setScalar(r){return this.x=r,this.y=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setComponent(r,l){switch(r){case 0:this.x=l;break;case 1:this.y=l;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y)}copy(r){return this.x=r.x,this.y=r.y,this}add(r){return this.x+=r.x,this.y+=r.y,this}addScalar(r){return this.x+=r,this.y+=r,this}addVectors(r,l){return this.x=r.x+l.x,this.y=r.y+l.y,this}addScaledVector(r,l){return this.x+=r.x*l,this.y+=r.y*l,this}sub(r){return this.x-=r.x,this.y-=r.y,this}subScalar(r){return this.x-=r,this.y-=r,this}subVectors(r,l){return this.x=r.x-l.x,this.y=r.y-l.y,this}multiply(r){return this.x*=r.x,this.y*=r.y,this}multiplyScalar(r){return this.x*=r,this.y*=r,this}divide(r){return this.x/=r.x,this.y/=r.y,this}divideScalar(r){return this.multiplyScalar(1/r)}applyMatrix3(r){const l=this.x,m=this.y,y=r.elements;return this.x=y[0]*l+y[3]*m+y[6],this.y=y[1]*l+y[4]*m+y[7],this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this}clamp(r,l){return this.x=Math.max(r.x,Math.min(l.x,this.x)),this.y=Math.max(r.y,Math.min(l.y,this.y)),this}clampScalar(r,l){return this.x=Math.max(r,Math.min(l,this.x)),this.y=Math.max(r,Math.min(l,this.y)),this}clampLength(r,l){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(r,Math.min(l,m)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(r){return this.x*r.x+this.y*r.y}cross(r){return this.x*r.y-this.y*r.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(r){const l=Math.sqrt(this.lengthSq()*r.lengthSq());if(l===0)return Math.PI/2;const m=this.dot(r)/l;return Math.acos(Nr(m,-1,1))}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){const l=this.x-r.x,m=this.y-r.y;return l*l+m*m}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,l){return this.x+=(r.x-this.x)*l,this.y+=(r.y-this.y)*l,this}lerpVectors(r,l,m){return this.x=r.x+(l.x-r.x)*m,this.y=r.y+(l.y-r.y)*m,this}equals(r){return r.x===this.x&&r.y===this.y}fromArray(r,l=0){return this.x=r[l],this.y=r[l+1],this}toArray(r=[],l=0){return r[l]=this.x,r[l+1]=this.y,r}fromBufferAttribute(r,l){return this.x=r.getX(l),this.y=r.getY(l),this}rotateAround(r,l){const m=Math.cos(l),y=Math.sin(l),_=this.x-r.x,R=this.y-r.y;return this.x=_*m-R*y+r.x,this.y=_*y+R*m+r.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ui{constructor(r,l,m,y,_,R,I,O,N){Ui.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],r!==void 0&&this.set(r,l,m,y,_,R,I,O,N)}set(r,l,m,y,_,R,I,O,N){const V=this.elements;return V[0]=r,V[1]=y,V[2]=I,V[3]=l,V[4]=_,V[5]=O,V[6]=m,V[7]=R,V[8]=N,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(r){const l=this.elements,m=r.elements;return l[0]=m[0],l[1]=m[1],l[2]=m[2],l[3]=m[3],l[4]=m[4],l[5]=m[5],l[6]=m[6],l[7]=m[7],l[8]=m[8],this}extractBasis(r,l,m){return r.setFromMatrix3Column(this,0),l.setFromMatrix3Column(this,1),m.setFromMatrix3Column(this,2),this}setFromMatrix4(r){const l=r.elements;return this.set(l[0],l[4],l[8],l[1],l[5],l[9],l[2],l[6],l[10]),this}multiply(r){return this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,l){const m=r.elements,y=l.elements,_=this.elements,R=m[0],I=m[3],O=m[6],N=m[1],V=m[4],Q=m[7],X=m[2],$=m[5],ie=m[8],ue=y[0],re=y[3],q=y[6],Se=y[1],fe=y[4],Me=y[7],ze=y[2],He=y[5],et=y[8];return _[0]=R*ue+I*Se+O*ze,_[3]=R*re+I*fe+O*He,_[6]=R*q+I*Me+O*et,_[1]=N*ue+V*Se+Q*ze,_[4]=N*re+V*fe+Q*He,_[7]=N*q+V*Me+Q*et,_[2]=X*ue+$*Se+ie*ze,_[5]=X*re+$*fe+ie*He,_[8]=X*q+$*Me+ie*et,this}multiplyScalar(r){const l=this.elements;return l[0]*=r,l[3]*=r,l[6]*=r,l[1]*=r,l[4]*=r,l[7]*=r,l[2]*=r,l[5]*=r,l[8]*=r,this}determinant(){const r=this.elements,l=r[0],m=r[1],y=r[2],_=r[3],R=r[4],I=r[5],O=r[6],N=r[7],V=r[8];return l*R*V-l*I*N-m*_*V+m*I*O+y*_*N-y*R*O}invert(){const r=this.elements,l=r[0],m=r[1],y=r[2],_=r[3],R=r[4],I=r[5],O=r[6],N=r[7],V=r[8],Q=V*R-I*N,X=I*O-V*_,$=N*_-R*O,ie=l*Q+m*X+y*$;if(ie===0)return this.set(0,0,0,0,0,0,0,0,0);const ue=1/ie;return r[0]=Q*ue,r[1]=(y*N-V*m)*ue,r[2]=(I*m-y*R)*ue,r[3]=X*ue,r[4]=(V*l-y*O)*ue,r[5]=(y*_-I*l)*ue,r[6]=$*ue,r[7]=(m*O-N*l)*ue,r[8]=(R*l-m*_)*ue,this}transpose(){let r;const l=this.elements;return r=l[1],l[1]=l[3],l[3]=r,r=l[2],l[2]=l[6],l[6]=r,r=l[5],l[5]=l[7],l[7]=r,this}getNormalMatrix(r){return this.setFromMatrix4(r).invert().transpose()}transposeIntoArray(r){const l=this.elements;return r[0]=l[0],r[1]=l[3],r[2]=l[6],r[3]=l[1],r[4]=l[4],r[5]=l[7],r[6]=l[2],r[7]=l[5],r[8]=l[8],this}setUvTransform(r,l,m,y,_,R,I){const O=Math.cos(_),N=Math.sin(_);return this.set(m*O,m*N,-m*(O*R+N*I)+R+r,-y*N,y*O,-y*(-N*R+O*I)+I+l,0,0,1),this}scale(r,l){return this.premultiply(Rf.makeScale(r,l)),this}rotate(r){return this.premultiply(Rf.makeRotation(-r)),this}translate(r,l){return this.premultiply(Rf.makeTranslation(r,l)),this}makeTranslation(r,l){return r.isVector2?this.set(1,0,r.x,0,1,r.y,0,0,1):this.set(1,0,r,0,1,l,0,0,1),this}makeRotation(r){const l=Math.cos(r),m=Math.sin(r);return this.set(l,-m,0,m,l,0,0,0,1),this}makeScale(r,l){return this.set(r,0,0,0,l,0,0,0,1),this}equals(r){const l=this.elements,m=r.elements;for(let y=0;y<9;y++)if(l[y]!==m[y])return!1;return!0}fromArray(r,l=0){for(let m=0;m<9;m++)this.elements[m]=r[m+l];return this}toArray(r=[],l=0){const m=this.elements;return r[l]=m[0],r[l+1]=m[1],r[l+2]=m[2],r[l+3]=m[3],r[l+4]=m[4],r[l+5]=m[5],r[l+6]=m[6],r[l+7]=m[7],r[l+8]=m[8],r}clone(){return new this.constructor().fromArray(this.elements)}}const Rf=new Ui;function jm(w){for(let r=w.length-1;r>=0;--r)if(w[r]>=65535)return!0;return!1}const jy={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function oc(w,r){return new jy[w](r)}function hh(w){return document.createElementNS("http://www.w3.org/1999/xhtml",w)}function Wm(){const w=hh("canvas");return w.style.display="block",w}const Qm={};function uh(w){w in Qm||(Qm[w]=!0,console.warn(w))}const Xm=new Ui().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Km=new Ui().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),gu={[pr]:{transfer:rh,primaries:sh,toReference:w=>w,fromReference:w=>w},[Cr]:{transfer:wr,primaries:sh,toReference:w=>w.convertSRGBToLinear(),fromReference:w=>w.convertLinearToSRGB()},[ih]:{transfer:rh,primaries:oh,toReference:w=>w.applyMatrix3(Km),fromReference:w=>w.applyMatrix3(Xm)},[fu]:{transfer:wr,primaries:oh,toReference:w=>w.convertSRGBToLinear().applyMatrix3(Km),fromReference:w=>w.applyMatrix3(Xm).convertLinearToSRGB()}},Wy=new Set([pr,ih]),vr={enabled:!0,_workingColorSpace:pr,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(w){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!w},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(w){if(!Wy.has(w))throw new Error(`Unsupported working color space, "${w}".`);this._workingColorSpace=w},convert:function(w,r,l){if(this.enabled===!1||r===l||!r||!l)return w;const m=gu[r].toReference,y=gu[l].fromReference;return y(m(w))},fromWorkingColorSpace:function(w,r){return this.convert(w,this._workingColorSpace,r)},toWorkingColorSpace:function(w,r){return this.convert(w,r,this._workingColorSpace)},getPrimaries:function(w){return gu[w].primaries},getTransfer:function(w){return w===qr?rh:gu[w].transfer}};function ac(w){return w<.04045?w*.0773993808:Math.pow(w*.9478672986+.0521327014,2.4)}function If(w){return w<.0031308?w*12.92:1.055*Math.pow(w,.41666)-.055}let ll;class cl{static getDataURL(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let l;if(r instanceof HTMLCanvasElement)l=r;else{ll===void 0&&(ll=hh("canvas")),ll.width=r.width,ll.height=r.height;const m=ll.getContext("2d");r instanceof ImageData?m.putImageData(r,0,0):m.drawImage(r,0,0,r.width,r.height),l=ll}return l.width>2048||l.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",r),l.toDataURL("image/jpeg",.6)):l.toDataURL("image/png")}static sRGBToLinear(r){if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap){const l=hh("canvas");l.width=r.width,l.height=r.height;const m=l.getContext("2d");m.drawImage(r,0,0,r.width,r.height);const y=m.getImageData(0,0,r.width,r.height),_=y.data;for(let R=0;R<_.length;R++)_[R]=ac(_[R]/255)*255;return m.putImageData(y,0,0),l}else if(r.data){const l=r.data.slice(0);for(let m=0;m<l.length;m++)l instanceof Uint8Array||l instanceof Uint8ClampedArray?l[m]=Math.floor(ac(l[m]/255)*255):l[m]=ac(l[m]);return{data:l,width:r.width,height:r.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),r}}let qm=0;class Br{constructor(r=null){this.isSource=!0,Object.defineProperty(this,"id",{value:qm++}),this.uuid=no(),this.data=r,this.version=0}set needsUpdate(r){r===!0&&this.version++}toJSON(r){const l=r===void 0||typeof r=="string";if(!l&&r.images[this.uuid]!==void 0)return r.images[this.uuid];const m={uuid:this.uuid,url:""},y=this.data;if(y!==null){let _;if(Array.isArray(y)){_=[];for(let R=0,I=y.length;R<I;R++)y[R].isDataTexture?_.push(Au(y[R].image)):_.push(Au(y[R]))}else _=Au(y);m.url=_}return l||(r.images[this.uuid]=m),m}}function Au(w){return typeof HTMLImageElement<"u"&&w instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&w instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&w instanceof ImageBitmap?cl.getDataURL(w):w.data?{data:Array.from(w.data),width:w.width,height:w.height,type:w.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Ym=0;class Ir extends to{constructor(r=Ir.DEFAULT_IMAGE,l=Ir.DEFAULT_MAPPING,m=We,y=We,_=Bn,R=Fn,I=ht,O=Rt,N=Ir.DEFAULT_ANISOTROPY,V=qr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Ym++}),this.uuid=no(),this.name="",this.source=new Br(r),this.mipmaps=[],this.mapping=l,this.channel=0,this.wrapS=m,this.wrapT=y,this.magFilter=_,this.minFilter=R,this.anisotropy=N,this.format=I,this.internalFormat=null,this.type=O,this.offset=new en(0,0),this.repeat=new en(1,1),this.center=new en(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ui,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof V=="string"?this.colorSpace=V:(uh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=V===Kr?Cr:qr),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(r=null){this.source.data=r}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(r){return this.name=r.name,this.source=r.source,this.mipmaps=r.mipmaps.slice(0),this.mapping=r.mapping,this.channel=r.channel,this.wrapS=r.wrapS,this.wrapT=r.wrapT,this.magFilter=r.magFilter,this.minFilter=r.minFilter,this.anisotropy=r.anisotropy,this.format=r.format,this.internalFormat=r.internalFormat,this.type=r.type,this.offset.copy(r.offset),this.repeat.copy(r.repeat),this.center.copy(r.center),this.rotation=r.rotation,this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrix.copy(r.matrix),this.generateMipmaps=r.generateMipmaps,this.premultiplyAlpha=r.premultiplyAlpha,this.flipY=r.flipY,this.unpackAlignment=r.unpackAlignment,this.colorSpace=r.colorSpace,this.userData=JSON.parse(JSON.stringify(r.userData)),this.needsUpdate=!0,this}toJSON(r){const l=r===void 0||typeof r=="string";if(!l&&r.textures[this.uuid]!==void 0)return r.textures[this.uuid];const m={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(r).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(m.userData=this.userData),l||(r.textures[this.uuid]=m),m}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(r){if(this.mapping!==Ye)return r;if(r.applyMatrix3(this.matrix),r.x<0||r.x>1)switch(this.wrapS){case Re:r.x=r.x-Math.floor(r.x);break;case We:r.x=r.x<0?0:1;break;case ve:Math.abs(Math.floor(r.x)%2)===1?r.x=Math.ceil(r.x)-r.x:r.x=r.x-Math.floor(r.x);break}if(r.y<0||r.y>1)switch(this.wrapT){case Re:r.y=r.y-Math.floor(r.y);break;case We:r.y=r.y<0?0:1;break;case ve:Math.abs(Math.floor(r.y)%2)===1?r.y=Math.ceil(r.y)-r.y:r.y=r.y-Math.floor(r.y);break}return this.flipY&&(r.y=1-r.y),r}set needsUpdate(r){r===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return uh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Cr?Kr:eo}set encoding(r){uh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=r===Kr?Cr:qr}}Ir.DEFAULT_IMAGE=null,Ir.DEFAULT_MAPPING=Ye,Ir.DEFAULT_ANISOTROPY=1;class ur{constructor(r=0,l=0,m=0,y=1){ur.prototype.isVector4=!0,this.x=r,this.y=l,this.z=m,this.w=y}get width(){return this.z}set width(r){this.z=r}get height(){return this.w}set height(r){this.w=r}set(r,l,m,y){return this.x=r,this.y=l,this.z=m,this.w=y,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this.w=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setW(r){return this.w=r,this}setComponent(r,l){switch(r){case 0:this.x=l;break;case 1:this.y=l;break;case 2:this.z=l;break;case 3:this.w=l;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w!==void 0?r.w:1,this}add(r){return this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this}addVectors(r,l){return this.x=r.x+l.x,this.y=r.y+l.y,this.z=r.z+l.z,this.w=r.w+l.w,this}addScaledVector(r,l){return this.x+=r.x*l,this.y+=r.y*l,this.z+=r.z*l,this.w+=r.w*l,this}sub(r){return this.x-=r.x,this.y-=r.y,this.z-=r.z,this.w-=r.w,this}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this.w-=r,this}subVectors(r,l){return this.x=r.x-l.x,this.y=r.y-l.y,this.z=r.z-l.z,this.w=r.w-l.w,this}multiply(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this.w*=r.w,this}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this.w*=r,this}applyMatrix4(r){const l=this.x,m=this.y,y=this.z,_=this.w,R=r.elements;return this.x=R[0]*l+R[4]*m+R[8]*y+R[12]*_,this.y=R[1]*l+R[5]*m+R[9]*y+R[13]*_,this.z=R[2]*l+R[6]*m+R[10]*y+R[14]*_,this.w=R[3]*l+R[7]*m+R[11]*y+R[15]*_,this}divideScalar(r){return this.multiplyScalar(1/r)}setAxisAngleFromQuaternion(r){this.w=2*Math.acos(r.w);const l=Math.sqrt(1-r.w*r.w);return l<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=r.x/l,this.y=r.y/l,this.z=r.z/l),this}setAxisAngleFromRotationMatrix(r){let l,m,y,_;const O=r.elements,N=O[0],V=O[4],Q=O[8],X=O[1],$=O[5],ie=O[9],ue=O[2],re=O[6],q=O[10];if(Math.abs(V-X)<.01&&Math.abs(Q-ue)<.01&&Math.abs(ie-re)<.01){if(Math.abs(V+X)<.1&&Math.abs(Q+ue)<.1&&Math.abs(ie+re)<.1&&Math.abs(N+$+q-3)<.1)return this.set(1,0,0,0),this;l=Math.PI;const fe=(N+1)/2,Me=($+1)/2,ze=(q+1)/2,He=(V+X)/4,et=(Q+ue)/4,st=(ie+re)/4;return fe>Me&&fe>ze?fe<.01?(m=0,y=.707106781,_=.707106781):(m=Math.sqrt(fe),y=He/m,_=et/m):Me>ze?Me<.01?(m=.707106781,y=0,_=.707106781):(y=Math.sqrt(Me),m=He/y,_=st/y):ze<.01?(m=.707106781,y=.707106781,_=0):(_=Math.sqrt(ze),m=et/_,y=st/_),this.set(m,y,_,l),this}let Se=Math.sqrt((re-ie)*(re-ie)+(Q-ue)*(Q-ue)+(X-V)*(X-V));return Math.abs(Se)<.001&&(Se=1),this.x=(re-ie)/Se,this.y=(Q-ue)/Se,this.z=(X-V)/Se,this.w=Math.acos((N+$+q-1)/2),this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this.w=Math.min(this.w,r.w),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this.w=Math.max(this.w,r.w),this}clamp(r,l){return this.x=Math.max(r.x,Math.min(l.x,this.x)),this.y=Math.max(r.y,Math.min(l.y,this.y)),this.z=Math.max(r.z,Math.min(l.z,this.z)),this.w=Math.max(r.w,Math.min(l.w,this.w)),this}clampScalar(r,l){return this.x=Math.max(r,Math.min(l,this.x)),this.y=Math.max(r,Math.min(l,this.y)),this.z=Math.max(r,Math.min(l,this.z)),this.w=Math.max(r,Math.min(l,this.w)),this}clampLength(r,l){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(r,Math.min(l,m)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,l){return this.x+=(r.x-this.x)*l,this.y+=(r.y-this.y)*l,this.z+=(r.z-this.z)*l,this.w+=(r.w-this.w)*l,this}lerpVectors(r,l,m){return this.x=r.x+(l.x-r.x)*m,this.y=r.y+(l.y-r.y)*m,this.z=r.z+(l.z-r.z)*m,this.w=r.w+(l.w-r.w)*m,this}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z&&r.w===this.w}fromArray(r,l=0){return this.x=r[l],this.y=r[l+1],this.z=r[l+2],this.w=r[l+3],this}toArray(r=[],l=0){return r[l]=this.x,r[l+1]=this.y,r[l+2]=this.z,r[l+3]=this.w,r}fromBufferAttribute(r,l){return this.x=r.getX(l),this.y=r.getY(l),this.z=r.getZ(l),this.w=r.getW(l),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class vu extends to{constructor(r=1,l=1,m={}){super(),this.isRenderTarget=!0,this.width=r,this.height=l,this.depth=1,this.scissor=new ur(0,0,r,l),this.scissorTest=!1,this.viewport=new ur(0,0,r,l);const y={width:r,height:l,depth:1};m.encoding!==void 0&&(uh("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),m.colorSpace=m.encoding===Kr?Cr:qr),m=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},m),this.texture=new Ir(y,m.mapping,m.wrapS,m.wrapT,m.magFilter,m.minFilter,m.format,m.type,m.anisotropy,m.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=m.generateMipmaps,this.texture.internalFormat=m.internalFormat,this.depthBuffer=m.depthBuffer,this.stencilBuffer=m.stencilBuffer,this.depthTexture=m.depthTexture,this.samples=m.samples}setSize(r,l,m=1){(this.width!==r||this.height!==l||this.depth!==m)&&(this.width=r,this.height=l,this.depth=m,this.texture.image.width=r,this.texture.image.height=l,this.texture.image.depth=m,this.dispose()),this.viewport.set(0,0,r,l),this.scissor.set(0,0,r,l)}clone(){return new this.constructor().copy(this)}copy(r){this.width=r.width,this.height=r.height,this.depth=r.depth,this.scissor.copy(r.scissor),this.scissorTest=r.scissorTest,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.texture.isRenderTargetTexture=!0;const l=Object.assign({},r.texture.image);return this.texture.source=new Br(l),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,r.depthTexture!==null&&(this.depthTexture=r.depthTexture.clone()),this.samples=r.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class yo extends vu{constructor(r=1,l=1,m={}){super(r,l,m),this.isWebGLRenderTarget=!0}}class yu extends Ir{constructor(r=null,l=1,m=1,y=1){super(null),this.isDataArrayTexture=!0,this.image={data:r,width:l,height:m,depth:y},this.magFilter=at,this.minFilter=at,this.wrapR=We,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class qn extends yo{constructor(r=1,l=1,m=1){super(r,l),this.isWebGLArrayRenderTarget=!0,this.depth=m,this.texture=new yu(null,r,l,m),this.texture.isRenderTargetTexture=!0}}class Pi extends Ir{constructor(r=null,l=1,m=1,y=1){super(null),this.isData3DTexture=!0,this.image={data:r,width:l,height:m,depth:y},this.magFilter=at,this.minFilter=at,this.wrapR=We,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ar extends yo{constructor(r=1,l=1,m=1){super(r,l),this.isWebGL3DRenderTarget=!0,this.depth=m,this.texture=new Pi(null,r,l,m),this.texture.isRenderTargetTexture=!0}}class bs extends yo{constructor(r=1,l=1,m=1,y={}){super(r,l,y),this.isWebGLMultipleRenderTargets=!0;const _=this.texture;this.texture=[];for(let R=0;R<m;R++)this.texture[R]=_.clone(),this.texture[R].isRenderTargetTexture=!0}setSize(r,l,m=1){if(this.width!==r||this.height!==l||this.depth!==m){this.width=r,this.height=l,this.depth=m;for(let y=0,_=this.texture.length;y<_;y++)this.texture[y].image.width=r,this.texture[y].image.height=l,this.texture[y].image.depth=m;this.dispose()}this.viewport.set(0,0,r,l),this.scissor.set(0,0,r,l)}copy(r){this.dispose(),this.width=r.width,this.height=r.height,this.depth=r.depth,this.scissor.copy(r.scissor),this.scissorTest=r.scissorTest,this.viewport.copy(r.viewport),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,r.depthTexture!==null&&(this.depthTexture=r.depthTexture.clone()),this.texture.length=0;for(let l=0,m=r.texture.length;l<m;l++)this.texture[l]=r.texture[l].clone(),this.texture[l].isRenderTargetTexture=!0;return this}}class Ti{constructor(r=0,l=0,m=0,y=1){this.isQuaternion=!0,this._x=r,this._y=l,this._z=m,this._w=y}static slerpFlat(r,l,m,y,_,R,I){let O=m[y+0],N=m[y+1],V=m[y+2],Q=m[y+3];const X=_[R+0],$=_[R+1],ie=_[R+2],ue=_[R+3];if(I===0){r[l+0]=O,r[l+1]=N,r[l+2]=V,r[l+3]=Q;return}if(I===1){r[l+0]=X,r[l+1]=$,r[l+2]=ie,r[l+3]=ue;return}if(Q!==ue||O!==X||N!==$||V!==ie){let re=1-I;const q=O*X+N*$+V*ie+Q*ue,Se=q>=0?1:-1,fe=1-q*q;if(fe>Number.EPSILON){const ze=Math.sqrt(fe),He=Math.atan2(ze,q*Se);re=Math.sin(re*He)/ze,I=Math.sin(I*He)/ze}const Me=I*Se;if(O=O*re+X*Me,N=N*re+$*Me,V=V*re+ie*Me,Q=Q*re+ue*Me,re===1-I){const ze=1/Math.sqrt(O*O+N*N+V*V+Q*Q);O*=ze,N*=ze,V*=ze,Q*=ze}}r[l]=O,r[l+1]=N,r[l+2]=V,r[l+3]=Q}static multiplyQuaternionsFlat(r,l,m,y,_,R){const I=m[y],O=m[y+1],N=m[y+2],V=m[y+3],Q=_[R],X=_[R+1],$=_[R+2],ie=_[R+3];return r[l]=I*ie+V*Q+O*$-N*X,r[l+1]=O*ie+V*X+N*Q-I*$,r[l+2]=N*ie+V*$+I*X-O*Q,r[l+3]=V*ie-I*Q-O*X-N*$,r}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get w(){return this._w}set w(r){this._w=r,this._onChangeCallback()}set(r,l,m,y){return this._x=r,this._y=l,this._z=m,this._w=y,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this}setFromEuler(r,l){const m=r._x,y=r._y,_=r._z,R=r._order,I=Math.cos,O=Math.sin,N=I(m/2),V=I(y/2),Q=I(_/2),X=O(m/2),$=O(y/2),ie=O(_/2);switch(R){case"XYZ":this._x=X*V*Q+N*$*ie,this._y=N*$*Q-X*V*ie,this._z=N*V*ie+X*$*Q,this._w=N*V*Q-X*$*ie;break;case"YXZ":this._x=X*V*Q+N*$*ie,this._y=N*$*Q-X*V*ie,this._z=N*V*ie-X*$*Q,this._w=N*V*Q+X*$*ie;break;case"ZXY":this._x=X*V*Q-N*$*ie,this._y=N*$*Q+X*V*ie,this._z=N*V*ie+X*$*Q,this._w=N*V*Q-X*$*ie;break;case"ZYX":this._x=X*V*Q-N*$*ie,this._y=N*$*Q+X*V*ie,this._z=N*V*ie-X*$*Q,this._w=N*V*Q+X*$*ie;break;case"YZX":this._x=X*V*Q+N*$*ie,this._y=N*$*Q+X*V*ie,this._z=N*V*ie-X*$*Q,this._w=N*V*Q-X*$*ie;break;case"XZY":this._x=X*V*Q-N*$*ie,this._y=N*$*Q-X*V*ie,this._z=N*V*ie+X*$*Q,this._w=N*V*Q+X*$*ie;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+R)}return l!==!1&&this._onChangeCallback(),this}setFromAxisAngle(r,l){const m=l/2,y=Math.sin(m);return this._x=r.x*y,this._y=r.y*y,this._z=r.z*y,this._w=Math.cos(m),this._onChangeCallback(),this}setFromRotationMatrix(r){const l=r.elements,m=l[0],y=l[4],_=l[8],R=l[1],I=l[5],O=l[9],N=l[2],V=l[6],Q=l[10],X=m+I+Q;if(X>0){const $=.5/Math.sqrt(X+1);this._w=.25/$,this._x=(V-O)*$,this._y=(_-N)*$,this._z=(R-y)*$}else if(m>I&&m>Q){const $=2*Math.sqrt(1+m-I-Q);this._w=(V-O)/$,this._x=.25*$,this._y=(y+R)/$,this._z=(_+N)/$}else if(I>Q){const $=2*Math.sqrt(1+I-m-Q);this._w=(_-N)/$,this._x=(y+R)/$,this._y=.25*$,this._z=(O+V)/$}else{const $=2*Math.sqrt(1+Q-m-I);this._w=(R-y)/$,this._x=(_+N)/$,this._y=(O+V)/$,this._z=.25*$}return this._onChangeCallback(),this}setFromUnitVectors(r,l){let m=r.dot(l)+1;return m<Number.EPSILON?(m=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=m):(this._x=0,this._y=-r.z,this._z=r.y,this._w=m)):(this._x=r.y*l.z-r.z*l.y,this._y=r.z*l.x-r.x*l.z,this._z=r.x*l.y-r.y*l.x,this._w=m),this.normalize()}angleTo(r){return 2*Math.acos(Math.abs(Nr(this.dot(r),-1,1)))}rotateTowards(r,l){const m=this.angleTo(r);if(m===0)return this;const y=Math.min(1,l/m);return this.slerp(r,y),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this}multiply(r){return this.multiplyQuaternions(this,r)}premultiply(r){return this.multiplyQuaternions(r,this)}multiplyQuaternions(r,l){const m=r._x,y=r._y,_=r._z,R=r._w,I=l._x,O=l._y,N=l._z,V=l._w;return this._x=m*V+R*I+y*N-_*O,this._y=y*V+R*O+_*I-m*N,this._z=_*V+R*N+m*O-y*I,this._w=R*V-m*I-y*O-_*N,this._onChangeCallback(),this}slerp(r,l){if(l===0)return this;if(l===1)return this.copy(r);const m=this._x,y=this._y,_=this._z,R=this._w;let I=R*r._w+m*r._x+y*r._y+_*r._z;if(I<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,I=-I):this.copy(r),I>=1)return this._w=R,this._x=m,this._y=y,this._z=_,this;const O=1-I*I;if(O<=Number.EPSILON){const $=1-l;return this._w=$*R+l*this._w,this._x=$*m+l*this._x,this._y=$*y+l*this._y,this._z=$*_+l*this._z,this.normalize(),this._onChangeCallback(),this}const N=Math.sqrt(O),V=Math.atan2(N,I),Q=Math.sin((1-l)*V)/N,X=Math.sin(l*V)/N;return this._w=R*Q+this._w*X,this._x=m*Q+this._x*X,this._y=y*Q+this._y*X,this._z=_*Q+this._z*X,this._onChangeCallback(),this}slerpQuaternions(r,l,m){return this.copy(r).slerp(l,m)}random(){const r=Math.random(),l=Math.sqrt(1-r),m=Math.sqrt(r),y=2*Math.PI*Math.random(),_=2*Math.PI*Math.random();return this.set(l*Math.cos(y),m*Math.sin(_),m*Math.cos(_),l*Math.sin(y))}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w}fromArray(r,l=0){return this._x=r[l],this._y=r[l+1],this._z=r[l+2],this._w=r[l+3],this._onChangeCallback(),this}toArray(r=[],l=0){return r[l]=this._x,r[l+1]=this._y,r[l+2]=this._z,r[l+3]=this._w,r}fromBufferAttribute(r,l){return this._x=r.getX(l),this._y=r.getY(l),this._z=r.getZ(l),this._w=r.getW(l),this}toJSON(){return this.toArray()}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class je{constructor(r=0,l=0,m=0){je.prototype.isVector3=!0,this.x=r,this.y=l,this.z=m}set(r,l,m){return m===void 0&&(m=this.z),this.x=r,this.y=l,this.z=m,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setComponent(r,l){switch(r){case 0:this.x=l;break;case 1:this.y=l;break;case 2:this.z=l;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}add(r){return this.x+=r.x,this.y+=r.y,this.z+=r.z,this}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this}addVectors(r,l){return this.x=r.x+l.x,this.y=r.y+l.y,this.z=r.z+l.z,this}addScaledVector(r,l){return this.x+=r.x*l,this.y+=r.y*l,this.z+=r.z*l,this}sub(r){return this.x-=r.x,this.y-=r.y,this.z-=r.z,this}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this}subVectors(r,l){return this.x=r.x-l.x,this.y=r.y-l.y,this.z=r.z-l.z,this}multiply(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this}multiplyVectors(r,l){return this.x=r.x*l.x,this.y=r.y*l.y,this.z=r.z*l.z,this}applyEuler(r){return this.applyQuaternion(Wa.setFromEuler(r))}applyAxisAngle(r,l){return this.applyQuaternion(Wa.setFromAxisAngle(r,l))}applyMatrix3(r){const l=this.x,m=this.y,y=this.z,_=r.elements;return this.x=_[0]*l+_[3]*m+_[6]*y,this.y=_[1]*l+_[4]*m+_[7]*y,this.z=_[2]*l+_[5]*m+_[8]*y,this}applyNormalMatrix(r){return this.applyMatrix3(r).normalize()}applyMatrix4(r){const l=this.x,m=this.y,y=this.z,_=r.elements,R=1/(_[3]*l+_[7]*m+_[11]*y+_[15]);return this.x=(_[0]*l+_[4]*m+_[8]*y+_[12])*R,this.y=(_[1]*l+_[5]*m+_[9]*y+_[13])*R,this.z=(_[2]*l+_[6]*m+_[10]*y+_[14])*R,this}applyQuaternion(r){const l=this.x,m=this.y,y=this.z,_=r.x,R=r.y,I=r.z,O=r.w,N=2*(R*y-I*m),V=2*(I*l-_*y),Q=2*(_*m-R*l);return this.x=l+O*N+R*Q-I*V,this.y=m+O*V+I*N-_*Q,this.z=y+O*Q+_*V-R*N,this}project(r){return this.applyMatrix4(r.matrixWorldInverse).applyMatrix4(r.projectionMatrix)}unproject(r){return this.applyMatrix4(r.projectionMatrixInverse).applyMatrix4(r.matrixWorld)}transformDirection(r){const l=this.x,m=this.y,y=this.z,_=r.elements;return this.x=_[0]*l+_[4]*m+_[8]*y,this.y=_[1]*l+_[5]*m+_[9]*y,this.z=_[2]*l+_[6]*m+_[10]*y,this.normalize()}divide(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this}divideScalar(r){return this.multiplyScalar(1/r)}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this}clamp(r,l){return this.x=Math.max(r.x,Math.min(l.x,this.x)),this.y=Math.max(r.y,Math.min(l.y,this.y)),this.z=Math.max(r.z,Math.min(l.z,this.z)),this}clampScalar(r,l){return this.x=Math.max(r,Math.min(l,this.x)),this.y=Math.max(r,Math.min(l,this.y)),this.z=Math.max(r,Math.min(l,this.z)),this}clampLength(r,l){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(r,Math.min(l,m)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,l){return this.x+=(r.x-this.x)*l,this.y+=(r.y-this.y)*l,this.z+=(r.z-this.z)*l,this}lerpVectors(r,l,m){return this.x=r.x+(l.x-r.x)*m,this.y=r.y+(l.y-r.y)*m,this.z=r.z+(l.z-r.z)*m,this}cross(r){return this.crossVectors(this,r)}crossVectors(r,l){const m=r.x,y=r.y,_=r.z,R=l.x,I=l.y,O=l.z;return this.x=y*O-_*I,this.y=_*R-m*O,this.z=m*I-y*R,this}projectOnVector(r){const l=r.lengthSq();if(l===0)return this.set(0,0,0);const m=r.dot(this)/l;return this.copy(r).multiplyScalar(m)}projectOnPlane(r){return Vr.copy(this).projectOnVector(r),this.sub(Vr)}reflect(r){return this.sub(Vr.copy(r).multiplyScalar(2*this.dot(r)))}angleTo(r){const l=Math.sqrt(this.lengthSq()*r.lengthSq());if(l===0)return Math.PI/2;const m=this.dot(r)/l;return Math.acos(Nr(m,-1,1))}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){const l=this.x-r.x,m=this.y-r.y,y=this.z-r.z;return l*l+m*m+y*y}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)+Math.abs(this.z-r.z)}setFromSpherical(r){return this.setFromSphericalCoords(r.radius,r.phi,r.theta)}setFromSphericalCoords(r,l,m){const y=Math.sin(l)*r;return this.x=y*Math.sin(m),this.y=Math.cos(l)*r,this.z=y*Math.cos(m),this}setFromCylindrical(r){return this.setFromCylindricalCoords(r.radius,r.theta,r.y)}setFromCylindricalCoords(r,l,m){return this.x=r*Math.sin(l),this.y=m,this.z=r*Math.cos(l),this}setFromMatrixPosition(r){const l=r.elements;return this.x=l[12],this.y=l[13],this.z=l[14],this}setFromMatrixScale(r){const l=this.setFromMatrixColumn(r,0).length(),m=this.setFromMatrixColumn(r,1).length(),y=this.setFromMatrixColumn(r,2).length();return this.x=l,this.y=m,this.z=y,this}setFromMatrixColumn(r,l){return this.fromArray(r.elements,l*4)}setFromMatrix3Column(r,l){return this.fromArray(r.elements,l*3)}setFromEuler(r){return this.x=r._x,this.y=r._y,this.z=r._z,this}setFromColor(r){return this.x=r.r,this.y=r.g,this.z=r.b,this}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z}fromArray(r,l=0){return this.x=r[l],this.y=r[l+1],this.z=r[l+2],this}toArray(r=[],l=0){return r[l]=this.x,r[l+1]=this.y,r[l+2]=this.z,r}fromBufferAttribute(r,l){return this.x=r.getX(l),this.y=r.getY(l),this.z=r.getZ(l),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const r=(Math.random()-.5)*2,l=Math.random()*Math.PI*2,m=Math.sqrt(1-r**2);return this.x=m*Math.cos(l),this.y=m*Math.sin(l),this.z=r,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Vr=new je,Wa=new Ti;class er{constructor(r=new je(1/0,1/0,1/0),l=new je(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=r,this.max=l}set(r,l){return this.min.copy(r),this.max.copy(l),this}setFromArray(r){this.makeEmpty();for(let l=0,m=r.length;l<m;l+=3)this.expandByPoint(Ds.fromArray(r,l));return this}setFromBufferAttribute(r){this.makeEmpty();for(let l=0,m=r.count;l<m;l++)this.expandByPoint(Ds.fromBufferAttribute(r,l));return this}setFromPoints(r){this.makeEmpty();for(let l=0,m=r.length;l<m;l++)this.expandByPoint(r[l]);return this}setFromCenterAndSize(r,l){const m=Ds.copy(l).multiplyScalar(.5);return this.min.copy(r).sub(m),this.max.copy(r).add(m),this}setFromObject(r,l=!1){return this.makeEmpty(),this.expandByObject(r,l)}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(r){return this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}expandByObject(r,l=!1){r.updateWorldMatrix(!1,!1);const m=r.geometry;if(m!==void 0){const _=m.getAttribute("position");if(l===!0&&_!==void 0&&r.isInstancedMesh!==!0)for(let R=0,I=_.count;R<I;R++)r.isMesh===!0?r.getVertexPosition(R,Ds):Ds.fromBufferAttribute(_,R),Ds.applyMatrix4(r.matrixWorld),this.expandByPoint(Ds);else r.boundingBox!==void 0?(r.boundingBox===null&&r.computeBoundingBox(),$o.copy(r.boundingBox)):(m.boundingBox===null&&m.computeBoundingBox(),$o.copy(m.boundingBox)),$o.applyMatrix4(r.matrixWorld),this.union($o)}const y=r.children;for(let _=0,R=y.length;_<R;_++)this.expandByObject(y[_],l);return this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z}getParameter(r,l){return l.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)}intersectsSphere(r){return this.clampPoint(r.center,Ds),Ds.distanceToSquared(r.center)<=r.radius*r.radius}intersectsPlane(r){let l,m;return r.normal.x>0?(l=r.normal.x*this.min.x,m=r.normal.x*this.max.x):(l=r.normal.x*this.max.x,m=r.normal.x*this.min.x),r.normal.y>0?(l+=r.normal.y*this.min.y,m+=r.normal.y*this.max.y):(l+=r.normal.y*this.max.y,m+=r.normal.y*this.min.y),r.normal.z>0?(l+=r.normal.z*this.min.z,m+=r.normal.z*this.max.z):(l+=r.normal.z*this.max.z,m+=r.normal.z*this.min.z),l<=-r.constant&&m>=-r.constant}intersectsTriangle(r){if(this.isEmpty())return!1;this.getCenter(Er),ji.subVectors(this.max,Er),_s.subVectors(r.a,Er),Hi.subVectors(r.b,Er),io.subVectors(r.c,Er),Do.subVectors(Hi,_s),ls.subVectors(io,Hi),rr.subVectors(_s,io);let l=[0,-Do.z,Do.y,0,-ls.z,ls.y,0,-rr.z,rr.y,Do.z,0,-Do.x,ls.z,0,-ls.x,rr.z,0,-rr.x,-Do.y,Do.x,0,-ls.y,ls.x,0,-rr.y,rr.x,0];return!Qa(l,_s,Hi,io,ji)||(l=[1,0,0,0,1,0,0,0,1],!Qa(l,_s,Hi,io,ji))?!1:(yr.crossVectors(Do,ls),l=[yr.x,yr.y,yr.z],Qa(l,_s,Hi,io,ji))}clampPoint(r,l){return l.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return this.clampPoint(r,Ds).distanceTo(r)}getBoundingSphere(r){return this.isEmpty()?r.makeEmpty():(this.getCenter(r.center),r.radius=this.getSize(Ds).length()*.5),r}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}applyMatrix4(r){return this.isEmpty()?this:(xo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),xo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),xo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),xo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),xo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),xo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),xo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),xo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(xo),this)}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}}const xo=[new je,new je,new je,new je,new je,new je,new je,new je],Ds=new je,$o=new er,_s=new je,Hi=new je,io=new je,Do=new je,ls=new je,rr=new je,Er=new je,ji=new je,yr=new je,cs=new je;function Qa(w,r,l,m,y){for(let _=0,R=w.length-3;_<=R;_+=3){cs.fromArray(w,_);const I=y.x*Math.abs(cs.x)+y.y*Math.abs(cs.y)+y.z*Math.abs(cs.z),O=r.dot(cs),N=l.dot(cs),V=m.dot(cs);if(Math.max(-Math.max(O,N,V),Math.min(O,N,V))>I)return!1}return!0}const Bf=new er,lc=new je,xu=new je;class Eo{constructor(r=new je,l=-1){this.center=r,this.radius=l}set(r,l){return this.center.copy(r),this.radius=l,this}setFromPoints(r,l){const m=this.center;l!==void 0?m.copy(l):Bf.setFromPoints(r).getCenter(m);let y=0;for(let _=0,R=r.length;_<R;_++)y=Math.max(y,m.distanceToSquared(r[_]));return this.radius=Math.sqrt(y),this}copy(r){return this.center.copy(r.center),this.radius=r.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(r){return r.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(r){return r.distanceTo(this.center)-this.radius}intersectsSphere(r){const l=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=l*l}intersectsBox(r){return r.intersectsSphere(this)}intersectsPlane(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius}clampPoint(r,l){const m=this.center.distanceToSquared(r);return l.copy(r),m>this.radius*this.radius&&(l.sub(this.center).normalize(),l.multiplyScalar(this.radius).add(this.center)),l}getBoundingBox(r){return this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)}applyMatrix4(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this}translate(r){return this.center.add(r),this}expandByPoint(r){if(this.isEmpty())return this.center.copy(r),this.radius=0,this;lc.subVectors(r,this.center);const l=lc.lengthSq();if(l>this.radius*this.radius){const m=Math.sqrt(l),y=(m-this.radius)*.5;this.center.addScaledVector(lc,y/m),this.radius+=y}return this}union(r){return r.isEmpty()?this:this.isEmpty()?(this.copy(r),this):(this.center.equals(r.center)===!0?this.radius=Math.max(this.radius,r.radius):(xu.subVectors(r.center,this.center).setLength(r.radius),this.expandByPoint(lc.copy(r.center).add(xu)),this.expandByPoint(lc.copy(r.center).sub(xu))),this)}equals(r){return r.center.equals(this.center)&&r.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Jo=new je,Lf=new je,Eu=new je,Xa=new je,Pf=new je,bu=new je,Gs=new je;class Vs{constructor(r=new je,l=new je(0,0,-1)){this.origin=r,this.direction=l}set(r,l){return this.origin.copy(r),this.direction.copy(l),this}copy(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this}at(r,l){return l.copy(this.origin).addScaledVector(this.direction,r)}lookAt(r){return this.direction.copy(r).sub(this.origin).normalize(),this}recast(r){return this.origin.copy(this.at(r,Jo)),this}closestPointToPoint(r,l){l.subVectors(r,this.origin);const m=l.dot(this.direction);return m<0?l.copy(this.origin):l.copy(this.origin).addScaledVector(this.direction,m)}distanceToPoint(r){return Math.sqrt(this.distanceSqToPoint(r))}distanceSqToPoint(r){const l=Jo.subVectors(r,this.origin).dot(this.direction);return l<0?this.origin.distanceToSquared(r):(Jo.copy(this.origin).addScaledVector(this.direction,l),Jo.distanceToSquared(r))}distanceSqToSegment(r,l,m,y){Lf.copy(r).add(l).multiplyScalar(.5),Eu.copy(l).sub(r).normalize(),Xa.copy(this.origin).sub(Lf);const _=r.distanceTo(l)*.5,R=-this.direction.dot(Eu),I=Xa.dot(this.direction),O=-Xa.dot(Eu),N=Xa.lengthSq(),V=Math.abs(1-R*R);let Q,X,$,ie;if(V>0)if(Q=R*O-I,X=R*I-O,ie=_*V,Q>=0)if(X>=-ie)if(X<=ie){const ue=1/V;Q*=ue,X*=ue,$=Q*(Q+R*X+2*I)+X*(R*Q+X+2*O)+N}else X=_,Q=Math.max(0,-(R*X+I)),$=-Q*Q+X*(X+2*O)+N;else X=-_,Q=Math.max(0,-(R*X+I)),$=-Q*Q+X*(X+2*O)+N;else X<=-ie?(Q=Math.max(0,-(-R*_+I)),X=Q>0?-_:Math.min(Math.max(-_,-O),_),$=-Q*Q+X*(X+2*O)+N):X<=ie?(Q=0,X=Math.min(Math.max(-_,-O),_),$=X*(X+2*O)+N):(Q=Math.max(0,-(R*_+I)),X=Q>0?_:Math.min(Math.max(-_,-O),_),$=-Q*Q+X*(X+2*O)+N);else X=R>0?-_:_,Q=Math.max(0,-(R*X+I)),$=-Q*Q+X*(X+2*O)+N;return m&&m.copy(this.origin).addScaledVector(this.direction,Q),y&&y.copy(Lf).addScaledVector(Eu,X),$}intersectSphere(r,l){Jo.subVectors(r.center,this.origin);const m=Jo.dot(this.direction),y=Jo.dot(Jo)-m*m,_=r.radius*r.radius;if(y>_)return null;const R=Math.sqrt(_-y),I=m-R,O=m+R;return O<0?null:I<0?this.at(O,l):this.at(I,l)}intersectsSphere(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius}distanceToPlane(r){const l=r.normal.dot(this.direction);if(l===0)return r.distanceToPoint(this.origin)===0?0:null;const m=-(this.origin.dot(r.normal)+r.constant)/l;return m>=0?m:null}intersectPlane(r,l){const m=this.distanceToPlane(r);return m===null?null:this.at(m,l)}intersectsPlane(r){const l=r.distanceToPoint(this.origin);return l===0||r.normal.dot(this.direction)*l<0}intersectBox(r,l){let m,y,_,R,I,O;const N=1/this.direction.x,V=1/this.direction.y,Q=1/this.direction.z,X=this.origin;return N>=0?(m=(r.min.x-X.x)*N,y=(r.max.x-X.x)*N):(m=(r.max.x-X.x)*N,y=(r.min.x-X.x)*N),V>=0?(_=(r.min.y-X.y)*V,R=(r.max.y-X.y)*V):(_=(r.max.y-X.y)*V,R=(r.min.y-X.y)*V),m>R||_>y||((_>m||isNaN(m))&&(m=_),(R<y||isNaN(y))&&(y=R),Q>=0?(I=(r.min.z-X.z)*Q,O=(r.max.z-X.z)*Q):(I=(r.max.z-X.z)*Q,O=(r.min.z-X.z)*Q),m>O||I>y)||((I>m||m!==m)&&(m=I),(O<y||y!==y)&&(y=O),y<0)?null:this.at(m>=0?m:y,l)}intersectsBox(r){return this.intersectBox(r,Jo)!==null}intersectTriangle(r,l,m,y,_){Pf.subVectors(l,r),bu.subVectors(m,r),Gs.crossVectors(Pf,bu);let R=this.direction.dot(Gs),I;if(R>0){if(y)return null;I=1}else if(R<0)I=-1,R=-R;else return null;Xa.subVectors(this.origin,r);const O=I*this.direction.dot(bu.crossVectors(Xa,bu));if(O<0)return null;const N=I*this.direction.dot(Pf.cross(Xa));if(N<0||O+N>R)return null;const V=-I*Xa.dot(Gs);return V<0?null:this.at(V/R,_)}applyMatrix4(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this}equals(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class _i{constructor(r,l,m,y,_,R,I,O,N,V,Q,X,$,ie,ue,re){_i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r!==void 0&&this.set(r,l,m,y,_,R,I,O,N,V,Q,X,$,ie,ue,re)}set(r,l,m,y,_,R,I,O,N,V,Q,X,$,ie,ue,re){const q=this.elements;return q[0]=r,q[4]=l,q[8]=m,q[12]=y,q[1]=_,q[5]=R,q[9]=I,q[13]=O,q[2]=N,q[6]=V,q[10]=Q,q[14]=X,q[3]=$,q[7]=ie,q[11]=ue,q[15]=re,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new _i().fromArray(this.elements)}copy(r){const l=this.elements,m=r.elements;return l[0]=m[0],l[1]=m[1],l[2]=m[2],l[3]=m[3],l[4]=m[4],l[5]=m[5],l[6]=m[6],l[7]=m[7],l[8]=m[8],l[9]=m[9],l[10]=m[10],l[11]=m[11],l[12]=m[12],l[13]=m[13],l[14]=m[14],l[15]=m[15],this}copyPosition(r){const l=this.elements,m=r.elements;return l[12]=m[12],l[13]=m[13],l[14]=m[14],this}setFromMatrix3(r){const l=r.elements;return this.set(l[0],l[3],l[6],0,l[1],l[4],l[7],0,l[2],l[5],l[8],0,0,0,0,1),this}extractBasis(r,l,m){return r.setFromMatrixColumn(this,0),l.setFromMatrixColumn(this,1),m.setFromMatrixColumn(this,2),this}makeBasis(r,l,m){return this.set(r.x,l.x,m.x,0,r.y,l.y,m.y,0,r.z,l.z,m.z,0,0,0,0,1),this}extractRotation(r){const l=this.elements,m=r.elements,y=1/hl.setFromMatrixColumn(r,0).length(),_=1/hl.setFromMatrixColumn(r,1).length(),R=1/hl.setFromMatrixColumn(r,2).length();return l[0]=m[0]*y,l[1]=m[1]*y,l[2]=m[2]*y,l[3]=0,l[4]=m[4]*_,l[5]=m[5]*_,l[6]=m[6]*_,l[7]=0,l[8]=m[8]*R,l[9]=m[9]*R,l[10]=m[10]*R,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this}makeRotationFromEuler(r){const l=this.elements,m=r.x,y=r.y,_=r.z,R=Math.cos(m),I=Math.sin(m),O=Math.cos(y),N=Math.sin(y),V=Math.cos(_),Q=Math.sin(_);if(r.order==="XYZ"){const X=R*V,$=R*Q,ie=I*V,ue=I*Q;l[0]=O*V,l[4]=-O*Q,l[8]=N,l[1]=$+ie*N,l[5]=X-ue*N,l[9]=-I*O,l[2]=ue-X*N,l[6]=ie+$*N,l[10]=R*O}else if(r.order==="YXZ"){const X=O*V,$=O*Q,ie=N*V,ue=N*Q;l[0]=X+ue*I,l[4]=ie*I-$,l[8]=R*N,l[1]=R*Q,l[5]=R*V,l[9]=-I,l[2]=$*I-ie,l[6]=ue+X*I,l[10]=R*O}else if(r.order==="ZXY"){const X=O*V,$=O*Q,ie=N*V,ue=N*Q;l[0]=X-ue*I,l[4]=-R*Q,l[8]=ie+$*I,l[1]=$+ie*I,l[5]=R*V,l[9]=ue-X*I,l[2]=-R*N,l[6]=I,l[10]=R*O}else if(r.order==="ZYX"){const X=R*V,$=R*Q,ie=I*V,ue=I*Q;l[0]=O*V,l[4]=ie*N-$,l[8]=X*N+ue,l[1]=O*Q,l[5]=ue*N+X,l[9]=$*N-ie,l[2]=-N,l[6]=I*O,l[10]=R*O}else if(r.order==="YZX"){const X=R*O,$=R*N,ie=I*O,ue=I*N;l[0]=O*V,l[4]=ue-X*Q,l[8]=ie*Q+$,l[1]=Q,l[5]=R*V,l[9]=-I*V,l[2]=-N*V,l[6]=$*Q+ie,l[10]=X-ue*Q}else if(r.order==="XZY"){const X=R*O,$=R*N,ie=I*O,ue=I*N;l[0]=O*V,l[4]=-Q,l[8]=N*V,l[1]=X*Q+ue,l[5]=R*V,l[9]=$*Q-ie,l[2]=ie*Q-$,l[6]=I*V,l[10]=ue*Q+X}return l[3]=0,l[7]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this}makeRotationFromQuaternion(r){return this.compose(_P,r,wP)}lookAt(r,l,m){const y=this.elements;return Oo.subVectors(r,l),Oo.lengthSq()===0&&(Oo.z=1),Oo.normalize(),cc.crossVectors(m,Oo),cc.lengthSq()===0&&(Math.abs(m.z)===1?Oo.x+=1e-4:Oo.z+=1e-4,Oo.normalize(),cc.crossVectors(m,Oo)),cc.normalize(),$m.crossVectors(Oo,cc),y[0]=cc.x,y[4]=$m.x,y[8]=Oo.x,y[1]=cc.y,y[5]=$m.y,y[9]=Oo.y,y[2]=cc.z,y[6]=$m.z,y[10]=Oo.z,this}multiply(r){return this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,l){const m=r.elements,y=l.elements,_=this.elements,R=m[0],I=m[4],O=m[8],N=m[12],V=m[1],Q=m[5],X=m[9],$=m[13],ie=m[2],ue=m[6],re=m[10],q=m[14],Se=m[3],fe=m[7],Me=m[11],ze=m[15],He=y[0],et=y[4],st=y[8],Be=y[12],Xe=y[1],rt=y[5],bt=y[9],Gt=y[13],lt=y[2],wt=y[6],Kt=y[10],qt=y[14],ln=y[3],Jt=y[7],pn=y[11],dn=y[15];return _[0]=R*He+I*Xe+O*lt+N*ln,_[4]=R*et+I*rt+O*wt+N*Jt,_[8]=R*st+I*bt+O*Kt+N*pn,_[12]=R*Be+I*Gt+O*qt+N*dn,_[1]=V*He+Q*Xe+X*lt+$*ln,_[5]=V*et+Q*rt+X*wt+$*Jt,_[9]=V*st+Q*bt+X*Kt+$*pn,_[13]=V*Be+Q*Gt+X*qt+$*dn,_[2]=ie*He+ue*Xe+re*lt+q*ln,_[6]=ie*et+ue*rt+re*wt+q*Jt,_[10]=ie*st+ue*bt+re*Kt+q*pn,_[14]=ie*Be+ue*Gt+re*qt+q*dn,_[3]=Se*He+fe*Xe+Me*lt+ze*ln,_[7]=Se*et+fe*rt+Me*wt+ze*Jt,_[11]=Se*st+fe*bt+Me*Kt+ze*pn,_[15]=Se*Be+fe*Gt+Me*qt+ze*dn,this}multiplyScalar(r){const l=this.elements;return l[0]*=r,l[4]*=r,l[8]*=r,l[12]*=r,l[1]*=r,l[5]*=r,l[9]*=r,l[13]*=r,l[2]*=r,l[6]*=r,l[10]*=r,l[14]*=r,l[3]*=r,l[7]*=r,l[11]*=r,l[15]*=r,this}determinant(){const r=this.elements,l=r[0],m=r[4],y=r[8],_=r[12],R=r[1],I=r[5],O=r[9],N=r[13],V=r[2],Q=r[6],X=r[10],$=r[14],ie=r[3],ue=r[7],re=r[11],q=r[15];return ie*(+_*O*Q-y*N*Q-_*I*X+m*N*X+y*I*$-m*O*$)+ue*(+l*O*$-l*N*X+_*R*X-y*R*$+y*N*V-_*O*V)+re*(+l*N*Q-l*I*$-_*R*Q+m*R*$+_*I*V-m*N*V)+q*(-y*I*V-l*O*Q+l*I*X+y*R*Q-m*R*X+m*O*V)}transpose(){const r=this.elements;let l;return l=r[1],r[1]=r[4],r[4]=l,l=r[2],r[2]=r[8],r[8]=l,l=r[6],r[6]=r[9],r[9]=l,l=r[3],r[3]=r[12],r[12]=l,l=r[7],r[7]=r[13],r[13]=l,l=r[11],r[11]=r[14],r[14]=l,this}setPosition(r,l,m){const y=this.elements;return r.isVector3?(y[12]=r.x,y[13]=r.y,y[14]=r.z):(y[12]=r,y[13]=l,y[14]=m),this}invert(){const r=this.elements,l=r[0],m=r[1],y=r[2],_=r[3],R=r[4],I=r[5],O=r[6],N=r[7],V=r[8],Q=r[9],X=r[10],$=r[11],ie=r[12],ue=r[13],re=r[14],q=r[15],Se=Q*re*N-ue*X*N+ue*O*$-I*re*$-Q*O*q+I*X*q,fe=ie*X*N-V*re*N-ie*O*$+R*re*$+V*O*q-R*X*q,Me=V*ue*N-ie*Q*N+ie*I*$-R*ue*$-V*I*q+R*Q*q,ze=ie*Q*O-V*ue*O-ie*I*X+R*ue*X+V*I*re-R*Q*re,He=l*Se+m*fe+y*Me+_*ze;if(He===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const et=1/He;return r[0]=Se*et,r[1]=(ue*X*_-Q*re*_-ue*y*$+m*re*$+Q*y*q-m*X*q)*et,r[2]=(I*re*_-ue*O*_+ue*y*N-m*re*N-I*y*q+m*O*q)*et,r[3]=(Q*O*_-I*X*_-Q*y*N+m*X*N+I*y*$-m*O*$)*et,r[4]=fe*et,r[5]=(V*re*_-ie*X*_+ie*y*$-l*re*$-V*y*q+l*X*q)*et,r[6]=(ie*O*_-R*re*_-ie*y*N+l*re*N+R*y*q-l*O*q)*et,r[7]=(R*X*_-V*O*_+V*y*N-l*X*N-R*y*$+l*O*$)*et,r[8]=Me*et,r[9]=(ie*Q*_-V*ue*_-ie*m*$+l*ue*$+V*m*q-l*Q*q)*et,r[10]=(R*ue*_-ie*I*_+ie*m*N-l*ue*N-R*m*q+l*I*q)*et,r[11]=(V*I*_-R*Q*_-V*m*N+l*Q*N+R*m*$-l*I*$)*et,r[12]=ze*et,r[13]=(V*ue*y-ie*Q*y+ie*m*X-l*ue*X-V*m*re+l*Q*re)*et,r[14]=(ie*I*y-R*ue*y-ie*m*O+l*ue*O+R*m*re-l*I*re)*et,r[15]=(R*Q*y-V*I*y+V*m*O-l*Q*O-R*m*X+l*I*X)*et,this}scale(r){const l=this.elements,m=r.x,y=r.y,_=r.z;return l[0]*=m,l[4]*=y,l[8]*=_,l[1]*=m,l[5]*=y,l[9]*=_,l[2]*=m,l[6]*=y,l[10]*=_,l[3]*=m,l[7]*=y,l[11]*=_,this}getMaxScaleOnAxis(){const r=this.elements,l=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],m=r[4]*r[4]+r[5]*r[5]+r[6]*r[6],y=r[8]*r[8]+r[9]*r[9]+r[10]*r[10];return Math.sqrt(Math.max(l,m,y))}makeTranslation(r,l,m){return r.isVector3?this.set(1,0,0,r.x,0,1,0,r.y,0,0,1,r.z,0,0,0,1):this.set(1,0,0,r,0,1,0,l,0,0,1,m,0,0,0,1),this}makeRotationX(r){const l=Math.cos(r),m=Math.sin(r);return this.set(1,0,0,0,0,l,-m,0,0,m,l,0,0,0,0,1),this}makeRotationY(r){const l=Math.cos(r),m=Math.sin(r);return this.set(l,0,m,0,0,1,0,0,-m,0,l,0,0,0,0,1),this}makeRotationZ(r){const l=Math.cos(r),m=Math.sin(r);return this.set(l,-m,0,0,m,l,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(r,l){const m=Math.cos(l),y=Math.sin(l),_=1-m,R=r.x,I=r.y,O=r.z,N=_*R,V=_*I;return this.set(N*R+m,N*I-y*O,N*O+y*I,0,N*I+y*O,V*I+m,V*O-y*R,0,N*O-y*I,V*O+y*R,_*O*O+m,0,0,0,0,1),this}makeScale(r,l,m){return this.set(r,0,0,0,0,l,0,0,0,0,m,0,0,0,0,1),this}makeShear(r,l,m,y,_,R){return this.set(1,m,_,0,r,1,R,0,l,y,1,0,0,0,0,1),this}compose(r,l,m){const y=this.elements,_=l._x,R=l._y,I=l._z,O=l._w,N=_+_,V=R+R,Q=I+I,X=_*N,$=_*V,ie=_*Q,ue=R*V,re=R*Q,q=I*Q,Se=O*N,fe=O*V,Me=O*Q,ze=m.x,He=m.y,et=m.z;return y[0]=(1-(ue+q))*ze,y[1]=($+Me)*ze,y[2]=(ie-fe)*ze,y[3]=0,y[4]=($-Me)*He,y[5]=(1-(X+q))*He,y[6]=(re+Se)*He,y[7]=0,y[8]=(ie+fe)*et,y[9]=(re-Se)*et,y[10]=(1-(X+ue))*et,y[11]=0,y[12]=r.x,y[13]=r.y,y[14]=r.z,y[15]=1,this}decompose(r,l,m){const y=this.elements;let _=hl.set(y[0],y[1],y[2]).length();const R=hl.set(y[4],y[5],y[6]).length(),I=hl.set(y[8],y[9],y[10]).length();this.determinant()<0&&(_=-_),r.x=y[12],r.y=y[13],r.z=y[14],ua.copy(this);const N=1/_,V=1/R,Q=1/I;return ua.elements[0]*=N,ua.elements[1]*=N,ua.elements[2]*=N,ua.elements[4]*=V,ua.elements[5]*=V,ua.elements[6]*=V,ua.elements[8]*=Q,ua.elements[9]*=Q,ua.elements[10]*=Q,l.setFromRotationMatrix(ua),m.x=_,m.y=R,m.z=I,this}makePerspective(r,l,m,y,_,R,I=Yo){const O=this.elements,N=2*_/(l-r),V=2*_/(m-y),Q=(l+r)/(l-r),X=(m+y)/(m-y);let $,ie;if(I===Yo)$=-(R+_)/(R-_),ie=-2*R*_/(R-_);else if(I===lh)$=-R/(R-_),ie=-R*_/(R-_);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+I);return O[0]=N,O[4]=0,O[8]=Q,O[12]=0,O[1]=0,O[5]=V,O[9]=X,O[13]=0,O[2]=0,O[6]=0,O[10]=$,O[14]=ie,O[3]=0,O[7]=0,O[11]=-1,O[15]=0,this}makeOrthographic(r,l,m,y,_,R,I=Yo){const O=this.elements,N=1/(l-r),V=1/(m-y),Q=1/(R-_),X=(l+r)*N,$=(m+y)*V;let ie,ue;if(I===Yo)ie=(R+_)*Q,ue=-2*Q;else if(I===lh)ie=_*Q,ue=-1*Q;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+I);return O[0]=2*N,O[4]=0,O[8]=0,O[12]=-X,O[1]=0,O[5]=2*V,O[9]=0,O[13]=-$,O[2]=0,O[6]=0,O[10]=ue,O[14]=-ie,O[3]=0,O[7]=0,O[11]=0,O[15]=1,this}equals(r){const l=this.elements,m=r.elements;for(let y=0;y<16;y++)if(l[y]!==m[y])return!1;return!0}fromArray(r,l=0){for(let m=0;m<16;m++)this.elements[m]=r[m+l];return this}toArray(r=[],l=0){const m=this.elements;return r[l]=m[0],r[l+1]=m[1],r[l+2]=m[2],r[l+3]=m[3],r[l+4]=m[4],r[l+5]=m[5],r[l+6]=m[6],r[l+7]=m[7],r[l+8]=m[8],r[l+9]=m[9],r[l+10]=m[10],r[l+11]=m[11],r[l+12]=m[12],r[l+13]=m[13],r[l+14]=m[14],r[l+15]=m[15],r}}const hl=new je,ua=new _i,_P=new je(0,0,0),wP=new je(1,1,1),cc=new je,$m=new je,Oo=new je,bw=new _i,_w=new Ti;class Df{constructor(r=0,l=0,m=0,y=Df.DEFAULT_ORDER){this.isEuler=!0,this._x=r,this._y=l,this._z=m,this._order=y}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get order(){return this._order}set order(r){this._order=r,this._onChangeCallback()}set(r,l,m,y=this._order){return this._x=r,this._y=l,this._z=m,this._order=y,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(r){return this._x=r._x,this._y=r._y,this._z=r._z,this._order=r._order,this._onChangeCallback(),this}setFromRotationMatrix(r,l=this._order,m=!0){const y=r.elements,_=y[0],R=y[4],I=y[8],O=y[1],N=y[5],V=y[9],Q=y[2],X=y[6],$=y[10];switch(l){case"XYZ":this._y=Math.asin(Nr(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(-V,$),this._z=Math.atan2(-R,_)):(this._x=Math.atan2(X,N),this._z=0);break;case"YXZ":this._x=Math.asin(-Nr(V,-1,1)),Math.abs(V)<.9999999?(this._y=Math.atan2(I,$),this._z=Math.atan2(O,N)):(this._y=Math.atan2(-Q,_),this._z=0);break;case"ZXY":this._x=Math.asin(Nr(X,-1,1)),Math.abs(X)<.9999999?(this._y=Math.atan2(-Q,$),this._z=Math.atan2(-R,N)):(this._y=0,this._z=Math.atan2(O,_));break;case"ZYX":this._y=Math.asin(-Nr(Q,-1,1)),Math.abs(Q)<.9999999?(this._x=Math.atan2(X,$),this._z=Math.atan2(O,_)):(this._x=0,this._z=Math.atan2(-R,N));break;case"YZX":this._z=Math.asin(Nr(O,-1,1)),Math.abs(O)<.9999999?(this._x=Math.atan2(-V,N),this._y=Math.atan2(-Q,_)):(this._x=0,this._y=Math.atan2(I,$));break;case"XZY":this._z=Math.asin(-Nr(R,-1,1)),Math.abs(R)<.9999999?(this._x=Math.atan2(X,N),this._y=Math.atan2(I,_)):(this._x=Math.atan2(-V,$),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+l)}return this._order=l,m===!0&&this._onChangeCallback(),this}setFromQuaternion(r,l,m){return bw.makeRotationFromQuaternion(r),this.setFromRotationMatrix(bw,l,m)}setFromVector3(r,l=this._order){return this.set(r.x,r.y,r.z,l)}reorder(r){return _w.setFromEuler(this),this.setFromQuaternion(_w,r)}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._order===this._order}fromArray(r){return this._x=r[0],this._y=r[1],this._z=r[2],r[3]!==void 0&&(this._order=r[3]),this._onChangeCallback(),this}toArray(r=[],l=0){return r[l]=this._x,r[l+1]=this._y,r[l+2]=this._z,r[l+3]=this._order,r}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Df.DEFAULT_ORDER="XYZ";class Jm{constructor(){this.mask=1}set(r){this.mask=(1<<r|0)>>>0}enable(r){this.mask|=1<<r|0}enableAll(){this.mask=-1}toggle(r){this.mask^=1<<r|0}disable(r){this.mask&=~(1<<r|0)}disableAll(){this.mask=0}test(r){return(this.mask&r.mask)!==0}isEnabled(r){return(this.mask&(1<<r|0))!==0}}let MP=0;const ww=new je,_u=new Ti,ul=new _i,Zm=new je,Of=new je,CP=new je,SP=new Ti,Mw=new je(1,0,0),Cw=new je(0,1,0),Sw=new je(0,0,1),TP={type:"added"},RP={type:"removed"};class mr extends to{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:MP++}),this.uuid=no(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=mr.DEFAULT_UP.clone();const r=new je,l=new Df,m=new Ti,y=new je(1,1,1);function _(){m.setFromEuler(l,!1)}function R(){l.setFromQuaternion(m,void 0,!1)}l._onChange(_),m._onChange(R),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:l},quaternion:{configurable:!0,enumerable:!0,value:m},scale:{configurable:!0,enumerable:!0,value:y},modelViewMatrix:{value:new _i},normalMatrix:{value:new Ui}}),this.matrix=new _i,this.matrixWorld=new _i,this.matrixAutoUpdate=mr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=mr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Jm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(r){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(r),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(r){return this.quaternion.premultiply(r),this}setRotationFromAxisAngle(r,l){this.quaternion.setFromAxisAngle(r,l)}setRotationFromEuler(r){this.quaternion.setFromEuler(r,!0)}setRotationFromMatrix(r){this.quaternion.setFromRotationMatrix(r)}setRotationFromQuaternion(r){this.quaternion.copy(r)}rotateOnAxis(r,l){return _u.setFromAxisAngle(r,l),this.quaternion.multiply(_u),this}rotateOnWorldAxis(r,l){return _u.setFromAxisAngle(r,l),this.quaternion.premultiply(_u),this}rotateX(r){return this.rotateOnAxis(Mw,r)}rotateY(r){return this.rotateOnAxis(Cw,r)}rotateZ(r){return this.rotateOnAxis(Sw,r)}translateOnAxis(r,l){return ww.copy(r).applyQuaternion(this.quaternion),this.position.add(ww.multiplyScalar(l)),this}translateX(r){return this.translateOnAxis(Mw,r)}translateY(r){return this.translateOnAxis(Cw,r)}translateZ(r){return this.translateOnAxis(Sw,r)}localToWorld(r){return this.updateWorldMatrix(!0,!1),r.applyMatrix4(this.matrixWorld)}worldToLocal(r){return this.updateWorldMatrix(!0,!1),r.applyMatrix4(ul.copy(this.matrixWorld).invert())}lookAt(r,l,m){r.isVector3?Zm.copy(r):Zm.set(r,l,m);const y=this.parent;this.updateWorldMatrix(!0,!1),Of.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ul.lookAt(Of,Zm,this.up):ul.lookAt(Zm,Of,this.up),this.quaternion.setFromRotationMatrix(ul),y&&(ul.extractRotation(y.matrixWorld),_u.setFromRotationMatrix(ul),this.quaternion.premultiply(_u.invert()))}add(r){if(arguments.length>1){for(let l=0;l<arguments.length;l++)this.add(arguments[l]);return this}return r===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this):(r&&r.isObject3D?(r.parent!==null&&r.parent.remove(r),r.parent=this,this.children.push(r),r.dispatchEvent(TP)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r),this)}remove(r){if(arguments.length>1){for(let m=0;m<arguments.length;m++)this.remove(arguments[m]);return this}const l=this.children.indexOf(r);return l!==-1&&(r.parent=null,this.children.splice(l,1),r.dispatchEvent(RP)),this}removeFromParent(){const r=this.parent;return r!==null&&r.remove(this),this}clear(){return this.remove(...this.children)}attach(r){return this.updateWorldMatrix(!0,!1),ul.copy(this.matrixWorld).invert(),r.parent!==null&&(r.parent.updateWorldMatrix(!0,!1),ul.multiply(r.parent.matrixWorld)),r.applyMatrix4(ul),this.add(r),r.updateWorldMatrix(!1,!0),this}getObjectById(r){return this.getObjectByProperty("id",r)}getObjectByName(r){return this.getObjectByProperty("name",r)}getObjectByProperty(r,l){if(this[r]===l)return this;for(let m=0,y=this.children.length;m<y;m++){const R=this.children[m].getObjectByProperty(r,l);if(R!==void 0)return R}}getObjectsByProperty(r,l){let m=[];this[r]===l&&m.push(this);for(let y=0,_=this.children.length;y<_;y++){const R=this.children[y].getObjectsByProperty(r,l);R.length>0&&(m=m.concat(R))}return m}getWorldPosition(r){return this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(r){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Of,r,CP),r}getWorldScale(r){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Of,SP,r),r}getWorldDirection(r){this.updateWorldMatrix(!0,!1);const l=this.matrixWorld.elements;return r.set(l[8],l[9],l[10]).normalize()}raycast(){}traverse(r){r(this);const l=this.children;for(let m=0,y=l.length;m<y;m++)l[m].traverse(r)}traverseVisible(r){if(this.visible===!1)return;r(this);const l=this.children;for(let m=0,y=l.length;m<y;m++)l[m].traverseVisible(r)}traverseAncestors(r){const l=this.parent;l!==null&&(r(l),l.traverseAncestors(r))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);const l=this.children;for(let m=0,y=l.length;m<y;m++){const _=l[m];(_.matrixWorldAutoUpdate===!0||r===!0)&&_.updateMatrixWorld(r)}}updateWorldMatrix(r,l){const m=this.parent;if(r===!0&&m!==null&&m.matrixWorldAutoUpdate===!0&&m.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),l===!0){const y=this.children;for(let _=0,R=y.length;_<R;_++){const I=y[_];I.matrixWorldAutoUpdate===!0&&I.updateWorldMatrix(!1,!0)}}}toJSON(r){const l=r===void 0||typeof r=="string",m={};l&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},m.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const y={};y.uuid=this.uuid,y.type=this.type,this.name!==""&&(y.name=this.name),this.castShadow===!0&&(y.castShadow=!0),this.receiveShadow===!0&&(y.receiveShadow=!0),this.visible===!1&&(y.visible=!1),this.frustumCulled===!1&&(y.frustumCulled=!1),this.renderOrder!==0&&(y.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(y.userData=this.userData),y.layers=this.layers.mask,y.matrix=this.matrix.toArray(),y.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(y.matrixAutoUpdate=!1),this.isInstancedMesh&&(y.type="InstancedMesh",y.count=this.count,y.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(y.instanceColor=this.instanceColor.toJSON()));function _(I,O){return I[O.uuid]===void 0&&(I[O.uuid]=O.toJSON(r)),O.uuid}if(this.isScene)this.background&&(this.background.isColor?y.background=this.background.toJSON():this.background.isTexture&&(y.background=this.background.toJSON(r).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(y.environment=this.environment.toJSON(r).uuid);else if(this.isMesh||this.isLine||this.isPoints){y.geometry=_(r.geometries,this.geometry);const I=this.geometry.parameters;if(I!==void 0&&I.shapes!==void 0){const O=I.shapes;if(Array.isArray(O))for(let N=0,V=O.length;N<V;N++){const Q=O[N];_(r.shapes,Q)}else _(r.shapes,O)}}if(this.isSkinnedMesh&&(y.bindMode=this.bindMode,y.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(_(r.skeletons,this.skeleton),y.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const I=[];for(let O=0,N=this.material.length;O<N;O++)I.push(_(r.materials,this.material[O]));y.material=I}else y.material=_(r.materials,this.material);if(this.children.length>0){y.children=[];for(let I=0;I<this.children.length;I++)y.children.push(this.children[I].toJSON(r).object)}if(this.animations.length>0){y.animations=[];for(let I=0;I<this.animations.length;I++){const O=this.animations[I];y.animations.push(_(r.animations,O))}}if(l){const I=R(r.geometries),O=R(r.materials),N=R(r.textures),V=R(r.images),Q=R(r.shapes),X=R(r.skeletons),$=R(r.animations),ie=R(r.nodes);I.length>0&&(m.geometries=I),O.length>0&&(m.materials=O),N.length>0&&(m.textures=N),V.length>0&&(m.images=V),Q.length>0&&(m.shapes=Q),X.length>0&&(m.skeletons=X),$.length>0&&(m.animations=$),ie.length>0&&(m.nodes=ie)}return m.object=y,m;function R(I){const O=[];for(const N in I){const V=I[N];delete V.metadata,O.push(V)}return O}}clone(r){return new this.constructor().copy(this,r)}copy(r,l=!0){if(this.name=r.name,this.up.copy(r.up),this.position.copy(r.position),this.rotation.order=r.rotation.order,this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.matrix.copy(r.matrix),this.matrixWorld.copy(r.matrixWorld),this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrixWorldNeedsUpdate=r.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=r.matrixWorldAutoUpdate,this.layers.mask=r.layers.mask,this.visible=r.visible,this.castShadow=r.castShadow,this.receiveShadow=r.receiveShadow,this.frustumCulled=r.frustumCulled,this.renderOrder=r.renderOrder,this.animations=r.animations.slice(),this.userData=JSON.parse(JSON.stringify(r.userData)),l===!0)for(let m=0;m<r.children.length;m++){const y=r.children[m];this.add(y.clone())}return this}}mr.DEFAULT_UP=new je(0,1,0),mr.DEFAULT_MATRIX_AUTO_UPDATE=!0,mr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const da=new je,dl=new je,Qy=new je,fl=new je,wu=new je,Mu=new je,Tw=new je,Xy=new je,Ky=new je,qy=new je;let eg=!1;class bo{constructor(r=new je,l=new je,m=new je){this.a=r,this.b=l,this.c=m}static getNormal(r,l,m,y){y.subVectors(m,l),da.subVectors(r,l),y.cross(da);const _=y.lengthSq();return _>0?y.multiplyScalar(1/Math.sqrt(_)):y.set(0,0,0)}static getBarycoord(r,l,m,y,_){da.subVectors(y,l),dl.subVectors(m,l),Qy.subVectors(r,l);const R=da.dot(da),I=da.dot(dl),O=da.dot(Qy),N=dl.dot(dl),V=dl.dot(Qy),Q=R*N-I*I;if(Q===0)return _.set(-2,-1,-1);const X=1/Q,$=(N*O-I*V)*X,ie=(R*V-I*O)*X;return _.set(1-$-ie,ie,$)}static containsPoint(r,l,m,y){return this.getBarycoord(r,l,m,y,fl),fl.x>=0&&fl.y>=0&&fl.x+fl.y<=1}static getUV(r,l,m,y,_,R,I,O){return eg===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),eg=!0),this.getInterpolation(r,l,m,y,_,R,I,O)}static getInterpolation(r,l,m,y,_,R,I,O){return this.getBarycoord(r,l,m,y,fl),O.setScalar(0),O.addScaledVector(_,fl.x),O.addScaledVector(R,fl.y),O.addScaledVector(I,fl.z),O}static isFrontFacing(r,l,m,y){return da.subVectors(m,l),dl.subVectors(r,l),da.cross(dl).dot(y)<0}set(r,l,m){return this.a.copy(r),this.b.copy(l),this.c.copy(m),this}setFromPointsAndIndices(r,l,m,y){return this.a.copy(r[l]),this.b.copy(r[m]),this.c.copy(r[y]),this}setFromAttributeAndIndices(r,l,m,y){return this.a.fromBufferAttribute(r,l),this.b.fromBufferAttribute(r,m),this.c.fromBufferAttribute(r,y),this}clone(){return new this.constructor().copy(this)}copy(r){return this.a.copy(r.a),this.b.copy(r.b),this.c.copy(r.c),this}getArea(){return da.subVectors(this.c,this.b),dl.subVectors(this.a,this.b),da.cross(dl).length()*.5}getMidpoint(r){return r.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(r){return bo.getNormal(this.a,this.b,this.c,r)}getPlane(r){return r.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(r,l){return bo.getBarycoord(r,this.a,this.b,this.c,l)}getUV(r,l,m,y,_){return eg===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),eg=!0),bo.getInterpolation(r,this.a,this.b,this.c,l,m,y,_)}getInterpolation(r,l,m,y,_){return bo.getInterpolation(r,this.a,this.b,this.c,l,m,y,_)}containsPoint(r){return bo.containsPoint(r,this.a,this.b,this.c)}isFrontFacing(r){return bo.isFrontFacing(this.a,this.b,this.c,r)}intersectsBox(r){return r.intersectsTriangle(this)}closestPointToPoint(r,l){const m=this.a,y=this.b,_=this.c;let R,I;wu.subVectors(y,m),Mu.subVectors(_,m),Xy.subVectors(r,m);const O=wu.dot(Xy),N=Mu.dot(Xy);if(O<=0&&N<=0)return l.copy(m);Ky.subVectors(r,y);const V=wu.dot(Ky),Q=Mu.dot(Ky);if(V>=0&&Q<=V)return l.copy(y);const X=O*Q-V*N;if(X<=0&&O>=0&&V<=0)return R=O/(O-V),l.copy(m).addScaledVector(wu,R);qy.subVectors(r,_);const $=wu.dot(qy),ie=Mu.dot(qy);if(ie>=0&&$<=ie)return l.copy(_);const ue=$*N-O*ie;if(ue<=0&&N>=0&&ie<=0)return I=N/(N-ie),l.copy(m).addScaledVector(Mu,I);const re=V*ie-$*Q;if(re<=0&&Q-V>=0&&$-ie>=0)return Tw.subVectors(_,y),I=(Q-V)/(Q-V+($-ie)),l.copy(y).addScaledVector(Tw,I);const q=1/(re+ue+X);return R=ue*q,I=X*q,l.copy(m).addScaledVector(wu,R).addScaledVector(Mu,I)}equals(r){return r.a.equals(this.a)&&r.b.equals(this.b)&&r.c.equals(this.c)}}const Rw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hc={h:0,s:0,l:0},tg={h:0,s:0,l:0};function Yy(w,r,l){return l<0&&(l+=1),l>1&&(l-=1),l<.16666666666666666?w+(r-w)*6*l:l<.5?r:l<.6666666666666666?w+(r-w)*6*(.6666666666666666-l):w}class Hn{constructor(r,l,m){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(r,l,m)}set(r,l,m){if(l===void 0&&m===void 0){const y=r;y&&y.isColor?this.copy(y):typeof y=="number"?this.setHex(y):typeof y=="string"&&this.setStyle(y)}else this.setRGB(r,l,m);return this}setScalar(r){return this.r=r,this.g=r,this.b=r,this}setHex(r,l=Cr){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,vr.toWorkingColorSpace(this,l),this}setRGB(r,l,m,y=vr.workingColorSpace){return this.r=r,this.g=l,this.b=m,vr.toWorkingColorSpace(this,y),this}setHSL(r,l,m,y=vr.workingColorSpace){if(r=Sf(r,1),l=Nr(l,0,1),m=Nr(m,0,1),l===0)this.r=this.g=this.b=m;else{const _=m<=.5?m*(1+l):m+l-m*l,R=2*m-_;this.r=Yy(R,_,r+.3333333333333333),this.g=Yy(R,_,r),this.b=Yy(R,_,r-.3333333333333333)}return vr.toWorkingColorSpace(this,y),this}setStyle(r,l=Cr){function m(_){_!==void 0&&parseFloat(_)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}let y;if(y=/^(\w+)\(([^\)]*)\)/.exec(r)){let _;const R=y[1],I=y[2];switch(R){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(I))return m(_[4]),this.setRGB(Math.min(255,parseInt(_[1],10))/255,Math.min(255,parseInt(_[2],10))/255,Math.min(255,parseInt(_[3],10))/255,l);if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(I))return m(_[4]),this.setRGB(Math.min(100,parseInt(_[1],10))/100,Math.min(100,parseInt(_[2],10))/100,Math.min(100,parseInt(_[3],10))/100,l);break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(I))return m(_[4]),this.setHSL(parseFloat(_[1])/360,parseFloat(_[2])/100,parseFloat(_[3])/100,l);break;default:console.warn("THREE.Color: Unknown color model "+r)}}else if(y=/^\#([A-Fa-f\d]+)$/.exec(r)){const _=y[1],R=_.length;if(R===3)return this.setRGB(parseInt(_.charAt(0),16)/15,parseInt(_.charAt(1),16)/15,parseInt(_.charAt(2),16)/15,l);if(R===6)return this.setHex(parseInt(_,16),l);console.warn("THREE.Color: Invalid hex color "+r)}else if(r&&r.length>0)return this.setColorName(r,l);return this}setColorName(r,l=Cr){const m=Rw[r.toLowerCase()];return m!==void 0?this.setHex(m,l):console.warn("THREE.Color: Unknown color "+r),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(r){return this.r=r.r,this.g=r.g,this.b=r.b,this}copySRGBToLinear(r){return this.r=ac(r.r),this.g=ac(r.g),this.b=ac(r.b),this}copyLinearToSRGB(r){return this.r=If(r.r),this.g=If(r.g),this.b=If(r.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(r=Cr){return vr.fromWorkingColorSpace(Hs.copy(this),r),Math.round(Nr(Hs.r*255,0,255))*65536+Math.round(Nr(Hs.g*255,0,255))*256+Math.round(Nr(Hs.b*255,0,255))}getHexString(r=Cr){return("000000"+this.getHex(r).toString(16)).slice(-6)}getHSL(r,l=vr.workingColorSpace){vr.fromWorkingColorSpace(Hs.copy(this),l);const m=Hs.r,y=Hs.g,_=Hs.b,R=Math.max(m,y,_),I=Math.min(m,y,_);let O,N;const V=(I+R)/2;if(I===R)O=0,N=0;else{const Q=R-I;switch(N=V<=.5?Q/(R+I):Q/(2-R-I),R){case m:O=(y-_)/Q+(y<_?6:0);break;case y:O=(_-m)/Q+2;break;case _:O=(m-y)/Q+4;break}O/=6}return r.h=O,r.s=N,r.l=V,r}getRGB(r,l=vr.workingColorSpace){return vr.fromWorkingColorSpace(Hs.copy(this),l),r.r=Hs.r,r.g=Hs.g,r.b=Hs.b,r}getStyle(r=Cr){vr.fromWorkingColorSpace(Hs.copy(this),r);const l=Hs.r,m=Hs.g,y=Hs.b;return r!==Cr?`color(${r} ${l.toFixed(3)} ${m.toFixed(3)} ${y.toFixed(3)})`:`rgb(${Math.round(l*255)},${Math.round(m*255)},${Math.round(y*255)})`}offsetHSL(r,l,m){return this.getHSL(hc),this.setHSL(hc.h+r,hc.s+l,hc.l+m)}add(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this}addColors(r,l){return this.r=r.r+l.r,this.g=r.g+l.g,this.b=r.b+l.b,this}addScalar(r){return this.r+=r,this.g+=r,this.b+=r,this}sub(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this}multiply(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this}multiplyScalar(r){return this.r*=r,this.g*=r,this.b*=r,this}lerp(r,l){return this.r+=(r.r-this.r)*l,this.g+=(r.g-this.g)*l,this.b+=(r.b-this.b)*l,this}lerpColors(r,l,m){return this.r=r.r+(l.r-r.r)*m,this.g=r.g+(l.g-r.g)*m,this.b=r.b+(l.b-r.b)*m,this}lerpHSL(r,l){this.getHSL(hc),r.getHSL(tg);const m=ch(hc.h,tg.h,l),y=ch(hc.s,tg.s,l),_=ch(hc.l,tg.l,l);return this.setHSL(m,y,_),this}setFromVector3(r){return this.r=r.x,this.g=r.y,this.b=r.z,this}applyMatrix3(r){const l=this.r,m=this.g,y=this.b,_=r.elements;return this.r=_[0]*l+_[3]*m+_[6]*y,this.g=_[1]*l+_[4]*m+_[7]*y,this.b=_[2]*l+_[5]*m+_[8]*y,this}equals(r){return r.r===this.r&&r.g===this.g&&r.b===this.b}fromArray(r,l=0){return this.r=r[l],this.g=r[l+1],this.b=r[l+2],this}toArray(r=[],l=0){return r[l]=this.r,r[l+1]=this.g,r[l+2]=this.b,r}fromBufferAttribute(r,l){return this.r=r.getX(l),this.g=r.getY(l),this.b=r.getZ(l),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Hs=new Hn;Hn.NAMES=Rw;let IP=0;class js extends to{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:IP++}),this.uuid=no(),this.name="",this.type="Material",this.blending=D,this.side=C,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Pe,this.blendDst=me,this.blendEquation=z,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Hn(0,0,0),this.blendAlpha=0,this.depthFunc=Tn,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Mf,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ol,this.stencilZFail=ol,this.stencilZPass=ol,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(r){this._alphaTest>0!=r>0&&this.version++,this._alphaTest=r}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(r){if(r!==void 0)for(const l in r){const m=r[l];if(m===void 0){console.warn(`THREE.Material: parameter '${l}' has value of undefined.`);continue}const y=this[l];if(y===void 0){console.warn(`THREE.Material: '${l}' is not a property of THREE.${this.type}.`);continue}y&&y.isColor?y.set(m):y&&y.isVector3&&m&&m.isVector3?y.copy(m):this[l]=m}}toJSON(r){const l=r===void 0||typeof r=="string";l&&(r={textures:{},images:{}});const m={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};m.uuid=this.uuid,m.type=this.type,this.name!==""&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),this.roughness!==void 0&&(m.roughness=this.roughness),this.metalness!==void 0&&(m.metalness=this.metalness),this.sheen!==void 0&&(m.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(m.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(m.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(m.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(m.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(m.shininess=this.shininess),this.clearcoat!==void 0&&(m.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(m.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(m.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(m.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(m.iridescenceMap=this.iridescenceMap.toJSON(r).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(m.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(r).uuid),this.anisotropy!==void 0&&(m.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(m.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(m.anisotropyMap=this.anisotropyMap.toJSON(r).uuid),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(r).uuid,m.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(r).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(r).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(r).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(r).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(r).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(m.specularIntensityMap=this.specularIntensityMap.toJSON(r).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(m.specularColorMap=this.specularColorMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(r).uuid,this.combine!==void 0&&(m.combine=this.combine)),this.envMapIntensity!==void 0&&(m.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(m.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(m.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(r).uuid),this.transmission!==void 0&&(m.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(m.transmissionMap=this.transmissionMap.toJSON(r).uuid),this.thickness!==void 0&&(m.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(m.thicknessMap=this.thicknessMap.toJSON(r).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(m.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(m.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(m.size=this.size),this.shadowSide!==null&&(m.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==D&&(m.blending=this.blending),this.side!==C&&(m.side=this.side),this.vertexColors===!0&&(m.vertexColors=!0),this.opacity<1&&(m.opacity=this.opacity),this.transparent===!0&&(m.transparent=!0),this.blendSrc!==Pe&&(m.blendSrc=this.blendSrc),this.blendDst!==me&&(m.blendDst=this.blendDst),this.blendEquation!==z&&(m.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(m.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(m.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(m.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(m.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(m.blendAlpha=this.blendAlpha),this.depthFunc!==Tn&&(m.depthFunc=this.depthFunc),this.depthTest===!1&&(m.depthTest=this.depthTest),this.depthWrite===!1&&(m.depthWrite=this.depthWrite),this.colorWrite===!1&&(m.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(m.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Mf&&(m.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(m.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(m.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ol&&(m.stencilFail=this.stencilFail),this.stencilZFail!==ol&&(m.stencilZFail=this.stencilZFail),this.stencilZPass!==ol&&(m.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(m.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(m.rotation=this.rotation),this.polygonOffset===!0&&(m.polygonOffset=!0),this.polygonOffsetFactor!==0&&(m.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(m.linewidth=this.linewidth),this.dashSize!==void 0&&(m.dashSize=this.dashSize),this.gapSize!==void 0&&(m.gapSize=this.gapSize),this.scale!==void 0&&(m.scale=this.scale),this.dithering===!0&&(m.dithering=!0),this.alphaTest>0&&(m.alphaTest=this.alphaTest),this.alphaHash===!0&&(m.alphaHash=!0),this.alphaToCoverage===!0&&(m.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(m.premultipliedAlpha=!0),this.forceSinglePass===!0&&(m.forceSinglePass=!0),this.wireframe===!0&&(m.wireframe=!0),this.wireframeLinewidth>1&&(m.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(m.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(m.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(m.flatShading=!0),this.visible===!1&&(m.visible=!1),this.toneMapped===!1&&(m.toneMapped=!1),this.fog===!1&&(m.fog=!1),Object.keys(this.userData).length>0&&(m.userData=this.userData);function y(_){const R=[];for(const I in _){const O=_[I];delete O.metadata,R.push(O)}return R}if(l){const _=y(r.textures),R=y(r.images);_.length>0&&(m.textures=_),R.length>0&&(m.images=R)}return m}clone(){return new this.constructor().copy(this)}copy(r){this.name=r.name,this.blending=r.blending,this.side=r.side,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.blendColor.copy(r.blendColor),this.blendAlpha=r.blendAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;const l=r.clippingPlanes;let m=null;if(l!==null){const y=l.length;m=new Array(y);for(let _=0;_!==y;++_)m[_]=l[_].clone()}return this.clippingPlanes=m,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.alphaHash=r.alphaHash,this.alphaToCoverage=r.alphaToCoverage,this.premultipliedAlpha=r.premultipliedAlpha,this.forceSinglePass=r.forceSinglePass,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(r){r===!0&&this.version++}}class uc extends js{constructor(r){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Hn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.fog=r.fog,this}}const pl=BP();function BP(){const w=new ArrayBuffer(4),r=new Float32Array(w),l=new Uint32Array(w),m=new Uint32Array(512),y=new Uint32Array(512);for(let O=0;O<256;++O){const N=O-127;N<-27?(m[O]=0,m[O|256]=32768,y[O]=24,y[O|256]=24):N<-14?(m[O]=1024>>-N-14,m[O|256]=1024>>-N-14|32768,y[O]=-N-1,y[O|256]=-N-1):N<=15?(m[O]=N+15<<10,m[O|256]=N+15<<10|32768,y[O]=13,y[O|256]=13):N<128?(m[O]=31744,m[O|256]=64512,y[O]=24,y[O|256]=24):(m[O]=31744,m[O|256]=64512,y[O]=13,y[O|256]=13)}const _=new Uint32Array(2048),R=new Uint32Array(64),I=new Uint32Array(64);for(let O=1;O<1024;++O){let N=O<<13,V=0;for(;!(N&8388608);)N<<=1,V-=8388608;N&=-8388609,V+=947912704,_[O]=N|V}for(let O=1024;O<2048;++O)_[O]=939524096+(O-1024<<13);for(let O=1;O<31;++O)R[O]=O<<23;R[31]=1199570944,R[32]=2147483648;for(let O=33;O<63;++O)R[O]=2147483648+(O-32<<23);R[63]=3347054592;for(let O=1;O<64;++O)O!==32&&(I[O]=1024);return{floatView:r,uint32View:l,baseTable:m,shiftTable:y,mantissaTable:_,exponentTable:R,offsetTable:I}}function _o(w){Math.abs(w)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),w=Nr(w,-65504,65504),pl.floatView[0]=w;const r=pl.uint32View[0],l=r>>23&511;return pl.baseTable[l]+((r&8388607)>>pl.shiftTable[l])}function Ff(w){const r=w>>10;return pl.uint32View[0]=pl.mantissaTable[pl.offsetTable[r]+(w&1023)]+pl.exponentTable[r],pl.floatView[0]}const LP={toHalfFloat:_o,fromHalfFloat:Ff},is=new je,ng=new en;class Sr{constructor(r,l,m=!1){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=r,this.itemSize=l,this.count=r!==void 0?r.length/l:0,this.normalized=m,this.usage=ah,this.updateRange={offset:0,count:-1},this.gpuType=Ei,this.version=0}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this.gpuType=r.gpuType,this}copyAt(r,l,m){r*=this.itemSize,m*=l.itemSize;for(let y=0,_=this.itemSize;y<_;y++)this.array[r+y]=l.array[m+y];return this}copyArray(r){return this.array.set(r),this}applyMatrix3(r){if(this.itemSize===2)for(let l=0,m=this.count;l<m;l++)ng.fromBufferAttribute(this,l),ng.applyMatrix3(r),this.setXY(l,ng.x,ng.y);else if(this.itemSize===3)for(let l=0,m=this.count;l<m;l++)is.fromBufferAttribute(this,l),is.applyMatrix3(r),this.setXYZ(l,is.x,is.y,is.z);return this}applyMatrix4(r){for(let l=0,m=this.count;l<m;l++)is.fromBufferAttribute(this,l),is.applyMatrix4(r),this.setXYZ(l,is.x,is.y,is.z);return this}applyNormalMatrix(r){for(let l=0,m=this.count;l<m;l++)is.fromBufferAttribute(this,l),is.applyNormalMatrix(r),this.setXYZ(l,is.x,is.y,is.z);return this}transformDirection(r){for(let l=0,m=this.count;l<m;l++)is.fromBufferAttribute(this,l),is.transformDirection(r),this.setXYZ(l,is.x,is.y,is.z);return this}set(r,l=0){return this.array.set(r,l),this}getComponent(r,l){let m=this.array[r*this.itemSize+l];return this.normalized&&(m=zs(m,this.array)),m}setComponent(r,l,m){return this.normalized&&(m=Ni(m,this.array)),this.array[r*this.itemSize+l]=m,this}getX(r){let l=this.array[r*this.itemSize];return this.normalized&&(l=zs(l,this.array)),l}setX(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize]=l,this}getY(r){let l=this.array[r*this.itemSize+1];return this.normalized&&(l=zs(l,this.array)),l}setY(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize+1]=l,this}getZ(r){let l=this.array[r*this.itemSize+2];return this.normalized&&(l=zs(l,this.array)),l}setZ(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize+2]=l,this}getW(r){let l=this.array[r*this.itemSize+3];return this.normalized&&(l=zs(l,this.array)),l}setW(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize+3]=l,this}setXY(r,l,m){return r*=this.itemSize,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array)),this.array[r+0]=l,this.array[r+1]=m,this}setXYZ(r,l,m,y){return r*=this.itemSize,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array),y=Ni(y,this.array)),this.array[r+0]=l,this.array[r+1]=m,this.array[r+2]=y,this}setXYZW(r,l,m,y,_){return r*=this.itemSize,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array),y=Ni(y,this.array),_=Ni(_,this.array)),this.array[r+0]=l,this.array[r+1]=m,this.array[r+2]=y,this.array[r+3]=_,this}onUpload(r){return this.onUploadCallback=r,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const r={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(r.name=this.name),this.usage!==ah&&(r.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(r.updateRange=this.updateRange),r}}class PP extends Sr{constructor(r,l,m){super(new Int8Array(r),l,m)}}class DP extends Sr{constructor(r,l,m){super(new Uint8Array(r),l,m)}}class OP extends Sr{constructor(r,l,m){super(new Uint8ClampedArray(r),l,m)}}class FP extends Sr{constructor(r,l,m){super(new Int16Array(r),l,m)}}class $y extends Sr{constructor(r,l,m){super(new Uint16Array(r),l,m)}}class NP extends Sr{constructor(r,l,m){super(new Int32Array(r),l,m)}}class Jy extends Sr{constructor(r,l,m){super(new Uint32Array(r),l,m)}}class UP extends Sr{constructor(r,l,m){super(new Uint16Array(r),l,m),this.isFloat16BufferAttribute=!0}getX(r){let l=Ff(this.array[r*this.itemSize]);return this.normalized&&(l=zs(l,this.array)),l}setX(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize]=_o(l),this}getY(r){let l=Ff(this.array[r*this.itemSize+1]);return this.normalized&&(l=zs(l,this.array)),l}setY(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize+1]=_o(l),this}getZ(r){let l=Ff(this.array[r*this.itemSize+2]);return this.normalized&&(l=zs(l,this.array)),l}setZ(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize+2]=_o(l),this}getW(r){let l=Ff(this.array[r*this.itemSize+3]);return this.normalized&&(l=zs(l,this.array)),l}setW(r,l){return this.normalized&&(l=Ni(l,this.array)),this.array[r*this.itemSize+3]=_o(l),this}setXY(r,l,m){return r*=this.itemSize,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array)),this.array[r+0]=_o(l),this.array[r+1]=_o(m),this}setXYZ(r,l,m,y){return r*=this.itemSize,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array),y=Ni(y,this.array)),this.array[r+0]=_o(l),this.array[r+1]=_o(m),this.array[r+2]=_o(y),this}setXYZW(r,l,m,y,_){return r*=this.itemSize,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array),y=Ni(y,this.array),_=Ni(_,this.array)),this.array[r+0]=_o(l),this.array[r+1]=_o(m),this.array[r+2]=_o(y),this.array[r+3]=_o(_),this}}class ni extends Sr{constructor(r,l,m){super(new Float32Array(r),l,m)}}class kP extends Sr{constructor(r,l,m){super(new Float64Array(r),l,m)}}let zP=0;const Zo=new _i,Zy=new mr,Cu=new je,Fo=new er,Nf=new er,ws=new je;class Yi extends to{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:zP++}),this.uuid=no(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(r){return Array.isArray(r)?this.index=new(jm(r)?Jy:$y)(r,1):this.index=r,this}getAttribute(r){return this.attributes[r]}setAttribute(r,l){return this.attributes[r]=l,this}deleteAttribute(r){return delete this.attributes[r],this}hasAttribute(r){return this.attributes[r]!==void 0}addGroup(r,l,m=0){this.groups.push({start:r,count:l,materialIndex:m})}clearGroups(){this.groups=[]}setDrawRange(r,l){this.drawRange.start=r,this.drawRange.count=l}applyMatrix4(r){const l=this.attributes.position;l!==void 0&&(l.applyMatrix4(r),l.needsUpdate=!0);const m=this.attributes.normal;if(m!==void 0){const _=new Ui().getNormalMatrix(r);m.applyNormalMatrix(_),m.needsUpdate=!0}const y=this.attributes.tangent;return y!==void 0&&(y.transformDirection(r),y.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(r){return Zo.makeRotationFromQuaternion(r),this.applyMatrix4(Zo),this}rotateX(r){return Zo.makeRotationX(r),this.applyMatrix4(Zo),this}rotateY(r){return Zo.makeRotationY(r),this.applyMatrix4(Zo),this}rotateZ(r){return Zo.makeRotationZ(r),this.applyMatrix4(Zo),this}translate(r,l,m){return Zo.makeTranslation(r,l,m),this.applyMatrix4(Zo),this}scale(r,l,m){return Zo.makeScale(r,l,m),this.applyMatrix4(Zo),this}lookAt(r){return Zy.lookAt(r),Zy.updateMatrix(),this.applyMatrix4(Zy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cu).negate(),this.translate(Cu.x,Cu.y,Cu.z),this}setFromPoints(r){const l=[];for(let m=0,y=r.length;m<y;m++){const _=r[m];l.push(_.x,_.y,_.z||0)}return this.setAttribute("position",new ni(l,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new er);const r=this.attributes.position,l=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new je(-1/0,-1/0,-1/0),new je(1/0,1/0,1/0));return}if(r!==void 0){if(this.boundingBox.setFromBufferAttribute(r),l)for(let m=0,y=l.length;m<y;m++){const _=l[m];Fo.setFromBufferAttribute(_),this.morphTargetsRelative?(ws.addVectors(this.boundingBox.min,Fo.min),this.boundingBox.expandByPoint(ws),ws.addVectors(this.boundingBox.max,Fo.max),this.boundingBox.expandByPoint(ws)):(this.boundingBox.expandByPoint(Fo.min),this.boundingBox.expandByPoint(Fo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Eo);const r=this.attributes.position,l=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new je,1/0);return}if(r){const m=this.boundingSphere.center;if(Fo.setFromBufferAttribute(r),l)for(let _=0,R=l.length;_<R;_++){const I=l[_];Nf.setFromBufferAttribute(I),this.morphTargetsRelative?(ws.addVectors(Fo.min,Nf.min),Fo.expandByPoint(ws),ws.addVectors(Fo.max,Nf.max),Fo.expandByPoint(ws)):(Fo.expandByPoint(Nf.min),Fo.expandByPoint(Nf.max))}Fo.getCenter(m);let y=0;for(let _=0,R=r.count;_<R;_++)ws.fromBufferAttribute(r,_),y=Math.max(y,m.distanceToSquared(ws));if(l)for(let _=0,R=l.length;_<R;_++){const I=l[_],O=this.morphTargetsRelative;for(let N=0,V=I.count;N<V;N++)ws.fromBufferAttribute(I,N),O&&(Cu.fromBufferAttribute(r,N),ws.add(Cu)),y=Math.max(y,m.distanceToSquared(ws))}this.boundingSphere.radius=Math.sqrt(y),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const r=this.index,l=this.attributes;if(r===null||l.position===void 0||l.normal===void 0||l.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const m=r.array,y=l.position.array,_=l.normal.array,R=l.uv.array,I=y.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Sr(new Float32Array(4*I),4));const O=this.getAttribute("tangent").array,N=[],V=[];for(let Xe=0;Xe<I;Xe++)N[Xe]=new je,V[Xe]=new je;const Q=new je,X=new je,$=new je,ie=new en,ue=new en,re=new en,q=new je,Se=new je;function fe(Xe,rt,bt){Q.fromArray(y,Xe*3),X.fromArray(y,rt*3),$.fromArray(y,bt*3),ie.fromArray(R,Xe*2),ue.fromArray(R,rt*2),re.fromArray(R,bt*2),X.sub(Q),$.sub(Q),ue.sub(ie),re.sub(ie);const Gt=1/(ue.x*re.y-re.x*ue.y);isFinite(Gt)&&(q.copy(X).multiplyScalar(re.y).addScaledVector($,-ue.y).multiplyScalar(Gt),Se.copy($).multiplyScalar(ue.x).addScaledVector(X,-re.x).multiplyScalar(Gt),N[Xe].add(q),N[rt].add(q),N[bt].add(q),V[Xe].add(Se),V[rt].add(Se),V[bt].add(Se))}let Me=this.groups;Me.length===0&&(Me=[{start:0,count:m.length}]);for(let Xe=0,rt=Me.length;Xe<rt;++Xe){const bt=Me[Xe],Gt=bt.start,lt=bt.count;for(let wt=Gt,Kt=Gt+lt;wt<Kt;wt+=3)fe(m[wt+0],m[wt+1],m[wt+2])}const ze=new je,He=new je,et=new je,st=new je;function Be(Xe){et.fromArray(_,Xe*3),st.copy(et);const rt=N[Xe];ze.copy(rt),ze.sub(et.multiplyScalar(et.dot(rt))).normalize(),He.crossVectors(st,rt);const Gt=He.dot(V[Xe])<0?-1:1;O[Xe*4]=ze.x,O[Xe*4+1]=ze.y,O[Xe*4+2]=ze.z,O[Xe*4+3]=Gt}for(let Xe=0,rt=Me.length;Xe<rt;++Xe){const bt=Me[Xe],Gt=bt.start,lt=bt.count;for(let wt=Gt,Kt=Gt+lt;wt<Kt;wt+=3)Be(m[wt+0]),Be(m[wt+1]),Be(m[wt+2])}}computeVertexNormals(){const r=this.index,l=this.getAttribute("position");if(l!==void 0){let m=this.getAttribute("normal");if(m===void 0)m=new Sr(new Float32Array(l.count*3),3),this.setAttribute("normal",m);else for(let X=0,$=m.count;X<$;X++)m.setXYZ(X,0,0,0);const y=new je,_=new je,R=new je,I=new je,O=new je,N=new je,V=new je,Q=new je;if(r)for(let X=0,$=r.count;X<$;X+=3){const ie=r.getX(X+0),ue=r.getX(X+1),re=r.getX(X+2);y.fromBufferAttribute(l,ie),_.fromBufferAttribute(l,ue),R.fromBufferAttribute(l,re),V.subVectors(R,_),Q.subVectors(y,_),V.cross(Q),I.fromBufferAttribute(m,ie),O.fromBufferAttribute(m,ue),N.fromBufferAttribute(m,re),I.add(V),O.add(V),N.add(V),m.setXYZ(ie,I.x,I.y,I.z),m.setXYZ(ue,O.x,O.y,O.z),m.setXYZ(re,N.x,N.y,N.z)}else for(let X=0,$=l.count;X<$;X+=3)y.fromBufferAttribute(l,X+0),_.fromBufferAttribute(l,X+1),R.fromBufferAttribute(l,X+2),V.subVectors(R,_),Q.subVectors(y,_),V.cross(Q),m.setXYZ(X+0,V.x,V.y,V.z),m.setXYZ(X+1,V.x,V.y,V.z),m.setXYZ(X+2,V.x,V.y,V.z);this.normalizeNormals(),m.needsUpdate=!0}}normalizeNormals(){const r=this.attributes.normal;for(let l=0,m=r.count;l<m;l++)ws.fromBufferAttribute(r,l),ws.normalize(),r.setXYZ(l,ws.x,ws.y,ws.z)}toNonIndexed(){function r(I,O){const N=I.array,V=I.itemSize,Q=I.normalized,X=new N.constructor(O.length*V);let $=0,ie=0;for(let ue=0,re=O.length;ue<re;ue++){I.isInterleavedBufferAttribute?$=O[ue]*I.data.stride+I.offset:$=O[ue]*V;for(let q=0;q<V;q++)X[ie++]=N[$++]}return new Sr(X,V,Q)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const l=new Yi,m=this.index.array,y=this.attributes;for(const I in y){const O=y[I],N=r(O,m);l.setAttribute(I,N)}const _=this.morphAttributes;for(const I in _){const O=[],N=_[I];for(let V=0,Q=N.length;V<Q;V++){const X=N[V],$=r(X,m);O.push($)}l.morphAttributes[I]=O}l.morphTargetsRelative=this.morphTargetsRelative;const R=this.groups;for(let I=0,O=R.length;I<O;I++){const N=R[I];l.addGroup(N.start,N.count,N.materialIndex)}return l}toJSON(){const r={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){const O=this.parameters;for(const N in O)O[N]!==void 0&&(r[N]=O[N]);return r}r.data={attributes:{}};const l=this.index;l!==null&&(r.data.index={type:l.array.constructor.name,array:Array.prototype.slice.call(l.array)});const m=this.attributes;for(const O in m){const N=m[O];r.data.attributes[O]=N.toJSON(r.data)}const y={};let _=!1;for(const O in this.morphAttributes){const N=this.morphAttributes[O],V=[];for(let Q=0,X=N.length;Q<X;Q++){const $=N[Q];V.push($.toJSON(r.data))}V.length>0&&(y[O]=V,_=!0)}_&&(r.data.morphAttributes=y,r.data.morphTargetsRelative=this.morphTargetsRelative);const R=this.groups;R.length>0&&(r.data.groups=JSON.parse(JSON.stringify(R)));const I=this.boundingSphere;return I!==null&&(r.data.boundingSphere={center:I.center.toArray(),radius:I.radius}),r}clone(){return new this.constructor().copy(this)}copy(r){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const l={};this.name=r.name;const m=r.index;m!==null&&this.setIndex(m.clone(l));const y=r.attributes;for(const N in y){const V=y[N];this.setAttribute(N,V.clone(l))}const _=r.morphAttributes;for(const N in _){const V=[],Q=_[N];for(let X=0,$=Q.length;X<$;X++)V.push(Q[X].clone(l));this.morphAttributes[N]=V}this.morphTargetsRelative=r.morphTargetsRelative;const R=r.groups;for(let N=0,V=R.length;N<V;N++){const Q=R[N];this.addGroup(Q.start,Q.count,Q.materialIndex)}const I=r.boundingBox;I!==null&&(this.boundingBox=I.clone());const O=r.boundingSphere;return O!==null&&(this.boundingSphere=O.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Iw=new _i,dh=new Vs,ig=new Eo,Bw=new je,Su=new je,Tu=new je,Ru=new je,ex=new je,rg=new je,sg=new en,og=new en,ag=new en,Lw=new je,Pw=new je,Dw=new je,lg=new je,cg=new je;class Os extends mr{constructor(r=new Yi,l=new uc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=r,this.material=l,this.updateMorphTargets()}copy(r,l){return super.copy(r,l),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}updateMorphTargets(){const l=this.geometry.morphAttributes,m=Object.keys(l);if(m.length>0){const y=l[m[0]];if(y!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _=0,R=y.length;_<R;_++){const I=y[_].name||String(_);this.morphTargetInfluences.push(0),this.morphTargetDictionary[I]=_}}}}getVertexPosition(r,l){const m=this.geometry,y=m.attributes.position,_=m.morphAttributes.position,R=m.morphTargetsRelative;l.fromBufferAttribute(y,r);const I=this.morphTargetInfluences;if(_&&I){rg.set(0,0,0);for(let O=0,N=_.length;O<N;O++){const V=I[O],Q=_[O];V!==0&&(ex.fromBufferAttribute(Q,r),R?rg.addScaledVector(ex,V):rg.addScaledVector(ex.sub(l),V))}l.add(rg)}return l}raycast(r,l){const m=this.geometry,y=this.material,_=this.matrixWorld;y!==void 0&&(m.boundingSphere===null&&m.computeBoundingSphere(),ig.copy(m.boundingSphere),ig.applyMatrix4(_),dh.copy(r.ray).recast(r.near),!(ig.containsPoint(dh.origin)===!1&&(dh.intersectSphere(ig,Bw)===null||dh.origin.distanceToSquared(Bw)>(r.far-r.near)**2))&&(Iw.copy(_).invert(),dh.copy(r.ray).applyMatrix4(Iw),!(m.boundingBox!==null&&dh.intersectsBox(m.boundingBox)===!1)&&this._computeIntersections(r,l,dh)))}_computeIntersections(r,l,m){let y;const _=this.geometry,R=this.material,I=_.index,O=_.attributes.position,N=_.attributes.uv,V=_.attributes.uv1,Q=_.attributes.normal,X=_.groups,$=_.drawRange;if(I!==null)if(Array.isArray(R))for(let ie=0,ue=X.length;ie<ue;ie++){const re=X[ie],q=R[re.materialIndex],Se=Math.max(re.start,$.start),fe=Math.min(I.count,Math.min(re.start+re.count,$.start+$.count));for(let Me=Se,ze=fe;Me<ze;Me+=3){const He=I.getX(Me),et=I.getX(Me+1),st=I.getX(Me+2);y=hg(this,q,r,m,N,V,Q,He,et,st),y&&(y.faceIndex=Math.floor(Me/3),y.face.materialIndex=re.materialIndex,l.push(y))}}else{const ie=Math.max(0,$.start),ue=Math.min(I.count,$.start+$.count);for(let re=ie,q=ue;re<q;re+=3){const Se=I.getX(re),fe=I.getX(re+1),Me=I.getX(re+2);y=hg(this,R,r,m,N,V,Q,Se,fe,Me),y&&(y.faceIndex=Math.floor(re/3),l.push(y))}}else if(O!==void 0)if(Array.isArray(R))for(let ie=0,ue=X.length;ie<ue;ie++){const re=X[ie],q=R[re.materialIndex],Se=Math.max(re.start,$.start),fe=Math.min(O.count,Math.min(re.start+re.count,$.start+$.count));for(let Me=Se,ze=fe;Me<ze;Me+=3){const He=Me,et=Me+1,st=Me+2;y=hg(this,q,r,m,N,V,Q,He,et,st),y&&(y.faceIndex=Math.floor(Me/3),y.face.materialIndex=re.materialIndex,l.push(y))}}else{const ie=Math.max(0,$.start),ue=Math.min(O.count,$.start+$.count);for(let re=ie,q=ue;re<q;re+=3){const Se=re,fe=re+1,Me=re+2;y=hg(this,R,r,m,N,V,Q,Se,fe,Me),y&&(y.faceIndex=Math.floor(re/3),l.push(y))}}}}function GP(w,r,l,m,y,_,R,I){let O;if(r.side===T?O=m.intersectTriangle(R,_,y,!0,I):O=m.intersectTriangle(y,_,R,r.side===C,I),O===null)return null;cg.copy(I),cg.applyMatrix4(w.matrixWorld);const N=l.ray.origin.distanceTo(cg);return N<l.near||N>l.far?null:{distance:N,point:cg.clone(),object:w}}function hg(w,r,l,m,y,_,R,I,O,N){w.getVertexPosition(I,Su),w.getVertexPosition(O,Tu),w.getVertexPosition(N,Ru);const V=GP(w,r,l,m,Su,Tu,Ru,lg);if(V){y&&(sg.fromBufferAttribute(y,I),og.fromBufferAttribute(y,O),ag.fromBufferAttribute(y,N),V.uv=bo.getInterpolation(lg,Su,Tu,Ru,sg,og,ag,new en)),_&&(sg.fromBufferAttribute(_,I),og.fromBufferAttribute(_,O),ag.fromBufferAttribute(_,N),V.uv1=bo.getInterpolation(lg,Su,Tu,Ru,sg,og,ag,new en),V.uv2=V.uv1),R&&(Lw.fromBufferAttribute(R,I),Pw.fromBufferAttribute(R,O),Dw.fromBufferAttribute(R,N),V.normal=bo.getInterpolation(lg,Su,Tu,Ru,Lw,Pw,Dw,new je),V.normal.dot(m.direction)>0&&V.normal.multiplyScalar(-1));const Q={a:I,b:O,c:N,normal:new je,materialIndex:0};bo.getNormal(Su,Tu,Ru,Q.normal),V.face=Q}return V}class fh extends Yi{constructor(r=1,l=1,m=1,y=1,_=1,R=1){super(),this.type="BoxGeometry",this.parameters={width:r,height:l,depth:m,widthSegments:y,heightSegments:_,depthSegments:R};const I=this;y=Math.floor(y),_=Math.floor(_),R=Math.floor(R);const O=[],N=[],V=[],Q=[];let X=0,$=0;ie("z","y","x",-1,-1,m,l,r,R,_,0),ie("z","y","x",1,-1,m,l,-r,R,_,1),ie("x","z","y",1,1,r,m,l,y,R,2),ie("x","z","y",1,-1,r,m,-l,y,R,3),ie("x","y","z",1,-1,r,l,m,y,_,4),ie("x","y","z",-1,-1,r,l,-m,y,_,5),this.setIndex(O),this.setAttribute("position",new ni(N,3)),this.setAttribute("normal",new ni(V,3)),this.setAttribute("uv",new ni(Q,2));function ie(ue,re,q,Se,fe,Me,ze,He,et,st,Be){const Xe=Me/et,rt=ze/st,bt=Me/2,Gt=ze/2,lt=He/2,wt=et+1,Kt=st+1;let qt=0,ln=0;const Jt=new je;for(let pn=0;pn<Kt;pn++){const dn=pn*rt-Gt;for(let Qn=0;Qn<wt;Qn++){const Qi=Qn*Xe-bt;Jt[ue]=Qi*Se,Jt[re]=dn*fe,Jt[q]=lt,N.push(Jt.x,Jt.y,Jt.z),Jt[ue]=0,Jt[re]=0,Jt[q]=He>0?1:-1,V.push(Jt.x,Jt.y,Jt.z),Q.push(Qn/et),Q.push(1-pn/st),qt+=1}}for(let pn=0;pn<st;pn++)for(let dn=0;dn<et;dn++){const Qn=X+dn+wt*pn,Qi=X+dn+wt*(pn+1),ki=X+(dn+1)+wt*(pn+1),Ht=X+(dn+1)+wt*pn;O.push(Qn,Qi,Ht),O.push(Qi,ki,Ht),ln+=6}I.addGroup($,ln,Be),$+=ln,X+=qt}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new fh(r.width,r.height,r.depth,r.widthSegments,r.heightSegments,r.depthSegments)}}function Iu(w){const r={};for(const l in w){r[l]={};for(const m in w[l]){const y=w[l][m];y&&(y.isColor||y.isMatrix3||y.isMatrix4||y.isVector2||y.isVector3||y.isVector4||y.isTexture||y.isQuaternion)?y.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),r[l][m]=null):r[l][m]=y.clone():Array.isArray(y)?r[l][m]=y.slice():r[l][m]=y}}return r}function ro(w){const r={};for(let l=0;l<w.length;l++){const m=Iu(w[l]);for(const y in m)r[y]=m[y]}return r}function VP(w){const r=[];for(let l=0;l<w.length;l++)r.push(w[l].clone());return r}function Ow(w){return w.getRenderTarget()===null?w.outputColorSpace:vr.workingColorSpace}const Fw={clone:Iu,merge:ro};var HP=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,jP=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ka extends js{constructor(r){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=HP,this.fragmentShader=jP,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&this.setValues(r)}copy(r){return super.copy(r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=Iu(r.uniforms),this.uniformsGroups=VP(r.uniformsGroups),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.fog=r.fog,this.lights=r.lights,this.clipping=r.clipping,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this}toJSON(r){const l=super.toJSON(r);l.glslVersion=this.glslVersion,l.uniforms={};for(const y in this.uniforms){const R=this.uniforms[y].value;R&&R.isTexture?l.uniforms[y]={type:"t",value:R.toJSON(r).uuid}:R&&R.isColor?l.uniforms[y]={type:"c",value:R.getHex()}:R&&R.isVector2?l.uniforms[y]={type:"v2",value:R.toArray()}:R&&R.isVector3?l.uniforms[y]={type:"v3",value:R.toArray()}:R&&R.isVector4?l.uniforms[y]={type:"v4",value:R.toArray()}:R&&R.isMatrix3?l.uniforms[y]={type:"m3",value:R.toArray()}:R&&R.isMatrix4?l.uniforms[y]={type:"m4",value:R.toArray()}:l.uniforms[y]={value:R}}Object.keys(this.defines).length>0&&(l.defines=this.defines),l.vertexShader=this.vertexShader,l.fragmentShader=this.fragmentShader,l.lights=this.lights,l.clipping=this.clipping;const m={};for(const y in this.extensions)this.extensions[y]===!0&&(m[y]=!0);return Object.keys(m).length>0&&(l.extensions=m),l}}class ug extends mr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new _i,this.projectionMatrix=new _i,this.projectionMatrixInverse=new _i,this.coordinateSystem=Yo}copy(r,l){return super.copy(r,l),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this.coordinateSystem=r.coordinateSystem,this}getWorldDirection(r){return super.getWorldDirection(r).negate()}updateMatrixWorld(r){super.updateMatrixWorld(r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(r,l){super.updateWorldMatrix(r,l),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class hs extends ug{constructor(r=50,l=1,m=.1,y=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=r,this.zoom=1,this.near=m,this.far=y,this.focus=10,this.aspect=l,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(r,l){return super.copy(r,l),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this}setFocalLength(r){const l=.5*this.getFilmHeight()/r;this.fov=sc*2*Math.atan(l),this.updateProjectionMatrix()}getFocalLength(){const r=Math.tan(al*.5*this.fov);return .5*this.getFilmHeight()/r}getEffectiveFOV(){return sc*2*Math.atan(Math.tan(al*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(r,l,m,y,_,R){this.aspect=r/l,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=l,this.view.offsetX=m,this.view.offsetY=y,this.view.width=_,this.view.height=R,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=this.near;let l=r*Math.tan(al*.5*this.fov)/this.zoom,m=2*l,y=this.aspect*m,_=-.5*y;const R=this.view;if(this.view!==null&&this.view.enabled){const O=R.fullWidth,N=R.fullHeight;_+=R.offsetX*y/O,l-=R.offsetY*m/N,y*=R.width/O,m*=R.height/N}const I=this.filmOffset;I!==0&&(_+=r*I/this.getFilmWidth()),this.projectionMatrix.makePerspective(_,_+y,l,l-m,r,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const l=super.toJSON(r);return l.object.fov=this.fov,l.object.zoom=this.zoom,l.object.near=this.near,l.object.far=this.far,l.object.focus=this.focus,l.object.aspect=this.aspect,this.view!==null&&(l.object.view=Object.assign({},this.view)),l.object.filmGauge=this.filmGauge,l.object.filmOffset=this.filmOffset,l}}const Bu=-90,Lu=1;class Nw extends mr{constructor(r,l,m){super(),this.type="CubeCamera",this.renderTarget=m,this.coordinateSystem=null,this.activeMipmapLevel=0;const y=new hs(Bu,Lu,r,l);y.layers=this.layers,this.add(y);const _=new hs(Bu,Lu,r,l);_.layers=this.layers,this.add(_);const R=new hs(Bu,Lu,r,l);R.layers=this.layers,this.add(R);const I=new hs(Bu,Lu,r,l);I.layers=this.layers,this.add(I);const O=new hs(Bu,Lu,r,l);O.layers=this.layers,this.add(O);const N=new hs(Bu,Lu,r,l);N.layers=this.layers,this.add(N)}updateCoordinateSystem(){const r=this.coordinateSystem,l=this.children.concat(),[m,y,_,R,I,O]=l;for(const N of l)this.remove(N);if(r===Yo)m.up.set(0,1,0),m.lookAt(1,0,0),y.up.set(0,1,0),y.lookAt(-1,0,0),_.up.set(0,0,-1),_.lookAt(0,1,0),R.up.set(0,0,1),R.lookAt(0,-1,0),I.up.set(0,1,0),I.lookAt(0,0,1),O.up.set(0,1,0),O.lookAt(0,0,-1);else if(r===lh)m.up.set(0,-1,0),m.lookAt(-1,0,0),y.up.set(0,-1,0),y.lookAt(1,0,0),_.up.set(0,0,1),_.lookAt(0,1,0),R.up.set(0,0,-1),R.lookAt(0,-1,0),I.up.set(0,-1,0),I.lookAt(0,0,1),O.up.set(0,-1,0),O.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+r);for(const N of l)this.add(N),N.updateMatrixWorld()}update(r,l){this.parent===null&&this.updateMatrixWorld();const{renderTarget:m,activeMipmapLevel:y}=this;this.coordinateSystem!==r.coordinateSystem&&(this.coordinateSystem=r.coordinateSystem,this.updateCoordinateSystem());const[_,R,I,O,N,V]=this.children,Q=r.getRenderTarget(),X=r.getActiveCubeFace(),$=r.getActiveMipmapLevel(),ie=r.xr.enabled;r.xr.enabled=!1;const ue=m.texture.generateMipmaps;m.texture.generateMipmaps=!1,r.setRenderTarget(m,0,y),r.render(l,_),r.setRenderTarget(m,1,y),r.render(l,R),r.setRenderTarget(m,2,y),r.render(l,I),r.setRenderTarget(m,3,y),r.render(l,O),r.setRenderTarget(m,4,y),r.render(l,N),m.texture.generateMipmaps=ue,r.setRenderTarget(m,5,y),r.render(l,V),r.setRenderTarget(Q,X,$),r.xr.enabled=ie,m.texture.needsPMREMUpdate=!0}}class Uf extends Ir{constructor(r,l,m,y,_,R,I,O,N,V){r=r!==void 0?r:[],l=l!==void 0?l:Qe,super(r,l,m,y,_,R,I,O,N,V),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(r){this.image=r}}class Uw extends yo{constructor(r=1,l={}){super(r,r,l),this.isWebGLCubeRenderTarget=!0;const m={width:r,height:r,depth:1},y=[m,m,m,m,m,m];l.encoding!==void 0&&(uh("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),l.colorSpace=l.encoding===Kr?Cr:qr),this.texture=new Uf(y,l.mapping,l.wrapS,l.wrapT,l.magFilter,l.minFilter,l.format,l.type,l.anisotropy,l.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=l.generateMipmaps!==void 0?l.generateMipmaps:!1,this.texture.minFilter=l.minFilter!==void 0?l.minFilter:Bn}fromEquirectangularTexture(r,l){this.texture.type=l.type,this.texture.colorSpace=l.colorSpace,this.texture.generateMipmaps=l.generateMipmaps,this.texture.minFilter=l.minFilter,this.texture.magFilter=l.magFilter;const m={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},y=new fh(5,5,5),_=new Ka({name:"CubemapFromEquirect",uniforms:Iu(m.uniforms),vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,side:T,blending:F});_.uniforms.tEquirect.value=l;const R=new Os(y,_),I=l.minFilter;return l.minFilter===Fn&&(l.minFilter=Bn),new Nw(1,10,this).update(r,R),l.minFilter=I,R.geometry.dispose(),R.material.dispose(),this}clear(r,l,m,y){const _=r.getRenderTarget();for(let R=0;R<6;R++)r.setRenderTarget(this,R),r.clear(l,m,y);r.setRenderTarget(_)}}const tx=new je,WP=new je,QP=new Ui;class dc{constructor(r=new je(1,0,0),l=0){this.isPlane=!0,this.normal=r,this.constant=l}set(r,l){return this.normal.copy(r),this.constant=l,this}setComponents(r,l,m,y){return this.normal.set(r,l,m),this.constant=y,this}setFromNormalAndCoplanarPoint(r,l){return this.normal.copy(r),this.constant=-l.dot(this.normal),this}setFromCoplanarPoints(r,l,m){const y=tx.subVectors(m,l).cross(WP.subVectors(r,l)).normalize();return this.setFromNormalAndCoplanarPoint(y,r),this}copy(r){return this.normal.copy(r.normal),this.constant=r.constant,this}normalize(){const r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(r){return this.normal.dot(r)+this.constant}distanceToSphere(r){return this.distanceToPoint(r.center)-r.radius}projectPoint(r,l){return l.copy(r).addScaledVector(this.normal,-this.distanceToPoint(r))}intersectLine(r,l){const m=r.delta(tx),y=this.normal.dot(m);if(y===0)return this.distanceToPoint(r.start)===0?l.copy(r.start):null;const _=-(r.start.dot(this.normal)+this.constant)/y;return _<0||_>1?null:l.copy(r.start).addScaledVector(m,_)}intersectsLine(r){const l=this.distanceToPoint(r.start),m=this.distanceToPoint(r.end);return l<0&&m>0||m<0&&l>0}intersectsBox(r){return r.intersectsPlane(this)}intersectsSphere(r){return r.intersectsPlane(this)}coplanarPoint(r){return r.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(r,l){const m=l||QP.getNormalMatrix(r),y=this.coplanarPoint(tx).applyMatrix4(r),_=this.normal.applyMatrix3(m).normalize();return this.constant=-y.dot(_),this}translate(r){return this.constant-=r.dot(this.normal),this}equals(r){return r.normal.equals(this.normal)&&r.constant===this.constant}clone(){return new this.constructor().copy(this)}}const ph=new Eo,dg=new je;class fg{constructor(r=new dc,l=new dc,m=new dc,y=new dc,_=new dc,R=new dc){this.planes=[r,l,m,y,_,R]}set(r,l,m,y,_,R){const I=this.planes;return I[0].copy(r),I[1].copy(l),I[2].copy(m),I[3].copy(y),I[4].copy(_),I[5].copy(R),this}copy(r){const l=this.planes;for(let m=0;m<6;m++)l[m].copy(r.planes[m]);return this}setFromProjectionMatrix(r,l=Yo){const m=this.planes,y=r.elements,_=y[0],R=y[1],I=y[2],O=y[3],N=y[4],V=y[5],Q=y[6],X=y[7],$=y[8],ie=y[9],ue=y[10],re=y[11],q=y[12],Se=y[13],fe=y[14],Me=y[15];if(m[0].setComponents(O-_,X-N,re-$,Me-q).normalize(),m[1].setComponents(O+_,X+N,re+$,Me+q).normalize(),m[2].setComponents(O+R,X+V,re+ie,Me+Se).normalize(),m[3].setComponents(O-R,X-V,re-ie,Me-Se).normalize(),m[4].setComponents(O-I,X-Q,re-ue,Me-fe).normalize(),l===Yo)m[5].setComponents(O+I,X+Q,re+ue,Me+fe).normalize();else if(l===lh)m[5].setComponents(I,Q,ue,fe).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+l);return this}intersectsObject(r){if(r.boundingSphere!==void 0)r.boundingSphere===null&&r.computeBoundingSphere(),ph.copy(r.boundingSphere).applyMatrix4(r.matrixWorld);else{const l=r.geometry;l.boundingSphere===null&&l.computeBoundingSphere(),ph.copy(l.boundingSphere).applyMatrix4(r.matrixWorld)}return this.intersectsSphere(ph)}intersectsSprite(r){return ph.center.set(0,0,0),ph.radius=.7071067811865476,ph.applyMatrix4(r.matrixWorld),this.intersectsSphere(ph)}intersectsSphere(r){const l=this.planes,m=r.center,y=-r.radius;for(let _=0;_<6;_++)if(l[_].distanceToPoint(m)<y)return!1;return!0}intersectsBox(r){const l=this.planes;for(let m=0;m<6;m++){const y=l[m];if(dg.x=y.normal.x>0?r.max.x:r.min.x,dg.y=y.normal.y>0?r.max.y:r.min.y,dg.z=y.normal.z>0?r.max.z:r.min.z,y.distanceToPoint(dg)<0)return!1}return!0}containsPoint(r){const l=this.planes;for(let m=0;m<6;m++)if(l[m].distanceToPoint(r)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function nx(){let w=null,r=!1,l=null,m=null;function y(_,R){l(_,R),m=w.requestAnimationFrame(y)}return{start:function(){r!==!0&&l!==null&&(m=w.requestAnimationFrame(y),r=!0)},stop:function(){w.cancelAnimationFrame(m),r=!1},setAnimationLoop:function(_){l=_},setContext:function(_){w=_}}}function XP(w,r){const l=r.isWebGL2,m=new WeakMap;function y(N,V){const Q=N.array,X=N.usage,$=w.createBuffer();w.bindBuffer(V,$),w.bufferData(V,Q,X),N.onUploadCallback();let ie;if(Q instanceof Float32Array)ie=w.FLOAT;else if(Q instanceof Uint16Array)if(N.isFloat16BufferAttribute)if(l)ie=w.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else ie=w.UNSIGNED_SHORT;else if(Q instanceof Int16Array)ie=w.SHORT;else if(Q instanceof Uint32Array)ie=w.UNSIGNED_INT;else if(Q instanceof Int32Array)ie=w.INT;else if(Q instanceof Int8Array)ie=w.BYTE;else if(Q instanceof Uint8Array)ie=w.UNSIGNED_BYTE;else if(Q instanceof Uint8ClampedArray)ie=w.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+Q);return{buffer:$,type:ie,bytesPerElement:Q.BYTES_PER_ELEMENT,version:N.version}}function _(N,V,Q){const X=V.array,$=V.updateRange;w.bindBuffer(Q,N),$.count===-1?w.bufferSubData(Q,0,X):(l?w.bufferSubData(Q,$.offset*X.BYTES_PER_ELEMENT,X,$.offset,$.count):w.bufferSubData(Q,$.offset*X.BYTES_PER_ELEMENT,X.subarray($.offset,$.offset+$.count)),$.count=-1),V.onUploadCallback()}function R(N){return N.isInterleavedBufferAttribute&&(N=N.data),m.get(N)}function I(N){N.isInterleavedBufferAttribute&&(N=N.data);const V=m.get(N);V&&(w.deleteBuffer(V.buffer),m.delete(N))}function O(N,V){if(N.isGLBufferAttribute){const X=m.get(N);(!X||X.version<N.version)&&m.set(N,{buffer:N.buffer,type:N.type,bytesPerElement:N.elementSize,version:N.version});return}N.isInterleavedBufferAttribute&&(N=N.data);const Q=m.get(N);Q===void 0?m.set(N,y(N,V)):Q.version<N.version&&(_(Q.buffer,N,V),Q.version=N.version)}return{get:R,remove:I,update:O}}class kf extends Yi{constructor(r=1,l=1,m=1,y=1){super(),this.type="PlaneGeometry",this.parameters={width:r,height:l,widthSegments:m,heightSegments:y};const _=r/2,R=l/2,I=Math.floor(m),O=Math.floor(y),N=I+1,V=O+1,Q=r/I,X=l/O,$=[],ie=[],ue=[],re=[];for(let q=0;q<V;q++){const Se=q*X-R;for(let fe=0;fe<N;fe++){const Me=fe*Q-_;ie.push(Me,-Se,0),ue.push(0,0,1),re.push(fe/I),re.push(1-q/O)}}for(let q=0;q<O;q++)for(let Se=0;Se<I;Se++){const fe=Se+N*q,Me=Se+N*(q+1),ze=Se+1+N*(q+1),He=Se+1+N*q;$.push(fe,Me,He),$.push(Me,ze,He)}this.setIndex($),this.setAttribute("position",new ni(ie,3)),this.setAttribute("normal",new ni(ue,3)),this.setAttribute("uv",new ni(re,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new kf(r.width,r.height,r.widthSegments,r.heightSegments)}}var KP=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,qP=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,YP=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,$P=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,JP=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,ZP=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,eD=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,tD=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,nD=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,iD=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,rD=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,sD=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,oD=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,aD=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,lD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,cD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,hD=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,uD=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,dD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,fD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,pD=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,mD=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,gD=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,AD=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,vD=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,yD=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,xD=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ED=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,bD="gl_FragColor = linearToOutputTexel( gl_FragColor );",_D=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,wD=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,MD=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,CD=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,SD=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,TD=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,RD=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,ID=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,BD=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,LD=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,PD=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,DD=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,OD=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,FD=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,ND=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,UD=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,kD=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,zD=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,GD=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,VD=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,HD=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,jD=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,WD=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,QD=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,XD=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,KD=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,qD=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,YD=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,$D=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,JD=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,ZD=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,eO=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,tO=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,nO=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,iO=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,rO=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,sO=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,oO=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,aO=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,lO=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,cO=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,hO=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,uO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,dO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,fO=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,pO=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,mO=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,gO=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,AO=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,vO=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,yO=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,xO=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,EO=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,bO=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,_O=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,wO=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,MO=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,CO=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,SO=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,TO=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,RO=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,IO=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,BO=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,LO=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,PO=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,DO=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,OO=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,FO=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,NO=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,UO=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,kO=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,zO=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,GO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,VO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,HO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,jO=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Wi={alphahash_fragment:KP,alphahash_pars_fragment:qP,alphamap_fragment:YP,alphamap_pars_fragment:$P,alphatest_fragment:JP,alphatest_pars_fragment:ZP,aomap_fragment:eD,aomap_pars_fragment:tD,begin_vertex:nD,beginnormal_vertex:iD,bsdfs:rD,iridescence_fragment:sD,bumpmap_pars_fragment:oD,clipping_planes_fragment:aD,clipping_planes_pars_fragment:lD,clipping_planes_pars_vertex:cD,clipping_planes_vertex:hD,color_fragment:uD,color_pars_fragment:dD,color_pars_vertex:fD,color_vertex:pD,common:mD,cube_uv_reflection_fragment:gD,defaultnormal_vertex:AD,displacementmap_pars_vertex:vD,displacementmap_vertex:yD,emissivemap_fragment:xD,emissivemap_pars_fragment:ED,colorspace_fragment:bD,colorspace_pars_fragment:_D,envmap_fragment:wD,envmap_common_pars_fragment:MD,envmap_pars_fragment:CD,envmap_pars_vertex:SD,envmap_physical_pars_fragment:kD,envmap_vertex:TD,fog_vertex:RD,fog_pars_vertex:ID,fog_fragment:BD,fog_pars_fragment:LD,gradientmap_pars_fragment:PD,lightmap_fragment:DD,lightmap_pars_fragment:OD,lights_lambert_fragment:FD,lights_lambert_pars_fragment:ND,lights_pars_begin:UD,lights_toon_fragment:zD,lights_toon_pars_fragment:GD,lights_phong_fragment:VD,lights_phong_pars_fragment:HD,lights_physical_fragment:jD,lights_physical_pars_fragment:WD,lights_fragment_begin:QD,lights_fragment_maps:XD,lights_fragment_end:KD,logdepthbuf_fragment:qD,logdepthbuf_pars_fragment:YD,logdepthbuf_pars_vertex:$D,logdepthbuf_vertex:JD,map_fragment:ZD,map_pars_fragment:eO,map_particle_fragment:tO,map_particle_pars_fragment:nO,metalnessmap_fragment:iO,metalnessmap_pars_fragment:rO,morphcolor_vertex:sO,morphnormal_vertex:oO,morphtarget_pars_vertex:aO,morphtarget_vertex:lO,normal_fragment_begin:cO,normal_fragment_maps:hO,normal_pars_fragment:uO,normal_pars_vertex:dO,normal_vertex:fO,normalmap_pars_fragment:pO,clearcoat_normal_fragment_begin:mO,clearcoat_normal_fragment_maps:gO,clearcoat_pars_fragment:AO,iridescence_pars_fragment:vO,opaque_fragment:yO,packing:xO,premultiplied_alpha_fragment:EO,project_vertex:bO,dithering_fragment:_O,dithering_pars_fragment:wO,roughnessmap_fragment:MO,roughnessmap_pars_fragment:CO,shadowmap_pars_fragment:SO,shadowmap_pars_vertex:TO,shadowmap_vertex:RO,shadowmask_pars_fragment:IO,skinbase_vertex:BO,skinning_pars_vertex:LO,skinning_vertex:PO,skinnormal_vertex:DO,specularmap_fragment:OO,specularmap_pars_fragment:FO,tonemapping_fragment:NO,tonemapping_pars_fragment:UO,transmission_fragment:kO,transmission_pars_fragment:zO,uv_pars_fragment:GO,uv_pars_vertex:VO,uv_vertex:HO,worldpos_vertex:jO,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},Un={common:{diffuse:{value:new Hn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ui},alphaMap:{value:null},alphaMapTransform:{value:new Ui},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ui}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ui}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ui}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ui},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ui},normalScale:{value:new en(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ui},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ui}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ui}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ui}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Hn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Hn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ui},alphaTest:{value:0},uvTransform:{value:new Ui}},sprite:{diffuse:{value:new Hn(16777215)},opacity:{value:1},center:{value:new en(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ui},alphaMap:{value:null},alphaMapTransform:{value:new Ui},alphaTest:{value:0}}},fa={basic:{uniforms:ro([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.fog]),vertexShader:Wi.meshbasic_vert,fragmentShader:Wi.meshbasic_frag},lambert:{uniforms:ro([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new Hn(0)}}]),vertexShader:Wi.meshlambert_vert,fragmentShader:Wi.meshlambert_frag},phong:{uniforms:ro([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new Hn(0)},specular:{value:new Hn(1118481)},shininess:{value:30}}]),vertexShader:Wi.meshphong_vert,fragmentShader:Wi.meshphong_frag},standard:{uniforms:ro([Un.common,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.roughnessmap,Un.metalnessmap,Un.fog,Un.lights,{emissive:{value:new Hn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag},toon:{uniforms:ro([Un.common,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.gradientmap,Un.fog,Un.lights,{emissive:{value:new Hn(0)}}]),vertexShader:Wi.meshtoon_vert,fragmentShader:Wi.meshtoon_frag},matcap:{uniforms:ro([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,{matcap:{value:null}}]),vertexShader:Wi.meshmatcap_vert,fragmentShader:Wi.meshmatcap_frag},points:{uniforms:ro([Un.points,Un.fog]),vertexShader:Wi.points_vert,fragmentShader:Wi.points_frag},dashed:{uniforms:ro([Un.common,Un.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wi.linedashed_vert,fragmentShader:Wi.linedashed_frag},depth:{uniforms:ro([Un.common,Un.displacementmap]),vertexShader:Wi.depth_vert,fragmentShader:Wi.depth_frag},normal:{uniforms:ro([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,{opacity:{value:1}}]),vertexShader:Wi.meshnormal_vert,fragmentShader:Wi.meshnormal_frag},sprite:{uniforms:ro([Un.sprite,Un.fog]),vertexShader:Wi.sprite_vert,fragmentShader:Wi.sprite_frag},background:{uniforms:{uvTransform:{value:new Ui},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Wi.background_vert,fragmentShader:Wi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Wi.backgroundCube_vert,fragmentShader:Wi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Wi.cube_vert,fragmentShader:Wi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wi.equirect_vert,fragmentShader:Wi.equirect_frag},distanceRGBA:{uniforms:ro([Un.common,Un.displacementmap,{referencePosition:{value:new je},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wi.distanceRGBA_vert,fragmentShader:Wi.distanceRGBA_frag},shadow:{uniforms:ro([Un.lights,Un.fog,{color:{value:new Hn(0)},opacity:{value:1}}]),vertexShader:Wi.shadow_vert,fragmentShader:Wi.shadow_frag}};fa.physical={uniforms:ro([fa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ui},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ui},clearcoatNormalScale:{value:new en(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ui},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ui},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ui},sheen:{value:0},sheenColor:{value:new Hn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ui},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ui},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ui},transmissionSamplerSize:{value:new en},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ui},attenuationDistance:{value:0},attenuationColor:{value:new Hn(0)},specularColor:{value:new Hn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ui},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ui},anisotropyVector:{value:new en},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ui}}]),vertexShader:Wi.meshphysical_vert,fragmentShader:Wi.meshphysical_frag};const pg={r:0,b:0,g:0};function WO(w,r,l,m,y,_,R){const I=new Hn(0);let O=_===!0?0:1,N,V,Q=null,X=0,$=null;function ie(re,q){let Se=!1,fe=q.isScene===!0?q.background:null;fe&&fe.isTexture&&(fe=(q.backgroundBlurriness>0?l:r).get(fe)),fe===null?ue(I,O):fe&&fe.isColor&&(ue(fe,1),Se=!0);const Me=w.xr.getEnvironmentBlendMode();Me==="additive"?m.buffers.color.setClear(0,0,0,1,R):Me==="alpha-blend"&&m.buffers.color.setClear(0,0,0,0,R),(w.autoClear||Se)&&w.clear(w.autoClearColor,w.autoClearDepth,w.autoClearStencil),fe&&(fe.isCubeTexture||fe.mapping===he)?(V===void 0&&(V=new Os(new fh(1e4,1e4,1e4),new Ka({name:"BackgroundCubeMaterial",uniforms:Iu(fa.backgroundCube.uniforms),vertexShader:fa.backgroundCube.vertexShader,fragmentShader:fa.backgroundCube.fragmentShader,side:T,depthTest:!1,depthWrite:!1,fog:!1})),V.geometry.deleteAttribute("normal"),V.geometry.deleteAttribute("uv"),V.onBeforeRender=function(ze,He,et){this.matrixWorld.copyPosition(et.matrixWorld)},Object.defineProperty(V.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),y.update(V)),V.material.uniforms.envMap.value=fe,V.material.uniforms.flipEnvMap.value=fe.isCubeTexture&&fe.isRenderTargetTexture===!1?-1:1,V.material.uniforms.backgroundBlurriness.value=q.backgroundBlurriness,V.material.uniforms.backgroundIntensity.value=q.backgroundIntensity,V.material.toneMapped=vr.getTransfer(fe.colorSpace)!==wr,(Q!==fe||X!==fe.version||$!==w.toneMapping)&&(V.material.needsUpdate=!0,Q=fe,X=fe.version,$=w.toneMapping),V.layers.enableAll(),re.unshift(V,V.geometry,V.material,0,0,null)):fe&&fe.isTexture&&(N===void 0&&(N=new Os(new kf(2,2),new Ka({name:"BackgroundMaterial",uniforms:Iu(fa.background.uniforms),vertexShader:fa.background.vertexShader,fragmentShader:fa.background.fragmentShader,side:C,depthTest:!1,depthWrite:!1,fog:!1})),N.geometry.deleteAttribute("normal"),Object.defineProperty(N.material,"map",{get:function(){return this.uniforms.t2D.value}}),y.update(N)),N.material.uniforms.t2D.value=fe,N.material.uniforms.backgroundIntensity.value=q.backgroundIntensity,N.material.toneMapped=vr.getTransfer(fe.colorSpace)!==wr,fe.matrixAutoUpdate===!0&&fe.updateMatrix(),N.material.uniforms.uvTransform.value.copy(fe.matrix),(Q!==fe||X!==fe.version||$!==w.toneMapping)&&(N.material.needsUpdate=!0,Q=fe,X=fe.version,$=w.toneMapping),N.layers.enableAll(),re.unshift(N,N.geometry,N.material,0,0,null))}function ue(re,q){re.getRGB(pg,Ow(w)),m.buffers.color.setClear(pg.r,pg.g,pg.b,q,R)}return{getClearColor:function(){return I},setClearColor:function(re,q=1){I.set(re),O=q,ue(I,O)},getClearAlpha:function(){return O},setClearAlpha:function(re){O=re,ue(I,O)},render:ie}}function QO(w,r,l,m){const y=w.getParameter(w.MAX_VERTEX_ATTRIBS),_=m.isWebGL2?null:r.get("OES_vertex_array_object"),R=m.isWebGL2||_!==null,I={},O=re(null);let N=O,V=!1;function Q(lt,wt,Kt,qt,ln){let Jt=!1;if(R){const pn=ue(qt,Kt,wt);N!==pn&&(N=pn,$(N.object)),Jt=q(lt,qt,Kt,ln),Jt&&Se(lt,qt,Kt,ln)}else{const pn=wt.wireframe===!0;(N.geometry!==qt.id||N.program!==Kt.id||N.wireframe!==pn)&&(N.geometry=qt.id,N.program=Kt.id,N.wireframe=pn,Jt=!0)}ln!==null&&l.update(ln,w.ELEMENT_ARRAY_BUFFER),(Jt||V)&&(V=!1,st(lt,wt,Kt,qt),ln!==null&&w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,l.get(ln).buffer))}function X(){return m.isWebGL2?w.createVertexArray():_.createVertexArrayOES()}function $(lt){return m.isWebGL2?w.bindVertexArray(lt):_.bindVertexArrayOES(lt)}function ie(lt){return m.isWebGL2?w.deleteVertexArray(lt):_.deleteVertexArrayOES(lt)}function ue(lt,wt,Kt){const qt=Kt.wireframe===!0;let ln=I[lt.id];ln===void 0&&(ln={},I[lt.id]=ln);let Jt=ln[wt.id];Jt===void 0&&(Jt={},ln[wt.id]=Jt);let pn=Jt[qt];return pn===void 0&&(pn=re(X()),Jt[qt]=pn),pn}function re(lt){const wt=[],Kt=[],qt=[];for(let ln=0;ln<y;ln++)wt[ln]=0,Kt[ln]=0,qt[ln]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:wt,enabledAttributes:Kt,attributeDivisors:qt,object:lt,attributes:{},index:null}}function q(lt,wt,Kt,qt){const ln=N.attributes,Jt=wt.attributes;let pn=0;const dn=Kt.getAttributes();for(const Qn in dn)if(dn[Qn].location>=0){const ki=ln[Qn];let Ht=Jt[Qn];if(Ht===void 0&&(Qn==="instanceMatrix"&&lt.instanceMatrix&&(Ht=lt.instanceMatrix),Qn==="instanceColor"&&lt.instanceColor&&(Ht=lt.instanceColor)),ki===void 0||ki.attribute!==Ht||Ht&&ki.data!==Ht.data)return!0;pn++}return N.attributesNum!==pn||N.index!==qt}function Se(lt,wt,Kt,qt){const ln={},Jt=wt.attributes;let pn=0;const dn=Kt.getAttributes();for(const Qn in dn)if(dn[Qn].location>=0){let ki=Jt[Qn];ki===void 0&&(Qn==="instanceMatrix"&&lt.instanceMatrix&&(ki=lt.instanceMatrix),Qn==="instanceColor"&&lt.instanceColor&&(ki=lt.instanceColor));const Ht={};Ht.attribute=ki,ki&&ki.data&&(Ht.data=ki.data),ln[Qn]=Ht,pn++}N.attributes=ln,N.attributesNum=pn,N.index=qt}function fe(){const lt=N.newAttributes;for(let wt=0,Kt=lt.length;wt<Kt;wt++)lt[wt]=0}function Me(lt){ze(lt,0)}function ze(lt,wt){const Kt=N.newAttributes,qt=N.enabledAttributes,ln=N.attributeDivisors;Kt[lt]=1,qt[lt]===0&&(w.enableVertexAttribArray(lt),qt[lt]=1),ln[lt]!==wt&&((m.isWebGL2?w:r.get("ANGLE_instanced_arrays"))[m.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](lt,wt),ln[lt]=wt)}function He(){const lt=N.newAttributes,wt=N.enabledAttributes;for(let Kt=0,qt=wt.length;Kt<qt;Kt++)wt[Kt]!==lt[Kt]&&(w.disableVertexAttribArray(Kt),wt[Kt]=0)}function et(lt,wt,Kt,qt,ln,Jt,pn){pn===!0?w.vertexAttribIPointer(lt,wt,Kt,ln,Jt):w.vertexAttribPointer(lt,wt,Kt,qt,ln,Jt)}function st(lt,wt,Kt,qt){if(m.isWebGL2===!1&&(lt.isInstancedMesh||qt.isInstancedBufferGeometry)&&r.get("ANGLE_instanced_arrays")===null)return;fe();const ln=qt.attributes,Jt=Kt.getAttributes(),pn=wt.defaultAttributeValues;for(const dn in Jt){const Qn=Jt[dn];if(Qn.location>=0){let Qi=ln[dn];if(Qi===void 0&&(dn==="instanceMatrix"&&lt.instanceMatrix&&(Qi=lt.instanceMatrix),dn==="instanceColor"&&lt.instanceColor&&(Qi=lt.instanceColor)),Qi!==void 0){const ki=Qi.normalized,Ht=Qi.itemSize,Sn=l.get(Qi);if(Sn===void 0)continue;const _n=Sn.buffer,wi=Sn.type,ei=Sn.bytesPerElement,ii=m.isWebGL2===!0&&(wi===w.INT||wi===w.UNSIGNED_INT||Qi.gpuType===Jn);if(Qi.isInterleavedBufferAttribute){const yi=Qi.data,nn=yi.stride,ct=Qi.offset;if(yi.isInstancedInterleavedBuffer){for(let hn=0;hn<Qn.locationSize;hn++)ze(Qn.location+hn,yi.meshPerAttribute);lt.isInstancedMesh!==!0&&qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=yi.meshPerAttribute*yi.count)}else for(let hn=0;hn<Qn.locationSize;hn++)Me(Qn.location+hn);w.bindBuffer(w.ARRAY_BUFFER,_n);for(let hn=0;hn<Qn.locationSize;hn++)et(Qn.location+hn,Ht/Qn.locationSize,wi,ki,nn*ei,(ct+Ht/Qn.locationSize*hn)*ei,ii)}else{if(Qi.isInstancedBufferAttribute){for(let yi=0;yi<Qn.locationSize;yi++)ze(Qn.location+yi,Qi.meshPerAttribute);lt.isInstancedMesh!==!0&&qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=Qi.meshPerAttribute*Qi.count)}else for(let yi=0;yi<Qn.locationSize;yi++)Me(Qn.location+yi);w.bindBuffer(w.ARRAY_BUFFER,_n);for(let yi=0;yi<Qn.locationSize;yi++)et(Qn.location+yi,Ht/Qn.locationSize,wi,ki,Ht*ei,Ht/Qn.locationSize*yi*ei,ii)}}else if(pn!==void 0){const ki=pn[dn];if(ki!==void 0)switch(ki.length){case 2:w.vertexAttrib2fv(Qn.location,ki);break;case 3:w.vertexAttrib3fv(Qn.location,ki);break;case 4:w.vertexAttrib4fv(Qn.location,ki);break;default:w.vertexAttrib1fv(Qn.location,ki)}}}}He()}function Be(){bt();for(const lt in I){const wt=I[lt];for(const Kt in wt){const qt=wt[Kt];for(const ln in qt)ie(qt[ln].object),delete qt[ln];delete wt[Kt]}delete I[lt]}}function Xe(lt){if(I[lt.id]===void 0)return;const wt=I[lt.id];for(const Kt in wt){const qt=wt[Kt];for(const ln in qt)ie(qt[ln].object),delete qt[ln];delete wt[Kt]}delete I[lt.id]}function rt(lt){for(const wt in I){const Kt=I[wt];if(Kt[lt.id]===void 0)continue;const qt=Kt[lt.id];for(const ln in qt)ie(qt[ln].object),delete qt[ln];delete Kt[lt.id]}}function bt(){Gt(),V=!0,N!==O&&(N=O,$(N.object))}function Gt(){O.geometry=null,O.program=null,O.wireframe=!1}return{setup:Q,reset:bt,resetDefaultState:Gt,dispose:Be,releaseStatesOfGeometry:Xe,releaseStatesOfProgram:rt,initAttributes:fe,enableAttribute:Me,disableUnusedAttributes:He}}function XO(w,r,l,m){const y=m.isWebGL2;let _;function R(N){_=N}function I(N,V){w.drawArrays(_,N,V),l.update(V,_,1)}function O(N,V,Q){if(Q===0)return;let X,$;if(y)X=w,$="drawArraysInstanced";else if(X=r.get("ANGLE_instanced_arrays"),$="drawArraysInstancedANGLE",X===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}X[$](_,N,V,Q),l.update(V,_,Q)}this.setMode=R,this.render=I,this.renderInstances=O}function KO(w,r,l){let m;function y(){if(m!==void 0)return m;if(r.has("EXT_texture_filter_anisotropic")===!0){const et=r.get("EXT_texture_filter_anisotropic");m=w.getParameter(et.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else m=0;return m}function _(et){if(et==="highp"){if(w.getShaderPrecisionFormat(w.VERTEX_SHADER,w.HIGH_FLOAT).precision>0&&w.getShaderPrecisionFormat(w.FRAGMENT_SHADER,w.HIGH_FLOAT).precision>0)return"highp";et="mediump"}return et==="mediump"&&w.getShaderPrecisionFormat(w.VERTEX_SHADER,w.MEDIUM_FLOAT).precision>0&&w.getShaderPrecisionFormat(w.FRAGMENT_SHADER,w.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const R=typeof WebGL2RenderingContext<"u"&&w.constructor.name==="WebGL2RenderingContext";let I=l.precision!==void 0?l.precision:"highp";const O=_(I);O!==I&&(console.warn("THREE.WebGLRenderer:",I,"not supported, using",O,"instead."),I=O);const N=R||r.has("WEBGL_draw_buffers"),V=l.logarithmicDepthBuffer===!0,Q=w.getParameter(w.MAX_TEXTURE_IMAGE_UNITS),X=w.getParameter(w.MAX_VERTEX_TEXTURE_IMAGE_UNITS),$=w.getParameter(w.MAX_TEXTURE_SIZE),ie=w.getParameter(w.MAX_CUBE_MAP_TEXTURE_SIZE),ue=w.getParameter(w.MAX_VERTEX_ATTRIBS),re=w.getParameter(w.MAX_VERTEX_UNIFORM_VECTORS),q=w.getParameter(w.MAX_VARYING_VECTORS),Se=w.getParameter(w.MAX_FRAGMENT_UNIFORM_VECTORS),fe=X>0,Me=R||r.has("OES_texture_float"),ze=fe&&Me,He=R?w.getParameter(w.MAX_SAMPLES):0;return{isWebGL2:R,drawBuffers:N,getMaxAnisotropy:y,getMaxPrecision:_,precision:I,logarithmicDepthBuffer:V,maxTextures:Q,maxVertexTextures:X,maxTextureSize:$,maxCubemapSize:ie,maxAttributes:ue,maxVertexUniforms:re,maxVaryings:q,maxFragmentUniforms:Se,vertexTextures:fe,floatFragmentTextures:Me,floatVertexTextures:ze,maxSamples:He}}function qO(w){const r=this;let l=null,m=0,y=!1,_=!1;const R=new dc,I=new Ui,O={value:null,needsUpdate:!1};this.uniform=O,this.numPlanes=0,this.numIntersection=0,this.init=function(Q,X){const $=Q.length!==0||X||m!==0||y;return y=X,m=Q.length,$},this.beginShadows=function(){_=!0,V(null)},this.endShadows=function(){_=!1},this.setGlobalState=function(Q,X){l=V(Q,X,0)},this.setState=function(Q,X,$){const ie=Q.clippingPlanes,ue=Q.clipIntersection,re=Q.clipShadows,q=w.get(Q);if(!y||ie===null||ie.length===0||_&&!re)_?V(null):N();else{const Se=_?0:m,fe=Se*4;let Me=q.clippingState||null;O.value=Me,Me=V(ie,X,fe,$);for(let ze=0;ze!==fe;++ze)Me[ze]=l[ze];q.clippingState=Me,this.numIntersection=ue?this.numPlanes:0,this.numPlanes+=Se}};function N(){O.value!==l&&(O.value=l,O.needsUpdate=m>0),r.numPlanes=m,r.numIntersection=0}function V(Q,X,$,ie){const ue=Q!==null?Q.length:0;let re=null;if(ue!==0){if(re=O.value,ie!==!0||re===null){const q=$+ue*4,Se=X.matrixWorldInverse;I.getNormalMatrix(Se),(re===null||re.length<q)&&(re=new Float32Array(q));for(let fe=0,Me=$;fe!==ue;++fe,Me+=4)R.copy(Q[fe]).applyMatrix4(Se,I),R.normal.toArray(re,Me),re[Me+3]=R.constant}O.value=re,O.needsUpdate=!0}return r.numPlanes=ue,r.numIntersection=0,re}}function YO(w){let r=new WeakMap;function l(R,I){return I===W?R.mapping=Qe:I===k&&(R.mapping=ne),R}function m(R){if(R&&R.isTexture&&R.isRenderTargetTexture===!1){const I=R.mapping;if(I===W||I===k)if(r.has(R)){const O=r.get(R).texture;return l(O,R.mapping)}else{const O=R.image;if(O&&O.height>0){const N=new Uw(O.height/2);return N.fromEquirectangularTexture(w,R),r.set(R,N),R.addEventListener("dispose",y),l(N.texture,R.mapping)}else return null}}return R}function y(R){const I=R.target;I.removeEventListener("dispose",y);const O=r.get(I);O!==void 0&&(r.delete(I),O.dispose())}function _(){r=new WeakMap}return{get:m,dispose:_}}class mg extends ug{constructor(r=-1,l=1,m=1,y=-1,_=.1,R=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r,this.right=l,this.top=m,this.bottom=y,this.near=_,this.far=R,this.updateProjectionMatrix()}copy(r,l){return super.copy(r,l),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this}setViewOffset(r,l,m,y,_,R){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=l,this.view.offsetX=m,this.view.offsetY=y,this.view.width=_,this.view.height=R,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=(this.right-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),m=(this.right+this.left)/2,y=(this.top+this.bottom)/2;let _=m-r,R=m+r,I=y+l,O=y-l;if(this.view!==null&&this.view.enabled){const N=(this.right-this.left)/this.view.fullWidth/this.zoom,V=(this.top-this.bottom)/this.view.fullHeight/this.zoom;_+=N*this.view.offsetX,R=_+N*this.view.width,I-=V*this.view.offsetY,O=I-V*this.view.height}this.projectionMatrix.makeOrthographic(_,R,I,O,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const l=super.toJSON(r);return l.object.zoom=this.zoom,l.object.left=this.left,l.object.right=this.right,l.object.top=this.top,l.object.bottom=this.bottom,l.object.near=this.near,l.object.far=this.far,this.view!==null&&(l.object.view=Object.assign({},this.view)),l}}const Pu=4,kw=[.125,.215,.35,.446,.526,.582],mh=20,ix=new mg,zw=new Hn;let rx=null,sx=0,ox=0;const gh=(1+Math.sqrt(5))/2,Du=1/gh,Gw=[new je(1,1,1),new je(-1,1,1),new je(1,1,-1),new je(-1,1,-1),new je(0,gh,Du),new je(0,gh,-Du),new je(Du,0,gh),new je(-Du,0,gh),new je(gh,Du,0),new je(-gh,Du,0)];class ax{constructor(r){this._renderer=r,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(r,l=0,m=.1,y=100){rx=this._renderer.getRenderTarget(),sx=this._renderer.getActiveCubeFace(),ox=this._renderer.getActiveMipmapLevel(),this._setSize(256);const _=this._allocateTargets();return _.depthBuffer=!0,this._sceneToCubeUV(r,m,y,_),l>0&&this._blur(_,0,0,l),this._applyPMREM(_),this._cleanup(_),_}fromEquirectangular(r,l=null){return this._fromTexture(r,l)}fromCubemap(r,l=null){return this._fromTexture(r,l)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=jw(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Hw(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(r){this._lodMax=Math.floor(Math.log2(r)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let r=0;r<this._lodPlanes.length;r++)this._lodPlanes[r].dispose()}_cleanup(r){this._renderer.setRenderTarget(rx,sx,ox),r.scissorTest=!1,gg(r,0,0,r.width,r.height)}_fromTexture(r,l){r.mapping===Qe||r.mapping===ne?this._setSize(r.image.length===0?16:r.image[0].width||r.image[0].image.width):this._setSize(r.image.width/4),rx=this._renderer.getRenderTarget(),sx=this._renderer.getActiveCubeFace(),ox=this._renderer.getActiveMipmapLevel();const m=l||this._allocateTargets();return this._textureToCubeUV(r,m),this._applyPMREM(m),this._cleanup(m),m}_allocateTargets(){const r=3*Math.max(this._cubeSize,112),l=4*this._cubeSize,m={magFilter:Bn,minFilter:Bn,generateMipmaps:!1,type:Fi,format:ht,colorSpace:pr,depthBuffer:!1},y=Vw(r,l,m);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==r||this._pingPongRenderTarget.height!==l){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Vw(r,l,m);const{_lodMax:_}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=$O(_)),this._blurMaterial=JO(_,r,l)}return y}_compileMaterial(r){const l=new Os(this._lodPlanes[0],r);this._renderer.compile(l,ix)}_sceneToCubeUV(r,l,m,y){const I=new hs(90,1,l,m),O=[1,-1,1,1,1,1],N=[1,1,1,-1,-1,-1],V=this._renderer,Q=V.autoClear,X=V.toneMapping;V.getClearColor(zw),V.toneMapping=fn,V.autoClear=!1;const $=new uc({name:"PMREM.Background",side:T,depthWrite:!1,depthTest:!1}),ie=new Os(new fh,$);let ue=!1;const re=r.background;re?re.isColor&&($.color.copy(re),r.background=null,ue=!0):($.color.copy(zw),ue=!0);for(let q=0;q<6;q++){const Se=q%3;Se===0?(I.up.set(0,O[q],0),I.lookAt(N[q],0,0)):Se===1?(I.up.set(0,0,O[q]),I.lookAt(0,N[q],0)):(I.up.set(0,O[q],0),I.lookAt(0,0,N[q]));const fe=this._cubeSize;gg(y,Se*fe,q>2?fe:0,fe,fe),V.setRenderTarget(y),ue&&V.render(ie,I),V.render(r,I)}ie.geometry.dispose(),ie.material.dispose(),V.toneMapping=X,V.autoClear=Q,r.background=re}_textureToCubeUV(r,l){const m=this._renderer,y=r.mapping===Qe||r.mapping===ne;y?(this._cubemapMaterial===null&&(this._cubemapMaterial=jw()),this._cubemapMaterial.uniforms.flipEnvMap.value=r.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Hw());const _=y?this._cubemapMaterial:this._equirectMaterial,R=new Os(this._lodPlanes[0],_),I=_.uniforms;I.envMap.value=r;const O=this._cubeSize;gg(l,0,0,3*O,2*O),m.setRenderTarget(l),m.render(R,ix)}_applyPMREM(r){const l=this._renderer,m=l.autoClear;l.autoClear=!1;for(let y=1;y<this._lodPlanes.length;y++){const _=Math.sqrt(this._sigmas[y]*this._sigmas[y]-this._sigmas[y-1]*this._sigmas[y-1]),R=Gw[(y-1)%Gw.length];this._blur(r,y-1,y,_,R)}l.autoClear=m}_blur(r,l,m,y,_){const R=this._pingPongRenderTarget;this._halfBlur(r,R,l,m,y,"latitudinal",_),this._halfBlur(R,r,m,m,y,"longitudinal",_)}_halfBlur(r,l,m,y,_,R,I){const O=this._renderer,N=this._blurMaterial;R!=="latitudinal"&&R!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const V=3,Q=new Os(this._lodPlanes[y],N),X=N.uniforms,$=this._sizeLods[m]-1,ie=isFinite(_)?Math.PI/(2*$):2*Math.PI/(2*mh-1),ue=_/ie,re=isFinite(_)?1+Math.floor(V*ue):mh;re>mh&&console.warn(`sigmaRadians, ${_}, is too large and will clip, as it requested ${re} samples when the maximum is set to ${mh}`);const q=[];let Se=0;for(let et=0;et<mh;++et){const st=et/ue,Be=Math.exp(-st*st/2);q.push(Be),et===0?Se+=Be:et<re&&(Se+=2*Be)}for(let et=0;et<q.length;et++)q[et]=q[et]/Se;X.envMap.value=r.texture,X.samples.value=re,X.weights.value=q,X.latitudinal.value=R==="latitudinal",I&&(X.poleAxis.value=I);const{_lodMax:fe}=this;X.dTheta.value=ie,X.mipInt.value=fe-m;const Me=this._sizeLods[y],ze=3*Me*(y>fe-Pu?y-fe+Pu:0),He=4*(this._cubeSize-Me);gg(l,ze,He,3*Me,2*Me),O.setRenderTarget(l),O.render(Q,ix)}}function $O(w){const r=[],l=[],m=[];let y=w;const _=w-Pu+1+kw.length;for(let R=0;R<_;R++){const I=Math.pow(2,y);l.push(I);let O=1/I;R>w-Pu?O=kw[R-w+Pu-1]:R===0&&(O=0),m.push(O);const N=1/(I-2),V=-N,Q=1+N,X=[V,V,Q,V,Q,Q,V,V,Q,Q,V,Q],$=6,ie=6,ue=3,re=2,q=1,Se=new Float32Array(ue*ie*$),fe=new Float32Array(re*ie*$),Me=new Float32Array(q*ie*$);for(let He=0;He<$;He++){const et=He%3*2/3-1,st=He>2?0:-1,Be=[et,st,0,et+2/3,st,0,et+2/3,st+1,0,et,st,0,et+2/3,st+1,0,et,st+1,0];Se.set(Be,ue*ie*He),fe.set(X,re*ie*He);const Xe=[He,He,He,He,He,He];Me.set(Xe,q*ie*He)}const ze=new Yi;ze.setAttribute("position",new Sr(Se,ue)),ze.setAttribute("uv",new Sr(fe,re)),ze.setAttribute("faceIndex",new Sr(Me,q)),r.push(ze),y>Pu&&y--}return{lodPlanes:r,sizeLods:l,sigmas:m}}function Vw(w,r,l){const m=new yo(w,r,l);return m.texture.mapping=he,m.texture.name="PMREM.cubeUv",m.scissorTest=!0,m}function gg(w,r,l,m,y){w.viewport.set(r,l,m,y),w.scissor.set(r,l,m,y)}function JO(w,r,l){const m=new Float32Array(mh),y=new je(0,1,0);return new Ka({name:"SphericalGaussianBlur",defines:{n:mh,CUBEUV_TEXEL_WIDTH:1/r,CUBEUV_TEXEL_HEIGHT:1/l,CUBEUV_MAX_MIP:`${w}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:m},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:y}},vertexShader:lx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:F,depthTest:!1,depthWrite:!1})}function Hw(){return new Ka({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:lx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:F,depthTest:!1,depthWrite:!1})}function jw(){return new Ka({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:lx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:F,depthTest:!1,depthWrite:!1})}function lx(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function ZO(w){let r=new WeakMap,l=null;function m(I){if(I&&I.isTexture){const O=I.mapping,N=O===W||O===k,V=O===Qe||O===ne;if(N||V)if(I.isRenderTargetTexture&&I.needsPMREMUpdate===!0){I.needsPMREMUpdate=!1;let Q=r.get(I);return l===null&&(l=new ax(w)),Q=N?l.fromEquirectangular(I,Q):l.fromCubemap(I,Q),r.set(I,Q),Q.texture}else{if(r.has(I))return r.get(I).texture;{const Q=I.image;if(N&&Q&&Q.height>0||V&&Q&&y(Q)){l===null&&(l=new ax(w));const X=N?l.fromEquirectangular(I):l.fromCubemap(I);return r.set(I,X),I.addEventListener("dispose",_),X.texture}else return null}}}return I}function y(I){let O=0;const N=6;for(let V=0;V<N;V++)I[V]!==void 0&&O++;return O===N}function _(I){const O=I.target;O.removeEventListener("dispose",_);const N=r.get(O);N!==void 0&&(r.delete(O),N.dispose())}function R(){r=new WeakMap,l!==null&&(l.dispose(),l=null)}return{get:m,dispose:R}}function e4(w){const r={};function l(m){if(r[m]!==void 0)return r[m];let y;switch(m){case"WEBGL_depth_texture":y=w.getExtension("WEBGL_depth_texture")||w.getExtension("MOZ_WEBGL_depth_texture")||w.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":y=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":y=w.getExtension("WEBGL_compressed_texture_s3tc")||w.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":y=w.getExtension("WEBGL_compressed_texture_pvrtc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:y=w.getExtension(m)}return r[m]=y,y}return{has:function(m){return l(m)!==null},init:function(m){m.isWebGL2?l("EXT_color_buffer_float"):(l("WEBGL_depth_texture"),l("OES_texture_float"),l("OES_texture_half_float"),l("OES_texture_half_float_linear"),l("OES_standard_derivatives"),l("OES_element_index_uint"),l("OES_vertex_array_object"),l("ANGLE_instanced_arrays")),l("OES_texture_float_linear"),l("EXT_color_buffer_half_float"),l("WEBGL_multisampled_render_to_texture")},get:function(m){const y=l(m);return y===null&&console.warn("THREE.WebGLRenderer: "+m+" extension not supported."),y}}}function t4(w,r,l,m){const y={},_=new WeakMap;function R(Q){const X=Q.target;X.index!==null&&r.remove(X.index);for(const ie in X.attributes)r.remove(X.attributes[ie]);for(const ie in X.morphAttributes){const ue=X.morphAttributes[ie];for(let re=0,q=ue.length;re<q;re++)r.remove(ue[re])}X.removeEventListener("dispose",R),delete y[X.id];const $=_.get(X);$&&(r.remove($),_.delete(X)),m.releaseStatesOfGeometry(X),X.isInstancedBufferGeometry===!0&&delete X._maxInstanceCount,l.memory.geometries--}function I(Q,X){return y[X.id]===!0||(X.addEventListener("dispose",R),y[X.id]=!0,l.memory.geometries++),X}function O(Q){const X=Q.attributes;for(const ie in X)r.update(X[ie],w.ARRAY_BUFFER);const $=Q.morphAttributes;for(const ie in $){const ue=$[ie];for(let re=0,q=ue.length;re<q;re++)r.update(ue[re],w.ARRAY_BUFFER)}}function N(Q){const X=[],$=Q.index,ie=Q.attributes.position;let ue=0;if($!==null){const Se=$.array;ue=$.version;for(let fe=0,Me=Se.length;fe<Me;fe+=3){const ze=Se[fe+0],He=Se[fe+1],et=Se[fe+2];X.push(ze,He,He,et,et,ze)}}else if(ie!==void 0){const Se=ie.array;ue=ie.version;for(let fe=0,Me=Se.length/3-1;fe<Me;fe+=3){const ze=fe+0,He=fe+1,et=fe+2;X.push(ze,He,He,et,et,ze)}}else return;const re=new(jm(X)?Jy:$y)(X,1);re.version=ue;const q=_.get(Q);q&&r.remove(q),_.set(Q,re)}function V(Q){const X=_.get(Q);if(X){const $=Q.index;$!==null&&X.version<$.version&&N(Q)}else N(Q);return _.get(Q)}return{get:I,update:O,getWireframeAttribute:V}}function n4(w,r,l,m){const y=m.isWebGL2;let _;function R(X){_=X}let I,O;function N(X){I=X.type,O=X.bytesPerElement}function V(X,$){w.drawElements(_,$,I,X*O),l.update($,_,1)}function Q(X,$,ie){if(ie===0)return;let ue,re;if(y)ue=w,re="drawElementsInstanced";else if(ue=r.get("ANGLE_instanced_arrays"),re="drawElementsInstancedANGLE",ue===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}ue[re](_,$,I,X*O,ie),l.update($,_,ie)}this.setMode=R,this.setIndex=N,this.render=V,this.renderInstances=Q}function i4(w){const r={geometries:0,textures:0},l={frame:0,calls:0,triangles:0,points:0,lines:0};function m(_,R,I){switch(l.calls++,R){case w.TRIANGLES:l.triangles+=I*(_/3);break;case w.LINES:l.lines+=I*(_/2);break;case w.LINE_STRIP:l.lines+=I*(_-1);break;case w.LINE_LOOP:l.lines+=I*_;break;case w.POINTS:l.points+=I*_;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",R);break}}function y(){l.calls=0,l.triangles=0,l.points=0,l.lines=0}return{memory:r,render:l,programs:null,autoReset:!0,reset:y,update:m}}function r4(w,r){return w[0]-r[0]}function s4(w,r){return Math.abs(r[1])-Math.abs(w[1])}function o4(w,r,l){const m={},y=new Float32Array(8),_=new WeakMap,R=new ur,I=[];for(let N=0;N<8;N++)I[N]=[N,0];function O(N,V,Q){const X=N.morphTargetInfluences;if(r.isWebGL2===!0){const $=V.morphAttributes.position||V.morphAttributes.normal||V.morphAttributes.color,ie=$!==void 0?$.length:0;let ue=_.get(V);if(ue===void 0||ue.count!==ie){let Se=function(){Gt.dispose(),_.delete(V),V.removeEventListener("dispose",Se)};ue!==void 0&&ue.texture.dispose();const fe=V.morphAttributes.position!==void 0,Me=V.morphAttributes.normal!==void 0,ze=V.morphAttributes.color!==void 0,He=V.morphAttributes.position||[],et=V.morphAttributes.normal||[],st=V.morphAttributes.color||[];let Be=0;fe===!0&&(Be=1),Me===!0&&(Be=2),ze===!0&&(Be=3);let Xe=V.attributes.position.count*Be,rt=1;Xe>r.maxTextureSize&&(rt=Math.ceil(Xe/r.maxTextureSize),Xe=r.maxTextureSize);const bt=new Float32Array(Xe*rt*4*ie),Gt=new yu(bt,Xe,rt,ie);Gt.type=Ei,Gt.needsUpdate=!0;const lt=Be*4;for(let wt=0;wt<ie;wt++){const Kt=He[wt],qt=et[wt],ln=st[wt],Jt=Xe*rt*4*wt;for(let pn=0;pn<Kt.count;pn++){const dn=pn*lt;fe===!0&&(R.fromBufferAttribute(Kt,pn),bt[Jt+dn+0]=R.x,bt[Jt+dn+1]=R.y,bt[Jt+dn+2]=R.z,bt[Jt+dn+3]=0),Me===!0&&(R.fromBufferAttribute(qt,pn),bt[Jt+dn+4]=R.x,bt[Jt+dn+5]=R.y,bt[Jt+dn+6]=R.z,bt[Jt+dn+7]=0),ze===!0&&(R.fromBufferAttribute(ln,pn),bt[Jt+dn+8]=R.x,bt[Jt+dn+9]=R.y,bt[Jt+dn+10]=R.z,bt[Jt+dn+11]=ln.itemSize===4?R.w:1)}}ue={count:ie,texture:Gt,size:new en(Xe,rt)},_.set(V,ue),V.addEventListener("dispose",Se)}let re=0;for(let Se=0;Se<X.length;Se++)re+=X[Se];const q=V.morphTargetsRelative?1:1-re;Q.getUniforms().setValue(w,"morphTargetBaseInfluence",q),Q.getUniforms().setValue(w,"morphTargetInfluences",X),Q.getUniforms().setValue(w,"morphTargetsTexture",ue.texture,l),Q.getUniforms().setValue(w,"morphTargetsTextureSize",ue.size)}else{const $=X===void 0?0:X.length;let ie=m[V.id];if(ie===void 0||ie.length!==$){ie=[];for(let fe=0;fe<$;fe++)ie[fe]=[fe,0];m[V.id]=ie}for(let fe=0;fe<$;fe++){const Me=ie[fe];Me[0]=fe,Me[1]=X[fe]}ie.sort(s4);for(let fe=0;fe<8;fe++)fe<$&&ie[fe][1]?(I[fe][0]=ie[fe][0],I[fe][1]=ie[fe][1]):(I[fe][0]=Number.MAX_SAFE_INTEGER,I[fe][1]=0);I.sort(r4);const ue=V.morphAttributes.position,re=V.morphAttributes.normal;let q=0;for(let fe=0;fe<8;fe++){const Me=I[fe],ze=Me[0],He=Me[1];ze!==Number.MAX_SAFE_INTEGER&&He?(ue&&V.getAttribute("morphTarget"+fe)!==ue[ze]&&V.setAttribute("morphTarget"+fe,ue[ze]),re&&V.getAttribute("morphNormal"+fe)!==re[ze]&&V.setAttribute("morphNormal"+fe,re[ze]),y[fe]=He,q+=He):(ue&&V.hasAttribute("morphTarget"+fe)===!0&&V.deleteAttribute("morphTarget"+fe),re&&V.hasAttribute("morphNormal"+fe)===!0&&V.deleteAttribute("morphNormal"+fe),y[fe]=0)}const Se=V.morphTargetsRelative?1:1-q;Q.getUniforms().setValue(w,"morphTargetBaseInfluence",Se),Q.getUniforms().setValue(w,"morphTargetInfluences",y)}}return{update:O}}class a4{constructor(r,l,m){if(this.renderer=r,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=m,this.extensions=l,this.available=this.extensions.has("OCULUS_multiview"),this.available){const _=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(_.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var y=0;y<this.maxNumViews;y++)this.mat4[y]=new _i,this.mat3[y]=new Ui}}getCameraArray(r){return r.isArrayCamera?r.cameras:(this.cameraArray[0]=r,this.cameraArray)}updateCameraProjectionMatricesUniform(r,l){for(var m=this.getCameraArray(r),y=0;y<m.length;y++)this.mat4[y].copy(m[y].projectionMatrix);l.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(r,l){for(var m=this.getCameraArray(r),y=0;y<m.length;y++)this.mat4[y].copy(m[y].matrixWorldInverse);l.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(r,l,m){for(var y=this.getCameraArray(l),_=0;_<y.length;_++)this.mat4[_].multiplyMatrices(y[_].matrixWorldInverse,r.matrixWorld),this.mat3[_].getNormalMatrix(this.mat4[_]);m.setValue(this.gl,"modelViewMatrices",this.mat4),m.setValue(this.gl,"normalMatrices",this.mat3)}}function l4(w,r,l,m){let y=new WeakMap;function _(O){const N=m.render.frame,V=O.geometry,Q=r.get(O,V);if(y.get(Q)!==N&&(r.update(Q),y.set(Q,N)),O.isInstancedMesh&&(O.hasEventListener("dispose",I)===!1&&O.addEventListener("dispose",I),y.get(O)!==N&&(l.update(O.instanceMatrix,w.ARRAY_BUFFER),O.instanceColor!==null&&l.update(O.instanceColor,w.ARRAY_BUFFER),y.set(O,N))),O.isSkinnedMesh){const X=O.skeleton;y.get(X)!==N&&(X.update(),y.set(X,N))}return Q}function R(){y=new WeakMap}function I(O){const N=O.target;N.removeEventListener("dispose",I),l.remove(N.instanceMatrix),N.instanceColor!==null&&l.remove(N.instanceColor)}return{update:_,dispose:R}}const Ww=new Ir,Qw=new yu,Xw=new Pi,Kw=new Uf,qw=[],Yw=[],$w=new Float32Array(16),Jw=new Float32Array(9),Zw=new Float32Array(4);function Ou(w,r,l){const m=w[0];if(m<=0||m>0)return w;const y=r*l;let _=qw[y];if(_===void 0&&(_=new Float32Array(y),qw[y]=_),r!==0){m.toArray(_,0);for(let R=1,I=0;R!==r;++R)I+=l,w[R].toArray(_,I)}return _}function us(w,r){if(w.length!==r.length)return!1;for(let l=0,m=w.length;l<m;l++)if(w[l]!==r[l])return!1;return!0}function ds(w,r){for(let l=0,m=r.length;l<m;l++)w[l]=r[l]}function Ag(w,r){let l=Yw[r];l===void 0&&(l=new Int32Array(r),Yw[r]=l);for(let m=0;m!==r;++m)l[m]=w.allocateTextureUnit();return l}function c4(w,r){const l=this.cache;l[0]!==r&&(w.uniform1f(this.addr,r),l[0]=r)}function h4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y)&&(w.uniform2f(this.addr,r.x,r.y),l[0]=r.x,l[1]=r.y);else{if(us(l,r))return;w.uniform2fv(this.addr,r),ds(l,r)}}function u4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z)&&(w.uniform3f(this.addr,r.x,r.y,r.z),l[0]=r.x,l[1]=r.y,l[2]=r.z);else if(r.r!==void 0)(l[0]!==r.r||l[1]!==r.g||l[2]!==r.b)&&(w.uniform3f(this.addr,r.r,r.g,r.b),l[0]=r.r,l[1]=r.g,l[2]=r.b);else{if(us(l,r))return;w.uniform3fv(this.addr,r),ds(l,r)}}function d4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z||l[3]!==r.w)&&(w.uniform4f(this.addr,r.x,r.y,r.z,r.w),l[0]=r.x,l[1]=r.y,l[2]=r.z,l[3]=r.w);else{if(us(l,r))return;w.uniform4fv(this.addr,r),ds(l,r)}}function f4(w,r){const l=this.cache,m=r.elements;if(m===void 0){if(us(l,r))return;w.uniformMatrix2fv(this.addr,!1,r),ds(l,r)}else{if(us(l,m))return;Zw.set(m),w.uniformMatrix2fv(this.addr,!1,Zw),ds(l,m)}}function p4(w,r){const l=this.cache,m=r.elements;if(m===void 0){if(us(l,r))return;w.uniformMatrix3fv(this.addr,!1,r),ds(l,r)}else{if(us(l,m))return;Jw.set(m),w.uniformMatrix3fv(this.addr,!1,Jw),ds(l,m)}}function m4(w,r){const l=this.cache,m=r.elements;if(m===void 0){if(us(l,r))return;w.uniformMatrix4fv(this.addr,!1,r),ds(l,r)}else{if(us(l,m))return;$w.set(m),w.uniformMatrix4fv(this.addr,!1,$w),ds(l,m)}}function g4(w,r){const l=this.cache;l[0]!==r&&(w.uniform1i(this.addr,r),l[0]=r)}function A4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y)&&(w.uniform2i(this.addr,r.x,r.y),l[0]=r.x,l[1]=r.y);else{if(us(l,r))return;w.uniform2iv(this.addr,r),ds(l,r)}}function v4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z)&&(w.uniform3i(this.addr,r.x,r.y,r.z),l[0]=r.x,l[1]=r.y,l[2]=r.z);else{if(us(l,r))return;w.uniform3iv(this.addr,r),ds(l,r)}}function y4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z||l[3]!==r.w)&&(w.uniform4i(this.addr,r.x,r.y,r.z,r.w),l[0]=r.x,l[1]=r.y,l[2]=r.z,l[3]=r.w);else{if(us(l,r))return;w.uniform4iv(this.addr,r),ds(l,r)}}function x4(w,r){const l=this.cache;l[0]!==r&&(w.uniform1ui(this.addr,r),l[0]=r)}function E4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y)&&(w.uniform2ui(this.addr,r.x,r.y),l[0]=r.x,l[1]=r.y);else{if(us(l,r))return;w.uniform2uiv(this.addr,r),ds(l,r)}}function b4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z)&&(w.uniform3ui(this.addr,r.x,r.y,r.z),l[0]=r.x,l[1]=r.y,l[2]=r.z);else{if(us(l,r))return;w.uniform3uiv(this.addr,r),ds(l,r)}}function _4(w,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z||l[3]!==r.w)&&(w.uniform4ui(this.addr,r.x,r.y,r.z,r.w),l[0]=r.x,l[1]=r.y,l[2]=r.z,l[3]=r.w);else{if(us(l,r))return;w.uniform4uiv(this.addr,r),ds(l,r)}}function w4(w,r,l){const m=this.cache,y=l.allocateTextureUnit();m[0]!==y&&(w.uniform1i(this.addr,y),m[0]=y),l.setTexture2D(r||Ww,y)}function M4(w,r,l){const m=this.cache,y=l.allocateTextureUnit();m[0]!==y&&(w.uniform1i(this.addr,y),m[0]=y),l.setTexture3D(r||Xw,y)}function C4(w,r,l){const m=this.cache,y=l.allocateTextureUnit();m[0]!==y&&(w.uniform1i(this.addr,y),m[0]=y),l.setTextureCube(r||Kw,y)}function S4(w,r,l){const m=this.cache,y=l.allocateTextureUnit();m[0]!==y&&(w.uniform1i(this.addr,y),m[0]=y),l.setTexture2DArray(r||Qw,y)}function T4(w){switch(w){case 5126:return c4;case 35664:return h4;case 35665:return u4;case 35666:return d4;case 35674:return f4;case 35675:return p4;case 35676:return m4;case 5124:case 35670:return g4;case 35667:case 35671:return A4;case 35668:case 35672:return v4;case 35669:case 35673:return y4;case 5125:return x4;case 36294:return E4;case 36295:return b4;case 36296:return _4;case 35678:case 36198:case 36298:case 36306:case 35682:return w4;case 35679:case 36299:case 36307:return M4;case 35680:case 36300:case 36308:case 36293:return C4;case 36289:case 36303:case 36311:case 36292:return S4}}function R4(w,r){w.uniform1fv(this.addr,r)}function I4(w,r){const l=Ou(r,this.size,2);w.uniform2fv(this.addr,l)}function B4(w,r){const l=Ou(r,this.size,3);w.uniform3fv(this.addr,l)}function L4(w,r){const l=Ou(r,this.size,4);w.uniform4fv(this.addr,l)}function P4(w,r){const l=Ou(r,this.size,4);w.uniformMatrix2fv(this.addr,!1,l)}function D4(w,r){const l=Ou(r,this.size,9);w.uniformMatrix3fv(this.addr,!1,l)}function O4(w,r){const l=Ou(r,this.size,16);w.uniformMatrix4fv(this.addr,!1,l)}function F4(w,r){w.uniform1iv(this.addr,r)}function N4(w,r){w.uniform2iv(this.addr,r)}function U4(w,r){w.uniform3iv(this.addr,r)}function k4(w,r){w.uniform4iv(this.addr,r)}function z4(w,r){w.uniform1uiv(this.addr,r)}function G4(w,r){w.uniform2uiv(this.addr,r)}function V4(w,r){w.uniform3uiv(this.addr,r)}function H4(w,r){w.uniform4uiv(this.addr,r)}function j4(w,r,l){const m=this.cache,y=r.length,_=Ag(l,y);us(m,_)||(w.uniform1iv(this.addr,_),ds(m,_));for(let R=0;R!==y;++R)l.setTexture2D(r[R]||Ww,_[R])}function W4(w,r,l){const m=this.cache,y=r.length,_=Ag(l,y);us(m,_)||(w.uniform1iv(this.addr,_),ds(m,_));for(let R=0;R!==y;++R)l.setTexture3D(r[R]||Xw,_[R])}function Q4(w,r,l){const m=this.cache,y=r.length,_=Ag(l,y);us(m,_)||(w.uniform1iv(this.addr,_),ds(m,_));for(let R=0;R!==y;++R)l.setTextureCube(r[R]||Kw,_[R])}function X4(w,r,l){const m=this.cache,y=r.length,_=Ag(l,y);us(m,_)||(w.uniform1iv(this.addr,_),ds(m,_));for(let R=0;R!==y;++R)l.setTexture2DArray(r[R]||Qw,_[R])}function K4(w){switch(w){case 5126:return R4;case 35664:return I4;case 35665:return B4;case 35666:return L4;case 35674:return P4;case 35675:return D4;case 35676:return O4;case 5124:case 35670:return F4;case 35667:case 35671:return N4;case 35668:case 35672:return U4;case 35669:case 35673:return k4;case 5125:return z4;case 36294:return G4;case 36295:return V4;case 36296:return H4;case 35678:case 36198:case 36298:case 36306:case 35682:return j4;case 35679:case 36299:case 36307:return W4;case 35680:case 36300:case 36308:case 36293:return Q4;case 36289:case 36303:case 36311:case 36292:return X4}}class q4{constructor(r,l,m){this.id=r,this.addr=m,this.cache=[],this.setValue=T4(l.type)}}class Y4{constructor(r,l,m){this.id=r,this.addr=m,this.cache=[],this.size=l.size,this.setValue=K4(l.type)}}class $4{constructor(r){this.id=r,this.seq=[],this.map={}}setValue(r,l,m){const y=this.seq;for(let _=0,R=y.length;_!==R;++_){const I=y[_];I.setValue(r,l[I.id],m)}}}const cx=/(\w+)(\])?(\[|\.)?/g;function eM(w,r){w.seq.push(r),w.map[r.id]=r}function J4(w,r,l){const m=w.name,y=m.length;for(cx.lastIndex=0;;){const _=cx.exec(m),R=cx.lastIndex;let I=_[1];const O=_[2]==="]",N=_[3];if(O&&(I=I|0),N===void 0||N==="["&&R+2===y){eM(l,N===void 0?new q4(I,w,r):new Y4(I,w,r));break}else{let Q=l.map[I];Q===void 0&&(Q=new $4(I),eM(l,Q)),l=Q}}}class vg{constructor(r,l){this.seq=[],this.map={};const m=r.getProgramParameter(l,r.ACTIVE_UNIFORMS);for(let y=0;y<m;++y){const _=r.getActiveUniform(l,y),R=r.getUniformLocation(l,_.name);J4(_,R,this)}}setValue(r,l,m,y){const _=this.map[l];_!==void 0&&_.setValue(r,m,y)}setOptional(r,l,m){const y=l[m];y!==void 0&&this.setValue(r,m,y)}static upload(r,l,m,y){for(let _=0,R=l.length;_!==R;++_){const I=l[_],O=m[I.id];O.needsUpdate!==!1&&I.setValue(r,O.value,y)}}static seqWithValue(r,l){const m=[];for(let y=0,_=r.length;y!==_;++y){const R=r[y];R.id in l&&m.push(R)}return m}}function tM(w,r,l){const m=w.createShader(r);return w.shaderSource(m,l),w.compileShader(m),m}const Z4=37297;let eF=0;function tF(w,r){const l=w.split(`
`),m=[],y=Math.max(r-6,0),_=Math.min(r+6,l.length);for(let R=y;R<_;R++){const I=R+1;m.push(`${I===r?">":" "} ${I}: ${l[R]}`)}return m.join(`
`)}function nF(w){const r=vr.getPrimaries(vr.workingColorSpace),l=vr.getPrimaries(w);let m;switch(r===l?m="":r===oh&&l===sh?m="LinearDisplayP3ToLinearSRGB":r===sh&&l===oh&&(m="LinearSRGBToLinearDisplayP3"),w){case pr:case ih:return[m,"LinearTransferOETF"];case Cr:case fu:return[m,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",w),[m,"LinearTransferOETF"]}}function nM(w,r,l){const m=w.getShaderParameter(r,w.COMPILE_STATUS),y=w.getShaderInfoLog(r).trim();if(m&&y==="")return"";const _=/ERROR: 0:(\d+)/.exec(y);if(_){const R=parseInt(_[1]);return l.toUpperCase()+`

`+y+`

`+tF(w.getShaderSource(r),R)}else return y}function iF(w,r){const l=nF(r);return`vec4 ${w}( vec4 value ) { return ${l[0]}( ${l[1]}( value ) ); }`}function rF(w,r){let l;switch(r){case mt:l="Linear";break;case Ee:l="Reinhard";break;case _e:l="OptimizedCineon";break;case Ne:l="ACESFilmic";break;case ye:l="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",r),l="Linear"}return"vec3 "+w+"( vec3 color ) { return "+l+"ToneMapping( color ); }"}function sF(w){return[w.extensionDerivatives||w.envMapCubeUVHeight||w.bumpMap||w.normalMapTangentSpace||w.clearcoatNormalMap||w.flatShading||w.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(w.extensionFragDepth||w.logarithmicDepthBuffer)&&w.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",w.extensionDrawBuffers&&w.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(w.extensionShaderTextureLOD||w.envMap||w.transmission)&&w.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zf).join(`
`)}function oF(w){const r=[];for(const l in w){const m=w[l];m!==!1&&r.push("#define "+l+" "+m)}return r.join(`
`)}function aF(w,r){const l={},m=w.getProgramParameter(r,w.ACTIVE_ATTRIBUTES);for(let y=0;y<m;y++){const _=w.getActiveAttrib(r,y),R=_.name;let I=1;_.type===w.FLOAT_MAT2&&(I=2),_.type===w.FLOAT_MAT3&&(I=3),_.type===w.FLOAT_MAT4&&(I=4),l[R]={type:_.type,location:w.getAttribLocation(r,R),locationSize:I}}return l}function zf(w){return w!==""}function iM(w,r){const l=r.numSpotLightShadows+r.numSpotLightMaps-r.numSpotLightShadowsWithMaps;return w.replace(/NUM_DIR_LIGHTS/g,r.numDirLights).replace(/NUM_SPOT_LIGHTS/g,r.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,r.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,l).replace(/NUM_RECT_AREA_LIGHTS/g,r.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,r.numPointLights).replace(/NUM_HEMI_LIGHTS/g,r.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,r.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,r.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,r.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,r.numPointLightShadows)}function rM(w,r){return w.replace(/NUM_CLIPPING_PLANES/g,r.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,r.numClippingPlanes-r.numClipIntersection)}const lF=/^[ \t]*#include +<([\w\d./]+)>/gm;function hx(w){return w.replace(lF,hF)}const cF=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function hF(w,r){let l=Wi[r];if(l===void 0){const m=cF.get(r);if(m!==void 0)l=Wi[m],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',r,m);else throw new Error("Can not resolve #include <"+r+">")}return hx(l)}const uF=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function sM(w){return w.replace(uF,dF)}function dF(w,r,l,m){let y="";for(let _=parseInt(r);_<parseInt(l);_++)y+=m.replace(/\[\s*i\s*\]/g,"[ "+_+" ]").replace(/UNROLLED_LOOP_INDEX/g,_);return y}function oM(w){let r="precision "+w.precision+` float;
precision `+w.precision+" int;";return w.precision==="highp"?r+=`
#define HIGH_PRECISION`:w.precision==="mediump"?r+=`
#define MEDIUM_PRECISION`:w.precision==="lowp"&&(r+=`
#define LOW_PRECISION`),r}function fF(w){let r="SHADOWMAP_TYPE_BASIC";return w.shadowMapType===E?r="SHADOWMAP_TYPE_PCF":w.shadowMapType===S?r="SHADOWMAP_TYPE_PCF_SOFT":w.shadowMapType===M&&(r="SHADOWMAP_TYPE_VSM"),r}function pF(w){let r="ENVMAP_TYPE_CUBE";if(w.envMap)switch(w.envMapMode){case Qe:case ne:r="ENVMAP_TYPE_CUBE";break;case he:r="ENVMAP_TYPE_CUBE_UV";break}return r}function mF(w){let r="ENVMAP_MODE_REFLECTION";if(w.envMap)switch(w.envMapMode){case ne:r="ENVMAP_MODE_REFRACTION";break}return r}function gF(w){let r="ENVMAP_BLENDING_NONE";if(w.envMap)switch(w.combine){case Nt:r="ENVMAP_BLENDING_MULTIPLY";break;case zt:r="ENVMAP_BLENDING_MIX";break;case Vt:r="ENVMAP_BLENDING_ADD";break}return r}function AF(w){const r=w.envMapCubeUVHeight;if(r===null)return null;const l=Math.log2(r)-2,m=1/r;return{texelWidth:1/(3*Math.max(Math.pow(2,l),7*16)),texelHeight:m,maxMip:l}}function vF(w,r,l,m){const y=w.getContext(),_=l.defines;let R=l.vertexShader,I=l.fragmentShader;const O=fF(l),N=pF(l),V=mF(l),Q=gF(l),X=AF(l),$=l.isWebGL2?"":sF(l),ie=oF(_),ue=y.createProgram();let re,q,Se=l.glslVersion?"#version "+l.glslVersion+`
`:"";const fe=l.numMultiviewViews;l.isRawShaderMaterial?(re=["#define SHADER_TYPE "+l.shaderType,"#define SHADER_NAME "+l.shaderName,ie].filter(zf).join(`
`),re.length>0&&(re+=`
`),q=[$,"#define SHADER_TYPE "+l.shaderType,"#define SHADER_NAME "+l.shaderName,ie].filter(zf).join(`
`),q.length>0&&(q+=`
`)):(re=[oM(l),"#define SHADER_TYPE "+l.shaderType,"#define SHADER_NAME "+l.shaderName,ie,l.instancing?"#define USE_INSTANCING":"",l.instancingColor?"#define USE_INSTANCING_COLOR":"",l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp2?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+V:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",l.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",l.displacementMap?"#define USE_DISPLACEMENTMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.anisotropy?"#define USE_ANISOTROPY":"",l.anisotropyMap?"#define USE_ANISOTROPYMAP":"",l.clearcoatMap?"#define USE_CLEARCOATMAP":"",l.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",l.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",l.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",l.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",l.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.alphaHash?"#define USE_ALPHAHASH":"",l.transmission?"#define USE_TRANSMISSION":"",l.transmissionMap?"#define USE_TRANSMISSIONMAP":"",l.thicknessMap?"#define USE_THICKNESSMAP":"",l.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",l.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",l.mapUv?"#define MAP_UV "+l.mapUv:"",l.alphaMapUv?"#define ALPHAMAP_UV "+l.alphaMapUv:"",l.lightMapUv?"#define LIGHTMAP_UV "+l.lightMapUv:"",l.aoMapUv?"#define AOMAP_UV "+l.aoMapUv:"",l.emissiveMapUv?"#define EMISSIVEMAP_UV "+l.emissiveMapUv:"",l.bumpMapUv?"#define BUMPMAP_UV "+l.bumpMapUv:"",l.normalMapUv?"#define NORMALMAP_UV "+l.normalMapUv:"",l.displacementMapUv?"#define DISPLACEMENTMAP_UV "+l.displacementMapUv:"",l.metalnessMapUv?"#define METALNESSMAP_UV "+l.metalnessMapUv:"",l.roughnessMapUv?"#define ROUGHNESSMAP_UV "+l.roughnessMapUv:"",l.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+l.anisotropyMapUv:"",l.clearcoatMapUv?"#define CLEARCOATMAP_UV "+l.clearcoatMapUv:"",l.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+l.clearcoatNormalMapUv:"",l.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+l.clearcoatRoughnessMapUv:"",l.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+l.iridescenceMapUv:"",l.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+l.iridescenceThicknessMapUv:"",l.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+l.sheenColorMapUv:"",l.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+l.sheenRoughnessMapUv:"",l.specularMapUv?"#define SPECULARMAP_UV "+l.specularMapUv:"",l.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+l.specularColorMapUv:"",l.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+l.specularIntensityMapUv:"",l.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+l.transmissionMapUv:"",l.thicknessMapUv?"#define THICKNESSMAP_UV "+l.thicknessMapUv:"",l.vertexTangents&&l.flatShading===!1?"#define USE_TANGENT":"",l.vertexColors?"#define USE_COLOR":"",l.vertexAlphas?"#define USE_COLOR_ALPHA":"",l.vertexUv1s?"#define USE_UV1":"",l.vertexUv2s?"#define USE_UV2":"",l.vertexUv3s?"#define USE_UV3":"",l.pointsUvs?"#define USE_POINTS_UV":"",l.flatShading?"#define FLAT_SHADED":"",l.skinning?"#define USE_SKINNING":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals&&l.flatShading===!1?"#define USE_MORPHNORMALS":"",l.morphColors&&l.isWebGL2?"#define USE_MORPHCOLORS":"",l.morphTargetsCount>0&&l.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",l.morphTargetsCount>0&&l.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+l.morphTextureStride:"",l.morphTargetsCount>0&&l.isWebGL2?"#define MORPHTARGETS_COUNT "+l.morphTargetsCount:"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+O:"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.numLightProbes>0?"#define USE_LIGHT_PROBES":"",l.useLegacyLights?"#define LEGACY_LIGHTS":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&l.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(zf).join(`
`),q=[$,oM(l),"#define SHADER_TYPE "+l.shaderType,"#define SHADER_NAME "+l.shaderName,ie,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp2?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.matcap?"#define USE_MATCAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+N:"",l.envMap?"#define "+V:"",l.envMap?"#define "+Q:"",X?"#define CUBEUV_TEXEL_WIDTH "+X.texelWidth:"",X?"#define CUBEUV_TEXEL_HEIGHT "+X.texelHeight:"",X?"#define CUBEUV_MAX_MIP "+X.maxMip+".0":"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",l.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.anisotropy?"#define USE_ANISOTROPY":"",l.anisotropyMap?"#define USE_ANISOTROPYMAP":"",l.clearcoat?"#define USE_CLEARCOAT":"",l.clearcoatMap?"#define USE_CLEARCOATMAP":"",l.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",l.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",l.iridescence?"#define USE_IRIDESCENCE":"",l.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",l.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",l.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.alphaTest?"#define USE_ALPHATEST":"",l.alphaHash?"#define USE_ALPHAHASH":"",l.sheen?"#define USE_SHEEN":"",l.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",l.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",l.transmission?"#define USE_TRANSMISSION":"",l.transmissionMap?"#define USE_TRANSMISSIONMAP":"",l.thicknessMap?"#define USE_THICKNESSMAP":"",l.vertexTangents&&l.flatShading===!1?"#define USE_TANGENT":"",l.vertexColors||l.instancingColor?"#define USE_COLOR":"",l.vertexAlphas?"#define USE_COLOR_ALPHA":"",l.vertexUv1s?"#define USE_UV1":"",l.vertexUv2s?"#define USE_UV2":"",l.vertexUv3s?"#define USE_UV3":"",l.pointsUvs?"#define USE_POINTS_UV":"",l.gradientMap?"#define USE_GRADIENTMAP":"",l.flatShading?"#define FLAT_SHADED":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+O:"",l.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",l.numLightProbes>0?"#define USE_LIGHT_PROBES":"",l.useLegacyLights?"#define LEGACY_LIGHTS":"",l.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&l.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",l.toneMapping!==fn?"#define TONE_MAPPING":"",l.toneMapping!==fn?Wi.tonemapping_pars_fragment:"",l.toneMapping!==fn?rF("toneMapping",l.toneMapping):"",l.dithering?"#define DITHERING":"",l.opaque?"#define OPAQUE":"",Wi.colorspace_pars_fragment,iF("linearToOutputTexel",l.outputColorSpace),l.useDepthPacking?"#define DEPTH_PACKING "+l.depthPacking:"",`
`].filter(zf).join(`
`)),R=hx(R),R=iM(R,l),R=rM(R,l),I=hx(I),I=iM(I,l),I=rM(I,l),R=sM(R),I=sM(I),l.isWebGL2&&l.isRawShaderMaterial!==!0&&(Se=`#version 300 es
`,re=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+re,q=["precision mediump sampler2DArray;","#define varying in",l.glslVersion===Cf?"":"layout(location = 0) out highp vec4 pc_fragColor;",l.glslVersion===Cf?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+q,fe>0&&(re=["#extension GL_OVR_multiview : require","layout(num_views = "+fe+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+re,re=re.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+fe+"];","uniform mat4 projectionMatrices["+fe+"];","uniform mat4 viewMatrices["+fe+"];","uniform mat3 normalMatrices["+fe+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),q=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+q,q=q.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+fe+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));const Me=Se+re+R,ze=Se+q+I,He=tM(y,y.VERTEX_SHADER,Me),et=tM(y,y.FRAGMENT_SHADER,ze);y.attachShader(ue,He),y.attachShader(ue,et),l.index0AttributeName!==void 0?y.bindAttribLocation(ue,0,l.index0AttributeName):l.morphTargets===!0&&y.bindAttribLocation(ue,0,"position"),y.linkProgram(ue);function st(bt){if(w.debug.checkShaderErrors){const Gt=y.getProgramInfoLog(ue).trim(),lt=y.getShaderInfoLog(He).trim(),wt=y.getShaderInfoLog(et).trim();let Kt=!0,qt=!0;if(y.getProgramParameter(ue,y.LINK_STATUS)===!1)if(Kt=!1,typeof w.debug.onShaderError=="function")w.debug.onShaderError(y,ue,He,et);else{const ln=nM(y,He,"vertex"),Jt=nM(y,et,"fragment");console.error("THREE.WebGLProgram: Shader Error "+y.getError()+" - VALIDATE_STATUS "+y.getProgramParameter(ue,y.VALIDATE_STATUS)+`

Program Info Log: `+Gt+`
`+ln+`
`+Jt)}else Gt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Gt):(lt===""||wt==="")&&(qt=!1);qt&&(bt.diagnostics={runnable:Kt,programLog:Gt,vertexShader:{log:lt,prefix:re},fragmentShader:{log:wt,prefix:q}})}y.deleteShader(He),y.deleteShader(et),Be=new vg(y,ue),Xe=aF(y,ue)}let Be;this.getUniforms=function(){return Be===void 0&&st(this),Be};let Xe;this.getAttributes=function(){return Xe===void 0&&st(this),Xe};let rt=l.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return rt===!1&&(rt=y.getProgramParameter(ue,Z4)),rt},this.destroy=function(){m.releaseStatesOfProgram(this),y.deleteProgram(ue),this.program=void 0},this.type=l.shaderType,this.name=l.shaderName,this.id=eF++,this.cacheKey=r,this.usedTimes=1,this.program=ue,this.vertexShader=He,this.fragmentShader=et,this.numMultiviewViews=fe,this}let yF=0;class xF{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(r){const l=r.vertexShader,m=r.fragmentShader,y=this._getShaderStage(l),_=this._getShaderStage(m),R=this._getShaderCacheForMaterial(r);return R.has(y)===!1&&(R.add(y),y.usedTimes++),R.has(_)===!1&&(R.add(_),_.usedTimes++),this}remove(r){const l=this.materialCache.get(r);for(const m of l)m.usedTimes--,m.usedTimes===0&&this.shaderCache.delete(m.code);return this.materialCache.delete(r),this}getVertexShaderID(r){return this._getShaderStage(r.vertexShader).id}getFragmentShaderID(r){return this._getShaderStage(r.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(r){const l=this.materialCache;let m=l.get(r);return m===void 0&&(m=new Set,l.set(r,m)),m}_getShaderStage(r){const l=this.shaderCache;let m=l.get(r);return m===void 0&&(m=new EF(r),l.set(r,m)),m}}class EF{constructor(r){this.id=yF++,this.code=r,this.usedTimes=0}}function bF(w,r,l,m,y,_,R){const I=new Jm,O=new xF,N=[],V=y.isWebGL2,Q=y.logarithmicDepthBuffer,X=y.vertexTextures;let $=y.precision;const ie={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ue(Be){return Be===0?"uv":`uv${Be}`}function re(Be,Xe,rt,bt,Gt){const lt=bt.fog,wt=Gt.geometry,Kt=Be.isMeshStandardMaterial?bt.environment:null,qt=(Be.isMeshStandardMaterial?l:r).get(Be.envMap||Kt),ln=qt&&qt.mapping===he?qt.image.height:null,Jt=ie[Be.type];Be.precision!==null&&($=y.getMaxPrecision(Be.precision),$!==Be.precision&&console.warn("THREE.WebGLProgram.getParameters:",Be.precision,"not supported, using",$,"instead."));const pn=wt.morphAttributes.position||wt.morphAttributes.normal||wt.morphAttributes.color,dn=pn!==void 0?pn.length:0;let Qn=0;wt.morphAttributes.position!==void 0&&(Qn=1),wt.morphAttributes.normal!==void 0&&(Qn=2),wt.morphAttributes.color!==void 0&&(Qn=3);let Qi,ki,Ht,Sn;if(Jt){const En=fa[Jt];Qi=En.vertexShader,ki=En.fragmentShader}else Qi=Be.vertexShader,ki=Be.fragmentShader,O.update(Be),Ht=O.getVertexShaderID(Be),Sn=O.getFragmentShaderID(Be);const _n=w.getRenderTarget(),wi=_n&&_n.isWebGLMultiviewRenderTarget?_n.numViews:0,ei=Gt.isInstancedMesh===!0,ii=!!Be.map,yi=!!Be.matcap,nn=!!qt,ct=!!Be.aoMap,hn=!!Be.lightMap,In=!!Be.bumpMap,rn=!!Be.normalMap,Gn=!!Be.displacementMap,mi=!!Be.emissiveMap,ti=!!Be.metalnessMap,gi=!!Be.roughnessMap,ir=Be.anisotropy>0,Lr=Be.clearcoat>0,fs=Be.iridescence>0,br=Be.sheen>0,gr=Be.transmission>0,$r=ir&&!!Be.anisotropyMap,Mo=Lr&&!!Be.clearcoatMap,qe=Lr&&!!Be.clearcoatNormalMap,Ie=Lr&&!!Be.clearcoatRoughnessMap,St=fs&&!!Be.iridescenceMap,an=fs&&!!Be.iridescenceThicknessMap,un=br&&!!Be.sheenColorMap,cn=br&&!!Be.sheenRoughnessMap,hi=!!Be.specularMap,zn=!!Be.specularColorMap,Yn=!!Be.specularIntensityMap,Ai=gr&&!!Be.transmissionMap,sr=gr&&!!Be.thicknessMap,wn=!!Be.gradientMap,Ur=!!Be.alphaMap,ot=Be.alphaTest>0,xn=!!Be.alphaHash,tn=!!Be.extensions,An=!!wt.attributes.uv1,kn=!!wt.attributes.uv2,Di=!!wt.attributes.uv3;let $i=fn;return Be.toneMapped&&(_n===null||_n.isXRRenderTarget===!0)&&($i=w.toneMapping),{isWebGL2:V,shaderID:Jt,shaderType:Be.type,shaderName:Be.name,vertexShader:Qi,fragmentShader:ki,defines:Be.defines,customVertexShaderID:Ht,customFragmentShaderID:Sn,isRawShaderMaterial:Be.isRawShaderMaterial===!0,glslVersion:Be.glslVersion,precision:$,instancing:ei,instancingColor:ei&&Gt.instanceColor!==null,supportsVertexTextures:X,numMultiviewViews:wi,outputColorSpace:_n===null?w.outputColorSpace:_n.isXRRenderTarget===!0?_n.texture.colorSpace:pr,map:ii,matcap:yi,envMap:nn,envMapMode:nn&&qt.mapping,envMapCubeUVHeight:ln,aoMap:ct,lightMap:hn,bumpMap:In,normalMap:rn,displacementMap:X&&Gn,emissiveMap:mi,normalMapObjectSpace:rn&&Be.normalMapType===ja,normalMapTangentSpace:rn&&Be.normalMapType===ks,metalnessMap:ti,roughnessMap:gi,anisotropy:ir,anisotropyMap:$r,clearcoat:Lr,clearcoatMap:Mo,clearcoatNormalMap:qe,clearcoatRoughnessMap:Ie,iridescence:fs,iridescenceMap:St,iridescenceThicknessMap:an,sheen:br,sheenColorMap:un,sheenRoughnessMap:cn,specularMap:hi,specularColorMap:zn,specularIntensityMap:Yn,transmission:gr,transmissionMap:Ai,thicknessMap:sr,gradientMap:wn,opaque:Be.transparent===!1&&Be.blending===D,alphaMap:Ur,alphaTest:ot,alphaHash:xn,combine:Be.combine,mapUv:ii&&ue(Be.map.channel),aoMapUv:ct&&ue(Be.aoMap.channel),lightMapUv:hn&&ue(Be.lightMap.channel),bumpMapUv:In&&ue(Be.bumpMap.channel),normalMapUv:rn&&ue(Be.normalMap.channel),displacementMapUv:Gn&&ue(Be.displacementMap.channel),emissiveMapUv:mi&&ue(Be.emissiveMap.channel),metalnessMapUv:ti&&ue(Be.metalnessMap.channel),roughnessMapUv:gi&&ue(Be.roughnessMap.channel),anisotropyMapUv:$r&&ue(Be.anisotropyMap.channel),clearcoatMapUv:Mo&&ue(Be.clearcoatMap.channel),clearcoatNormalMapUv:qe&&ue(Be.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ie&&ue(Be.clearcoatRoughnessMap.channel),iridescenceMapUv:St&&ue(Be.iridescenceMap.channel),iridescenceThicknessMapUv:an&&ue(Be.iridescenceThicknessMap.channel),sheenColorMapUv:un&&ue(Be.sheenColorMap.channel),sheenRoughnessMapUv:cn&&ue(Be.sheenRoughnessMap.channel),specularMapUv:hi&&ue(Be.specularMap.channel),specularColorMapUv:zn&&ue(Be.specularColorMap.channel),specularIntensityMapUv:Yn&&ue(Be.specularIntensityMap.channel),transmissionMapUv:Ai&&ue(Be.transmissionMap.channel),thicknessMapUv:sr&&ue(Be.thicknessMap.channel),alphaMapUv:Ur&&ue(Be.alphaMap.channel),vertexTangents:!!wt.attributes.tangent&&(rn||ir),vertexColors:Be.vertexColors,vertexAlphas:Be.vertexColors===!0&&!!wt.attributes.color&&wt.attributes.color.itemSize===4,vertexUv1s:An,vertexUv2s:kn,vertexUv3s:Di,pointsUvs:Gt.isPoints===!0&&!!wt.attributes.uv&&(ii||Ur),fog:!!lt,useFog:Be.fog===!0,fogExp2:lt&&lt.isFogExp2,flatShading:Be.flatShading===!0,sizeAttenuation:Be.sizeAttenuation===!0,logarithmicDepthBuffer:Q,skinning:Gt.isSkinnedMesh===!0,morphTargets:wt.morphAttributes.position!==void 0,morphNormals:wt.morphAttributes.normal!==void 0,morphColors:wt.morphAttributes.color!==void 0,morphTargetsCount:dn,morphTextureStride:Qn,numDirLights:Xe.directional.length,numPointLights:Xe.point.length,numSpotLights:Xe.spot.length,numSpotLightMaps:Xe.spotLightMap.length,numRectAreaLights:Xe.rectArea.length,numHemiLights:Xe.hemi.length,numDirLightShadows:Xe.directionalShadowMap.length,numPointLightShadows:Xe.pointShadowMap.length,numSpotLightShadows:Xe.spotShadowMap.length,numSpotLightShadowsWithMaps:Xe.numSpotLightShadowsWithMaps,numLightProbes:Xe.numLightProbes,numClippingPlanes:R.numPlanes,numClipIntersection:R.numIntersection,dithering:Be.dithering,shadowMapEnabled:w.shadowMap.enabled&&rt.length>0,shadowMapType:w.shadowMap.type,toneMapping:$i,useLegacyLights:w._useLegacyLights,decodeVideoTexture:ii&&Be.map.isVideoTexture===!0&&vr.getTransfer(Be.map.colorSpace)===wr,premultipliedAlpha:Be.premultipliedAlpha,doubleSided:Be.side===L,flipSided:Be.side===T,useDepthPacking:Be.depthPacking>=0,depthPacking:Be.depthPacking||0,index0AttributeName:Be.index0AttributeName,extensionDerivatives:tn&&Be.extensions.derivatives===!0,extensionFragDepth:tn&&Be.extensions.fragDepth===!0,extensionDrawBuffers:tn&&Be.extensions.drawBuffers===!0,extensionShaderTextureLOD:tn&&Be.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:V||m.has("EXT_frag_depth"),rendererExtensionDrawBuffers:V||m.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:V||m.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:m.has("KHR_parallel_shader_compile"),customProgramCacheKey:Be.customProgramCacheKey()}}function q(Be){const Xe=[];if(Be.shaderID?Xe.push(Be.shaderID):(Xe.push(Be.customVertexShaderID),Xe.push(Be.customFragmentShaderID)),Be.defines!==void 0)for(const rt in Be.defines)Xe.push(rt),Xe.push(Be.defines[rt]);return Be.isRawShaderMaterial===!1&&(Se(Xe,Be),fe(Xe,Be),Xe.push(w.outputColorSpace)),Xe.push(Be.customProgramCacheKey),Xe.join()}function Se(Be,Xe){Be.push(Xe.precision),Be.push(Xe.outputColorSpace),Be.push(Xe.envMapMode),Be.push(Xe.envMapCubeUVHeight),Be.push(Xe.mapUv),Be.push(Xe.alphaMapUv),Be.push(Xe.lightMapUv),Be.push(Xe.aoMapUv),Be.push(Xe.bumpMapUv),Be.push(Xe.normalMapUv),Be.push(Xe.displacementMapUv),Be.push(Xe.emissiveMapUv),Be.push(Xe.metalnessMapUv),Be.push(Xe.roughnessMapUv),Be.push(Xe.anisotropyMapUv),Be.push(Xe.clearcoatMapUv),Be.push(Xe.clearcoatNormalMapUv),Be.push(Xe.clearcoatRoughnessMapUv),Be.push(Xe.iridescenceMapUv),Be.push(Xe.iridescenceThicknessMapUv),Be.push(Xe.sheenColorMapUv),Be.push(Xe.sheenRoughnessMapUv),Be.push(Xe.specularMapUv),Be.push(Xe.specularColorMapUv),Be.push(Xe.specularIntensityMapUv),Be.push(Xe.transmissionMapUv),Be.push(Xe.thicknessMapUv),Be.push(Xe.combine),Be.push(Xe.fogExp2),Be.push(Xe.sizeAttenuation),Be.push(Xe.morphTargetsCount),Be.push(Xe.morphAttributeCount),Be.push(Xe.numDirLights),Be.push(Xe.numPointLights),Be.push(Xe.numSpotLights),Be.push(Xe.numSpotLightMaps),Be.push(Xe.numHemiLights),Be.push(Xe.numRectAreaLights),Be.push(Xe.numDirLightShadows),Be.push(Xe.numPointLightShadows),Be.push(Xe.numSpotLightShadows),Be.push(Xe.numSpotLightShadowsWithMaps),Be.push(Xe.numLightProbes),Be.push(Xe.shadowMapType),Be.push(Xe.toneMapping),Be.push(Xe.numClippingPlanes),Be.push(Xe.numClipIntersection),Be.push(Xe.depthPacking)}function fe(Be,Xe){I.disableAll(),Xe.isWebGL2&&I.enable(0),Xe.supportsVertexTextures&&I.enable(1),Xe.instancing&&I.enable(2),Xe.instancingColor&&I.enable(3),Xe.matcap&&I.enable(4),Xe.envMap&&I.enable(5),Xe.normalMapObjectSpace&&I.enable(6),Xe.normalMapTangentSpace&&I.enable(7),Xe.clearcoat&&I.enable(8),Xe.iridescence&&I.enable(9),Xe.alphaTest&&I.enable(10),Xe.vertexColors&&I.enable(11),Xe.vertexAlphas&&I.enable(12),Xe.vertexUv1s&&I.enable(13),Xe.vertexUv2s&&I.enable(14),Xe.vertexUv3s&&I.enable(15),Xe.vertexTangents&&I.enable(16),Xe.anisotropy&&I.enable(17),Xe.alphaHash&&I.enable(18),Be.push(I.mask),I.disableAll(),Xe.fog&&I.enable(0),Xe.useFog&&I.enable(1),Xe.flatShading&&I.enable(2),Xe.logarithmicDepthBuffer&&I.enable(3),Xe.skinning&&I.enable(4),Xe.morphTargets&&I.enable(5),Xe.morphNormals&&I.enable(6),Xe.morphColors&&I.enable(7),Xe.premultipliedAlpha&&I.enable(8),Xe.shadowMapEnabled&&I.enable(9),Xe.useLegacyLights&&I.enable(10),Xe.doubleSided&&I.enable(11),Xe.flipSided&&I.enable(12),Xe.useDepthPacking&&I.enable(13),Xe.dithering&&I.enable(14),Xe.transmission&&I.enable(15),Xe.sheen&&I.enable(16),Xe.opaque&&I.enable(17),Xe.pointsUvs&&I.enable(18),Xe.decodeVideoTexture&&I.enable(19),Xe.numMultiviewViews&&I.enable(20),Be.push(I.mask)}function Me(Be){const Xe=ie[Be.type];let rt;if(Xe){const bt=fa[Xe];rt=Fw.clone(bt.uniforms)}else rt=Be.uniforms;return rt}function ze(Be,Xe){let rt;for(let bt=0,Gt=N.length;bt<Gt;bt++){const lt=N[bt];if(lt.cacheKey===Xe){rt=lt,++rt.usedTimes;break}}return rt===void 0&&(rt=new vF(w,Xe,Be,_),N.push(rt)),rt}function He(Be){if(--Be.usedTimes===0){const Xe=N.indexOf(Be);N[Xe]=N[N.length-1],N.pop(),Be.destroy()}}function et(Be){O.remove(Be)}function st(){O.dispose()}return{getParameters:re,getProgramCacheKey:q,getUniforms:Me,acquireProgram:ze,releaseProgram:He,releaseShaderCache:et,programs:N,dispose:st}}function _F(){let w=new WeakMap;function r(_){let R=w.get(_);return R===void 0&&(R={},w.set(_,R)),R}function l(_){w.delete(_)}function m(_,R,I){w.get(_)[R]=I}function y(){w=new WeakMap}return{get:r,remove:l,update:m,dispose:y}}function wF(w,r){return w.groupOrder!==r.groupOrder?w.groupOrder-r.groupOrder:w.renderOrder!==r.renderOrder?w.renderOrder-r.renderOrder:w.material.id!==r.material.id?w.material.id-r.material.id:w.z!==r.z?w.z-r.z:w.id-r.id}function aM(w,r){return w.groupOrder!==r.groupOrder?w.groupOrder-r.groupOrder:w.renderOrder!==r.renderOrder?w.renderOrder-r.renderOrder:w.z!==r.z?r.z-w.z:w.id-r.id}function lM(){const w=[];let r=0;const l=[],m=[],y=[];function _(){r=0,l.length=0,m.length=0,y.length=0}function R(Q,X,$,ie,ue,re){let q=w[r];return q===void 0?(q={id:Q.id,object:Q,geometry:X,material:$,groupOrder:ie,renderOrder:Q.renderOrder,z:ue,group:re},w[r]=q):(q.id=Q.id,q.object=Q,q.geometry=X,q.material=$,q.groupOrder=ie,q.renderOrder=Q.renderOrder,q.z=ue,q.group=re),r++,q}function I(Q,X,$,ie,ue,re){const q=R(Q,X,$,ie,ue,re);$.transmission>0?m.push(q):$.transparent===!0?y.push(q):l.push(q)}function O(Q,X,$,ie,ue,re){const q=R(Q,X,$,ie,ue,re);$.transmission>0?m.unshift(q):$.transparent===!0?y.unshift(q):l.unshift(q)}function N(Q,X){l.length>1&&l.sort(Q||wF),m.length>1&&m.sort(X||aM),y.length>1&&y.sort(X||aM)}function V(){for(let Q=r,X=w.length;Q<X;Q++){const $=w[Q];if($.id===null)break;$.id=null,$.object=null,$.geometry=null,$.material=null,$.group=null}}return{opaque:l,transmissive:m,transparent:y,init:_,push:I,unshift:O,finish:V,sort:N}}function MF(){let w=new WeakMap;function r(m,y){const _=w.get(m);let R;return _===void 0?(R=new lM,w.set(m,[R])):y>=_.length?(R=new lM,_.push(R)):R=_[y],R}function l(){w=new WeakMap}return{get:r,dispose:l}}function CF(){const w={};return{get:function(r){if(w[r.id]!==void 0)return w[r.id];let l;switch(r.type){case"DirectionalLight":l={direction:new je,color:new Hn};break;case"SpotLight":l={position:new je,direction:new je,color:new Hn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":l={position:new je,color:new Hn,distance:0,decay:0};break;case"HemisphereLight":l={direction:new je,skyColor:new Hn,groundColor:new Hn};break;case"RectAreaLight":l={color:new Hn,position:new je,halfWidth:new je,halfHeight:new je};break}return w[r.id]=l,l}}}function SF(){const w={};return{get:function(r){if(w[r.id]!==void 0)return w[r.id];let l;switch(r.type){case"DirectionalLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new en};break;case"SpotLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new en};break;case"PointLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new en,shadowCameraNear:1,shadowCameraFar:1e3};break}return w[r.id]=l,l}}}let TF=0;function RF(w,r){return(r.castShadow?2:0)-(w.castShadow?2:0)+(r.map?1:0)-(w.map?1:0)}function IF(w,r){const l=new CF,m=SF(),y={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let V=0;V<9;V++)y.probe.push(new je);const _=new je,R=new _i,I=new _i;function O(V,Q){let X=0,$=0,ie=0;for(let bt=0;bt<9;bt++)y.probe[bt].set(0,0,0);let ue=0,re=0,q=0,Se=0,fe=0,Me=0,ze=0,He=0,et=0,st=0,Be=0;V.sort(RF);const Xe=Q===!0?Math.PI:1;for(let bt=0,Gt=V.length;bt<Gt;bt++){const lt=V[bt],wt=lt.color,Kt=lt.intensity,qt=lt.distance,ln=lt.shadow&&lt.shadow.map?lt.shadow.map.texture:null;if(lt.isAmbientLight)X+=wt.r*Kt*Xe,$+=wt.g*Kt*Xe,ie+=wt.b*Kt*Xe;else if(lt.isLightProbe){for(let Jt=0;Jt<9;Jt++)y.probe[Jt].addScaledVector(lt.sh.coefficients[Jt],Kt);Be++}else if(lt.isDirectionalLight){const Jt=l.get(lt);if(Jt.color.copy(lt.color).multiplyScalar(lt.intensity*Xe),lt.castShadow){const pn=lt.shadow,dn=m.get(lt);dn.shadowBias=pn.bias,dn.shadowNormalBias=pn.normalBias,dn.shadowRadius=pn.radius,dn.shadowMapSize=pn.mapSize,y.directionalShadow[ue]=dn,y.directionalShadowMap[ue]=ln,y.directionalShadowMatrix[ue]=lt.shadow.matrix,Me++}y.directional[ue]=Jt,ue++}else if(lt.isSpotLight){const Jt=l.get(lt);Jt.position.setFromMatrixPosition(lt.matrixWorld),Jt.color.copy(wt).multiplyScalar(Kt*Xe),Jt.distance=qt,Jt.coneCos=Math.cos(lt.angle),Jt.penumbraCos=Math.cos(lt.angle*(1-lt.penumbra)),Jt.decay=lt.decay,y.spot[q]=Jt;const pn=lt.shadow;if(lt.map&&(y.spotLightMap[et]=lt.map,et++,pn.updateMatrices(lt),lt.castShadow&&st++),y.spotLightMatrix[q]=pn.matrix,lt.castShadow){const dn=m.get(lt);dn.shadowBias=pn.bias,dn.shadowNormalBias=pn.normalBias,dn.shadowRadius=pn.radius,dn.shadowMapSize=pn.mapSize,y.spotShadow[q]=dn,y.spotShadowMap[q]=ln,He++}q++}else if(lt.isRectAreaLight){const Jt=l.get(lt);Jt.color.copy(wt).multiplyScalar(Kt),Jt.halfWidth.set(lt.width*.5,0,0),Jt.halfHeight.set(0,lt.height*.5,0),y.rectArea[Se]=Jt,Se++}else if(lt.isPointLight){const Jt=l.get(lt);if(Jt.color.copy(lt.color).multiplyScalar(lt.intensity*Xe),Jt.distance=lt.distance,Jt.decay=lt.decay,lt.castShadow){const pn=lt.shadow,dn=m.get(lt);dn.shadowBias=pn.bias,dn.shadowNormalBias=pn.normalBias,dn.shadowRadius=pn.radius,dn.shadowMapSize=pn.mapSize,dn.shadowCameraNear=pn.camera.near,dn.shadowCameraFar=pn.camera.far,y.pointShadow[re]=dn,y.pointShadowMap[re]=ln,y.pointShadowMatrix[re]=lt.shadow.matrix,ze++}y.point[re]=Jt,re++}else if(lt.isHemisphereLight){const Jt=l.get(lt);Jt.skyColor.copy(lt.color).multiplyScalar(Kt*Xe),Jt.groundColor.copy(lt.groundColor).multiplyScalar(Kt*Xe),y.hemi[fe]=Jt,fe++}}Se>0&&(r.isWebGL2||w.has("OES_texture_float_linear")===!0?(y.rectAreaLTC1=Un.LTC_FLOAT_1,y.rectAreaLTC2=Un.LTC_FLOAT_2):w.has("OES_texture_half_float_linear")===!0?(y.rectAreaLTC1=Un.LTC_HALF_1,y.rectAreaLTC2=Un.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),y.ambient[0]=X,y.ambient[1]=$,y.ambient[2]=ie;const rt=y.hash;(rt.directionalLength!==ue||rt.pointLength!==re||rt.spotLength!==q||rt.rectAreaLength!==Se||rt.hemiLength!==fe||rt.numDirectionalShadows!==Me||rt.numPointShadows!==ze||rt.numSpotShadows!==He||rt.numSpotMaps!==et||rt.numLightProbes!==Be)&&(y.directional.length=ue,y.spot.length=q,y.rectArea.length=Se,y.point.length=re,y.hemi.length=fe,y.directionalShadow.length=Me,y.directionalShadowMap.length=Me,y.pointShadow.length=ze,y.pointShadowMap.length=ze,y.spotShadow.length=He,y.spotShadowMap.length=He,y.directionalShadowMatrix.length=Me,y.pointShadowMatrix.length=ze,y.spotLightMatrix.length=He+et-st,y.spotLightMap.length=et,y.numSpotLightShadowsWithMaps=st,y.numLightProbes=Be,rt.directionalLength=ue,rt.pointLength=re,rt.spotLength=q,rt.rectAreaLength=Se,rt.hemiLength=fe,rt.numDirectionalShadows=Me,rt.numPointShadows=ze,rt.numSpotShadows=He,rt.numSpotMaps=et,rt.numLightProbes=Be,y.version=TF++)}function N(V,Q){let X=0,$=0,ie=0,ue=0,re=0;const q=Q.matrixWorldInverse;for(let Se=0,fe=V.length;Se<fe;Se++){const Me=V[Se];if(Me.isDirectionalLight){const ze=y.directional[X];ze.direction.setFromMatrixPosition(Me.matrixWorld),_.setFromMatrixPosition(Me.target.matrixWorld),ze.direction.sub(_),ze.direction.transformDirection(q),X++}else if(Me.isSpotLight){const ze=y.spot[ie];ze.position.setFromMatrixPosition(Me.matrixWorld),ze.position.applyMatrix4(q),ze.direction.setFromMatrixPosition(Me.matrixWorld),_.setFromMatrixPosition(Me.target.matrixWorld),ze.direction.sub(_),ze.direction.transformDirection(q),ie++}else if(Me.isRectAreaLight){const ze=y.rectArea[ue];ze.position.setFromMatrixPosition(Me.matrixWorld),ze.position.applyMatrix4(q),I.identity(),R.copy(Me.matrixWorld),R.premultiply(q),I.extractRotation(R),ze.halfWidth.set(Me.width*.5,0,0),ze.halfHeight.set(0,Me.height*.5,0),ze.halfWidth.applyMatrix4(I),ze.halfHeight.applyMatrix4(I),ue++}else if(Me.isPointLight){const ze=y.point[$];ze.position.setFromMatrixPosition(Me.matrixWorld),ze.position.applyMatrix4(q),$++}else if(Me.isHemisphereLight){const ze=y.hemi[re];ze.direction.setFromMatrixPosition(Me.matrixWorld),ze.direction.transformDirection(q),re++}}}return{setup:O,setupView:N,state:y}}function cM(w,r){const l=new IF(w,r),m=[],y=[];function _(){m.length=0,y.length=0}function R(Q){m.push(Q)}function I(Q){y.push(Q)}function O(Q){l.setup(m,Q)}function N(Q){l.setupView(m,Q)}return{init:_,state:{lightsArray:m,shadowsArray:y,lights:l},setupLights:O,setupLightsView:N,pushLight:R,pushShadow:I}}function BF(w,r){let l=new WeakMap;function m(_,R=0){const I=l.get(_);let O;return I===void 0?(O=new cM(w,r),l.set(_,[O])):R>=I.length?(O=new cM(w,r),I.push(O)):O=I[R],O}function y(){l=new WeakMap}return{get:m,dispose:y}}class ux extends js{constructor(r){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=qo,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(r)}copy(r){return super.copy(r),this.depthPacking=r.depthPacking,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this}}class dx extends js{constructor(r){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(r)}copy(r){return super.copy(r),this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this}}const LF=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,PF=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function DF(w,r,l){let m=new fg;const y=new en,_=new en,R=new ur,I=new ux({depthPacking:Ha}),O=new dx,N={},V=l.maxTextureSize,Q={[C]:T,[T]:C,[L]:L},X=new Ka({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new en},radius:{value:4}},vertexShader:LF,fragmentShader:PF}),$=X.clone();$.defines.HORIZONTAL_PASS=1;const ie=new Yi;ie.setAttribute("position",new Sr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ue=new Os(ie,X),re=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=E;let q=this.type;this.render=function(ze,He,et){if(re.enabled===!1||re.autoUpdate===!1&&re.needsUpdate===!1||ze.length===0)return;const st=w.getRenderTarget(),Be=w.getActiveCubeFace(),Xe=w.getActiveMipmapLevel(),rt=w.state;rt.setBlending(F),rt.buffers.color.setClear(1,1,1,1),rt.buffers.depth.setTest(!0),rt.setScissorTest(!1);const bt=q!==M&&this.type===M,Gt=q===M&&this.type!==M;for(let lt=0,wt=ze.length;lt<wt;lt++){const Kt=ze[lt],qt=Kt.shadow;if(qt===void 0){console.warn("THREE.WebGLShadowMap:",Kt,"has no shadow.");continue}if(qt.autoUpdate===!1&&qt.needsUpdate===!1)continue;y.copy(qt.mapSize);const ln=qt.getFrameExtents();if(y.multiply(ln),_.copy(qt.mapSize),(y.x>V||y.y>V)&&(y.x>V&&(_.x=Math.floor(V/ln.x),y.x=_.x*ln.x,qt.mapSize.x=_.x),y.y>V&&(_.y=Math.floor(V/ln.y),y.y=_.y*ln.y,qt.mapSize.y=_.y)),qt.map===null||bt===!0||Gt===!0){const pn=this.type!==M?{minFilter:at,magFilter:at}:{};qt.map!==null&&qt.map.dispose(),qt.map=new yo(y.x,y.y,pn),qt.map.texture.name=Kt.name+".shadowMap",qt.camera.updateProjectionMatrix()}w.setRenderTarget(qt.map),w.clear();const Jt=qt.getViewportCount();for(let pn=0;pn<Jt;pn++){const dn=qt.getViewport(pn);R.set(_.x*dn.x,_.y*dn.y,_.x*dn.z,_.y*dn.w),rt.viewport(R),qt.updateMatrices(Kt,pn),m=qt.getFrustum(),Me(He,et,qt.camera,Kt,this.type)}qt.isPointLightShadow!==!0&&this.type===M&&Se(qt,et),qt.needsUpdate=!1}q=this.type,re.needsUpdate=!1,w.setRenderTarget(st,Be,Xe)};function Se(ze,He){const et=r.update(ue);X.defines.VSM_SAMPLES!==ze.blurSamples&&(X.defines.VSM_SAMPLES=ze.blurSamples,$.defines.VSM_SAMPLES=ze.blurSamples,X.needsUpdate=!0,$.needsUpdate=!0),ze.mapPass===null&&(ze.mapPass=new yo(y.x,y.y)),X.uniforms.shadow_pass.value=ze.map.texture,X.uniforms.resolution.value=ze.mapSize,X.uniforms.radius.value=ze.radius,w.setRenderTarget(ze.mapPass),w.clear(),w.renderBufferDirect(He,null,et,X,ue,null),$.uniforms.shadow_pass.value=ze.mapPass.texture,$.uniforms.resolution.value=ze.mapSize,$.uniforms.radius.value=ze.radius,w.setRenderTarget(ze.map),w.clear(),w.renderBufferDirect(He,null,et,$,ue,null)}function fe(ze,He,et,st){let Be=null;const Xe=et.isPointLight===!0?ze.customDistanceMaterial:ze.customDepthMaterial;if(Xe!==void 0)Be=Xe;else if(Be=et.isPointLight===!0?O:I,w.localClippingEnabled&&He.clipShadows===!0&&Array.isArray(He.clippingPlanes)&&He.clippingPlanes.length!==0||He.displacementMap&&He.displacementScale!==0||He.alphaMap&&He.alphaTest>0||He.map&&He.alphaTest>0){const rt=Be.uuid,bt=He.uuid;let Gt=N[rt];Gt===void 0&&(Gt={},N[rt]=Gt);let lt=Gt[bt];lt===void 0&&(lt=Be.clone(),Gt[bt]=lt),Be=lt}if(Be.visible=He.visible,Be.wireframe=He.wireframe,st===M?Be.side=He.shadowSide!==null?He.shadowSide:He.side:Be.side=He.shadowSide!==null?He.shadowSide:Q[He.side],Be.alphaMap=He.alphaMap,Be.alphaTest=He.alphaTest,Be.map=He.map,Be.clipShadows=He.clipShadows,Be.clippingPlanes=He.clippingPlanes,Be.clipIntersection=He.clipIntersection,Be.displacementMap=He.displacementMap,Be.displacementScale=He.displacementScale,Be.displacementBias=He.displacementBias,Be.wireframeLinewidth=He.wireframeLinewidth,Be.linewidth=He.linewidth,et.isPointLight===!0&&Be.isMeshDistanceMaterial===!0){const rt=w.properties.get(Be);rt.light=et}return Be}function Me(ze,He,et,st,Be){if(ze.visible===!1)return;if(ze.layers.test(He.layers)&&(ze.isMesh||ze.isLine||ze.isPoints)&&(ze.castShadow||ze.receiveShadow&&Be===M)&&(!ze.frustumCulled||m.intersectsObject(ze))){ze.modelViewMatrix.multiplyMatrices(et.matrixWorldInverse,ze.matrixWorld);const bt=r.update(ze),Gt=ze.material;if(Array.isArray(Gt)){const lt=bt.groups;for(let wt=0,Kt=lt.length;wt<Kt;wt++){const qt=lt[wt],ln=Gt[qt.materialIndex];if(ln&&ln.visible){const Jt=fe(ze,ln,st,Be);w.renderBufferDirect(et,null,bt,Jt,ze,qt)}}}else if(Gt.visible){const lt=fe(ze,Gt,st,Be);w.renderBufferDirect(et,null,bt,lt,ze,null)}}const rt=ze.children;for(let bt=0,Gt=rt.length;bt<Gt;bt++)Me(rt[bt],He,et,st,Be)}}function OF(w,r,l){const m=l.isWebGL2;function y(){let ot=!1;const xn=new ur;let tn=null;const An=new ur(0,0,0,0);return{setMask:function(kn){tn!==kn&&!ot&&(w.colorMask(kn,kn,kn,kn),tn=kn)},setLocked:function(kn){ot=kn},setClear:function(kn,Di,$i,Ki,En){En===!0&&(kn*=Ki,Di*=Ki,$i*=Ki),xn.set(kn,Di,$i,Ki),An.equals(xn)===!1&&(w.clearColor(kn,Di,$i,Ki),An.copy(xn))},reset:function(){ot=!1,tn=null,An.set(-1,0,0,0)}}}function _(){let ot=!1,xn=null,tn=null,An=null;return{setTest:function(kn){kn?ei(w.DEPTH_TEST):ii(w.DEPTH_TEST)},setMask:function(kn){xn!==kn&&!ot&&(w.depthMask(kn),xn=kn)},setFunc:function(kn){if(tn!==kn){switch(kn){case Ft:w.depthFunc(w.NEVER);break;case Qt:w.depthFunc(w.ALWAYS);break;case Xt:w.depthFunc(w.LESS);break;case Tn:w.depthFunc(w.LEQUAL);break;case vn:w.depthFunc(w.EQUAL);break;case Fe:w.depthFunc(w.GEQUAL);break;case Te:w.depthFunc(w.GREATER);break;case pt:w.depthFunc(w.NOTEQUAL);break;default:w.depthFunc(w.LEQUAL)}tn=kn}},setLocked:function(kn){ot=kn},setClear:function(kn){An!==kn&&(w.clearDepth(kn),An=kn)},reset:function(){ot=!1,xn=null,tn=null,An=null}}}function R(){let ot=!1,xn=null,tn=null,An=null,kn=null,Di=null,$i=null,Ki=null,En=null;return{setTest:function(ui){ot||(ui?ei(w.STENCIL_TEST):ii(w.STENCIL_TEST))},setMask:function(ui){xn!==ui&&!ot&&(w.stencilMask(ui),xn=ui)},setFunc:function(ui,xr,Fs){(tn!==ui||An!==xr||kn!==Fs)&&(w.stencilFunc(ui,xr,Fs),tn=ui,An=xr,kn=Fs)},setOp:function(ui,xr,Fs){(Di!==ui||$i!==xr||Ki!==Fs)&&(w.stencilOp(ui,xr,Fs),Di=ui,$i=xr,Ki=Fs)},setLocked:function(ui){ot=ui},setClear:function(ui){En!==ui&&(w.clearStencil(ui),En=ui)},reset:function(){ot=!1,xn=null,tn=null,An=null,kn=null,Di=null,$i=null,Ki=null,En=null}}}const I=new y,O=new _,N=new R,V=new WeakMap,Q=new WeakMap;let X={},$={},ie=new WeakMap,ue=[],re=null,q=!1,Se=null,fe=null,Me=null,ze=null,He=null,et=null,st=null,Be=new Hn(0,0,0),Xe=0,rt=!1,bt=null,Gt=null,lt=null,wt=null,Kt=null;const qt=w.getParameter(w.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ln=!1,Jt=0;const pn=w.getParameter(w.VERSION);pn.indexOf("WebGL")!==-1?(Jt=parseFloat(/^WebGL (\d)/.exec(pn)[1]),ln=Jt>=1):pn.indexOf("OpenGL ES")!==-1&&(Jt=parseFloat(/^OpenGL ES (\d)/.exec(pn)[1]),ln=Jt>=2);let dn=null,Qn={};const Qi=w.getParameter(w.SCISSOR_BOX),ki=w.getParameter(w.VIEWPORT),Ht=new ur().fromArray(Qi),Sn=new ur().fromArray(ki);function _n(ot,xn,tn,An){const kn=new Uint8Array(4),Di=w.createTexture();w.bindTexture(ot,Di),w.texParameteri(ot,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(ot,w.TEXTURE_MAG_FILTER,w.NEAREST);for(let $i=0;$i<tn;$i++)m&&(ot===w.TEXTURE_3D||ot===w.TEXTURE_2D_ARRAY)?w.texImage3D(xn,0,w.RGBA,1,1,An,0,w.RGBA,w.UNSIGNED_BYTE,kn):w.texImage2D(xn+$i,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,kn);return Di}const wi={};wi[w.TEXTURE_2D]=_n(w.TEXTURE_2D,w.TEXTURE_2D,1),wi[w.TEXTURE_CUBE_MAP]=_n(w.TEXTURE_CUBE_MAP,w.TEXTURE_CUBE_MAP_POSITIVE_X,6),m&&(wi[w.TEXTURE_2D_ARRAY]=_n(w.TEXTURE_2D_ARRAY,w.TEXTURE_2D_ARRAY,1,1),wi[w.TEXTURE_3D]=_n(w.TEXTURE_3D,w.TEXTURE_3D,1,1)),I.setClear(0,0,0,1),O.setClear(1),N.setClear(0),ei(w.DEPTH_TEST),O.setFunc(Tn),mi(!1),ti(g),ei(w.CULL_FACE),rn(F);function ei(ot){X[ot]!==!0&&(w.enable(ot),X[ot]=!0)}function ii(ot){X[ot]!==!1&&(w.disable(ot),X[ot]=!1)}function yi(ot,xn){return $[ot]!==xn?(w.bindFramebuffer(ot,xn),$[ot]=xn,m&&(ot===w.DRAW_FRAMEBUFFER&&($[w.FRAMEBUFFER]=xn),ot===w.FRAMEBUFFER&&($[w.DRAW_FRAMEBUFFER]=xn)),!0):!1}function nn(ot,xn){let tn=ue,An=!1;if(ot)if(tn=ie.get(xn),tn===void 0&&(tn=[],ie.set(xn,tn)),ot.isWebGLMultipleRenderTargets){const kn=ot.texture;if(tn.length!==kn.length||tn[0]!==w.COLOR_ATTACHMENT0){for(let Di=0,$i=kn.length;Di<$i;Di++)tn[Di]=w.COLOR_ATTACHMENT0+Di;tn.length=kn.length,An=!0}}else tn[0]!==w.COLOR_ATTACHMENT0&&(tn[0]=w.COLOR_ATTACHMENT0,An=!0);else tn[0]!==w.BACK&&(tn[0]=w.BACK,An=!0);An&&(l.isWebGL2?w.drawBuffers(tn):r.get("WEBGL_draw_buffers").drawBuffersWEBGL(tn))}function ct(ot){return re!==ot?(w.useProgram(ot),re=ot,!0):!1}const hn={[z]:w.FUNC_ADD,[j]:w.FUNC_SUBTRACT,[G]:w.FUNC_REVERSE_SUBTRACT};if(m)hn[H]=w.MIN,hn[te]=w.MAX;else{const ot=r.get("EXT_blend_minmax");ot!==null&&(hn[H]=ot.MIN_EXT,hn[te]=ot.MAX_EXT)}const In={[Z]:w.ZERO,[ee]:w.ONE,[oe]:w.SRC_COLOR,[Pe]:w.SRC_ALPHA,[nt]:w.SRC_ALPHA_SATURATE,[Oe]:w.DST_COLOR,[Ce]:w.DST_ALPHA,[xe]:w.ONE_MINUS_SRC_COLOR,[me]:w.ONE_MINUS_SRC_ALPHA,[$e]:w.ONE_MINUS_DST_COLOR,[Je]:w.ONE_MINUS_DST_ALPHA,[gt]:w.CONSTANT_COLOR,[Tt]:w.ONE_MINUS_CONSTANT_COLOR,[Ze]:w.CONSTANT_ALPHA,[mn]:w.ONE_MINUS_CONSTANT_ALPHA};function rn(ot,xn,tn,An,kn,Di,$i,Ki,En,ui){if(ot===F){q===!0&&(ii(w.BLEND),q=!1);return}if(q===!1&&(ei(w.BLEND),q=!0),ot!==J){if(ot!==Se||ui!==rt){if((fe!==z||He!==z)&&(w.blendEquation(w.FUNC_ADD),fe=z,He=z),ui)switch(ot){case D:w.blendFuncSeparate(w.ONE,w.ONE_MINUS_SRC_ALPHA,w.ONE,w.ONE_MINUS_SRC_ALPHA);break;case P:w.blendFunc(w.ONE,w.ONE);break;case U:w.blendFuncSeparate(w.ZERO,w.ONE_MINUS_SRC_COLOR,w.ZERO,w.ONE);break;case K:w.blendFuncSeparate(w.ZERO,w.SRC_COLOR,w.ZERO,w.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ot);break}else switch(ot){case D:w.blendFuncSeparate(w.SRC_ALPHA,w.ONE_MINUS_SRC_ALPHA,w.ONE,w.ONE_MINUS_SRC_ALPHA);break;case P:w.blendFunc(w.SRC_ALPHA,w.ONE);break;case U:w.blendFuncSeparate(w.ZERO,w.ONE_MINUS_SRC_COLOR,w.ZERO,w.ONE);break;case K:w.blendFunc(w.ZERO,w.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ot);break}Me=null,ze=null,et=null,st=null,Be.set(0,0,0),Xe=0,Se=ot,rt=ui}return}kn=kn||xn,Di=Di||tn,$i=$i||An,(xn!==fe||kn!==He)&&(w.blendEquationSeparate(hn[xn],hn[kn]),fe=xn,He=kn),(tn!==Me||An!==ze||Di!==et||$i!==st)&&(w.blendFuncSeparate(In[tn],In[An],In[Di],In[$i]),Me=tn,ze=An,et=Di,st=$i),(Ki.equals(Be)===!1||En!==Xe)&&(w.blendColor(Ki.r,Ki.g,Ki.b,En),Be.copy(Ki),Xe=En),Se=ot,rt=!1}function Gn(ot,xn){ot.side===L?ii(w.CULL_FACE):ei(w.CULL_FACE);let tn=ot.side===T;xn&&(tn=!tn),mi(tn),ot.blending===D&&ot.transparent===!1?rn(F):rn(ot.blending,ot.blendEquation,ot.blendSrc,ot.blendDst,ot.blendEquationAlpha,ot.blendSrcAlpha,ot.blendDstAlpha,ot.blendColor,ot.blendAlpha,ot.premultipliedAlpha),O.setFunc(ot.depthFunc),O.setTest(ot.depthTest),O.setMask(ot.depthWrite),I.setMask(ot.colorWrite);const An=ot.stencilWrite;N.setTest(An),An&&(N.setMask(ot.stencilWriteMask),N.setFunc(ot.stencilFunc,ot.stencilRef,ot.stencilFuncMask),N.setOp(ot.stencilFail,ot.stencilZFail,ot.stencilZPass)),ir(ot.polygonOffset,ot.polygonOffsetFactor,ot.polygonOffsetUnits),ot.alphaToCoverage===!0?ei(w.SAMPLE_ALPHA_TO_COVERAGE):ii(w.SAMPLE_ALPHA_TO_COVERAGE)}function mi(ot){bt!==ot&&(ot?w.frontFace(w.CW):w.frontFace(w.CCW),bt=ot)}function ti(ot){ot!==A?(ei(w.CULL_FACE),ot!==Gt&&(ot===g?w.cullFace(w.BACK):ot===v?w.cullFace(w.FRONT):w.cullFace(w.FRONT_AND_BACK))):ii(w.CULL_FACE),Gt=ot}function gi(ot){ot!==lt&&(ln&&w.lineWidth(ot),lt=ot)}function ir(ot,xn,tn){ot?(ei(w.POLYGON_OFFSET_FILL),(wt!==xn||Kt!==tn)&&(w.polygonOffset(xn,tn),wt=xn,Kt=tn)):ii(w.POLYGON_OFFSET_FILL)}function Lr(ot){ot?ei(w.SCISSOR_TEST):ii(w.SCISSOR_TEST)}function fs(ot){ot===void 0&&(ot=w.TEXTURE0+qt-1),dn!==ot&&(w.activeTexture(ot),dn=ot)}function br(ot,xn,tn){tn===void 0&&(dn===null?tn=w.TEXTURE0+qt-1:tn=dn);let An=Qn[tn];An===void 0&&(An={type:void 0,texture:void 0},Qn[tn]=An),(An.type!==ot||An.texture!==xn)&&(dn!==tn&&(w.activeTexture(tn),dn=tn),w.bindTexture(ot,xn||wi[ot]),An.type=ot,An.texture=xn)}function gr(){const ot=Qn[dn];ot!==void 0&&ot.type!==void 0&&(w.bindTexture(ot.type,null),ot.type=void 0,ot.texture=void 0)}function $r(){try{w.compressedTexImage2D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Mo(){try{w.compressedTexImage3D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function qe(){try{w.texSubImage2D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Ie(){try{w.texSubImage3D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function St(){try{w.compressedTexSubImage2D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function an(){try{w.compressedTexSubImage3D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function un(){try{w.texStorage2D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function cn(){try{w.texStorage3D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function hi(){try{w.texImage2D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function zn(){try{w.texImage3D.apply(w,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Yn(ot){Ht.equals(ot)===!1&&(w.scissor(ot.x,ot.y,ot.z,ot.w),Ht.copy(ot))}function Ai(ot){Sn.equals(ot)===!1&&(w.viewport(ot.x,ot.y,ot.z,ot.w),Sn.copy(ot))}function sr(ot,xn){let tn=Q.get(xn);tn===void 0&&(tn=new WeakMap,Q.set(xn,tn));let An=tn.get(ot);An===void 0&&(An=w.getUniformBlockIndex(xn,ot.name),tn.set(ot,An))}function wn(ot,xn){const An=Q.get(xn).get(ot);V.get(xn)!==An&&(w.uniformBlockBinding(xn,An,ot.__bindingPointIndex),V.set(xn,An))}function Ur(){w.disable(w.BLEND),w.disable(w.CULL_FACE),w.disable(w.DEPTH_TEST),w.disable(w.POLYGON_OFFSET_FILL),w.disable(w.SCISSOR_TEST),w.disable(w.STENCIL_TEST),w.disable(w.SAMPLE_ALPHA_TO_COVERAGE),w.blendEquation(w.FUNC_ADD),w.blendFunc(w.ONE,w.ZERO),w.blendFuncSeparate(w.ONE,w.ZERO,w.ONE,w.ZERO),w.blendColor(0,0,0,0),w.colorMask(!0,!0,!0,!0),w.clearColor(0,0,0,0),w.depthMask(!0),w.depthFunc(w.LESS),w.clearDepth(1),w.stencilMask(4294967295),w.stencilFunc(w.ALWAYS,0,4294967295),w.stencilOp(w.KEEP,w.KEEP,w.KEEP),w.clearStencil(0),w.cullFace(w.BACK),w.frontFace(w.CCW),w.polygonOffset(0,0),w.activeTexture(w.TEXTURE0),w.bindFramebuffer(w.FRAMEBUFFER,null),m===!0&&(w.bindFramebuffer(w.DRAW_FRAMEBUFFER,null),w.bindFramebuffer(w.READ_FRAMEBUFFER,null)),w.useProgram(null),w.lineWidth(1),w.scissor(0,0,w.canvas.width,w.canvas.height),w.viewport(0,0,w.canvas.width,w.canvas.height),X={},dn=null,Qn={},$={},ie=new WeakMap,ue=[],re=null,q=!1,Se=null,fe=null,Me=null,ze=null,He=null,et=null,st=null,Be=new Hn(0,0,0),Xe=0,rt=!1,bt=null,Gt=null,lt=null,wt=null,Kt=null,Ht.set(0,0,w.canvas.width,w.canvas.height),Sn.set(0,0,w.canvas.width,w.canvas.height),I.reset(),O.reset(),N.reset()}return{buffers:{color:I,depth:O,stencil:N},enable:ei,disable:ii,bindFramebuffer:yi,drawBuffers:nn,useProgram:ct,setBlending:rn,setMaterial:Gn,setFlipSided:mi,setCullFace:ti,setLineWidth:gi,setPolygonOffset:ir,setScissorTest:Lr,activeTexture:fs,bindTexture:br,unbindTexture:gr,compressedTexImage2D:$r,compressedTexImage3D:Mo,texImage2D:hi,texImage3D:zn,updateUBOMapping:sr,uniformBlockBinding:wn,texStorage2D:un,texStorage3D:cn,texSubImage2D:qe,texSubImage3D:Ie,compressedTexSubImage2D:St,compressedTexSubImage3D:an,scissor:Yn,viewport:Ai,reset:Ur}}function FF(w,r,l,m,y,_,R){const I=y.isWebGL2,O=y.maxTextures,N=y.maxCubemapSize,V=y.maxTextureSize,Q=y.maxSamples,X=r.has("WEBGL_multisampled_render_to_texture")?r.get("WEBGL_multisampled_render_to_texture"):null,$=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ie=r.has("OCULUS_multiview")?r.get("OCULUS_multiview"):null,ue=new WeakMap;let re;const q=new WeakMap;let Se=[],fe=!1,Me=!1;try{Me=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ze(qe,Ie){return Me?new OffscreenCanvas(qe,Ie):hh("canvas")}function He(qe,Ie,St,an){let un=1;if((qe.width>an||qe.height>an)&&(un=an/Math.max(qe.width,qe.height)),un<1||Ie===!0)if(typeof HTMLImageElement<"u"&&qe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&qe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&qe instanceof ImageBitmap){const cn=Ie?mu:Math.floor,hi=cn(un*qe.width),zn=cn(un*qe.height);re===void 0&&(re=ze(hi,zn));const Yn=St?ze(hi,zn):re;return Yn.width=hi,Yn.height=zn,Yn.getContext("2d").drawImage(qe,0,0,hi,zn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+qe.width+"x"+qe.height+") to ("+hi+"x"+zn+")."),Yn}else return"data"in qe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+qe.width+"x"+qe.height+")."),qe;return qe}function et(qe){return Tf(qe.width)&&Tf(qe.height)}function st(qe){return I?!1:qe.wrapS!==We||qe.wrapT!==We||qe.minFilter!==at&&qe.minFilter!==Bn}function Be(qe,Ie){return qe.generateMipmaps&&Ie&&qe.minFilter!==at&&qe.minFilter!==Bn}function Xe(qe){w.generateMipmap(qe)}function rt(qe,Ie,St,an,un=!1){if(I===!1)return Ie;if(qe!==null){if(w[qe]!==void 0)return w[qe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+qe+"'")}let cn=Ie;if(Ie===w.RED&&(St===w.FLOAT&&(cn=w.R32F),St===w.HALF_FLOAT&&(cn=w.R16F),St===w.UNSIGNED_BYTE&&(cn=w.R8)),Ie===w.RED_INTEGER&&(St===w.UNSIGNED_BYTE&&(cn=w.R8UI),St===w.UNSIGNED_SHORT&&(cn=w.R16UI),St===w.UNSIGNED_INT&&(cn=w.R32UI),St===w.BYTE&&(cn=w.R8I),St===w.SHORT&&(cn=w.R16I),St===w.INT&&(cn=w.R32I)),Ie===w.RG&&(St===w.FLOAT&&(cn=w.RG32F),St===w.HALF_FLOAT&&(cn=w.RG16F),St===w.UNSIGNED_BYTE&&(cn=w.RG8)),Ie===w.RGBA){const hi=un?rh:vr.getTransfer(an);St===w.FLOAT&&(cn=w.RGBA32F),St===w.HALF_FLOAT&&(cn=w.RGBA16F),St===w.UNSIGNED_BYTE&&(cn=hi===wr?w.SRGB8_ALPHA8:w.RGBA8),St===w.UNSIGNED_SHORT_4_4_4_4&&(cn=w.RGBA4),St===w.UNSIGNED_SHORT_5_5_5_1&&(cn=w.RGB5_A1)}return(cn===w.R16F||cn===w.R32F||cn===w.RG16F||cn===w.RG32F||cn===w.RGBA16F||cn===w.RGBA32F)&&r.get("EXT_color_buffer_float"),cn}function bt(qe,Ie,St){return Be(qe,St)===!0||qe.isFramebufferTexture&&qe.minFilter!==at&&qe.minFilter!==Bn?Math.log2(Math.max(Ie.width,Ie.height))+1:qe.mipmaps!==void 0&&qe.mipmaps.length>0?qe.mipmaps.length:qe.isCompressedTexture&&Array.isArray(qe.image)?Ie.mipmaps.length:1}function Gt(qe){return qe===at||qe===At||qe===Pt?w.NEAREST:w.LINEAR}function lt(qe){const Ie=qe.target;Ie.removeEventListener("dispose",lt),Kt(Ie),Ie.isVideoTexture&&ue.delete(Ie)}function wt(qe){const Ie=qe.target;Ie.removeEventListener("dispose",wt),ln(Ie)}function Kt(qe){const Ie=m.get(qe);if(Ie.__webglInit===void 0)return;const St=qe.source,an=q.get(St);if(an){const un=an[Ie.__cacheKey];un.usedTimes--,un.usedTimes===0&&qt(qe),Object.keys(an).length===0&&q.delete(St)}m.remove(qe)}function qt(qe){const Ie=m.get(qe);w.deleteTexture(Ie.__webglTexture);const St=qe.source,an=q.get(St);delete an[Ie.__cacheKey],R.memory.textures--}function ln(qe){const Ie=qe.texture,St=m.get(qe),an=m.get(Ie);if(an.__webglTexture!==void 0&&(w.deleteTexture(an.__webglTexture),R.memory.textures--),qe.depthTexture&&qe.depthTexture.dispose(),qe.isWebGLCubeRenderTarget)for(let un=0;un<6;un++){if(Array.isArray(St.__webglFramebuffer[un]))for(let cn=0;cn<St.__webglFramebuffer[un].length;cn++)w.deleteFramebuffer(St.__webglFramebuffer[un][cn]);else w.deleteFramebuffer(St.__webglFramebuffer[un]);St.__webglDepthbuffer&&w.deleteRenderbuffer(St.__webglDepthbuffer[un])}else{if(Array.isArray(St.__webglFramebuffer))for(let un=0;un<St.__webglFramebuffer.length;un++)w.deleteFramebuffer(St.__webglFramebuffer[un]);else w.deleteFramebuffer(St.__webglFramebuffer);if(St.__webglDepthbuffer&&w.deleteRenderbuffer(St.__webglDepthbuffer),St.__webglMultisampledFramebuffer&&w.deleteFramebuffer(St.__webglMultisampledFramebuffer),St.__webglColorRenderbuffer)for(let un=0;un<St.__webglColorRenderbuffer.length;un++)St.__webglColorRenderbuffer[un]&&w.deleteRenderbuffer(St.__webglColorRenderbuffer[un]);St.__webglDepthRenderbuffer&&w.deleteRenderbuffer(St.__webglDepthRenderbuffer)}if(qe.isWebGLMultipleRenderTargets)for(let un=0,cn=Ie.length;un<cn;un++){const hi=m.get(Ie[un]);hi.__webglTexture&&(w.deleteTexture(hi.__webglTexture),R.memory.textures--),m.remove(Ie[un])}m.remove(Ie),m.remove(qe)}let Jt=0;function pn(){Jt=0}function dn(){const qe=Jt;return qe>=O&&console.warn("THREE.WebGLTextures: Trying to use "+qe+" texture units while this GPU supports only "+O),Jt+=1,qe}function Qn(qe){const Ie=[];return Ie.push(qe.wrapS),Ie.push(qe.wrapT),Ie.push(qe.wrapR||0),Ie.push(qe.magFilter),Ie.push(qe.minFilter),Ie.push(qe.anisotropy),Ie.push(qe.internalFormat),Ie.push(qe.format),Ie.push(qe.type),Ie.push(qe.generateMipmaps),Ie.push(qe.premultiplyAlpha),Ie.push(qe.flipY),Ie.push(qe.unpackAlignment),Ie.push(qe.colorSpace),Ie.join()}function Qi(qe,Ie){const St=m.get(qe);if(qe.isVideoTexture&&$r(qe),qe.isRenderTargetTexture===!1&&qe.version>0&&St.__version!==qe.version){const an=qe.image;if(an===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(an.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(hn(St,qe,Ie))return}l.bindTexture(w.TEXTURE_2D,St.__webglTexture,w.TEXTURE0+Ie)}function ki(qe,Ie){const St=m.get(qe);if(qe.version>0&&St.__version!==qe.version){hn(St,qe,Ie);return}l.bindTexture(w.TEXTURE_2D_ARRAY,St.__webglTexture,w.TEXTURE0+Ie)}function Ht(qe,Ie){const St=m.get(qe);if(qe.version>0&&St.__version!==qe.version){hn(St,qe,Ie);return}l.bindTexture(w.TEXTURE_3D,St.__webglTexture,w.TEXTURE0+Ie)}function Sn(qe,Ie){const St=m.get(qe);if(qe.version>0&&St.__version!==qe.version){In(St,qe,Ie);return}l.bindTexture(w.TEXTURE_CUBE_MAP,St.__webglTexture,w.TEXTURE0+Ie)}const _n={[Re]:w.REPEAT,[We]:w.CLAMP_TO_EDGE,[ve]:w.MIRRORED_REPEAT},wi={[at]:w.NEAREST,[At]:w.NEAREST_MIPMAP_NEAREST,[Pt]:w.NEAREST_MIPMAP_LINEAR,[Bn]:w.LINEAR,[pi]:w.LINEAR_MIPMAP_NEAREST,[Fn]:w.LINEAR_MIPMAP_LINEAR},ei={[Dm]:w.NEVER,[Gm]:w.ALWAYS,[Om]:w.LESS,[Nm]:w.LEQUAL,[Fm]:w.EQUAL,[zm]:w.GEQUAL,[Um]:w.GREATER,[km]:w.NOTEQUAL};function ii(qe,Ie,St){if(St?(w.texParameteri(qe,w.TEXTURE_WRAP_S,_n[Ie.wrapS]),w.texParameteri(qe,w.TEXTURE_WRAP_T,_n[Ie.wrapT]),(qe===w.TEXTURE_3D||qe===w.TEXTURE_2D_ARRAY)&&w.texParameteri(qe,w.TEXTURE_WRAP_R,_n[Ie.wrapR]),w.texParameteri(qe,w.TEXTURE_MAG_FILTER,wi[Ie.magFilter]),w.texParameteri(qe,w.TEXTURE_MIN_FILTER,wi[Ie.minFilter])):(w.texParameteri(qe,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(qe,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),(qe===w.TEXTURE_3D||qe===w.TEXTURE_2D_ARRAY)&&w.texParameteri(qe,w.TEXTURE_WRAP_R,w.CLAMP_TO_EDGE),(Ie.wrapS!==We||Ie.wrapT!==We)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),w.texParameteri(qe,w.TEXTURE_MAG_FILTER,Gt(Ie.magFilter)),w.texParameteri(qe,w.TEXTURE_MIN_FILTER,Gt(Ie.minFilter)),Ie.minFilter!==at&&Ie.minFilter!==Bn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Ie.compareFunction&&(w.texParameteri(qe,w.TEXTURE_COMPARE_MODE,w.COMPARE_REF_TO_TEXTURE),w.texParameteri(qe,w.TEXTURE_COMPARE_FUNC,ei[Ie.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){const an=r.get("EXT_texture_filter_anisotropic");if(Ie.magFilter===at||Ie.minFilter!==Pt&&Ie.minFilter!==Fn||Ie.type===Ei&&r.has("OES_texture_float_linear")===!1||I===!1&&Ie.type===Fi&&r.has("OES_texture_half_float_linear")===!1)return;(Ie.anisotropy>1||m.get(Ie).__currentAnisotropy)&&(w.texParameterf(qe,an.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ie.anisotropy,y.getMaxAnisotropy())),m.get(Ie).__currentAnisotropy=Ie.anisotropy)}}function yi(qe,Ie){let St=!1;qe.__webglInit===void 0&&(qe.__webglInit=!0,Ie.addEventListener("dispose",lt));const an=Ie.source;let un=q.get(an);un===void 0&&(un={},q.set(an,un));const cn=Qn(Ie);if(cn!==qe.__cacheKey){un[cn]===void 0&&(un[cn]={texture:w.createTexture(),usedTimes:0},R.memory.textures++,St=!0),un[cn].usedTimes++;const hi=un[qe.__cacheKey];hi!==void 0&&(un[qe.__cacheKey].usedTimes--,hi.usedTimes===0&&qt(Ie)),qe.__cacheKey=cn,qe.__webglTexture=un[cn].texture}return St}function nn(qe){fe=qe}function ct(){const qe=fe;fe=!1;for(const Ie of Se)hn(Ie.textureProperties,Ie.texture,Ie.slot),Ie.texture.isPendingDeferredUpload=!1;Se=[],fe=qe}function hn(qe,Ie,St){if(fe)return Ie.isPendingDeferredUpload||(Ie.isPendingDeferredUpload=!0,Se.push({textureProperties:qe,texture:Ie,slot:St})),!1;let an=w.TEXTURE_2D;(Ie.isDataArrayTexture||Ie.isCompressedArrayTexture)&&(an=w.TEXTURE_2D_ARRAY),Ie.isData3DTexture&&(an=w.TEXTURE_3D);const un=yi(qe,Ie),cn=Ie.source;l.bindTexture(an,qe.__webglTexture,w.TEXTURE0+St);const hi=m.get(cn);if(cn.version!==hi.__version||un===!0){l.activeTexture(w.TEXTURE0+St);const zn=vr.getPrimaries(vr.workingColorSpace),Yn=Ie.colorSpace===qr?null:vr.getPrimaries(Ie.colorSpace),Ai=Ie.colorSpace===qr||zn===Yn?w.NONE:w.BROWSER_DEFAULT_WEBGL;w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,Ie.flipY),w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ie.premultiplyAlpha),w.pixelStorei(w.UNPACK_ALIGNMENT,Ie.unpackAlignment),w.pixelStorei(w.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ai);const sr=st(Ie)&&et(Ie.image)===!1;let wn=He(Ie.image,sr,!1,V);wn=Mo(Ie,wn);const Ur=et(wn)||I,ot=_.convert(Ie.format,Ie.colorSpace);let xn=_.convert(Ie.type),tn=rt(Ie.internalFormat,ot,xn,Ie.colorSpace,Ie.isVideoTexture);ii(an,Ie,Ur);let An;const kn=Ie.mipmaps,Di=I&&Ie.isVideoTexture!==!0,$i=hi.__version===void 0||un===!0,Ki=bt(Ie,wn,Ur);if(Ie.isDepthTexture)tn=w.DEPTH_COMPONENT,I?Ie.type===Ei?tn=w.DEPTH_COMPONENT32F:Ie.type===$n?tn=w.DEPTH_COMPONENT24:Ie.type===cr?tn=w.DEPTH24_STENCIL8:tn=w.DEPTH_COMPONENT16:Ie.type===Ei&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Ie.format===be&&tn===w.DEPTH_COMPONENT&&Ie.type!==Ln&&Ie.type!==$n&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ie.type=$n,xn=_.convert(Ie.type)),Ie.format===Ve&&tn===w.DEPTH_COMPONENT&&(tn=w.DEPTH_STENCIL,Ie.type!==cr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ie.type=cr,xn=_.convert(Ie.type))),$i&&(Di?l.texStorage2D(w.TEXTURE_2D,1,tn,wn.width,wn.height):l.texImage2D(w.TEXTURE_2D,0,tn,wn.width,wn.height,0,ot,xn,null));else if(Ie.isDataTexture)if(kn.length>0&&Ur){Di&&$i&&l.texStorage2D(w.TEXTURE_2D,Ki,tn,kn[0].width,kn[0].height);for(let En=0,ui=kn.length;En<ui;En++)An=kn[En],Di?l.texSubImage2D(w.TEXTURE_2D,En,0,0,An.width,An.height,ot,xn,An.data):l.texImage2D(w.TEXTURE_2D,En,tn,An.width,An.height,0,ot,xn,An.data);Ie.generateMipmaps=!1}else Di?($i&&l.texStorage2D(w.TEXTURE_2D,Ki,tn,wn.width,wn.height),l.texSubImage2D(w.TEXTURE_2D,0,0,0,wn.width,wn.height,ot,xn,wn.data)):l.texImage2D(w.TEXTURE_2D,0,tn,wn.width,wn.height,0,ot,xn,wn.data);else if(Ie.isCompressedTexture)if(Ie.isCompressedArrayTexture){Di&&$i&&l.texStorage3D(w.TEXTURE_2D_ARRAY,Ki,tn,kn[0].width,kn[0].height,wn.depth);for(let En=0,ui=kn.length;En<ui;En++)An=kn[En],Ie.format!==ht?ot!==null?Di?l.compressedTexSubImage3D(w.TEXTURE_2D_ARRAY,En,0,0,0,An.width,An.height,wn.depth,ot,An.data,0,0):l.compressedTexImage3D(w.TEXTURE_2D_ARRAY,En,tn,An.width,An.height,wn.depth,0,An.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Di?l.texSubImage3D(w.TEXTURE_2D_ARRAY,En,0,0,0,An.width,An.height,wn.depth,ot,xn,An.data):l.texImage3D(w.TEXTURE_2D_ARRAY,En,tn,An.width,An.height,wn.depth,0,ot,xn,An.data)}else{Di&&$i&&l.texStorage2D(w.TEXTURE_2D,Ki,tn,kn[0].width,kn[0].height);for(let En=0,ui=kn.length;En<ui;En++)An=kn[En],Ie.format!==ht?ot!==null?Di?l.compressedTexSubImage2D(w.TEXTURE_2D,En,0,0,An.width,An.height,ot,An.data):l.compressedTexImage2D(w.TEXTURE_2D,En,tn,An.width,An.height,0,An.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Di?l.texSubImage2D(w.TEXTURE_2D,En,0,0,An.width,An.height,ot,xn,An.data):l.texImage2D(w.TEXTURE_2D,En,tn,An.width,An.height,0,ot,xn,An.data)}else if(Ie.isDataArrayTexture)Di?($i&&l.texStorage3D(w.TEXTURE_2D_ARRAY,Ki,tn,wn.width,wn.height,wn.depth),l.texSubImage3D(w.TEXTURE_2D_ARRAY,0,0,0,0,wn.width,wn.height,wn.depth,ot,xn,wn.data)):l.texImage3D(w.TEXTURE_2D_ARRAY,0,tn,wn.width,wn.height,wn.depth,0,ot,xn,wn.data);else if(Ie.isData3DTexture)Di?($i&&l.texStorage3D(w.TEXTURE_3D,Ki,tn,wn.width,wn.height,wn.depth),l.texSubImage3D(w.TEXTURE_3D,0,0,0,0,wn.width,wn.height,wn.depth,ot,xn,wn.data)):l.texImage3D(w.TEXTURE_3D,0,tn,wn.width,wn.height,wn.depth,0,ot,xn,wn.data);else if(Ie.isFramebufferTexture){if($i)if(Di)l.texStorage2D(w.TEXTURE_2D,Ki,tn,wn.width,wn.height);else{let En=wn.width,ui=wn.height;for(let xr=0;xr<Ki;xr++)l.texImage2D(w.TEXTURE_2D,xr,tn,En,ui,0,ot,xn,null),En>>=1,ui>>=1}}else if(kn.length>0&&Ur){Di&&$i&&l.texStorage2D(w.TEXTURE_2D,Ki,tn,kn[0].width,kn[0].height);for(let En=0,ui=kn.length;En<ui;En++)An=kn[En],Di?l.texSubImage2D(w.TEXTURE_2D,En,0,0,ot,xn,An):l.texImage2D(w.TEXTURE_2D,En,tn,ot,xn,An);Ie.generateMipmaps=!1}else Di?($i&&l.texStorage2D(w.TEXTURE_2D,Ki,tn,wn.width,wn.height),l.texSubImage2D(w.TEXTURE_2D,0,0,0,ot,xn,wn)):l.texImage2D(w.TEXTURE_2D,0,tn,ot,xn,wn);Be(Ie,Ur)&&Xe(an),hi.__version=cn.version,Ie.onUpdate&&Ie.onUpdate(Ie)}return qe.__version=Ie.version,!0}function In(qe,Ie,St){if(Ie.image.length!==6)return;const an=yi(qe,Ie),un=Ie.source;l.bindTexture(w.TEXTURE_CUBE_MAP,qe.__webglTexture,w.TEXTURE0+St);const cn=m.get(un);if(un.version!==cn.__version||an===!0){l.activeTexture(w.TEXTURE0+St);const hi=vr.getPrimaries(vr.workingColorSpace),zn=Ie.colorSpace===qr?null:vr.getPrimaries(Ie.colorSpace),Yn=Ie.colorSpace===qr||hi===zn?w.NONE:w.BROWSER_DEFAULT_WEBGL;w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,Ie.flipY),w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ie.premultiplyAlpha),w.pixelStorei(w.UNPACK_ALIGNMENT,Ie.unpackAlignment),w.pixelStorei(w.UNPACK_COLORSPACE_CONVERSION_WEBGL,Yn);const Ai=Ie.isCompressedTexture||Ie.image[0].isCompressedTexture,sr=Ie.image[0]&&Ie.image[0].isDataTexture,wn=[];for(let En=0;En<6;En++)!Ai&&!sr?wn[En]=He(Ie.image[En],!1,!0,N):wn[En]=sr?Ie.image[En].image:Ie.image[En],wn[En]=Mo(Ie,wn[En]);const Ur=wn[0],ot=et(Ur)||I,xn=_.convert(Ie.format,Ie.colorSpace),tn=_.convert(Ie.type),An=rt(Ie.internalFormat,xn,tn,Ie.colorSpace),kn=I&&Ie.isVideoTexture!==!0,Di=cn.__version===void 0||an===!0;let $i=bt(Ie,Ur,ot);ii(w.TEXTURE_CUBE_MAP,Ie,ot);let Ki;if(Ai){kn&&Di&&l.texStorage2D(w.TEXTURE_CUBE_MAP,$i,An,Ur.width,Ur.height);for(let En=0;En<6;En++){Ki=wn[En].mipmaps;for(let ui=0;ui<Ki.length;ui++){const xr=Ki[ui];Ie.format!==ht?xn!==null?kn?l.compressedTexSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui,0,0,xr.width,xr.height,xn,xr.data):l.compressedTexImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui,An,xr.width,xr.height,0,xr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):kn?l.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui,0,0,xr.width,xr.height,xn,tn,xr.data):l.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui,An,xr.width,xr.height,0,xn,tn,xr.data)}}}else{Ki=Ie.mipmaps,kn&&Di&&(Ki.length>0&&$i++,l.texStorage2D(w.TEXTURE_CUBE_MAP,$i,An,wn[0].width,wn[0].height));for(let En=0;En<6;En++)if(sr){kn?l.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,0,0,0,wn[En].width,wn[En].height,xn,tn,wn[En].data):l.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,0,An,wn[En].width,wn[En].height,0,xn,tn,wn[En].data);for(let ui=0;ui<Ki.length;ui++){const Fs=Ki[ui].image[En].image;kn?l.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui+1,0,0,Fs.width,Fs.height,xn,tn,Fs.data):l.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui+1,An,Fs.width,Fs.height,0,xn,tn,Fs.data)}}else{kn?l.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,0,0,0,xn,tn,wn[En]):l.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,0,An,xn,tn,wn[En]);for(let ui=0;ui<Ki.length;ui++){const xr=Ki[ui];kn?l.texSubImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui+1,0,0,xn,tn,xr.image[En]):l.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+En,ui+1,An,xn,tn,xr.image[En])}}}Be(Ie,ot)&&Xe(w.TEXTURE_CUBE_MAP),cn.__version=un.version,Ie.onUpdate&&Ie.onUpdate(Ie)}qe.__version=Ie.version}function rn(qe,Ie,St,an,un,cn){const hi=_.convert(St.format,St.colorSpace),zn=_.convert(St.type),Yn=rt(St.internalFormat,hi,zn,St.colorSpace);if(!m.get(Ie).__hasExternalTextures){const wn=Math.max(1,Ie.width>>cn),Ur=Math.max(1,Ie.height>>cn);Ie.isWebGLMultiviewRenderTarget===!0?l.texStorage3D(w.TEXTURE_2D_ARRAY,0,Yn,Ie.width,Ie.height,Ie.numViews):un===w.TEXTURE_3D||un===w.TEXTURE_2D_ARRAY?l.texImage3D(un,cn,Yn,wn,Ur,Ie.depth,0,hi,zn,null):l.texImage2D(un,cn,Yn,wn,Ur,0,hi,zn,null)}l.bindFramebuffer(w.FRAMEBUFFER,qe);const sr=gr(Ie);Ie.isWebGLMultiviewRenderTarget===!0?sr?ie.framebufferTextureMultisampleMultiviewOVR(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,m.get(St).__webglTexture,0,br(Ie),0,Ie.numViews):ie.framebufferTextureMultiviewOVR(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,m.get(St).__webglTexture,0,0,Ie.numViews):(un===w.TEXTURE_2D||un>=w.TEXTURE_CUBE_MAP_POSITIVE_X&&un<=w.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(sr?X.framebufferTexture2DMultisampleEXT(w.FRAMEBUFFER,an,un,m.get(St).__webglTexture,0,br(Ie)):w.framebufferTexture2D(w.FRAMEBUFFER,an,un,m.get(St).__webglTexture,cn)),l.bindFramebuffer(w.FRAMEBUFFER,null)}function Gn(qe,Ie,St){if(w.bindRenderbuffer(w.RENDERBUFFER,qe),Ie.isWebGLMultiviewRenderTarget===!0){const an=gr(Ie),un=Ie.numViews,cn=Ie.depthTexture;let hi=w.DEPTH_COMPONENT24,zn=w.DEPTH_ATTACHMENT;cn&&cn.isDepthTexture&&(cn.type===Ei?hi=w.DEPTH_COMPONENT32F:cn.type===cr&&(hi=w.DEPTH24_STENCIL8,zn=w.DEPTH_STENCIL_ATTACHMENT));let Yn=m.get(Ie.depthTexture).__webglTexture;Yn===void 0&&(Yn=w.createTexture(),w.bindTexture(w.TEXTURE_2D_ARRAY,Yn),w.texStorage3D(w.TEXTURE_2D_ARRAY,1,hi,Ie.width,Ie.height,un)),an?ie.framebufferTextureMultisampleMultiviewOVR(w.FRAMEBUFFER,zn,Yn,0,br(Ie),0,un):ie.framebufferTextureMultiviewOVR(w.FRAMEBUFFER,zn,Yn,0,0,un)}else if(Ie.depthBuffer&&!Ie.stencilBuffer){let an=I===!0?w.DEPTH_COMPONENT24:w.DEPTH_COMPONENT16;if(St||gr(Ie)){const un=Ie.depthTexture;un&&un.isDepthTexture&&(un.type===Ei?an=w.DEPTH_COMPONENT32F:un.type===$n&&(an=w.DEPTH_COMPONENT24));const cn=br(Ie);gr(Ie)?X.renderbufferStorageMultisampleEXT(w.RENDERBUFFER,cn,an,Ie.width,Ie.height):w.renderbufferStorageMultisample(w.RENDERBUFFER,cn,an,Ie.width,Ie.height)}else w.renderbufferStorage(w.RENDERBUFFER,an,Ie.width,Ie.height);w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.RENDERBUFFER,qe)}else if(Ie.depthBuffer&&Ie.stencilBuffer){const an=br(Ie);St&&gr(Ie)===!1?w.renderbufferStorageMultisample(w.RENDERBUFFER,an,w.DEPTH24_STENCIL8,Ie.width,Ie.height):gr(Ie)?X.renderbufferStorageMultisampleEXT(w.RENDERBUFFER,an,w.DEPTH24_STENCIL8,Ie.width,Ie.height):w.renderbufferStorage(w.RENDERBUFFER,w.DEPTH_STENCIL,Ie.width,Ie.height),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,w.RENDERBUFFER,qe)}else{const an=Ie.isWebGLMultipleRenderTargets===!0?Ie.texture:[Ie.texture];for(let un=0;un<an.length;un++){const cn=an[un],hi=_.convert(cn.format,cn.colorSpace),zn=_.convert(cn.type),Yn=rt(cn.internalFormat,hi,zn,cn.colorSpace),Ai=br(Ie);St&&gr(Ie)===!1?w.renderbufferStorageMultisample(w.RENDERBUFFER,Ai,Yn,Ie.width,Ie.height):gr(Ie)?X.renderbufferStorageMultisampleEXT(w.RENDERBUFFER,Ai,Yn,Ie.width,Ie.height):w.renderbufferStorage(w.RENDERBUFFER,Yn,Ie.width,Ie.height)}}w.bindRenderbuffer(w.RENDERBUFFER,null)}function mi(qe,Ie){if(Ie&&Ie.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(l.bindFramebuffer(w.FRAMEBUFFER,qe),!(Ie.depthTexture&&Ie.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!m.get(Ie.depthTexture).__webglTexture||Ie.depthTexture.image.width!==Ie.width||Ie.depthTexture.image.height!==Ie.height)&&(Ie.depthTexture.image.width=Ie.width,Ie.depthTexture.image.height=Ie.height,Ie.depthTexture.needsUpdate=!0),Qi(Ie.depthTexture,0),Ie.depthTexture.image.depth!=1?ki(Ie.depthTexture,0):Qi(Ie.depthTexture,0);const an=m.get(Ie.depthTexture).__webglTexture,un=br(Ie);if(Ie.isWebGLMultiviewRenderTarget===!0){const cn=gr(Ie),hi=Ie.numViews;if(Ie.depthTexture.format===be)cn?ie.framebufferTextureMultisampleMultiviewOVR(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,an,0,un,0,hi):ie.framebufferTextureMultiviewOVR(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,an,0,0,hi);else if(Ie.depthTexture.format===Ve)cn?ie.framebufferTextureMultisampleMultiviewOVR(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,an,0,un,0,hi):ie.framebufferTextureMultiviewOVR(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,an,0,0,hi);else throw new Error("Unknown depthTexture format")}else if(Ie.depthTexture.format===be)gr(Ie)?X.framebufferTexture2DMultisampleEXT(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.TEXTURE_2D,an,0,un):w.framebufferTexture2D(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.TEXTURE_2D,an,0);else if(Ie.depthTexture.format===Ve)gr(Ie)?X.framebufferTexture2DMultisampleEXT(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,w.TEXTURE_2D,an,0,un):w.framebufferTexture2D(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,w.TEXTURE_2D,an,0);else throw new Error("Unknown depthTexture format")}function ti(qe){const Ie=m.get(qe),St=qe.isWebGLCubeRenderTarget===!0;if(qe.depthTexture&&!Ie.__autoAllocateDepthBuffer){if(St)throw new Error("target.depthTexture not supported in Cube render targets");mi(Ie.__webglFramebuffer,qe)}else if(St){Ie.__webglDepthbuffer=[];for(let an=0;an<6;an++)l.bindFramebuffer(w.FRAMEBUFFER,Ie.__webglFramebuffer[an]),Ie.__webglDepthbuffer[an]=w.createRenderbuffer(),Gn(Ie.__webglDepthbuffer[an],qe,!1)}else l.bindFramebuffer(w.FRAMEBUFFER,Ie.__webglFramebuffer),Ie.__webglDepthbuffer=w.createRenderbuffer(),Gn(Ie.__webglDepthbuffer,qe,!1);l.bindFramebuffer(w.FRAMEBUFFER,null)}function gi(qe,Ie,St){const an=m.get(qe);Ie!==void 0&&rn(an.__webglFramebuffer,qe,qe.texture,w.COLOR_ATTACHMENT0,w.TEXTURE_2D,0),St!==void 0&&ti(qe)}function ir(qe){const Ie=qe.texture,St=m.get(qe),an=m.get(Ie);qe.addEventListener("dispose",wt),qe.isWebGLMultipleRenderTargets!==!0&&(an.__webglTexture===void 0&&(an.__webglTexture=w.createTexture()),an.__version=Ie.version,R.memory.textures++);const un=qe.isWebGLCubeRenderTarget===!0,cn=qe.isWebGLMultipleRenderTargets===!0,hi=et(qe)||I;if(un){St.__webglFramebuffer=[];for(let zn=0;zn<6;zn++)if(I&&Ie.mipmaps&&Ie.mipmaps.length>0){St.__webglFramebuffer[zn]=[];for(let Yn=0;Yn<Ie.mipmaps.length;Yn++)St.__webglFramebuffer[zn][Yn]=w.createFramebuffer()}else St.__webglFramebuffer[zn]=w.createFramebuffer()}else{if(I&&Ie.mipmaps&&Ie.mipmaps.length>0){St.__webglFramebuffer=[];for(let zn=0;zn<Ie.mipmaps.length;zn++)St.__webglFramebuffer[zn]=w.createFramebuffer()}else St.__webglFramebuffer=w.createFramebuffer();if(cn)if(y.drawBuffers){const zn=qe.texture;for(let Yn=0,Ai=zn.length;Yn<Ai;Yn++){const sr=m.get(zn[Yn]);sr.__webglTexture===void 0&&(sr.__webglTexture=w.createTexture(),R.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(I&&qe.samples>0&&gr(qe)===!1){const zn=cn?Ie:[Ie];St.__webglMultisampledFramebuffer=w.createFramebuffer(),St.__webglColorRenderbuffer=[],l.bindFramebuffer(w.FRAMEBUFFER,St.__webglMultisampledFramebuffer);for(let Yn=0;Yn<zn.length;Yn++){const Ai=zn[Yn];St.__webglColorRenderbuffer[Yn]=w.createRenderbuffer(),w.bindRenderbuffer(w.RENDERBUFFER,St.__webglColorRenderbuffer[Yn]);const sr=_.convert(Ai.format,Ai.colorSpace),wn=_.convert(Ai.type),Ur=rt(Ai.internalFormat,sr,wn,Ai.colorSpace,qe.isXRRenderTarget===!0),ot=br(qe);w.renderbufferStorageMultisample(w.RENDERBUFFER,ot,Ur,qe.width,qe.height),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0+Yn,w.RENDERBUFFER,St.__webglColorRenderbuffer[Yn])}w.bindRenderbuffer(w.RENDERBUFFER,null),qe.depthBuffer&&(St.__webglDepthRenderbuffer=w.createRenderbuffer(),Gn(St.__webglDepthRenderbuffer,qe,!0)),l.bindFramebuffer(w.FRAMEBUFFER,null)}}if(un){l.bindTexture(w.TEXTURE_CUBE_MAP,an.__webglTexture),ii(w.TEXTURE_CUBE_MAP,Ie,hi);for(let zn=0;zn<6;zn++)if(I&&Ie.mipmaps&&Ie.mipmaps.length>0)for(let Yn=0;Yn<Ie.mipmaps.length;Yn++)rn(St.__webglFramebuffer[zn][Yn],qe,Ie,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+zn,Yn);else rn(St.__webglFramebuffer[zn],qe,Ie,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+zn,0);Be(Ie,hi)&&Xe(w.TEXTURE_CUBE_MAP),l.unbindTexture()}else if(cn){const zn=qe.texture;for(let Yn=0,Ai=zn.length;Yn<Ai;Yn++){const sr=zn[Yn],wn=m.get(sr);l.bindTexture(w.TEXTURE_2D,wn.__webglTexture),ii(w.TEXTURE_2D,sr,hi),rn(St.__webglFramebuffer,qe,sr,w.COLOR_ATTACHMENT0+Yn,w.TEXTURE_2D,0),Be(sr,hi)&&Xe(w.TEXTURE_2D)}l.unbindTexture()}else{let zn=w.TEXTURE_2D;if((qe.isWebGL3DRenderTarget||qe.isWebGLArrayRenderTarget)&&(I?zn=qe.isWebGL3DRenderTarget?w.TEXTURE_3D:w.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),qe.isWebGLMultiviewRenderTarget===!0&&(zn=w.TEXTURE_2D_ARRAY),l.bindTexture(zn,an.__webglTexture),ii(zn,Ie,hi),I&&Ie.mipmaps&&Ie.mipmaps.length>0)for(let Yn=0;Yn<Ie.mipmaps.length;Yn++)rn(St.__webglFramebuffer[Yn],qe,Ie,w.COLOR_ATTACHMENT0,zn,Yn);else rn(St.__webglFramebuffer,qe,Ie,w.COLOR_ATTACHMENT0,zn,0);Be(Ie,hi)&&Xe(zn),l.unbindTexture()}(qe.depthBuffer||qe.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(qe)}function Lr(qe){const Ie=et(qe)||I,St=qe.isWebGLMultipleRenderTargets===!0?qe.texture:[qe.texture];for(let an=0,un=St.length;an<un;an++){const cn=St[an];if(Be(cn,Ie)){const hi=qe.isWebGLCubeRenderTarget?w.TEXTURE_CUBE_MAP:w.TEXTURE_2D,zn=m.get(cn).__webglTexture;l.bindTexture(hi,zn),Xe(hi),l.unbindTexture()}}}function fs(qe){if(I&&qe.samples>0&&gr(qe)===!1){const Ie=qe.isWebGLMultipleRenderTargets?qe.texture:[qe.texture],St=qe.width,an=qe.height;let un=w.COLOR_BUFFER_BIT;const cn=[],hi=qe.stencilBuffer?w.DEPTH_STENCIL_ATTACHMENT:w.DEPTH_ATTACHMENT,zn=m.get(qe),Yn=qe.isWebGLMultipleRenderTargets===!0;if(Yn)for(let Ai=0;Ai<Ie.length;Ai++)l.bindFramebuffer(w.FRAMEBUFFER,zn.__webglMultisampledFramebuffer),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0+Ai,w.RENDERBUFFER,null),l.bindFramebuffer(w.FRAMEBUFFER,zn.__webglFramebuffer),w.framebufferTexture2D(w.DRAW_FRAMEBUFFER,w.COLOR_ATTACHMENT0+Ai,w.TEXTURE_2D,null,0);l.bindFramebuffer(w.READ_FRAMEBUFFER,zn.__webglMultisampledFramebuffer),l.bindFramebuffer(w.DRAW_FRAMEBUFFER,zn.__webglFramebuffer);for(let Ai=0;Ai<Ie.length;Ai++){cn.push(w.COLOR_ATTACHMENT0+Ai),qe.depthBuffer&&cn.push(hi);const sr=zn.__ignoreDepthValues!==void 0?zn.__ignoreDepthValues:!1;if(sr===!1&&(qe.depthBuffer&&(un|=w.DEPTH_BUFFER_BIT),qe.stencilBuffer&&(un|=w.STENCIL_BUFFER_BIT)),Yn&&w.framebufferRenderbuffer(w.READ_FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.RENDERBUFFER,zn.__webglColorRenderbuffer[Ai]),sr===!0&&(w.invalidateFramebuffer(w.READ_FRAMEBUFFER,[hi]),w.invalidateFramebuffer(w.DRAW_FRAMEBUFFER,[hi])),Yn){const wn=m.get(Ie[Ai]).__webglTexture;w.framebufferTexture2D(w.DRAW_FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_2D,wn,0)}w.blitFramebuffer(0,0,St,an,0,0,St,an,un,w.NEAREST),$&&w.invalidateFramebuffer(w.READ_FRAMEBUFFER,cn)}if(l.bindFramebuffer(w.READ_FRAMEBUFFER,null),l.bindFramebuffer(w.DRAW_FRAMEBUFFER,null),Yn)for(let Ai=0;Ai<Ie.length;Ai++){l.bindFramebuffer(w.FRAMEBUFFER,zn.__webglMultisampledFramebuffer),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0+Ai,w.RENDERBUFFER,zn.__webglColorRenderbuffer[Ai]);const sr=m.get(Ie[Ai]).__webglTexture;l.bindFramebuffer(w.FRAMEBUFFER,zn.__webglFramebuffer),w.framebufferTexture2D(w.DRAW_FRAMEBUFFER,w.COLOR_ATTACHMENT0+Ai,w.TEXTURE_2D,sr,0)}l.bindFramebuffer(w.DRAW_FRAMEBUFFER,zn.__webglMultisampledFramebuffer)}}function br(qe){return Math.min(Q,qe.samples)}function gr(qe){const Ie=m.get(qe);return I&&qe.samples>0&&r.has("WEBGL_multisampled_render_to_texture")===!0&&Ie.__useRenderToTexture!==!1}function $r(qe){const Ie=R.render.frame;ue.get(qe)!==Ie&&(ue.set(qe,Ie),qe.update())}function Mo(qe,Ie){const St=qe.colorSpace,an=qe.format,un=qe.type;return qe.isCompressedTexture===!0||qe.isVideoTexture===!0||qe.format===pu||St!==pr&&St!==qr&&(vr.getTransfer(St)===wr?I===!1?r.has("EXT_sRGB")===!0&&an===ht?(qe.format=pu,qe.minFilter=Bn,qe.generateMipmaps=!1):Ie=cl.sRGBToLinear(Ie):(an!==ht||un!==Rt)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",St)),Ie}this.allocateTextureUnit=dn,this.resetTextureUnits=pn,this.setTexture2D=Qi,this.setTexture2DArray=ki,this.setTexture3D=Ht,this.setTextureCube=Sn,this.rebindTextures=gi,this.uploadTexture=hn,this.setupRenderTarget=ir,this.updateRenderTargetMipmap=Lr,this.updateMultisampleRenderTarget=fs,this.setupDepthTexture=mi,this.setupDepthRenderbuffer=ti,this.setupFrameBufferTexture=rn,this.useMultisampledRTT=gr,this.runDeferredUploads=ct,this.setDeferTextureUploads=nn}function hM(w,r,l){const m=l.isWebGL2;function y(_,R=qr){let I;const O=vr.getTransfer(R);if(_===Rt)return w.UNSIGNED_BYTE;if(_===Vi)return w.UNSIGNED_SHORT_4_4_4_4;if(_===lr)return w.UNSIGNED_SHORT_5_5_5_1;if(_===gn)return w.BYTE;if(_===si)return w.SHORT;if(_===Ln)return w.UNSIGNED_SHORT;if(_===Jn)return w.INT;if(_===$n)return w.UNSIGNED_INT;if(_===Ei)return w.FLOAT;if(_===Fi)return m?w.HALF_FLOAT:(I=r.get("OES_texture_half_float"),I!==null?I.HALF_FLOAT_OES:null);if(_===Le)return w.ALPHA;if(_===ht)return w.RGBA;if(_===yt)return w.LUMINANCE;if(_===de)return w.LUMINANCE_ALPHA;if(_===be)return w.DEPTH_COMPONENT;if(_===Ve)return w.DEPTH_STENCIL;if(_===pu)return I=r.get("EXT_sRGB"),I!==null?I.SRGB_ALPHA_EXT:null;if(_===dt)return w.RED;if(_===ut)return w.RED_INTEGER;if(_===_t)return w.RG;if(_===It)return w.RG_INTEGER;if(_===Zt)return w.RGBA_INTEGER;if(_===Wt||_===Lt||_===Pn||_===Dn)if(O===wr)if(I=r.get("WEBGL_compressed_texture_s3tc_srgb"),I!==null){if(_===Wt)return I.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(_===Lt)return I.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(_===Pn)return I.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(_===Dn)return I.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(I=r.get("WEBGL_compressed_texture_s3tc"),I!==null){if(_===Wt)return I.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===Lt)return I.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===Pn)return I.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===Dn)return I.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(_===jn||_===di||_===Cn||_===vi)if(I=r.get("WEBGL_compressed_texture_pvrtc"),I!==null){if(_===jn)return I.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===di)return I.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===Cn)return I.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===vi)return I.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(_===Zn)return I=r.get("WEBGL_compressed_texture_etc1"),I!==null?I.COMPRESSED_RGB_ETC1_WEBGL:null;if(_===nr||_===Rr)if(I=r.get("WEBGL_compressed_texture_etc"),I!==null){if(_===nr)return O===wr?I.COMPRESSED_SRGB8_ETC2:I.COMPRESSED_RGB8_ETC2;if(_===Rr)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:I.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(_===Rn||_===Kn||_===zi||_===Si||_===Y||_===se||_===pe||_===we||_===Ue||_===Ke||_===ft||_===ae||_===le||_===ce)if(I=r.get("WEBGL_compressed_texture_astc"),I!==null){if(_===Rn)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:I.COMPRESSED_RGBA_ASTC_4x4_KHR;if(_===Kn)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:I.COMPRESSED_RGBA_ASTC_5x4_KHR;if(_===zi)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:I.COMPRESSED_RGBA_ASTC_5x5_KHR;if(_===Si)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:I.COMPRESSED_RGBA_ASTC_6x5_KHR;if(_===Y)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:I.COMPRESSED_RGBA_ASTC_6x6_KHR;if(_===se)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:I.COMPRESSED_RGBA_ASTC_8x5_KHR;if(_===pe)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:I.COMPRESSED_RGBA_ASTC_8x6_KHR;if(_===we)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:I.COMPRESSED_RGBA_ASTC_8x8_KHR;if(_===Ue)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:I.COMPRESSED_RGBA_ASTC_10x5_KHR;if(_===Ke)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:I.COMPRESSED_RGBA_ASTC_10x6_KHR;if(_===ft)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:I.COMPRESSED_RGBA_ASTC_10x8_KHR;if(_===ae)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:I.COMPRESSED_RGBA_ASTC_10x10_KHR;if(_===le)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:I.COMPRESSED_RGBA_ASTC_12x10_KHR;if(_===ce)return O===wr?I.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:I.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(_===ge||_===Ae||_===tt)if(I=r.get("EXT_texture_compression_bptc"),I!==null){if(_===ge)return O===wr?I.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:I.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(_===Ae)return I.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(_===tt)return I.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(_===xt||_===Dt||_===Yt||_===on)if(I=r.get("EXT_texture_compression_rgtc"),I!==null){if(_===ge)return I.COMPRESSED_RED_RGTC1_EXT;if(_===Dt)return I.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(_===Yt)return I.COMPRESSED_RED_GREEN_RGTC2_EXT;if(_===on)return I.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return _===cr?m?w.UNSIGNED_INT_24_8:(I=r.get("WEBGL_depth_texture"),I!==null?I.UNSIGNED_INT_24_8_WEBGL:null):w[_]!==void 0?w[_]:null}return{convert:y}}class Ah extends mr{constructor(){super(),this.isGroup=!0,this.type="Group"}}class fx extends hs{constructor(r=[]){super(),this.isArrayCamera=!0,this.cameras=r}}var uM=new je,dM=new je;function NF(w,r,l){uM.setFromMatrixPosition(r.matrixWorld),dM.setFromMatrixPosition(l.matrixWorld);var m=uM.distanceTo(dM),y=r.projectionMatrix.elements,_=l.projectionMatrix.elements,R=y[14]/(y[10]-1),I=y[14]/(y[10]+1),O=(y[9]+1)/y[5],N=(y[9]-1)/y[5],V=(y[8]-1)/y[0],Q=(_[8]+1)/_[0],X=R*V,$=R*Q,ie=m/(-V+Q),ue=ie*-V;r.matrixWorld.decompose(w.position,w.quaternion,w.scale),w.translateX(ue),w.translateZ(ie),w.matrixWorld.compose(w.position,w.quaternion,w.scale),w.matrixWorldInverse.copy(w.matrixWorld).invert();var re=R+ie,q=I+ie,Se=X-ue,fe=$+(m-ue),Me=O*I/q*re,ze=N*I/q*re;w.projectionMatrix.makePerspective(Se,fe,Me,ze,re,q)}function fM(w){var r,l,m=this,y=null,_=null,R=null,I=[],O=new _i,N=new _i,V=1,Q="local-floor";typeof window<"u"&&"VRFrameData"in window&&(_=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",Me,!1));var X=new _i,$=new Ti,ie=new je,ue=new hs;ue.viewport=new ur,ue.layers.enable(1);var re=new hs;re.viewport=new ur,re.layers.enable(2);var q=new fx([ue,re]);q.layers.enable(1),q.layers.enable(2);var Se=new en,fe;function Me(){var rt=m.isPresenting=y!==null&&y.isPresenting===!0;if(rt){var bt=y.getEyeParameters("left");r=2*bt.renderWidth*V,l=bt.renderHeight*V,fe=w.getPixelRatio(),w.getSize(Se),w.setDrawingBufferSize(r,l,1),ue.viewport.set(0,0,r/2,l),re.viewport.set(r/2,0,r/2,l),Xe.start(),m.dispatchEvent({type:"sessionstart"})}else m.enabled&&w.setDrawingBufferSize(Se.width,Se.height,fe),Xe.stop(),m.dispatchEvent({type:"sessionend"})}var ze=[],He=[];function et(rt){for(var bt=navigator.getGamepads&&navigator.getGamepads(),Gt=0,lt=bt.length;Gt<lt;Gt++){var wt=bt[Gt];if(wt&&(wt.id==="Daydream Controller"||wt.id==="Gear VR Controller"||wt.id==="Oculus Go Controller"||wt.id==="OpenVR Gamepad"||wt.id.startsWith("Oculus Touch")||wt.id.startsWith("HTC Vive Focus")||wt.id.startsWith("Spatial Controller"))){var Kt=wt.hand;if(rt===0&&(Kt===""||Kt==="right")||rt===1&&Kt==="left")return wt}}}function st(){for(var rt=0;rt<I.length;rt++){var bt=I[rt],Gt=et(rt);if(Gt!==void 0&&Gt.pose!==void 0){if(Gt.pose===null)return;var lt=Gt.pose;lt.hasPosition===!1&&bt.position.set(.2,-.6,-.05),lt.position!==null&&bt.position.fromArray(lt.position),lt.orientation!==null&&bt.quaternion.fromArray(lt.orientation),bt.matrix.compose(bt.position,bt.quaternion,bt.scale),bt.matrix.premultiply(O),bt.matrix.decompose(bt.position,bt.quaternion,bt.scale),bt.matrixWorldNeedsUpdate=!0,bt.visible=!0;var wt=Gt.id==="Daydream Controller"?0:1;ze[rt]===void 0&&(ze[rt]=!1),ze[rt]!==Gt.buttons[wt].pressed&&(ze[rt]=Gt.buttons[wt].pressed,ze[rt]===!0?bt.dispatchEvent({type:"selectstart"}):(bt.dispatchEvent({type:"selectend"}),bt.dispatchEvent({type:"select"}))),wt=2,He[rt]===void 0&&(He[rt]=!1),Gt.buttons[wt]!==void 0&&He[rt]!==Gt.buttons[wt].pressed&&(He[rt]=Gt.buttons[wt].pressed,He[rt]===!0?bt.dispatchEvent({type:"squeezestart"}):(bt.dispatchEvent({type:"squeezeend"}),bt.dispatchEvent({type:"squeeze"})))}else bt.visible=!1}}function Be(rt,bt){bt!==null&&bt.length===4&&rt.set(bt[0]*r,bt[1]*l,bt[2]*r,bt[3]*l)}this.enabled=!1,this.getController=function(rt){var bt=I[rt];return bt===void 0&&(bt=new Ah,bt.matrixAutoUpdate=!1,bt.visible=!1,I[rt]=bt),bt},this.getDevice=function(){return y},this.setDevice=function(rt){rt!==void 0&&(y=rt),Xe.setContext(rt)},this.setFramebufferScaleFactor=function(rt){V=rt},this.setReferenceSpaceType=function(rt){Q=rt},this.setPoseTarget=function(rt){rt!==void 0&&(R=rt)},this.cameraAutoUpdate=!0,this.updateCamera=function(rt){var bt=Q==="local-floor"?1.6:0;if(y.depthNear=rt.near,y.depthFar=rt.far,y.getFrameData(_),Q==="local-floor"){var Gt=y.stageParameters;Gt?O.fromArray(Gt.sittingToStandingTransform):O.makeTranslation(0,bt,0)}var lt=_.pose,wt=R!==null?R:rt;wt.matrix.copy(O),wt.matrix.decompose(wt.position,wt.quaternion,wt.scale),lt.orientation!==null&&($.fromArray(lt.orientation),wt.quaternion.multiply($)),lt.position!==null&&($.setFromRotationMatrix(O),ie.fromArray(lt.position),ie.applyQuaternion($),wt.position.add(ie)),wt.updateMatrixWorld();for(var Kt=wt.children,qt=0,ln=Kt.length;qt<ln;qt++)Kt[qt].updateMatrixWorld(!0);ue.near=rt.near,re.near=rt.near,ue.far=rt.far,re.far=rt.far,ue.matrixWorldInverse.fromArray(_.leftViewMatrix),re.matrixWorldInverse.fromArray(_.rightViewMatrix),N.copy(O).invert(),Q==="local-floor"&&(ue.matrixWorldInverse.multiply(N),re.matrixWorldInverse.multiply(N));var Jt=wt.parent;Jt!==null&&(X.copy(Jt.matrixWorld).invert(),ue.matrixWorldInverse.multiply(X),re.matrixWorldInverse.multiply(X)),ue.matrixWorld.copy(ue.matrixWorldInverse).invert(),re.matrixWorld.copy(re.matrixWorldInverse).invert(),ue.projectionMatrix.fromArray(_.leftProjectionMatrix),re.projectionMatrix.fromArray(_.rightProjectionMatrix),NF(q,ue,re);var pn=y.getLayers();if(pn.length){var dn=pn[0];Be(ue.viewport,dn.leftBounds),Be(re.viewport,dn.rightBounds)}return st(),q},this.getCamera=function(){return q},this.getFoveation=function(){return 1},this.setFoveation=function(rt){rt!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(m.isPresenting)return"opaque"},this.getStandingMatrix=function(){return O},this.isPresenting=!1;var Xe=new nx;this.setAnimationLoop=function(rt){Xe.setAnimationLoop(rt),this.isPresenting&&Xe.start()},this.submitFrame=function(){this.isPresenting&&y.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",Me)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(fM.prototype,{addEventListener:to.prototype.addEventListener,hasEventListener:to.prototype.hasEventListener,removeEventListener:to.prototype.removeEventListener,dispatchEvent:to.prototype.dispatchEvent});class pM extends yo{constructor(r,l,m,y={}){super(r,l,y),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=m}copy(r){return super.copy(r),this.numViews=r.numViews,this}}pM.prototype.isWebGLMultiviewRenderTarget=!0;const UF={type:"move"};class px{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ah,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ah,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new je,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new je),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ah,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new je,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new je),this._grip}dispatchEvent(r){return this._targetRay!==null&&this._targetRay.dispatchEvent(r),this._grip!==null&&this._grip.dispatchEvent(r),this._hand!==null&&this._hand.dispatchEvent(r),this}connect(r){if(r&&r.hand){const l=this._hand;if(l)for(const m of r.hand.values())this._getHandJoint(l,m)}return this.dispatchEvent({type:"connected",data:r}),this}disconnect(r){return this.dispatchEvent({type:"disconnected",data:r}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(r,l,m){let y=null,_=null,R=null;const I=this._targetRay,O=this._grip,N=this._hand;if(r&&l.session.visibilityState!=="visible-blurred"){if(N&&r.hand){R=!0;for(const ue of r.hand.values()){const re=l.getJointPose(ue,m),q=this._getHandJoint(N,ue);re!==null&&(q.matrix.fromArray(re.transform.matrix),q.matrix.decompose(q.position,q.rotation,q.scale),q.matrixWorldNeedsUpdate=!0,q.jointRadius=re.radius),q.visible=re!==null}const V=N.joints["index-finger-tip"],Q=N.joints["thumb-tip"],X=V.position.distanceTo(Q.position),$=.02,ie=.005;N.inputState.pinching&&X>$+ie?(N.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:r.handedness,target:this})):!N.inputState.pinching&&X<=$-ie&&(N.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:r.handedness,target:this}))}else O!==null&&r.gripSpace&&(_=l.getPose(r.gripSpace,m),_!==null&&(O.matrix.fromArray(_.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),O.matrixWorldNeedsUpdate=!0,_.linearVelocity?(O.hasLinearVelocity=!0,O.linearVelocity.copy(_.linearVelocity)):O.hasLinearVelocity=!1,_.angularVelocity?(O.hasAngularVelocity=!0,O.angularVelocity.copy(_.angularVelocity)):O.hasAngularVelocity=!1));I!==null&&(y=l.getPose(r.targetRaySpace,m),y===null&&_!==null&&(y=_),y!==null&&(I.matrix.fromArray(y.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,y.linearVelocity?(I.hasLinearVelocity=!0,I.linearVelocity.copy(y.linearVelocity)):I.hasLinearVelocity=!1,y.angularVelocity?(I.hasAngularVelocity=!0,I.angularVelocity.copy(y.angularVelocity)):I.hasAngularVelocity=!1,this.dispatchEvent(UF)))}return I!==null&&(I.visible=y!==null),O!==null&&(O.visible=_!==null),N!==null&&(N.visible=R!==null),this}_getHandJoint(r,l){if(r.joints[l.jointName]===void 0){const m=new Ah;m.matrixAutoUpdate=!1,m.visible=!1,r.joints[l.jointName]=m,r.add(m)}return r.joints[l.jointName]}}class mM extends Ir{constructor(r,l,m,y,_,R,I,O,N,V){if(V=V!==void 0?V:be,V!==be&&V!==Ve)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");m===void 0&&V===be&&(m=$n),m===void 0&&V===Ve&&(m=cr),super(null,y,_,R,I,O,V,m,N),this.isDepthTexture=!0,this.image={width:r,height:l},this.magFilter=I!==void 0?I:at,this.minFilter=O!==void 0?O:at,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(r){return super.copy(r),this.compareFunction=r.compareFunction,this}toJSON(r){const l=super.toJSON(r);return this.compareFunction!==null&&(l.compareFunction=this.compareFunction),l}}class kF extends to{constructor(r,l,m,y){super();const _=this;let R=null,I=1;var O=null;let N=null,V="local-floor",Q=1,X=null,$=null;var ie=[];let ue=null,re=null,q=null,Se=null;const fe=l.getContextAttributes();let Me=null,ze=null;const He=[],et=[],st=new hs;st.layers.enable(1),st.viewport=new ur;const Be=new hs;Be.layers.enable(2),Be.viewport=new ur;const Xe=[st,Be],rt=new fx;rt.layers.enable(1),rt.layers.enable(2);let bt=null,Gt=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return $},this.getController=function(Ht){let Sn=He[Ht];return Sn===void 0&&(Sn=new px,He[Ht]=Sn),Sn.getTargetRaySpace()},this.getControllerGrip=function(Ht){let Sn=He[Ht];return Sn===void 0&&(Sn=new px,He[Ht]=Sn),Sn.getGripSpace()},this.getHand=function(Ht){let Sn=He[Ht];return Sn===void 0&&(Sn=new px,He[Ht]=Sn),Sn.getHandSpace()};function lt(Ht){const Sn=et.indexOf(Ht.inputSource);if(Sn===-1)return;const _n=He[Sn];_n!==void 0&&(_n.update(Ht.inputSource,Ht.frame,X||N),_n.dispatchEvent({type:Ht.type,data:Ht.inputSource}))}function wt(){R.removeEventListener("select",lt),R.removeEventListener("selectstart",lt),R.removeEventListener("selectend",lt),R.removeEventListener("squeeze",lt),R.removeEventListener("squeezestart",lt),R.removeEventListener("squeezeend",lt),R.removeEventListener("end",wt),R.removeEventListener("inputsourceschange",Kt);for(let Ht=0;Ht<He.length;Ht++){const Sn=et[Ht];Sn!==null&&(et[Ht]=null,He[Ht].disconnect(Sn))}bt=null,Gt=null,r.setRenderTarget(Me),q=null,re=null,ue=null,R=null,ze=null,ki.stop(),_.isPresenting=!1,_.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ht){I=Ht,_.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ht){V=Ht,_.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return X||N},this.setReferenceSpace=function(Ht){X=Ht},this.getBaseLayer=function(){return re!==null?re:q},this.getBinding=function(){return ue},this.getFrame=function(){return Se},this.getSession=function(){return R},this.setSession=async function(Ht){if(R=Ht,R!==null){if(Me=r.getRenderTarget(),R.addEventListener("select",lt),R.addEventListener("selectstart",lt),R.addEventListener("selectend",lt),R.addEventListener("squeeze",lt),R.addEventListener("squeezestart",lt),R.addEventListener("squeezeend",lt),R.addEventListener("end",wt),R.addEventListener("inputsourceschange",Kt),fe.xrCompatible!==!0&&await l.makeXRCompatible(),R.renderState.layers===void 0||r.capabilities.isWebGL2===!1){const Sn={antialias:R.renderState.layers===void 0?fe.antialias:!0,alpha:!0,depth:fe.depth,stencil:fe.stencil,framebufferScaleFactor:I};q=new XRWebGLLayer(R,l,Sn),R.updateRenderState({baseLayer:q}),ze=new yo(q.framebufferWidth,q.framebufferHeight,{format:ht,type:Rt,colorSpace:r.outputColorSpace,stencilBuffer:fe.stencil})}else{let Sn=null,_n=null,wi=null;fe.depth&&(wi=fe.stencil?l.DEPTH24_STENCIL8:l.DEPTH_COMPONENT24,Sn=fe.stencil?Ve:be,_n=fe.stencil?cr:$n),_.isMultiview=y&&m.has("OCULUS_multiview");const ei={colorFormat:l.RGBA8,depthFormat:wi,scaleFactor:I};_.isMultiview&&(ei.textureType="texture-array"),ue=new XRWebGLBinding(R,l),re=ue.createProjectionLayer(ei),R.updateRenderState({layers:[re]});const ii={format:ht,type:Rt,depthTexture:new mM(re.textureWidth,re.textureHeight,_n,void 0,void 0,void 0,void 0,void 0,void 0,Sn),stencilBuffer:fe.stencil,colorSpace:r.outputColorSpace,samples:fe.antialias?4:0};if(_.isMultiview){const nn=m.get("OCULUS_multiview");this.maxNumViews=l.getParameter(nn.MAX_VIEWS_OVR),ze=new pM(re.textureWidth,re.textureHeight,2,ii)}else ze=new yo(re.textureWidth,re.textureHeight,ii);const yi=r.properties.get(ze);yi.__ignoreDepthValues=re.ignoreDepthValues}ze.isXRRenderTarget=!0,this.setFoveation(Q),X=null,N=await R.requestReferenceSpace(V),ki.setContext(R),ki.start(),_.isPresenting=!0,_.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(R!==null)return R.environmentBlendMode},this.addLayer=function(Ht){!window.XRWebGLBinding||!this.layersEnabled||!R||(ie.push(Ht),this.updateLayers())},this.removeLayer=function(Ht){ie.splice(ie.indexOf(Ht),1),!(!window.XRWebGLBinding||!this.layersEnabled||!R)&&this.updateLayers()},this.updateLayers=function(){var Ht=ie.map(function(Sn){return Sn});Ht.unshift(R.renderState.layers[0]),R.updateRenderState({layers:Ht})};function Kt(Ht){for(let Sn=0;Sn<Ht.removed.length;Sn++){const _n=Ht.removed[Sn],wi=et.indexOf(_n);wi>=0&&(et[wi]=null,He[wi].disconnect(_n))}for(let Sn=0;Sn<Ht.added.length;Sn++){const _n=Ht.added[Sn];let wi=et.indexOf(_n);if(wi===-1){for(let ii=0;ii<He.length;ii++)if(ii>=et.length){et.push(_n),wi=ii;break}else if(et[ii]===null){et[ii]=_n,wi=ii;break}if(wi===-1)break}const ei=He[wi];ei&&ei.connect(_n)}}const qt=new je,ln=new je;function Jt(Ht,Sn,_n){qt.setFromMatrixPosition(Sn.matrixWorld),ln.setFromMatrixPosition(_n.matrixWorld);const wi=qt.distanceTo(ln),ei=Sn.projectionMatrix.elements,ii=_n.projectionMatrix.elements,yi=ei[14]/(ei[10]-1),nn=ei[14]/(ei[10]+1),ct=(ei[9]+1)/ei[5],hn=(ei[9]-1)/ei[5],In=(ei[8]-1)/ei[0],rn=(ii[8]+1)/ii[0],Gn=yi*In,mi=yi*rn,ti=wi/(-In+rn),gi=ti*-In;Sn.matrixWorld.decompose(Ht.position,Ht.quaternion,Ht.scale),Ht.translateX(gi),Ht.translateZ(ti),Ht.matrixWorld.compose(Ht.position,Ht.quaternion,Ht.scale),Ht.matrixWorldInverse.copy(Ht.matrixWorld).invert();const ir=yi+ti,Lr=nn+ti,fs=Gn-gi,br=mi+(wi-gi),gr=ct*nn/Lr*ir,$r=hn*nn/Lr*ir;Ht.projectionMatrix.makePerspective(fs,br,gr,$r,ir,Lr),Ht.projectionMatrixInverse.copy(Ht.projectionMatrix).invert()}function pn(Ht,Sn){Sn===null?Ht.matrixWorld.copy(Ht.matrix):Ht.matrixWorld.multiplyMatrices(Sn.matrixWorld,Ht.matrix),Ht.matrixWorldInverse.copy(Ht.matrixWorld).invert()}this.setPoseTarget=function(Ht){Ht!==void 0&&(O=Ht)},this.updateCamera=function(Ht){if(R===null)return;rt.near=Be.near=st.near=Ht.near,rt.far=Be.far=st.far=Ht.far,(bt!==rt.near||Gt!==rt.far)&&(R.updateRenderState({depthNear:rt.near,depthFar:rt.far}),bt=rt.near,Gt=rt.far);const Sn=rt.cameras;var _n=O||Ht;const wi=_n.parent;pn(rt,wi);for(let ei=0;ei<Sn.length;ei++)pn(Sn[ei],wi);Sn.length===2?Jt(rt,st,Be):rt.projectionMatrix.copy(st.projectionMatrix),dn(Ht,rt,_n)};function dn(Ht,Sn,_n){Sn.matrixWorld.decompose(Sn.position,Sn.quaternion,Sn.scale),_n.parent===null?_n.matrix.copy(Sn.matrixWorld):(_n.matrix.copy(_n.parent.matrixWorld),_n.matrix.invert(),_n.matrix.multiply(Sn.matrixWorld)),_n.matrix.decompose(_n.position,_n.quaternion,_n.scale),_n.updateMatrixWorld(!0),Ht.projectionMatrix.copy(Sn.projectionMatrix),Ht.projectionMatrixInverse.copy(Sn.projectionMatrixInverse),Ht.isPerspectiveCamera&&(Ht.fov=sc*2*Math.atan(1/Ht.projectionMatrix.elements[5]),Ht.zoom=1)}this.getCamera=function(){return rt},this.getFoveation=function(){if(!(re===null&&q===null))return Q},this.setFoveation=function(Ht){Q=Ht,re!==null&&(re.fixedFoveation=Ht),q!==null&&q.fixedFoveation!==void 0&&(q.fixedFoveation=Ht)};let Qn=null;function Qi(Ht,Sn){if($=Sn.getViewerPose(X||N),Se=Sn,$!==null){const _n=$.views;q!==null&&(r.setRenderTargetFramebuffer(ze,q.framebuffer),r.setRenderTarget(ze));let wi=!1;_n.length!==rt.cameras.length&&(rt.cameras.length=0,wi=!0);for(let ei=0;ei<_n.length;ei++){const ii=_n[ei];let yi=null;if(q!==null)yi=q.getViewport(ii);else{const ct=ue.getViewSubImage(re,ii);yi=ct.viewport,ei===0&&(r.setRenderTargetTextures(ze,ct.colorTexture,re.ignoreDepthValues?void 0:ct.depthStencilTexture),r.setRenderTarget(ze))}let nn=Xe[ei];nn===void 0&&(nn=new hs,nn.layers.enable(ei),nn.viewport=new ur,Xe[ei]=nn),nn.matrix.fromArray(ii.transform.matrix),nn.matrix.decompose(nn.position,nn.quaternion,nn.scale),nn.projectionMatrix.fromArray(ii.projectionMatrix),nn.projectionMatrixInverse.copy(nn.projectionMatrix).invert(),nn.viewport.set(yi.x,yi.y,yi.width,yi.height),ei===0&&(rt.matrix.copy(nn.matrix),rt.matrix.decompose(rt.position,rt.quaternion,rt.scale)),wi===!0&&rt.cameras.push(nn)}}for(let _n=0;_n<He.length;_n++){const wi=et[_n],ei=He[_n];wi!==null&&ei!==void 0&&ei.update(wi,Sn,X||N)}Qn&&Qn(Ht,Sn),Sn.detectedPlanes&&_.dispatchEvent({type:"planesdetected",data:Sn}),Se=null}const ki=new nx;ki.setAnimationLoop(Qi),this.setAnimationLoop=function(Ht){Qn=Ht},this.dispose=function(){}}}function zF(w,r){function l(re,q){re.matrixAutoUpdate===!0&&re.updateMatrix(),q.value.copy(re.matrix)}function m(re,q){q.color.getRGB(re.fogColor.value,Ow(w)),q.isFog?(re.fogNear.value=q.near,re.fogFar.value=q.far):q.isFogExp2&&(re.fogDensity.value=q.density)}function y(re,q,Se,fe,Me){q.isMeshBasicMaterial||q.isMeshLambertMaterial?_(re,q):q.isMeshToonMaterial?(_(re,q),Q(re,q)):q.isMeshPhongMaterial?(_(re,q),V(re,q)):q.isMeshStandardMaterial?(_(re,q),X(re,q),q.isMeshPhysicalMaterial&&$(re,q,Me)):q.isMeshMatcapMaterial?(_(re,q),ie(re,q)):q.isMeshDepthMaterial?_(re,q):q.isMeshDistanceMaterial?(_(re,q),ue(re,q)):q.isMeshNormalMaterial?_(re,q):q.isLineBasicMaterial?(R(re,q),q.isLineDashedMaterial&&I(re,q)):q.isPointsMaterial?O(re,q,Se,fe):q.isSpriteMaterial?N(re,q):q.isShadowMaterial?(re.color.value.copy(q.color),re.opacity.value=q.opacity):q.isShaderMaterial&&(q.uniformsNeedUpdate=!1)}function _(re,q){re.opacity.value=q.opacity,q.color&&re.diffuse.value.copy(q.color),q.emissive&&re.emissive.value.copy(q.emissive).multiplyScalar(q.emissiveIntensity),q.map&&(re.map.value=q.map,l(q.map,re.mapTransform)),q.alphaMap&&(re.alphaMap.value=q.alphaMap,l(q.alphaMap,re.alphaMapTransform)),q.bumpMap&&(re.bumpMap.value=q.bumpMap,l(q.bumpMap,re.bumpMapTransform),re.bumpScale.value=q.bumpScale,q.side===T&&(re.bumpScale.value*=-1)),q.normalMap&&(re.normalMap.value=q.normalMap,l(q.normalMap,re.normalMapTransform),re.normalScale.value.copy(q.normalScale),q.side===T&&re.normalScale.value.negate()),q.displacementMap&&(re.displacementMap.value=q.displacementMap,l(q.displacementMap,re.displacementMapTransform),re.displacementScale.value=q.displacementScale,re.displacementBias.value=q.displacementBias),q.emissiveMap&&(re.emissiveMap.value=q.emissiveMap,l(q.emissiveMap,re.emissiveMapTransform)),q.specularMap&&(re.specularMap.value=q.specularMap,l(q.specularMap,re.specularMapTransform)),q.alphaTest>0&&(re.alphaTest.value=q.alphaTest);const Se=r.get(q).envMap;if(Se&&(re.envMap.value=Se,re.flipEnvMap.value=Se.isCubeTexture&&Se.isRenderTargetTexture===!1?-1:1,re.reflectivity.value=q.reflectivity,re.ior.value=q.ior,re.refractionRatio.value=q.refractionRatio),q.lightMap){re.lightMap.value=q.lightMap;const fe=w._useLegacyLights===!0?Math.PI:1;re.lightMapIntensity.value=q.lightMapIntensity*fe,l(q.lightMap,re.lightMapTransform)}q.aoMap&&(re.aoMap.value=q.aoMap,re.aoMapIntensity.value=q.aoMapIntensity,l(q.aoMap,re.aoMapTransform))}function R(re,q){re.diffuse.value.copy(q.color),re.opacity.value=q.opacity,q.map&&(re.map.value=q.map,l(q.map,re.mapTransform))}function I(re,q){re.dashSize.value=q.dashSize,re.totalSize.value=q.dashSize+q.gapSize,re.scale.value=q.scale}function O(re,q,Se,fe){re.diffuse.value.copy(q.color),re.opacity.value=q.opacity,re.size.value=q.size*Se,re.scale.value=fe*.5,q.map&&(re.map.value=q.map,l(q.map,re.uvTransform)),q.alphaMap&&(re.alphaMap.value=q.alphaMap,l(q.alphaMap,re.alphaMapTransform)),q.alphaTest>0&&(re.alphaTest.value=q.alphaTest)}function N(re,q){re.diffuse.value.copy(q.color),re.opacity.value=q.opacity,re.rotation.value=q.rotation,q.map&&(re.map.value=q.map,l(q.map,re.mapTransform)),q.alphaMap&&(re.alphaMap.value=q.alphaMap,l(q.alphaMap,re.alphaMapTransform)),q.alphaTest>0&&(re.alphaTest.value=q.alphaTest)}function V(re,q){re.specular.value.copy(q.specular),re.shininess.value=Math.max(q.shininess,1e-4)}function Q(re,q){q.gradientMap&&(re.gradientMap.value=q.gradientMap)}function X(re,q){re.metalness.value=q.metalness,q.metalnessMap&&(re.metalnessMap.value=q.metalnessMap,l(q.metalnessMap,re.metalnessMapTransform)),re.roughness.value=q.roughness,q.roughnessMap&&(re.roughnessMap.value=q.roughnessMap,l(q.roughnessMap,re.roughnessMapTransform)),r.get(q).envMap&&(re.envMapIntensity.value=q.envMapIntensity)}function $(re,q,Se){re.ior.value=q.ior,q.sheen>0&&(re.sheenColor.value.copy(q.sheenColor).multiplyScalar(q.sheen),re.sheenRoughness.value=q.sheenRoughness,q.sheenColorMap&&(re.sheenColorMap.value=q.sheenColorMap,l(q.sheenColorMap,re.sheenColorMapTransform)),q.sheenRoughnessMap&&(re.sheenRoughnessMap.value=q.sheenRoughnessMap,l(q.sheenRoughnessMap,re.sheenRoughnessMapTransform))),q.clearcoat>0&&(re.clearcoat.value=q.clearcoat,re.clearcoatRoughness.value=q.clearcoatRoughness,q.clearcoatMap&&(re.clearcoatMap.value=q.clearcoatMap,l(q.clearcoatMap,re.clearcoatMapTransform)),q.clearcoatRoughnessMap&&(re.clearcoatRoughnessMap.value=q.clearcoatRoughnessMap,l(q.clearcoatRoughnessMap,re.clearcoatRoughnessMapTransform)),q.clearcoatNormalMap&&(re.clearcoatNormalMap.value=q.clearcoatNormalMap,l(q.clearcoatNormalMap,re.clearcoatNormalMapTransform),re.clearcoatNormalScale.value.copy(q.clearcoatNormalScale),q.side===T&&re.clearcoatNormalScale.value.negate())),q.iridescence>0&&(re.iridescence.value=q.iridescence,re.iridescenceIOR.value=q.iridescenceIOR,re.iridescenceThicknessMinimum.value=q.iridescenceThicknessRange[0],re.iridescenceThicknessMaximum.value=q.iridescenceThicknessRange[1],q.iridescenceMap&&(re.iridescenceMap.value=q.iridescenceMap,l(q.iridescenceMap,re.iridescenceMapTransform)),q.iridescenceThicknessMap&&(re.iridescenceThicknessMap.value=q.iridescenceThicknessMap,l(q.iridescenceThicknessMap,re.iridescenceThicknessMapTransform))),q.transmission>0&&(re.transmission.value=q.transmission,re.transmissionSamplerMap.value=Se.texture,re.transmissionSamplerSize.value.set(Se.width,Se.height),q.transmissionMap&&(re.transmissionMap.value=q.transmissionMap,l(q.transmissionMap,re.transmissionMapTransform)),re.thickness.value=q.thickness,q.thicknessMap&&(re.thicknessMap.value=q.thicknessMap,l(q.thicknessMap,re.thicknessMapTransform)),re.attenuationDistance.value=q.attenuationDistance,re.attenuationColor.value.copy(q.attenuationColor)),q.anisotropy>0&&(re.anisotropyVector.value.set(q.anisotropy*Math.cos(q.anisotropyRotation),q.anisotropy*Math.sin(q.anisotropyRotation)),q.anisotropyMap&&(re.anisotropyMap.value=q.anisotropyMap,l(q.anisotropyMap,re.anisotropyMapTransform))),re.specularIntensity.value=q.specularIntensity,re.specularColor.value.copy(q.specularColor),q.specularColorMap&&(re.specularColorMap.value=q.specularColorMap,l(q.specularColorMap,re.specularColorMapTransform)),q.specularIntensityMap&&(re.specularIntensityMap.value=q.specularIntensityMap,l(q.specularIntensityMap,re.specularIntensityMapTransform))}function ie(re,q){q.matcap&&(re.matcap.value=q.matcap)}function ue(re,q){const Se=r.get(q).light;re.referencePosition.value.setFromMatrixPosition(Se.matrixWorld),re.nearDistance.value=Se.shadow.camera.near,re.farDistance.value=Se.shadow.camera.far}return{refreshFogUniforms:m,refreshMaterialUniforms:y}}function GF(w,r,l,m){let y={},_={},R=[];const I=l.isWebGL2?w.getParameter(w.MAX_UNIFORM_BUFFER_BINDINGS):0;function O(Se,fe){const Me=fe.program;m.uniformBlockBinding(Se,Me)}function N(Se,fe){let Me=y[Se.id];Me===void 0&&(ie(Se),Me=V(Se),y[Se.id]=Me,Se.addEventListener("dispose",re));const ze=fe.program;m.updateUBOMapping(Se,ze);const He=r.render.frame;_[Se.id]!==He&&(X(Se),_[Se.id]=He)}function V(Se){const fe=Q();Se.__bindingPointIndex=fe;const Me=w.createBuffer(),ze=Se.__size,He=Se.usage;return w.bindBuffer(w.UNIFORM_BUFFER,Me),w.bufferData(w.UNIFORM_BUFFER,ze,He),w.bindBuffer(w.UNIFORM_BUFFER,null),w.bindBufferBase(w.UNIFORM_BUFFER,fe,Me),Me}function Q(){for(let Se=0;Se<I;Se++)if(R.indexOf(Se)===-1)return R.push(Se),Se;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function X(Se){const fe=y[Se.id],Me=Se.uniforms,ze=Se.__cache;w.bindBuffer(w.UNIFORM_BUFFER,fe);for(let He=0,et=Me.length;He<et;He++){const st=Me[He];if($(st,He,ze)===!0){const Be=st.__offset,Xe=Array.isArray(st.value)?st.value:[st.value];let rt=0;for(let bt=0;bt<Xe.length;bt++){const Gt=Xe[bt],lt=ue(Gt);typeof Gt=="number"?(st.__data[0]=Gt,w.bufferSubData(w.UNIFORM_BUFFER,Be+rt,st.__data)):Gt.isMatrix3?(st.__data[0]=Gt.elements[0],st.__data[1]=Gt.elements[1],st.__data[2]=Gt.elements[2],st.__data[3]=Gt.elements[0],st.__data[4]=Gt.elements[3],st.__data[5]=Gt.elements[4],st.__data[6]=Gt.elements[5],st.__data[7]=Gt.elements[0],st.__data[8]=Gt.elements[6],st.__data[9]=Gt.elements[7],st.__data[10]=Gt.elements[8],st.__data[11]=Gt.elements[0]):(Gt.toArray(st.__data,rt),rt+=lt.storage/Float32Array.BYTES_PER_ELEMENT)}w.bufferSubData(w.UNIFORM_BUFFER,Be,st.__data)}}w.bindBuffer(w.UNIFORM_BUFFER,null)}function $(Se,fe,Me){const ze=Se.value;if(Me[fe]===void 0){if(typeof ze=="number")Me[fe]=ze;else{const He=Array.isArray(ze)?ze:[ze],et=[];for(let st=0;st<He.length;st++)et.push(He[st].clone());Me[fe]=et}return!0}else if(typeof ze=="number"){if(Me[fe]!==ze)return Me[fe]=ze,!0}else{const He=Array.isArray(Me[fe])?Me[fe]:[Me[fe]],et=Array.isArray(ze)?ze:[ze];for(let st=0;st<He.length;st++){const Be=He[st];if(Be.equals(et[st])===!1)return Be.copy(et[st]),!0}}return!1}function ie(Se){const fe=Se.uniforms;let Me=0;const ze=16;let He=0;for(let et=0,st=fe.length;et<st;et++){const Be=fe[et],Xe={boundary:0,storage:0},rt=Array.isArray(Be.value)?Be.value:[Be.value];for(let bt=0,Gt=rt.length;bt<Gt;bt++){const lt=rt[bt],wt=ue(lt);Xe.boundary+=wt.boundary,Xe.storage+=wt.storage}if(Be.__data=new Float32Array(Xe.storage/Float32Array.BYTES_PER_ELEMENT),Be.__offset=Me,et>0){He=Me%ze;const bt=ze-He;He!==0&&bt-Xe.boundary<0&&(Me+=ze-He,Be.__offset=Me)}Me+=Xe.storage}return He=Me%ze,He>0&&(Me+=ze-He),Se.__size=Me,Se.__cache={},this}function ue(Se){const fe={boundary:0,storage:0};return typeof Se=="number"?(fe.boundary=4,fe.storage=4):Se.isVector2?(fe.boundary=8,fe.storage=8):Se.isVector3||Se.isColor?(fe.boundary=16,fe.storage=12):Se.isVector4?(fe.boundary=16,fe.storage=16):Se.isMatrix3?(fe.boundary=48,fe.storage=48):Se.isMatrix4?(fe.boundary=64,fe.storage=64):Se.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Se),fe}function re(Se){const fe=Se.target;fe.removeEventListener("dispose",re);const Me=R.indexOf(fe.__bindingPointIndex);R.splice(Me,1),w.deleteBuffer(y[fe.id]),delete y[fe.id],delete _[fe.id]}function q(){for(const Se in y)w.deleteBuffer(y[Se]);R=[],y={},_={}}return{bind:O,update:N,dispose:q}}class gM{constructor(r={}){const{canvas:l=Wm(),context:m=null,depth:y=!0,stencil:_=!0,alpha:R=!1,antialias:I=!1,premultipliedAlpha:O=!0,preserveDrawingBuffer:N=!1,powerPreference:V="default",failIfMajorPerformanceCaveat:Q=!1,multiviewStereo:X=!1}=r;this.isWebGLRenderer=!0;let $;m!==null?$=m.getContextAttributes().alpha:$=R;const ie=new Uint32Array(4),ue=new Int32Array(4);let re=null,q=null;const Se=[],fe=[];this.domElement=l,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Cr,this._useLegacyLights=!1,this.toneMapping=fn,this.toneMappingExposure=1;const Me=this;let ze=!1,He=0,et=0,st=null,Be=-1,Xe=null;const rt=new ur,bt=new ur;let Gt=null;const lt=new Hn(0);let wt=0,Kt=l.width,qt=l.height,ln=1,Jt=null,pn=null;const dn=new ur(0,0,Kt,qt),Qn=new ur(0,0,Kt,qt);let Qi=!1;const ki=new fg;let Ht=!1,Sn=!1,_n=null;const wi=new _i,ei=new en,ii=new je,yi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function nn(){return st===null?ln:1}let ct=m;function hn(Ge,Et){for(let Bt=0;Bt<Ge.length;Bt++){const Ot=Ge[Bt],Ut=l.getContext(Ot,Et);if(Ut!==null)return Ut}return null}try{const Ge={alpha:!0,depth:y,stencil:_,antialias:I,premultipliedAlpha:O,preserveDrawingBuffer:N,powerPreference:V,failIfMajorPerformanceCaveat:Q};if("setAttribute"in l&&l.setAttribute("data-engine",`three.js r${d}`),l.addEventListener("webglcontextlost",xn,!1),l.addEventListener("webglcontextrestored",tn,!1),l.addEventListener("webglcontextcreationerror",An,!1),ct===null){const Et=["webgl2","webgl","experimental-webgl"];if(Me.isWebGL1Renderer===!0&&Et.shift(),ct=hn(Et,Ge),ct===null)throw hn(Et)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&ct instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),ct.getShaderPrecisionFormat===void 0&&(ct.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ge){throw console.error("THREE.WebGLRenderer: "+Ge.message),Ge}let In,rn,Gn,mi,ti,gi,ir,Lr,fs,br,gr,$r,Mo,qe,Ie,St,an,un,cn,hi,zn,Yn,Ai,sr,wn;function Ur(){In=new e4(ct),rn=new KO(ct,In,r),In.init(rn),Ai=new hM(ct,In,rn),Gn=new OF(ct,In,rn),mi=new i4(ct),ti=new _F,gi=new FF(ct,In,Gn,ti,rn,Ai,mi),ir=new YO(Me),Lr=new ZO(Me),fs=new XP(ct,rn),sr=new QO(ct,In,fs,rn),br=new t4(ct,fs,mi,sr),gr=new l4(ct,br,fs,mi),hi=new o4(ct,rn,gi),St=new qO(ti),$r=new bF(Me,ir,Lr,In,rn,sr,St),Mo=new zF(Me,ti),qe=new MF,Ie=new BF(In,rn),cn=new WO(Me,ir,Lr,Gn,gr,$,O),un=new a4(Me,In,ct),an=new DF(Me,gr,rn),wn=new GF(ct,mi,rn,Gn),zn=new XO(ct,In,mi,rn),Yn=new n4(ct,In,mi,rn),mi.programs=$r.programs,Me.capabilities=rn,Me.extensions=In,Me.properties=ti,Me.renderLists=qe,Me.shadowMap=an,Me.state=Gn,Me.info=mi}Ur();const ot=typeof navigator<"u"&&"xr"in navigator?new kF(Me,ct,In,X):new fM(Me);this.xr=ot,this.getContext=function(){return ct},this.getContextAttributes=function(){return ct.getContextAttributes()},this.forceContextLoss=function(){const Ge=In.get("WEBGL_lose_context");Ge&&Ge.loseContext()},this.forceContextRestore=function(){const Ge=In.get("WEBGL_lose_context");Ge&&Ge.restoreContext()},this.getPixelRatio=function(){return ln},this.setPixelRatio=function(Ge){Ge!==void 0&&(ln=Ge,this.setSize(Kt,qt,!1))},this.getSize=function(Ge){return Ge.set(Kt,qt)},this.setSize=function(Ge,Et,Bt=!0){if(ot.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Kt=Ge,qt=Et,l.width=Math.floor(Ge*ln),l.height=Math.floor(Et*ln),Bt===!0&&(l.style.width=Ge+"px",l.style.height=Et+"px"),this.setViewport(0,0,Ge,Et)},this.getDrawingBufferSize=function(Ge){return Ge.set(Kt*ln,qt*ln).floor()},this.setDrawingBufferSize=function(Ge,Et,Bt){Kt=Ge,qt=Et,ln=Bt,l.width=Math.floor(Ge*Bt),l.height=Math.floor(Et*Bt),this.setViewport(0,0,Ge,Et)},this.getCurrentViewport=function(Ge){return Ge.copy(rt)},this.getViewport=function(Ge){return Ge.copy(dn)},this.setViewport=function(Ge,Et,Bt,Ot){Ge.isVector4?dn.set(Ge.x,Ge.y,Ge.z,Ge.w):dn.set(Ge,Et,Bt,Ot),Gn.viewport(rt.copy(dn).multiplyScalar(ln).floor())},this.getScissor=function(Ge){return Ge.copy(Qn)},this.setScissor=function(Ge,Et,Bt,Ot){Ge.isVector4?Qn.set(Ge.x,Ge.y,Ge.z,Ge.w):Qn.set(Ge,Et,Bt,Ot),Gn.scissor(bt.copy(Qn).multiplyScalar(ln).floor())},this.getScissorTest=function(){return Qi},this.setScissorTest=function(Ge){Gn.setScissorTest(Qi=Ge)},this.setOpaqueSort=function(Ge){Jt=Ge},this.setTransparentSort=function(Ge){pn=Ge},this.getClearColor=function(Ge){return Ge.copy(cn.getClearColor())},this.setClearColor=function(){cn.setClearColor.apply(cn,arguments)},this.getClearAlpha=function(){return cn.getClearAlpha()},this.setClearAlpha=function(){cn.setClearAlpha.apply(cn,arguments)},this.clear=function(Ge=!0,Et=!0,Bt=!0){let Ot=0;if(Ge){let Ut=!1;if(st!==null){const Xn=st.texture.format;Ut=Xn===Zt||Xn===It||Xn===ut}if(Ut){const Xn=st.texture.type,fi=Xn===Rt||Xn===$n||Xn===Ln||Xn===cr||Xn===Vi||Xn===lr,Ci=cn.getClearColor(),Oi=cn.getClearAlpha(),Ji=Ci.r,Gi=Ci.g,Xi=Ci.b;fi?(ie[0]=Ji,ie[1]=Gi,ie[2]=Xi,ie[3]=Oi,ct.clearBufferuiv(ct.COLOR,0,ie)):(ue[0]=Ji,ue[1]=Gi,ue[2]=Xi,ue[3]=Oi,ct.clearBufferiv(ct.COLOR,0,ue))}else Ot|=ct.COLOR_BUFFER_BIT}Et&&(Ot|=ct.DEPTH_BUFFER_BIT),Bt&&(Ot|=ct.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ct.clear(Ot)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){l.removeEventListener("webglcontextlost",xn,!1),l.removeEventListener("webglcontextrestored",tn,!1),l.removeEventListener("webglcontextcreationerror",An,!1),qe.dispose(),Ie.dispose(),ti.dispose(),ir.dispose(),Lr.dispose(),gr.dispose(),sr.dispose(),wn.dispose(),$r.dispose(),ot.dispose(),ot.removeEventListener("sessionstart",xr),ot.removeEventListener("sessionend",Fs),_n&&(_n.dispose(),_n=null),Ih.stop()};function xn(Ge){Ge.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ze=!0}function tn(){console.log("THREE.WebGLRenderer: Context Restored."),ze=!1;const Ge=mi.autoReset,Et=an.enabled,Bt=an.autoUpdate,Ot=an.needsUpdate,Ut=an.type;Ur(),mi.autoReset=Ge,an.enabled=Et,an.autoUpdate=Bt,an.needsUpdate=Ot,an.type=Ut}function An(Ge){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Ge.statusMessage)}function kn(Ge){const Et=Ge.target;Et.removeEventListener("dispose",kn),Di(Et)}function Di(Ge){$i(Ge),ti.remove(Ge)}function $i(Ge){const Et=ti.get(Ge).programs;Et!==void 0&&(Et.forEach(function(Bt){$r.releaseProgram(Bt)}),Ge.isShaderMaterial&&$r.releaseShaderCache(Ge))}this.renderBufferDirect=function(Ge,Et,Bt,Ot,Ut,Xn){Et===null&&(Et=yi);const fi=Ut.isMesh&&Ut.matrixWorld.determinant()<0,Ci=I5(Ge,Et,Bt,Ot,Ut);Gn.setMaterial(Ot,fi);let Oi=Bt.index,Ji=1;if(Ot.wireframe===!0){if(Oi=br.getWireframeAttribute(Bt),Oi===void 0)return;Ji=2}const Gi=Bt.drawRange,Xi=Bt.attributes.position;let Jr=Gi.start*Ji,No=(Gi.start+Gi.count)*Ji;Xn!==null&&(Jr=Math.max(Jr,Xn.start*Ji),No=Math.min(No,(Xn.start+Xn.count)*Ji)),Oi!==null?(Jr=Math.max(Jr,0),No=Math.min(No,Oi.count)):Xi!=null&&(Jr=Math.max(Jr,0),No=Math.min(No,Xi.count));const Ms=No-Jr;if(Ms<0||Ms===1/0)return;sr.setup(Ut,Ot,Ci,Bt,Oi);let Ac,jr=zn;if(Oi!==null&&(Ac=fs.get(Oi),jr=Yn,jr.setIndex(Ac)),Ut.isMesh)Ot.wireframe===!0?(Gn.setLineWidth(Ot.wireframeLinewidth*nn()),jr.setMode(ct.LINES)):jr.setMode(ct.TRIANGLES);else if(Ut.isLine){let Bh=Ot.linewidth;Bh===void 0&&(Bh=1),Gn.setLineWidth(Bh*nn()),Ut.isLineSegments?jr.setMode(ct.LINES):Ut.isLineLoop?jr.setMode(ct.LINE_LOOP):jr.setMode(ct.LINE_STRIP)}else Ut.isPoints?jr.setMode(ct.POINTS):Ut.isSprite&&jr.setMode(ct.TRIANGLES);if(Ut.isInstancedMesh)jr.renderInstances(Jr,Ms,Ut.count);else if(Bt.isInstancedBufferGeometry){const Bh=Bt._maxInstanceCount!==void 0?Bt._maxInstanceCount:1/0,fr=Math.min(Bt.instanceCount,Bh);jr.renderInstances(Jr,Ms,fr)}else jr.render(Jr,Ms)};function Ki(Ge,Et,Bt){Ge.transparent===!0&&Ge.side===L&&Ge.forceSinglePass===!1?(Ge.side=T,Ge.needsUpdate=!0,cA(Ge,Et,Bt),Ge.side=C,Ge.needsUpdate=!0,cA(Ge,Et,Bt),Ge.side=L):cA(Ge,Et,Bt)}this.compile=function(Ge,Et,Bt=null){Bt===null&&(Bt=Ge),q=Ie.get(Bt),q.init(),fe.push(q),Bt.traverseVisible(function(Ut){Ut.isLight&&Ut.layers.test(Et.layers)&&(q.pushLight(Ut),Ut.castShadow&&q.pushShadow(Ut))}),Ge!==Bt&&Ge.traverseVisible(function(Ut){Ut.isLight&&Ut.layers.test(Et.layers)&&(q.pushLight(Ut),Ut.castShadow&&q.pushShadow(Ut))}),q.setupLights(Me._useLegacyLights);const Ot=new Set;return Ge.traverse(function(Ut){const Xn=Ut.material;if(Xn)if(Array.isArray(Xn))for(let fi=0;fi<Xn.length;fi++){const Ci=Xn[fi];Ki(Ci,Bt,Ut),Ot.add(Ci)}else Ki(Xn,Bt,Ut),Ot.add(Xn)}),fe.pop(),q=null,Ot},this.compileAsync=function(Ge,Et,Bt=null){const Ot=this.compile(Ge,Et,Bt);return new Promise(Ut=>{function Xn(){if(Ot.forEach(function(fi){ti.get(fi).currentProgram.isReady()&&Ot.delete(fi)}),Ot.size===0){Ut(Ge);return}setTimeout(Xn,10)}In.get("KHR_parallel_shader_compile")!==null?Xn():setTimeout(Xn,10)})};let En=null;function ui(Ge){En&&En(Ge)}function xr(){Ih.stop()}function Fs(){Ih.start()}const Ih=new nx;Ih.setAnimationLoop(ui),typeof self<"u"&&Ih.setContext(self),this.setAnimationLoop=function(Ge){En=Ge,ot.setAnimationLoop(Ge),Ge===null?Ih.stop():Ih.start()},ot.addEventListener("sessionstart",xr),ot.addEventListener("sessionend",Fs),this.render=function(Ge,Et){if(Et!==void 0&&Et.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(ze===!0)return;Ge.matrixWorldAutoUpdate===!0&&Ge.updateMatrixWorld(),Et.parent===null&&Et.matrixWorldAutoUpdate===!0&&Et.updateMatrixWorld(),ot.enabled===!0&&ot.isPresenting===!0&&(ot.cameraAutoUpdate===!0&&ot.updateCamera(Et),Et=ot.getCamera()),Ge.isScene===!0&&Ge.onBeforeRender(Me,Ge,Et,st),q=Ie.get(Ge,fe.length),q.init(),fe.push(q),wi.multiplyMatrices(Et.projectionMatrix,Et.matrixWorldInverse),ki.setFromProjectionMatrix(wi),Sn=this.localClippingEnabled,Ht=St.init(this.clippingPlanes,Sn),re=qe.get(Ge,Se.length),re.init(),Se.push(re),tC(Ge,Et,0,Me.sortObjects),re.finish(),Me.sortObjects===!0&&re.sort(Jt,pn),this.info.render.frame++,Ht===!0&&St.beginShadows();const Bt=q.state.shadowsArray;if(an.render(Bt,Ge,Et),Ht===!0&&St.endShadows(),this.info.autoReset===!0&&this.info.reset(),cn.render(re,Ge),q.setupLights(Me._useLegacyLights),Et.isArrayCamera)if(ot.enabled&&ot.isMultiview)gi.setDeferTextureUploads(!0),Jx(re,Ge,Et,Et.cameras[0].viewport);else{const Ot=Et.cameras;for(let Ut=0,Xn=Ot.length;Ut<Xn;Ut++){const fi=Ot[Ut];Jx(re,Ge,fi,fi.viewport)}}else Jx(re,Ge,Et);st!==null&&(gi.updateMultisampleRenderTarget(st),gi.updateRenderTargetMipmap(st)),Ge.isScene===!0&&Ge.onAfterRender(Me,Ge,Et),gi.runDeferredUploads(),ot.enabled&&ot.submitFrame&&ot.submitFrame(),sr.resetDefaultState(),Be=-1,Xe=null,fe.pop(),fe.length>0?q=fe[fe.length-1]:q=null,Se.pop(),Se.length>0?re=Se[Se.length-1]:re=null};function tC(Ge,Et,Bt,Ot){if(Ge.visible===!1)return;if(Ge.layers.test(Et.layers)){if(Ge.isGroup)Bt=Ge.renderOrder;else if(Ge.isLOD)Ge.autoUpdate===!0&&Ge.update(Et);else if(Ge.isLight)q.pushLight(Ge),Ge.castShadow&&q.pushShadow(Ge);else if(Ge.isSprite){if(!Ge.frustumCulled||ki.intersectsSprite(Ge)){Ot&&ii.setFromMatrixPosition(Ge.matrixWorld).applyMatrix4(wi);const fi=gr.update(Ge),Ci=Ge.material;Ci.visible&&re.push(Ge,fi,Ci,Bt,ii.z,null)}}else if((Ge.isMesh||Ge.isLine||Ge.isPoints)&&(!Ge.frustumCulled||ki.intersectsObject(Ge))){const fi=gr.update(Ge),Ci=Ge.material;if(Ot&&(Ge.boundingSphere!==void 0?(Ge.boundingSphere===null&&Ge.computeBoundingSphere(),ii.copy(Ge.boundingSphere.center)):(fi.boundingSphere===null&&fi.computeBoundingSphere(),ii.copy(fi.boundingSphere.center)),ii.applyMatrix4(Ge.matrixWorld).applyMatrix4(wi)),Array.isArray(Ci)){const Oi=fi.groups;for(let Ji=0,Gi=Oi.length;Ji<Gi;Ji++){const Xi=Oi[Ji],Jr=Ci[Xi.materialIndex];Jr&&Jr.visible&&re.push(Ge,fi,Jr,Bt,ii.z,Xi)}}else Ci.visible&&re.push(Ge,fi,Ci,Bt,ii.z,null)}}const Xn=Ge.children;for(let fi=0,Ci=Xn.length;fi<Ci;fi++)tC(Xn[fi],Et,Bt,Ot)}function Jx(Ge,Et,Bt,Ot){const Ut=Ge.opaque,Xn=Ge.transmissive,fi=Ge.transparent;q.setupLightsView(Bt),Ht===!0&&St.setGlobalState(Me.clippingPlanes,Bt),Xn.length>0&&R5(Ut,Xn,Et,Bt),Ot&&Gn.viewport(rt.copy(Ot)),Ut.length>0&&lA(Ut,Et,Bt),Xn.length>0&&lA(Xn,Et,Bt),fi.length>0&&lA(fi,Et,Bt),Gn.buffers.depth.setTest(!0),Gn.buffers.depth.setMask(!0),Gn.buffers.color.setMask(!0),Gn.setPolygonOffset(!1)}function R5(Ge,Et,Bt,Ot){if((Bt.isScene===!0?Bt.overrideMaterial:null)!==null)return;const Xn=rn.isWebGL2;_n===null&&(_n=new yo(1,1,{generateMipmaps:!0,type:In.has("EXT_color_buffer_half_float")?Fi:Rt,minFilter:Fn,samples:Xn?4:0})),Me.getDrawingBufferSize(ei),Xn?_n.setSize(ei.x,ei.y):_n.setSize(mu(ei.x),mu(ei.y));const fi=Me.getRenderTarget();Me.setRenderTarget(_n),Me.getClearColor(lt),wt=Me.getClearAlpha(),wt<1&&Me.setClearColor(16777215,.5),Me.clear();const Ci=Me.toneMapping;Me.toneMapping=fn,lA(Ge,Bt,Ot),gi.updateMultisampleRenderTarget(_n),gi.updateRenderTargetMipmap(_n);let Oi=!1;for(let Ji=0,Gi=Et.length;Ji<Gi;Ji++){const Xi=Et[Ji],Jr=Xi.object,No=Xi.geometry,Ms=Xi.material,Ac=Xi.group;if(Ms.side===L&&Jr.layers.test(Ot.layers)){const jr=Ms.side;Ms.side=T,Ms.needsUpdate=!0,nC(Jr,Bt,Ot,No,Ms,Ac),Ms.side=jr,Ms.needsUpdate=!0,Oi=!0}}Oi===!0&&(gi.updateMultisampleRenderTarget(_n),gi.updateRenderTargetMipmap(_n)),Me.setRenderTarget(fi),Me.setClearColor(lt,wt),Me.toneMapping=Ci}function lA(Ge,Et,Bt){const Ot=Et.isScene===!0?Et.overrideMaterial:null;for(let Ut=0,Xn=Ge.length;Ut<Xn;Ut++){const fi=Ge[Ut],Ci=fi.object,Oi=fi.geometry,Ji=Ot===null?fi.material:Ot,Gi=fi.group;Ci.layers.test(Bt.layers)&&nC(Ci,Et,Bt,Oi,Ji,Gi)}}function nC(Ge,Et,Bt,Ot,Ut,Xn){Ge.onBeforeRender(Me,Et,Bt,Ot,Ut,Xn),Ge.modelViewMatrix.multiplyMatrices(Bt.matrixWorldInverse,Ge.matrixWorld),Ge.normalMatrix.getNormalMatrix(Ge.modelViewMatrix),Ut.onBeforeRender(Me,Et,Bt,Ot,Ge,Xn),Ut.transparent===!0&&Ut.side===L&&Ut.forceSinglePass===!1?(Ut.side=T,Ut.needsUpdate=!0,Me.renderBufferDirect(Bt,Et,Ot,Ut,Ge,Xn),Ut.side=C,Ut.needsUpdate=!0,Me.renderBufferDirect(Bt,Et,Ot,Ut,Ge,Xn),Ut.side=L):Me.renderBufferDirect(Bt,Et,Ot,Ut,Ge,Xn),Ge.onAfterRender(Me,Et,Bt,Ot,Ut,Xn)}function cA(Ge,Et,Bt){Et.isScene!==!0&&(Et=yi);const Ot=ti.get(Ge),Ut=q.state.lights,Xn=q.state.shadowsArray,fi=Ut.state.version,Ci=$r.getParameters(Ge,Ut.state,Xn,Et,Bt),Oi=$r.getProgramCacheKey(Ci);let Ji=Ot.programs;Ot.environment=Ge.isMeshStandardMaterial?Et.environment:null,Ot.fog=Et.fog,Ot.envMap=(Ge.isMeshStandardMaterial?Lr:ir).get(Ge.envMap||Ot.environment),Ji===void 0&&(Ge.addEventListener("dispose",kn),Ji=new Map,Ot.programs=Ji);let Gi=Ji.get(Oi);if(Gi!==void 0){if(Ot.currentProgram===Gi&&Ot.lightsStateVersion===fi)return rC(Ge,Ci),Gi}else Ci.uniforms=$r.getUniforms(Ge),Ge.onBuild(Bt,Ci,Me),Ge.onBeforeCompile(Ci,Me),Gi=$r.acquireProgram(Ci,Oi),Ji.set(Oi,Gi),Ot.uniforms=Ci.uniforms;const Xi=Ot.uniforms;return(!Ge.isShaderMaterial&&!Ge.isRawShaderMaterial||Ge.clipping===!0)&&(Xi.clippingPlanes=St.uniform),rC(Ge,Ci),Ot.needsLights=L5(Ge),Ot.lightsStateVersion=fi,Ot.needsLights&&(Xi.ambientLightColor.value=Ut.state.ambient,Xi.lightProbe.value=Ut.state.probe,Xi.directionalLights.value=Ut.state.directional,Xi.directionalLightShadows.value=Ut.state.directionalShadow,Xi.spotLights.value=Ut.state.spot,Xi.spotLightShadows.value=Ut.state.spotShadow,Xi.rectAreaLights.value=Ut.state.rectArea,Xi.ltc_1.value=Ut.state.rectAreaLTC1,Xi.ltc_2.value=Ut.state.rectAreaLTC2,Xi.pointLights.value=Ut.state.point,Xi.pointLightShadows.value=Ut.state.pointShadow,Xi.hemisphereLights.value=Ut.state.hemi,Xi.directionalShadowMap.value=Ut.state.directionalShadowMap,Xi.directionalShadowMatrix.value=Ut.state.directionalShadowMatrix,Xi.spotShadowMap.value=Ut.state.spotShadowMap,Xi.spotLightMatrix.value=Ut.state.spotLightMatrix,Xi.spotLightMap.value=Ut.state.spotLightMap,Xi.pointShadowMap.value=Ut.state.pointShadowMap,Xi.pointShadowMatrix.value=Ut.state.pointShadowMatrix),Ot.currentProgram=Gi,Ot.uniformsList=null,Gi}function iC(Ge){if(Ge.uniformsList===null){const Et=Ge.currentProgram.getUniforms();Ge.uniformsList=vg.seqWithValue(Et.seq,Ge.uniforms)}return Ge.uniformsList}function rC(Ge,Et){const Bt=ti.get(Ge);Bt.outputColorSpace=Et.outputColorSpace,Bt.instancing=Et.instancing,Bt.instancingColor=Et.instancingColor,Bt.skinning=Et.skinning,Bt.morphTargets=Et.morphTargets,Bt.morphNormals=Et.morphNormals,Bt.morphColors=Et.morphColors,Bt.morphTargetsCount=Et.morphTargetsCount,Bt.numClippingPlanes=Et.numClippingPlanes,Bt.numIntersection=Et.numClipIntersection,Bt.vertexAlphas=Et.vertexAlphas,Bt.vertexTangents=Et.vertexTangents,Bt.toneMapping=Et.toneMapping,Bt.numMultiviewViews=Et.numMultiviewViews}function I5(Ge,Et,Bt,Ot,Ut){Et.isScene!==!0&&(Et=yi),gi.resetTextureUnits();const Xn=Et.fog,fi=Ot.isMeshStandardMaterial?Et.environment:null,Ci=st===null?Me.outputColorSpace:st.isXRRenderTarget===!0?st.texture.colorSpace:pr,Oi=(Ot.isMeshStandardMaterial?Lr:ir).get(Ot.envMap||fi),Ji=Ot.vertexColors===!0&&!!Bt.attributes.color&&Bt.attributes.color.itemSize===4,Gi=!!Bt.attributes.tangent&&(!!Ot.normalMap||Ot.anisotropy>0),Xi=!!Bt.morphAttributes.position,Jr=!!Bt.morphAttributes.normal,No=!!Bt.morphAttributes.color;let Ms=fn;Ot.toneMapped&&(st===null||st.isXRRenderTarget===!0)&&(Ms=Me.toneMapping);const Ac=st&&st.isWebGLMultiviewRenderTarget?st.numViews:0,jr=Bt.morphAttributes.position||Bt.morphAttributes.normal||Bt.morphAttributes.color,Bh=jr!==void 0?jr.length:0,fr=ti.get(Ot),P5=q.state.lights;if(Ht===!0&&(Sn===!0||Ge!==Xe)){const Uo=Ge===Xe&&Ot.id===Be;St.setState(Ot,Ge,Uo)}let Zr=!1;Ot.version===fr.__version?(fr.needsLights&&fr.lightsStateVersion!==P5.state.version||fr.outputColorSpace!==Ci||Ut.isInstancedMesh&&fr.instancing===!1||!Ut.isInstancedMesh&&fr.instancing===!0||Ut.isSkinnedMesh&&fr.skinning===!1||!Ut.isSkinnedMesh&&fr.skinning===!0||Ut.isInstancedMesh&&fr.instancingColor===!0&&Ut.instanceColor===null||Ut.isInstancedMesh&&fr.instancingColor===!1&&Ut.instanceColor!==null||fr.envMap!==Oi||Ot.fog===!0&&fr.fog!==Xn||fr.numClippingPlanes!==void 0&&(fr.numClippingPlanes!==St.numPlanes||fr.numIntersection!==St.numIntersection)||fr.vertexAlphas!==Ji||fr.vertexTangents!==Gi||fr.morphTargets!==Xi||fr.morphNormals!==Jr||fr.morphColors!==No||fr.toneMapping!==Ms||rn.isWebGL2===!0&&fr.morphTargetsCount!==Bh||fr.numMultiviewViews!==Ac)&&(Zr=!0):(Zr=!0,fr.__version=Ot.version);let Al=fr.currentProgram;Zr===!0&&(Al=cA(Ot,Et,Ut));let sC=!1,ap=!1,Zx=!1;const Cs=Al.getUniforms(),Lh=fr.uniforms;if(Gn.useProgram(Al.program)&&(sC=!0,ap=!0,Zx=!0),Ot.id!==Be&&(Be=Ot.id,ap=!0),sC||Xe!==Ge){Al.numMultiviewViews>0?(un.updateCameraProjectionMatricesUniform(Ge,Cs),un.updateCameraViewMatricesUniform(Ge,Cs)):(Cs.setValue(ct,"projectionMatrix",Ge.projectionMatrix),Cs.setValue(ct,"viewMatrix",Ge.matrixWorldInverse));const Uo=Cs.map.cameraPosition;Uo!==void 0&&Uo.setValue(ct,ii.setFromMatrixPosition(Ge.matrixWorld)),rn.logarithmicDepthBuffer&&Cs.setValue(ct,"logDepthBufFC",2/(Math.log(Ge.far+1)/Math.LN2)),(Ot.isMeshPhongMaterial||Ot.isMeshToonMaterial||Ot.isMeshLambertMaterial||Ot.isMeshBasicMaterial||Ot.isMeshStandardMaterial||Ot.isShaderMaterial)&&Cs.setValue(ct,"isOrthographic",Ge.isOrthographicCamera===!0),Xe!==Ge&&(Xe=Ge,ap=!0,Zx=!0)}if(Ut.isSkinnedMesh){Cs.setOptional(ct,Ut,"bindMatrix"),Cs.setOptional(ct,Ut,"bindMatrixInverse");const Uo=Ut.skeleton;Uo&&(rn.floatVertexTextures?(Uo.boneTexture===null&&Uo.computeBoneTexture(),Cs.setValue(ct,"boneTexture",Uo.boneTexture,gi),Cs.setValue(ct,"boneTextureSize",Uo.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const e1=Bt.morphAttributes;if((e1.position!==void 0||e1.normal!==void 0||e1.color!==void 0&&rn.isWebGL2===!0)&&hi.update(Ut,Bt,Al),(ap||fr.receiveShadow!==Ut.receiveShadow)&&(fr.receiveShadow=Ut.receiveShadow,Cs.setValue(ct,"receiveShadow",Ut.receiveShadow)),Ot.isMeshGouraudMaterial&&Ot.envMap!==null&&(Lh.envMap.value=Oi,Lh.flipEnvMap.value=Oi.isCubeTexture&&Oi.isRenderTargetTexture===!1?-1:1),ap&&(Cs.setValue(ct,"toneMappingExposure",Me.toneMappingExposure),fr.needsLights&&B5(Lh,Zx),Xn&&Ot.fog===!0&&Mo.refreshFogUniforms(Lh,Xn),Mo.refreshMaterialUniforms(Lh,Ot,ln,qt,_n),vg.upload(ct,iC(fr),Lh,gi)),Ot.isShaderMaterial&&Ot.uniformsNeedUpdate===!0&&(vg.upload(ct,iC(fr),Lh,gi),Ot.uniformsNeedUpdate=!1),Ot.isSpriteMaterial&&Cs.setValue(ct,"center",Ut.center),Al.numMultiviewViews>0?un.updateObjectMatricesUniforms(Ut,Ge,Cs):(Cs.setValue(ct,"modelViewMatrix",Ut.modelViewMatrix),Cs.setValue(ct,"normalMatrix",Ut.normalMatrix)),Cs.setValue(ct,"modelMatrix",Ut.matrixWorld),Ot.isShaderMaterial||Ot.isRawShaderMaterial){const Uo=Ot.uniformsGroups;for(let t1=0,D5=Uo.length;t1<D5;t1++)if(rn.isWebGL2){const oC=Uo[t1];wn.update(oC,Al),wn.bind(oC,Al)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Al}function B5(Ge,Et){Ge.ambientLightColor.needsUpdate=Et,Ge.lightProbe.needsUpdate=Et,Ge.directionalLights.needsUpdate=Et,Ge.directionalLightShadows.needsUpdate=Et,Ge.pointLights.needsUpdate=Et,Ge.pointLightShadows.needsUpdate=Et,Ge.spotLights.needsUpdate=Et,Ge.spotLightShadows.needsUpdate=Et,Ge.rectAreaLights.needsUpdate=Et,Ge.hemisphereLights.needsUpdate=Et}function L5(Ge){return Ge.isMeshLambertMaterial||Ge.isMeshToonMaterial||Ge.isMeshPhongMaterial||Ge.isMeshStandardMaterial||Ge.isShadowMaterial||Ge.isShaderMaterial&&Ge.lights===!0}this.setTexture2D=function(){var Ge=!1;return function(Bt,Ot){Bt&&Bt.isWebGLRenderTarget&&(Ge||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),Ge=!0),Bt=Bt.texture),gi.setTexture2D(Bt,Ot)}}(),this.getActiveCubeFace=function(){return He},this.getActiveMipmapLevel=function(){return et},this.getRenderTarget=function(){return st},this.setRenderTargetTextures=function(Ge,Et,Bt){ti.get(Ge.texture).__webglTexture=Et,ti.get(Ge.depthTexture).__webglTexture=Bt;const Ot=ti.get(Ge);Ot.__hasExternalTextures=!0,Ot.__autoAllocateDepthBuffer=Bt===void 0,!Ot.__autoAllocateDepthBuffer&&!st.isWebGLMultiviewRenderTarget&&In.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ot.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Ge,Et){const Bt=ti.get(Ge);Bt.__webglFramebuffer=Et,Bt.__useDefaultFramebuffer=Et===void 0},this.setRenderTarget=function(Ge,Et=0,Bt=0){st=Ge,He=Et,et=Bt;let Ot=!0,Ut=null,Xn=!1,fi=!1;if(Ge){const Oi=ti.get(Ge);Oi.__useDefaultFramebuffer!==void 0?(Gn.bindFramebuffer(ct.FRAMEBUFFER,null),Ot=!1):Oi.__webglFramebuffer===void 0?gi.setupRenderTarget(Ge):Oi.__hasExternalTextures&&gi.rebindTextures(Ge,ti.get(Ge.texture).__webglTexture,ti.get(Ge.depthTexture).__webglTexture);const Ji=Ge.texture;(Ji.isData3DTexture||Ji.isDataArrayTexture||Ji.isCompressedArrayTexture)&&(fi=!0);const Gi=ti.get(Ge).__webglFramebuffer;Ge.isWebGLCubeRenderTarget?(Array.isArray(Gi[Et])?Ut=Gi[Et][Bt]:Ut=Gi[Et],Xn=!0):rn.isWebGL2&&Ge.samples>0&&gi.useMultisampledRTT(Ge)===!1?Ut=ti.get(Ge).__webglMultisampledFramebuffer:Array.isArray(Gi)?Ut=Gi[Bt]:Ut=Gi,rt.copy(Ge.viewport),bt.copy(Ge.scissor),Gt=Ge.scissorTest}else rt.copy(dn).multiplyScalar(ln).floor(),bt.copy(Qn).multiplyScalar(ln).floor(),Gt=Qi;if(Gn.bindFramebuffer(ct.FRAMEBUFFER,Ut)&&rn.drawBuffers&&Ot&&Gn.drawBuffers(Ge,Ut),Gn.viewport(rt),Gn.scissor(bt),Gn.setScissorTest(Gt),Xn){const Oi=ti.get(Ge.texture);ct.framebufferTexture2D(ct.FRAMEBUFFER,ct.COLOR_ATTACHMENT0,ct.TEXTURE_CUBE_MAP_POSITIVE_X+Et,Oi.__webglTexture,Bt)}else if(fi){const Oi=ti.get(Ge.texture),Ji=Et||0;ct.framebufferTextureLayer(ct.FRAMEBUFFER,ct.COLOR_ATTACHMENT0,Oi.__webglTexture,Bt||0,Ji)}Be=-1},this.readRenderTargetPixels=function(Ge,Et,Bt,Ot,Ut,Xn,fi){if(!(Ge&&Ge.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ci=ti.get(Ge).__webglFramebuffer;if(Ge.isWebGLCubeRenderTarget&&fi!==void 0&&(Ci=Ci[fi]),Ci){Gn.bindFramebuffer(ct.FRAMEBUFFER,Ci);try{const Oi=Ge.texture,Ji=Oi.format,Gi=Oi.type;if(Ji!==ht&&Ai.convert(Ji)!==ct.getParameter(ct.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Xi=Gi===Fi&&(In.has("EXT_color_buffer_half_float")||rn.isWebGL2&&In.has("EXT_color_buffer_float"));if(Gi!==Rt&&Ai.convert(Gi)!==ct.getParameter(ct.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Gi===Ei&&(rn.isWebGL2||In.has("OES_texture_float")||In.has("WEBGL_color_buffer_float")))&&!Xi){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Et>=0&&Et<=Ge.width-Ot&&Bt>=0&&Bt<=Ge.height-Ut&&ct.readPixels(Et,Bt,Ot,Ut,Ai.convert(Ji),Ai.convert(Gi),Xn)}finally{const Oi=st!==null?ti.get(st).__webglFramebuffer:null;Gn.bindFramebuffer(ct.FRAMEBUFFER,Oi)}}},this.copyFramebufferToTexture=function(Ge,Et,Bt=0){const Ot=Math.pow(2,-Bt),Ut=Math.floor(Et.image.width*Ot),Xn=Math.floor(Et.image.height*Ot);gi.setTexture2D(Et,0),ct.copyTexSubImage2D(ct.TEXTURE_2D,Bt,0,0,Ge.x,Ge.y,Ut,Xn),Gn.unbindTexture()},this.copyTextureToTexture=function(Ge,Et,Bt,Ot=0){const Ut=Et.image.width,Xn=Et.image.height,fi=Ai.convert(Bt.format),Ci=Ai.convert(Bt.type);gi.setTexture2D(Bt,0),ct.pixelStorei(ct.UNPACK_FLIP_Y_WEBGL,Bt.flipY),ct.pixelStorei(ct.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Bt.premultiplyAlpha),ct.pixelStorei(ct.UNPACK_ALIGNMENT,Bt.unpackAlignment),Et.isDataTexture?ct.texSubImage2D(ct.TEXTURE_2D,Ot,Ge.x,Ge.y,Ut,Xn,fi,Ci,Et.image.data):Et.isCompressedTexture?ct.compressedTexSubImage2D(ct.TEXTURE_2D,Ot,Ge.x,Ge.y,Et.mipmaps[0].width,Et.mipmaps[0].height,fi,Et.mipmaps[0].data):ct.texSubImage2D(ct.TEXTURE_2D,Ot,Ge.x,Ge.y,fi,Ci,Et.image),Ot===0&&Bt.generateMipmaps&&ct.generateMipmap(ct.TEXTURE_2D),Gn.unbindTexture()},this.copyTextureToTexture3D=function(Ge,Et,Bt,Ot,Ut=0){if(Me.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Xn=Ge.max.x-Ge.min.x+1,fi=Ge.max.y-Ge.min.y+1,Ci=Ge.max.z-Ge.min.z+1,Oi=Ai.convert(Ot.format),Ji=Ai.convert(Ot.type);let Gi;if(Ot.isData3DTexture)gi.setTexture3D(Ot,0),Gi=ct.TEXTURE_3D;else if(Ot.isDataArrayTexture)gi.setTexture2DArray(Ot,0),Gi=ct.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ct.pixelStorei(ct.UNPACK_FLIP_Y_WEBGL,Ot.flipY),ct.pixelStorei(ct.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ot.premultiplyAlpha),ct.pixelStorei(ct.UNPACK_ALIGNMENT,Ot.unpackAlignment);const Xi=ct.getParameter(ct.UNPACK_ROW_LENGTH),Jr=ct.getParameter(ct.UNPACK_IMAGE_HEIGHT),No=ct.getParameter(ct.UNPACK_SKIP_PIXELS),Ms=ct.getParameter(ct.UNPACK_SKIP_ROWS),Ac=ct.getParameter(ct.UNPACK_SKIP_IMAGES),jr=Bt.isCompressedTexture?Bt.mipmaps[0]:Bt.image;ct.pixelStorei(ct.UNPACK_ROW_LENGTH,jr.width),ct.pixelStorei(ct.UNPACK_IMAGE_HEIGHT,jr.height),ct.pixelStorei(ct.UNPACK_SKIP_PIXELS,Ge.min.x),ct.pixelStorei(ct.UNPACK_SKIP_ROWS,Ge.min.y),ct.pixelStorei(ct.UNPACK_SKIP_IMAGES,Ge.min.z),Bt.isDataTexture||Bt.isData3DTexture?ct.texSubImage3D(Gi,Ut,Et.x,Et.y,Et.z,Xn,fi,Ci,Oi,Ji,jr.data):Bt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ct.compressedTexSubImage3D(Gi,Ut,Et.x,Et.y,Et.z,Xn,fi,Ci,Oi,jr.data)):ct.texSubImage3D(Gi,Ut,Et.x,Et.y,Et.z,Xn,fi,Ci,Oi,Ji,jr),ct.pixelStorei(ct.UNPACK_ROW_LENGTH,Xi),ct.pixelStorei(ct.UNPACK_IMAGE_HEIGHT,Jr),ct.pixelStorei(ct.UNPACK_SKIP_PIXELS,No),ct.pixelStorei(ct.UNPACK_SKIP_ROWS,Ms),ct.pixelStorei(ct.UNPACK_SKIP_IMAGES,Ac),Ut===0&&Ot.generateMipmaps&&ct.generateMipmap(Gi),Gn.unbindTexture()},this.initTexture=function(Ge){Ge.isCubeTexture?gi.setTextureCube(Ge,0):Ge.isData3DTexture?gi.setTexture3D(Ge,0):Ge.isDataArrayTexture||Ge.isCompressedArrayTexture?gi.setTexture2DArray(Ge,0):gi.setTexture2D(Ge,0),Gn.unbindTexture()},this.resetState=function(){He=0,et=0,st=null,Gn.reset(),sr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Yo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(r){this._outputColorSpace=r;const l=this.getContext();l.drawingBufferColorSpace=r===fu?"display-p3":"srgb",l.unpackColorSpace=vr.workingColorSpace===ih?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(r){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!r}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Cr?Kr:eo}set outputEncoding(r){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=r===Kr?Cr:pr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(r){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=r}}class AM extends gM{}AM.prototype.isWebGL1Renderer=!0;class yg{constructor(r,l=25e-5){this.isFogExp2=!0,this.name="",this.color=new Hn(r),this.density=l}clone(){return new yg(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class xg{constructor(r,l=1,m=1e3){this.isFog=!0,this.name="",this.color=new Hn(r),this.near=l,this.far=m}clone(){return new xg(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class vM extends mr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(r,l){return super.copy(r,l),r.background!==null&&(this.background=r.background.clone()),r.environment!==null&&(this.environment=r.environment.clone()),r.fog!==null&&(this.fog=r.fog.clone()),this.backgroundBlurriness=r.backgroundBlurriness,this.backgroundIntensity=r.backgroundIntensity,r.overrideMaterial!==null&&(this.overrideMaterial=r.overrideMaterial.clone()),this.matrixAutoUpdate=r.matrixAutoUpdate,this}toJSON(r){const l=super.toJSON(r);return this.fog!==null&&(l.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(l.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(l.object.backgroundIntensity=this.backgroundIntensity),l}}class Eg{constructor(r,l){this.isInterleavedBuffer=!0,this.array=r,this.stride=l,this.count=r!==void 0?r.length/l:0,this.usage=ah,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=no()}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this}copyAt(r,l,m){r*=this.stride,m*=l.stride;for(let y=0,_=this.stride;y<_;y++)this.array[r+y]=l.array[m+y];return this}set(r,l=0){return this.array.set(r,l),this}clone(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=no()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const l=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),m=new this.constructor(l,this.stride);return m.setUsage(this.usage),m}onUpload(r){return this.onUploadCallback=r,this}toJSON(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=no()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const so=new je;class vh{constructor(r,l,m,y=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=r,this.itemSize=l,this.offset=m,this.normalized=y}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(r){this.data.needsUpdate=r}applyMatrix4(r){for(let l=0,m=this.data.count;l<m;l++)so.fromBufferAttribute(this,l),so.applyMatrix4(r),this.setXYZ(l,so.x,so.y,so.z);return this}applyNormalMatrix(r){for(let l=0,m=this.count;l<m;l++)so.fromBufferAttribute(this,l),so.applyNormalMatrix(r),this.setXYZ(l,so.x,so.y,so.z);return this}transformDirection(r){for(let l=0,m=this.count;l<m;l++)so.fromBufferAttribute(this,l),so.transformDirection(r),this.setXYZ(l,so.x,so.y,so.z);return this}setX(r,l){return this.normalized&&(l=Ni(l,this.array)),this.data.array[r*this.data.stride+this.offset]=l,this}setY(r,l){return this.normalized&&(l=Ni(l,this.array)),this.data.array[r*this.data.stride+this.offset+1]=l,this}setZ(r,l){return this.normalized&&(l=Ni(l,this.array)),this.data.array[r*this.data.stride+this.offset+2]=l,this}setW(r,l){return this.normalized&&(l=Ni(l,this.array)),this.data.array[r*this.data.stride+this.offset+3]=l,this}getX(r){let l=this.data.array[r*this.data.stride+this.offset];return this.normalized&&(l=zs(l,this.array)),l}getY(r){let l=this.data.array[r*this.data.stride+this.offset+1];return this.normalized&&(l=zs(l,this.array)),l}getZ(r){let l=this.data.array[r*this.data.stride+this.offset+2];return this.normalized&&(l=zs(l,this.array)),l}getW(r){let l=this.data.array[r*this.data.stride+this.offset+3];return this.normalized&&(l=zs(l,this.array)),l}setXY(r,l,m){return r=r*this.data.stride+this.offset,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array)),this.data.array[r+0]=l,this.data.array[r+1]=m,this}setXYZ(r,l,m,y){return r=r*this.data.stride+this.offset,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array),y=Ni(y,this.array)),this.data.array[r+0]=l,this.data.array[r+1]=m,this.data.array[r+2]=y,this}setXYZW(r,l,m,y,_){return r=r*this.data.stride+this.offset,this.normalized&&(l=Ni(l,this.array),m=Ni(m,this.array),y=Ni(y,this.array),_=Ni(_,this.array)),this.data.array[r+0]=l,this.data.array[r+1]=m,this.data.array[r+2]=y,this.data.array[r+3]=_,this}clone(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const l=[];for(let m=0;m<this.count;m++){const y=m*this.data.stride+this.offset;for(let _=0;_<this.itemSize;_++)l.push(this.data.array[y+_])}return new Sr(new this.array.constructor(l),this.itemSize,this.normalized)}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.clone(r)),new vh(r.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const l=[];for(let m=0;m<this.count;m++){const y=m*this.data.stride+this.offset;for(let _=0;_<this.itemSize;_++)l.push(this.data.array[y+_])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:l,normalized:this.normalized}}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.toJSON(r)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class mx extends js{constructor(r){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Hn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.rotation=r.rotation,this.sizeAttenuation=r.sizeAttenuation,this.fog=r.fog,this}}let Fu;const Gf=new je,Nu=new je,Uu=new je,ku=new en,Vf=new en,yM=new _i,bg=new je,Hf=new je,_g=new je,xM=new en,gx=new en,EM=new en;class bM extends mr{constructor(r=new mx){if(super(),this.isSprite=!0,this.type="Sprite",Fu===void 0){Fu=new Yi;const l=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),m=new Eg(l,5);Fu.setIndex([0,1,2,0,2,3]),Fu.setAttribute("position",new vh(m,3,0,!1)),Fu.setAttribute("uv",new vh(m,2,3,!1))}this.geometry=Fu,this.material=r,this.center=new en(.5,.5)}raycast(r,l){r.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Nu.setFromMatrixScale(this.matrixWorld),yM.copy(r.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r.camera.matrixWorldInverse,this.matrixWorld),Uu.setFromMatrixPosition(this.modelViewMatrix),r.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Nu.multiplyScalar(-Uu.z);const m=this.material.rotation;let y,_;m!==0&&(_=Math.cos(m),y=Math.sin(m));const R=this.center;wg(bg.set(-.5,-.5,0),Uu,R,Nu,y,_),wg(Hf.set(.5,-.5,0),Uu,R,Nu,y,_),wg(_g.set(.5,.5,0),Uu,R,Nu,y,_),xM.set(0,0),gx.set(1,0),EM.set(1,1);let I=r.ray.intersectTriangle(bg,Hf,_g,!1,Gf);if(I===null&&(wg(Hf.set(-.5,.5,0),Uu,R,Nu,y,_),gx.set(0,1),I=r.ray.intersectTriangle(bg,_g,Hf,!1,Gf),I===null))return;const O=r.ray.origin.distanceTo(Gf);O<r.near||O>r.far||l.push({distance:O,point:Gf.clone(),uv:bo.getInterpolation(Gf,bg,Hf,_g,xM,gx,EM,new en),face:null,object:this})}copy(r,l){return super.copy(r,l),r.center!==void 0&&this.center.copy(r.center),this.material=r.material,this}}function wg(w,r,l,m,y,_){ku.subVectors(w,l).addScalar(.5).multiply(m),y!==void 0?(Vf.x=_*ku.x-y*ku.y,Vf.y=y*ku.x+_*ku.y):Vf.copy(ku),w.copy(r),w.x+=Vf.x,w.y+=Vf.y,w.applyMatrix4(yM)}const Mg=new je,_M=new je;class wM extends mr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(r){super.copy(r,!1);const l=r.levels;for(let m=0,y=l.length;m<y;m++){const _=l[m];this.addLevel(_.object.clone(),_.distance,_.hysteresis)}return this.autoUpdate=r.autoUpdate,this}addLevel(r,l=0,m=0){l=Math.abs(l);const y=this.levels;let _;for(_=0;_<y.length&&!(l<y[_].distance);_++);return y.splice(_,0,{distance:l,hysteresis:m,object:r}),this.add(r),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(r){const l=this.levels;if(l.length>0){let m,y;for(m=1,y=l.length;m<y;m++){let _=l[m].distance;if(l[m].object.visible&&(_-=_*l[m].hysteresis),r<_)break}return l[m-1].object}return null}raycast(r,l){if(this.levels.length>0){Mg.setFromMatrixPosition(this.matrixWorld);const y=r.ray.origin.distanceTo(Mg);this.getObjectForDistance(y).raycast(r,l)}}update(r){const l=this.levels;if(l.length>1){Mg.setFromMatrixPosition(r.matrixWorld),_M.setFromMatrixPosition(this.matrixWorld);const m=Mg.distanceTo(_M)/r.zoom;l[0].object.visible=!0;let y,_;for(y=1,_=l.length;y<_;y++){let R=l[y].distance;if(l[y].object.visible&&(R-=R*l[y].hysteresis),m>=R)l[y-1].object.visible=!1,l[y].object.visible=!0;else break}for(this._currentLevel=y-1;y<_;y++)l[y].object.visible=!1}}toJSON(r){const l=super.toJSON(r);this.autoUpdate===!1&&(l.object.autoUpdate=!1),l.object.levels=[];const m=this.levels;for(let y=0,_=m.length;y<_;y++){const R=m[y];l.object.levels.push({object:R.object.uuid,distance:R.distance,hysteresis:R.hysteresis})}return l}}const MM=new je,CM=new ur,SM=new ur,VF=new je,TM=new _i,Cg=new je,Ax=new Eo,RM=new _i,vx=new Vs;class IM extends Os{constructor(r,l){super(r,l),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=De,this.bindMatrix=new _i,this.bindMatrixInverse=new _i,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const r=this.geometry;this.boundingBox===null&&(this.boundingBox=new er),this.boundingBox.makeEmpty();const l=r.getAttribute("position");for(let m=0;m<l.count;m++)this.getVertexPosition(m,Cg),this.boundingBox.expandByPoint(Cg)}computeBoundingSphere(){const r=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Eo),this.boundingSphere.makeEmpty();const l=r.getAttribute("position");for(let m=0;m<l.count;m++)this.getVertexPosition(m,Cg),this.boundingSphere.expandByPoint(Cg)}copy(r,l){return super.copy(r,l),this.bindMode=r.bindMode,this.bindMatrix.copy(r.bindMatrix),this.bindMatrixInverse.copy(r.bindMatrixInverse),this.skeleton=r.skeleton,r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this}raycast(r,l){const m=this.material,y=this.matrixWorld;m!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ax.copy(this.boundingSphere),Ax.applyMatrix4(y),r.ray.intersectsSphere(Ax)!==!1&&(RM.copy(y).invert(),vx.copy(r.ray).applyMatrix4(RM),!(this.boundingBox!==null&&vx.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(r,l,vx)))}getVertexPosition(r,l){return super.getVertexPosition(r,l),this.applyBoneTransform(r,l),l}bind(r,l){this.skeleton=r,l===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),l=this.matrixWorld),this.bindMatrix.copy(l),this.bindMatrixInverse.copy(l).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const r=new ur,l=this.geometry.attributes.skinWeight;for(let m=0,y=l.count;m<y;m++){r.fromBufferAttribute(l,m);const _=1/r.manhattanLength();_!==1/0?r.multiplyScalar(_):r.set(1,0,0,0),l.setXYZW(m,r.x,r.y,r.z,r.w)}}updateMatrixWorld(r){super.updateMatrixWorld(r),this.bindMode===De?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===ke?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(r,l){const m=this.skeleton,y=this.geometry;CM.fromBufferAttribute(y.attributes.skinIndex,r),SM.fromBufferAttribute(y.attributes.skinWeight,r),MM.copy(l).applyMatrix4(this.bindMatrix),l.set(0,0,0);for(let _=0;_<4;_++){const R=SM.getComponent(_);if(R!==0){const I=CM.getComponent(_);TM.multiplyMatrices(m.bones[I].matrixWorld,m.boneInverses[I]),l.addScaledVector(VF.copy(MM).applyMatrix4(TM),R)}}return l.applyMatrix4(this.bindMatrixInverse)}boneTransform(r,l){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(r,l)}}class yx extends mr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class zu extends Ir{constructor(r=null,l=1,m=1,y,_,R,I,O,N=at,V=at,Q,X){super(null,R,I,O,N,V,y,_,Q,X),this.isDataTexture=!0,this.image={data:r,width:l,height:m},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const BM=new _i,HF=new _i;class Sg{constructor(r=[],l=[]){this.uuid=no(),this.bones=r.slice(0),this.boneInverses=l,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const r=this.bones,l=this.boneInverses;if(this.boneMatrices=new Float32Array(r.length*16),l.length===0)this.calculateInverses();else if(r.length!==l.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let m=0,y=this.bones.length;m<y;m++)this.boneInverses.push(new _i)}}calculateInverses(){this.boneInverses.length=0;for(let r=0,l=this.bones.length;r<l;r++){const m=new _i;this.bones[r]&&m.copy(this.bones[r].matrixWorld).invert(),this.boneInverses.push(m)}}pose(){for(let r=0,l=this.bones.length;r<l;r++){const m=this.bones[r];m&&m.matrixWorld.copy(this.boneInverses[r]).invert()}for(let r=0,l=this.bones.length;r<l;r++){const m=this.bones[r];m&&(m.parent&&m.parent.isBone?(m.matrix.copy(m.parent.matrixWorld).invert(),m.matrix.multiply(m.matrixWorld)):m.matrix.copy(m.matrixWorld),m.matrix.decompose(m.position,m.quaternion,m.scale))}}update(){const r=this.bones,l=this.boneInverses,m=this.boneMatrices,y=this.boneTexture;for(let _=0,R=r.length;_<R;_++){const I=r[_]?r[_].matrixWorld:HF;BM.multiplyMatrices(I,l[_]),BM.toArray(m,_*16)}y!==null&&(y.needsUpdate=!0)}clone(){return new Sg(this.bones,this.boneInverses)}computeBoneTexture(){let r=Math.sqrt(this.bones.length*4);r=Hm(r),r=Math.max(r,4);const l=new Float32Array(r*r*4);l.set(this.boneMatrices);const m=new zu(l,r,r,ht,Ei);return m.needsUpdate=!0,this.boneMatrices=l,this.boneTexture=m,this.boneTextureSize=r,this}getBoneByName(r){for(let l=0,m=this.bones.length;l<m;l++){const y=this.bones[l];if(y.name===r)return y}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(r,l){this.uuid=r.uuid;for(let m=0,y=r.bones.length;m<y;m++){const _=r.bones[m];let R=l[_];R===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",_),R=new yx),this.bones.push(R),this.boneInverses.push(new _i().fromArray(r.boneInverses[m]))}return this.init(),this}toJSON(){const r={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};r.uuid=this.uuid;const l=this.bones,m=this.boneInverses;for(let y=0,_=l.length;y<_;y++){const R=l[y];r.bones.push(R.uuid);const I=m[y];r.boneInverses.push(I.toArray())}return r}}class Gu extends Sr{constructor(r,l,m,y=1){super(r,l,m),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=y}copy(r){return super.copy(r),this.meshPerAttribute=r.meshPerAttribute,this}toJSON(){const r=super.toJSON();return r.meshPerAttribute=this.meshPerAttribute,r.isInstancedBufferAttribute=!0,r}}const Vu=new _i,LM=new _i,Tg=[],PM=new er,jF=new _i,jf=new Os,Wf=new Eo;class DM extends Os{constructor(r,l,m){super(r,l),this.isInstancedMesh=!0,this.instanceMatrix=new Gu(new Float32Array(m*16),16),this.instanceColor=null,this.count=m,this.boundingBox=null,this.boundingSphere=null;for(let y=0;y<m;y++)this.setMatrixAt(y,jF)}computeBoundingBox(){const r=this.geometry,l=this.count;this.boundingBox===null&&(this.boundingBox=new er),r.boundingBox===null&&r.computeBoundingBox(),this.boundingBox.makeEmpty();for(let m=0;m<l;m++)this.getMatrixAt(m,Vu),PM.copy(r.boundingBox).applyMatrix4(Vu),this.boundingBox.union(PM)}computeBoundingSphere(){const r=this.geometry,l=this.count;this.boundingSphere===null&&(this.boundingSphere=new Eo),r.boundingSphere===null&&r.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let m=0;m<l;m++)this.getMatrixAt(m,Vu),Wf.copy(r.boundingSphere).applyMatrix4(Vu),this.boundingSphere.union(Wf)}copy(r,l){return super.copy(r,l),this.instanceMatrix.copy(r.instanceMatrix),r.instanceColor!==null&&(this.instanceColor=r.instanceColor.clone()),this.count=r.count,r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this}getColorAt(r,l){l.fromArray(this.instanceColor.array,r*3)}getMatrixAt(r,l){l.fromArray(this.instanceMatrix.array,r*16)}raycast(r,l){const m=this.matrixWorld,y=this.count;if(jf.geometry=this.geometry,jf.material=this.material,jf.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Wf.copy(this.boundingSphere),Wf.applyMatrix4(m),r.ray.intersectsSphere(Wf)!==!1))for(let _=0;_<y;_++){this.getMatrixAt(_,Vu),LM.multiplyMatrices(m,Vu),jf.matrixWorld=LM,jf.raycast(r,Tg);for(let R=0,I=Tg.length;R<I;R++){const O=Tg[R];O.instanceId=_,O.object=this,l.push(O)}Tg.length=0}}setColorAt(r,l){this.instanceColor===null&&(this.instanceColor=new Gu(new Float32Array(this.instanceMatrix.count*3),3)),l.toArray(this.instanceColor.array,r*3)}setMatrixAt(r,l){l.toArray(this.instanceMatrix.array,r*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class oo extends js{constructor(r){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Hn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.fog=r.fog,this}}const OM=new je,FM=new je,NM=new _i,xx=new Vs,Rg=new Eo;class fc extends mr{constructor(r=new Yi,l=new oo){super(),this.isLine=!0,this.type="Line",this.geometry=r,this.material=l,this.updateMorphTargets()}copy(r,l){return super.copy(r,l),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}computeLineDistances(){const r=this.geometry;if(r.index===null){const l=r.attributes.position,m=[0];for(let y=1,_=l.count;y<_;y++)OM.fromBufferAttribute(l,y-1),FM.fromBufferAttribute(l,y),m[y]=m[y-1],m[y]+=OM.distanceTo(FM);r.setAttribute("lineDistance",new ni(m,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(r,l){const m=this.geometry,y=this.matrixWorld,_=r.params.Line.threshold,R=m.drawRange;if(m.boundingSphere===null&&m.computeBoundingSphere(),Rg.copy(m.boundingSphere),Rg.applyMatrix4(y),Rg.radius+=_,r.ray.intersectsSphere(Rg)===!1)return;NM.copy(y).invert(),xx.copy(r.ray).applyMatrix4(NM);const I=_/((this.scale.x+this.scale.y+this.scale.z)/3),O=I*I,N=new je,V=new je,Q=new je,X=new je,$=this.isLineSegments?2:1,ie=m.index,re=m.attributes.position;if(ie!==null){const q=Math.max(0,R.start),Se=Math.min(ie.count,R.start+R.count);for(let fe=q,Me=Se-1;fe<Me;fe+=$){const ze=ie.getX(fe),He=ie.getX(fe+1);if(N.fromBufferAttribute(re,ze),V.fromBufferAttribute(re,He),xx.distanceSqToSegment(N,V,X,Q)>O)continue;X.applyMatrix4(this.matrixWorld);const st=r.ray.origin.distanceTo(X);st<r.near||st>r.far||l.push({distance:st,point:Q.clone().applyMatrix4(this.matrixWorld),index:fe,face:null,faceIndex:null,object:this})}}else{const q=Math.max(0,R.start),Se=Math.min(re.count,R.start+R.count);for(let fe=q,Me=Se-1;fe<Me;fe+=$){if(N.fromBufferAttribute(re,fe),V.fromBufferAttribute(re,fe+1),xx.distanceSqToSegment(N,V,X,Q)>O)continue;X.applyMatrix4(this.matrixWorld);const He=r.ray.origin.distanceTo(X);He<r.near||He>r.far||l.push({distance:He,point:Q.clone().applyMatrix4(this.matrixWorld),index:fe,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const l=this.geometry.morphAttributes,m=Object.keys(l);if(m.length>0){const y=l[m[0]];if(y!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _=0,R=y.length;_<R;_++){const I=y[_].name||String(_);this.morphTargetInfluences.push(0),this.morphTargetDictionary[I]=_}}}}}const UM=new je,kM=new je;class qa extends fc{constructor(r,l){super(r,l),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const r=this.geometry;if(r.index===null){const l=r.attributes.position,m=[];for(let y=0,_=l.count;y<_;y+=2)UM.fromBufferAttribute(l,y),kM.fromBufferAttribute(l,y+1),m[y]=y===0?0:m[y-1],m[y+1]=m[y]+UM.distanceTo(kM);r.setAttribute("lineDistance",new ni(m,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class zM extends fc{constructor(r,l){super(r,l),this.isLineLoop=!0,this.type="LineLoop"}}class Ex extends js{constructor(r){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Hn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.size=r.size,this.sizeAttenuation=r.sizeAttenuation,this.fog=r.fog,this}}const GM=new _i,bx=new Vs,Ig=new Eo,Bg=new je;class VM extends mr{constructor(r=new Yi,l=new Ex){super(),this.isPoints=!0,this.type="Points",this.geometry=r,this.material=l,this.updateMorphTargets()}copy(r,l){return super.copy(r,l),this.material=Array.isArray(r.material)?r.material.slice():r.material,this.geometry=r.geometry,this}raycast(r,l){const m=this.geometry,y=this.matrixWorld,_=r.params.Points.threshold,R=m.drawRange;if(m.boundingSphere===null&&m.computeBoundingSphere(),Ig.copy(m.boundingSphere),Ig.applyMatrix4(y),Ig.radius+=_,r.ray.intersectsSphere(Ig)===!1)return;GM.copy(y).invert(),bx.copy(r.ray).applyMatrix4(GM);const I=_/((this.scale.x+this.scale.y+this.scale.z)/3),O=I*I,N=m.index,Q=m.attributes.position;if(N!==null){const X=Math.max(0,R.start),$=Math.min(N.count,R.start+R.count);for(let ie=X,ue=$;ie<ue;ie++){const re=N.getX(ie);Bg.fromBufferAttribute(Q,re),HM(Bg,re,O,y,r,l,this)}}else{const X=Math.max(0,R.start),$=Math.min(Q.count,R.start+R.count);for(let ie=X,ue=$;ie<ue;ie++)Bg.fromBufferAttribute(Q,ie),HM(Bg,ie,O,y,r,l,this)}}updateMorphTargets(){const l=this.geometry.morphAttributes,m=Object.keys(l);if(m.length>0){const y=l[m[0]];if(y!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _=0,R=y.length;_<R;_++){const I=y[_].name||String(_);this.morphTargetInfluences.push(0),this.morphTargetDictionary[I]=_}}}}}function HM(w,r,l,m,y,_,R){const I=bx.distanceSqToPoint(w);if(I<l){const O=new je;bx.closestPointToPoint(w,O),O.applyMatrix4(m);const N=y.ray.origin.distanceTo(O);if(N<y.near||N>y.far)return;_.push({distance:N,distanceToRay:Math.sqrt(I),point:O,index:r,face:null,object:R})}}class WF extends Ir{constructor(r,l,m,y,_,R,I,O,N){super(r,l,m,y,_,R,I,O,N),this.isVideoTexture=!0,this.minFilter=R!==void 0?R:Bn,this.magFilter=_!==void 0?_:Bn,this.generateMipmaps=!1;const V=this;function Q(){V.needsUpdate=!0,r.requestVideoFrameCallback(Q)}"requestVideoFrameCallback"in r&&r.requestVideoFrameCallback(Q)}clone(){return new this.constructor(this.image).copy(this)}update(){const r=this.image;"requestVideoFrameCallback"in r===!1&&r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class QF extends Ir{constructor(r,l){super({width:r,height:l}),this.isFramebufferTexture=!0,this.magFilter=at,this.minFilter=at,this.generateMipmaps=!1,this.needsUpdate=!0}}class Lg extends Ir{constructor(r,l,m,y,_,R,I,O,N,V,Q,X){super(null,R,I,O,N,V,y,_,Q,X),this.isCompressedTexture=!0,this.image={width:l,height:m},this.mipmaps=r,this.flipY=!1,this.generateMipmaps=!1}}class XF extends Lg{constructor(r,l,m,y,_,R){super(r,l,m,_,R),this.isCompressedArrayTexture=!0,this.image.depth=y,this.wrapR=We}}class KF extends Lg{constructor(r,l,m){super(void 0,r[0].width,r[0].height,l,m,Qe),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=r}}class qF extends Ir{constructor(r,l,m,y,_,R,I,O,N){super(r,l,m,y,_,R,I,O,N),this.isCanvasTexture=!0,this.needsUpdate=!0}}class pa{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(r,l){const m=this.getUtoTmapping(r);return this.getPoint(m,l)}getPoints(r=5){const l=[];for(let m=0;m<=r;m++)l.push(this.getPoint(m/r));return l}getSpacedPoints(r=5){const l=[];for(let m=0;m<=r;m++)l.push(this.getPointAt(m/r));return l}getLength(){const r=this.getLengths();return r[r.length-1]}getLengths(r=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const l=[];let m,y=this.getPoint(0),_=0;l.push(0);for(let R=1;R<=r;R++)m=this.getPoint(R/r),_+=m.distanceTo(y),l.push(_),y=m;return this.cacheArcLengths=l,l}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(r,l){const m=this.getLengths();let y=0;const _=m.length;let R;l?R=l:R=r*m[_-1];let I=0,O=_-1,N;for(;I<=O;)if(y=Math.floor(I+(O-I)/2),N=m[y]-R,N<0)I=y+1;else if(N>0)O=y-1;else{O=y;break}if(y=O,m[y]===R)return y/(_-1);const V=m[y],X=m[y+1]-V,$=(R-V)/X;return(y+$)/(_-1)}getTangent(r,l){let y=r-1e-4,_=r+1e-4;y<0&&(y=0),_>1&&(_=1);const R=this.getPoint(y),I=this.getPoint(_),O=l||(R.isVector2?new en:new je);return O.copy(I).sub(R).normalize(),O}getTangentAt(r,l){const m=this.getUtoTmapping(r);return this.getTangent(m,l)}computeFrenetFrames(r,l){const m=new je,y=[],_=[],R=[],I=new je,O=new _i;for(let $=0;$<=r;$++){const ie=$/r;y[$]=this.getTangentAt(ie,new je)}_[0]=new je,R[0]=new je;let N=Number.MAX_VALUE;const V=Math.abs(y[0].x),Q=Math.abs(y[0].y),X=Math.abs(y[0].z);V<=N&&(N=V,m.set(1,0,0)),Q<=N&&(N=Q,m.set(0,1,0)),X<=N&&m.set(0,0,1),I.crossVectors(y[0],m).normalize(),_[0].crossVectors(y[0],I),R[0].crossVectors(y[0],_[0]);for(let $=1;$<=r;$++){if(_[$]=_[$-1].clone(),R[$]=R[$-1].clone(),I.crossVectors(y[$-1],y[$]),I.length()>Number.EPSILON){I.normalize();const ie=Math.acos(Nr(y[$-1].dot(y[$]),-1,1));_[$].applyMatrix4(O.makeRotationAxis(I,ie))}R[$].crossVectors(y[$],_[$])}if(l===!0){let $=Math.acos(Nr(_[0].dot(_[r]),-1,1));$/=r,y[0].dot(I.crossVectors(_[0],_[r]))>0&&($=-$);for(let ie=1;ie<=r;ie++)_[ie].applyMatrix4(O.makeRotationAxis(y[ie],$*ie)),R[ie].crossVectors(y[ie],_[ie])}return{tangents:y,normals:_,binormals:R}}clone(){return new this.constructor().copy(this)}copy(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}toJSON(){const r={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r}fromJSON(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}}class Pg extends pa{constructor(r=0,l=0,m=1,y=1,_=0,R=Math.PI*2,I=!1,O=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=r,this.aY=l,this.xRadius=m,this.yRadius=y,this.aStartAngle=_,this.aEndAngle=R,this.aClockwise=I,this.aRotation=O}getPoint(r,l){const m=l||new en,y=Math.PI*2;let _=this.aEndAngle-this.aStartAngle;const R=Math.abs(_)<Number.EPSILON;for(;_<0;)_+=y;for(;_>y;)_-=y;_<Number.EPSILON&&(R?_=0:_=y),this.aClockwise===!0&&!R&&(_===y?_=-y:_=_-y);const I=this.aStartAngle+r*_;let O=this.aX+this.xRadius*Math.cos(I),N=this.aY+this.yRadius*Math.sin(I);if(this.aRotation!==0){const V=Math.cos(this.aRotation),Q=Math.sin(this.aRotation),X=O-this.aX,$=N-this.aY;O=X*V-$*Q+this.aX,N=X*Q+$*V+this.aY}return m.set(O,N)}copy(r){return super.copy(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}toJSON(){const r=super.toJSON();return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r}fromJSON(r){return super.fromJSON(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}}class jM extends Pg{constructor(r,l,m,y,_,R){super(r,l,m,m,y,_,R),this.isArcCurve=!0,this.type="ArcCurve"}}function _x(){let w=0,r=0,l=0,m=0;function y(_,R,I,O){w=_,r=I,l=-3*_+3*R-2*I-O,m=2*_-2*R+I+O}return{initCatmullRom:function(_,R,I,O,N){y(R,I,N*(I-_),N*(O-R))},initNonuniformCatmullRom:function(_,R,I,O,N,V,Q){let X=(R-_)/N-(I-_)/(N+V)+(I-R)/V,$=(I-R)/V-(O-R)/(V+Q)+(O-I)/Q;X*=V,$*=V,y(R,I,X,$)},calc:function(_){const R=_*_,I=R*_;return w+r*_+l*R+m*I}}}const Dg=new je,wx=new _x,Mx=new _x,Cx=new _x;class WM extends pa{constructor(r=[],l=!1,m="centripetal",y=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=r,this.closed=l,this.curveType=m,this.tension=y}getPoint(r,l=new je){const m=l,y=this.points,_=y.length,R=(_-(this.closed?0:1))*r;let I=Math.floor(R),O=R-I;this.closed?I+=I>0?0:(Math.floor(Math.abs(I)/_)+1)*_:O===0&&I===_-1&&(I=_-2,O=1);let N,V;this.closed||I>0?N=y[(I-1)%_]:(Dg.subVectors(y[0],y[1]).add(y[0]),N=Dg);const Q=y[I%_],X=y[(I+1)%_];if(this.closed||I+2<_?V=y[(I+2)%_]:(Dg.subVectors(y[_-1],y[_-2]).add(y[_-1]),V=Dg),this.curveType==="centripetal"||this.curveType==="chordal"){const $=this.curveType==="chordal"?.5:.25;let ie=Math.pow(N.distanceToSquared(Q),$),ue=Math.pow(Q.distanceToSquared(X),$),re=Math.pow(X.distanceToSquared(V),$);ue<1e-4&&(ue=1),ie<1e-4&&(ie=ue),re<1e-4&&(re=ue),wx.initNonuniformCatmullRom(N.x,Q.x,X.x,V.x,ie,ue,re),Mx.initNonuniformCatmullRom(N.y,Q.y,X.y,V.y,ie,ue,re),Cx.initNonuniformCatmullRom(N.z,Q.z,X.z,V.z,ie,ue,re)}else this.curveType==="catmullrom"&&(wx.initCatmullRom(N.x,Q.x,X.x,V.x,this.tension),Mx.initCatmullRom(N.y,Q.y,X.y,V.y,this.tension),Cx.initCatmullRom(N.z,Q.z,X.z,V.z,this.tension));return m.set(wx.calc(O),Mx.calc(O),Cx.calc(O)),m}copy(r){super.copy(r),this.points=[];for(let l=0,m=r.points.length;l<m;l++){const y=r.points[l];this.points.push(y.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}toJSON(){const r=super.toJSON();r.points=[];for(let l=0,m=this.points.length;l<m;l++){const y=this.points[l];r.points.push(y.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r}fromJSON(r){super.fromJSON(r),this.points=[];for(let l=0,m=r.points.length;l<m;l++){const y=r.points[l];this.points.push(new je().fromArray(y))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}}function QM(w,r,l,m,y){const _=(m-r)*.5,R=(y-l)*.5,I=w*w,O=w*I;return(2*l-2*m+_+R)*O+(-3*l+3*m-2*_-R)*I+_*w+l}function YF(w,r){const l=1-w;return l*l*r}function $F(w,r){return 2*(1-w)*w*r}function JF(w,r){return w*w*r}function Qf(w,r,l,m){return YF(w,r)+$F(w,l)+JF(w,m)}function ZF(w,r){const l=1-w;return l*l*l*r}function eN(w,r){const l=1-w;return 3*l*l*w*r}function tN(w,r){return 3*(1-w)*w*w*r}function nN(w,r){return w*w*w*r}function Xf(w,r,l,m,y){return ZF(w,r)+eN(w,l)+tN(w,m)+nN(w,y)}class Sx extends pa{constructor(r=new en,l=new en,m=new en,y=new en){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=r,this.v1=l,this.v2=m,this.v3=y}getPoint(r,l=new en){const m=l,y=this.v0,_=this.v1,R=this.v2,I=this.v3;return m.set(Xf(r,y.x,_.x,R.x,I.x),Xf(r,y.y,_.y,R.y,I.y)),m}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}}class XM extends pa{constructor(r=new je,l=new je,m=new je,y=new je){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=r,this.v1=l,this.v2=m,this.v3=y}getPoint(r,l=new je){const m=l,y=this.v0,_=this.v1,R=this.v2,I=this.v3;return m.set(Xf(r,y.x,_.x,R.x,I.x),Xf(r,y.y,_.y,R.y,I.y),Xf(r,y.z,_.z,R.z,I.z)),m}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}}class Tx extends pa{constructor(r=new en,l=new en){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=r,this.v2=l}getPoint(r,l=new en){const m=l;return r===1?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(r).add(this.v1)),m}getPointAt(r,l){return this.getPoint(r,l)}getTangent(r,l=new en){return l.subVectors(this.v2,this.v1).normalize()}getTangentAt(r,l){return this.getTangent(r,l)}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class KM extends pa{constructor(r=new je,l=new je){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=r,this.v2=l}getPoint(r,l=new je){const m=l;return r===1?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(r).add(this.v1)),m}getPointAt(r,l){return this.getPoint(r,l)}getTangent(r,l=new je){return l.subVectors(this.v2,this.v1).normalize()}getTangentAt(r,l){return this.getTangent(r,l)}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class Rx extends pa{constructor(r=new en,l=new en,m=new en){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=r,this.v1=l,this.v2=m}getPoint(r,l=new en){const m=l,y=this.v0,_=this.v1,R=this.v2;return m.set(Qf(r,y.x,_.x,R.x),Qf(r,y.y,_.y,R.y)),m}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class Ix extends pa{constructor(r=new je,l=new je,m=new je){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=r,this.v1=l,this.v2=m}getPoint(r,l=new je){const m=l,y=this.v0,_=this.v1,R=this.v2;return m.set(Qf(r,y.x,_.x,R.x),Qf(r,y.y,_.y,R.y),Qf(r,y.z,_.z,R.z)),m}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class Bx extends pa{constructor(r=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=r}getPoint(r,l=new en){const m=l,y=this.points,_=(y.length-1)*r,R=Math.floor(_),I=_-R,O=y[R===0?R:R-1],N=y[R],V=y[R>y.length-2?y.length-1:R+1],Q=y[R>y.length-3?y.length-1:R+2];return m.set(QM(I,O.x,N.x,V.x,Q.x),QM(I,O.y,N.y,V.y,Q.y)),m}copy(r){super.copy(r),this.points=[];for(let l=0,m=r.points.length;l<m;l++){const y=r.points[l];this.points.push(y.clone())}return this}toJSON(){const r=super.toJSON();r.points=[];for(let l=0,m=this.points.length;l<m;l++){const y=this.points[l];r.points.push(y.toArray())}return r}fromJSON(r){super.fromJSON(r),this.points=[];for(let l=0,m=r.points.length;l<m;l++){const y=r.points[l];this.points.push(new en().fromArray(y))}return this}}var Og=Object.freeze({__proto__:null,ArcCurve:jM,CatmullRomCurve3:WM,CubicBezierCurve:Sx,CubicBezierCurve3:XM,EllipseCurve:Pg,LineCurve:Tx,LineCurve3:KM,QuadraticBezierCurve:Rx,QuadraticBezierCurve3:Ix,SplineCurve:Bx});class qM extends pa{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(r){this.curves.push(r)}closePath(){const r=this.curves[0].getPoint(0),l=this.curves[this.curves.length-1].getPoint(1);if(!r.equals(l)){const m=r.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Og[m](l,r))}return this}getPoint(r,l){const m=r*this.getLength(),y=this.getCurveLengths();let _=0;for(;_<y.length;){if(y[_]>=m){const R=y[_]-m,I=this.curves[_],O=I.getLength(),N=O===0?0:1-R/O;return I.getPointAt(N,l)}_++}return null}getLength(){const r=this.getCurveLengths();return r[r.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const r=[];let l=0;for(let m=0,y=this.curves.length;m<y;m++)l+=this.curves[m].getLength(),r.push(l);return this.cacheLengths=r,r}getSpacedPoints(r=40){const l=[];for(let m=0;m<=r;m++)l.push(this.getPoint(m/r));return this.autoClose&&l.push(l[0]),l}getPoints(r=12){const l=[];let m;for(let y=0,_=this.curves;y<_.length;y++){const R=_[y],I=R.isEllipseCurve?r*2:R.isLineCurve||R.isLineCurve3?1:R.isSplineCurve?r*R.points.length:r,O=R.getPoints(I);for(let N=0;N<O.length;N++){const V=O[N];m&&m.equals(V)||(l.push(V),m=V)}}return this.autoClose&&l.length>1&&!l[l.length-1].equals(l[0])&&l.push(l[0]),l}copy(r){super.copy(r),this.curves=[];for(let l=0,m=r.curves.length;l<m;l++){const y=r.curves[l];this.curves.push(y.clone())}return this.autoClose=r.autoClose,this}toJSON(){const r=super.toJSON();r.autoClose=this.autoClose,r.curves=[];for(let l=0,m=this.curves.length;l<m;l++){const y=this.curves[l];r.curves.push(y.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.autoClose=r.autoClose,this.curves=[];for(let l=0,m=r.curves.length;l<m;l++){const y=r.curves[l];this.curves.push(new Og[y.type]().fromJSON(y))}return this}}class Kf extends qM{constructor(r){super(),this.type="Path",this.currentPoint=new en,r&&this.setFromPoints(r)}setFromPoints(r){this.moveTo(r[0].x,r[0].y);for(let l=1,m=r.length;l<m;l++)this.lineTo(r[l].x,r[l].y);return this}moveTo(r,l){return this.currentPoint.set(r,l),this}lineTo(r,l){const m=new Tx(this.currentPoint.clone(),new en(r,l));return this.curves.push(m),this.currentPoint.set(r,l),this}quadraticCurveTo(r,l,m,y){const _=new Rx(this.currentPoint.clone(),new en(r,l),new en(m,y));return this.curves.push(_),this.currentPoint.set(m,y),this}bezierCurveTo(r,l,m,y,_,R){const I=new Sx(this.currentPoint.clone(),new en(r,l),new en(m,y),new en(_,R));return this.curves.push(I),this.currentPoint.set(_,R),this}splineThru(r){const l=[this.currentPoint.clone()].concat(r),m=new Bx(l);return this.curves.push(m),this.currentPoint.copy(r[r.length-1]),this}arc(r,l,m,y,_,R){const I=this.currentPoint.x,O=this.currentPoint.y;return this.absarc(r+I,l+O,m,y,_,R),this}absarc(r,l,m,y,_,R){return this.absellipse(r,l,m,m,y,_,R),this}ellipse(r,l,m,y,_,R,I,O){const N=this.currentPoint.x,V=this.currentPoint.y;return this.absellipse(r+N,l+V,m,y,_,R,I,O),this}absellipse(r,l,m,y,_,R,I,O){const N=new Pg(r,l,m,y,_,R,I,O);if(this.curves.length>0){const Q=N.getPoint(0);Q.equals(this.currentPoint)||this.lineTo(Q.x,Q.y)}this.curves.push(N);const V=N.getPoint(1);return this.currentPoint.copy(V),this}copy(r){return super.copy(r),this.currentPoint.copy(r.currentPoint),this}toJSON(){const r=super.toJSON();return r.currentPoint=this.currentPoint.toArray(),r}fromJSON(r){return super.fromJSON(r),this.currentPoint.fromArray(r.currentPoint),this}}class qf extends Yi{constructor(r=[new en(0,-.5),new en(.5,0),new en(0,.5)],l=12,m=0,y=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:r,segments:l,phiStart:m,phiLength:y},l=Math.floor(l),y=Nr(y,0,Math.PI*2);const _=[],R=[],I=[],O=[],N=[],V=1/l,Q=new je,X=new en,$=new je,ie=new je,ue=new je;let re=0,q=0;for(let Se=0;Se<=r.length-1;Se++)switch(Se){case 0:re=r[Se+1].x-r[Se].x,q=r[Se+1].y-r[Se].y,$.x=q*1,$.y=-re,$.z=q*0,ue.copy($),$.normalize(),O.push($.x,$.y,$.z);break;case r.length-1:O.push(ue.x,ue.y,ue.z);break;default:re=r[Se+1].x-r[Se].x,q=r[Se+1].y-r[Se].y,$.x=q*1,$.y=-re,$.z=q*0,ie.copy($),$.x+=ue.x,$.y+=ue.y,$.z+=ue.z,$.normalize(),O.push($.x,$.y,$.z),ue.copy(ie)}for(let Se=0;Se<=l;Se++){const fe=m+Se*V*y,Me=Math.sin(fe),ze=Math.cos(fe);for(let He=0;He<=r.length-1;He++){Q.x=r[He].x*Me,Q.y=r[He].y,Q.z=r[He].x*ze,R.push(Q.x,Q.y,Q.z),X.x=Se/l,X.y=He/(r.length-1),I.push(X.x,X.y);const et=O[3*He+0]*Me,st=O[3*He+1],Be=O[3*He+0]*ze;N.push(et,st,Be)}}for(let Se=0;Se<l;Se++)for(let fe=0;fe<r.length-1;fe++){const Me=fe+Se*r.length,ze=Me,He=Me+r.length,et=Me+r.length+1,st=Me+1;_.push(ze,He,st),_.push(et,st,He)}this.setIndex(_),this.setAttribute("position",new ni(R,3)),this.setAttribute("uv",new ni(I,2)),this.setAttribute("normal",new ni(N,3))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new qf(r.points,r.segments,r.phiStart,r.phiLength)}}class Fg extends qf{constructor(r=1,l=1,m=4,y=8){const _=new Kf;_.absarc(0,-l/2,r,Math.PI*1.5,0),_.absarc(0,l/2,r,0,Math.PI*.5),super(_.getPoints(m),y),this.type="CapsuleGeometry",this.parameters={radius:r,length:l,capSegments:m,radialSegments:y}}static fromJSON(r){return new Fg(r.radius,r.length,r.capSegments,r.radialSegments)}}class Ng extends Yi{constructor(r=1,l=32,m=0,y=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:r,segments:l,thetaStart:m,thetaLength:y},l=Math.max(3,l);const _=[],R=[],I=[],O=[],N=new je,V=new en;R.push(0,0,0),I.push(0,0,1),O.push(.5,.5);for(let Q=0,X=3;Q<=l;Q++,X+=3){const $=m+Q/l*y;N.x=r*Math.cos($),N.y=r*Math.sin($),R.push(N.x,N.y,N.z),I.push(0,0,1),V.x=(R[X]/r+1)/2,V.y=(R[X+1]/r+1)/2,O.push(V.x,V.y)}for(let Q=1;Q<=l;Q++)_.push(Q,Q+1,0);this.setIndex(_),this.setAttribute("position",new ni(R,3)),this.setAttribute("normal",new ni(I,3)),this.setAttribute("uv",new ni(O,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Ng(r.radius,r.segments,r.thetaStart,r.thetaLength)}}class Hu extends Yi{constructor(r=1,l=1,m=1,y=32,_=1,R=!1,I=0,O=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:r,radiusBottom:l,height:m,radialSegments:y,heightSegments:_,openEnded:R,thetaStart:I,thetaLength:O};const N=this;y=Math.floor(y),_=Math.floor(_);const V=[],Q=[],X=[],$=[];let ie=0;const ue=[],re=m/2;let q=0;Se(),R===!1&&(r>0&&fe(!0),l>0&&fe(!1)),this.setIndex(V),this.setAttribute("position",new ni(Q,3)),this.setAttribute("normal",new ni(X,3)),this.setAttribute("uv",new ni($,2));function Se(){const Me=new je,ze=new je;let He=0;const et=(l-r)/m;for(let st=0;st<=_;st++){const Be=[],Xe=st/_,rt=Xe*(l-r)+r;for(let bt=0;bt<=y;bt++){const Gt=bt/y,lt=Gt*O+I,wt=Math.sin(lt),Kt=Math.cos(lt);ze.x=rt*wt,ze.y=-Xe*m+re,ze.z=rt*Kt,Q.push(ze.x,ze.y,ze.z),Me.set(wt,et,Kt).normalize(),X.push(Me.x,Me.y,Me.z),$.push(Gt,1-Xe),Be.push(ie++)}ue.push(Be)}for(let st=0;st<y;st++)for(let Be=0;Be<_;Be++){const Xe=ue[Be][st],rt=ue[Be+1][st],bt=ue[Be+1][st+1],Gt=ue[Be][st+1];V.push(Xe,rt,Gt),V.push(rt,bt,Gt),He+=6}N.addGroup(q,He,0),q+=He}function fe(Me){const ze=ie,He=new en,et=new je;let st=0;const Be=Me===!0?r:l,Xe=Me===!0?1:-1;for(let bt=1;bt<=y;bt++)Q.push(0,re*Xe,0),X.push(0,Xe,0),$.push(.5,.5),ie++;const rt=ie;for(let bt=0;bt<=y;bt++){const lt=bt/y*O+I,wt=Math.cos(lt),Kt=Math.sin(lt);et.x=Be*Kt,et.y=re*Xe,et.z=Be*wt,Q.push(et.x,et.y,et.z),X.push(0,Xe,0),He.x=wt*.5+.5,He.y=Kt*.5*Xe+.5,$.push(He.x,He.y),ie++}for(let bt=0;bt<y;bt++){const Gt=ze+bt,lt=rt+bt;Me===!0?V.push(lt,lt+1,Gt):V.push(lt+1,lt,Gt),st+=3}N.addGroup(q,st,Me===!0?1:2),q+=st}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Hu(r.radiusTop,r.radiusBottom,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}}class Ug extends Hu{constructor(r=1,l=1,m=32,y=1,_=!1,R=0,I=Math.PI*2){super(0,r,l,m,y,_,R,I),this.type="ConeGeometry",this.parameters={radius:r,height:l,radialSegments:m,heightSegments:y,openEnded:_,thetaStart:R,thetaLength:I}}static fromJSON(r){return new Ug(r.radius,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}}class pc extends Yi{constructor(r=[],l=[],m=1,y=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:r,indices:l,radius:m,detail:y};const _=[],R=[];I(y),N(m),V(),this.setAttribute("position",new ni(_,3)),this.setAttribute("normal",new ni(_.slice(),3)),this.setAttribute("uv",new ni(R,2)),y===0?this.computeVertexNormals():this.normalizeNormals();function I(Se){const fe=new je,Me=new je,ze=new je;for(let He=0;He<l.length;He+=3)$(l[He+0],fe),$(l[He+1],Me),$(l[He+2],ze),O(fe,Me,ze,Se)}function O(Se,fe,Me,ze){const He=ze+1,et=[];for(let st=0;st<=He;st++){et[st]=[];const Be=Se.clone().lerp(Me,st/He),Xe=fe.clone().lerp(Me,st/He),rt=He-st;for(let bt=0;bt<=rt;bt++)bt===0&&st===He?et[st][bt]=Be:et[st][bt]=Be.clone().lerp(Xe,bt/rt)}for(let st=0;st<He;st++)for(let Be=0;Be<2*(He-st)-1;Be++){const Xe=Math.floor(Be/2);Be%2===0?(X(et[st][Xe+1]),X(et[st+1][Xe]),X(et[st][Xe])):(X(et[st][Xe+1]),X(et[st+1][Xe+1]),X(et[st+1][Xe]))}}function N(Se){const fe=new je;for(let Me=0;Me<_.length;Me+=3)fe.x=_[Me+0],fe.y=_[Me+1],fe.z=_[Me+2],fe.normalize().multiplyScalar(Se),_[Me+0]=fe.x,_[Me+1]=fe.y,_[Me+2]=fe.z}function V(){const Se=new je;for(let fe=0;fe<_.length;fe+=3){Se.x=_[fe+0],Se.y=_[fe+1],Se.z=_[fe+2];const Me=re(Se)/2/Math.PI+.5,ze=q(Se)/Math.PI+.5;R.push(Me,1-ze)}ie(),Q()}function Q(){for(let Se=0;Se<R.length;Se+=6){const fe=R[Se+0],Me=R[Se+2],ze=R[Se+4],He=Math.max(fe,Me,ze),et=Math.min(fe,Me,ze);He>.9&&et<.1&&(fe<.2&&(R[Se+0]+=1),Me<.2&&(R[Se+2]+=1),ze<.2&&(R[Se+4]+=1))}}function X(Se){_.push(Se.x,Se.y,Se.z)}function $(Se,fe){const Me=Se*3;fe.x=r[Me+0],fe.y=r[Me+1],fe.z=r[Me+2]}function ie(){const Se=new je,fe=new je,Me=new je,ze=new je,He=new en,et=new en,st=new en;for(let Be=0,Xe=0;Be<_.length;Be+=9,Xe+=6){Se.set(_[Be+0],_[Be+1],_[Be+2]),fe.set(_[Be+3],_[Be+4],_[Be+5]),Me.set(_[Be+6],_[Be+7],_[Be+8]),He.set(R[Xe+0],R[Xe+1]),et.set(R[Xe+2],R[Xe+3]),st.set(R[Xe+4],R[Xe+5]),ze.copy(Se).add(fe).add(Me).divideScalar(3);const rt=re(ze);ue(He,Xe+0,Se,rt),ue(et,Xe+2,fe,rt),ue(st,Xe+4,Me,rt)}}function ue(Se,fe,Me,ze){ze<0&&Se.x===1&&(R[fe]=Se.x-1),Me.x===0&&Me.z===0&&(R[fe]=ze/2/Math.PI+.5)}function re(Se){return Math.atan2(Se.z,-Se.x)}function q(Se){return Math.atan2(-Se.y,Math.sqrt(Se.x*Se.x+Se.z*Se.z))}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new pc(r.vertices,r.indices,r.radius,r.details)}}class kg extends pc{constructor(r=1,l=0){const m=(1+Math.sqrt(5))/2,y=1/m,_=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-y,-m,0,-y,m,0,y,-m,0,y,m,-y,-m,0,-y,m,0,y,-m,0,y,m,0,-m,0,-y,m,0,-y,-m,0,y,m,0,y],R=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(_,R,r,l),this.type="DodecahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new kg(r.radius,r.detail)}}const zg=new je,Gg=new je,Lx=new je,Vg=new bo;class YM extends Yi{constructor(r=null,l=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:r,thresholdAngle:l},r!==null){const y=Math.pow(10,4),_=Math.cos(al*l),R=r.getIndex(),I=r.getAttribute("position"),O=R?R.count:I.count,N=[0,0,0],V=["a","b","c"],Q=new Array(3),X={},$=[];for(let ie=0;ie<O;ie+=3){R?(N[0]=R.getX(ie),N[1]=R.getX(ie+1),N[2]=R.getX(ie+2)):(N[0]=ie,N[1]=ie+1,N[2]=ie+2);const{a:ue,b:re,c:q}=Vg;if(ue.fromBufferAttribute(I,N[0]),re.fromBufferAttribute(I,N[1]),q.fromBufferAttribute(I,N[2]),Vg.getNormal(Lx),Q[0]=`${Math.round(ue.x*y)},${Math.round(ue.y*y)},${Math.round(ue.z*y)}`,Q[1]=`${Math.round(re.x*y)},${Math.round(re.y*y)},${Math.round(re.z*y)}`,Q[2]=`${Math.round(q.x*y)},${Math.round(q.y*y)},${Math.round(q.z*y)}`,!(Q[0]===Q[1]||Q[1]===Q[2]||Q[2]===Q[0]))for(let Se=0;Se<3;Se++){const fe=(Se+1)%3,Me=Q[Se],ze=Q[fe],He=Vg[V[Se]],et=Vg[V[fe]],st=`${Me}_${ze}`,Be=`${ze}_${Me}`;Be in X&&X[Be]?(Lx.dot(X[Be].normal)<=_&&($.push(He.x,He.y,He.z),$.push(et.x,et.y,et.z)),X[Be]=null):st in X||(X[st]={index0:N[Se],index1:N[fe],normal:Lx.clone()})}}for(const ie in X)if(X[ie]){const{index0:ue,index1:re}=X[ie];zg.fromBufferAttribute(I,ue),Gg.fromBufferAttribute(I,re),$.push(zg.x,zg.y,zg.z),$.push(Gg.x,Gg.y,Gg.z)}this.setAttribute("position",new ni($,3))}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}}class yh extends Kf{constructor(r){super(r),this.uuid=no(),this.type="Shape",this.holes=[]}getPointsHoles(r){const l=[];for(let m=0,y=this.holes.length;m<y;m++)l[m]=this.holes[m].getPoints(r);return l}extractPoints(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}}copy(r){super.copy(r),this.holes=[];for(let l=0,m=r.holes.length;l<m;l++){const y=r.holes[l];this.holes.push(y.clone())}return this}toJSON(){const r=super.toJSON();r.uuid=this.uuid,r.holes=[];for(let l=0,m=this.holes.length;l<m;l++){const y=this.holes[l];r.holes.push(y.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.uuid=r.uuid,this.holes=[];for(let l=0,m=r.holes.length;l<m;l++){const y=r.holes[l];this.holes.push(new Kf().fromJSON(y))}return this}}const iN={triangulate:function(w,r,l=2){const m=r&&r.length,y=m?r[0]*l:w.length;let _=$M(w,0,y,l,!0);const R=[];if(!_||_.next===_.prev)return R;let I,O,N,V,Q,X,$;if(m&&(_=lN(w,r,_,l)),w.length>80*l){I=N=w[0],O=V=w[1];for(let ie=l;ie<y;ie+=l)Q=w[ie],X=w[ie+1],Q<I&&(I=Q),X<O&&(O=X),Q>N&&(N=Q),X>V&&(V=X);$=Math.max(N-I,V-O),$=$!==0?32767/$:0}return Yf(_,R,l,I,O,$,0),R}};function $M(w,r,l,m,y){let _,R;if(y===yN(w,r,l,m)>0)for(_=r;_<l;_+=m)R=e2(_,w[_],w[_+1],R);else for(_=l-m;_>=r;_-=m)R=e2(_,w[_],w[_+1],R);return R&&Hg(R,R.next)&&(Jf(R),R=R.next),R}function xh(w,r){if(!w)return w;r||(r=w);let l=w,m;do if(m=!1,!l.steiner&&(Hg(l,l.next)||Hr(l.prev,l,l.next)===0)){if(Jf(l),l=r=l.prev,l===l.next)break;m=!0}else l=l.next;while(m||l!==r);return r}function Yf(w,r,l,m,y,_,R){if(!w)return;!R&&_&&fN(w,m,y,_);let I=w,O,N;for(;w.prev!==w.next;){if(O=w.prev,N=w.next,_?sN(w,m,y,_):rN(w)){r.push(O.i/l|0),r.push(w.i/l|0),r.push(N.i/l|0),Jf(w),w=N.next,I=N.next;continue}if(w=N,w===I){R?R===1?(w=oN(xh(w),r,l),Yf(w,r,l,m,y,_,2)):R===2&&aN(w,r,l,m,y,_):Yf(xh(w),r,l,m,y,_,1);break}}}function rN(w){const r=w.prev,l=w,m=w.next;if(Hr(r,l,m)>=0)return!1;const y=r.x,_=l.x,R=m.x,I=r.y,O=l.y,N=m.y,V=y<_?y<R?y:R:_<R?_:R,Q=I<O?I<N?I:N:O<N?O:N,X=y>_?y>R?y:R:_>R?_:R,$=I>O?I>N?I:N:O>N?O:N;let ie=m.next;for(;ie!==r;){if(ie.x>=V&&ie.x<=X&&ie.y>=Q&&ie.y<=$&&ju(y,I,_,O,R,N,ie.x,ie.y)&&Hr(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function sN(w,r,l,m){const y=w.prev,_=w,R=w.next;if(Hr(y,_,R)>=0)return!1;const I=y.x,O=_.x,N=R.x,V=y.y,Q=_.y,X=R.y,$=I<O?I<N?I:N:O<N?O:N,ie=V<Q?V<X?V:X:Q<X?Q:X,ue=I>O?I>N?I:N:O>N?O:N,re=V>Q?V>X?V:X:Q>X?Q:X,q=Px($,ie,r,l,m),Se=Px(ue,re,r,l,m);let fe=w.prevZ,Me=w.nextZ;for(;fe&&fe.z>=q&&Me&&Me.z<=Se;){if(fe.x>=$&&fe.x<=ue&&fe.y>=ie&&fe.y<=re&&fe!==y&&fe!==R&&ju(I,V,O,Q,N,X,fe.x,fe.y)&&Hr(fe.prev,fe,fe.next)>=0||(fe=fe.prevZ,Me.x>=$&&Me.x<=ue&&Me.y>=ie&&Me.y<=re&&Me!==y&&Me!==R&&ju(I,V,O,Q,N,X,Me.x,Me.y)&&Hr(Me.prev,Me,Me.next)>=0))return!1;Me=Me.nextZ}for(;fe&&fe.z>=q;){if(fe.x>=$&&fe.x<=ue&&fe.y>=ie&&fe.y<=re&&fe!==y&&fe!==R&&ju(I,V,O,Q,N,X,fe.x,fe.y)&&Hr(fe.prev,fe,fe.next)>=0)return!1;fe=fe.prevZ}for(;Me&&Me.z<=Se;){if(Me.x>=$&&Me.x<=ue&&Me.y>=ie&&Me.y<=re&&Me!==y&&Me!==R&&ju(I,V,O,Q,N,X,Me.x,Me.y)&&Hr(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}return!0}function oN(w,r,l){let m=w;do{const y=m.prev,_=m.next.next;!Hg(y,_)&&JM(y,m,m.next,_)&&$f(y,_)&&$f(_,y)&&(r.push(y.i/l|0),r.push(m.i/l|0),r.push(_.i/l|0),Jf(m),Jf(m.next),m=w=_),m=m.next}while(m!==w);return xh(m)}function aN(w,r,l,m,y,_){let R=w;do{let I=R.next.next;for(;I!==R.prev;){if(R.i!==I.i&&gN(R,I)){let O=ZM(R,I);R=xh(R,R.next),O=xh(O,O.next),Yf(R,r,l,m,y,_,0),Yf(O,r,l,m,y,_,0);return}I=I.next}R=R.next}while(R!==w)}function lN(w,r,l,m){const y=[];let _,R,I,O,N;for(_=0,R=r.length;_<R;_++)I=r[_]*m,O=_<R-1?r[_+1]*m:w.length,N=$M(w,I,O,m,!1),N===N.next&&(N.steiner=!0),y.push(mN(N));for(y.sort(cN),_=0;_<y.length;_++)l=hN(y[_],l);return l}function cN(w,r){return w.x-r.x}function hN(w,r){const l=uN(w,r);if(!l)return r;const m=ZM(l,w);return xh(m,m.next),xh(l,l.next)}function uN(w,r){let l=r,m=-1/0,y;const _=w.x,R=w.y;do{if(R<=l.y&&R>=l.next.y&&l.next.y!==l.y){const X=l.x+(R-l.y)*(l.next.x-l.x)/(l.next.y-l.y);if(X<=_&&X>m&&(m=X,y=l.x<l.next.x?l:l.next,X===_))return y}l=l.next}while(l!==r);if(!y)return null;const I=y,O=y.x,N=y.y;let V=1/0,Q;l=y;do _>=l.x&&l.x>=O&&_!==l.x&&ju(R<N?_:m,R,O,N,R<N?m:_,R,l.x,l.y)&&(Q=Math.abs(R-l.y)/(_-l.x),$f(l,w)&&(Q<V||Q===V&&(l.x>y.x||l.x===y.x&&dN(y,l)))&&(y=l,V=Q)),l=l.next;while(l!==I);return y}function dN(w,r){return Hr(w.prev,w,r.prev)<0&&Hr(r.next,w,w.next)<0}function fN(w,r,l,m){let y=w;do y.z===0&&(y.z=Px(y.x,y.y,r,l,m)),y.prevZ=y.prev,y.nextZ=y.next,y=y.next;while(y!==w);y.prevZ.nextZ=null,y.prevZ=null,pN(y)}function pN(w){let r,l,m,y,_,R,I,O,N=1;do{for(l=w,w=null,_=null,R=0;l;){for(R++,m=l,I=0,r=0;r<N&&(I++,m=m.nextZ,!!m);r++);for(O=N;I>0||O>0&&m;)I!==0&&(O===0||!m||l.z<=m.z)?(y=l,l=l.nextZ,I--):(y=m,m=m.nextZ,O--),_?_.nextZ=y:w=y,y.prevZ=_,_=y;l=m}_.nextZ=null,N*=2}while(R>1);return w}function Px(w,r,l,m,y){return w=(w-l)*y|0,r=(r-m)*y|0,w=(w|w<<8)&16711935,w=(w|w<<4)&252645135,w=(w|w<<2)&858993459,w=(w|w<<1)&1431655765,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,w|r<<1}function mN(w){let r=w,l=w;do(r.x<l.x||r.x===l.x&&r.y<l.y)&&(l=r),r=r.next;while(r!==w);return l}function ju(w,r,l,m,y,_,R,I){return(y-R)*(r-I)>=(w-R)*(_-I)&&(w-R)*(m-I)>=(l-R)*(r-I)&&(l-R)*(_-I)>=(y-R)*(m-I)}function gN(w,r){return w.next.i!==r.i&&w.prev.i!==r.i&&!AN(w,r)&&($f(w,r)&&$f(r,w)&&vN(w,r)&&(Hr(w.prev,w,r.prev)||Hr(w,r.prev,r))||Hg(w,r)&&Hr(w.prev,w,w.next)>0&&Hr(r.prev,r,r.next)>0)}function Hr(w,r,l){return(r.y-w.y)*(l.x-r.x)-(r.x-w.x)*(l.y-r.y)}function Hg(w,r){return w.x===r.x&&w.y===r.y}function JM(w,r,l,m){const y=Wg(Hr(w,r,l)),_=Wg(Hr(w,r,m)),R=Wg(Hr(l,m,w)),I=Wg(Hr(l,m,r));return!!(y!==_&&R!==I||y===0&&jg(w,l,r)||_===0&&jg(w,m,r)||R===0&&jg(l,w,m)||I===0&&jg(l,r,m))}function jg(w,r,l){return r.x<=Math.max(w.x,l.x)&&r.x>=Math.min(w.x,l.x)&&r.y<=Math.max(w.y,l.y)&&r.y>=Math.min(w.y,l.y)}function Wg(w){return w>0?1:w<0?-1:0}function AN(w,r){let l=w;do{if(l.i!==w.i&&l.next.i!==w.i&&l.i!==r.i&&l.next.i!==r.i&&JM(l,l.next,w,r))return!0;l=l.next}while(l!==w);return!1}function $f(w,r){return Hr(w.prev,w,w.next)<0?Hr(w,r,w.next)>=0&&Hr(w,w.prev,r)>=0:Hr(w,r,w.prev)<0||Hr(w,w.next,r)<0}function vN(w,r){let l=w,m=!1;const y=(w.x+r.x)/2,_=(w.y+r.y)/2;do l.y>_!=l.next.y>_&&l.next.y!==l.y&&y<(l.next.x-l.x)*(_-l.y)/(l.next.y-l.y)+l.x&&(m=!m),l=l.next;while(l!==w);return m}function ZM(w,r){const l=new Dx(w.i,w.x,w.y),m=new Dx(r.i,r.x,r.y),y=w.next,_=r.prev;return w.next=r,r.prev=w,l.next=y,y.prev=l,m.next=l,l.prev=m,_.next=m,m.prev=_,m}function e2(w,r,l,m){const y=new Dx(w,r,l);return m?(y.next=m.next,y.prev=m,m.next.prev=y,m.next=y):(y.prev=y,y.next=y),y}function Jf(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function Dx(w,r,l){this.i=w,this.x=r,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function yN(w,r,l,m){let y=0;for(let _=r,R=l-m;_<l;_+=m)y+=(w[R]-w[_])*(w[_+1]+w[R+1]),R=_;return y}class Ya{static area(r){const l=r.length;let m=0;for(let y=l-1,_=0;_<l;y=_++)m+=r[y].x*r[_].y-r[_].x*r[y].y;return m*.5}static isClockWise(r){return Ya.area(r)<0}static triangulateShape(r,l){const m=[],y=[],_=[];t2(r),n2(m,r);let R=r.length;l.forEach(t2);for(let O=0;O<l.length;O++)y.push(R),R+=l[O].length,n2(m,l[O]);const I=iN.triangulate(m,y);for(let O=0;O<I.length;O+=3)_.push(I.slice(O,O+3));return _}}function t2(w){const r=w.length;r>2&&w[r-1].equals(w[0])&&w.pop()}function n2(w,r){for(let l=0;l<r.length;l++)w.push(r[l].x),w.push(r[l].y)}class Qg extends Yi{constructor(r=new yh([new en(.5,.5),new en(-.5,.5),new en(-.5,-.5),new en(.5,-.5)]),l={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:r,options:l},r=Array.isArray(r)?r:[r];const m=this,y=[],_=[];for(let I=0,O=r.length;I<O;I++){const N=r[I];R(N)}this.setAttribute("position",new ni(y,3)),this.setAttribute("uv",new ni(_,2)),this.computeVertexNormals();function R(I){const O=[],N=l.curveSegments!==void 0?l.curveSegments:12,V=l.steps!==void 0?l.steps:1,Q=l.depth!==void 0?l.depth:1;let X=l.bevelEnabled!==void 0?l.bevelEnabled:!0,$=l.bevelThickness!==void 0?l.bevelThickness:.2,ie=l.bevelSize!==void 0?l.bevelSize:$-.1,ue=l.bevelOffset!==void 0?l.bevelOffset:0,re=l.bevelSegments!==void 0?l.bevelSegments:3;const q=l.extrudePath,Se=l.UVGenerator!==void 0?l.UVGenerator:xN;let fe,Me=!1,ze,He,et,st;q&&(fe=q.getSpacedPoints(V),Me=!0,X=!1,ze=q.computeFrenetFrames(V,!1),He=new je,et=new je,st=new je),X||(re=0,$=0,ie=0,ue=0);const Be=I.extractPoints(N);let Xe=Be.shape;const rt=Be.holes;if(!Ya.isClockWise(Xe)){Xe=Xe.reverse();for(let nn=0,ct=rt.length;nn<ct;nn++){const hn=rt[nn];Ya.isClockWise(hn)&&(rt[nn]=hn.reverse())}}const Gt=Ya.triangulateShape(Xe,rt),lt=Xe;for(let nn=0,ct=rt.length;nn<ct;nn++){const hn=rt[nn];Xe=Xe.concat(hn)}function wt(nn,ct,hn){return ct||console.error("THREE.ExtrudeGeometry: vec does not exist"),nn.clone().addScaledVector(ct,hn)}const Kt=Xe.length,qt=Gt.length;function ln(nn,ct,hn){let In,rn,Gn;const mi=nn.x-ct.x,ti=nn.y-ct.y,gi=hn.x-nn.x,ir=hn.y-nn.y,Lr=mi*mi+ti*ti,fs=mi*ir-ti*gi;if(Math.abs(fs)>Number.EPSILON){const br=Math.sqrt(Lr),gr=Math.sqrt(gi*gi+ir*ir),$r=ct.x-ti/br,Mo=ct.y+mi/br,qe=hn.x-ir/gr,Ie=hn.y+gi/gr,St=((qe-$r)*ir-(Ie-Mo)*gi)/(mi*ir-ti*gi);In=$r+mi*St-nn.x,rn=Mo+ti*St-nn.y;const an=In*In+rn*rn;if(an<=2)return new en(In,rn);Gn=Math.sqrt(an/2)}else{let br=!1;mi>Number.EPSILON?gi>Number.EPSILON&&(br=!0):mi<-Number.EPSILON?gi<-Number.EPSILON&&(br=!0):Math.sign(ti)===Math.sign(ir)&&(br=!0),br?(In=-ti,rn=mi,Gn=Math.sqrt(Lr)):(In=mi,rn=ti,Gn=Math.sqrt(Lr/2))}return new en(In/Gn,rn/Gn)}const Jt=[];for(let nn=0,ct=lt.length,hn=ct-1,In=nn+1;nn<ct;nn++,hn++,In++)hn===ct&&(hn=0),In===ct&&(In=0),Jt[nn]=ln(lt[nn],lt[hn],lt[In]);const pn=[];let dn,Qn=Jt.concat();for(let nn=0,ct=rt.length;nn<ct;nn++){const hn=rt[nn];dn=[];for(let In=0,rn=hn.length,Gn=rn-1,mi=In+1;In<rn;In++,Gn++,mi++)Gn===rn&&(Gn=0),mi===rn&&(mi=0),dn[In]=ln(hn[In],hn[Gn],hn[mi]);pn.push(dn),Qn=Qn.concat(dn)}for(let nn=0;nn<re;nn++){const ct=nn/re,hn=$*Math.cos(ct*Math.PI/2),In=ie*Math.sin(ct*Math.PI/2)+ue;for(let rn=0,Gn=lt.length;rn<Gn;rn++){const mi=wt(lt[rn],Jt[rn],In);_n(mi.x,mi.y,-hn)}for(let rn=0,Gn=rt.length;rn<Gn;rn++){const mi=rt[rn];dn=pn[rn];for(let ti=0,gi=mi.length;ti<gi;ti++){const ir=wt(mi[ti],dn[ti],In);_n(ir.x,ir.y,-hn)}}}const Qi=ie+ue;for(let nn=0;nn<Kt;nn++){const ct=X?wt(Xe[nn],Qn[nn],Qi):Xe[nn];Me?(et.copy(ze.normals[0]).multiplyScalar(ct.x),He.copy(ze.binormals[0]).multiplyScalar(ct.y),st.copy(fe[0]).add(et).add(He),_n(st.x,st.y,st.z)):_n(ct.x,ct.y,0)}for(let nn=1;nn<=V;nn++)for(let ct=0;ct<Kt;ct++){const hn=X?wt(Xe[ct],Qn[ct],Qi):Xe[ct];Me?(et.copy(ze.normals[nn]).multiplyScalar(hn.x),He.copy(ze.binormals[nn]).multiplyScalar(hn.y),st.copy(fe[nn]).add(et).add(He),_n(st.x,st.y,st.z)):_n(hn.x,hn.y,Q/V*nn)}for(let nn=re-1;nn>=0;nn--){const ct=nn/re,hn=$*Math.cos(ct*Math.PI/2),In=ie*Math.sin(ct*Math.PI/2)+ue;for(let rn=0,Gn=lt.length;rn<Gn;rn++){const mi=wt(lt[rn],Jt[rn],In);_n(mi.x,mi.y,Q+hn)}for(let rn=0,Gn=rt.length;rn<Gn;rn++){const mi=rt[rn];dn=pn[rn];for(let ti=0,gi=mi.length;ti<gi;ti++){const ir=wt(mi[ti],dn[ti],In);Me?_n(ir.x,ir.y+fe[V-1].y,fe[V-1].x+hn):_n(ir.x,ir.y,Q+hn)}}}ki(),Ht();function ki(){const nn=y.length/3;if(X){let ct=0,hn=Kt*ct;for(let In=0;In<qt;In++){const rn=Gt[In];wi(rn[2]+hn,rn[1]+hn,rn[0]+hn)}ct=V+re*2,hn=Kt*ct;for(let In=0;In<qt;In++){const rn=Gt[In];wi(rn[0]+hn,rn[1]+hn,rn[2]+hn)}}else{for(let ct=0;ct<qt;ct++){const hn=Gt[ct];wi(hn[2],hn[1],hn[0])}for(let ct=0;ct<qt;ct++){const hn=Gt[ct];wi(hn[0]+Kt*V,hn[1]+Kt*V,hn[2]+Kt*V)}}m.addGroup(nn,y.length/3-nn,0)}function Ht(){const nn=y.length/3;let ct=0;Sn(lt,ct),ct+=lt.length;for(let hn=0,In=rt.length;hn<In;hn++){const rn=rt[hn];Sn(rn,ct),ct+=rn.length}m.addGroup(nn,y.length/3-nn,1)}function Sn(nn,ct){let hn=nn.length;for(;--hn>=0;){const In=hn;let rn=hn-1;rn<0&&(rn=nn.length-1);for(let Gn=0,mi=V+re*2;Gn<mi;Gn++){const ti=Kt*Gn,gi=Kt*(Gn+1),ir=ct+In+ti,Lr=ct+rn+ti,fs=ct+rn+gi,br=ct+In+gi;ei(ir,Lr,fs,br)}}}function _n(nn,ct,hn){O.push(nn),O.push(ct),O.push(hn)}function wi(nn,ct,hn){ii(nn),ii(ct),ii(hn);const In=y.length/3,rn=Se.generateTopUV(m,y,In-3,In-2,In-1);yi(rn[0]),yi(rn[1]),yi(rn[2])}function ei(nn,ct,hn,In){ii(nn),ii(ct),ii(In),ii(ct),ii(hn),ii(In);const rn=y.length/3,Gn=Se.generateSideWallUV(m,y,rn-6,rn-3,rn-2,rn-1);yi(Gn[0]),yi(Gn[1]),yi(Gn[3]),yi(Gn[1]),yi(Gn[2]),yi(Gn[3])}function ii(nn){y.push(O[nn*3+0]),y.push(O[nn*3+1]),y.push(O[nn*3+2])}function yi(nn){_.push(nn.x),_.push(nn.y)}}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}toJSON(){const r=super.toJSON(),l=this.parameters.shapes,m=this.parameters.options;return EN(l,m,r)}static fromJSON(r,l){const m=[];for(let _=0,R=r.shapes.length;_<R;_++){const I=l[r.shapes[_]];m.push(I)}const y=r.options.extrudePath;return y!==void 0&&(r.options.extrudePath=new Og[y.type]().fromJSON(y)),new Qg(m,r.options)}}const xN={generateTopUV:function(w,r,l,m,y){const _=r[l*3],R=r[l*3+1],I=r[m*3],O=r[m*3+1],N=r[y*3],V=r[y*3+1];return[new en(_,R),new en(I,O),new en(N,V)]},generateSideWallUV:function(w,r,l,m,y,_){const R=r[l*3],I=r[l*3+1],O=r[l*3+2],N=r[m*3],V=r[m*3+1],Q=r[m*3+2],X=r[y*3],$=r[y*3+1],ie=r[y*3+2],ue=r[_*3],re=r[_*3+1],q=r[_*3+2];return Math.abs(I-V)<Math.abs(R-N)?[new en(R,1-O),new en(N,1-Q),new en(X,1-ie),new en(ue,1-q)]:[new en(I,1-O),new en(V,1-Q),new en($,1-ie),new en(re,1-q)]}};function EN(w,r,l){if(l.shapes=[],Array.isArray(w))for(let m=0,y=w.length;m<y;m++){const _=w[m];l.shapes.push(_.uuid)}else l.shapes.push(w.uuid);return l.options=Object.assign({},r),r.extrudePath!==void 0&&(l.options.extrudePath=r.extrudePath.toJSON()),l}class Xg extends pc{constructor(r=1,l=0){const m=(1+Math.sqrt(5))/2,y=[-1,m,0,1,m,0,-1,-m,0,1,-m,0,0,-1,m,0,1,m,0,-1,-m,0,1,-m,m,0,-1,m,0,1,-m,0,-1,-m,0,1],_=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(y,_,r,l),this.type="IcosahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new Xg(r.radius,r.detail)}}class Zf extends pc{constructor(r=1,l=0){const m=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],y=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(m,y,r,l),this.type="OctahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new Zf(r.radius,r.detail)}}class Kg extends Yi{constructor(r=.5,l=1,m=32,y=1,_=0,R=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:r,outerRadius:l,thetaSegments:m,phiSegments:y,thetaStart:_,thetaLength:R},m=Math.max(3,m),y=Math.max(1,y);const I=[],O=[],N=[],V=[];let Q=r;const X=(l-r)/y,$=new je,ie=new en;for(let ue=0;ue<=y;ue++){for(let re=0;re<=m;re++){const q=_+re/m*R;$.x=Q*Math.cos(q),$.y=Q*Math.sin(q),O.push($.x,$.y,$.z),N.push(0,0,1),ie.x=($.x/l+1)/2,ie.y=($.y/l+1)/2,V.push(ie.x,ie.y)}Q+=X}for(let ue=0;ue<y;ue++){const re=ue*(m+1);for(let q=0;q<m;q++){const Se=q+re,fe=Se,Me=Se+m+1,ze=Se+m+2,He=Se+1;I.push(fe,Me,He),I.push(Me,ze,He)}}this.setIndex(I),this.setAttribute("position",new ni(O,3)),this.setAttribute("normal",new ni(N,3)),this.setAttribute("uv",new ni(V,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Kg(r.innerRadius,r.outerRadius,r.thetaSegments,r.phiSegments,r.thetaStart,r.thetaLength)}}class qg extends Yi{constructor(r=new yh([new en(0,.5),new en(-.5,-.5),new en(.5,-.5)]),l=12){super(),this.type="ShapeGeometry",this.parameters={shapes:r,curveSegments:l};const m=[],y=[],_=[],R=[];let I=0,O=0;if(Array.isArray(r)===!1)N(r);else for(let V=0;V<r.length;V++)N(r[V]),this.addGroup(I,O,V),I+=O,O=0;this.setIndex(m),this.setAttribute("position",new ni(y,3)),this.setAttribute("normal",new ni(_,3)),this.setAttribute("uv",new ni(R,2));function N(V){const Q=y.length/3,X=V.extractPoints(l);let $=X.shape;const ie=X.holes;Ya.isClockWise($)===!1&&($=$.reverse());for(let re=0,q=ie.length;re<q;re++){const Se=ie[re];Ya.isClockWise(Se)===!0&&(ie[re]=Se.reverse())}const ue=Ya.triangulateShape($,ie);for(let re=0,q=ie.length;re<q;re++){const Se=ie[re];$=$.concat(Se)}for(let re=0,q=$.length;re<q;re++){const Se=$[re];y.push(Se.x,Se.y,0),_.push(0,0,1),R.push(Se.x,Se.y)}for(let re=0,q=ue.length;re<q;re++){const Se=ue[re],fe=Se[0]+Q,Me=Se[1]+Q,ze=Se[2]+Q;m.push(fe,Me,ze),O+=3}}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}toJSON(){const r=super.toJSON(),l=this.parameters.shapes;return bN(l,r)}static fromJSON(r,l){const m=[];for(let y=0,_=r.shapes.length;y<_;y++){const R=l[r.shapes[y]];m.push(R)}return new qg(m,r.curveSegments)}}function bN(w,r){if(r.shapes=[],Array.isArray(w))for(let l=0,m=w.length;l<m;l++){const y=w[l];r.shapes.push(y.uuid)}else r.shapes.push(w.uuid);return r}class ep extends Yi{constructor(r=1,l=32,m=16,y=0,_=Math.PI*2,R=0,I=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:r,widthSegments:l,heightSegments:m,phiStart:y,phiLength:_,thetaStart:R,thetaLength:I},l=Math.max(3,Math.floor(l)),m=Math.max(2,Math.floor(m));const O=Math.min(R+I,Math.PI);let N=0;const V=[],Q=new je,X=new je,$=[],ie=[],ue=[],re=[];for(let q=0;q<=m;q++){const Se=[],fe=q/m;let Me=0;q===0&&R===0?Me=.5/l:q===m&&O===Math.PI&&(Me=-.5/l);for(let ze=0;ze<=l;ze++){const He=ze/l;Q.x=-r*Math.cos(y+He*_)*Math.sin(R+fe*I),Q.y=r*Math.cos(R+fe*I),Q.z=r*Math.sin(y+He*_)*Math.sin(R+fe*I),ie.push(Q.x,Q.y,Q.z),X.copy(Q).normalize(),ue.push(X.x,X.y,X.z),re.push(He+Me,1-fe),Se.push(N++)}V.push(Se)}for(let q=0;q<m;q++)for(let Se=0;Se<l;Se++){const fe=V[q][Se+1],Me=V[q][Se],ze=V[q+1][Se],He=V[q+1][Se+1];(q!==0||R>0)&&$.push(fe,Me,He),(q!==m-1||O<Math.PI)&&$.push(Me,ze,He)}this.setIndex($),this.setAttribute("position",new ni(ie,3)),this.setAttribute("normal",new ni(ue,3)),this.setAttribute("uv",new ni(re,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new ep(r.radius,r.widthSegments,r.heightSegments,r.phiStart,r.phiLength,r.thetaStart,r.thetaLength)}}class Yg extends pc{constructor(r=1,l=0){const m=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],y=[2,1,0,0,3,2,1,3,0,2,3,1];super(m,y,r,l),this.type="TetrahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new Yg(r.radius,r.detail)}}class $g extends Yi{constructor(r=1,l=.4,m=12,y=48,_=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:r,tube:l,radialSegments:m,tubularSegments:y,arc:_},m=Math.floor(m),y=Math.floor(y);const R=[],I=[],O=[],N=[],V=new je,Q=new je,X=new je;for(let $=0;$<=m;$++)for(let ie=0;ie<=y;ie++){const ue=ie/y*_,re=$/m*Math.PI*2;Q.x=(r+l*Math.cos(re))*Math.cos(ue),Q.y=(r+l*Math.cos(re))*Math.sin(ue),Q.z=l*Math.sin(re),I.push(Q.x,Q.y,Q.z),V.x=r*Math.cos(ue),V.y=r*Math.sin(ue),X.subVectors(Q,V).normalize(),O.push(X.x,X.y,X.z),N.push(ie/y),N.push($/m)}for(let $=1;$<=m;$++)for(let ie=1;ie<=y;ie++){const ue=(y+1)*$+ie-1,re=(y+1)*($-1)+ie-1,q=(y+1)*($-1)+ie,Se=(y+1)*$+ie;R.push(ue,re,Se),R.push(re,q,Se)}this.setIndex(R),this.setAttribute("position",new ni(I,3)),this.setAttribute("normal",new ni(O,3)),this.setAttribute("uv",new ni(N,2))}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new $g(r.radius,r.tube,r.radialSegments,r.tubularSegments,r.arc)}}class Jg extends Yi{constructor(r=1,l=.4,m=64,y=8,_=2,R=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:r,tube:l,tubularSegments:m,radialSegments:y,p:_,q:R},m=Math.floor(m),y=Math.floor(y);const I=[],O=[],N=[],V=[],Q=new je,X=new je,$=new je,ie=new je,ue=new je,re=new je,q=new je;for(let fe=0;fe<=m;++fe){const Me=fe/m*_*Math.PI*2;Se(Me,_,R,r,$),Se(Me+.01,_,R,r,ie),re.subVectors(ie,$),q.addVectors(ie,$),ue.crossVectors(re,q),q.crossVectors(ue,re),ue.normalize(),q.normalize();for(let ze=0;ze<=y;++ze){const He=ze/y*Math.PI*2,et=-l*Math.cos(He),st=l*Math.sin(He);Q.x=$.x+(et*q.x+st*ue.x),Q.y=$.y+(et*q.y+st*ue.y),Q.z=$.z+(et*q.z+st*ue.z),O.push(Q.x,Q.y,Q.z),X.subVectors(Q,$).normalize(),N.push(X.x,X.y,X.z),V.push(fe/m),V.push(ze/y)}}for(let fe=1;fe<=m;fe++)for(let Me=1;Me<=y;Me++){const ze=(y+1)*(fe-1)+(Me-1),He=(y+1)*fe+(Me-1),et=(y+1)*fe+Me,st=(y+1)*(fe-1)+Me;I.push(ze,He,st),I.push(He,et,st)}this.setIndex(I),this.setAttribute("position",new ni(O,3)),this.setAttribute("normal",new ni(N,3)),this.setAttribute("uv",new ni(V,2));function Se(fe,Me,ze,He,et){const st=Math.cos(fe),Be=Math.sin(fe),Xe=ze/Me*fe,rt=Math.cos(Xe);et.x=He*(2+rt)*.5*st,et.y=He*(2+rt)*Be*.5,et.z=He*Math.sin(Xe)*.5}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}static fromJSON(r){return new Jg(r.radius,r.tube,r.tubularSegments,r.radialSegments,r.p,r.q)}}class Zg extends Yi{constructor(r=new Ix(new je(-1,-1,0),new je(-1,1,0),new je(1,1,0)),l=64,m=1,y=8,_=!1){super(),this.type="TubeGeometry",this.parameters={path:r,tubularSegments:l,radius:m,radialSegments:y,closed:_};const R=r.computeFrenetFrames(l,_);this.tangents=R.tangents,this.normals=R.normals,this.binormals=R.binormals;const I=new je,O=new je,N=new en;let V=new je;const Q=[],X=[],$=[],ie=[];ue(),this.setIndex(ie),this.setAttribute("position",new ni(Q,3)),this.setAttribute("normal",new ni(X,3)),this.setAttribute("uv",new ni($,2));function ue(){for(let fe=0;fe<l;fe++)re(fe);re(_===!1?l:0),Se(),q()}function re(fe){V=r.getPointAt(fe/l,V);const Me=R.normals[fe],ze=R.binormals[fe];for(let He=0;He<=y;He++){const et=He/y*Math.PI*2,st=Math.sin(et),Be=-Math.cos(et);O.x=Be*Me.x+st*ze.x,O.y=Be*Me.y+st*ze.y,O.z=Be*Me.z+st*ze.z,O.normalize(),X.push(O.x,O.y,O.z),I.x=V.x+m*O.x,I.y=V.y+m*O.y,I.z=V.z+m*O.z,Q.push(I.x,I.y,I.z)}}function q(){for(let fe=1;fe<=l;fe++)for(let Me=1;Me<=y;Me++){const ze=(y+1)*(fe-1)+(Me-1),He=(y+1)*fe+(Me-1),et=(y+1)*fe+Me,st=(y+1)*(fe-1)+Me;ie.push(ze,He,st),ie.push(He,et,st)}}function Se(){for(let fe=0;fe<=l;fe++)for(let Me=0;Me<=y;Me++)N.x=fe/l,N.y=Me/y,$.push(N.x,N.y)}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}toJSON(){const r=super.toJSON();return r.path=this.parameters.path.toJSON(),r}static fromJSON(r){return new Zg(new Og[r.path.type]().fromJSON(r.path),r.tubularSegments,r.radius,r.radialSegments,r.closed)}}class i2 extends Yi{constructor(r=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:r},r!==null){const l=[],m=new Set,y=new je,_=new je;if(r.index!==null){const R=r.attributes.position,I=r.index;let O=r.groups;O.length===0&&(O=[{start:0,count:I.count,materialIndex:0}]);for(let N=0,V=O.length;N<V;++N){const Q=O[N],X=Q.start,$=Q.count;for(let ie=X,ue=X+$;ie<ue;ie+=3)for(let re=0;re<3;re++){const q=I.getX(ie+re),Se=I.getX(ie+(re+1)%3);y.fromBufferAttribute(R,q),_.fromBufferAttribute(R,Se),r2(y,_,m)===!0&&(l.push(y.x,y.y,y.z),l.push(_.x,_.y,_.z))}}}else{const R=r.attributes.position;for(let I=0,O=R.count/3;I<O;I++)for(let N=0;N<3;N++){const V=3*I+N,Q=3*I+(N+1)%3;y.fromBufferAttribute(R,V),_.fromBufferAttribute(R,Q),r2(y,_,m)===!0&&(l.push(y.x,y.y,y.z),l.push(_.x,_.y,_.z))}}this.setAttribute("position",new ni(l,3))}}copy(r){return super.copy(r),this.parameters=Object.assign({},r.parameters),this}}function r2(w,r,l){const m=`${w.x},${w.y},${w.z}-${r.x},${r.y},${r.z}`,y=`${r.x},${r.y},${r.z}-${w.x},${w.y},${w.z}`;return l.has(m)===!0||l.has(y)===!0?!1:(l.add(m),l.add(y),!0)}var s2=Object.freeze({__proto__:null,BoxGeometry:fh,CapsuleGeometry:Fg,CircleGeometry:Ng,ConeGeometry:Ug,CylinderGeometry:Hu,DodecahedronGeometry:kg,EdgesGeometry:YM,ExtrudeGeometry:Qg,IcosahedronGeometry:Xg,LatheGeometry:qf,OctahedronGeometry:Zf,PlaneGeometry:kf,PolyhedronGeometry:pc,RingGeometry:Kg,ShapeGeometry:qg,SphereGeometry:ep,TetrahedronGeometry:Yg,TorusGeometry:$g,TorusKnotGeometry:Jg,TubeGeometry:Zg,WireframeGeometry:i2});class o2 extends js{constructor(r){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Hn(0),this.transparent=!0,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.fog=r.fog,this}}class a2 extends Ka{constructor(r){super(r),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ox extends js{constructor(r){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Hn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.defines={STANDARD:""},this.color.copy(r.color),this.roughness=r.roughness,this.metalness=r.metalness,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.roughnessMap=r.roughnessMap,this.metalnessMap=r.metalnessMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapIntensity=r.envMapIntensity,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}}class l2 extends Ox{constructor(r){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new en(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Nr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(l){this.ior=(1+.4*l)/(1-.4*l)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Hn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Hn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Hn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(r)}get anisotropy(){return this._anisotropy}set anisotropy(r){this._anisotropy>0!=r>0&&this.version++,this._anisotropy=r}get clearcoat(){return this._clearcoat}set clearcoat(r){this._clearcoat>0!=r>0&&this.version++,this._clearcoat=r}get iridescence(){return this._iridescence}set iridescence(r){this._iridescence>0!=r>0&&this.version++,this._iridescence=r}get sheen(){return this._sheen}set sheen(r){this._sheen>0!=r>0&&this.version++,this._sheen=r}get transmission(){return this._transmission}set transmission(r){this._transmission>0!=r>0&&this.version++,this._transmission=r}copy(r){return super.copy(r),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=r.anisotropy,this.anisotropyRotation=r.anisotropyRotation,this.anisotropyMap=r.anisotropyMap,this.clearcoat=r.clearcoat,this.clearcoatMap=r.clearcoatMap,this.clearcoatRoughness=r.clearcoatRoughness,this.clearcoatRoughnessMap=r.clearcoatRoughnessMap,this.clearcoatNormalMap=r.clearcoatNormalMap,this.clearcoatNormalScale.copy(r.clearcoatNormalScale),this.ior=r.ior,this.iridescence=r.iridescence,this.iridescenceMap=r.iridescenceMap,this.iridescenceIOR=r.iridescenceIOR,this.iridescenceThicknessRange=[...r.iridescenceThicknessRange],this.iridescenceThicknessMap=r.iridescenceThicknessMap,this.sheen=r.sheen,this.sheenColor.copy(r.sheenColor),this.sheenColorMap=r.sheenColorMap,this.sheenRoughness=r.sheenRoughness,this.sheenRoughnessMap=r.sheenRoughnessMap,this.transmission=r.transmission,this.transmissionMap=r.transmissionMap,this.thickness=r.thickness,this.thicknessMap=r.thicknessMap,this.attenuationDistance=r.attenuationDistance,this.attenuationColor.copy(r.attenuationColor),this.specularIntensity=r.specularIntensity,this.specularIntensityMap=r.specularIntensityMap,this.specularColor.copy(r.specularColor),this.specularColorMap=r.specularColorMap,this}}class c2 extends js{constructor(r){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Hn(16777215),this.specular=new Hn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}}class h2 extends js{constructor(r){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Hn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.gradientMap=r.gradientMap,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.fog=r.fog,this}}class u2 extends js{constructor(r){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(r)}copy(r){return super.copy(r),this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.flatShading=r.flatShading,this}}class d2 extends js{constructor(r){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Hn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this.fog=r.fog,this}}class f2 extends js{constructor(r){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Hn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ks,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.defines={MATCAP:""},this.color.copy(r.color),this.matcap=r.matcap,this.map=r.map,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.flatShading=r.flatShading,this.fog=r.fog,this}}class p2 extends oo{constructor(r){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(r)}copy(r){return super.copy(r),this.scale=r.scale,this.dashSize=r.dashSize,this.gapSize=r.gapSize,this}}function Eh(w,r,l){return!w||!l&&w.constructor===r?w:typeof r.BYTES_PER_ELEMENT=="number"?new r(w):Array.prototype.slice.call(w)}function m2(w){return ArrayBuffer.isView(w)&&!(w instanceof DataView)}function g2(w){function r(y,_){return w[y]-w[_]}const l=w.length,m=new Array(l);for(let y=0;y!==l;++y)m[y]=y;return m.sort(r),m}function Fx(w,r,l){const m=w.length,y=new w.constructor(m);for(let _=0,R=0;R!==m;++_){const I=l[_]*r;for(let O=0;O!==r;++O)y[R++]=w[I+O]}return y}function Nx(w,r,l,m){let y=1,_=w[0];for(;_!==void 0&&_[m]===void 0;)_=w[y++];if(_===void 0)return;let R=_[m];if(R!==void 0)if(Array.isArray(R))do R=_[m],R!==void 0&&(r.push(_.time),l.push.apply(l,R)),_=w[y++];while(_!==void 0);else if(R.toArray!==void 0)do R=_[m],R!==void 0&&(r.push(_.time),R.toArray(l,l.length)),_=w[y++];while(_!==void 0);else do R=_[m],R!==void 0&&(r.push(_.time),l.push(R)),_=w[y++];while(_!==void 0)}function _N(w,r,l,m,y=30){const _=w.clone();_.name=r;const R=[];for(let O=0;O<_.tracks.length;++O){const N=_.tracks[O],V=N.getValueSize(),Q=[],X=[];for(let $=0;$<N.times.length;++$){const ie=N.times[$]*y;if(!(ie<l||ie>=m)){Q.push(N.times[$]);for(let ue=0;ue<V;++ue)X.push(N.values[$*V+ue])}}Q.length!==0&&(N.times=Eh(Q,N.times.constructor),N.values=Eh(X,N.values.constructor),R.push(N))}_.tracks=R;let I=1/0;for(let O=0;O<_.tracks.length;++O)I>_.tracks[O].times[0]&&(I=_.tracks[O].times[0]);for(let O=0;O<_.tracks.length;++O)_.tracks[O].shift(-1*I);return _.resetDuration(),_}function wN(w,r=0,l=w,m=30){m<=0&&(m=30);const y=l.tracks.length,_=r/m;for(let R=0;R<y;++R){const I=l.tracks[R],O=I.ValueTypeName;if(O==="bool"||O==="string")continue;const N=w.tracks.find(function(q){return q.name===I.name&&q.ValueTypeName===O});if(N===void 0)continue;let V=0;const Q=I.getValueSize();I.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(V=Q/3);let X=0;const $=N.getValueSize();N.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(X=$/3);const ie=I.times.length-1;let ue;if(_<=I.times[0]){const q=V,Se=Q-V;ue=I.values.slice(q,Se)}else if(_>=I.times[ie]){const q=ie*Q+V,Se=q+Q-V;ue=I.values.slice(q,Se)}else{const q=I.createInterpolant(),Se=V,fe=Q-V;q.evaluate(_),ue=q.resultBuffer.slice(Se,fe)}O==="quaternion"&&new Ti().fromArray(ue).normalize().conjugate().toArray(ue);const re=N.times.length;for(let q=0;q<re;++q){const Se=q*$+X;if(O==="quaternion")Ti.multiplyQuaternionsFlat(N.values,Se,ue,0,N.values,Se);else{const fe=$-X*2;for(let Me=0;Me<fe;++Me)N.values[Se+Me]-=ue[Me]}}}return w.blendMode=hr,w}const MN={convertArray:Eh,isTypedArray:m2,getKeyframeOrder:g2,sortedArray:Fx,flattenJSON:Nx,subclip:_N,makeClipAdditive:wN};class tp{constructor(r,l,m,y){this.parameterPositions=r,this._cachedIndex=0,this.resultBuffer=y!==void 0?y:new l.constructor(m),this.sampleValues=l,this.valueSize=m,this.settings=null,this.DefaultSettings_={}}evaluate(r){const l=this.parameterPositions;let m=this._cachedIndex,y=l[m],_=l[m-1];n:{e:{let R;t:{i:if(!(r<y)){for(let I=m+2;;){if(y===void 0){if(r<_)break i;return m=l.length,this._cachedIndex=m,this.copySampleValue_(m-1)}if(m===I)break;if(_=y,y=l[++m],r<y)break e}R=l.length;break t}if(!(r>=_)){const I=l[1];r<I&&(m=2,_=I);for(let O=m-2;;){if(_===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(m===O)break;if(y=_,_=l[--m-1],r>=_)break e}R=m,m=0;break t}break n}for(;m<R;){const I=m+R>>>1;r<l[I]?R=I:m=I+1}if(y=l[m],_=l[m-1],_===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(y===void 0)return m=l.length,this._cachedIndex=m,this.copySampleValue_(m-1)}this._cachedIndex=m,this.intervalChanged_(m,_,y)}return this.interpolate_(m,_,r,y)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(r){const l=this.resultBuffer,m=this.sampleValues,y=this.valueSize,_=r*y;for(let R=0;R!==y;++R)l[R]=m[_+R];return l}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class A2 extends tp{constructor(r,l,m,y){super(r,l,m,y),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ai,endingEnd:ai}}intervalChanged_(r,l,m){const y=this.parameterPositions;let _=r-2,R=r+1,I=y[_],O=y[R];if(I===void 0)switch(this.getSettings_().endingStart){case li:_=r,I=2*l-m;break;case xi:_=y.length-2,I=l+y[_]-y[_+1];break;default:_=r,I=m}if(O===void 0)switch(this.getSettings_().endingEnd){case li:R=r,O=2*m-l;break;case xi:R=1,O=m+y[1]-y[0];break;default:R=r-1,O=l}const N=(m-l)*.5,V=this.valueSize;this._weightPrev=N/(l-I),this._weightNext=N/(O-m),this._offsetPrev=_*V,this._offsetNext=R*V}interpolate_(r,l,m,y){const _=this.resultBuffer,R=this.sampleValues,I=this.valueSize,O=r*I,N=O-I,V=this._offsetPrev,Q=this._offsetNext,X=this._weightPrev,$=this._weightNext,ie=(m-l)/(y-l),ue=ie*ie,re=ue*ie,q=-X*re+2*X*ue-X*ie,Se=(1+X)*re+(-1.5-2*X)*ue+(-.5+X)*ie+1,fe=(-1-$)*re+(1.5+$)*ue+.5*ie,Me=$*re-$*ue;for(let ze=0;ze!==I;++ze)_[ze]=q*R[V+ze]+Se*R[N+ze]+fe*R[O+ze]+Me*R[Q+ze];return _}}class Ux extends tp{constructor(r,l,m,y){super(r,l,m,y)}interpolate_(r,l,m,y){const _=this.resultBuffer,R=this.sampleValues,I=this.valueSize,O=r*I,N=O-I,V=(m-l)/(y-l),Q=1-V;for(let X=0;X!==I;++X)_[X]=R[N+X]*Q+R[O+X]*V;return _}}class v2 extends tp{constructor(r,l,m,y){super(r,l,m,y)}interpolate_(r){return this.copySampleValue_(r-1)}}class ma{constructor(r,l,m,y){if(r===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(l===void 0||l.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+r);this.name=r,this.times=Eh(l,this.TimeBufferType),this.values=Eh(m,this.ValueBufferType),this.setInterpolation(y||this.DefaultInterpolation)}static toJSON(r){const l=r.constructor;let m;if(l.toJSON!==this.toJSON)m=l.toJSON(r);else{m={name:r.name,times:Eh(r.times,Array),values:Eh(r.values,Array)};const y=r.getInterpolation();y!==r.DefaultInterpolation&&(m.interpolation=y)}return m.type=r.ValueTypeName,m}InterpolantFactoryMethodDiscrete(r){return new v2(this.times,this.values,this.getValueSize(),r)}InterpolantFactoryMethodLinear(r){return new Ux(this.times,this.values,this.getValueSize(),r)}InterpolantFactoryMethodSmooth(r){return new A2(this.times,this.values,this.getValueSize(),r)}setInterpolation(r){let l;switch(r){case Vn:l=this.InterpolantFactoryMethodDiscrete;break;case Wn:l=this.InterpolantFactoryMethodLinear;break;case Nn:l=this.InterpolantFactoryMethodSmooth;break}if(l===void 0){const m="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(r!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(m);return console.warn("THREE.KeyframeTrack:",m),this}return this.createInterpolant=l,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Vn;case this.InterpolantFactoryMethodLinear:return Wn;case this.InterpolantFactoryMethodSmooth:return Nn}}getValueSize(){return this.values.length/this.times.length}shift(r){if(r!==0){const l=this.times;for(let m=0,y=l.length;m!==y;++m)l[m]+=r}return this}scale(r){if(r!==1){const l=this.times;for(let m=0,y=l.length;m!==y;++m)l[m]*=r}return this}trim(r,l){const m=this.times,y=m.length;let _=0,R=y-1;for(;_!==y&&m[_]<r;)++_;for(;R!==-1&&m[R]>l;)--R;if(++R,_!==0||R!==y){_>=R&&(R=Math.max(R,1),_=R-1);const I=this.getValueSize();this.times=m.slice(_,R),this.values=this.values.slice(_*I,R*I)}return this}validate(){let r=!0;const l=this.getValueSize();l-Math.floor(l)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),r=!1);const m=this.times,y=this.values,_=m.length;_===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),r=!1);let R=null;for(let I=0;I!==_;I++){const O=m[I];if(typeof O=="number"&&isNaN(O)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,I,O),r=!1;break}if(R!==null&&R>O){console.error("THREE.KeyframeTrack: Out of order keys.",this,I,O,R),r=!1;break}R=O}if(y!==void 0&&m2(y))for(let I=0,O=y.length;I!==O;++I){const N=y[I];if(isNaN(N)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,I,N),r=!1;break}}return r}optimize(){const r=this.times.slice(),l=this.values.slice(),m=this.getValueSize(),y=this.getInterpolation()===Nn,_=r.length-1;let R=1;for(let I=1;I<_;++I){let O=!1;const N=r[I],V=r[I+1];if(N!==V&&(I!==1||N!==r[0]))if(y)O=!0;else{const Q=I*m,X=Q-m,$=Q+m;for(let ie=0;ie!==m;++ie){const ue=l[Q+ie];if(ue!==l[X+ie]||ue!==l[$+ie]){O=!0;break}}}if(O){if(I!==R){r[R]=r[I];const Q=I*m,X=R*m;for(let $=0;$!==m;++$)l[X+$]=l[Q+$]}++R}}if(_>0){r[R]=r[_];for(let I=_*m,O=R*m,N=0;N!==m;++N)l[O+N]=l[I+N];++R}return R!==r.length?(this.times=r.slice(0,R),this.values=l.slice(0,R*m)):(this.times=r,this.values=l),this}clone(){const r=this.times.slice(),l=this.values.slice(),m=this.constructor,y=new m(this.name,r,l);return y.createInterpolant=this.createInterpolant,y}}ma.prototype.TimeBufferType=Float32Array,ma.prototype.ValueBufferType=Float32Array,ma.prototype.DefaultInterpolation=Wn;class bh extends ma{}bh.prototype.ValueTypeName="bool",bh.prototype.ValueBufferType=Array,bh.prototype.DefaultInterpolation=Vn,bh.prototype.InterpolantFactoryMethodLinear=void 0,bh.prototype.InterpolantFactoryMethodSmooth=void 0;class kx extends ma{}kx.prototype.ValueTypeName="color";class np extends ma{}np.prototype.ValueTypeName="number";class y2 extends tp{constructor(r,l,m,y){super(r,l,m,y)}interpolate_(r,l,m,y){const _=this.resultBuffer,R=this.sampleValues,I=this.valueSize,O=(m-l)/(y-l);let N=r*I;for(let V=N+I;N!==V;N+=4)Ti.slerpFlat(_,0,R,N-I,R,N,O);return _}}class Wu extends ma{InterpolantFactoryMethodLinear(r){return new y2(this.times,this.values,this.getValueSize(),r)}}Wu.prototype.ValueTypeName="quaternion",Wu.prototype.DefaultInterpolation=Wn,Wu.prototype.InterpolantFactoryMethodSmooth=void 0;class _h extends ma{}_h.prototype.ValueTypeName="string",_h.prototype.ValueBufferType=Array,_h.prototype.DefaultInterpolation=Vn,_h.prototype.InterpolantFactoryMethodLinear=void 0,_h.prototype.InterpolantFactoryMethodSmooth=void 0;class ip extends ma{}ip.prototype.ValueTypeName="vector";class rp{constructor(r,l=-1,m,y=Bi){this.name=r,this.tracks=m,this.duration=l,this.blendMode=y,this.uuid=no(),this.duration<0&&this.resetDuration()}static parse(r){const l=[],m=r.tracks,y=1/(r.fps||1);for(let R=0,I=m.length;R!==I;++R)l.push(SN(m[R]).scale(y));const _=new this(r.name,r.duration,l,r.blendMode);return _.uuid=r.uuid,_}static toJSON(r){const l=[],m=r.tracks,y={name:r.name,duration:r.duration,tracks:l,uuid:r.uuid,blendMode:r.blendMode};for(let _=0,R=m.length;_!==R;++_)l.push(ma.toJSON(m[_]));return y}static CreateFromMorphTargetSequence(r,l,m,y){const _=l.length,R=[];for(let I=0;I<_;I++){let O=[],N=[];O.push((I+_-1)%_,I,(I+1)%_),N.push(0,1,0);const V=g2(O);O=Fx(O,1,V),N=Fx(N,1,V),!y&&O[0]===0&&(O.push(_),N.push(N[0])),R.push(new np(".morphTargetInfluences["+l[I].name+"]",O,N).scale(1/m))}return new this(r,-1,R)}static findByName(r,l){let m=r;if(!Array.isArray(r)){const y=r;m=y.geometry&&y.geometry.animations||y.animations}for(let y=0;y<m.length;y++)if(m[y].name===l)return m[y];return null}static CreateClipsFromMorphTargetSequences(r,l,m){const y={},_=/^([\w-]*?)([\d]+)$/;for(let I=0,O=r.length;I<O;I++){const N=r[I],V=N.name.match(_);if(V&&V.length>1){const Q=V[1];let X=y[Q];X||(y[Q]=X=[]),X.push(N)}}const R=[];for(const I in y)R.push(this.CreateFromMorphTargetSequence(I,y[I],l,m));return R}static parseAnimation(r,l){if(!r)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const m=function(Q,X,$,ie,ue){if($.length!==0){const re=[],q=[];Nx($,re,q,ie),re.length!==0&&ue.push(new Q(X,re,q))}},y=[],_=r.name||"default",R=r.fps||30,I=r.blendMode;let O=r.length||-1;const N=r.hierarchy||[];for(let Q=0;Q<N.length;Q++){const X=N[Q].keys;if(!(!X||X.length===0))if(X[0].morphTargets){const $={};let ie;for(ie=0;ie<X.length;ie++)if(X[ie].morphTargets)for(let ue=0;ue<X[ie].morphTargets.length;ue++)$[X[ie].morphTargets[ue]]=-1;for(const ue in $){const re=[],q=[];for(let Se=0;Se!==X[ie].morphTargets.length;++Se){const fe=X[ie];re.push(fe.time),q.push(fe.morphTarget===ue?1:0)}y.push(new np(".morphTargetInfluence["+ue+"]",re,q))}O=$.length*R}else{const $=".bones["+l[Q].name+"]";m(ip,$+".position",X,"pos",y),m(Wu,$+".quaternion",X,"rot",y),m(ip,$+".scale",X,"scl",y)}}return y.length===0?null:new this(_,O,y,I)}resetDuration(){const r=this.tracks;let l=0;for(let m=0,y=r.length;m!==y;++m){const _=this.tracks[m];l=Math.max(l,_.times[_.times.length-1])}return this.duration=l,this}trim(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].trim(0,this.duration);return this}validate(){let r=!0;for(let l=0;l<this.tracks.length;l++)r=r&&this.tracks[l].validate();return r}optimize(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].optimize();return this}clone(){const r=[];for(let l=0;l<this.tracks.length;l++)r.push(this.tracks[l].clone());return new this.constructor(this.name,this.duration,r,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function CN(w){switch(w.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return np;case"vector":case"vector2":case"vector3":case"vector4":return ip;case"color":return kx;case"quaternion":return Wu;case"bool":case"boolean":return bh;case"string":return _h}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+w)}function SN(w){if(w.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const r=CN(w.type);if(w.times===void 0){const l=[],m=[];Nx(w.keys,l,m,"value"),w.times=l,w.values=m}return r.parse!==void 0?r.parse(w):new r(w.name,w.times,w.values,w.interpolation)}const wh={enabled:!1,files:{},add:function(w,r){this.enabled!==!1&&(this.files[w]=r)},get:function(w){if(this.enabled!==!1)return this.files[w]},remove:function(w){delete this.files[w]},clear:function(){this.files={}}};class zx{constructor(r,l,m){const y=this;let _=!1,R=0,I=0,O;const N=[];this.onStart=void 0,this.onLoad=r,this.onProgress=l,this.onError=m,this.itemStart=function(V){I++,_===!1&&y.onStart!==void 0&&y.onStart(V,R,I),_=!0},this.itemEnd=function(V){R++,y.onProgress!==void 0&&y.onProgress(V,R,I),R===I&&(_=!1,y.onLoad!==void 0&&y.onLoad())},this.itemError=function(V){y.onError!==void 0&&y.onError(V)},this.resolveURL=function(V){return O?O(V):V},this.setURLModifier=function(V){return O=V,this},this.addHandler=function(V,Q){return N.push(V,Q),this},this.removeHandler=function(V){const Q=N.indexOf(V);return Q!==-1&&N.splice(Q,2),this},this.getHandler=function(V){for(let Q=0,X=N.length;Q<X;Q+=2){const $=N[Q],ie=N[Q+1];if($.global&&($.lastIndex=0),$.test(V))return ie}return null}}}const x2=new zx;class wo{constructor(r){this.manager=r!==void 0?r:x2,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(r,l){const m=this;return new Promise(function(y,_){m.load(r,y,l,_)})}parse(){}setCrossOrigin(r){return this.crossOrigin=r,this}setWithCredentials(r){return this.withCredentials=r,this}setPath(r){return this.path=r,this}setResourcePath(r){return this.resourcePath=r,this}setRequestHeader(r){return this.requestHeader=r,this}}wo.DEFAULT_MATERIAL_NAME="__DEFAULT";const ml={};class TN extends Error{constructor(r,l){super(r),this.response=l}}class gl extends wo{constructor(r){super(r)}load(r,l,m,y){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const _=wh.get(r);if(_!==void 0)return this.manager.itemStart(r),setTimeout(()=>{l&&l(_),this.manager.itemEnd(r)},0),_;if(ml[r]!==void 0){ml[r].push({onLoad:l,onProgress:m,onError:y});return}ml[r]=[],ml[r].push({onLoad:l,onProgress:m,onError:y});const R=new Request(r,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),I=this.mimeType,O=this.responseType;fetch(R).then(N=>{if(N.status===200||N.status===0){if(N.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||N.body===void 0||N.body.getReader===void 0)return N;const V=ml[r],Q=N.body.getReader(),X=N.headers.get("Content-Length")||N.headers.get("X-File-Size"),$=X?parseInt(X):0,ie=$!==0;let ue=0;const re=new ReadableStream({start(q){Se();function Se(){Q.read().then(({done:fe,value:Me})=>{if(fe)q.close();else{ue+=Me.byteLength;const ze=new ProgressEvent("progress",{lengthComputable:ie,loaded:ue,total:$});for(let He=0,et=V.length;He<et;He++){const st=V[He];st.onProgress&&st.onProgress(ze)}q.enqueue(Me),Se()}})}}});return new Response(re)}else throw new TN(`fetch for "${N.url}" responded with ${N.status}: ${N.statusText}`,N)}).then(N=>{switch(O){case"arraybuffer":return N.arrayBuffer();case"blob":return N.blob();case"document":return N.text().then(V=>new DOMParser().parseFromString(V,I));case"json":return N.json();default:if(I===void 0)return N.text();{const Q=/charset="?([^;"\s]*)"?/i.exec(I),X=Q&&Q[1]?Q[1].toLowerCase():void 0,$=new TextDecoder(X);return N.arrayBuffer().then(ie=>$.decode(ie))}}}).then(N=>{wh.add(r,N);const V=ml[r];delete ml[r];for(let Q=0,X=V.length;Q<X;Q++){const $=V[Q];$.onLoad&&$.onLoad(N)}}).catch(N=>{const V=ml[r];if(V===void 0)throw this.manager.itemError(r),N;delete ml[r];for(let Q=0,X=V.length;Q<X;Q++){const $=V[Q];$.onError&&$.onError(N)}this.manager.itemError(r)}).finally(()=>{this.manager.itemEnd(r)}),this.manager.itemStart(r)}setResponseType(r){return this.responseType=r,this}setMimeType(r){return this.mimeType=r,this}}class RN extends wo{constructor(r){super(r)}load(r,l,m,y){const _=this,R=new gl(this.manager);R.setPath(this.path),R.setRequestHeader(this.requestHeader),R.setWithCredentials(this.withCredentials),R.load(r,function(I){try{l(_.parse(JSON.parse(I)))}catch(O){y?y(O):console.error(O),_.manager.itemError(r)}},m,y)}parse(r){const l=[];for(let m=0;m<r.length;m++){const y=rp.parse(r[m]);l.push(y)}return l}}class IN extends wo{constructor(r){super(r)}load(r,l,m,y){const _=this,R=[],I=new Lg,O=new gl(this.manager);O.setPath(this.path),O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setWithCredentials(_.withCredentials);let N=0;function V(Q){O.load(r[Q],function(X){const $=_.parse(X,!0);R[Q]={width:$.width,height:$.height,format:$.format,mipmaps:$.mipmaps},N+=1,N===6&&($.mipmapCount===1&&(I.minFilter=Bn),I.image=R,I.format=$.format,I.needsUpdate=!0,l&&l(I))},m,y)}if(Array.isArray(r))for(let Q=0,X=r.length;Q<X;++Q)V(Q);else O.load(r,function(Q){const X=_.parse(Q,!0);if(X.isCubemap){const $=X.mipmaps.length/X.mipmapCount;for(let ie=0;ie<$;ie++){R[ie]={mipmaps:[]};for(let ue=0;ue<X.mipmapCount;ue++)R[ie].mipmaps.push(X.mipmaps[ie*X.mipmapCount+ue]),R[ie].format=X.format,R[ie].width=X.width,R[ie].height=X.height}I.image=R}else I.image.width=X.width,I.image.height=X.height,I.mipmaps=X.mipmaps;X.mipmapCount===1&&(I.minFilter=Bn),I.format=X.format,I.needsUpdate=!0,l&&l(I)},m,y);return I}}class sp extends wo{constructor(r){super(r)}load(r,l,m,y){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const _=this,R=wh.get(r);if(R!==void 0)return _.manager.itemStart(r),setTimeout(function(){l&&l(R),_.manager.itemEnd(r)},0),R;const I=hh("img");function O(){V(),wh.add(r,this),l&&l(this),_.manager.itemEnd(r)}function N(Q){V(),y&&y(Q),_.manager.itemError(r),_.manager.itemEnd(r)}function V(){I.removeEventListener("load",O,!1),I.removeEventListener("error",N,!1)}return I.addEventListener("load",O,!1),I.addEventListener("error",N,!1),r.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(I.crossOrigin=this.crossOrigin),_.manager.itemStart(r),I.src=r,I}}class BN extends wo{constructor(r){super(r)}load(r,l,m,y){const _=new Uf;_.colorSpace=Cr;const R=new sp(this.manager);R.setCrossOrigin(this.crossOrigin),R.setPath(this.path);let I=0;function O(N){R.load(r[N],function(V){_.images[N]=V,I++,I===6&&(_.needsUpdate=!0,l&&l(_))},void 0,y)}for(let N=0;N<r.length;++N)O(N);return _}}class LN extends wo{constructor(r){super(r)}load(r,l,m,y){const _=this,R=new zu,I=new gl(this.manager);return I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setPath(this.path),I.setWithCredentials(_.withCredentials),I.load(r,function(O){let N;try{N=_.parse(O)}catch(V){if(y!==void 0)y(V);else{console.error(V);return}}N.image!==void 0?R.image=N.image:N.data!==void 0&&(R.image.width=N.width,R.image.height=N.height,R.image.data=N.data),R.wrapS=N.wrapS!==void 0?N.wrapS:We,R.wrapT=N.wrapT!==void 0?N.wrapT:We,R.magFilter=N.magFilter!==void 0?N.magFilter:Bn,R.minFilter=N.minFilter!==void 0?N.minFilter:Bn,R.anisotropy=N.anisotropy!==void 0?N.anisotropy:1,N.colorSpace!==void 0?R.colorSpace=N.colorSpace:N.encoding!==void 0&&(R.encoding=N.encoding),N.flipY!==void 0&&(R.flipY=N.flipY),N.format!==void 0&&(R.format=N.format),N.type!==void 0&&(R.type=N.type),N.mipmaps!==void 0&&(R.mipmaps=N.mipmaps,R.minFilter=Fn),N.mipmapCount===1&&(R.minFilter=Bn),N.generateMipmaps!==void 0&&(R.generateMipmaps=N.generateMipmaps),R.needsUpdate=!0,l&&l(R,N)},m,y),R}}class PN extends wo{constructor(r){super(r)}load(r,l,m,y){const _=new Ir,R=new sp(this.manager);return R.setCrossOrigin(this.crossOrigin),R.setPath(this.path),R.load(r,function(I){_.image=I,_.needsUpdate=!0,l!==void 0&&l(_)},m,y),_}}class mc extends mr{constructor(r,l=1){super(),this.isLight=!0,this.type="Light",this.color=new Hn(r),this.intensity=l}dispose(){}copy(r,l){return super.copy(r,l),this.color.copy(r.color),this.intensity=r.intensity,this}toJSON(r){const l=super.toJSON(r);return l.object.color=this.color.getHex(),l.object.intensity=this.intensity,this.groundColor!==void 0&&(l.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(l.object.distance=this.distance),this.angle!==void 0&&(l.object.angle=this.angle),this.decay!==void 0&&(l.object.decay=this.decay),this.penumbra!==void 0&&(l.object.penumbra=this.penumbra),this.shadow!==void 0&&(l.object.shadow=this.shadow.toJSON()),l}}class E2 extends mc{constructor(r,l,m){super(r,m),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(mr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Hn(l)}copy(r,l){return super.copy(r,l),this.groundColor.copy(r.groundColor),this}}const Gx=new _i,b2=new je,_2=new je;class Vx{constructor(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new en(512,512),this.map=null,this.mapPass=null,this.matrix=new _i,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fg,this._frameExtents=new en(1,1),this._viewportCount=1,this._viewports=[new ur(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(r){const l=this.camera,m=this.matrix;b2.setFromMatrixPosition(r.matrixWorld),l.position.copy(b2),_2.setFromMatrixPosition(r.target.matrixWorld),l.lookAt(_2),l.updateMatrixWorld(),Gx.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Gx),m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(Gx)}getViewport(r){return this._viewports[r]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}}class DN extends Vx{constructor(){super(new hs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(r){const l=this.camera,m=sc*2*r.angle*this.focus,y=this.mapSize.width/this.mapSize.height,_=r.distance||l.far;(m!==l.fov||y!==l.aspect||_!==l.far)&&(l.fov=m,l.aspect=y,l.far=_,l.updateProjectionMatrix()),super.updateMatrices(r)}copy(r){return super.copy(r),this.focus=r.focus,this}}class w2 extends mc{constructor(r,l,m=0,y=Math.PI/3,_=0,R=2){super(r,l),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(mr.DEFAULT_UP),this.updateMatrix(),this.target=new mr,this.distance=m,this.angle=y,this.penumbra=_,this.decay=R,this.map=null,this.shadow=new DN}get power(){return this.intensity*Math.PI}set power(r){this.intensity=r/Math.PI}dispose(){this.shadow.dispose()}copy(r,l){return super.copy(r,l),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}}const M2=new _i,op=new je,Hx=new je;class ON extends Vx{constructor(){super(new hs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new en(4,2),this._viewportCount=6,this._viewports=[new ur(2,1,1,1),new ur(0,1,1,1),new ur(3,1,1,1),new ur(1,1,1,1),new ur(3,0,1,1),new ur(1,0,1,1)],this._cubeDirections=[new je(1,0,0),new je(-1,0,0),new je(0,0,1),new je(0,0,-1),new je(0,1,0),new je(0,-1,0)],this._cubeUps=[new je(0,1,0),new je(0,1,0),new je(0,1,0),new je(0,1,0),new je(0,0,1),new je(0,0,-1)]}updateMatrices(r,l=0){const m=this.camera,y=this.matrix,_=r.distance||m.far;_!==m.far&&(m.far=_,m.updateProjectionMatrix()),op.setFromMatrixPosition(r.matrixWorld),m.position.copy(op),Hx.copy(m.position),Hx.add(this._cubeDirections[l]),m.up.copy(this._cubeUps[l]),m.lookAt(Hx),m.updateMatrixWorld(),y.makeTranslation(-op.x,-op.y,-op.z),M2.multiplyMatrices(m.projectionMatrix,m.matrixWorldInverse),this._frustum.setFromProjectionMatrix(M2)}}class C2 extends mc{constructor(r,l,m=0,y=2){super(r,l),this.isPointLight=!0,this.type="PointLight",this.distance=m,this.decay=y,this.shadow=new ON}get power(){return this.intensity*4*Math.PI}set power(r){this.intensity=r/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(r,l){return super.copy(r,l),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}}class FN extends Vx{constructor(){super(new mg(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class S2 extends mc{constructor(r,l){super(r,l),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(mr.DEFAULT_UP),this.updateMatrix(),this.target=new mr,this.shadow=new FN}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}}class T2 extends mc{constructor(r,l){super(r,l),this.isAmbientLight=!0,this.type="AmbientLight"}}class R2 extends mc{constructor(r,l,m=10,y=10){super(r,l),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=m,this.height=y}get power(){return this.intensity*this.width*this.height*Math.PI}set power(r){this.intensity=r/(this.width*this.height*Math.PI)}copy(r){return super.copy(r),this.width=r.width,this.height=r.height,this}toJSON(r){const l=super.toJSON(r);return l.object.width=this.width,l.object.height=this.height,l}}class I2{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let r=0;r<9;r++)this.coefficients.push(new je)}set(r){for(let l=0;l<9;l++)this.coefficients[l].copy(r[l]);return this}zero(){for(let r=0;r<9;r++)this.coefficients[r].set(0,0,0);return this}getAt(r,l){const m=r.x,y=r.y,_=r.z,R=this.coefficients;return l.copy(R[0]).multiplyScalar(.282095),l.addScaledVector(R[1],.488603*y),l.addScaledVector(R[2],.488603*_),l.addScaledVector(R[3],.488603*m),l.addScaledVector(R[4],1.092548*(m*y)),l.addScaledVector(R[5],1.092548*(y*_)),l.addScaledVector(R[6],.315392*(3*_*_-1)),l.addScaledVector(R[7],1.092548*(m*_)),l.addScaledVector(R[8],.546274*(m*m-y*y)),l}getIrradianceAt(r,l){const m=r.x,y=r.y,_=r.z,R=this.coefficients;return l.copy(R[0]).multiplyScalar(.886227),l.addScaledVector(R[1],1.023328*y),l.addScaledVector(R[2],1.023328*_),l.addScaledVector(R[3],1.023328*m),l.addScaledVector(R[4],.858086*m*y),l.addScaledVector(R[5],.858086*y*_),l.addScaledVector(R[6],.743125*_*_-.247708),l.addScaledVector(R[7],.858086*m*_),l.addScaledVector(R[8],.429043*(m*m-y*y)),l}add(r){for(let l=0;l<9;l++)this.coefficients[l].add(r.coefficients[l]);return this}addScaledSH(r,l){for(let m=0;m<9;m++)this.coefficients[m].addScaledVector(r.coefficients[m],l);return this}scale(r){for(let l=0;l<9;l++)this.coefficients[l].multiplyScalar(r);return this}lerp(r,l){for(let m=0;m<9;m++)this.coefficients[m].lerp(r.coefficients[m],l);return this}equals(r){for(let l=0;l<9;l++)if(!this.coefficients[l].equals(r.coefficients[l]))return!1;return!0}copy(r){return this.set(r.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(r,l=0){const m=this.coefficients;for(let y=0;y<9;y++)m[y].fromArray(r,l+y*3);return this}toArray(r=[],l=0){const m=this.coefficients;for(let y=0;y<9;y++)m[y].toArray(r,l+y*3);return r}static getBasisAt(r,l){const m=r.x,y=r.y,_=r.z;l[0]=.282095,l[1]=.488603*y,l[2]=.488603*_,l[3]=.488603*m,l[4]=1.092548*m*y,l[5]=1.092548*y*_,l[6]=.315392*(3*_*_-1),l[7]=1.092548*m*_,l[8]=.546274*(m*m-y*y)}}class B2 extends mc{constructor(r=new I2,l=1){super(void 0,l),this.isLightProbe=!0,this.sh=r}copy(r){return super.copy(r),this.sh.copy(r.sh),this}fromJSON(r){return this.intensity=r.intensity,this.sh.fromArray(r.sh),this}toJSON(r){const l=super.toJSON(r);return l.object.sh=this.sh.toArray(),l}}class eA extends wo{constructor(r){super(r),this.textures={}}load(r,l,m,y){const _=this,R=new gl(_.manager);R.setPath(_.path),R.setRequestHeader(_.requestHeader),R.setWithCredentials(_.withCredentials),R.load(r,function(I){try{l(_.parse(JSON.parse(I)))}catch(O){y?y(O):console.error(O),_.manager.itemError(r)}},m,y)}parse(r){const l=this.textures;function m(_){return l[_]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",_),l[_]}const y=eA.createMaterialFromType(r.type);if(r.uuid!==void 0&&(y.uuid=r.uuid),r.name!==void 0&&(y.name=r.name),r.color!==void 0&&y.color!==void 0&&y.color.setHex(r.color),r.roughness!==void 0&&(y.roughness=r.roughness),r.metalness!==void 0&&(y.metalness=r.metalness),r.sheen!==void 0&&(y.sheen=r.sheen),r.sheenColor!==void 0&&(y.sheenColor=new Hn().setHex(r.sheenColor)),r.sheenRoughness!==void 0&&(y.sheenRoughness=r.sheenRoughness),r.emissive!==void 0&&y.emissive!==void 0&&y.emissive.setHex(r.emissive),r.specular!==void 0&&y.specular!==void 0&&y.specular.setHex(r.specular),r.specularIntensity!==void 0&&(y.specularIntensity=r.specularIntensity),r.specularColor!==void 0&&y.specularColor!==void 0&&y.specularColor.setHex(r.specularColor),r.shininess!==void 0&&(y.shininess=r.shininess),r.clearcoat!==void 0&&(y.clearcoat=r.clearcoat),r.clearcoatRoughness!==void 0&&(y.clearcoatRoughness=r.clearcoatRoughness),r.iridescence!==void 0&&(y.iridescence=r.iridescence),r.iridescenceIOR!==void 0&&(y.iridescenceIOR=r.iridescenceIOR),r.iridescenceThicknessRange!==void 0&&(y.iridescenceThicknessRange=r.iridescenceThicknessRange),r.transmission!==void 0&&(y.transmission=r.transmission),r.thickness!==void 0&&(y.thickness=r.thickness),r.attenuationDistance!==void 0&&(y.attenuationDistance=r.attenuationDistance),r.attenuationColor!==void 0&&y.attenuationColor!==void 0&&y.attenuationColor.setHex(r.attenuationColor),r.anisotropy!==void 0&&(y.anisotropy=r.anisotropy),r.anisotropyRotation!==void 0&&(y.anisotropyRotation=r.anisotropyRotation),r.fog!==void 0&&(y.fog=r.fog),r.flatShading!==void 0&&(y.flatShading=r.flatShading),r.blending!==void 0&&(y.blending=r.blending),r.combine!==void 0&&(y.combine=r.combine),r.side!==void 0&&(y.side=r.side),r.shadowSide!==void 0&&(y.shadowSide=r.shadowSide),r.opacity!==void 0&&(y.opacity=r.opacity),r.transparent!==void 0&&(y.transparent=r.transparent),r.alphaTest!==void 0&&(y.alphaTest=r.alphaTest),r.alphaHash!==void 0&&(y.alphaHash=r.alphaHash),r.depthFunc!==void 0&&(y.depthFunc=r.depthFunc),r.depthTest!==void 0&&(y.depthTest=r.depthTest),r.depthWrite!==void 0&&(y.depthWrite=r.depthWrite),r.colorWrite!==void 0&&(y.colorWrite=r.colorWrite),r.blendSrc!==void 0&&(y.blendSrc=r.blendSrc),r.blendDst!==void 0&&(y.blendDst=r.blendDst),r.blendEquation!==void 0&&(y.blendEquation=r.blendEquation),r.blendSrcAlpha!==void 0&&(y.blendSrcAlpha=r.blendSrcAlpha),r.blendDstAlpha!==void 0&&(y.blendDstAlpha=r.blendDstAlpha),r.blendEquationAlpha!==void 0&&(y.blendEquationAlpha=r.blendEquationAlpha),r.blendColor!==void 0&&y.blendColor!==void 0&&y.blendColor.setHex(r.blendColor),r.blendAlpha!==void 0&&(y.blendAlpha=r.blendAlpha),r.stencilWriteMask!==void 0&&(y.stencilWriteMask=r.stencilWriteMask),r.stencilFunc!==void 0&&(y.stencilFunc=r.stencilFunc),r.stencilRef!==void 0&&(y.stencilRef=r.stencilRef),r.stencilFuncMask!==void 0&&(y.stencilFuncMask=r.stencilFuncMask),r.stencilFail!==void 0&&(y.stencilFail=r.stencilFail),r.stencilZFail!==void 0&&(y.stencilZFail=r.stencilZFail),r.stencilZPass!==void 0&&(y.stencilZPass=r.stencilZPass),r.stencilWrite!==void 0&&(y.stencilWrite=r.stencilWrite),r.wireframe!==void 0&&(y.wireframe=r.wireframe),r.wireframeLinewidth!==void 0&&(y.wireframeLinewidth=r.wireframeLinewidth),r.wireframeLinecap!==void 0&&(y.wireframeLinecap=r.wireframeLinecap),r.wireframeLinejoin!==void 0&&(y.wireframeLinejoin=r.wireframeLinejoin),r.rotation!==void 0&&(y.rotation=r.rotation),r.linewidth!==void 0&&(y.linewidth=r.linewidth),r.dashSize!==void 0&&(y.dashSize=r.dashSize),r.gapSize!==void 0&&(y.gapSize=r.gapSize),r.scale!==void 0&&(y.scale=r.scale),r.polygonOffset!==void 0&&(y.polygonOffset=r.polygonOffset),r.polygonOffsetFactor!==void 0&&(y.polygonOffsetFactor=r.polygonOffsetFactor),r.polygonOffsetUnits!==void 0&&(y.polygonOffsetUnits=r.polygonOffsetUnits),r.dithering!==void 0&&(y.dithering=r.dithering),r.alphaToCoverage!==void 0&&(y.alphaToCoverage=r.alphaToCoverage),r.premultipliedAlpha!==void 0&&(y.premultipliedAlpha=r.premultipliedAlpha),r.forceSinglePass!==void 0&&(y.forceSinglePass=r.forceSinglePass),r.visible!==void 0&&(y.visible=r.visible),r.toneMapped!==void 0&&(y.toneMapped=r.toneMapped),r.userData!==void 0&&(y.userData=r.userData),r.vertexColors!==void 0&&(typeof r.vertexColors=="number"?y.vertexColors=r.vertexColors>0:y.vertexColors=r.vertexColors),r.uniforms!==void 0)for(const _ in r.uniforms){const R=r.uniforms[_];switch(y.uniforms[_]={},R.type){case"t":y.uniforms[_].value=m(R.value);break;case"c":y.uniforms[_].value=new Hn().setHex(R.value);break;case"v2":y.uniforms[_].value=new en().fromArray(R.value);break;case"v3":y.uniforms[_].value=new je().fromArray(R.value);break;case"v4":y.uniforms[_].value=new ur().fromArray(R.value);break;case"m3":y.uniforms[_].value=new Ui().fromArray(R.value);break;case"m4":y.uniforms[_].value=new _i().fromArray(R.value);break;default:y.uniforms[_].value=R.value}}if(r.defines!==void 0&&(y.defines=r.defines),r.vertexShader!==void 0&&(y.vertexShader=r.vertexShader),r.fragmentShader!==void 0&&(y.fragmentShader=r.fragmentShader),r.glslVersion!==void 0&&(y.glslVersion=r.glslVersion),r.extensions!==void 0)for(const _ in r.extensions)y.extensions[_]=r.extensions[_];if(r.lights!==void 0&&(y.lights=r.lights),r.clipping!==void 0&&(y.clipping=r.clipping),r.size!==void 0&&(y.size=r.size),r.sizeAttenuation!==void 0&&(y.sizeAttenuation=r.sizeAttenuation),r.map!==void 0&&(y.map=m(r.map)),r.matcap!==void 0&&(y.matcap=m(r.matcap)),r.alphaMap!==void 0&&(y.alphaMap=m(r.alphaMap)),r.bumpMap!==void 0&&(y.bumpMap=m(r.bumpMap)),r.bumpScale!==void 0&&(y.bumpScale=r.bumpScale),r.normalMap!==void 0&&(y.normalMap=m(r.normalMap)),r.normalMapType!==void 0&&(y.normalMapType=r.normalMapType),r.normalScale!==void 0){let _=r.normalScale;Array.isArray(_)===!1&&(_=[_,_]),y.normalScale=new en().fromArray(_)}return r.displacementMap!==void 0&&(y.displacementMap=m(r.displacementMap)),r.displacementScale!==void 0&&(y.displacementScale=r.displacementScale),r.displacementBias!==void 0&&(y.displacementBias=r.displacementBias),r.roughnessMap!==void 0&&(y.roughnessMap=m(r.roughnessMap)),r.metalnessMap!==void 0&&(y.metalnessMap=m(r.metalnessMap)),r.emissiveMap!==void 0&&(y.emissiveMap=m(r.emissiveMap)),r.emissiveIntensity!==void 0&&(y.emissiveIntensity=r.emissiveIntensity),r.specularMap!==void 0&&(y.specularMap=m(r.specularMap)),r.specularIntensityMap!==void 0&&(y.specularIntensityMap=m(r.specularIntensityMap)),r.specularColorMap!==void 0&&(y.specularColorMap=m(r.specularColorMap)),r.envMap!==void 0&&(y.envMap=m(r.envMap)),r.envMapIntensity!==void 0&&(y.envMapIntensity=r.envMapIntensity),r.reflectivity!==void 0&&(y.reflectivity=r.reflectivity),r.refractionRatio!==void 0&&(y.refractionRatio=r.refractionRatio),r.lightMap!==void 0&&(y.lightMap=m(r.lightMap)),r.lightMapIntensity!==void 0&&(y.lightMapIntensity=r.lightMapIntensity),r.aoMap!==void 0&&(y.aoMap=m(r.aoMap)),r.aoMapIntensity!==void 0&&(y.aoMapIntensity=r.aoMapIntensity),r.gradientMap!==void 0&&(y.gradientMap=m(r.gradientMap)),r.clearcoatMap!==void 0&&(y.clearcoatMap=m(r.clearcoatMap)),r.clearcoatRoughnessMap!==void 0&&(y.clearcoatRoughnessMap=m(r.clearcoatRoughnessMap)),r.clearcoatNormalMap!==void 0&&(y.clearcoatNormalMap=m(r.clearcoatNormalMap)),r.clearcoatNormalScale!==void 0&&(y.clearcoatNormalScale=new en().fromArray(r.clearcoatNormalScale)),r.iridescenceMap!==void 0&&(y.iridescenceMap=m(r.iridescenceMap)),r.iridescenceThicknessMap!==void 0&&(y.iridescenceThicknessMap=m(r.iridescenceThicknessMap)),r.transmissionMap!==void 0&&(y.transmissionMap=m(r.transmissionMap)),r.thicknessMap!==void 0&&(y.thicknessMap=m(r.thicknessMap)),r.anisotropyMap!==void 0&&(y.anisotropyMap=m(r.anisotropyMap)),r.sheenColorMap!==void 0&&(y.sheenColorMap=m(r.sheenColorMap)),r.sheenRoughnessMap!==void 0&&(y.sheenRoughnessMap=m(r.sheenRoughnessMap)),y}setTextures(r){return this.textures=r,this}static createMaterialFromType(r){const l={ShadowMaterial:o2,SpriteMaterial:mx,RawShaderMaterial:a2,ShaderMaterial:Ka,PointsMaterial:Ex,MeshPhysicalMaterial:l2,MeshStandardMaterial:Ox,MeshPhongMaterial:c2,MeshToonMaterial:h2,MeshNormalMaterial:u2,MeshLambertMaterial:d2,MeshDepthMaterial:ux,MeshDistanceMaterial:dx,MeshBasicMaterial:uc,MeshMatcapMaterial:f2,LineDashedMaterial:p2,LineBasicMaterial:oo,Material:js};return new l[r]}}class jx{static decodeText(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let l="";for(let m=0,y=r.length;m<y;m++)l+=String.fromCharCode(r[m]);try{return decodeURIComponent(escape(l))}catch{return l}}static extractUrlBase(r){const l=r.lastIndexOf("/");return l===-1?"./":r.slice(0,l+1)}static resolveURL(r,l){return typeof r!="string"||r===""?"":(/^https?:\/\//i.test(l)&&/^\//.test(r)&&(l=l.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(r)||/^data:.*,.*$/i.test(r)||/^blob:.*$/i.test(r)?r:l+r)}}class L2 extends Yi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(r){return super.copy(r),this.instanceCount=r.instanceCount,this}toJSON(){const r=super.toJSON();return r.instanceCount=this.instanceCount,r.isInstancedBufferGeometry=!0,r}}class P2 extends wo{constructor(r){super(r)}load(r,l,m,y){const _=this,R=new gl(_.manager);R.setPath(_.path),R.setRequestHeader(_.requestHeader),R.setWithCredentials(_.withCredentials),R.load(r,function(I){try{l(_.parse(JSON.parse(I)))}catch(O){y?y(O):console.error(O),_.manager.itemError(r)}},m,y)}parse(r){const l={},m={};function y($,ie){if(l[ie]!==void 0)return l[ie];const re=$.interleavedBuffers[ie],q=_($,re.buffer),Se=oc(re.type,q),fe=new Eg(Se,re.stride);return fe.uuid=re.uuid,l[ie]=fe,fe}function _($,ie){if(m[ie]!==void 0)return m[ie];const re=$.arrayBuffers[ie],q=new Uint32Array(re).buffer;return m[ie]=q,q}const R=r.isInstancedBufferGeometry?new L2:new Yi,I=r.data.index;if(I!==void 0){const $=oc(I.type,I.array);R.setIndex(new Sr($,1))}const O=r.data.attributes;for(const $ in O){const ie=O[$];let ue;if(ie.isInterleavedBufferAttribute){const re=y(r.data,ie.data);ue=new vh(re,ie.itemSize,ie.offset,ie.normalized)}else{const re=oc(ie.type,ie.array),q=ie.isInstancedBufferAttribute?Gu:Sr;ue=new q(re,ie.itemSize,ie.normalized)}ie.name!==void 0&&(ue.name=ie.name),ie.usage!==void 0&&ue.setUsage(ie.usage),ie.updateRange!==void 0&&(ue.updateRange.offset=ie.updateRange.offset,ue.updateRange.count=ie.updateRange.count),R.setAttribute($,ue)}const N=r.data.morphAttributes;if(N)for(const $ in N){const ie=N[$],ue=[];for(let re=0,q=ie.length;re<q;re++){const Se=ie[re];let fe;if(Se.isInterleavedBufferAttribute){const Me=y(r.data,Se.data);fe=new vh(Me,Se.itemSize,Se.offset,Se.normalized)}else{const Me=oc(Se.type,Se.array);fe=new Sr(Me,Se.itemSize,Se.normalized)}Se.name!==void 0&&(fe.name=Se.name),ue.push(fe)}R.morphAttributes[$]=ue}r.data.morphTargetsRelative&&(R.morphTargetsRelative=!0);const Q=r.data.groups||r.data.drawcalls||r.data.offsets;if(Q!==void 0)for(let $=0,ie=Q.length;$!==ie;++$){const ue=Q[$];R.addGroup(ue.start,ue.count,ue.materialIndex)}const X=r.data.boundingSphere;if(X!==void 0){const $=new je;X.center!==void 0&&$.fromArray(X.center),R.boundingSphere=new Eo($,X.radius)}return r.name&&(R.name=r.name),r.userData&&(R.userData=r.userData),R}}class NN extends wo{constructor(r){super(r)}load(r,l,m,y){const _=this,R=this.path===""?jx.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||R;const I=new gl(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.setWithCredentials(this.withCredentials),I.load(r,function(O){let N=null;try{N=JSON.parse(O)}catch(Q){y!==void 0&&y(Q),console.error("THREE:ObjectLoader: Can't parse "+r+".",Q.message);return}const V=N.metadata;if(V===void 0||V.type===void 0||V.type.toLowerCase()==="geometry"){y!==void 0&&y(new Error("THREE.ObjectLoader: Can't load "+r)),console.error("THREE.ObjectLoader: Can't load "+r);return}_.parse(N,l)},m,y)}async loadAsync(r,l){const m=this,y=this.path===""?jx.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||y;const _=new gl(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials);const R=await _.loadAsync(r,l),I=JSON.parse(R),O=I.metadata;if(O===void 0||O.type===void 0||O.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+r);return await m.parseAsync(I)}parse(r,l){const m=this.parseAnimations(r.animations),y=this.parseShapes(r.shapes),_=this.parseGeometries(r.geometries,y),R=this.parseImages(r.images,function(){l!==void 0&&l(N)}),I=this.parseTextures(r.textures,R),O=this.parseMaterials(r.materials,I),N=this.parseObject(r.object,_,O,I,m),V=this.parseSkeletons(r.skeletons,N);if(this.bindSkeletons(N,V),l!==void 0){let Q=!1;for(const X in R)if(R[X].data instanceof HTMLImageElement){Q=!0;break}Q===!1&&l(N)}return N}async parseAsync(r){const l=this.parseAnimations(r.animations),m=this.parseShapes(r.shapes),y=this.parseGeometries(r.geometries,m),_=await this.parseImagesAsync(r.images),R=this.parseTextures(r.textures,_),I=this.parseMaterials(r.materials,R),O=this.parseObject(r.object,y,I,R,l),N=this.parseSkeletons(r.skeletons,O);return this.bindSkeletons(O,N),O}parseShapes(r){const l={};if(r!==void 0)for(let m=0,y=r.length;m<y;m++){const _=new yh().fromJSON(r[m]);l[_.uuid]=_}return l}parseSkeletons(r,l){const m={},y={};if(l.traverse(function(_){_.isBone&&(y[_.uuid]=_)}),r!==void 0)for(let _=0,R=r.length;_<R;_++){const I=new Sg().fromJSON(r[_],y);m[I.uuid]=I}return m}parseGeometries(r,l){const m={};if(r!==void 0){const _=new P2;for(let R=0,I=r.length;R<I;R++){let O;const N=r[R];switch(N.type){case"BufferGeometry":case"InstancedBufferGeometry":O=_.parse(N);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var y=new THREE.LegacyJSONLoader;O=y.parse(N,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:N.type in s2?O=s2[N.type].fromJSON(N,l):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${N.type}"`)}O.uuid=N.uuid,N.name!==void 0&&(O.name=N.name),N.userData!==void 0&&(O.userData=N.userData),m[N.uuid]=O}}return m}parseMaterials(r,l){const m={},y={};if(r!==void 0){const _=new eA;_.setTextures(l);for(let R=0,I=r.length;R<I;R++){const O=r[R];m[O.uuid]===void 0&&(m[O.uuid]=_.parse(O)),y[O.uuid]=m[O.uuid]}}return y}parseAnimations(r){const l={};if(r!==void 0)for(let m=0;m<r.length;m++){const y=r[m],_=rp.parse(y);l[_.uuid]=_}return l}parseImages(r,l){const m=this,y={};let _;function R(O){return m.manager.itemStart(O),_.load(O,function(){m.manager.itemEnd(O)},void 0,function(){m.manager.itemError(O),m.manager.itemEnd(O)})}function I(O){if(typeof O=="string"){const N=O,V=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(N)?N:m.resourcePath+N;return R(V)}else return O.data?{data:oc(O.type,O.data),width:O.width,height:O.height}:null}if(r!==void 0&&r.length>0){const O=new zx(l);_=new sp(O),_.setCrossOrigin(this.crossOrigin);for(let N=0,V=r.length;N<V;N++){const Q=r[N],X=Q.url;if(Array.isArray(X)){const $=[];for(let ie=0,ue=X.length;ie<ue;ie++){const re=X[ie],q=I(re);q!==null&&(q instanceof HTMLImageElement?$.push(q):$.push(new zu(q.data,q.width,q.height)))}y[Q.uuid]=new Br($)}else{const $=I(Q.url);y[Q.uuid]=new Br($)}}}return y}async parseImagesAsync(r){const l=this,m={};let y;async function _(R){if(typeof R=="string"){const I=R,O=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(I)?I:l.resourcePath+I;return await y.loadAsync(O)}else return R.data?{data:oc(R.type,R.data),width:R.width,height:R.height}:null}if(r!==void 0&&r.length>0){y=new sp(this.manager),y.setCrossOrigin(this.crossOrigin);for(let R=0,I=r.length;R<I;R++){const O=r[R],N=O.url;if(Array.isArray(N)){const V=[];for(let Q=0,X=N.length;Q<X;Q++){const $=N[Q],ie=await _($);ie!==null&&(ie instanceof HTMLImageElement?V.push(ie):V.push(new zu(ie.data,ie.width,ie.height)))}m[O.uuid]=new Br(V)}else{const V=await _(O.url);m[O.uuid]=new Br(V)}}}return m}parseTextures(r,l){function m(_,R){return typeof _=="number"?_:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",_),R[_])}const y={};if(r!==void 0)for(let _=0,R=r.length;_<R;_++){const I=r[_];I.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',I.uuid),l[I.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",I.image);const O=l[I.image],N=O.data;let V;Array.isArray(N)?(V=new Uf,N.length===6&&(V.needsUpdate=!0)):(N&&N.data?V=new zu:V=new Ir,N&&(V.needsUpdate=!0)),V.source=O,V.uuid=I.uuid,I.name!==void 0&&(V.name=I.name),I.mapping!==void 0&&(V.mapping=m(I.mapping,UN)),I.channel!==void 0&&(V.channel=I.channel),I.offset!==void 0&&V.offset.fromArray(I.offset),I.repeat!==void 0&&V.repeat.fromArray(I.repeat),I.center!==void 0&&V.center.fromArray(I.center),I.rotation!==void 0&&(V.rotation=I.rotation),I.wrap!==void 0&&(V.wrapS=m(I.wrap[0],D2),V.wrapT=m(I.wrap[1],D2)),I.format!==void 0&&(V.format=I.format),I.internalFormat!==void 0&&(V.internalFormat=I.internalFormat),I.type!==void 0&&(V.type=I.type),I.colorSpace!==void 0&&(V.colorSpace=I.colorSpace),I.encoding!==void 0&&(V.encoding=I.encoding),I.minFilter!==void 0&&(V.minFilter=m(I.minFilter,O2)),I.magFilter!==void 0&&(V.magFilter=m(I.magFilter,O2)),I.anisotropy!==void 0&&(V.anisotropy=I.anisotropy),I.flipY!==void 0&&(V.flipY=I.flipY),I.generateMipmaps!==void 0&&(V.generateMipmaps=I.generateMipmaps),I.premultiplyAlpha!==void 0&&(V.premultiplyAlpha=I.premultiplyAlpha),I.unpackAlignment!==void 0&&(V.unpackAlignment=I.unpackAlignment),I.compareFunction!==void 0&&(V.compareFunction=I.compareFunction),I.userData!==void 0&&(V.userData=I.userData),y[I.uuid]=V}return y}parseObject(r,l,m,y,_){let R;function I(X){return l[X]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",X),l[X]}function O(X){if(X!==void 0){if(Array.isArray(X)){const $=[];for(let ie=0,ue=X.length;ie<ue;ie++){const re=X[ie];m[re]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",re),$.push(m[re])}return $}return m[X]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",X),m[X]}}function N(X){return y[X]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",X),y[X]}let V,Q;switch(r.type){case"Scene":R=new vM,r.background!==void 0&&(Number.isInteger(r.background)?R.background=new Hn(r.background):R.background=N(r.background)),r.environment!==void 0&&(R.environment=N(r.environment)),r.fog!==void 0&&(r.fog.type==="Fog"?R.fog=new xg(r.fog.color,r.fog.near,r.fog.far):r.fog.type==="FogExp2"&&(R.fog=new yg(r.fog.color,r.fog.density)),r.fog.name!==""&&(R.fog.name=r.fog.name)),r.backgroundBlurriness!==void 0&&(R.backgroundBlurriness=r.backgroundBlurriness),r.backgroundIntensity!==void 0&&(R.backgroundIntensity=r.backgroundIntensity);break;case"PerspectiveCamera":R=new hs(r.fov,r.aspect,r.near,r.far),r.focus!==void 0&&(R.focus=r.focus),r.zoom!==void 0&&(R.zoom=r.zoom),r.filmGauge!==void 0&&(R.filmGauge=r.filmGauge),r.filmOffset!==void 0&&(R.filmOffset=r.filmOffset),r.view!==void 0&&(R.view=Object.assign({},r.view));break;case"OrthographicCamera":R=new mg(r.left,r.right,r.top,r.bottom,r.near,r.far),r.zoom!==void 0&&(R.zoom=r.zoom),r.view!==void 0&&(R.view=Object.assign({},r.view));break;case"AmbientLight":R=new T2(r.color,r.intensity);break;case"DirectionalLight":R=new S2(r.color,r.intensity);break;case"PointLight":R=new C2(r.color,r.intensity,r.distance,r.decay);break;case"RectAreaLight":R=new R2(r.color,r.intensity,r.width,r.height);break;case"SpotLight":R=new w2(r.color,r.intensity,r.distance,r.angle,r.penumbra,r.decay);break;case"HemisphereLight":R=new E2(r.color,r.groundColor,r.intensity);break;case"LightProbe":R=new B2().fromJSON(r);break;case"SkinnedMesh":V=I(r.geometry),Q=O(r.material),R=new IM(V,Q),r.bindMode!==void 0&&(R.bindMode=r.bindMode),r.bindMatrix!==void 0&&R.bindMatrix.fromArray(r.bindMatrix),r.skeleton!==void 0&&(R.skeleton=r.skeleton);break;case"Mesh":V=I(r.geometry),Q=O(r.material),R=new Os(V,Q);break;case"InstancedMesh":V=I(r.geometry),Q=O(r.material);const X=r.count,$=r.instanceMatrix,ie=r.instanceColor;R=new DM(V,Q,X),R.instanceMatrix=new Gu(new Float32Array($.array),16),ie!==void 0&&(R.instanceColor=new Gu(new Float32Array(ie.array),ie.itemSize));break;case"LOD":R=new wM;break;case"Line":R=new fc(I(r.geometry),O(r.material));break;case"LineLoop":R=new zM(I(r.geometry),O(r.material));break;case"LineSegments":R=new qa(I(r.geometry),O(r.material));break;case"PointCloud":case"Points":R=new VM(I(r.geometry),O(r.material));break;case"Sprite":R=new bM(O(r.material));break;case"Group":R=new Ah;break;case"Bone":R=new yx;break;default:R=new mr}if(R.uuid=r.uuid,r.name!==void 0&&(R.name=r.name),r.matrix!==void 0?(R.matrix.fromArray(r.matrix),r.matrixAutoUpdate!==void 0&&(R.matrixAutoUpdate=r.matrixAutoUpdate),R.matrixAutoUpdate&&R.matrix.decompose(R.position,R.quaternion,R.scale)):(r.position!==void 0&&R.position.fromArray(r.position),r.rotation!==void 0&&R.rotation.fromArray(r.rotation),r.quaternion!==void 0&&R.quaternion.fromArray(r.quaternion),r.scale!==void 0&&R.scale.fromArray(r.scale)),r.up!==void 0&&R.up.fromArray(r.up),r.castShadow!==void 0&&(R.castShadow=r.castShadow),r.receiveShadow!==void 0&&(R.receiveShadow=r.receiveShadow),r.shadow&&(r.shadow.bias!==void 0&&(R.shadow.bias=r.shadow.bias),r.shadow.normalBias!==void 0&&(R.shadow.normalBias=r.shadow.normalBias),r.shadow.radius!==void 0&&(R.shadow.radius=r.shadow.radius),r.shadow.mapSize!==void 0&&R.shadow.mapSize.fromArray(r.shadow.mapSize),r.shadow.camera!==void 0&&(R.shadow.camera=this.parseObject(r.shadow.camera))),r.visible!==void 0&&(R.visible=r.visible),r.frustumCulled!==void 0&&(R.frustumCulled=r.frustumCulled),r.renderOrder!==void 0&&(R.renderOrder=r.renderOrder),r.userData!==void 0&&(R.userData=r.userData),r.layers!==void 0&&(R.layers.mask=r.layers),r.children!==void 0){const X=r.children;for(let $=0;$<X.length;$++)R.add(this.parseObject(X[$],l,m,y,_))}if(r.animations!==void 0){const X=r.animations;for(let $=0;$<X.length;$++){const ie=X[$];R.animations.push(_[ie])}}if(r.type==="LOD"){r.autoUpdate!==void 0&&(R.autoUpdate=r.autoUpdate);const X=r.levels;for(let $=0;$<X.length;$++){const ie=X[$],ue=R.getObjectByProperty("uuid",ie.object);ue!==void 0&&R.addLevel(ue,ie.distance,ie.hysteresis)}}return R}bindSkeletons(r,l){Object.keys(l).length!==0&&r.traverse(function(m){if(m.isSkinnedMesh===!0&&m.skeleton!==void 0){const y=l[m.skeleton];y===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",m.skeleton):m.bind(y,m.bindMatrix)}})}}const UN={UVMapping:Ye,CubeReflectionMapping:Qe,CubeRefractionMapping:ne,EquirectangularReflectionMapping:W,EquirectangularRefractionMapping:k,CubeUVReflectionMapping:he},D2={RepeatWrapping:Re,ClampToEdgeWrapping:We,MirroredRepeatWrapping:ve},O2={NearestFilter:at,NearestMipmapNearestFilter:At,NearestMipmapLinearFilter:Pt,LinearFilter:Bn,LinearMipmapNearestFilter:pi,LinearMipmapLinearFilter:Fn};class kN extends wo{constructor(r){super(r),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(r){return this.options=r,this}load(r,l,m,y){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const _=this,R=wh.get(r);if(R!==void 0)return _.manager.itemStart(r),setTimeout(function(){l&&l(R),_.manager.itemEnd(r)},0),R;const I={};I.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",I.headers=this.requestHeader,fetch(r,I).then(function(O){return O.blob()}).then(function(O){return createImageBitmap(O,Object.assign(_.options,{colorSpaceConversion:"none"}))}).then(function(O){wh.add(r,O),l&&l(O),_.manager.itemEnd(r)}).catch(function(O){y&&y(O),_.manager.itemError(r),_.manager.itemEnd(r)}),_.manager.itemStart(r)}}let tA;class Wx{static getContext(){return tA===void 0&&(tA=new(window.AudioContext||window.webkitAudioContext)),tA}static setContext(r){tA=r}}class zN extends wo{constructor(r){super(r)}load(r,l,m,y){const _=this,R=new gl(this.manager);R.setResponseType("arraybuffer"),R.setPath(this.path),R.setRequestHeader(this.requestHeader),R.setWithCredentials(this.withCredentials),R.load(r,function(O){try{const N=O.slice(0);Wx.getContext().decodeAudioData(N,function(Q){l(Q)},I)}catch(N){I(N)}},m,y);function I(O){y?y(O):console.error(O),_.manager.itemError(r)}}}const F2=new _i,N2=new _i,Mh=new _i;class GN{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new hs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new hs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(r){const l=this._cache;if(l.focus!==r.focus||l.fov!==r.fov||l.aspect!==r.aspect*this.aspect||l.near!==r.near||l.far!==r.far||l.zoom!==r.zoom||l.eyeSep!==this.eyeSep){l.focus=r.focus,l.fov=r.fov,l.aspect=r.aspect*this.aspect,l.near=r.near,l.far=r.far,l.zoom=r.zoom,l.eyeSep=this.eyeSep,Mh.copy(r.projectionMatrix);const y=l.eyeSep/2,_=y*l.near/l.focus,R=l.near*Math.tan(al*l.fov*.5)/l.zoom;let I,O;N2.elements[12]=-y,F2.elements[12]=y,I=-R*l.aspect+_,O=R*l.aspect+_,Mh.elements[0]=2*l.near/(O-I),Mh.elements[8]=(O+I)/(O-I),this.cameraL.projectionMatrix.copy(Mh),I=-R*l.aspect-_,O=R*l.aspect-_,Mh.elements[0]=2*l.near/(O-I),Mh.elements[8]=(O+I)/(O-I),this.cameraR.projectionMatrix.copy(Mh)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(N2),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(F2)}}class U2{constructor(r=!0){this.autoStart=r,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=k2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const l=k2();r=(l-this.oldTime)/1e3,this.oldTime=l,this.elapsedTime+=r}return r}}function k2(){return(typeof performance>"u"?Date:performance).now()}const Ch=new je,z2=new Ti,VN=new je,Sh=new je;class HN extends mr{constructor(){super(),this.type="AudioListener",this.context=Wx.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new U2}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(r){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=r,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this}updateMatrixWorld(r){super.updateMatrixWorld(r);const l=this.context.listener,m=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ch,z2,VN),Sh.set(0,0,-1).applyQuaternion(z2),l.positionX){const y=this.context.currentTime+this.timeDelta;l.positionX.linearRampToValueAtTime(Ch.x,y),l.positionY.linearRampToValueAtTime(Ch.y,y),l.positionZ.linearRampToValueAtTime(Ch.z,y),l.forwardX.linearRampToValueAtTime(Sh.x,y),l.forwardY.linearRampToValueAtTime(Sh.y,y),l.forwardZ.linearRampToValueAtTime(Sh.z,y),l.upX.linearRampToValueAtTime(m.x,y),l.upY.linearRampToValueAtTime(m.y,y),l.upZ.linearRampToValueAtTime(m.z,y)}else l.setPosition(Ch.x,Ch.y,Ch.z),l.setOrientation(Sh.x,Sh.y,Sh.z,m.x,m.y,m.z)}}class G2 extends mr{constructor(r){super(),this.type="Audio",this.listener=r,this.context=r.context,this.gain=this.context.createGain(),this.gain.connect(r.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(r){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=r,this.connect(),this}setMediaElementSource(r){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(r),this.connect(),this}setMediaStreamSource(r){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(r),this.connect(),this}setBuffer(r){return this.buffer=r,this.sourceType="buffer",this.autoplay&&this.play(),this}play(r=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+r;const l=this.context.createBufferSource();return l.buffer=this.buffer,l.loop=this.loop,l.loopStart=this.loopStart,l.loopEnd=this.loopEnd,l.onended=this.onEnded.bind(this),l.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=l,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let r=1,l=this.filters.length;r<l;r++)this.filters[r-1].connect(this.filters[r]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let r=1,l=this.filters.length;r<l;r++)this.filters[r-1].disconnect(this.filters[r]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(r){return r||(r=[]),this._connected===!0?(this.disconnect(),this.filters=r.slice(),this.connect()):this.filters=r.slice(),this}setDetune(r){if(this.detune=r,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(r){return this.setFilters(r?[r]:[])}setPlaybackRate(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=r,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=r,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(r){return this.loopStart=r,this}setLoopEnd(r){return this.loopEnd=r,this}getVolume(){return this.gain.gain.value}setVolume(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this}}const Th=new je,V2=new Ti,jN=new je,Rh=new je;class WN extends G2{constructor(r){super(r),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(r){return this.panner.refDistance=r,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(r){return this.panner.rolloffFactor=r,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(r){return this.panner.distanceModel=r,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(r){return this.panner.maxDistance=r,this}setDirectionalCone(r,l,m){return this.panner.coneInnerAngle=r,this.panner.coneOuterAngle=l,this.panner.coneOuterGain=m,this}updateMatrixWorld(r){if(super.updateMatrixWorld(r),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Th,V2,jN),Rh.set(0,0,1).applyQuaternion(V2);const l=this.panner;if(l.positionX){const m=this.context.currentTime+this.listener.timeDelta;l.positionX.linearRampToValueAtTime(Th.x,m),l.positionY.linearRampToValueAtTime(Th.y,m),l.positionZ.linearRampToValueAtTime(Th.z,m),l.orientationX.linearRampToValueAtTime(Rh.x,m),l.orientationY.linearRampToValueAtTime(Rh.y,m),l.orientationZ.linearRampToValueAtTime(Rh.z,m)}else l.setPosition(Th.x,Th.y,Th.z),l.setOrientation(Rh.x,Rh.y,Rh.z)}}class QN{constructor(r,l=2048){this.analyser=r.context.createAnalyser(),this.analyser.fftSize=l,this.data=new Uint8Array(this.analyser.frequencyBinCount),r.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let r=0;const l=this.getFrequencyData();for(let m=0;m<l.length;m++)r+=l[m];return r/l.length}}class H2{constructor(r,l,m){this.binding=r,this.valueSize=m;let y,_,R;switch(l){case"quaternion":y=this._slerp,_=this._slerpAdditive,R=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(m*6),this._workIndex=5;break;case"string":case"bool":y=this._select,_=this._select,R=this._setAdditiveIdentityOther,this.buffer=new Array(m*5);break;default:y=this._lerp,_=this._lerpAdditive,R=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(m*5)}this._mixBufferRegion=y,this._mixBufferRegionAdditive=_,this._setIdentity=R,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(r,l){const m=this.buffer,y=this.valueSize,_=r*y+y;let R=this.cumulativeWeight;if(R===0){for(let I=0;I!==y;++I)m[_+I]=m[I];R=l}else{R+=l;const I=l/R;this._mixBufferRegion(m,_,0,I,y)}this.cumulativeWeight=R}accumulateAdditive(r){const l=this.buffer,m=this.valueSize,y=m*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(l,y,0,r,m),this.cumulativeWeightAdditive+=r}apply(r){const l=this.valueSize,m=this.buffer,y=r*l+l,_=this.cumulativeWeight,R=this.cumulativeWeightAdditive,I=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,_<1){const O=l*this._origIndex;this._mixBufferRegion(m,y,O,1-_,l)}R>0&&this._mixBufferRegionAdditive(m,y,this._addIndex*l,1,l);for(let O=l,N=l+l;O!==N;++O)if(m[O]!==m[O+l]){I.setValue(m,y);break}}saveOriginalState(){const r=this.binding,l=this.buffer,m=this.valueSize,y=m*this._origIndex;r.getValue(l,y);for(let _=m,R=y;_!==R;++_)l[_]=l[y+_%m];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const r=this.valueSize*3;this.binding.setValue(this.buffer,r)}_setAdditiveIdentityNumeric(){const r=this._addIndex*this.valueSize,l=r+this.valueSize;for(let m=r;m<l;m++)this.buffer[m]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const r=this._origIndex*this.valueSize,l=this._addIndex*this.valueSize;for(let m=0;m<this.valueSize;m++)this.buffer[l+m]=this.buffer[r+m]}_select(r,l,m,y,_){if(y>=.5)for(let R=0;R!==_;++R)r[l+R]=r[m+R]}_slerp(r,l,m,y){Ti.slerpFlat(r,l,r,l,r,m,y)}_slerpAdditive(r,l,m,y,_){const R=this._workIndex*_;Ti.multiplyQuaternionsFlat(r,R,r,l,r,m),Ti.slerpFlat(r,l,r,l,r,R,y)}_lerp(r,l,m,y,_){const R=1-y;for(let I=0;I!==_;++I){const O=l+I;r[O]=r[O]*R+r[m+I]*y}}_lerpAdditive(r,l,m,y,_){for(let R=0;R!==_;++R){const I=l+R;r[I]=r[I]+r[m+R]*y}}}const Qx="\\[\\]\\.:\\/",XN=new RegExp("["+Qx+"]","g"),Xx="[^"+Qx+"]",KN="[^"+Qx.replace("\\.","")+"]",qN=/((?:WC+[\/:])*)/.source.replace("WC",Xx),YN=/(WCOD+)?/.source.replace("WCOD",KN),$N=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Xx),JN=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Xx),ZN=new RegExp("^"+qN+YN+$N+JN+"$"),e5=["material","materials","bones","map"];class t5{constructor(r,l,m){const y=m||dr.parseTrackName(l);this._targetGroup=r,this._bindings=r.subscribe_(l,y)}getValue(r,l){this.bind();const m=this._targetGroup.nCachedObjects_,y=this._bindings[m];y!==void 0&&y.getValue(r,l)}setValue(r,l){const m=this._bindings;for(let y=this._targetGroup.nCachedObjects_,_=m.length;y!==_;++y)m[y].setValue(r,l)}bind(){const r=this._bindings;for(let l=this._targetGroup.nCachedObjects_,m=r.length;l!==m;++l)r[l].bind()}unbind(){const r=this._bindings;for(let l=this._targetGroup.nCachedObjects_,m=r.length;l!==m;++l)r[l].unbind()}}class dr{constructor(r,l,m){this.path=l,this.parsedPath=m||dr.parseTrackName(l),this.node=dr.findNode(r,this.parsedPath.nodeName),this.rootNode=r,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(r,l,m){return r&&r.isAnimationObjectGroup?new dr.Composite(r,l,m):new dr(r,l,m)}static sanitizeNodeName(r){return r.replace(/\s/g,"_").replace(XN,"")}static parseTrackName(r){const l=ZN.exec(r);if(l===null)throw new Error("PropertyBinding: Cannot parse trackName: "+r);const m={nodeName:l[2],objectName:l[3],objectIndex:l[4],propertyName:l[5],propertyIndex:l[6]},y=m.nodeName&&m.nodeName.lastIndexOf(".");if(y!==void 0&&y!==-1){const _=m.nodeName.substring(y+1);e5.indexOf(_)!==-1&&(m.nodeName=m.nodeName.substring(0,y),m.objectName=_)}if(m.propertyName===null||m.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+r);return m}static findNode(r,l){if(l===void 0||l===""||l==="."||l===-1||l===r.name||l===r.uuid)return r;if(r.skeleton){const m=r.skeleton.getBoneByName(l);if(m!==void 0)return m}if(r.children){const m=function(_){for(let R=0;R<_.length;R++){const I=_[R];if(I.name===l||I.uuid===l)return I;const O=m(I.children);if(O)return O}return null},y=m(r.children);if(y)return y}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(r,l){r[l]=this.targetObject[this.propertyName]}_getValue_array(r,l){const m=this.resolvedProperty;for(let y=0,_=m.length;y!==_;++y)r[l++]=m[y]}_getValue_arrayElement(r,l){r[l]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(r,l){this.resolvedProperty.toArray(r,l)}_setValue_direct(r,l){this.targetObject[this.propertyName]=r[l]}_setValue_direct_setNeedsUpdate(r,l){this.targetObject[this.propertyName]=r[l],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(r,l){this.targetObject[this.propertyName]=r[l],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(r,l){const m=this.resolvedProperty;for(let y=0,_=m.length;y!==_;++y)m[y]=r[l++]}_setValue_array_setNeedsUpdate(r,l){const m=this.resolvedProperty;for(let y=0,_=m.length;y!==_;++y)m[y]=r[l++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(r,l){const m=this.resolvedProperty;for(let y=0,_=m.length;y!==_;++y)m[y]=r[l++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(r,l){this.resolvedProperty[this.propertyIndex]=r[l]}_setValue_arrayElement_setNeedsUpdate(r,l){this.resolvedProperty[this.propertyIndex]=r[l],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(r,l){this.resolvedProperty[this.propertyIndex]=r[l],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(r,l){this.resolvedProperty.fromArray(r,l)}_setValue_fromArray_setNeedsUpdate(r,l){this.resolvedProperty.fromArray(r,l),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(r,l){this.resolvedProperty.fromArray(r,l),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(r,l){this.bind(),this.getValue(r,l)}_setValue_unbound(r,l){this.bind(),this.setValue(r,l)}bind(){let r=this.node;const l=this.parsedPath,m=l.objectName,y=l.propertyName;let _=l.propertyIndex;if(r||(r=dr.findNode(this.rootNode,l.nodeName),this.node=r),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!r){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(m){let N=l.objectIndex;switch(m){case"materials":if(!r.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!r.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}r=r.material.materials;break;case"bones":if(!r.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}r=r.skeleton.bones;for(let V=0;V<r.length;V++)if(r[V].name===N){N=V;break}break;case"map":if("map"in r){r=r.map;break}if(!r.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!r.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}r=r.material.map;break;default:if(r[m]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}r=r[m]}if(N!==void 0){if(r[N]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,r);return}r=r[N]}}const R=r[y];if(R===void 0){const N=l.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+N+"."+y+" but it wasn't found.",r);return}let I=this.Versioning.None;this.targetObject=r,r.needsUpdate!==void 0?I=this.Versioning.NeedsUpdate:r.matrixWorldNeedsUpdate!==void 0&&(I=this.Versioning.MatrixWorldNeedsUpdate);let O=this.BindingType.Direct;if(_!==void 0){if(y==="morphTargetInfluences"){if(!r.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!r.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}r.morphTargetDictionary[_]!==void 0&&(_=r.morphTargetDictionary[_])}O=this.BindingType.ArrayElement,this.resolvedProperty=R,this.propertyIndex=_}else R.fromArray!==void 0&&R.toArray!==void 0?(O=this.BindingType.HasFromToArray,this.resolvedProperty=R):Array.isArray(R)?(O=this.BindingType.EntireArray,this.resolvedProperty=R):this.propertyName=y;this.getValue=this.GetterByBindingType[O],this.setValue=this.SetterByBindingTypeAndVersioning[O][I]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}dr.Composite=t5,dr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},dr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},dr.prototype.GetterByBindingType=[dr.prototype._getValue_direct,dr.prototype._getValue_array,dr.prototype._getValue_arrayElement,dr.prototype._getValue_toArray],dr.prototype.SetterByBindingTypeAndVersioning=[[dr.prototype._setValue_direct,dr.prototype._setValue_direct_setNeedsUpdate,dr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[dr.prototype._setValue_array,dr.prototype._setValue_array_setNeedsUpdate,dr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[dr.prototype._setValue_arrayElement,dr.prototype._setValue_arrayElement_setNeedsUpdate,dr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[dr.prototype._setValue_fromArray,dr.prototype._setValue_fromArray_setNeedsUpdate,dr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class n5{constructor(){this.isAnimationObjectGroup=!0,this.uuid=no(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const r={};this._indicesByUUID=r;for(let m=0,y=arguments.length;m!==y;++m)r[arguments[m].uuid]=m;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const l=this;this.stats={objects:{get total(){return l._objects.length},get inUse(){return this.total-l.nCachedObjects_}},get bindingsPerObject(){return l._bindings.length}}}add(){const r=this._objects,l=this._indicesByUUID,m=this._paths,y=this._parsedPaths,_=this._bindings,R=_.length;let I,O=r.length,N=this.nCachedObjects_;for(let V=0,Q=arguments.length;V!==Q;++V){const X=arguments[V],$=X.uuid;let ie=l[$];if(ie===void 0){ie=O++,l[$]=ie,r.push(X);for(let ue=0,re=R;ue!==re;++ue)_[ue].push(new dr(X,m[ue],y[ue]))}else if(ie<N){I=r[ie];const ue=--N,re=r[ue];l[re.uuid]=ie,r[ie]=re,l[$]=ue,r[ue]=X;for(let q=0,Se=R;q!==Se;++q){const fe=_[q],Me=fe[ue];let ze=fe[ie];fe[ie]=Me,ze===void 0&&(ze=new dr(X,m[q],y[q])),fe[ue]=ze}}else r[ie]!==I&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=N}remove(){const r=this._objects,l=this._indicesByUUID,m=this._bindings,y=m.length;let _=this.nCachedObjects_;for(let R=0,I=arguments.length;R!==I;++R){const O=arguments[R],N=O.uuid,V=l[N];if(V!==void 0&&V>=_){const Q=_++,X=r[Q];l[X.uuid]=V,r[V]=X,l[N]=Q,r[Q]=O;for(let $=0,ie=y;$!==ie;++$){const ue=m[$],re=ue[Q],q=ue[V];ue[V]=re,ue[Q]=q}}}this.nCachedObjects_=_}uncache(){const r=this._objects,l=this._indicesByUUID,m=this._bindings,y=m.length;let _=this.nCachedObjects_,R=r.length;for(let I=0,O=arguments.length;I!==O;++I){const N=arguments[I],V=N.uuid,Q=l[V];if(Q!==void 0)if(delete l[V],Q<_){const X=--_,$=r[X],ie=--R,ue=r[ie];l[$.uuid]=Q,r[Q]=$,l[ue.uuid]=X,r[X]=ue,r.pop();for(let re=0,q=y;re!==q;++re){const Se=m[re],fe=Se[X],Me=Se[ie];Se[Q]=fe,Se[X]=Me,Se.pop()}}else{const X=--R,$=r[X];X>0&&(l[$.uuid]=Q),r[Q]=$,r.pop();for(let ie=0,ue=y;ie!==ue;++ie){const re=m[ie];re[Q]=re[X],re.pop()}}}this.nCachedObjects_=_}subscribe_(r,l){const m=this._bindingsIndicesByPath;let y=m[r];const _=this._bindings;if(y!==void 0)return _[y];const R=this._paths,I=this._parsedPaths,O=this._objects,N=O.length,V=this.nCachedObjects_,Q=new Array(N);y=_.length,m[r]=y,R.push(r),I.push(l),_.push(Q);for(let X=V,$=O.length;X!==$;++X){const ie=O[X];Q[X]=new dr(ie,r,l)}return Q}unsubscribe_(r){const l=this._bindingsIndicesByPath,m=l[r];if(m!==void 0){const y=this._paths,_=this._parsedPaths,R=this._bindings,I=R.length-1,O=R[I],N=r[I];l[N]=m,R[m]=O,R.pop(),_[m]=_[I],_.pop(),y[m]=y[I],y.pop()}}}class j2{constructor(r,l,m=null,y=l.blendMode){this._mixer=r,this._clip=l,this._localRoot=m,this.blendMode=y;const _=l.tracks,R=_.length,I=new Array(R),O={endingStart:ai,endingEnd:ai};for(let N=0;N!==R;++N){const V=_[N].createInterpolant(null);I[N]=V,V.settings=O}this._interpolantSettings=O,this._interpolants=I,this._propertyBindings=new Array(R),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=bn,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(r){return this._startTime=r,this}setLoop(r,l){return this.loop=r,this.repetitions=l,this}setEffectiveWeight(r){return this.weight=r,this._effectiveWeight=this.enabled?r:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(r){return this._scheduleFading(r,0,1)}fadeOut(r){return this._scheduleFading(r,1,0)}crossFadeFrom(r,l,m){if(r.fadeOut(l),this.fadeIn(l),m){const y=this._clip.duration,_=r._clip.duration,R=_/y,I=y/_;r.warp(1,R,l),this.warp(I,1,l)}return this}crossFadeTo(r,l,m){return r.crossFadeFrom(this,l,m)}stopFading(){const r=this._weightInterpolant;return r!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this}setEffectiveTimeScale(r){return this.timeScale=r,this._effectiveTimeScale=this.paused?0:r,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(r){return this.timeScale=this._clip.duration/r,this.stopWarping()}syncWith(r){return this.time=r.time,this.timeScale=r.timeScale,this.stopWarping()}halt(r){return this.warp(this._effectiveTimeScale,0,r)}warp(r,l,m){const y=this._mixer,_=y.time,R=this.timeScale;let I=this._timeScaleInterpolant;I===null&&(I=y._lendControlInterpolant(),this._timeScaleInterpolant=I);const O=I.parameterPositions,N=I.sampleValues;return O[0]=_,O[1]=_+m,N[0]=r/R,N[1]=l/R,this}stopWarping(){const r=this._timeScaleInterpolant;return r!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(r,l,m,y){if(!this.enabled){this._updateWeight(r);return}const _=this._startTime;if(_!==null){const O=(r-_)*m;O<0||m===0?l=0:(this._startTime=null,l=m*O)}l*=this._updateTimeScale(r);const R=this._updateTime(l),I=this._updateWeight(r);if(I>0){const O=this._interpolants,N=this._propertyBindings;switch(this.blendMode){case hr:for(let V=0,Q=O.length;V!==Q;++V)O[V].evaluate(R),N[V].accumulateAdditive(I);break;case Bi:default:for(let V=0,Q=O.length;V!==Q;++V)O[V].evaluate(R),N[V].accumulate(y,I)}}}_updateWeight(r){let l=0;if(this.enabled){l=this.weight;const m=this._weightInterpolant;if(m!==null){const y=m.evaluate(r)[0];l*=y,r>m.parameterPositions[1]&&(this.stopFading(),y===0&&(this.enabled=!1))}}return this._effectiveWeight=l,l}_updateTimeScale(r){let l=0;if(!this.paused){l=this.timeScale;const m=this._timeScaleInterpolant;if(m!==null){const y=m.evaluate(r)[0];l*=y,r>m.parameterPositions[1]&&(this.stopWarping(),l===0?this.paused=!0:this.timeScale=l)}}return this._effectiveTimeScale=l,l}_updateTime(r){const l=this._clip.duration,m=this.loop;let y=this.time+r,_=this._loopCount;const R=m===oi;if(r===0)return _===-1?y:R&&(_&1)===1?l-y:y;if(m===kt){_===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));n:{if(y>=l)y=l;else if(y<0)y=0;else{this.time=y;break n}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=y,this._mixer.dispatchEvent({type:"finished",action:this,direction:r<0?-1:1})}}else{if(_===-1&&(r>=0?(_=0,this._setEndings(!0,this.repetitions===0,R)):this._setEndings(this.repetitions===0,!0,R)),y>=l||y<0){const I=Math.floor(y/l);y-=l*I,_+=Math.abs(I);const O=this.repetitions-_;if(O<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,y=r>0?l:0,this.time=y,this._mixer.dispatchEvent({type:"finished",action:this,direction:r>0?1:-1});else{if(O===1){const N=r<0;this._setEndings(N,!N,R)}else this._setEndings(!1,!1,R);this._loopCount=_,this.time=y,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:I})}}else this.time=y;if(R&&(_&1)===1)return l-y}return y}_setEndings(r,l,m){const y=this._interpolantSettings;m?(y.endingStart=li,y.endingEnd=li):(r?y.endingStart=this.zeroSlopeAtStart?li:ai:y.endingStart=xi,l?y.endingEnd=this.zeroSlopeAtEnd?li:ai:y.endingEnd=xi)}_scheduleFading(r,l,m){const y=this._mixer,_=y.time;let R=this._weightInterpolant;R===null&&(R=y._lendControlInterpolant(),this._weightInterpolant=R);const I=R.parameterPositions,O=R.sampleValues;return I[0]=_,O[0]=l,I[1]=_+r,O[1]=m,this}}const i5=new Float32Array(1);class r5 extends to{constructor(r){super(),this._root=r,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(r,l){const m=r._localRoot||this._root,y=r._clip.tracks,_=y.length,R=r._propertyBindings,I=r._interpolants,O=m.uuid,N=this._bindingsByRootAndName;let V=N[O];V===void 0&&(V={},N[O]=V);for(let Q=0;Q!==_;++Q){const X=y[Q],$=X.name;let ie=V[$];if(ie!==void 0)++ie.referenceCount,R[Q]=ie;else{if(ie=R[Q],ie!==void 0){ie._cacheIndex===null&&(++ie.referenceCount,this._addInactiveBinding(ie,O,$));continue}const ue=l&&l._propertyBindings[Q].binding.parsedPath;ie=new H2(dr.create(m,$,ue),X.ValueTypeName,X.getValueSize()),++ie.referenceCount,this._addInactiveBinding(ie,O,$),R[Q]=ie}I[Q].resultBuffer=ie.buffer}}_activateAction(r){if(!this._isActiveAction(r)){if(r._cacheIndex===null){const m=(r._localRoot||this._root).uuid,y=r._clip.uuid,_=this._actionsByClip[y];this._bindAction(r,_&&_.knownActions[0]),this._addInactiveAction(r,y,m)}const l=r._propertyBindings;for(let m=0,y=l.length;m!==y;++m){const _=l[m];_.useCount++===0&&(this._lendBinding(_),_.saveOriginalState())}this._lendAction(r)}}_deactivateAction(r){if(this._isActiveAction(r)){const l=r._propertyBindings;for(let m=0,y=l.length;m!==y;++m){const _=l[m];--_.useCount===0&&(_.restoreOriginalState(),this._takeBackBinding(_))}this._takeBackAction(r)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const r=this;this.stats={actions:{get total(){return r._actions.length},get inUse(){return r._nActiveActions}},bindings:{get total(){return r._bindings.length},get inUse(){return r._nActiveBindings}},controlInterpolants:{get total(){return r._controlInterpolants.length},get inUse(){return r._nActiveControlInterpolants}}}}_isActiveAction(r){const l=r._cacheIndex;return l!==null&&l<this._nActiveActions}_addInactiveAction(r,l,m){const y=this._actions,_=this._actionsByClip;let R=_[l];if(R===void 0)R={knownActions:[r],actionByRoot:{}},r._byClipCacheIndex=0,_[l]=R;else{const I=R.knownActions;r._byClipCacheIndex=I.length,I.push(r)}r._cacheIndex=y.length,y.push(r),R.actionByRoot[m]=r}_removeInactiveAction(r){const l=this._actions,m=l[l.length-1],y=r._cacheIndex;m._cacheIndex=y,l[y]=m,l.pop(),r._cacheIndex=null;const _=r._clip.uuid,R=this._actionsByClip,I=R[_],O=I.knownActions,N=O[O.length-1],V=r._byClipCacheIndex;N._byClipCacheIndex=V,O[V]=N,O.pop(),r._byClipCacheIndex=null;const Q=I.actionByRoot,X=(r._localRoot||this._root).uuid;delete Q[X],O.length===0&&delete R[_],this._removeInactiveBindingsForAction(r)}_removeInactiveBindingsForAction(r){const l=r._propertyBindings;for(let m=0,y=l.length;m!==y;++m){const _=l[m];--_.referenceCount===0&&this._removeInactiveBinding(_)}}_lendAction(r){const l=this._actions,m=r._cacheIndex,y=this._nActiveActions++,_=l[y];r._cacheIndex=y,l[y]=r,_._cacheIndex=m,l[m]=_}_takeBackAction(r){const l=this._actions,m=r._cacheIndex,y=--this._nActiveActions,_=l[y];r._cacheIndex=y,l[y]=r,_._cacheIndex=m,l[m]=_}_addInactiveBinding(r,l,m){const y=this._bindingsByRootAndName,_=this._bindings;let R=y[l];R===void 0&&(R={},y[l]=R),R[m]=r,r._cacheIndex=_.length,_.push(r)}_removeInactiveBinding(r){const l=this._bindings,m=r.binding,y=m.rootNode.uuid,_=m.path,R=this._bindingsByRootAndName,I=R[y],O=l[l.length-1],N=r._cacheIndex;O._cacheIndex=N,l[N]=O,l.pop(),delete I[_],Object.keys(I).length===0&&delete R[y]}_lendBinding(r){const l=this._bindings,m=r._cacheIndex,y=this._nActiveBindings++,_=l[y];r._cacheIndex=y,l[y]=r,_._cacheIndex=m,l[m]=_}_takeBackBinding(r){const l=this._bindings,m=r._cacheIndex,y=--this._nActiveBindings,_=l[y];r._cacheIndex=y,l[y]=r,_._cacheIndex=m,l[m]=_}_lendControlInterpolant(){const r=this._controlInterpolants,l=this._nActiveControlInterpolants++;let m=r[l];return m===void 0&&(m=new Ux(new Float32Array(2),new Float32Array(2),1,i5),m.__cacheIndex=l,r[l]=m),m}_takeBackControlInterpolant(r){const l=this._controlInterpolants,m=r.__cacheIndex,y=--this._nActiveControlInterpolants,_=l[y];r.__cacheIndex=y,l[y]=r,_.__cacheIndex=m,l[m]=_}clipAction(r,l,m){const y=l||this._root,_=y.uuid;let R=typeof r=="string"?rp.findByName(y,r):r;const I=R!==null?R.uuid:r,O=this._actionsByClip[I];let N=null;if(m===void 0&&(R!==null?m=R.blendMode:m=Bi),O!==void 0){const Q=O.actionByRoot[_];if(Q!==void 0&&Q.blendMode===m)return Q;N=O.knownActions[0],R===null&&(R=N._clip)}if(R===null)return null;const V=new j2(this,R,l,m);return this._bindAction(V,N),this._addInactiveAction(V,I,_),V}existingAction(r,l){const m=l||this._root,y=m.uuid,_=typeof r=="string"?rp.findByName(m,r):r,R=_?_.uuid:r,I=this._actionsByClip[R];return I!==void 0&&I.actionByRoot[y]||null}stopAllAction(){const r=this._actions,l=this._nActiveActions;for(let m=l-1;m>=0;--m)r[m].stop();return this}update(r){r*=this.timeScale;const l=this._actions,m=this._nActiveActions,y=this.time+=r,_=Math.sign(r),R=this._accuIndex^=1;for(let N=0;N!==m;++N)l[N]._update(y,r,_,R);const I=this._bindings,O=this._nActiveBindings;for(let N=0;N!==O;++N)I[N].apply(R);return this}setTime(r){this.time=0;for(let l=0;l<this._actions.length;l++)this._actions[l].time=0;return this.update(r)}getRoot(){return this._root}uncacheClip(r){const l=this._actions,m=r.uuid,y=this._actionsByClip,_=y[m];if(_!==void 0){const R=_.knownActions;for(let I=0,O=R.length;I!==O;++I){const N=R[I];this._deactivateAction(N);const V=N._cacheIndex,Q=l[l.length-1];N._cacheIndex=null,N._byClipCacheIndex=null,Q._cacheIndex=V,l[V]=Q,l.pop(),this._removeInactiveBindingsForAction(N)}delete y[m]}}uncacheRoot(r){const l=r.uuid,m=this._actionsByClip;for(const R in m){const I=m[R].actionByRoot,O=I[l];O!==void 0&&(this._deactivateAction(O),this._removeInactiveAction(O))}const y=this._bindingsByRootAndName,_=y[l];if(_!==void 0)for(const R in _){const I=_[R];I.restoreOriginalState(),this._removeInactiveBinding(I)}}uncacheAction(r,l){const m=this.existingAction(r,l);m!==null&&(this._deactivateAction(m),this._removeInactiveAction(m))}}class Kx{constructor(r){this.value=r}clone(){return new Kx(this.value.clone===void 0?this.value:this.value.clone())}}let s5=0;class o5 extends to{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:s5++}),this.name="",this.usage=ah,this.uniforms=[]}add(r){return this.uniforms.push(r),this}remove(r){const l=this.uniforms.indexOf(r);return l!==-1&&this.uniforms.splice(l,1),this}setName(r){return this.name=r,this}setUsage(r){return this.usage=r,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(r){this.name=r.name,this.usage=r.usage;const l=r.uniforms;this.uniforms.length=0;for(let m=0,y=l.length;m<y;m++)this.uniforms.push(l[m].clone());return this}clone(){return new this.constructor().copy(this)}}class a5 extends Eg{constructor(r,l,m=1){super(r,l),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=m}copy(r){return super.copy(r),this.meshPerAttribute=r.meshPerAttribute,this}clone(r){const l=super.clone(r);return l.meshPerAttribute=this.meshPerAttribute,l}toJSON(r){const l=super.toJSON(r);return l.isInstancedInterleavedBuffer=!0,l.meshPerAttribute=this.meshPerAttribute,l}}class l5{constructor(r,l,m,y,_){this.isGLBufferAttribute=!0,this.name="",this.buffer=r,this.type=l,this.itemSize=m,this.elementSize=y,this.count=_,this.version=0}set needsUpdate(r){r===!0&&this.version++}setBuffer(r){return this.buffer=r,this}setType(r,l){return this.type=r,this.elementSize=l,this}setItemSize(r){return this.itemSize=r,this}setCount(r){return this.count=r,this}}class c5{constructor(r,l,m=0,y=1/0){this.ray=new Vs(r,l),this.near=m,this.far=y,this.camera=null,this.layers=new Jm,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(r,l){this.ray.set(r,l)}setFromCamera(r,l){l.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(l.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(l).sub(this.ray.origin).normalize(),this.camera=l):l.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(l.near+l.far)/(l.near-l.far)).unproject(l),this.ray.direction.set(0,0,-1).transformDirection(l.matrixWorld),this.camera=l):console.error("THREE.Raycaster: Unsupported camera type: "+l.type)}intersectObject(r,l=!0,m=[]){return qx(r,this,m,l),m.sort(W2),m}intersectObjects(r,l=!0,m=[]){for(let y=0,_=r.length;y<_;y++)qx(r[y],this,m,l);return m.sort(W2),m}}function W2(w,r){return w.distance-r.distance}function qx(w,r,l,m){if(w.layers.test(r.layers)&&w.raycast(r,l),m===!0){const y=w.children;for(let _=0,R=y.length;_<R;_++)qx(y[_],r,l,!0)}}class h5{constructor(r=1,l=0,m=0){return this.radius=r,this.phi=l,this.theta=m,this}set(r,l,m){return this.radius=r,this.phi=l,this.theta=m,this}copy(r){return this.radius=r.radius,this.phi=r.phi,this.theta=r.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(r){return this.setFromCartesianCoords(r.x,r.y,r.z)}setFromCartesianCoords(r,l,m){return this.radius=Math.sqrt(r*r+l*l+m*m),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(r,m),this.phi=Math.acos(Nr(l/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class u5{constructor(r=1,l=0,m=0){return this.radius=r,this.theta=l,this.y=m,this}set(r,l,m){return this.radius=r,this.theta=l,this.y=m,this}copy(r){return this.radius=r.radius,this.theta=r.theta,this.y=r.y,this}setFromVector3(r){return this.setFromCartesianCoords(r.x,r.y,r.z)}setFromCartesianCoords(r,l,m){return this.radius=Math.sqrt(r*r+m*m),this.theta=Math.atan2(r,m),this.y=l,this}clone(){return new this.constructor().copy(this)}}const Q2=new en;class d5{constructor(r=new en(1/0,1/0),l=new en(-1/0,-1/0)){this.isBox2=!0,this.min=r,this.max=l}set(r,l){return this.min.copy(r),this.max.copy(l),this}setFromPoints(r){this.makeEmpty();for(let l=0,m=r.length;l<m;l++)this.expandByPoint(r[l]);return this}setFromCenterAndSize(r,l){const m=Q2.copy(l).multiplyScalar(.5);return this.min.copy(r).sub(m),this.max.copy(r).add(m),this}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(r){return this.isEmpty()?r.set(0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y}getParameter(r,l){return l.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y)}clampPoint(r,l){return l.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return this.clampPoint(r,Q2).distanceTo(r)}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}}const X2=new je,nA=new je;class f5{constructor(r=new je,l=new je){this.start=r,this.end=l}set(r,l){return this.start.copy(r),this.end.copy(l),this}copy(r){return this.start.copy(r.start),this.end.copy(r.end),this}getCenter(r){return r.addVectors(this.start,this.end).multiplyScalar(.5)}delta(r){return r.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(r,l){return this.delta(l).multiplyScalar(r).add(this.start)}closestPointToPointParameter(r,l){X2.subVectors(r,this.start),nA.subVectors(this.end,this.start);const m=nA.dot(nA);let _=nA.dot(X2)/m;return l&&(_=Nr(_,0,1)),_}closestPointToPoint(r,l,m){const y=this.closestPointToPointParameter(r,l);return this.delta(m).multiplyScalar(y).add(this.start)}applyMatrix4(r){return this.start.applyMatrix4(r),this.end.applyMatrix4(r),this}equals(r){return r.start.equals(this.start)&&r.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const K2=new je;class p5 extends mr{constructor(r,l){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=l,this.type="SpotLightHelper";const m=new Yi,y=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let R=0,I=1,O=32;R<O;R++,I++){const N=R/O*Math.PI*2,V=I/O*Math.PI*2;y.push(Math.cos(N),Math.sin(N),1,Math.cos(V),Math.sin(V),1)}m.setAttribute("position",new ni(y,3));const _=new oo({fog:!1,toneMapped:!1});this.cone=new qa(m,_),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const r=this.light.distance?this.light.distance:1e3,l=r*Math.tan(this.light.angle);this.cone.scale.set(l,l,r),K2.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(K2),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const gc=new je,iA=new _i,Yx=new _i;class m5 extends qa{constructor(r){const l=q2(r),m=new Yi,y=[],_=[],R=new Hn(0,0,1),I=new Hn(0,1,0);for(let N=0;N<l.length;N++){const V=l[N];V.parent&&V.parent.isBone&&(y.push(0,0,0),y.push(0,0,0),_.push(R.r,R.g,R.b),_.push(I.r,I.g,I.b))}m.setAttribute("position",new ni(y,3)),m.setAttribute("color",new ni(_,3));const O=new oo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(m,O),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=r,this.bones=l,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(r){const l=this.bones,m=this.geometry,y=m.getAttribute("position");Yx.copy(this.root.matrixWorld).invert();for(let _=0,R=0;_<l.length;_++){const I=l[_];I.parent&&I.parent.isBone&&(iA.multiplyMatrices(Yx,I.matrixWorld),gc.setFromMatrixPosition(iA),y.setXYZ(R,gc.x,gc.y,gc.z),iA.multiplyMatrices(Yx,I.parent.matrixWorld),gc.setFromMatrixPosition(iA),y.setXYZ(R+1,gc.x,gc.y,gc.z),R+=2)}m.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(r)}dispose(){this.geometry.dispose(),this.material.dispose()}}function q2(w){const r=[];w.isBone===!0&&r.push(w);for(let l=0;l<w.children.length;l++)r.push.apply(r,q2(w.children[l]));return r}class g5 extends Os{constructor(r,l,m){const y=new ep(l,4,2),_=new uc({wireframe:!0,fog:!1,toneMapped:!1});super(y,_),this.light=r,this.color=m,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const A5=new je,Y2=new Hn,$2=new Hn;class v5 extends mr{constructor(r,l,m){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=m,this.type="HemisphereLightHelper";const y=new Zf(l);y.rotateY(Math.PI*.5),this.material=new uc({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const _=y.getAttribute("position"),R=new Float32Array(_.count*3);y.setAttribute("color",new Sr(R,3)),this.add(new Os(y,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const r=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const l=r.geometry.getAttribute("color");Y2.copy(this.light.color),$2.copy(this.light.groundColor);for(let m=0,y=l.count;m<y;m++){const _=m<y/2?Y2:$2;l.setXYZ(m,_.r,_.g,_.b)}l.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),r.lookAt(A5.setFromMatrixPosition(this.light.matrixWorld).negate())}}class y5 extends qa{constructor(r=10,l=10,m=4473924,y=8947848){m=new Hn(m),y=new Hn(y);const _=l/2,R=r/l,I=r/2,O=[],N=[];for(let X=0,$=0,ie=-I;X<=l;X++,ie+=R){O.push(-I,0,ie,I,0,ie),O.push(ie,0,-I,ie,0,I);const ue=X===_?m:y;ue.toArray(N,$),$+=3,ue.toArray(N,$),$+=3,ue.toArray(N,$),$+=3,ue.toArray(N,$),$+=3}const V=new Yi;V.setAttribute("position",new ni(O,3)),V.setAttribute("color",new ni(N,3));const Q=new oo({vertexColors:!0,toneMapped:!1});super(V,Q),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class x5 extends qa{constructor(r=10,l=16,m=8,y=64,_=4473924,R=8947848){_=new Hn(_),R=new Hn(R);const I=[],O=[];if(l>1)for(let Q=0;Q<l;Q++){const X=Q/l*(Math.PI*2),$=Math.sin(X)*r,ie=Math.cos(X)*r;I.push(0,0,0),I.push($,0,ie);const ue=Q&1?_:R;O.push(ue.r,ue.g,ue.b),O.push(ue.r,ue.g,ue.b)}for(let Q=0;Q<m;Q++){const X=Q&1?_:R,$=r-r/m*Q;for(let ie=0;ie<y;ie++){let ue=ie/y*(Math.PI*2),re=Math.sin(ue)*$,q=Math.cos(ue)*$;I.push(re,0,q),O.push(X.r,X.g,X.b),ue=(ie+1)/y*(Math.PI*2),re=Math.sin(ue)*$,q=Math.cos(ue)*$,I.push(re,0,q),O.push(X.r,X.g,X.b)}}const N=new Yi;N.setAttribute("position",new ni(I,3)),N.setAttribute("color",new ni(O,3));const V=new oo({vertexColors:!0,toneMapped:!1});super(N,V),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const J2=new je,rA=new je,Z2=new je;class E5 extends mr{constructor(r,l,m){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=m,this.type="DirectionalLightHelper",l===void 0&&(l=1);let y=new Yi;y.setAttribute("position",new ni([-l,l,0,l,l,0,l,-l,0,-l,-l,0,-l,l,0],3));const _=new oo({fog:!1,toneMapped:!1});this.lightPlane=new fc(y,_),this.add(this.lightPlane),y=new Yi,y.setAttribute("position",new ni([0,0,0,0,0,1],3)),this.targetLine=new fc(y,_),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),J2.setFromMatrixPosition(this.light.matrixWorld),rA.setFromMatrixPosition(this.light.target.matrixWorld),Z2.subVectors(rA,J2),this.lightPlane.lookAt(rA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(rA),this.targetLine.scale.z=Z2.length()}}const sA=new je,Qr=new ug;class b5 extends qa{constructor(r){const l=new Yi,m=new oo({color:16777215,vertexColors:!0,toneMapped:!1}),y=[],_=[],R={};I("n1","n2"),I("n2","n4"),I("n4","n3"),I("n3","n1"),I("f1","f2"),I("f2","f4"),I("f4","f3"),I("f3","f1"),I("n1","f1"),I("n2","f2"),I("n3","f3"),I("n4","f4"),I("p","n1"),I("p","n2"),I("p","n3"),I("p","n4"),I("u1","u2"),I("u2","u3"),I("u3","u1"),I("c","t"),I("p","c"),I("cn1","cn2"),I("cn3","cn4"),I("cf1","cf2"),I("cf3","cf4");function I(ie,ue){O(ie),O(ue)}function O(ie){y.push(0,0,0),_.push(0,0,0),R[ie]===void 0&&(R[ie]=[]),R[ie].push(y.length/3-1)}l.setAttribute("position",new ni(y,3)),l.setAttribute("color",new ni(_,3)),super(l,m),this.type="CameraHelper",this.camera=r,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=R,this.update();const N=new Hn(16755200),V=new Hn(16711680),Q=new Hn(43775),X=new Hn(16777215),$=new Hn(3355443);this.setColors(N,V,Q,X,$)}setColors(r,l,m,y,_){const I=this.geometry.getAttribute("color");I.setXYZ(0,r.r,r.g,r.b),I.setXYZ(1,r.r,r.g,r.b),I.setXYZ(2,r.r,r.g,r.b),I.setXYZ(3,r.r,r.g,r.b),I.setXYZ(4,r.r,r.g,r.b),I.setXYZ(5,r.r,r.g,r.b),I.setXYZ(6,r.r,r.g,r.b),I.setXYZ(7,r.r,r.g,r.b),I.setXYZ(8,r.r,r.g,r.b),I.setXYZ(9,r.r,r.g,r.b),I.setXYZ(10,r.r,r.g,r.b),I.setXYZ(11,r.r,r.g,r.b),I.setXYZ(12,r.r,r.g,r.b),I.setXYZ(13,r.r,r.g,r.b),I.setXYZ(14,r.r,r.g,r.b),I.setXYZ(15,r.r,r.g,r.b),I.setXYZ(16,r.r,r.g,r.b),I.setXYZ(17,r.r,r.g,r.b),I.setXYZ(18,r.r,r.g,r.b),I.setXYZ(19,r.r,r.g,r.b),I.setXYZ(20,r.r,r.g,r.b),I.setXYZ(21,r.r,r.g,r.b),I.setXYZ(22,r.r,r.g,r.b),I.setXYZ(23,r.r,r.g,r.b),I.setXYZ(24,l.r,l.g,l.b),I.setXYZ(25,l.r,l.g,l.b),I.setXYZ(26,l.r,l.g,l.b),I.setXYZ(27,l.r,l.g,l.b),I.setXYZ(28,l.r,l.g,l.b),I.setXYZ(29,l.r,l.g,l.b),I.setXYZ(30,l.r,l.g,l.b),I.setXYZ(31,l.r,l.g,l.b),I.setXYZ(32,m.r,m.g,m.b),I.setXYZ(33,m.r,m.g,m.b),I.setXYZ(34,m.r,m.g,m.b),I.setXYZ(35,m.r,m.g,m.b),I.setXYZ(36,m.r,m.g,m.b),I.setXYZ(37,m.r,m.g,m.b),I.setXYZ(38,y.r,y.g,y.b),I.setXYZ(39,y.r,y.g,y.b),I.setXYZ(40,_.r,_.g,_.b),I.setXYZ(41,_.r,_.g,_.b),I.setXYZ(42,_.r,_.g,_.b),I.setXYZ(43,_.r,_.g,_.b),I.setXYZ(44,_.r,_.g,_.b),I.setXYZ(45,_.r,_.g,_.b),I.setXYZ(46,_.r,_.g,_.b),I.setXYZ(47,_.r,_.g,_.b),I.setXYZ(48,_.r,_.g,_.b),I.setXYZ(49,_.r,_.g,_.b),I.needsUpdate=!0}update(){const r=this.geometry,l=this.pointMap,m=1,y=1;Qr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Yr("c",l,r,Qr,0,0,-1),Yr("t",l,r,Qr,0,0,1),Yr("n1",l,r,Qr,-m,-y,-1),Yr("n2",l,r,Qr,m,-y,-1),Yr("n3",l,r,Qr,-m,y,-1),Yr("n4",l,r,Qr,m,y,-1),Yr("f1",l,r,Qr,-m,-y,1),Yr("f2",l,r,Qr,m,-y,1),Yr("f3",l,r,Qr,-m,y,1),Yr("f4",l,r,Qr,m,y,1),Yr("u1",l,r,Qr,m*.7,y*1.1,-1),Yr("u2",l,r,Qr,-m*.7,y*1.1,-1),Yr("u3",l,r,Qr,0,y*2,-1),Yr("cf1",l,r,Qr,-m,0,1),Yr("cf2",l,r,Qr,m,0,1),Yr("cf3",l,r,Qr,0,-y,1),Yr("cf4",l,r,Qr,0,y,1),Yr("cn1",l,r,Qr,-m,0,-1),Yr("cn2",l,r,Qr,m,0,-1),Yr("cn3",l,r,Qr,0,-y,-1),Yr("cn4",l,r,Qr,0,y,-1),r.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Yr(w,r,l,m,y,_,R){sA.set(y,_,R).unproject(m);const I=r[w];if(I!==void 0){const O=l.getAttribute("position");for(let N=0,V=I.length;N<V;N++)O.setXYZ(I[N],sA.x,sA.y,sA.z)}}const oA=new er;class _5 extends qa{constructor(r,l=16776960){const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),y=new Float32Array(8*3),_=new Yi;_.setIndex(new Sr(m,1)),_.setAttribute("position",new Sr(y,3)),super(_,new oo({color:l,toneMapped:!1})),this.object=r,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(r){if(r!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&oA.setFromObject(this.object),oA.isEmpty())return;const l=oA.min,m=oA.max,y=this.geometry.attributes.position,_=y.array;_[0]=m.x,_[1]=m.y,_[2]=m.z,_[3]=l.x,_[4]=m.y,_[5]=m.z,_[6]=l.x,_[7]=l.y,_[8]=m.z,_[9]=m.x,_[10]=l.y,_[11]=m.z,_[12]=m.x,_[13]=m.y,_[14]=l.z,_[15]=l.x,_[16]=m.y,_[17]=l.z,_[18]=l.x,_[19]=l.y,_[20]=l.z,_[21]=m.x,_[22]=l.y,_[23]=l.z,y.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(r){return this.object=r,this.update(),this}copy(r,l){return super.copy(r,l),this.object=r.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class w5 extends qa{constructor(r,l=16776960){const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),y=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],_=new Yi;_.setIndex(new Sr(m,1)),_.setAttribute("position",new ni(y,3)),super(_,new oo({color:l,toneMapped:!1})),this.box=r,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(r){const l=this.box;l.isEmpty()||(l.getCenter(this.position),l.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(r))}dispose(){this.geometry.dispose(),this.material.dispose()}}class M5 extends fc{constructor(r,l=1,m=16776960){const y=m,_=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],R=new Yi;R.setAttribute("position",new ni(_,3)),R.computeBoundingSphere(),super(R,new oo({color:y,toneMapped:!1})),this.type="PlaneHelper",this.plane=r,this.size=l;const I=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],O=new Yi;O.setAttribute("position",new ni(I,3)),O.computeBoundingSphere(),this.add(new Os(O,new uc({color:y,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(r){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(r)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const eC=new je;let aA,$x;class C5 extends mr{constructor(r=new je(0,0,1),l=new je(0,0,0),m=1,y=16776960,_=m*.2,R=_*.2){super(),this.type="ArrowHelper",aA===void 0&&(aA=new Yi,aA.setAttribute("position",new ni([0,0,0,0,1,0],3)),$x=new Hu(0,.5,1,5,1),$x.translate(0,-.5,0)),this.position.copy(l),this.line=new fc(aA,new oo({color:y,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Os($x,new uc({color:y,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(r),this.setLength(m,_,R)}setDirection(r){if(r.y>.99999)this.quaternion.set(0,0,0,1);else if(r.y<-.99999)this.quaternion.set(1,0,0,0);else{eC.set(r.z,0,-r.x).normalize();const l=Math.acos(r.y);this.quaternion.setFromAxisAngle(eC,l)}}setLength(r,l=r*.2,m=l*.2){this.line.scale.set(1,Math.max(1e-4,r-l),1),this.line.updateMatrix(),this.cone.scale.set(m,l,m),this.cone.position.y=r,this.cone.updateMatrix()}setColor(r){this.line.material.color.set(r),this.cone.material.color.set(r)}copy(r){return super.copy(r,!1),this.line.copy(r.line),this.cone.copy(r.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class S5 extends qa{constructor(r=1){const l=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],m=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],y=new Yi;y.setAttribute("position",new ni(l,3)),y.setAttribute("color",new ni(m,3));const _=new oo({vertexColors:!0,toneMapped:!1});super(y,_),this.type="AxesHelper"}setColors(r,l,m){const y=new Hn,_=this.geometry.attributes.color.array;return y.set(r),y.toArray(_,0),y.toArray(_,3),y.set(l),y.toArray(_,6),y.toArray(_,9),y.set(m),y.toArray(_,12),y.toArray(_,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class T5{constructor(){this.type="ShapePath",this.color=new Hn,this.subPaths=[],this.currentPath=null}moveTo(r,l){return this.currentPath=new Kf,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,l),this}lineTo(r,l){return this.currentPath.lineTo(r,l),this}quadraticCurveTo(r,l,m,y){return this.currentPath.quadraticCurveTo(r,l,m,y),this}bezierCurveTo(r,l,m,y,_,R){return this.currentPath.bezierCurveTo(r,l,m,y,_,R),this}splineThru(r){return this.currentPath.splineThru(r),this}toShapes(r){function l(q){const Se=[];for(let fe=0,Me=q.length;fe<Me;fe++){const ze=q[fe],He=new yh;He.curves=ze.curves,Se.push(He)}return Se}function m(q,Se){const fe=Se.length;let Me=!1;for(let ze=fe-1,He=0;He<fe;ze=He++){let et=Se[ze],st=Se[He],Be=st.x-et.x,Xe=st.y-et.y;if(Math.abs(Xe)>Number.EPSILON){if(Xe<0&&(et=Se[He],Be=-Be,st=Se[ze],Xe=-Xe),q.y<et.y||q.y>st.y)continue;if(q.y===et.y){if(q.x===et.x)return!0}else{const rt=Xe*(q.x-et.x)-Be*(q.y-et.y);if(rt===0)return!0;if(rt<0)continue;Me=!Me}}else{if(q.y!==et.y)continue;if(st.x<=q.x&&q.x<=et.x||et.x<=q.x&&q.x<=st.x)return!0}}return Me}const y=Ya.isClockWise,_=this.subPaths;if(_.length===0)return[];let R,I,O;const N=[];if(_.length===1)return I=_[0],O=new yh,O.curves=I.curves,N.push(O),N;let V=!y(_[0].getPoints());V=r?!V:V;const Q=[],X=[];let $=[],ie=0,ue;X[ie]=void 0,$[ie]=[];for(let q=0,Se=_.length;q<Se;q++)I=_[q],ue=I.getPoints(),R=y(ue),R=r?!R:R,R?(!V&&X[ie]&&ie++,X[ie]={s:new yh,p:ue},X[ie].s.curves=I.curves,V&&ie++,$[ie]=[]):$[ie].push({h:I,p:ue[0]});if(!X[0])return l(_);if(X.length>1){let q=!1,Se=0;for(let fe=0,Me=X.length;fe<Me;fe++)Q[fe]=[];for(let fe=0,Me=X.length;fe<Me;fe++){const ze=$[fe];for(let He=0;He<ze.length;He++){const et=ze[He];let st=!0;for(let Be=0;Be<X.length;Be++)m(et.p,X[Be].p)&&(fe!==Be&&Se++,st?(st=!1,Q[Be].push(et)):q=!0);st&&Q[fe].push(et)}}Se>0&&q===!1&&($=Q)}let re;for(let q=0,Se=X.length;q<Se;q++){O=X[q].s,N.push(O),re=$[q];for(let fe=0,Me=re.length;fe<Me;fe++)O.holes.push(re[fe].h)}return N}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:d}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=d)},"./node_modules/super-three/examples/jsm/libs/ktx-parse.module.js":(c,u,h)=>{h.r(u),h.d(u,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>fn,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>Nt,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>Vt,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>pt,KHR_DF_CHANNEL_RGBSDA_RED:()=>Te,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>zt,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>F,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>B,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>v,KHR_DF_MODEL_ASTC:()=>T,KHR_DF_MODEL_ETC1:()=>M,KHR_DF_MODEL_ETC1S:()=>L,KHR_DF_MODEL_ETC2:()=>C,KHR_DF_MODEL_RGBSDA:()=>S,KHR_DF_MODEL_UNSPECIFIED:()=>E,KHR_DF_PRIMARIES_ACES:()=>Ft,KHR_DF_PRIMARIES_ACESCC:()=>Qt,KHR_DF_PRIMARIES_ADOBERGB:()=>Fe,KHR_DF_PRIMARIES_BT2020:()=>Ze,KHR_DF_PRIMARIES_BT601_EBU:()=>gt,KHR_DF_PRIMARIES_BT601_SMPTE:()=>Tt,KHR_DF_PRIMARIES_BT709:()=>nt,KHR_DF_PRIMARIES_CIEXYZ:()=>mn,KHR_DF_PRIMARIES_DISPLAYP3:()=>vn,KHR_DF_PRIMARIES_NTSC1953:()=>Xt,KHR_DF_PRIMARIES_PAL525:()=>Tn,KHR_DF_PRIMARIES_UNSPECIFIED:()=>$e,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>_e,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>mt,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>Ne,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>Ee,KHR_DF_TRANSFER_ACESCC:()=>Ce,KHR_DF_TRANSFER_ACESCCT:()=>Je,KHR_DF_TRANSFER_ADOBERGB:()=>Oe,KHR_DF_TRANSFER_BT1886:()=>G,KHR_DF_TRANSFER_DCIP3:()=>oe,KHR_DF_TRANSFER_HLG_EOTF:()=>te,KHR_DF_TRANSFER_HLG_OETF:()=>H,KHR_DF_TRANSFER_ITU:()=>K,KHR_DF_TRANSFER_LINEAR:()=>P,KHR_DF_TRANSFER_NTSC:()=>J,KHR_DF_TRANSFER_PAL625_EOTF:()=>Pe,KHR_DF_TRANSFER_PAL_OETF:()=>xe,KHR_DF_TRANSFER_PQ_EOTF:()=>Z,KHR_DF_TRANSFER_PQ_OETF:()=>ee,KHR_DF_TRANSFER_SLOG:()=>z,KHR_DF_TRANSFER_SLOG2:()=>j,KHR_DF_TRANSFER_SRGB:()=>U,KHR_DF_TRANSFER_ST240:()=>me,KHR_DF_TRANSFER_UNSPECIFIED:()=>D,KHR_DF_VENDORID_KHRONOS:()=>b,KHR_DF_VERSION:()=>x,KHR_SUPERCOMPRESSION_BASISLZ:()=>p,KHR_SUPERCOMPRESSION_NONE:()=>f,KHR_SUPERCOMPRESSION_ZLIB:()=>g,KHR_SUPERCOMPRESSION_ZSTD:()=>A,KTX2Container:()=>ll,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>he,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>Pn,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>Wt,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>Lt,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>Zt,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>It,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>ut,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>_t,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>dt,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>If,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>ac,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>gu,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>Nr,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>no,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>uh,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>to,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>lh,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>Xm,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>Vm,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Es,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>Km,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>sc,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>al,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>Wy,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>Iy,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>Sf,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>vr,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>ch,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>By,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>Ui,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>zm,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>km,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>Rf,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>ah,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>Gm,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>jm,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>by,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>Ey,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>jy,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>wy,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>_y,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>oc,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>Cy,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>My,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>hh,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>Ty,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>Sy,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>Wm,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>Cf,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>Ry,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>Qm,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>Yo,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>pu,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>Kr,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>Fy,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>Gy,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>Ye,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>k,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>ne,VK_FORMAT_B8G8R8A8_SINT:()=>be,VK_FORMAT_B8G8R8A8_SNORM:()=>yt,VK_FORMAT_B8G8R8A8_SRGB:()=>Ve,VK_FORMAT_B8G8R8A8_UINT:()=>de,VK_FORMAT_B8G8R8A8_UNORM:()=>ht,VK_FORMAT_B8G8R8_SINT:()=>$n,VK_FORMAT_B8G8R8_SNORM:()=>Ln,VK_FORMAT_B8G8R8_SRGB:()=>Ei,VK_FORMAT_B8G8R8_UINT:()=>Jn,VK_FORMAT_B8G8R8_UNORM:()=>si,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>sh,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>wr,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>rh,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>ih,VK_FORMAT_BC2_SRGB_BLOCK:()=>ay,VK_FORMAT_BC2_UNORM_BLOCK:()=>oh,VK_FORMAT_BC3_SRGB_BLOCK:()=>ly,VK_FORMAT_BC3_UNORM_BLOCK:()=>ol,VK_FORMAT_BC4_SNORM_BLOCK:()=>hy,VK_FORMAT_BC4_UNORM_BLOCK:()=>cy,VK_FORMAT_BC5_SNORM_BLOCK:()=>dy,VK_FORMAT_BC5_UNORM_BLOCK:()=>uy,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>py,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>fy,VK_FORMAT_BC7_SRGB_BLOCK:()=>gy,VK_FORMAT_BC7_UNORM_BLOCK:()=>my,VK_FORMAT_D16_UNORM:()=>Ha,VK_FORMAT_D16_UNORM_S8_UINT:()=>Cr,VK_FORMAT_D24_UNORM_S8_UINT:()=>pr,VK_FORMAT_D32_SFLOAT:()=>ja,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>fu,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>qo,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>Um,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>Nm,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>Fm,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>Om,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>xy,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>yy,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>Dm,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>Mf,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>vy,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>Ay,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>Oy,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>zy,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>zs,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>Tf,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Ni,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>Hm,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>Hy,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>mu,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>en,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>Vy,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>Dy,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>Py,VK_FORMAT_R10X6_UNORM_PACK16:()=>Ly,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>ky,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>Uy,VK_FORMAT_R12X4_UNORM_PACK16:()=>Ny,VK_FORMAT_R16G16B16A16_SFLOAT:()=>ae,VK_FORMAT_R16G16B16A16_SINT:()=>ft,VK_FORMAT_R16G16B16A16_SNORM:()=>Ue,VK_FORMAT_R16G16B16A16_UINT:()=>Ke,VK_FORMAT_R16G16B16A16_UNORM:()=>we,VK_FORMAT_R16G16B16_SFLOAT:()=>pe,VK_FORMAT_R16G16B16_SINT:()=>se,VK_FORMAT_R16G16B16_SNORM:()=>Si,VK_FORMAT_R16G16B16_UINT:()=>Y,VK_FORMAT_R16G16B16_UNORM:()=>zi,VK_FORMAT_R16G16_SFLOAT:()=>Kn,VK_FORMAT_R16G16_SINT:()=>Rn,VK_FORMAT_R16G16_SNORM:()=>nr,VK_FORMAT_R16G16_UINT:()=>Rr,VK_FORMAT_R16G16_UNORM:()=>Zn,VK_FORMAT_R16_SFLOAT:()=>vi,VK_FORMAT_R16_SINT:()=>Cn,VK_FORMAT_R16_SNORM:()=>jn,VK_FORMAT_R16_UINT:()=>di,VK_FORMAT_R16_UNORM:()=>Dn,VK_FORMAT_R32G32B32A32_SFLOAT:()=>oi,VK_FORMAT_R32G32B32A32_SINT:()=>bn,VK_FORMAT_R32G32B32A32_UINT:()=>kt,VK_FORMAT_R32G32B32_SFLOAT:()=>on,VK_FORMAT_R32G32B32_SINT:()=>Yt,VK_FORMAT_R32G32B32_UINT:()=>Dt,VK_FORMAT_R32G32_SFLOAT:()=>xt,VK_FORMAT_R32G32_SINT:()=>tt,VK_FORMAT_R32G32_UINT:()=>Ae,VK_FORMAT_R32_SFLOAT:()=>ge,VK_FORMAT_R32_SINT:()=>ce,VK_FORMAT_R32_UINT:()=>le,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>ke,VK_FORMAT_R4G4_UNORM_PACK8:()=>De,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>W,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>Qe,VK_FORMAT_R64G64B64A64_SFLOAT:()=>eo,VK_FORMAT_R64G64B64A64_SINT:()=>bi,VK_FORMAT_R64G64B64A64_UINT:()=>Fr,VK_FORMAT_R64G64B64_SFLOAT:()=>Li,VK_FORMAT_R64G64B64_SINT:()=>hr,VK_FORMAT_R64G64B64_UINT:()=>Bi,VK_FORMAT_R64G64_SFLOAT:()=>xi,VK_FORMAT_R64G64_SINT:()=>li,VK_FORMAT_R64G64_UINT:()=>ai,VK_FORMAT_R64_SFLOAT:()=>Nn,VK_FORMAT_R64_SINT:()=>Wn,VK_FORMAT_R64_UINT:()=>Vn,VK_FORMAT_R8G8B8A8_SINT:()=>cr,VK_FORMAT_R8G8B8A8_SNORM:()=>Vi,VK_FORMAT_R8G8B8A8_SRGB:()=>Le,VK_FORMAT_R8G8B8A8_UINT:()=>lr,VK_FORMAT_R8G8B8A8_UNORM:()=>Fi,VK_FORMAT_R8G8B8_SINT:()=>Rt,VK_FORMAT_R8G8B8_SNORM:()=>Fn,VK_FORMAT_R8G8B8_SRGB:()=>gn,VK_FORMAT_R8G8B8_UINT:()=>sn,VK_FORMAT_R8G8B8_UNORM:()=>Ri,VK_FORMAT_R8G8_SINT:()=>Bn,VK_FORMAT_R8G8_SNORM:()=>Pt,VK_FORMAT_R8G8_SRGB:()=>pi,VK_FORMAT_R8G8_UINT:()=>$t,VK_FORMAT_R8G8_UNORM:()=>Ct,VK_FORMAT_R8_SINT:()=>at,VK_FORMAT_R8_SNORM:()=>We,VK_FORMAT_R8_SRGB:()=>At,VK_FORMAT_R8_UINT:()=>ve,VK_FORMAT_R8_UNORM:()=>Re,VK_FORMAT_S8_UINT:()=>qr,VK_FORMAT_UNDEFINED:()=>ye,VK_FORMAT_X8_D24_UNORM_PACK32:()=>ks,read:()=>ur,write:()=>yu});var d=h("./node_modules/buffer/index.js").Buffer;const f=0,p=1,A=2,g=3,v=0,b=0,x=2,E=0,S=1,M=160,C=161,T=162,L=163,B=0,F=1,D=0,P=1,U=2,K=3,J=4,z=5,j=6,G=7,H=8,te=9,Z=10,ee=11,oe=12,xe=13,Pe=14,me=15,Ce=16,Je=17,Oe=18,$e=0,nt=1,gt=2,Tt=3,Ze=4,mn=5,Ft=6,Qt=7,Xt=8,Tn=9,vn=10,Fe=11,Te=0,pt=1,Nt=2,zt=13,Vt=14,fn=15,mt=128,Ee=64,_e=32,Ne=16,ye=0,De=1,ke=2,Ye=3,Qe=4,ne=5,W=6,k=7,he=8,Re=9,We=10,ve=13,at=14,At=15,Ct=16,Pt=17,$t=20,Bn=21,pi=22,Ri=23,Fn=24,sn=27,Rt=28,gn=29,si=30,Ln=31,Jn=34,$n=35,Ei=36,Fi=37,Vi=38,lr=41,cr=42,Le=43,ht=44,yt=45,de=48,be=49,Ve=50,dt=58,ut=59,_t=62,It=63,Zt=64,Wt=65,Lt=68,Pn=69,Dn=70,jn=71,di=74,Cn=75,vi=76,Zn=77,nr=78,Rr=81,Rn=82,Kn=83,zi=84,Si=85,Y=88,se=89,pe=90,we=91,Ue=92,Ke=95,ft=96,ae=97,le=98,ce=99,ge=100,Ae=101,tt=102,xt=103,Dt=104,Yt=105,on=106,kt=107,bn=108,oi=109,Vn=110,Wn=111,Nn=112,ai=113,li=114,xi=115,Bi=116,hr=117,Li=118,Fr=119,bi=120,eo=121,Kr=122,qo=123,Ha=124,ks=125,ja=126,qr=127,Cr=128,pr=129,fu=130,ih=131,rh=132,wr=133,sh=134,oh=135,ay=136,ol=137,ly=138,cy=139,hy=140,uy=141,dy=142,fy=143,py=144,my=145,gy=146,Ay=147,vy=148,yy=149,xy=150,Mf=151,Dm=152,Om=153,Fm=154,Nm=155,Um=156,km=157,zm=158,Gm=159,ah=160,Ey=161,by=162,_y=163,wy=164,My=165,Cy=166,Sy=167,Ty=168,Ry=169,Cf=170,pu=171,Yo=172,lh=173,to=174,Es=175,Vm=176,al=177,sc=178,no=179,Nr=180,Sf=181,Iy=182,By=183,ch=184,Ly=1000156007,Py=1000156008,Dy=1000156009,Oy=1000156010,Fy=1000156011,Ny=1000156017,Uy=1000156018,ky=1000156019,zy=1000156020,Gy=1000156021,Tf=1000054e3,Hm=1000054001,mu=1000054002,Vy=1000054003,zs=1000054004,Ni=1000054005,Hy=1000054006,en=1000054007,Ui=1000066e3,Rf=1000066001,jm=1000066002,jy=1000066003,oc=1000066004,hh=1000066005,Wm=1000066006,Qm=1000066007,uh=1000066008,Xm=1000066009,Km=1000066010,gu=1000066011,Wy=1000066012,vr=1000066013,ac=100034e4,If=1000340001;class ll{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class cl{constructor(Pi,ar,bs,Ti){this._dataView=new DataView(Pi.buffer,Pi.byteOffset+ar,bs),this._littleEndian=Ti,this._offset=0}_nextUint8(){const Pi=this._dataView.getUint8(this._offset);return this._offset+=1,Pi}_nextUint16(){const Pi=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,Pi}_nextUint32(){const Pi=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,Pi}_nextUint64(){const Pi=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,Pi}_nextInt32(){const Pi=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,Pi}_skip(Pi){return this._offset+=Pi,this}_scan(Pi,ar=0){const bs=this._offset;let Ti=0;for(;this._dataView.getUint8(this._offset)!==ar&&Ti<Pi;)Ti++,this._offset++;return Ti<Pi&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+bs,Ti)}}const qm=new Uint8Array([0]),Br=[171,75,84,88,32,50,48,187,13,10,26,10];function Au(qn){return typeof TextEncoder<"u"?new TextEncoder().encode(qn):d.from(qn)}function Ym(qn){return typeof TextDecoder<"u"?new TextDecoder().decode(qn):d.from(qn).toString("utf8")}function Ir(qn){let Pi=0;for(const Ti of qn)Pi+=Ti.byteLength;const ar=new Uint8Array(Pi);let bs=0;for(const Ti of qn)ar.set(new Uint8Array(Ti),bs),bs+=Ti.byteLength;return ar}function ur(qn){const Pi=new Uint8Array(qn.buffer,qn.byteOffset,Br.length);if(Pi[0]!==Br[0]||Pi[1]!==Br[1]||Pi[2]!==Br[2]||Pi[3]!==Br[3]||Pi[4]!==Br[4]||Pi[5]!==Br[5]||Pi[6]!==Br[6]||Pi[7]!==Br[7]||Pi[8]!==Br[8]||Pi[9]!==Br[9]||Pi[10]!==Br[10]||Pi[11]!==Br[11])throw new Error("Missing KTX 2.0 identifier.");const ar=new ll,bs=17*Uint32Array.BYTES_PER_ELEMENT,Ti=new cl(qn,Br.length,bs,!0);ar.vkFormat=Ti._nextUint32(),ar.typeSize=Ti._nextUint32(),ar.pixelWidth=Ti._nextUint32(),ar.pixelHeight=Ti._nextUint32(),ar.pixelDepth=Ti._nextUint32(),ar.layerCount=Ti._nextUint32(),ar.faceCount=Ti._nextUint32();const je=Ti._nextUint32();ar.supercompressionScheme=Ti._nextUint32();const Vr=Ti._nextUint32(),Wa=Ti._nextUint32(),er=Ti._nextUint32(),xo=Ti._nextUint32(),Ds=Ti._nextUint64(),$o=Ti._nextUint64(),_s=new cl(qn,Br.length+bs,3*je*8,!0);for(let Gs=0;Gs<je;Gs++)ar.levels.push({levelData:new Uint8Array(qn.buffer,qn.byteOffset+_s._nextUint64(),_s._nextUint64()),uncompressedByteLength:_s._nextUint64()});const Hi=new cl(qn,Vr,Wa,!0),io={vendorId:Hi._skip(4)._nextUint16(),descriptorType:Hi._nextUint16(),versionNumber:Hi._nextUint16(),descriptorBlockSize:Hi._nextUint16(),colorModel:Hi._nextUint8(),colorPrimaries:Hi._nextUint8(),transferFunction:Hi._nextUint8(),flags:Hi._nextUint8(),texelBlockDimension:[Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8()],bytesPlane:[Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8()],samples:[]},Do=(io.descriptorBlockSize/4-6)/4;for(let Gs=0;Gs<Do;Gs++){const Vs={bitOffset:Hi._nextUint16(),bitLength:Hi._nextUint8(),channelType:Hi._nextUint8(),samplePosition:[Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8(),Hi._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&Vs.channelType?(Vs.sampleLower=Hi._nextInt32(),Vs.sampleUpper=Hi._nextInt32()):(Vs.sampleLower=Hi._nextUint32(),Vs.sampleUpper=Hi._nextUint32()),io.samples[Gs]=Vs}ar.dataFormatDescriptor.length=0,ar.dataFormatDescriptor.push(io);const ls=new cl(qn,er,xo,!0);for(;ls._offset<xo;){const Gs=ls._nextUint32(),Vs=ls._scan(Gs),_i=Ym(Vs),hl=ls._scan(Gs-Vs.byteLength);ar.keyValue[_i]=_i.match(/^ktx/i)?Ym(hl):hl,ls._offset%4&&ls._skip(4-ls._offset%4)}if($o<=0)return ar;const rr=new cl(qn,Ds,$o,!0),Er=rr._nextUint16(),ji=rr._nextUint16(),yr=rr._nextUint32(),cs=rr._nextUint32(),Qa=rr._nextUint32(),Bf=rr._nextUint32(),lc=[];for(let Gs=0;Gs<je;Gs++)lc.push({imageFlags:rr._nextUint32(),rgbSliceByteOffset:rr._nextUint32(),rgbSliceByteLength:rr._nextUint32(),alphaSliceByteOffset:rr._nextUint32(),alphaSliceByteLength:rr._nextUint32()});const xu=Ds+rr._offset,Eo=xu+yr,Jo=Eo+cs,Lf=Jo+Qa,Eu=new Uint8Array(qn.buffer,qn.byteOffset+xu,yr),Xa=new Uint8Array(qn.buffer,qn.byteOffset+Eo,cs),Pf=new Uint8Array(qn.buffer,qn.byteOffset+Jo,Qa),bu=new Uint8Array(qn.buffer,qn.byteOffset+Lf,Bf);return ar.globalData={endpointCount:Er,selectorCount:ji,imageDescs:lc,endpointsData:Eu,selectorsData:Xa,tablesData:Pf,extendedData:bu},ar}function vu(){return(vu=Object.assign||function(qn){for(var Pi=1;Pi<arguments.length;Pi++){var ar=arguments[Pi];for(var bs in ar)Object.prototype.hasOwnProperty.call(ar,bs)&&(qn[bs]=ar[bs])}return qn}).apply(this,arguments)}const yo={keepWriter:!1};function yu(qn,Pi={}){Pi=vu({},yo,Pi);let ar=new ArrayBuffer(0);if(qn.globalData){const Er=new ArrayBuffer(20+5*qn.globalData.imageDescs.length*4),ji=new DataView(Er);ji.setUint16(0,qn.globalData.endpointCount,!0),ji.setUint16(2,qn.globalData.selectorCount,!0),ji.setUint32(4,qn.globalData.endpointsData.byteLength,!0),ji.setUint32(8,qn.globalData.selectorsData.byteLength,!0),ji.setUint32(12,qn.globalData.tablesData.byteLength,!0),ji.setUint32(16,qn.globalData.extendedData.byteLength,!0);for(let yr=0;yr<qn.globalData.imageDescs.length;yr++){const cs=qn.globalData.imageDescs[yr];ji.setUint32(20+5*yr*4+0,cs.imageFlags,!0),ji.setUint32(20+5*yr*4+4,cs.rgbSliceByteOffset,!0),ji.setUint32(20+5*yr*4+8,cs.rgbSliceByteLength,!0),ji.setUint32(20+5*yr*4+12,cs.alphaSliceByteOffset,!0),ji.setUint32(20+5*yr*4+16,cs.alphaSliceByteLength,!0)}ar=Ir([Er,qn.globalData.endpointsData,qn.globalData.selectorsData,qn.globalData.tablesData,qn.globalData.extendedData])}const bs=[];let Ti=qn.keyValue;Pi.keepWriter||(Ti=vu({},qn.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const Er in Ti){const ji=Ti[Er],yr=Au(Er),cs=typeof ji=="string"?Au(ji):ji,Qa=yr.byteLength+1+cs.byteLength+1,Bf=Qa%4?4-Qa%4:0;bs.push(Ir([new Uint32Array([Qa]),yr,qm,cs,qm,new Uint8Array(Bf).fill(0)]))}const je=Ir(bs);if(qn.dataFormatDescriptor.length!==1||qn.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const Vr=qn.dataFormatDescriptor[0],Wa=new ArrayBuffer(28+16*Vr.samples.length),er=new DataView(Wa),xo=24+16*Vr.samples.length;if(er.setUint32(0,Wa.byteLength,!0),er.setUint16(4,Vr.vendorId,!0),er.setUint16(6,Vr.descriptorType,!0),er.setUint16(8,Vr.versionNumber,!0),er.setUint16(10,xo,!0),er.setUint8(12,Vr.colorModel),er.setUint8(13,Vr.colorPrimaries),er.setUint8(14,Vr.transferFunction),er.setUint8(15,Vr.flags),!Array.isArray(Vr.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");er.setUint8(16,Vr.texelBlockDimension[0]),er.setUint8(17,Vr.texelBlockDimension[1]),er.setUint8(18,Vr.texelBlockDimension[2]),er.setUint8(19,Vr.texelBlockDimension[3]);for(let Er=0;Er<8;Er++)er.setUint8(20+Er,Vr.bytesPlane[Er]);for(let Er=0;Er<Vr.samples.length;Er++){const ji=Vr.samples[Er],yr=28+16*Er;if(ji.channelID)throw new Error("channelID has been renamed to channelType.");er.setUint16(yr+0,ji.bitOffset,!0),er.setUint8(yr+2,ji.bitLength),er.setUint8(yr+3,ji.channelType),er.setUint8(yr+4,ji.samplePosition[0]),er.setUint8(yr+5,ji.samplePosition[1]),er.setUint8(yr+6,ji.samplePosition[2]),er.setUint8(yr+7,ji.samplePosition[3]),64&ji.channelType?(er.setInt32(yr+8,ji.sampleLower,!0),er.setInt32(yr+12,ji.sampleUpper,!0)):(er.setUint32(yr+8,ji.sampleLower,!0),er.setUint32(yr+12,ji.sampleUpper,!0))}const Ds=Br.length+68+3*qn.levels.length*8,$o=Ds+Wa.byteLength;let _s=ar.byteLength>0?$o+je.byteLength:0;_s%8&&(_s+=8-_s%8);const Hi=[],io=new DataView(new ArrayBuffer(3*qn.levels.length*8));let Do=(_s||$o+je.byteLength)+ar.byteLength;for(let Er=0;Er<qn.levels.length;Er++){const ji=qn.levels[Er];Hi.push(ji.levelData),io.setBigUint64(24*Er+0,BigInt(Do),!0),io.setBigUint64(24*Er+8,BigInt(ji.levelData.byteLength),!0),io.setBigUint64(24*Er+16,BigInt(ji.uncompressedByteLength),!0),Do+=ji.levelData.byteLength}const ls=new ArrayBuffer(68),rr=new DataView(ls);return rr.setUint32(0,qn.vkFormat,!0),rr.setUint32(4,qn.typeSize,!0),rr.setUint32(8,qn.pixelWidth,!0),rr.setUint32(12,qn.pixelHeight,!0),rr.setUint32(16,qn.pixelDepth,!0),rr.setUint32(20,qn.layerCount,!0),rr.setUint32(24,qn.faceCount,!0),rr.setUint32(28,qn.levels.length,!0),rr.setUint32(32,qn.supercompressionScheme,!0),rr.setUint32(36,Ds,!0),rr.setUint32(40,Wa.byteLength,!0),rr.setUint32(44,$o,!0),rr.setUint32(48,je.byteLength,!0),rr.setBigUint64(52,BigInt(ar.byteLength>0?_s:0),!0),rr.setBigUint64(60,BigInt(ar.byteLength),!0),new Uint8Array(Ir([new Uint8Array(Br).buffer,ls,io.buffer,Wa,je,_s>0?new ArrayBuffer(_s-($o+je.byteLength)):new ArrayBuffer(0),ar,...Hi]))}},"./node_modules/super-three/examples/jsm/libs/zstddec.module.js":(c,u,h)=>{h.r(u),h.d(u,{ZSTDDecoder:()=>v});var d=h("./node_modules/buffer/index.js").Buffer;let f,p,A;const g={env:{emscripten_notify_memory_growth:function(x){A=new Uint8Array(p.exports.memory.buffer)}}};class v{init(){return f||(f=typeof fetch<"u"?fetch("data:application/wasm;base64,"+b).then(E=>E.arrayBuffer()).then(E=>WebAssembly.instantiate(E,g)).then(this._init):WebAssembly.instantiate(d.from(b,"base64"),g).then(this._init),f)}_init(E){p=E.instance,g.env.emscripten_notify_memory_growth(0)}decode(E,S=0){if(!p)throw new Error("ZSTDDecoder: Await .init() before decoding.");const M=E.byteLength,C=p.exports.malloc(M);A.set(E,C),S=S||Number(p.exports.ZSTD_findDecompressedSize(C,M));const T=p.exports.malloc(S),L=p.exports.ZSTD_decompress(T,S,C,M),B=A.slice(T,T+L);return p.exports.free(C),p.exports.free(T),B}}const b="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/super-three/examples/jsm/lights/LightProbeGenerator.js":(c,u,h)=>{h.r(u),h.d(u,{LightProbeGenerator:()=>f});var d=h("./node_modules/super-three/build/three.module.js");class f{static fromCubeTexture(g){let v=0;const b=new d.Vector3,x=new d.Vector3,E=new d.Color,S=[0,0,0,0,0,0,0,0,0],M=new d.SphericalHarmonics3,C=M.coefficients;for(let L=0;L<6;L++){const B=g.image[L],F=B.width,D=B.height,P=document.createElement("canvas");P.width=F,P.height=D;const U=P.getContext("2d");U.drawImage(B,0,0,F,D);const K=U.getImageData(0,0,F,D),J=K.data,z=K.width,j=2/z;for(let G=0,H=J.length;G<H;G+=4){E.setRGB(J[G]/255,J[G+1]/255,J[G+2]/255),p(E,g.colorSpace);const te=G/4,Z=-1+(te%z+.5)*j,ee=1-(Math.floor(te/z)+.5)*j;switch(L){case 0:b.set(-1,ee,-Z);break;case 1:b.set(1,ee,Z);break;case 2:b.set(-Z,1,-ee);break;case 3:b.set(-Z,-1,ee);break;case 4:b.set(-Z,ee,1);break;case 5:b.set(Z,ee,-1);break}const oe=b.lengthSq(),xe=4/(Math.sqrt(oe)*oe);v+=xe,x.copy(b).normalize(),d.SphericalHarmonics3.getBasisAt(x,S);for(let Pe=0;Pe<9;Pe++)C[Pe].x+=S[Pe]*E.r*xe,C[Pe].y+=S[Pe]*E.g*xe,C[Pe].z+=S[Pe]*E.b*xe}}const T=4*Math.PI/v;for(let L=0;L<9;L++)C[L].x*=T,C[L].y*=T,C[L].z*=T;return new d.LightProbe(M)}static fromCubeRenderTarget(g,v){let b=0;const x=new d.Vector3,E=new d.Vector3,S=new d.Color,M=[0,0,0,0,0,0,0,0,0],C=new d.SphericalHarmonics3,T=C.coefficients,L=v.texture.type;for(let F=0;F<6;F++){const D=v.width;let P;L===d.HalfFloatType?P=new Uint16Array(D*D*4):P=new Uint8Array(D*D*4),g.readRenderTargetPixels(v,0,0,D,D,P,F);const U=2/D;for(let K=0,J=P.length;K<J;K+=4){let z,j,G;L===d.HalfFloatType?(z=d.DataUtils.fromHalfFloat(P[K]),j=d.DataUtils.fromHalfFloat(P[K+1]),G=d.DataUtils.fromHalfFloat(P[K+2])):(z=P[K]/255,j=P[K+1]/255,G=P[K+2]/255),S.setRGB(z,j,G),p(S,v.texture.colorSpace);const H=K/4,te=-1+(H%D+.5)*U,Z=1-(Math.floor(H/D)+.5)*U;switch(F){case 0:x.set(1,Z,-te);break;case 1:x.set(-1,Z,te);break;case 2:x.set(te,1,-Z);break;case 3:x.set(te,-1,Z);break;case 4:x.set(te,Z,1);break;case 5:x.set(-te,Z,-1);break}const ee=x.lengthSq(),oe=4/(Math.sqrt(ee)*ee);b+=oe,E.copy(x).normalize(),d.SphericalHarmonics3.getBasisAt(E,M);for(let xe=0;xe<9;xe++)T[xe].x+=M[xe]*S.r*oe,T[xe].y+=M[xe]*S.g*oe,T[xe].z+=M[xe]*S.b*oe}}const B=4*Math.PI/b;for(let F=0;F<9;F++)T[F].x*=B,T[F].y*=B,T[F].z*=B;return new d.LightProbe(C)}}function p(A,g){switch(g){case d.SRGBColorSpace:A.convertSRGBToLinear();break;case d.LinearSRGBColorSpace:case d.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return A}},"./node_modules/super-three/examples/jsm/loaders/DRACOLoader.js":(c,u,h)=>{h.r(u),h.d(u,{DRACOLoader:()=>p});var d=h("./node_modules/super-three/build/three.module.js");const f=new WeakMap;class p extends d.Loader{constructor(v){super(v),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(v){return this.decoderPath=v,this}setDecoderConfig(v){return this.decoderConfig=v,this}setWorkerLimit(v){return this.workerLimit=v,this}load(v,b,x,E){const S=new d.FileLoader(this.manager);S.setPath(this.path),S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setWithCredentials(this.withCredentials),S.load(v,M=>{this.parse(M,b,E)},x,E)}parse(v,b,x){this.decodeDracoFile(v,b,null,null,d.SRGBColorSpace).catch(x)}decodeDracoFile(v,b,x,E,S=d.LinearSRGBColorSpace){const M={attributeIDs:x||this.defaultAttributeIDs,attributeTypes:E||this.defaultAttributeTypes,useUniqueIDs:!!x,vertexColorSpace:S};return this.decodeGeometry(v,M).then(b)}decodeGeometry(v,b){const x=JSON.stringify(b);if(f.has(v)){const T=f.get(v);if(T.key===x)return T.promise;if(v.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let E;const S=this.workerNextTaskID++,M=v.byteLength,C=this._getWorker(S,M).then(T=>(E=T,new Promise((L,B)=>{E._callbacks[S]={resolve:L,reject:B},E.postMessage({type:"decode",id:S,taskConfig:b,buffer:v},[v])}))).then(T=>this._createGeometry(T.geometry));return C.catch(()=>!0).then(()=>{E&&S&&this._releaseTask(E,S)}),f.set(v,{key:x,promise:C}),C}_createGeometry(v){const b=new d.BufferGeometry;v.index&&b.setIndex(new d.BufferAttribute(v.index.array,1));for(let x=0;x<v.attributes.length;x++){const E=v.attributes[x],S=E.name,M=E.array,C=E.itemSize,T=new d.BufferAttribute(M,C);S==="color"&&(this._assignVertexColorSpace(T,E.vertexColorSpace),T.normalized=!(M instanceof Float32Array)),b.setAttribute(S,T)}return b}_assignVertexColorSpace(v,b){if(b!==d.SRGBColorSpace)return;const x=new d.Color;for(let E=0,S=v.count;E<S;E++)x.fromBufferAttribute(v,E).convertSRGBToLinear(),v.setXYZ(E,x.r,x.g,x.b)}_loadLibrary(v,b){const x=new d.FileLoader(this.manager);return x.setPath(this.decoderPath),x.setResponseType(b),x.setWithCredentials(this.withCredentials),new Promise((E,S)=>{x.load(v,E,void 0,S)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const v=typeof WebAssembly!="object"||this.decoderConfig.type==="js",b=[];return v?b.push(this._loadLibrary("draco_decoder.js","text")):(b.push(this._loadLibrary("draco_wasm_wrapper.js","text")),b.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(b).then(x=>{const E=x[0];v||(this.decoderConfig.wasmBinary=x[1]);const S=A.toString(),M=["/* draco decoder */",E,"","/* worker */",S.substring(S.indexOf("{")+1,S.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([M]))}),this.decoderPending}_getWorker(v,b){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const E=new Worker(this.workerSourceURL);E._callbacks={},E._taskCosts={},E._taskLoad=0,E.postMessage({type:"init",decoderConfig:this.decoderConfig}),E.onmessage=function(S){const M=S.data;switch(M.type){case"decode":E._callbacks[M.id].resolve(M);break;case"error":E._callbacks[M.id].reject(M);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+M.type+'"')}},this.workerPool.push(E)}else this.workerPool.sort(function(E,S){return E._taskLoad>S._taskLoad?-1:1});const x=this.workerPool[this.workerPool.length-1];return x._taskCosts[v]=b,x._taskLoad+=b,x})}_releaseTask(v,b){v._taskLoad-=v._taskCosts[b],delete v._callbacks[b],delete v._taskCosts[b]}debug(){console.log("Task load: ",this.workerPool.map(v=>v._taskLoad))}dispose(){for(let v=0;v<this.workerPool.length;++v)this.workerPool[v].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function A(){let g,v;onmessage=function(M){const C=M.data;switch(C.type){case"init":g=C.decoderConfig,v=new Promise(function(B){g.onModuleLoaded=function(F){B({draco:F})},DracoDecoderModule(g)});break;case"decode":const T=C.buffer,L=C.taskConfig;v.then(B=>{const F=B.draco,D=new F.Decoder;try{const P=b(F,D,new Int8Array(T),L),U=P.attributes.map(K=>K.array.buffer);P.index&&U.push(P.index.array.buffer),self.postMessage({type:"decode",id:C.id,geometry:P},U)}catch(P){console.error(P),self.postMessage({type:"error",id:C.id,error:P.message})}finally{F.destroy(D)}});break}};function b(M,C,T,L){const B=L.attributeIDs,F=L.attributeTypes;let D,P;const U=C.GetEncodedGeometryType(T);if(U===M.TRIANGULAR_MESH)D=new M.Mesh,P=C.DecodeArrayToMesh(T,T.byteLength,D);else if(U===M.POINT_CLOUD)D=new M.PointCloud,P=C.DecodeArrayToPointCloud(T,T.byteLength,D);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!P.ok()||D.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+P.error_msg());const K={index:null,attributes:[]};for(const J in B){const z=self[F[J]];let j,G;if(L.useUniqueIDs)G=B[J],j=C.GetAttributeByUniqueId(D,G);else{if(G=C.GetAttributeId(D,M[B[J]]),G===-1)continue;j=C.GetAttribute(D,G)}const H=E(M,C,D,J,z,j);J==="color"&&(H.vertexColorSpace=L.vertexColorSpace),K.attributes.push(H)}return U===M.TRIANGULAR_MESH&&(K.index=x(M,C,D)),M.destroy(D),K}function x(M,C,T){const B=T.num_faces()*3,F=B*4,D=M._malloc(F);C.GetTrianglesUInt32Array(T,F,D);const P=new Uint32Array(M.HEAPF32.buffer,D,B).slice();return M._free(D),{array:P,itemSize:1}}function E(M,C,T,L,B,F){const D=F.num_components(),U=T.num_points()*D,K=U*B.BYTES_PER_ELEMENT,J=S(M,B),z=M._malloc(K);C.GetAttributeDataArrayForAllPoints(T,F,J,K,z);const j=new B(M.HEAPF32.buffer,z,U).slice();return M._free(z),{name:L,array:j,itemSize:D}}function S(M,C){switch(C){case Float32Array:return M.DT_FLOAT32;case Int8Array:return M.DT_INT8;case Int16Array:return M.DT_INT16;case Int32Array:return M.DT_INT32;case Uint8Array:return M.DT_UINT8;case Uint16Array:return M.DT_UINT16;case Uint32Array:return M.DT_UINT32}}}},"./node_modules/super-three/examples/jsm/loaders/GLTFLoader.js":(c,u,h)=>{h.r(u),h.d(u,{GLTFLoader:()=>p});var d=h("./node_modules/super-three/build/three.module.js"),f=h("./node_modules/super-three/examples/jsm/utils/BufferGeometryUtils.js");class p extends d.Loader{constructor(Ee){super(Ee),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(_e){return new E(_e)}),this.register(function(_e){return new D(_e)}),this.register(function(_e){return new P(_e)}),this.register(function(_e){return new U(_e)}),this.register(function(_e){return new M(_e)}),this.register(function(_e){return new C(_e)}),this.register(function(_e){return new T(_e)}),this.register(function(_e){return new L(_e)}),this.register(function(_e){return new x(_e)}),this.register(function(_e){return new B(_e)}),this.register(function(_e){return new S(_e)}),this.register(function(_e){return new F(_e)}),this.register(function(_e){return new v(_e)}),this.register(function(_e){return new K(_e)}),this.register(function(_e){return new J(_e)})}load(Ee,_e,Ne,ye){const De=this;let ke;this.resourcePath!==""?ke=this.resourcePath:this.path!==""?ke=this.path:ke=d.LoaderUtils.extractUrlBase(Ee),this.manager.itemStart(Ee);const Ye=function(ne){ye?ye(ne):console.error(ne),De.manager.itemError(Ee),De.manager.itemEnd(Ee)},Qe=new d.FileLoader(this.manager);Qe.setPath(this.path),Qe.setResponseType("arraybuffer"),Qe.setRequestHeader(this.requestHeader),Qe.setWithCredentials(this.withCredentials),Qe.load(Ee,function(ne){try{De.parse(ne,ke,function(W){_e(W),De.manager.itemEnd(Ee)},Ye)}catch(W){Ye(W)}},Ne,Ye)}setDRACOLoader(Ee){return this.dracoLoader=Ee,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(Ee){return this.ktx2Loader=Ee,this}setMeshoptDecoder(Ee){return this.meshoptDecoder=Ee,this}register(Ee){return this.pluginCallbacks.indexOf(Ee)===-1&&this.pluginCallbacks.push(Ee),this}unregister(Ee){return this.pluginCallbacks.indexOf(Ee)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(Ee),1),this}parse(Ee,_e,Ne,ye){let De;const ke={},Ye={},Qe=new TextDecoder;if(typeof Ee=="string")De=JSON.parse(Ee);else if(Ee instanceof ArrayBuffer)if(Qe.decode(new Uint8Array(Ee,0,4))===z){try{ke[g.KHR_BINARY_GLTF]=new H(Ee)}catch(k){ye&&ye(k);return}De=JSON.parse(ke[g.KHR_BINARY_GLTF].content)}else De=JSON.parse(Qe.decode(Ee));else De=Ee;if(De.asset===void 0||De.asset.version[0]<2){ye&&ye(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ne=new zt(De,{path:_e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ne.fileLoader.setRequestHeader(this.requestHeader);for(let W=0;W<this.pluginCallbacks.length;W++){const k=this.pluginCallbacks[W](ne);k.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),Ye[k.name]=k,ke[k.name]=!0}if(De.extensionsUsed)for(let W=0;W<De.extensionsUsed.length;++W){const k=De.extensionsUsed[W],he=De.extensionsRequired||[];switch(k){case g.KHR_MATERIALS_UNLIT:ke[k]=new b;break;case g.KHR_DRACO_MESH_COMPRESSION:ke[k]=new te(De,this.dracoLoader);break;case g.KHR_TEXTURE_TRANSFORM:ke[k]=new Z;break;case g.KHR_MESH_QUANTIZATION:ke[k]=new ee;break;default:he.indexOf(k)>=0&&Ye[k]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+k+'".')}}ne.setExtensions(ke),ne.setPlugins(Ye),ne.parse(Ne,ye)}parseAsync(Ee,_e){const Ne=this;return new Promise(function(ye,De){Ne.parse(Ee,_e,ye,De)})}}function A(){let mt={};return{get:function(Ee){return mt[Ee]},add:function(Ee,_e){mt[Ee]=_e},remove:function(Ee){delete mt[Ee]},removeAll:function(){mt={}}}}const g={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class v{constructor(Ee){this.parser=Ee,this.name=g.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const Ee=this.parser,_e=this.parser.json.nodes||[];for(let Ne=0,ye=_e.length;Ne<ye;Ne++){const De=_e[Ne];De.extensions&&De.extensions[this.name]&&De.extensions[this.name].light!==void 0&&Ee._addNodeRef(this.cache,De.extensions[this.name].light)}}_loadLight(Ee){const _e=this.parser,Ne="light:"+Ee;let ye=_e.cache.get(Ne);if(ye)return ye;const De=_e.json,Qe=((De.extensions&&De.extensions[this.name]||{}).lights||[])[Ee];let ne;const W=new d.Color(16777215);Qe.color!==void 0&&W.setRGB(Qe.color[0],Qe.color[1],Qe.color[2],d.LinearSRGBColorSpace);const k=Qe.range!==void 0?Qe.range:0;switch(Qe.type){case"directional":ne=new d.DirectionalLight(W),ne.target.position.set(0,0,-1),ne.add(ne.target);break;case"point":ne=new d.PointLight(W),ne.distance=k;break;case"spot":ne=new d.SpotLight(W),ne.distance=k,Qe.spot=Qe.spot||{},Qe.spot.innerConeAngle=Qe.spot.innerConeAngle!==void 0?Qe.spot.innerConeAngle:0,Qe.spot.outerConeAngle=Qe.spot.outerConeAngle!==void 0?Qe.spot.outerConeAngle:Math.PI/4,ne.angle=Qe.spot.outerConeAngle,ne.penumbra=1-Qe.spot.innerConeAngle/Qe.spot.outerConeAngle,ne.target.position.set(0,0,-1),ne.add(ne.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+Qe.type)}return ne.position.set(0,0,0),ne.decay=2,Qt(ne,Qe),Qe.intensity!==void 0&&(ne.intensity=Qe.intensity),ne.name=_e.createUniqueName(Qe.name||"light_"+Ee),ye=Promise.resolve(ne),_e.cache.add(Ne,ye),ye}getDependency(Ee,_e){if(Ee==="light")return this._loadLight(_e)}createNodeAttachment(Ee){const _e=this,Ne=this.parser,De=Ne.json.nodes[Ee],Ye=(De.extensions&&De.extensions[this.name]||{}).light;return Ye===void 0?null:this._loadLight(Ye).then(function(Qe){return Ne._getNodeRef(_e.cache,Ye,Qe)})}}class b{constructor(){this.name=g.KHR_MATERIALS_UNLIT}getMaterialType(){return d.MeshBasicMaterial}extendParams(Ee,_e,Ne){const ye=[];Ee.color=new d.Color(1,1,1),Ee.opacity=1;const De=_e.pbrMetallicRoughness;if(De){if(Array.isArray(De.baseColorFactor)){const ke=De.baseColorFactor;Ee.color.setRGB(ke[0],ke[1],ke[2],d.LinearSRGBColorSpace),Ee.opacity=ke[3]}De.baseColorTexture!==void 0&&ye.push(Ne.assignTexture(Ee,"map",De.baseColorTexture,d.SRGBColorSpace))}return Promise.all(ye)}}class x{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(Ee,_e){const ye=this.parser.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=ye.extensions[this.name].emissiveStrength;return De!==void 0&&(_e.emissiveIntensity=De),Promise.resolve()}}class E{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_CLEARCOAT}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const Ne=this.parser,ye=Ne.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=[],ke=ye.extensions[this.name];if(ke.clearcoatFactor!==void 0&&(_e.clearcoat=ke.clearcoatFactor),ke.clearcoatTexture!==void 0&&De.push(Ne.assignTexture(_e,"clearcoatMap",ke.clearcoatTexture)),ke.clearcoatRoughnessFactor!==void 0&&(_e.clearcoatRoughness=ke.clearcoatRoughnessFactor),ke.clearcoatRoughnessTexture!==void 0&&De.push(Ne.assignTexture(_e,"clearcoatRoughnessMap",ke.clearcoatRoughnessTexture)),ke.clearcoatNormalTexture!==void 0&&(De.push(Ne.assignTexture(_e,"clearcoatNormalMap",ke.clearcoatNormalTexture)),ke.clearcoatNormalTexture.scale!==void 0)){const Ye=ke.clearcoatNormalTexture.scale;_e.clearcoatNormalScale=new d.Vector2(Ye,Ye)}return Promise.all(De)}}class S{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_IRIDESCENCE}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const Ne=this.parser,ye=Ne.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=[],ke=ye.extensions[this.name];return ke.iridescenceFactor!==void 0&&(_e.iridescence=ke.iridescenceFactor),ke.iridescenceTexture!==void 0&&De.push(Ne.assignTexture(_e,"iridescenceMap",ke.iridescenceTexture)),ke.iridescenceIor!==void 0&&(_e.iridescenceIOR=ke.iridescenceIor),_e.iridescenceThicknessRange===void 0&&(_e.iridescenceThicknessRange=[100,400]),ke.iridescenceThicknessMinimum!==void 0&&(_e.iridescenceThicknessRange[0]=ke.iridescenceThicknessMinimum),ke.iridescenceThicknessMaximum!==void 0&&(_e.iridescenceThicknessRange[1]=ke.iridescenceThicknessMaximum),ke.iridescenceThicknessTexture!==void 0&&De.push(Ne.assignTexture(_e,"iridescenceThicknessMap",ke.iridescenceThicknessTexture)),Promise.all(De)}}class M{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_SHEEN}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const Ne=this.parser,ye=Ne.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=[];_e.sheenColor=new d.Color(0,0,0),_e.sheenRoughness=0,_e.sheen=1;const ke=ye.extensions[this.name];if(ke.sheenColorFactor!==void 0){const Ye=ke.sheenColorFactor;_e.sheenColor.setRGB(Ye[0],Ye[1],Ye[2],d.LinearSRGBColorSpace)}return ke.sheenRoughnessFactor!==void 0&&(_e.sheenRoughness=ke.sheenRoughnessFactor),ke.sheenColorTexture!==void 0&&De.push(Ne.assignTexture(_e,"sheenColorMap",ke.sheenColorTexture,d.SRGBColorSpace)),ke.sheenRoughnessTexture!==void 0&&De.push(Ne.assignTexture(_e,"sheenRoughnessMap",ke.sheenRoughnessTexture)),Promise.all(De)}}class C{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_TRANSMISSION}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const Ne=this.parser,ye=Ne.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=[],ke=ye.extensions[this.name];return ke.transmissionFactor!==void 0&&(_e.transmission=ke.transmissionFactor),ke.transmissionTexture!==void 0&&De.push(Ne.assignTexture(_e,"transmissionMap",ke.transmissionTexture)),Promise.all(De)}}class T{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_VOLUME}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const Ne=this.parser,ye=Ne.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=[],ke=ye.extensions[this.name];_e.thickness=ke.thicknessFactor!==void 0?ke.thicknessFactor:0,ke.thicknessTexture!==void 0&&De.push(Ne.assignTexture(_e,"thicknessMap",ke.thicknessTexture)),_e.attenuationDistance=ke.attenuationDistance||1/0;const Ye=ke.attenuationColor||[1,1,1];return _e.attenuationColor=new d.Color().setRGB(Ye[0],Ye[1],Ye[2],d.LinearSRGBColorSpace),Promise.all(De)}}class L{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_IOR}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const ye=this.parser.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=ye.extensions[this.name];return _e.ior=De.ior!==void 0?De.ior:1.5,Promise.resolve()}}class B{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_SPECULAR}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const Ne=this.parser,ye=Ne.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=[],ke=ye.extensions[this.name];_e.specularIntensity=ke.specularFactor!==void 0?ke.specularFactor:1,ke.specularTexture!==void 0&&De.push(Ne.assignTexture(_e,"specularIntensityMap",ke.specularTexture));const Ye=ke.specularColorFactor||[1,1,1];return _e.specularColor=new d.Color().setRGB(Ye[0],Ye[1],Ye[2],d.LinearSRGBColorSpace),ke.specularColorTexture!==void 0&&De.push(Ne.assignTexture(_e,"specularColorMap",ke.specularColorTexture,d.SRGBColorSpace)),Promise.all(De)}}class F{constructor(Ee){this.parser=Ee,this.name=g.KHR_MATERIALS_ANISOTROPY}getMaterialType(Ee){const Ne=this.parser.json.materials[Ee];return!Ne.extensions||!Ne.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(Ee,_e){const Ne=this.parser,ye=Ne.json.materials[Ee];if(!ye.extensions||!ye.extensions[this.name])return Promise.resolve();const De=[],ke=ye.extensions[this.name];return ke.anisotropyStrength!==void 0&&(_e.anisotropy=ke.anisotropyStrength),ke.anisotropyRotation!==void 0&&(_e.anisotropyRotation=ke.anisotropyRotation),ke.anisotropyTexture!==void 0&&De.push(Ne.assignTexture(_e,"anisotropyMap",ke.anisotropyTexture)),Promise.all(De)}}class D{constructor(Ee){this.parser=Ee,this.name=g.KHR_TEXTURE_BASISU}loadTexture(Ee){const _e=this.parser,Ne=_e.json,ye=Ne.textures[Ee];if(!ye.extensions||!ye.extensions[this.name])return null;const De=ye.extensions[this.name],ke=_e.options.ktx2Loader;if(!ke){if(Ne.extensionsRequired&&Ne.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return _e.loadTextureImage(Ee,De.source,ke)}}class P{constructor(Ee){this.parser=Ee,this.name=g.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(Ee){const _e=this.name,Ne=this.parser,ye=Ne.json,De=ye.textures[Ee];if(!De.extensions||!De.extensions[_e])return null;const ke=De.extensions[_e],Ye=ye.images[ke.source];let Qe=Ne.textureLoader;if(Ye.uri){const ne=Ne.options.manager.getHandler(Ye.uri);ne!==null&&(Qe=ne)}return this.detectSupport().then(function(ne){if(ne)return Ne.loadTextureImage(Ee,ke.source,Qe);if(ye.extensionsRequired&&ye.extensionsRequired.indexOf(_e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Ne.loadTexture(Ee)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(Ee){const _e=new Image;_e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",_e.onload=_e.onerror=function(){Ee(_e.height===1)}})),this.isSupported}}class U{constructor(Ee){this.parser=Ee,this.name=g.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(Ee){const _e=this.name,Ne=this.parser,ye=Ne.json,De=ye.textures[Ee];if(!De.extensions||!De.extensions[_e])return null;const ke=De.extensions[_e],Ye=ye.images[ke.source];let Qe=Ne.textureLoader;if(Ye.uri){const ne=Ne.options.manager.getHandler(Ye.uri);ne!==null&&(Qe=ne)}return this.detectSupport().then(function(ne){if(ne)return Ne.loadTextureImage(Ee,ke.source,Qe);if(ye.extensionsRequired&&ye.extensionsRequired.indexOf(_e)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return Ne.loadTexture(Ee)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(Ee){const _e=new Image;_e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",_e.onload=_e.onerror=function(){Ee(_e.height===1)}})),this.isSupported}}class K{constructor(Ee){this.name=g.EXT_MESHOPT_COMPRESSION,this.parser=Ee}loadBufferView(Ee){const _e=this.parser.json,Ne=_e.bufferViews[Ee];if(Ne.extensions&&Ne.extensions[this.name]){const ye=Ne.extensions[this.name],De=this.parser.getDependency("buffer",ye.buffer),ke=this.parser.options.meshoptDecoder;if(!ke||!ke.supported){if(_e.extensionsRequired&&_e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return De.then(function(Ye){const Qe=ye.byteOffset||0,ne=ye.byteLength||0,W=ye.count,k=ye.byteStride,he=new Uint8Array(Ye,Qe,ne);return ke.decodeGltfBufferAsync?ke.decodeGltfBufferAsync(W,k,he,ye.mode,ye.filter).then(function(Re){return Re.buffer}):ke.ready.then(function(){const Re=new ArrayBuffer(W*k);return ke.decodeGltfBuffer(new Uint8Array(Re),W,k,he,ye.mode,ye.filter),Re})})}else return null}}class J{constructor(Ee){this.name=g.EXT_MESH_GPU_INSTANCING,this.parser=Ee}createNodeMesh(Ee){const _e=this.parser.json,Ne=_e.nodes[Ee];if(!Ne.extensions||!Ne.extensions[this.name]||Ne.mesh===void 0)return null;const ye=_e.meshes[Ne.mesh];for(const ne of ye.primitives)if(ne.mode!==me.TRIANGLES&&ne.mode!==me.TRIANGLE_STRIP&&ne.mode!==me.TRIANGLE_FAN&&ne.mode!==void 0)return null;const ke=Ne.extensions[this.name].attributes,Ye=[],Qe={};for(const ne in ke)Ye.push(this.parser.getDependency("accessor",ke[ne]).then(W=>(Qe[ne]=W,Qe[ne])));return Ye.length<1?null:(Ye.push(this.parser.createNodeMesh(Ee)),Promise.all(Ye).then(ne=>{const W=ne.pop(),k=W.isGroup?W.children:[W],he=ne[0].count,Re=[];for(const We of k){const ve=new d.Matrix4,at=new d.Vector3,At=new d.Quaternion,Ct=new d.Vector3(1,1,1),Pt=new d.InstancedMesh(We.geometry,We.material,he);for(let $t=0;$t<he;$t++)Qe.TRANSLATION&&at.fromBufferAttribute(Qe.TRANSLATION,$t),Qe.ROTATION&&At.fromBufferAttribute(Qe.ROTATION,$t),Qe.SCALE&&Ct.fromBufferAttribute(Qe.SCALE,$t),Pt.setMatrixAt($t,ve.compose(at,At,Ct));for(const $t in Qe)if($t==="_COLOR_0"){const Bn=Qe[$t];Pt.instanceColor=new d.InstancedBufferAttribute(Bn.array,Bn.itemSize,Bn.normalized)}else $t!=="TRANSLATION"&&$t!=="ROTATION"&&$t!=="SCALE"&&We.geometry.setAttribute($t,Qe[$t]);d.Object3D.prototype.copy.call(Pt,We),this.parser.assignFinalMaterial(Pt),Re.push(Pt)}return W.isGroup?(W.clear(),W.add(...Re),W):Re[0]}))}}const z="glTF",j=12,G={JSON:1313821514,BIN:5130562};class H{constructor(Ee){this.name=g.KHR_BINARY_GLTF,this.content=null,this.body=null;const _e=new DataView(Ee,0,j),Ne=new TextDecoder;if(this.header={magic:Ne.decode(new Uint8Array(Ee.slice(0,4))),version:_e.getUint32(4,!0),length:_e.getUint32(8,!0)},this.header.magic!==z)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const ye=this.header.length-j,De=new DataView(Ee,j);let ke=0;for(;ke<ye;){const Ye=De.getUint32(ke,!0);ke+=4;const Qe=De.getUint32(ke,!0);if(ke+=4,Qe===G.JSON){const ne=new Uint8Array(Ee,j+ke,Ye);this.content=Ne.decode(ne)}else if(Qe===G.BIN){const ne=j+ke;this.body=Ee.slice(ne,ne+Ye)}ke+=Ye}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class te{constructor(Ee,_e){if(!_e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=g.KHR_DRACO_MESH_COMPRESSION,this.json=Ee,this.dracoLoader=_e,this.dracoLoader.preload()}decodePrimitive(Ee,_e){const Ne=this.json,ye=this.dracoLoader,De=Ee.extensions[this.name].bufferView,ke=Ee.extensions[this.name].attributes,Ye={},Qe={},ne={};for(const W in ke){const k=nt[W]||W.toLowerCase();Ye[k]=ke[W]}for(const W in Ee.attributes){const k=nt[W]||W.toLowerCase();if(ke[W]!==void 0){const he=Ne.accessors[Ee.attributes[W]],Re=Ce[he.componentType];ne[k]=Re.name,Qe[k]=he.normalized===!0}}return _e.getDependency("bufferView",De).then(function(W){return new Promise(function(k){ye.decodeDracoFile(W,function(he){for(const Re in he.attributes){const We=he.attributes[Re],ve=Qe[Re];ve!==void 0&&(We.normalized=ve)}k(he)},Ye,ne)})})}}class Z{constructor(){this.name=g.KHR_TEXTURE_TRANSFORM}extendTexture(Ee,_e){return(_e.texCoord===void 0||_e.texCoord===Ee.channel)&&_e.offset===void 0&&_e.rotation===void 0&&_e.scale===void 0||(Ee=Ee.clone(),_e.texCoord!==void 0&&(Ee.channel=_e.texCoord),_e.offset!==void 0&&Ee.offset.fromArray(_e.offset),_e.rotation!==void 0&&(Ee.rotation=_e.rotation),_e.scale!==void 0&&Ee.repeat.fromArray(_e.scale),Ee.needsUpdate=!0),Ee}}class ee{constructor(){this.name=g.KHR_MESH_QUANTIZATION}}class oe extends d.Interpolant{constructor(Ee,_e,Ne,ye){super(Ee,_e,Ne,ye)}copySampleValue_(Ee){const _e=this.resultBuffer,Ne=this.sampleValues,ye=this.valueSize,De=Ee*ye*3+ye;for(let ke=0;ke!==ye;ke++)_e[ke]=Ne[De+ke];return _e}interpolate_(Ee,_e,Ne,ye){const De=this.resultBuffer,ke=this.sampleValues,Ye=this.valueSize,Qe=Ye*2,ne=Ye*3,W=ye-_e,k=(Ne-_e)/W,he=k*k,Re=he*k,We=Ee*ne,ve=We-ne,at=-2*Re+3*he,At=Re-he,Ct=1-at,Pt=At-he+k;for(let $t=0;$t!==Ye;$t++){const Bn=ke[ve+$t+Ye],pi=ke[ve+$t+Qe]*W,Ri=ke[We+$t+Ye],Fn=ke[We+$t]*W;De[$t]=Ct*Bn+Pt*pi+at*Ri+At*Fn}return De}}const xe=new d.Quaternion;class Pe extends oe{interpolate_(Ee,_e,Ne,ye){const De=super.interpolate_(Ee,_e,Ne,ye);return xe.fromArray(De).normalize().toArray(De),De}}const me={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ce={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Je={9728:d.NearestFilter,9729:d.LinearFilter,9984:d.NearestMipmapNearestFilter,9985:d.LinearMipmapNearestFilter,9986:d.NearestMipmapLinearFilter,9987:d.LinearMipmapLinearFilter},Oe={33071:d.ClampToEdgeWrapping,33648:d.MirroredRepeatWrapping,10497:d.RepeatWrapping},$e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},gt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Tt={CUBICSPLINE:void 0,LINEAR:d.InterpolateLinear,STEP:d.InterpolateDiscrete},Ze={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function mn(mt){return mt.DefaultMaterial===void 0&&(mt.DefaultMaterial=new d.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.FrontSide})),mt.DefaultMaterial}function Ft(mt,Ee,_e){for(const Ne in _e.extensions)mt[Ne]===void 0&&(Ee.userData.gltfExtensions=Ee.userData.gltfExtensions||{},Ee.userData.gltfExtensions[Ne]=_e.extensions[Ne])}function Qt(mt,Ee){Ee.extras!==void 0&&(typeof Ee.extras=="object"?Object.assign(mt.userData,Ee.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+Ee.extras))}function Xt(mt,Ee,_e){let Ne=!1,ye=!1,De=!1;for(let ne=0,W=Ee.length;ne<W;ne++){const k=Ee[ne];if(k.POSITION!==void 0&&(Ne=!0),k.NORMAL!==void 0&&(ye=!0),k.COLOR_0!==void 0&&(De=!0),Ne&&ye&&De)break}if(!Ne&&!ye&&!De)return Promise.resolve(mt);const ke=[],Ye=[],Qe=[];for(let ne=0,W=Ee.length;ne<W;ne++){const k=Ee[ne];if(Ne){const he=k.POSITION!==void 0?_e.getDependency("accessor",k.POSITION):mt.attributes.position;ke.push(he)}if(ye){const he=k.NORMAL!==void 0?_e.getDependency("accessor",k.NORMAL):mt.attributes.normal;Ye.push(he)}if(De){const he=k.COLOR_0!==void 0?_e.getDependency("accessor",k.COLOR_0):mt.attributes.color;Qe.push(he)}}return Promise.all([Promise.all(ke),Promise.all(Ye),Promise.all(Qe)]).then(function(ne){const W=ne[0],k=ne[1],he=ne[2];return Ne&&(mt.morphAttributes.position=W),ye&&(mt.morphAttributes.normal=k),De&&(mt.morphAttributes.color=he),mt.morphTargetsRelative=!0,mt})}function Tn(mt,Ee){if(mt.updateMorphTargets(),Ee.weights!==void 0)for(let _e=0,Ne=Ee.weights.length;_e<Ne;_e++)mt.morphTargetInfluences[_e]=Ee.weights[_e];if(Ee.extras&&Array.isArray(Ee.extras.targetNames)){const _e=Ee.extras.targetNames;if(mt.morphTargetInfluences.length===_e.length){mt.morphTargetDictionary={};for(let Ne=0,ye=_e.length;Ne<ye;Ne++)mt.morphTargetDictionary[_e[Ne]]=Ne}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function vn(mt){let Ee;const _e=mt.extensions&&mt.extensions[g.KHR_DRACO_MESH_COMPRESSION];if(_e?Ee="draco:"+_e.bufferView+":"+_e.indices+":"+Fe(_e.attributes):Ee=mt.indices+":"+Fe(mt.attributes)+":"+mt.mode,mt.targets!==void 0)for(let Ne=0,ye=mt.targets.length;Ne<ye;Ne++)Ee+=":"+Fe(mt.targets[Ne]);return Ee}function Fe(mt){let Ee="";const _e=Object.keys(mt).sort();for(let Ne=0,ye=_e.length;Ne<ye;Ne++)Ee+=_e[Ne]+":"+mt[_e[Ne]]+";";return Ee}function Te(mt){switch(mt){case Int8Array:return .007874015748031496;case Uint8Array:return .00392156862745098;case Int16Array:return 3051850947599719e-20;case Uint16Array:return 15259021896696422e-21;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function pt(mt){return mt.search(/\.jpe?g($|\?)/i)>0||mt.search(/^data\:image\/jpeg/)===0?"image/jpeg":mt.search(/\.webp($|\?)/i)>0||mt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Nt=new d.Matrix4;class zt{constructor(Ee={},_e={}){this.json=Ee,this.extensions={},this.plugins={},this.options=_e,this.cache=new A,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let Ne=!1,ye=!1,De=-1;typeof navigator<"u"&&(Ne=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,ye=navigator.userAgent.indexOf("Firefox")>-1,De=ye?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||Ne||ye&&De<98?this.textureLoader=new d.TextureLoader(this.options.manager):this.textureLoader=new d.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(Ee){this.extensions=Ee}setPlugins(Ee){this.plugins=Ee}parse(Ee,_e){const Ne=this,ye=this.json,De=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(ke){return ke._markDefs&&ke._markDefs()}),Promise.all(this._invokeAll(function(ke){return ke.beforeRoot&&ke.beforeRoot()})).then(function(){return Promise.all([Ne.getDependencies("scene"),Ne.getDependencies("animation"),Ne.getDependencies("camera")])}).then(function(ke){const Ye={scene:ke[0][ye.scene||0],scenes:ke[0],animations:ke[1],cameras:ke[2],asset:ye.asset,parser:Ne,userData:{}};return Ft(De,Ye,ye),Qt(Ye,ye),Promise.all(Ne._invokeAll(function(Qe){return Qe.afterRoot&&Qe.afterRoot(Ye)})).then(function(){Ee(Ye)})}).catch(_e)}_markDefs(){const Ee=this.json.nodes||[],_e=this.json.skins||[],Ne=this.json.meshes||[];for(let ye=0,De=_e.length;ye<De;ye++){const ke=_e[ye].joints;for(let Ye=0,Qe=ke.length;Ye<Qe;Ye++)Ee[ke[Ye]].isBone=!0}for(let ye=0,De=Ee.length;ye<De;ye++){const ke=Ee[ye];ke.mesh!==void 0&&(this._addNodeRef(this.meshCache,ke.mesh),ke.skin!==void 0&&(Ne[ke.mesh].isSkinnedMesh=!0)),ke.camera!==void 0&&this._addNodeRef(this.cameraCache,ke.camera)}}_addNodeRef(Ee,_e){_e!==void 0&&(Ee.refs[_e]===void 0&&(Ee.refs[_e]=Ee.uses[_e]=0),Ee.refs[_e]++)}_getNodeRef(Ee,_e,Ne){if(Ee.refs[_e]<=1)return Ne;const ye=Ne.clone(),De=(ke,Ye)=>{const Qe=this.associations.get(ke);Qe!=null&&this.associations.set(Ye,Qe);for(const[ne,W]of ke.children.entries())De(W,Ye.children[ne])};return De(Ne,ye),ye.name+="_instance_"+Ee.uses[_e]++,ye}_invokeOne(Ee){const _e=Object.values(this.plugins);_e.push(this);for(let Ne=0;Ne<_e.length;Ne++){const ye=Ee(_e[Ne]);if(ye)return ye}return null}_invokeAll(Ee){const _e=Object.values(this.plugins);_e.unshift(this);const Ne=[];for(let ye=0;ye<_e.length;ye++){const De=Ee(_e[ye]);De&&Ne.push(De)}return Ne}getDependency(Ee,_e){const Ne=Ee+":"+_e;let ye=this.cache.get(Ne);if(!ye){switch(Ee){case"scene":ye=this.loadScene(_e);break;case"node":ye=this._invokeOne(function(De){return De.loadNode&&De.loadNode(_e)});break;case"mesh":ye=this._invokeOne(function(De){return De.loadMesh&&De.loadMesh(_e)});break;case"accessor":ye=this.loadAccessor(_e);break;case"bufferView":ye=this._invokeOne(function(De){return De.loadBufferView&&De.loadBufferView(_e)});break;case"buffer":ye=this.loadBuffer(_e);break;case"material":ye=this._invokeOne(function(De){return De.loadMaterial&&De.loadMaterial(_e)});break;case"texture":ye=this._invokeOne(function(De){return De.loadTexture&&De.loadTexture(_e)});break;case"skin":ye=this.loadSkin(_e);break;case"animation":ye=this._invokeOne(function(De){return De.loadAnimation&&De.loadAnimation(_e)});break;case"camera":ye=this.loadCamera(_e);break;default:if(ye=this._invokeOne(function(De){return De!=this&&De.getDependency&&De.getDependency(Ee,_e)}),!ye)throw new Error("Unknown type: "+Ee);break}this.cache.add(Ne,ye)}return ye}getDependencies(Ee){let _e=this.cache.get(Ee);if(!_e){const Ne=this,ye=this.json[Ee+(Ee==="mesh"?"es":"s")]||[];_e=Promise.all(ye.map(function(De,ke){return Ne.getDependency(Ee,ke)})),this.cache.add(Ee,_e)}return _e}loadBuffer(Ee){const _e=this.json.buffers[Ee],Ne=this.fileLoader;if(_e.type&&_e.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+_e.type+" buffer type is not supported.");if(_e.uri===void 0&&Ee===0)return Promise.resolve(this.extensions[g.KHR_BINARY_GLTF].body);const ye=this.options;return new Promise(function(De,ke){Ne.load(d.LoaderUtils.resolveURL(_e.uri,ye.path),De,void 0,function(){ke(new Error('THREE.GLTFLoader: Failed to load buffer "'+_e.uri+'".'))})})}loadBufferView(Ee){const _e=this.json.bufferViews[Ee];return this.getDependency("buffer",_e.buffer).then(function(Ne){const ye=_e.byteLength||0,De=_e.byteOffset||0;return Ne.slice(De,De+ye)})}loadAccessor(Ee){const _e=this,Ne=this.json,ye=this.json.accessors[Ee];if(ye.bufferView===void 0&&ye.sparse===void 0){const ke=$e[ye.type],Ye=Ce[ye.componentType],Qe=ye.normalized===!0,ne=new Ye(ye.count*ke);return Promise.resolve(new d.BufferAttribute(ne,ke,Qe))}const De=[];return ye.bufferView!==void 0?De.push(this.getDependency("bufferView",ye.bufferView)):De.push(null),ye.sparse!==void 0&&(De.push(this.getDependency("bufferView",ye.sparse.indices.bufferView)),De.push(this.getDependency("bufferView",ye.sparse.values.bufferView))),Promise.all(De).then(function(ke){const Ye=ke[0],Qe=$e[ye.type],ne=Ce[ye.componentType],W=ne.BYTES_PER_ELEMENT,k=W*Qe,he=ye.byteOffset||0,Re=ye.bufferView!==void 0?Ne.bufferViews[ye.bufferView].byteStride:void 0,We=ye.normalized===!0;let ve,at;if(Re&&Re!==k){const At=Math.floor(he/Re),Ct="InterleavedBuffer:"+ye.bufferView+":"+ye.componentType+":"+At+":"+ye.count;let Pt=_e.cache.get(Ct);Pt||(ve=new ne(Ye,At*Re,ye.count*Re/W),Pt=new d.InterleavedBuffer(ve,Re/W),_e.cache.add(Ct,Pt)),at=new d.InterleavedBufferAttribute(Pt,Qe,he%Re/W,We)}else Ye===null?ve=new ne(ye.count*Qe):ve=new ne(Ye,he,ye.count*Qe),at=new d.BufferAttribute(ve,Qe,We);if(ye.sparse!==void 0){const At=$e.SCALAR,Ct=Ce[ye.sparse.indices.componentType],Pt=ye.sparse.indices.byteOffset||0,$t=ye.sparse.values.byteOffset||0,Bn=new Ct(ke[1],Pt,ye.sparse.count*At),pi=new ne(ke[2],$t,ye.sparse.count*Qe);Ye!==null&&(at=new d.BufferAttribute(at.array.slice(),at.itemSize,at.normalized));for(let Ri=0,Fn=Bn.length;Ri<Fn;Ri++){const sn=Bn[Ri];if(at.setX(sn,pi[Ri*Qe]),Qe>=2&&at.setY(sn,pi[Ri*Qe+1]),Qe>=3&&at.setZ(sn,pi[Ri*Qe+2]),Qe>=4&&at.setW(sn,pi[Ri*Qe+3]),Qe>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return at})}loadTexture(Ee){const _e=this.json,Ne=this.options,De=_e.textures[Ee].source,ke=_e.images[De];let Ye=this.textureLoader;if(ke.uri){const Qe=Ne.manager.getHandler(ke.uri);Qe!==null&&(Ye=Qe)}return this.loadTextureImage(Ee,De,Ye)}loadTextureImage(Ee,_e,Ne){const ye=this,De=this.json,ke=De.textures[Ee],Ye=De.images[_e],Qe=(Ye.uri||Ye.bufferView)+":"+ke.sampler;if(this.textureCache[Qe])return this.textureCache[Qe];const ne=this.loadImageSource(_e,Ne).then(function(W){W.flipY=!1,W.name=ke.name||Ye.name||"",W.name===""&&typeof Ye.uri=="string"&&Ye.uri.startsWith("data:image/")===!1&&(W.name=Ye.uri);const he=(De.samplers||{})[ke.sampler]||{};return W.magFilter=Je[he.magFilter]||d.LinearFilter,W.minFilter=Je[he.minFilter]||d.LinearMipmapLinearFilter,W.wrapS=Oe[he.wrapS]||d.RepeatWrapping,W.wrapT=Oe[he.wrapT]||d.RepeatWrapping,ye.associations.set(W,{textures:Ee}),W}).catch(function(){return null});return this.textureCache[Qe]=ne,ne}loadImageSource(Ee,_e){const Ne=this,ye=this.json,De=this.options;if(this.sourceCache[Ee]!==void 0)return this.sourceCache[Ee].then(k=>k.clone());const ke=ye.images[Ee],Ye=self.URL||self.webkitURL;let Qe=ke.uri||"",ne=!1;if(ke.bufferView!==void 0)Qe=Ne.getDependency("bufferView",ke.bufferView).then(function(k){ne=!0;const he=new Blob([k],{type:ke.mimeType});return Qe=Ye.createObjectURL(he),Qe});else if(ke.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+Ee+" is missing URI and bufferView");const W=Promise.resolve(Qe).then(function(k){return new Promise(function(he,Re){let We=he;_e.isImageBitmapLoader===!0&&(We=function(ve){const at=new d.Texture(ve);at.needsUpdate=!0,he(at)}),_e.load(d.LoaderUtils.resolveURL(k,De.path),We,void 0,Re)})}).then(function(k){return ne===!0&&Ye.revokeObjectURL(Qe),k.userData.mimeType=ke.mimeType||pt(ke.uri),k}).catch(function(k){throw console.error("THREE.GLTFLoader: Couldn't load texture",Qe),k});return this.sourceCache[Ee]=W,W}assignTexture(Ee,_e,Ne,ye){const De=this;return this.getDependency("texture",Ne.index).then(function(ke){if(!ke)return null;if(Ne.texCoord!==void 0&&Ne.texCoord>0&&(ke=ke.clone(),ke.channel=Ne.texCoord),De.extensions[g.KHR_TEXTURE_TRANSFORM]){const Ye=Ne.extensions!==void 0?Ne.extensions[g.KHR_TEXTURE_TRANSFORM]:void 0;if(Ye){const Qe=De.associations.get(ke);ke=De.extensions[g.KHR_TEXTURE_TRANSFORM].extendTexture(ke,Ye),De.associations.set(ke,Qe)}}return ye!==void 0&&(ke.colorSpace=ye),Ee[_e]=ke,ke})}assignFinalMaterial(Ee){const _e=Ee.geometry;let Ne=Ee.material;const ye=_e.attributes.tangent===void 0,De=_e.attributes.color!==void 0,ke=_e.attributes.normal===void 0;if(Ee.isPoints){const Ye="PointsMaterial:"+Ne.uuid;let Qe=this.cache.get(Ye);Qe||(Qe=new d.PointsMaterial,d.Material.prototype.copy.call(Qe,Ne),Qe.color.copy(Ne.color),Qe.map=Ne.map,Qe.sizeAttenuation=!1,this.cache.add(Ye,Qe)),Ne=Qe}else if(Ee.isLine){const Ye="LineBasicMaterial:"+Ne.uuid;let Qe=this.cache.get(Ye);Qe||(Qe=new d.LineBasicMaterial,d.Material.prototype.copy.call(Qe,Ne),Qe.color.copy(Ne.color),Qe.map=Ne.map,this.cache.add(Ye,Qe)),Ne=Qe}if(ye||De||ke){let Ye="ClonedMaterial:"+Ne.uuid+":";ye&&(Ye+="derivative-tangents:"),De&&(Ye+="vertex-colors:"),ke&&(Ye+="flat-shading:");let Qe=this.cache.get(Ye);Qe||(Qe=Ne.clone(),De&&(Qe.vertexColors=!0),ke&&(Qe.flatShading=!0),ye&&(Qe.normalScale&&(Qe.normalScale.y*=-1),Qe.clearcoatNormalScale&&(Qe.clearcoatNormalScale.y*=-1)),this.cache.add(Ye,Qe),this.associations.set(Qe,this.associations.get(Ne))),Ne=Qe}Ee.material=Ne}getMaterialType(){return d.MeshStandardMaterial}loadMaterial(Ee){const _e=this,Ne=this.json,ye=this.extensions,De=Ne.materials[Ee];let ke;const Ye={},Qe=De.extensions||{},ne=[];if(Qe[g.KHR_MATERIALS_UNLIT]){const k=ye[g.KHR_MATERIALS_UNLIT];ke=k.getMaterialType(),ne.push(k.extendParams(Ye,De,_e))}else{const k=De.pbrMetallicRoughness||{};if(Ye.color=new d.Color(1,1,1),Ye.opacity=1,Array.isArray(k.baseColorFactor)){const he=k.baseColorFactor;Ye.color.setRGB(he[0],he[1],he[2],d.LinearSRGBColorSpace),Ye.opacity=he[3]}k.baseColorTexture!==void 0&&ne.push(_e.assignTexture(Ye,"map",k.baseColorTexture,d.SRGBColorSpace)),Ye.metalness=k.metallicFactor!==void 0?k.metallicFactor:1,Ye.roughness=k.roughnessFactor!==void 0?k.roughnessFactor:1,k.metallicRoughnessTexture!==void 0&&(ne.push(_e.assignTexture(Ye,"metalnessMap",k.metallicRoughnessTexture)),ne.push(_e.assignTexture(Ye,"roughnessMap",k.metallicRoughnessTexture))),ke=this._invokeOne(function(he){return he.getMaterialType&&he.getMaterialType(Ee)}),ne.push(Promise.all(this._invokeAll(function(he){return he.extendMaterialParams&&he.extendMaterialParams(Ee,Ye)})))}De.doubleSided===!0&&(Ye.side=d.DoubleSide);const W=De.alphaMode||Ze.OPAQUE;if(W===Ze.BLEND?(Ye.transparent=!0,Ye.depthWrite=!1):(Ye.transparent=!1,W===Ze.MASK&&(Ye.alphaTest=De.alphaCutoff!==void 0?De.alphaCutoff:.5)),De.normalTexture!==void 0&&ke!==d.MeshBasicMaterial&&(ne.push(_e.assignTexture(Ye,"normalMap",De.normalTexture)),Ye.normalScale=new d.Vector2(1,1),De.normalTexture.scale!==void 0)){const k=De.normalTexture.scale;Ye.normalScale.set(k,k)}if(De.occlusionTexture!==void 0&&ke!==d.MeshBasicMaterial&&(ne.push(_e.assignTexture(Ye,"aoMap",De.occlusionTexture)),De.occlusionTexture.strength!==void 0&&(Ye.aoMapIntensity=De.occlusionTexture.strength)),De.emissiveFactor!==void 0&&ke!==d.MeshBasicMaterial){const k=De.emissiveFactor;Ye.emissive=new d.Color().setRGB(k[0],k[1],k[2],d.LinearSRGBColorSpace)}return De.emissiveTexture!==void 0&&ke!==d.MeshBasicMaterial&&ne.push(_e.assignTexture(Ye,"emissiveMap",De.emissiveTexture,d.SRGBColorSpace)),Promise.all(ne).then(function(){const k=new ke(Ye);return De.name&&(k.name=De.name),Qt(k,De),_e.associations.set(k,{materials:Ee}),De.extensions&&Ft(ye,k,De),k})}createUniqueName(Ee){const _e=d.PropertyBinding.sanitizeNodeName(Ee||"");return _e in this.nodeNamesUsed?_e+"_"+ ++this.nodeNamesUsed[_e]:(this.nodeNamesUsed[_e]=0,_e)}loadGeometries(Ee){const _e=this,Ne=this.extensions,ye=this.primitiveCache;function De(Ye){return Ne[g.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Ye,_e).then(function(Qe){return fn(Qe,Ye,_e)})}const ke=[];for(let Ye=0,Qe=Ee.length;Ye<Qe;Ye++){const ne=Ee[Ye],W=vn(ne),k=ye[W];if(k)ke.push(k.promise);else{let he;ne.extensions&&ne.extensions[g.KHR_DRACO_MESH_COMPRESSION]?he=De(ne):he=fn(new d.BufferGeometry,ne,_e),ye[W]={primitive:ne,promise:he},ke.push(he)}}return Promise.all(ke)}loadMesh(Ee){const _e=this,Ne=this.json,ye=this.extensions,De=Ne.meshes[Ee],ke=De.primitives,Ye=[];for(let Qe=0,ne=ke.length;Qe<ne;Qe++){const W=ke[Qe].material===void 0?mn(this.cache):this.getDependency("material",ke[Qe].material);Ye.push(W)}return Ye.push(_e.loadGeometries(ke)),Promise.all(Ye).then(function(Qe){const ne=Qe.slice(0,Qe.length-1),W=Qe[Qe.length-1],k=[];for(let Re=0,We=W.length;Re<We;Re++){const ve=W[Re],at=ke[Re];let At;const Ct=ne[Re];if(at.mode===me.TRIANGLES||at.mode===me.TRIANGLE_STRIP||at.mode===me.TRIANGLE_FAN||at.mode===void 0)At=De.isSkinnedMesh===!0?new d.SkinnedMesh(ve,Ct):new d.Mesh(ve,Ct),At.isSkinnedMesh===!0&&At.normalizeSkinWeights(),at.mode===me.TRIANGLE_STRIP?At.geometry=(0,f.toTrianglesDrawMode)(At.geometry,d.TriangleStripDrawMode):at.mode===me.TRIANGLE_FAN&&(At.geometry=(0,f.toTrianglesDrawMode)(At.geometry,d.TriangleFanDrawMode));else if(at.mode===me.LINES)At=new d.LineSegments(ve,Ct);else if(at.mode===me.LINE_STRIP)At=new d.Line(ve,Ct);else if(at.mode===me.LINE_LOOP)At=new d.LineLoop(ve,Ct);else if(at.mode===me.POINTS)At=new d.Points(ve,Ct);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+at.mode);Object.keys(At.geometry.morphAttributes).length>0&&Tn(At,De),At.name=_e.createUniqueName(De.name||"mesh_"+Ee),Qt(At,De),at.extensions&&Ft(ye,At,at),_e.assignFinalMaterial(At),k.push(At)}for(let Re=0,We=k.length;Re<We;Re++)_e.associations.set(k[Re],{meshes:Ee,primitives:Re});if(k.length===1)return De.extensions&&Ft(ye,k[0],De),k[0];const he=new d.Group;De.extensions&&Ft(ye,he,De),_e.associations.set(he,{meshes:Ee});for(let Re=0,We=k.length;Re<We;Re++)he.add(k[Re]);return he})}loadCamera(Ee){let _e;const Ne=this.json.cameras[Ee],ye=Ne[Ne.type];if(!ye){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Ne.type==="perspective"?_e=new d.PerspectiveCamera(d.MathUtils.radToDeg(ye.yfov),ye.aspectRatio||1,ye.znear||1,ye.zfar||2e6):Ne.type==="orthographic"&&(_e=new d.OrthographicCamera(-ye.xmag,ye.xmag,ye.ymag,-ye.ymag,ye.znear,ye.zfar)),Ne.name&&(_e.name=this.createUniqueName(Ne.name)),Qt(_e,Ne),Promise.resolve(_e)}loadSkin(Ee){const _e=this.json.skins[Ee],Ne=[];for(let ye=0,De=_e.joints.length;ye<De;ye++)Ne.push(this._loadNodeShallow(_e.joints[ye]));return _e.inverseBindMatrices!==void 0?Ne.push(this.getDependency("accessor",_e.inverseBindMatrices)):Ne.push(null),Promise.all(Ne).then(function(ye){const De=ye.pop(),ke=ye,Ye=[],Qe=[];for(let ne=0,W=ke.length;ne<W;ne++){const k=ke[ne];if(k){Ye.push(k);const he=new d.Matrix4;De!==null&&he.fromArray(De.array,ne*16),Qe.push(he)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',_e.joints[ne])}return new d.Skeleton(Ye,Qe)})}loadAnimation(Ee){const _e=this.json,Ne=this,ye=_e.animations[Ee],De=ye.name?ye.name:"animation_"+Ee,ke=[],Ye=[],Qe=[],ne=[],W=[];for(let k=0,he=ye.channels.length;k<he;k++){const Re=ye.channels[k],We=ye.samplers[Re.sampler],ve=Re.target,at=ve.node,At=ye.parameters!==void 0?ye.parameters[We.input]:We.input,Ct=ye.parameters!==void 0?ye.parameters[We.output]:We.output;ve.node!==void 0&&(ke.push(this.getDependency("node",at)),Ye.push(this.getDependency("accessor",At)),Qe.push(this.getDependency("accessor",Ct)),ne.push(We),W.push(ve))}return Promise.all([Promise.all(ke),Promise.all(Ye),Promise.all(Qe),Promise.all(ne),Promise.all(W)]).then(function(k){const he=k[0],Re=k[1],We=k[2],ve=k[3],at=k[4],At=[];for(let Ct=0,Pt=he.length;Ct<Pt;Ct++){const $t=he[Ct],Bn=Re[Ct],pi=We[Ct],Ri=ve[Ct],Fn=at[Ct];if($t===void 0)continue;$t.updateMatrix&&$t.updateMatrix();const sn=Ne._createAnimationTracks($t,Bn,pi,Ri,Fn);if(sn)for(let Rt=0;Rt<sn.length;Rt++)At.push(sn[Rt])}return new d.AnimationClip(De,void 0,At)})}createNodeMesh(Ee){const _e=this.json,Ne=this,ye=_e.nodes[Ee];return ye.mesh===void 0?null:Ne.getDependency("mesh",ye.mesh).then(function(De){const ke=Ne._getNodeRef(Ne.meshCache,ye.mesh,De);return ye.weights!==void 0&&ke.traverse(function(Ye){if(Ye.isMesh)for(let Qe=0,ne=ye.weights.length;Qe<ne;Qe++)Ye.morphTargetInfluences[Qe]=ye.weights[Qe]}),ke})}loadNode(Ee){const _e=this.json,Ne=this,ye=_e.nodes[Ee],De=Ne._loadNodeShallow(Ee),ke=[],Ye=ye.children||[];for(let ne=0,W=Ye.length;ne<W;ne++)ke.push(Ne.getDependency("node",Ye[ne]));const Qe=ye.skin===void 0?Promise.resolve(null):Ne.getDependency("skin",ye.skin);return Promise.all([De,Promise.all(ke),Qe]).then(function(ne){const W=ne[0],k=ne[1],he=ne[2];he!==null&&W.traverse(function(Re){Re.isSkinnedMesh&&Re.bind(he,Nt)});for(let Re=0,We=k.length;Re<We;Re++)W.add(k[Re]);return W})}_loadNodeShallow(Ee){const _e=this.json,Ne=this.extensions,ye=this;if(this.nodeCache[Ee]!==void 0)return this.nodeCache[Ee];const De=_e.nodes[Ee],ke=De.name?ye.createUniqueName(De.name):"",Ye=[],Qe=ye._invokeOne(function(ne){return ne.createNodeMesh&&ne.createNodeMesh(Ee)});return Qe&&Ye.push(Qe),De.camera!==void 0&&Ye.push(ye.getDependency("camera",De.camera).then(function(ne){return ye._getNodeRef(ye.cameraCache,De.camera,ne)})),ye._invokeAll(function(ne){return ne.createNodeAttachment&&ne.createNodeAttachment(Ee)}).forEach(function(ne){Ye.push(ne)}),this.nodeCache[Ee]=Promise.all(Ye).then(function(ne){let W;if(De.isBone===!0?W=new d.Bone:ne.length>1?W=new d.Group:ne.length===1?W=ne[0]:W=new d.Object3D,W!==ne[0])for(let k=0,he=ne.length;k<he;k++)W.add(ne[k]);if(De.name&&(W.userData.name=De.name,W.name=ke),Qt(W,De),De.extensions&&Ft(Ne,W,De),De.matrix!==void 0){const k=new d.Matrix4;k.fromArray(De.matrix),W.applyMatrix4(k)}else De.translation!==void 0&&W.position.fromArray(De.translation),De.rotation!==void 0&&W.quaternion.fromArray(De.rotation),De.scale!==void 0&&W.scale.fromArray(De.scale);return ye.associations.has(W)||ye.associations.set(W,{}),ye.associations.get(W).nodes=Ee,W}),this.nodeCache[Ee]}loadScene(Ee){const _e=this.extensions,Ne=this.json.scenes[Ee],ye=this,De=new d.Group;Ne.name&&(De.name=ye.createUniqueName(Ne.name)),Qt(De,Ne),Ne.extensions&&Ft(_e,De,Ne);const ke=Ne.nodes||[],Ye=[];for(let Qe=0,ne=ke.length;Qe<ne;Qe++)Ye.push(ye.getDependency("node",ke[Qe]));return Promise.all(Ye).then(function(Qe){for(let W=0,k=Qe.length;W<k;W++)De.add(Qe[W]);const ne=W=>{const k=new Map;for(const[he,Re]of ye.associations)(he instanceof d.Material||he instanceof d.Texture)&&k.set(he,Re);return W.traverse(he=>{const Re=ye.associations.get(he);Re!=null&&k.set(he,Re)}),k};return ye.associations=ne(De),De})}_createAnimationTracks(Ee,_e,Ne,ye,De){const ke=[],Ye=Ee.name?Ee.name:Ee.uuid,Qe=[];gt[De.path]===gt.weights?Ee.traverse(function(he){he.morphTargetInfluences&&Qe.push(he.name?he.name:he.uuid)}):Qe.push(Ye);let ne;switch(gt[De.path]){case gt.weights:ne=d.NumberKeyframeTrack;break;case gt.rotation:ne=d.QuaternionKeyframeTrack;break;case gt.position:case gt.scale:ne=d.VectorKeyframeTrack;break;default:switch(Ne.itemSize){case 1:ne=d.NumberKeyframeTrack;break;case 2:case 3:default:ne=d.VectorKeyframeTrack;break}break}const W=ye.interpolation!==void 0?Tt[ye.interpolation]:d.InterpolateLinear,k=this._getArrayFromAccessor(Ne);for(let he=0,Re=Qe.length;he<Re;he++){const We=new ne(Qe[he]+"."+gt[De.path],_e.array,k,W);ye.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(We),ke.push(We)}return ke}_getArrayFromAccessor(Ee){let _e=Ee.array;if(Ee.normalized){const Ne=Te(_e.constructor),ye=new Float32Array(_e.length);for(let De=0,ke=_e.length;De<ke;De++)ye[De]=_e[De]*Ne;_e=ye}return _e}_createCubicSplineTrackInterpolant(Ee){Ee.createInterpolant=function(Ne){const ye=this instanceof d.QuaternionKeyframeTrack?Pe:oe;return new ye(this.times,this.values,this.getValueSize()/3,Ne)},Ee.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Vt(mt,Ee,_e){const Ne=Ee.attributes,ye=new d.Box3;if(Ne.POSITION!==void 0){const Ye=_e.json.accessors[Ne.POSITION],Qe=Ye.min,ne=Ye.max;if(Qe!==void 0&&ne!==void 0){if(ye.set(new d.Vector3(Qe[0],Qe[1],Qe[2]),new d.Vector3(ne[0],ne[1],ne[2])),Ye.normalized){const W=Te(Ce[Ye.componentType]);ye.min.multiplyScalar(W),ye.max.multiplyScalar(W)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const De=Ee.targets;if(De!==void 0){const Ye=new d.Vector3,Qe=new d.Vector3;for(let ne=0,W=De.length;ne<W;ne++){const k=De[ne];if(k.POSITION!==void 0){const he=_e.json.accessors[k.POSITION],Re=he.min,We=he.max;if(Re!==void 0&&We!==void 0){if(Qe.setX(Math.max(Math.abs(Re[0]),Math.abs(We[0]))),Qe.setY(Math.max(Math.abs(Re[1]),Math.abs(We[1]))),Qe.setZ(Math.max(Math.abs(Re[2]),Math.abs(We[2]))),he.normalized){const ve=Te(Ce[he.componentType]);Qe.multiplyScalar(ve)}Ye.max(Qe)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}ye.expandByVector(Ye)}mt.boundingBox=ye;const ke=new d.Sphere;ye.getCenter(ke.center),ke.radius=ye.min.distanceTo(ye.max)/2,mt.boundingSphere=ke}function fn(mt,Ee,_e){const Ne=Ee.attributes,ye=[];function De(ke,Ye){return _e.getDependency("accessor",ke).then(function(Qe){mt.setAttribute(Ye,Qe)})}for(const ke in Ne){const Ye=nt[ke]||ke.toLowerCase();Ye in mt.attributes||ye.push(De(Ne[ke],Ye))}if(Ee.indices!==void 0&&!mt.index){const ke=_e.getDependency("accessor",Ee.indices).then(function(Ye){mt.setIndex(Ye)});ye.push(ke)}return d.ColorManagement.workingColorSpace!==d.LinearSRGBColorSpace&&"COLOR_0"in Ne&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${d.ColorManagement.workingColorSpace}" not supported.`),Qt(mt,Ee),Vt(mt,Ee,_e),Promise.all(ye).then(function(){return Ee.targets!==void 0?Xt(mt,Ee.targets,_e):mt})}},"./node_modules/super-three/examples/jsm/loaders/KTX2Loader.js":(c,u,h)=>{h.r(u),h.d(u,{KTX2Loader:()=>x});var d=h("./node_modules/super-three/build/three.module.js"),f=h("./node_modules/super-three/examples/jsm/utils/WorkerPool.js"),p=h("./node_modules/super-three/examples/jsm/libs/ktx-parse.module.js"),A=h("./node_modules/super-three/examples/jsm/libs/zstddec.module.js");const g=new WeakMap;let v=0,b;class x extends d.Loader{constructor(B){super(B),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new f.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(B){return this.transcoderPath=B,this}setWorkerLimit(B){return this.workerPool.setWorkerLimit(B),this}detectSupport(B){return B.isWebGPURenderer===!0?this.workerConfig={astcSupported:B.hasFeature("texture-compression-astc"),etc1Supported:!1,etc2Supported:B.hasFeature("texture-compression-etc2"),dxtSupported:B.hasFeature("texture-compression-bc"),bptcSupported:!1,pvrtcSupported:!1}:(this.workerConfig={astcSupported:B.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:B.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:B.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:B.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:B.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:B.extensions.has("WEBGL_compressed_texture_pvrtc")||B.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},B.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1)),this}init(){if(!this.transcoderPending){const B=new d.FileLoader(this.manager);B.setPath(this.transcoderPath),B.setWithCredentials(this.withCredentials);const F=B.loadAsync("basis_transcoder.js"),D=new d.FileLoader(this.manager);D.setPath(this.transcoderPath),D.setResponseType("arraybuffer"),D.setWithCredentials(this.withCredentials);const P=D.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([F,P]).then(([U,K])=>{const J=x.BasisWorker.toString(),z=["/* constants */","let _EngineFormat = "+JSON.stringify(x.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(x.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(x.BasisFormat),"/* basis_transcoder.js */",U,"/* worker */",J.substring(J.indexOf("{")+1,J.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([z])),this.transcoderBinary=K,this.workerPool.setWorkerCreator(()=>{const j=new Worker(this.workerSourceURL),G=this.transcoderBinary.slice(0);return j.postMessage({type:"init",config:this.workerConfig,transcoderBinary:G},[G]),j})}),v>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),v++}return this.transcoderPending}load(B,F,D,P){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const U=new d.FileLoader(this.manager);U.setResponseType("arraybuffer"),U.setWithCredentials(this.withCredentials),U.load(B,K=>{if(g.has(K))return g.get(K).promise.then(F).catch(P);this._createTexture(K).then(J=>F?F(J):null).catch(P)},D,P)}_createTextureFrom(B,F){const{faces:D,width:P,height:U,format:K,type:J,error:z,dfdFlags:j}=B;if(J==="error")return Promise.reject(z);let G;if(F.faceCount===6)G=new d.CompressedCubeTexture(D,K,d.UnsignedByteType);else{const H=D[0].mipmaps;G=F.layerCount>1?new d.CompressedArrayTexture(H,P,U,F.layerCount,K,d.UnsignedByteType):new d.CompressedTexture(H,P,U,K,d.UnsignedByteType)}return G.minFilter=D[0].mipmaps.length===1?d.LinearFilter:d.LinearMipmapLinearFilter,G.magFilter=d.LinearFilter,G.generateMipmaps=!1,G.needsUpdate=!0,G.colorSpace=T(F),G.premultiplyAlpha=!!(j&p.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),G}async _createTexture(B,F={}){const D=(0,p.read)(new Uint8Array(B));if(D.vkFormat!==p.VK_FORMAT_UNDEFINED)return C(D);const P=F,U=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:B,taskConfig:P},[B])).then(K=>this._createTextureFrom(K.data,D));return g.set(B,{promise:U}),U}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),v--,this}}x.BasisFormat={ETC1S:0,UASTC_4x4:1},x.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},x.EngineFormat={RGBAFormat:d.RGBAFormat,RGBA_ASTC_4x4_Format:d.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:d.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:d.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:d.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:d.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:d.RGB_ETC1_Format,RGB_ETC2_Format:d.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:d.RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format:d.RGB_S3TC_DXT1_Format},x.BasisWorker=function(){let L,B,F;const D=_EngineFormat,P=_TranscoderFormat,U=_BasisFormat;self.addEventListener("message",function(ee){const oe=ee.data;switch(oe.type){case"init":L=oe.config,K(oe.transcoderBinary);break;case"transcode":B.then(()=>{try{const{faces:xe,buffers:Pe,width:me,height:Ce,hasAlpha:Je,format:Oe,dfdFlags:$e}=J(oe.buffer);self.postMessage({type:"transcode",id:oe.id,faces:xe,width:me,height:Ce,hasAlpha:Je,format:Oe,dfdFlags:$e},Pe)}catch(xe){console.error(xe),self.postMessage({type:"error",id:oe.id,error:xe.message})}});break}});function K(ee){B=new Promise(oe=>{F={wasmBinary:ee,onRuntimeInitialized:oe},BASIS(F)}).then(()=>{F.initializeBasis(),F.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function J(ee){const oe=new F.KTX2File(new Uint8Array(ee));function xe(){oe.close(),oe.delete()}if(!oe.isValid())throw xe(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const Pe=oe.isUASTC()?U.UASTC_4x4:U.ETC1S,me=oe.getWidth(),Ce=oe.getHeight(),Je=oe.getLayers()||1,Oe=oe.getLevels(),$e=oe.getFaces(),nt=oe.getHasAlpha(),gt=oe.getDFDFlags(),{transcoderFormat:Tt,engineFormat:Ze}=H(Pe,me,Ce,nt);if(!me||!Ce||!Oe)throw xe(),new Error("THREE.KTX2Loader:	Invalid texture");if(!oe.startTranscoding())throw xe(),new Error("THREE.KTX2Loader: .startTranscoding failed");const mn=[],Ft=[];for(let Qt=0;Qt<$e;Qt++){const Xt=[];for(let Tn=0;Tn<Oe;Tn++){const vn=[];let Fe,Te;for(let Nt=0;Nt<Je;Nt++){const zt=oe.getImageLevelInfo(Tn,Nt,Qt);Qt===0&&Tn===0&&Nt===0&&(zt.origWidth%4!==0||zt.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),Oe>1?(Fe=zt.origWidth,Te=zt.origHeight):(Fe=zt.width,Te=zt.height);const Vt=new Uint8Array(oe.getImageTranscodedSizeInBytes(Tn,Nt,0,Tt));if(!oe.transcodeImage(Vt,Tn,Nt,Qt,Tt,0,-1,-1))throw xe(),new Error("THREE.KTX2Loader: .transcodeImage failed.");vn.push(Vt)}const pt=Z(vn);Xt.push({data:pt,width:Fe,height:Te}),Ft.push(pt.buffer)}mn.push({mipmaps:Xt,width:me,height:Ce,format:Ze})}return xe(),{faces:mn,buffers:Ft,width:me,height:Ce,hasAlpha:nt,format:Ze,dfdFlags:gt}}const z=[{if:"astcSupported",basisFormat:[U.UASTC_4x4],transcoderFormat:[P.ASTC_4x4,P.ASTC_4x4],engineFormat:[D.RGBA_ASTC_4x4_Format,D.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[P.BC7_M5,P.BC7_M5],engineFormat:[D.RGBA_BPTC_Format,D.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[P.BC1,P.BC3],engineFormat:[D.RGB_S3TC_DXT1_Format,D.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[P.ETC1,P.ETC2],engineFormat:[D.RGB_ETC2_Format,D.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[P.ETC1],engineFormat:[D.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[U.ETC1S,U.UASTC_4x4],transcoderFormat:[P.PVRTC1_4_RGB,P.PVRTC1_4_RGBA],engineFormat:[D.RGB_PVRTC_4BPPV1_Format,D.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],j=z.sort(function(ee,oe){return ee.priorityETC1S-oe.priorityETC1S}),G=z.sort(function(ee,oe){return ee.priorityUASTC-oe.priorityUASTC});function H(ee,oe,xe,Pe){let me,Ce;const Je=ee===U.ETC1S?j:G;for(let Oe=0;Oe<Je.length;Oe++){const $e=Je[Oe];if(L[$e.if]&&$e.basisFormat.includes(ee)&&!(Pe&&$e.transcoderFormat.length<2)&&!($e.needsPowerOfTwo&&!(te(oe)&&te(xe))))return me=$e.transcoderFormat[Pe?1:0],Ce=$e.engineFormat[Pe?1:0],{transcoderFormat:me,engineFormat:Ce}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),me=P.RGBA32,Ce=D.RGBAFormat,{transcoderFormat:me,engineFormat:Ce}}function te(ee){return ee<=2?!0:(ee&ee-1)===0&&ee!==0}function Z(ee){if(ee.length===1)return ee[0];let oe=0;for(let me=0;me<ee.length;me++){const Ce=ee[me];oe+=Ce.byteLength}const xe=new Uint8Array(oe);let Pe=0;for(let me=0;me<ee.length;me++){const Ce=ee[me];xe.set(Ce,Pe),Pe+=Ce.byteLength}return xe}};const E=new Set([d.RGBAFormat,d.RGFormat,d.RedFormat]),S={[p.VK_FORMAT_R32G32B32A32_SFLOAT]:d.RGBAFormat,[p.VK_FORMAT_R16G16B16A16_SFLOAT]:d.RGBAFormat,[p.VK_FORMAT_R8G8B8A8_UNORM]:d.RGBAFormat,[p.VK_FORMAT_R8G8B8A8_SRGB]:d.RGBAFormat,[p.VK_FORMAT_R32G32_SFLOAT]:d.RGFormat,[p.VK_FORMAT_R16G16_SFLOAT]:d.RGFormat,[p.VK_FORMAT_R8G8_UNORM]:d.RGFormat,[p.VK_FORMAT_R8G8_SRGB]:d.RGFormat,[p.VK_FORMAT_R32_SFLOAT]:d.RedFormat,[p.VK_FORMAT_R16_SFLOAT]:d.RedFormat,[p.VK_FORMAT_R8_SRGB]:d.RedFormat,[p.VK_FORMAT_R8_UNORM]:d.RedFormat,[p.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:d.RGBA_ASTC_6x6_Format,[p.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:d.RGBA_ASTC_6x6_Format},M={[p.VK_FORMAT_R32G32B32A32_SFLOAT]:d.FloatType,[p.VK_FORMAT_R16G16B16A16_SFLOAT]:d.HalfFloatType,[p.VK_FORMAT_R8G8B8A8_UNORM]:d.UnsignedByteType,[p.VK_FORMAT_R8G8B8A8_SRGB]:d.UnsignedByteType,[p.VK_FORMAT_R32G32_SFLOAT]:d.FloatType,[p.VK_FORMAT_R16G16_SFLOAT]:d.HalfFloatType,[p.VK_FORMAT_R8G8_UNORM]:d.UnsignedByteType,[p.VK_FORMAT_R8G8_SRGB]:d.UnsignedByteType,[p.VK_FORMAT_R32_SFLOAT]:d.FloatType,[p.VK_FORMAT_R16_SFLOAT]:d.HalfFloatType,[p.VK_FORMAT_R8_SRGB]:d.UnsignedByteType,[p.VK_FORMAT_R8_UNORM]:d.UnsignedByteType,[p.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:d.UnsignedByteType,[p.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:d.UnsignedByteType};async function C(L){const{vkFormat:B}=L;if(S[B]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let F;L.supercompressionScheme===p.KHR_SUPERCOMPRESSION_ZSTD&&(b||(b=new Promise(async U=>{const K=new A.ZSTDDecoder;await K.init(),U(K)})),F=await b);const D=[];for(let U=0;U<L.levels.length;U++){const K=Math.max(1,L.pixelWidth>>U),J=Math.max(1,L.pixelHeight>>U),z=L.pixelDepth?Math.max(1,L.pixelDepth>>U):0,j=L.levels[U];let G;if(L.supercompressionScheme===p.KHR_SUPERCOMPRESSION_NONE)G=j.levelData;else if(L.supercompressionScheme===p.KHR_SUPERCOMPRESSION_ZSTD)G=F.decode(j.levelData,j.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let H;M[B]===d.FloatType?H=new Float32Array(G.buffer,G.byteOffset,G.byteLength/Float32Array.BYTES_PER_ELEMENT):M[B]===d.HalfFloatType?H=new Uint16Array(G.buffer,G.byteOffset,G.byteLength/Uint16Array.BYTES_PER_ELEMENT):H=G,D.push({data:H,width:K,height:J,depth:z})}let P;if(E.has(S[B]))P=L.pixelDepth===0?new d.DataTexture(D[0].data,L.pixelWidth,L.pixelHeight):new d.Data3DTexture(D[0].data,L.pixelWidth,L.pixelHeight,L.pixelDepth);else{if(L.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");P=new d.CompressedTexture(D,L.pixelWidth,L.pixelHeight)}return P.mipmaps=D,P.type=M[B],P.format=S[B],P.colorSpace=T(L),P.needsUpdate=!0,Promise.resolve(P)}function T(L){const B=L.dataFormatDescriptor[0];return B.colorPrimaries===p.KHR_DF_PRIMARIES_BT709?B.transferFunction===p.KHR_DF_TRANSFER_SRGB?d.SRGBColorSpace:d.LinearSRGBColorSpace:B.colorPrimaries===p.KHR_DF_PRIMARIES_DISPLAYP3?B.transferFunction===p.KHR_DF_TRANSFER_SRGB?d.DisplayP3ColorSpace:d.LinearDisplayP3ColorSpace:(B.colorPrimaries===p.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${B.colorPrimaries}"`),d.NoColorSpace)}},"./node_modules/super-three/examples/jsm/loaders/MTLLoader.js":(c,u,h)=>{h.r(u),h.d(u,{MTLLoader:()=>f});var d=h("./node_modules/super-three/build/three.module.js");class f extends d.Loader{constructor(g){super(g)}load(g,v,b,x){const E=this,S=this.path===""?d.LoaderUtils.extractUrlBase(g):this.path,M=new d.FileLoader(this.manager);M.setPath(this.path),M.setRequestHeader(this.requestHeader),M.setWithCredentials(this.withCredentials),M.load(g,function(C){try{v(E.parse(C,S))}catch(T){x?x(T):console.error(T),E.manager.itemError(g)}},b,x)}setMaterialOptions(g){return this.materialOptions=g,this}parse(g,v){const b=g.split(`
`);let x={};const E=/\s+/,S={};for(let C=0;C<b.length;C++){let T=b[C];if(T=T.trim(),T.length===0||T.charAt(0)==="#")continue;const L=T.indexOf(" ");let B=L>=0?T.substring(0,L):T;B=B.toLowerCase();let F=L>=0?T.substring(L+1):"";if(F=F.trim(),B==="newmtl")x={name:F},S[F]=x;else if(B==="ka"||B==="kd"||B==="ks"||B==="ke"){const D=F.split(E,3);x[B]=[parseFloat(D[0]),parseFloat(D[1]),parseFloat(D[2])]}else x[B]=F}const M=new p(this.resourcePath||v,this.materialOptions);return M.setCrossOrigin(this.crossOrigin),M.setManager(this.manager),M.setMaterials(S),M}}class p{constructor(g="",v={}){this.baseUrl=g,this.options=v,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:d.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:d.RepeatWrapping}setCrossOrigin(g){return this.crossOrigin=g,this}setManager(g){this.manager=g}setMaterials(g){this.materialsInfo=this.convert(g),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(g){if(!this.options)return g;const v={};for(const b in g){const x=g[b],E={};v[b]=E;for(const S in x){let M=!0,C=x[S];const T=S.toLowerCase();switch(T){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(C=[C[0]/255,C[1]/255,C[2]/255]),this.options&&this.options.ignoreZeroRGBs&&C[0]===0&&C[1]===0&&C[2]===0&&(M=!1);break}M&&(E[T]=C)}}return v}preload(){for(const g in this.materialsInfo)this.create(g)}getIndex(g){return this.nameLookup[g]}getAsArray(){let g=0;for(const v in this.materialsInfo)this.materialsArray[g]=this.create(v),this.nameLookup[v]=g,g++;return this.materialsArray}create(g){return this.materials[g]===void 0&&this.createMaterial_(g),this.materials[g]}createMaterial_(g){const v=this,b=this.materialsInfo[g],x={name:g,side:this.side};function E(M,C){return typeof C!="string"||C===""?"":/^https?:\/\//i.test(C)?C:M+C}function S(M,C){if(x[M])return;const T=v.getTextureParams(C,x),L=v.loadTexture(E(v.baseUrl,T.url));L.repeat.copy(T.scale),L.offset.copy(T.offset),L.wrapS=v.wrap,L.wrapT=v.wrap,(M==="map"||M==="emissiveMap")&&(L.colorSpace=d.SRGBColorSpace),x[M]=L}for(const M in b){const C=b[M];let T;if(C!=="")switch(M.toLowerCase()){case"kd":x.color=new d.Color().fromArray(C).convertSRGBToLinear();break;case"ks":x.specular=new d.Color().fromArray(C).convertSRGBToLinear();break;case"ke":x.emissive=new d.Color().fromArray(C).convertSRGBToLinear();break;case"map_kd":S("map",C);break;case"map_ks":S("specularMap",C);break;case"map_ke":S("emissiveMap",C);break;case"norm":S("normalMap",C);break;case"map_bump":case"bump":S("bumpMap",C);break;case"map_d":S("alphaMap",C),x.transparent=!0;break;case"ns":x.shininess=parseFloat(C);break;case"d":T=parseFloat(C),T<1&&(x.opacity=T,x.transparent=!0);break;case"tr":T=parseFloat(C),this.options&&this.options.invertTrProperty&&(T=1-T),T>0&&(x.opacity=1-T,x.transparent=!0);break}}return this.materials[g]=new d.MeshPhongMaterial(x),this.materials[g]}getTextureParams(g,v){const b={scale:new d.Vector2(1,1),offset:new d.Vector2(0,0)},x=g.split(/\s+/);let E;return E=x.indexOf("-bm"),E>=0&&(v.bumpScale=parseFloat(x[E+1]),x.splice(E,2)),E=x.indexOf("-s"),E>=0&&(b.scale.set(parseFloat(x[E+1]),parseFloat(x[E+2])),x.splice(E,4)),E=x.indexOf("-o"),E>=0&&(b.offset.set(parseFloat(x[E+1]),parseFloat(x[E+2])),x.splice(E,4)),b.url=x.join(" ").trim(),b}loadTexture(g,v,b,x,E){const S=this.manager!==void 0?this.manager:d.DefaultLoadingManager;let M=S.getHandler(g);M===null&&(M=new d.TextureLoader(S)),M.setCrossOrigin&&M.setCrossOrigin(this.crossOrigin);const C=M.load(g,b,x,E);return v!==void 0&&(C.mapping=v),C}}},"./node_modules/super-three/examples/jsm/loaders/OBJLoader.js":(c,u,h)=>{h.r(u),h.d(u,{OBJLoader:()=>L});var d=h("./node_modules/super-three/build/three.module.js");const f=/^[og]\s*(.+)?/,p=/^mtllib /,A=/^usemtl /,g=/^usemap /,v=/\s+/,b=new d.Vector3,x=new d.Vector3,E=new d.Vector3,S=new d.Vector3,M=new d.Vector3,C=new d.Color;function T(){const B={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(F,D){if(this.object&&this.object.fromDeclaration===!1){this.object.name=F,this.object.fromDeclaration=D!==!1;return}const P=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:F||"",fromDeclaration:D!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(U,K){const J=this._finalize(!1);J&&(J.inherited||J.groupCount<=0)&&this.materials.splice(J.index,1);const z={index:this.materials.length,name:U||"",mtllib:Array.isArray(K)&&K.length>0?K[K.length-1]:"",smooth:J!==void 0?J.smooth:this.smooth,groupStart:J!==void 0?J.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(j){const G={index:typeof j=="number"?j:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return G.clone=this.clone.bind(G),G}};return this.materials.push(z),z},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(U){const K=this.currentMaterial();if(K&&K.groupEnd===-1&&(K.groupEnd=this.geometry.vertices.length/3,K.groupCount=K.groupEnd-K.groupStart,K.inherited=!1),U&&this.materials.length>1)for(let J=this.materials.length-1;J>=0;J--)this.materials[J].groupCount<=0&&this.materials.splice(J,1);return U&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),K}},P&&P.name&&typeof P.clone=="function"){const U=P.clone(0);U.inherited=!0,this.object.materials.push(U)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(F,D){const P=parseInt(F,10);return(P>=0?P-1:P+D/3)*3},parseNormalIndex:function(F,D){const P=parseInt(F,10);return(P>=0?P-1:P+D/3)*3},parseUVIndex:function(F,D){const P=parseInt(F,10);return(P>=0?P-1:P+D/2)*2},addVertex:function(F,D,P){const U=this.vertices,K=this.object.geometry.vertices;K.push(U[F+0],U[F+1],U[F+2]),K.push(U[D+0],U[D+1],U[D+2]),K.push(U[P+0],U[P+1],U[P+2])},addVertexPoint:function(F){const D=this.vertices;this.object.geometry.vertices.push(D[F+0],D[F+1],D[F+2])},addVertexLine:function(F){const D=this.vertices;this.object.geometry.vertices.push(D[F+0],D[F+1],D[F+2])},addNormal:function(F,D,P){const U=this.normals,K=this.object.geometry.normals;K.push(U[F+0],U[F+1],U[F+2]),K.push(U[D+0],U[D+1],U[D+2]),K.push(U[P+0],U[P+1],U[P+2])},addFaceNormal:function(F,D,P){const U=this.vertices,K=this.object.geometry.normals;b.fromArray(U,F),x.fromArray(U,D),E.fromArray(U,P),M.subVectors(E,x),S.subVectors(b,x),M.cross(S),M.normalize(),K.push(M.x,M.y,M.z),K.push(M.x,M.y,M.z),K.push(M.x,M.y,M.z)},addColor:function(F,D,P){const U=this.colors,K=this.object.geometry.colors;U[F]!==void 0&&K.push(U[F+0],U[F+1],U[F+2]),U[D]!==void 0&&K.push(U[D+0],U[D+1],U[D+2]),U[P]!==void 0&&K.push(U[P+0],U[P+1],U[P+2])},addUV:function(F,D,P){const U=this.uvs,K=this.object.geometry.uvs;K.push(U[F+0],U[F+1]),K.push(U[D+0],U[D+1]),K.push(U[P+0],U[P+1])},addDefaultUV:function(){const F=this.object.geometry.uvs;F.push(0,0),F.push(0,0),F.push(0,0)},addUVLine:function(F){const D=this.uvs;this.object.geometry.uvs.push(D[F+0],D[F+1])},addFace:function(F,D,P,U,K,J,z,j,G){const H=this.vertices.length;let te=this.parseVertexIndex(F,H),Z=this.parseVertexIndex(D,H),ee=this.parseVertexIndex(P,H);if(this.addVertex(te,Z,ee),this.addColor(te,Z,ee),z!==void 0&&z!==""){const oe=this.normals.length;te=this.parseNormalIndex(z,oe),Z=this.parseNormalIndex(j,oe),ee=this.parseNormalIndex(G,oe),this.addNormal(te,Z,ee)}else this.addFaceNormal(te,Z,ee);if(U!==void 0&&U!==""){const oe=this.uvs.length;te=this.parseUVIndex(U,oe),Z=this.parseUVIndex(K,oe),ee=this.parseUVIndex(J,oe),this.addUV(te,Z,ee),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(F){this.object.geometry.type="Points";const D=this.vertices.length;for(let P=0,U=F.length;P<U;P++){const K=this.parseVertexIndex(F[P],D);this.addVertexPoint(K),this.addColor(K)}},addLineGeometry:function(F,D){this.object.geometry.type="Line";const P=this.vertices.length,U=this.uvs.length;for(let K=0,J=F.length;K<J;K++)this.addVertexLine(this.parseVertexIndex(F[K],P));for(let K=0,J=D.length;K<J;K++)this.addUVLine(this.parseUVIndex(D[K],U))}};return B.startObject("",!1),B}class L extends d.Loader{constructor(F){super(F),this.materials=null}load(F,D,P,U){const K=this,J=new d.FileLoader(this.manager);J.setPath(this.path),J.setRequestHeader(this.requestHeader),J.setWithCredentials(this.withCredentials),J.load(F,function(z){try{D(K.parse(z))}catch(j){U?U(j):console.error(j),K.manager.itemError(F)}},P,U)}setMaterials(F){return this.materials=F,this}parse(F){const D=new T;F.indexOf(`\r
`)!==-1&&(F=F.replace(/\r\n/g,`
`)),F.indexOf(`\\
`)!==-1&&(F=F.replace(/\\\n/g,""));const P=F.split(`
`);let U=[];for(let z=0,j=P.length;z<j;z++){const G=P[z].trimStart();if(G.length===0)continue;const H=G.charAt(0);if(H!=="#")if(H==="v"){const te=G.split(v);switch(te[0]){case"v":D.vertices.push(parseFloat(te[1]),parseFloat(te[2]),parseFloat(te[3])),te.length>=7?(C.setRGB(parseFloat(te[4]),parseFloat(te[5]),parseFloat(te[6])).convertSRGBToLinear(),D.colors.push(C.r,C.g,C.b)):D.colors.push(void 0,void 0,void 0);break;case"vn":D.normals.push(parseFloat(te[1]),parseFloat(te[2]),parseFloat(te[3]));break;case"vt":D.uvs.push(parseFloat(te[1]),parseFloat(te[2]));break}}else if(H==="f"){const Z=G.slice(1).trim().split(v),ee=[];for(let xe=0,Pe=Z.length;xe<Pe;xe++){const me=Z[xe];if(me.length>0){const Ce=me.split("/");ee.push(Ce)}}const oe=ee[0];for(let xe=1,Pe=ee.length-1;xe<Pe;xe++){const me=ee[xe],Ce=ee[xe+1];D.addFace(oe[0],me[0],Ce[0],oe[1],me[1],Ce[1],oe[2],me[2],Ce[2])}}else if(H==="l"){const te=G.substring(1).trim().split(" ");let Z=[];const ee=[];if(G.indexOf("/")===-1)Z=te;else for(let oe=0,xe=te.length;oe<xe;oe++){const Pe=te[oe].split("/");Pe[0]!==""&&Z.push(Pe[0]),Pe[1]!==""&&ee.push(Pe[1])}D.addLineGeometry(Z,ee)}else if(H==="p"){const Z=G.slice(1).trim().split(" ");D.addPointGeometry(Z)}else if((U=f.exec(G))!==null){const te=(" "+U[0].slice(1).trim()).slice(1);D.startObject(te)}else if(A.test(G))D.object.startMaterial(G.substring(7).trim(),D.materialLibraries);else if(p.test(G))D.materialLibraries.push(G.substring(7).trim());else if(g.test(G))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(H==="s"){if(U=G.split(" "),U.length>1){const Z=U[1].trim().toLowerCase();D.object.smooth=Z!=="0"&&Z!=="off"}else D.object.smooth=!0;const te=D.object.currentMaterial();te&&(te.smooth=D.object.smooth)}else{if(G==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+G+'"')}}D.finalize();const K=new d.Group;if(K.materialLibraries=[].concat(D.materialLibraries),!(D.objects.length===1&&D.objects[0].geometry.vertices.length===0)===!0)for(let z=0,j=D.objects.length;z<j;z++){const G=D.objects[z],H=G.geometry,te=G.materials,Z=H.type==="Line",ee=H.type==="Points";let oe=!1;if(H.vertices.length===0)continue;const xe=new d.BufferGeometry;xe.setAttribute("position",new d.Float32BufferAttribute(H.vertices,3)),H.normals.length>0&&xe.setAttribute("normal",new d.Float32BufferAttribute(H.normals,3)),H.colors.length>0&&(oe=!0,xe.setAttribute("color",new d.Float32BufferAttribute(H.colors,3))),H.hasUVIndices===!0&&xe.setAttribute("uv",new d.Float32BufferAttribute(H.uvs,2));const Pe=[];for(let Ce=0,Je=te.length;Ce<Je;Ce++){const Oe=te[Ce],$e=Oe.name+"_"+Oe.smooth+"_"+oe;let nt=D.materials[$e];if(this.materials!==null){if(nt=this.materials.create(Oe.name),Z&&nt&&!(nt instanceof d.LineBasicMaterial)){const gt=new d.LineBasicMaterial;d.Material.prototype.copy.call(gt,nt),gt.color.copy(nt.color),nt=gt}else if(ee&&nt&&!(nt instanceof d.PointsMaterial)){const gt=new d.PointsMaterial({size:10,sizeAttenuation:!1});d.Material.prototype.copy.call(gt,nt),gt.color.copy(nt.color),gt.map=nt.map,nt=gt}}nt===void 0&&(Z?nt=new d.LineBasicMaterial:ee?nt=new d.PointsMaterial({size:1,sizeAttenuation:!1}):nt=new d.MeshPhongMaterial,nt.name=Oe.name,nt.flatShading=!Oe.smooth,nt.vertexColors=oe,D.materials[$e]=nt),Pe.push(nt)}let me;if(Pe.length>1){for(let Ce=0,Je=te.length;Ce<Je;Ce++){const Oe=te[Ce];xe.addGroup(Oe.groupStart,Oe.groupCount,Ce)}Z?me=new d.LineSegments(xe,Pe):ee?me=new d.Points(xe,Pe):me=new d.Mesh(xe,Pe)}else Z?me=new d.LineSegments(xe,Pe[0]):ee?me=new d.Points(xe,Pe[0]):me=new d.Mesh(xe,Pe[0]);me.name=G.name,K.add(me)}else if(D.vertices.length>0){const z=new d.PointsMaterial({size:1,sizeAttenuation:!1}),j=new d.BufferGeometry;j.setAttribute("position",new d.Float32BufferAttribute(D.vertices,3)),D.colors.length>0&&D.colors[0]!==void 0&&(j.setAttribute("color",new d.Float32BufferAttribute(D.colors,3)),z.vertexColors=!0);const G=new d.Points(j,z);K.add(G)}return K}}},"./node_modules/super-three/examples/jsm/math/OBB.js":(c,u,h)=>{h.r(u),h.d(u,{OBB:()=>P});var d=h("./node_modules/super-three/build/three.module.js");const f={c:null,u:[new d.Vector3,new d.Vector3,new d.Vector3],e:[]},p={c:null,u:[new d.Vector3,new d.Vector3,new d.Vector3],e:[]},A=[[],[],[]],g=[[],[],[]],v=[],b=new d.Vector3,x=new d.Vector3,E=new d.Vector3,S=new d.Vector3,M=new d.Vector3,C=new d.Vector3,T=new d.Matrix3,L=new d.Box3,B=new d.Matrix4,F=new d.Matrix4,D=new d.Ray;class P{constructor(J=new d.Vector3,z=new d.Vector3,j=new d.Matrix3){this.center=J,this.halfSize=z,this.rotation=j}set(J,z,j){return this.center=J,this.halfSize=z,this.rotation=j,this}copy(J){return this.center.copy(J.center),this.halfSize.copy(J.halfSize),this.rotation.copy(J.rotation),this}clone(){return new this.constructor().copy(this)}getSize(J){return J.copy(this.halfSize).multiplyScalar(2)}clampPoint(J,z){const j=this.halfSize;S.subVectors(J,this.center),this.rotation.extractBasis(b,x,E),z.copy(this.center);const G=d.MathUtils.clamp(S.dot(b),-j.x,j.x);z.add(b.multiplyScalar(G));const H=d.MathUtils.clamp(S.dot(x),-j.y,j.y);z.add(x.multiplyScalar(H));const te=d.MathUtils.clamp(S.dot(E),-j.z,j.z);return z.add(E.multiplyScalar(te)),z}containsPoint(J){return S.subVectors(J,this.center),this.rotation.extractBasis(b,x,E),Math.abs(S.dot(b))<=this.halfSize.x&&Math.abs(S.dot(x))<=this.halfSize.y&&Math.abs(S.dot(E))<=this.halfSize.z}intersectsBox3(J){return this.intersectsOBB(U.fromBox3(J))}intersectsSphere(J){return this.clampPoint(J.center,C),C.distanceToSquared(J.center)<=J.radius*J.radius}intersectsOBB(J,z=Number.EPSILON){f.c=this.center,f.e[0]=this.halfSize.x,f.e[1]=this.halfSize.y,f.e[2]=this.halfSize.z,this.rotation.extractBasis(f.u[0],f.u[1],f.u[2]),p.c=J.center,p.e[0]=J.halfSize.x,p.e[1]=J.halfSize.y,p.e[2]=J.halfSize.z,J.rotation.extractBasis(p.u[0],p.u[1],p.u[2]);for(let H=0;H<3;H++)for(let te=0;te<3;te++)A[H][te]=f.u[H].dot(p.u[te]);S.subVectors(p.c,f.c),v[0]=S.dot(f.u[0]),v[1]=S.dot(f.u[1]),v[2]=S.dot(f.u[2]);for(let H=0;H<3;H++)for(let te=0;te<3;te++)g[H][te]=Math.abs(A[H][te])+z;let j,G;for(let H=0;H<3;H++)if(j=f.e[H],G=p.e[0]*g[H][0]+p.e[1]*g[H][1]+p.e[2]*g[H][2],Math.abs(v[H])>j+G)return!1;for(let H=0;H<3;H++)if(j=f.e[0]*g[0][H]+f.e[1]*g[1][H]+f.e[2]*g[2][H],G=p.e[H],Math.abs(v[0]*A[0][H]+v[1]*A[1][H]+v[2]*A[2][H])>j+G)return!1;return j=f.e[1]*g[2][0]+f.e[2]*g[1][0],G=p.e[1]*g[0][2]+p.e[2]*g[0][1],!(Math.abs(v[2]*A[1][0]-v[1]*A[2][0])>j+G||(j=f.e[1]*g[2][1]+f.e[2]*g[1][1],G=p.e[0]*g[0][2]+p.e[2]*g[0][0],Math.abs(v[2]*A[1][1]-v[1]*A[2][1])>j+G)||(j=f.e[1]*g[2][2]+f.e[2]*g[1][2],G=p.e[0]*g[0][1]+p.e[1]*g[0][0],Math.abs(v[2]*A[1][2]-v[1]*A[2][2])>j+G)||(j=f.e[0]*g[2][0]+f.e[2]*g[0][0],G=p.e[1]*g[1][2]+p.e[2]*g[1][1],Math.abs(v[0]*A[2][0]-v[2]*A[0][0])>j+G)||(j=f.e[0]*g[2][1]+f.e[2]*g[0][1],G=p.e[0]*g[1][2]+p.e[2]*g[1][0],Math.abs(v[0]*A[2][1]-v[2]*A[0][1])>j+G)||(j=f.e[0]*g[2][2]+f.e[2]*g[0][2],G=p.e[0]*g[1][1]+p.e[1]*g[1][0],Math.abs(v[0]*A[2][2]-v[2]*A[0][2])>j+G)||(j=f.e[0]*g[1][0]+f.e[1]*g[0][0],G=p.e[1]*g[2][2]+p.e[2]*g[2][1],Math.abs(v[1]*A[0][0]-v[0]*A[1][0])>j+G)||(j=f.e[0]*g[1][1]+f.e[1]*g[0][1],G=p.e[0]*g[2][2]+p.e[2]*g[2][0],Math.abs(v[1]*A[0][1]-v[0]*A[1][1])>j+G)||(j=f.e[0]*g[1][2]+f.e[1]*g[0][2],G=p.e[0]*g[2][1]+p.e[1]*g[2][0],Math.abs(v[1]*A[0][2]-v[0]*A[1][2])>j+G))}intersectsPlane(J){this.rotation.extractBasis(b,x,E);const z=this.halfSize.x*Math.abs(J.normal.dot(b))+this.halfSize.y*Math.abs(J.normal.dot(x))+this.halfSize.z*Math.abs(J.normal.dot(E)),j=J.normal.dot(this.center)-J.constant;return Math.abs(j)<=z}intersectRay(J,z){return this.getSize(M),L.setFromCenterAndSize(S.set(0,0,0),M),B.setFromMatrix3(this.rotation),B.setPosition(this.center),F.copy(B).invert(),D.copy(J).applyMatrix4(F),D.intersectBox(L,z)?z.applyMatrix4(B):null}intersectsRay(J){return this.intersectRay(J,S)!==null}fromBox3(J){return J.getCenter(this.center),J.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(J){return J.center.equals(this.center)&&J.halfSize.equals(this.halfSize)&&J.rotation.equals(this.rotation)}applyMatrix4(J){const z=J.elements;let j=S.set(z[0],z[1],z[2]).length();const G=S.set(z[4],z[5],z[6]).length(),H=S.set(z[8],z[9],z[10]).length();J.determinant()<0&&(j=-j),T.setFromMatrix4(J);const Z=1/j,ee=1/G,oe=1/H;return T.elements[0]*=Z,T.elements[1]*=Z,T.elements[2]*=Z,T.elements[3]*=ee,T.elements[4]*=ee,T.elements[5]*=ee,T.elements[6]*=oe,T.elements[7]*=oe,T.elements[8]*=oe,this.rotation.multiply(T),this.halfSize.x*=j,this.halfSize.y*=G,this.halfSize.z*=H,S.setFromMatrixPosition(J),this.center.add(S),this}}const U=new P},"./node_modules/super-three/examples/jsm/utils/BufferGeometryUtils.js":(c,u,h)=>{h.r(u),h.d(u,{computeMikkTSpaceTangents:()=>f,computeMorphedAttributes:()=>C,deepCloneAttribute:()=>g,deinterleaveAttribute:()=>b,deinterleaveGeometry:()=>x,estimateBytesUsed:()=>E,interleaveAttributes:()=>v,mergeAttributes:()=>A,mergeBufferAttributes:()=>F,mergeBufferGeometries:()=>B,mergeGeometries:()=>p,mergeGroups:()=>T,mergeVertices:()=>S,toCreasedNormals:()=>L,toTrianglesDrawMode:()=>M});var d=h("./node_modules/super-three/build/three.module.js");function f(D,P,U=!0){if(!P||!P.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!D.hasAttribute("position")||!D.hasAttribute("normal")||!D.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function K(j){if(j.normalized||j.isInterleavedBufferAttribute){const G=new Float32Array(j.count*j.itemSize);for(let H=0,te=0;H<j.count;H++)G[te++]=j.getX(H),G[te++]=j.getY(H),j.itemSize>2&&(G[te++]=j.getZ(H));return G}return j.array instanceof Float32Array?j.array:new Float32Array(j.array)}const J=D.index?D.toNonIndexed():D,z=P.generateTangents(K(J.attributes.position),K(J.attributes.normal),K(J.attributes.uv));if(U)for(let j=3;j<z.length;j+=4)z[j]*=-1;return J.setAttribute("tangent",new d.BufferAttribute(z,4)),D!==J&&D.copy(J),D}function p(D,P=!1){const U=D[0].index!==null,K=new Set(Object.keys(D[0].attributes)),J=new Set(Object.keys(D[0].morphAttributes)),z={},j={},G=D[0].morphTargetsRelative,H=new d.BufferGeometry;let te=0;for(let Z=0;Z<D.length;++Z){const ee=D[Z];let oe=0;if(U!==(ee.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Z+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const xe in ee.attributes){if(!K.has(xe))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Z+'. All geometries must have compatible attributes; make sure "'+xe+'" attribute exists among all geometries, or in none of them.'),null;z[xe]===void 0&&(z[xe]=[]),z[xe].push(ee.attributes[xe]),oe++}if(oe!==K.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Z+". Make sure all geometries have the same number of attributes."),null;if(G!==ee.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Z+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const xe in ee.morphAttributes){if(!J.has(xe))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Z+".  .morphAttributes must be consistent throughout all geometries."),null;j[xe]===void 0&&(j[xe]=[]),j[xe].push(ee.morphAttributes[xe])}if(P){let xe;if(U)xe=ee.index.count;else if(ee.attributes.position!==void 0)xe=ee.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Z+". The geometry must have either an index or a position attribute"),null;H.addGroup(te,xe,Z),te+=xe}}if(U){let Z=0;const ee=[];for(let oe=0;oe<D.length;++oe){const xe=D[oe].index;for(let Pe=0;Pe<xe.count;++Pe)ee.push(xe.getX(Pe)+Z);Z+=D[oe].attributes.position.count}H.setIndex(ee)}for(const Z in z){const ee=A(z[Z]);if(!ee)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Z+" attribute."),null;H.setAttribute(Z,ee)}for(const Z in j){const ee=j[Z][0].length;if(ee===0)break;H.morphAttributes=H.morphAttributes||{},H.morphAttributes[Z]=[];for(let oe=0;oe<ee;++oe){const xe=[];for(let me=0;me<j[Z].length;++me)xe.push(j[Z][me][oe]);const Pe=A(xe);if(!Pe)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Z+" morphAttribute."),null;H.morphAttributes[Z].push(Pe)}}return H}function A(D){let P,U,K,J=-1,z=0;for(let te=0;te<D.length;++te){const Z=D[te];if(Z.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(P===void 0&&(P=Z.array.constructor),P!==Z.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(U===void 0&&(U=Z.itemSize),U!==Z.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(K===void 0&&(K=Z.normalized),K!==Z.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(J===-1&&(J=Z.gpuType),J!==Z.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;z+=Z.array.length}const j=new P(z);let G=0;for(let te=0;te<D.length;++te)j.set(D[te].array,G),G+=D[te].array.length;const H=new d.BufferAttribute(j,U,K);return J!==void 0&&(H.gpuType=J),H}function g(D){return D.isInstancedInterleavedBufferAttribute||D.isInterleavedBufferAttribute?b(D):D.isInstancedBufferAttribute?new d.InstancedBufferAttribute().copy(D):new d.BufferAttribute().copy(D)}function v(D){let P,U=0,K=0;for(let te=0,Z=D.length;te<Z;++te){const ee=D[te];if(P===void 0&&(P=ee.array.constructor),P!==ee.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;U+=ee.array.length,K+=ee.itemSize}const J=new d.InterleavedBuffer(new P(U),K);let z=0;const j=[],G=["getX","getY","getZ","getW"],H=["setX","setY","setZ","setW"];for(let te=0,Z=D.length;te<Z;te++){const ee=D[te],oe=ee.itemSize,xe=ee.count,Pe=new d.InterleavedBufferAttribute(J,oe,z,ee.normalized);j.push(Pe),z+=oe;for(let me=0;me<xe;me++)for(let Ce=0;Ce<oe;Ce++)Pe[H[Ce]](me,ee[G[Ce]](me))}return j}function b(D){const P=D.data.array.constructor,U=D.count,K=D.itemSize,J=D.normalized,z=new P(U*K);let j;D.isInstancedInterleavedBufferAttribute?j=new d.InstancedBufferAttribute(z,K,J,D.meshPerAttribute):j=new d.BufferAttribute(z,K,J);for(let G=0;G<U;G++)j.setX(G,D.getX(G)),K>=2&&j.setY(G,D.getY(G)),K>=3&&j.setZ(G,D.getZ(G)),K>=4&&j.setW(G,D.getW(G));return j}function x(D){const P=D.attributes,U=D.morphTargets,K=new Map;for(const J in P){const z=P[J];z.isInterleavedBufferAttribute&&(K.has(z)||K.set(z,b(z)),P[J]=K.get(z))}for(const J in U){const z=U[J];z.isInterleavedBufferAttribute&&(K.has(z)||K.set(z,b(z)),U[J]=K.get(z))}}function E(D){let P=0;for(const K in D.attributes){const J=D.getAttribute(K);P+=J.count*J.itemSize*J.array.BYTES_PER_ELEMENT}const U=D.getIndex();return P+=U?U.count*U.itemSize*U.array.BYTES_PER_ELEMENT:0,P}function S(D,P=1e-4){P=Math.max(P,Number.EPSILON);const U={},K=D.getIndex(),J=D.getAttribute("position"),z=K?K.count:J.count;let j=0;const G=Object.keys(D.attributes),H={},te={},Z=[],ee=["getX","getY","getZ","getW"],oe=["setX","setY","setZ","setW"];for(let Oe=0,$e=G.length;Oe<$e;Oe++){const nt=G[Oe],gt=D.attributes[nt];H[nt]=new d.BufferAttribute(new gt.array.constructor(gt.count*gt.itemSize),gt.itemSize,gt.normalized);const Tt=D.morphAttributes[nt];Tt&&(te[nt]=new d.BufferAttribute(new Tt.array.constructor(Tt.count*Tt.itemSize),Tt.itemSize,Tt.normalized))}const xe=P*.5,Pe=Math.log10(1/P),me=Math.pow(10,Pe),Ce=xe*me;for(let Oe=0;Oe<z;Oe++){const $e=K?K.getX(Oe):Oe;let nt="";for(let gt=0,Tt=G.length;gt<Tt;gt++){const Ze=G[gt],mn=D.getAttribute(Ze),Ft=mn.itemSize;for(let Qt=0;Qt<Ft;Qt++)nt+=`${~~(mn[ee[Qt]]($e)*me+Ce)},`}if(nt in U)Z.push(U[nt]);else{for(let gt=0,Tt=G.length;gt<Tt;gt++){const Ze=G[gt],mn=D.getAttribute(Ze),Ft=D.morphAttributes[Ze],Qt=mn.itemSize,Xt=H[Ze],Tn=te[Ze];for(let vn=0;vn<Qt;vn++){const Fe=ee[vn],Te=oe[vn];if(Xt[Te](j,mn[Fe]($e)),Ft)for(let pt=0,Nt=Ft.length;pt<Nt;pt++)Tn[pt][Te](j,Ft[pt][Fe]($e))}}U[nt]=j,Z.push(j),j++}}const Je=D.clone();for(const Oe in D.attributes){const $e=H[Oe];if(Je.setAttribute(Oe,new d.BufferAttribute($e.array.slice(0,j*$e.itemSize),$e.itemSize,$e.normalized)),Oe in te)for(let nt=0;nt<te[Oe].length;nt++){const gt=te[Oe][nt];Je.morphAttributes[Oe][nt]=new d.BufferAttribute(gt.array.slice(0,j*gt.itemSize),gt.itemSize,gt.normalized)}}return Je.setIndex(Z),Je}function M(D,P){if(P===d.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),D;if(P===d.TriangleFanDrawMode||P===d.TriangleStripDrawMode){let U=D.getIndex();if(U===null){const j=[],G=D.getAttribute("position");if(G!==void 0){for(let H=0;H<G.count;H++)j.push(H);D.setIndex(j),U=D.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),D}const K=U.count-2,J=[];if(P===d.TriangleFanDrawMode)for(let j=1;j<=K;j++)J.push(U.getX(0)),J.push(U.getX(j)),J.push(U.getX(j+1));else for(let j=0;j<K;j++)j%2===0?(J.push(U.getX(j)),J.push(U.getX(j+1)),J.push(U.getX(j+2))):(J.push(U.getX(j+2)),J.push(U.getX(j+1)),J.push(U.getX(j)));J.length/3!==K&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const z=D.clone();return z.setIndex(J),z.clearGroups(),z}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",P),D}function C(D){const P=new d.Vector3,U=new d.Vector3,K=new d.Vector3,J=new d.Vector3,z=new d.Vector3,j=new d.Vector3,G=new d.Vector3,H=new d.Vector3,te=new d.Vector3;function Z(Vt,fn,mt,Ee,_e,Ne,ye,De){P.fromBufferAttribute(fn,_e),U.fromBufferAttribute(fn,Ne),K.fromBufferAttribute(fn,ye);const ke=Vt.morphTargetInfluences;if(mt&&ke){G.set(0,0,0),H.set(0,0,0),te.set(0,0,0);for(let Ye=0,Qe=mt.length;Ye<Qe;Ye++){const ne=ke[Ye],W=mt[Ye];ne!==0&&(J.fromBufferAttribute(W,_e),z.fromBufferAttribute(W,Ne),j.fromBufferAttribute(W,ye),Ee?(G.addScaledVector(J,ne),H.addScaledVector(z,ne),te.addScaledVector(j,ne)):(G.addScaledVector(J.sub(P),ne),H.addScaledVector(z.sub(U),ne),te.addScaledVector(j.sub(K),ne)))}P.add(G),U.add(H),K.add(te)}Vt.isSkinnedMesh&&(Vt.applyBoneTransform(_e,P),Vt.applyBoneTransform(Ne,U),Vt.applyBoneTransform(ye,K)),De[_e*3+0]=P.x,De[_e*3+1]=P.y,De[_e*3+2]=P.z,De[Ne*3+0]=U.x,De[Ne*3+1]=U.y,De[Ne*3+2]=U.z,De[ye*3+0]=K.x,De[ye*3+1]=K.y,De[ye*3+2]=K.z}const ee=D.geometry,oe=D.material;let xe,Pe,me;const Ce=ee.index,Je=ee.attributes.position,Oe=ee.morphAttributes.position,$e=ee.morphTargetsRelative,nt=ee.attributes.normal,gt=ee.morphAttributes.position,Tt=ee.groups,Ze=ee.drawRange;let mn,Ft,Qt,Xt,Tn,vn,Fe;const Te=new Float32Array(Je.count*Je.itemSize),pt=new Float32Array(nt.count*nt.itemSize);if(Ce!==null)if(Array.isArray(oe))for(mn=0,Qt=Tt.length;mn<Qt;mn++)for(Tn=Tt[mn],vn=Math.max(Tn.start,Ze.start),Fe=Math.min(Tn.start+Tn.count,Ze.start+Ze.count),Ft=vn,Xt=Fe;Ft<Xt;Ft+=3)xe=Ce.getX(Ft),Pe=Ce.getX(Ft+1),me=Ce.getX(Ft+2),Z(D,Je,Oe,$e,xe,Pe,me,Te),Z(D,nt,gt,$e,xe,Pe,me,pt);else for(vn=Math.max(0,Ze.start),Fe=Math.min(Ce.count,Ze.start+Ze.count),mn=vn,Qt=Fe;mn<Qt;mn+=3)xe=Ce.getX(mn),Pe=Ce.getX(mn+1),me=Ce.getX(mn+2),Z(D,Je,Oe,$e,xe,Pe,me,Te),Z(D,nt,gt,$e,xe,Pe,me,pt);else if(Array.isArray(oe))for(mn=0,Qt=Tt.length;mn<Qt;mn++)for(Tn=Tt[mn],vn=Math.max(Tn.start,Ze.start),Fe=Math.min(Tn.start+Tn.count,Ze.start+Ze.count),Ft=vn,Xt=Fe;Ft<Xt;Ft+=3)xe=Ft,Pe=Ft+1,me=Ft+2,Z(D,Je,Oe,$e,xe,Pe,me,Te),Z(D,nt,gt,$e,xe,Pe,me,pt);else for(vn=Math.max(0,Ze.start),Fe=Math.min(Je.count,Ze.start+Ze.count),mn=vn,Qt=Fe;mn<Qt;mn+=3)xe=mn,Pe=mn+1,me=mn+2,Z(D,Je,Oe,$e,xe,Pe,me,Te),Z(D,nt,gt,$e,xe,Pe,me,pt);const Nt=new d.Float32BufferAttribute(Te,3),zt=new d.Float32BufferAttribute(pt,3);return{positionAttribute:Je,normalAttribute:nt,morphedPositionAttribute:Nt,morphedNormalAttribute:zt}}function T(D){if(D.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),D;let P=D.groups;if(P=P.sort((j,G)=>j.materialIndex!==G.materialIndex?j.materialIndex-G.materialIndex:j.start-G.start),D.getIndex()===null){const j=D.getAttribute("position"),G=[];for(let H=0;H<j.count;H+=3)G.push(H,H+1,H+2);D.setIndex(G)}const U=D.getIndex(),K=[];for(let j=0;j<P.length;j++){const G=P[j],H=G.start,te=H+G.count;for(let Z=H;Z<te;Z++)K.push(U.getX(Z))}D.dispose(),D.setIndex(K);let J=0;for(let j=0;j<P.length;j++){const G=P[j];G.start=J,J+=G.count}let z=P[0];D.groups=[z];for(let j=1;j<P.length;j++){const G=P[j];z.materialIndex===G.materialIndex?z.count+=G.count:(z=G,D.groups.push(z))}return D}function L(D,P=Math.PI/3){const U=Math.cos(P),K=(1+1e-10)*100,J=[new d.Vector3,new d.Vector3,new d.Vector3],z=new d.Vector3,j=new d.Vector3,G=new d.Vector3,H=new d.Vector3;function te(me){const Ce=~~(me.x*K),Je=~~(me.y*K),Oe=~~(me.z*K);return`${Ce},${Je},${Oe}`}const Z=D.index?D.toNonIndexed():D,ee=Z.attributes.position,oe={};for(let me=0,Ce=ee.count/3;me<Ce;me++){const Je=3*me,Oe=J[0].fromBufferAttribute(ee,Je+0),$e=J[1].fromBufferAttribute(ee,Je+1),nt=J[2].fromBufferAttribute(ee,Je+2);z.subVectors(nt,$e),j.subVectors(Oe,$e);const gt=new d.Vector3().crossVectors(z,j).normalize();for(let Tt=0;Tt<3;Tt++){const Ze=J[Tt],mn=te(Ze);mn in oe||(oe[mn]=[]),oe[mn].push(gt)}}const xe=new Float32Array(ee.count*3),Pe=new d.BufferAttribute(xe,3,!1);for(let me=0,Ce=ee.count/3;me<Ce;me++){const Je=3*me,Oe=J[0].fromBufferAttribute(ee,Je+0),$e=J[1].fromBufferAttribute(ee,Je+1),nt=J[2].fromBufferAttribute(ee,Je+2);z.subVectors(nt,$e),j.subVectors(Oe,$e),G.crossVectors(z,j).normalize();for(let gt=0;gt<3;gt++){const Tt=J[gt],Ze=te(Tt),mn=oe[Ze];H.set(0,0,0);for(let Ft=0,Qt=mn.length;Ft<Qt;Ft++){const Xt=mn[Ft];G.dot(Xt)>U&&H.add(Xt)}H.normalize(),Pe.setXYZ(Je+gt,H.x,H.y,H.z)}}return Z.setAttribute("normal",Pe),Z}function B(D,P=!1){return console.warn("THREE.BufferGeometryUtils: mergeBufferGeometries() has been renamed to mergeGeometries()."),p(D,P)}function F(D){return console.warn("THREE.BufferGeometryUtils: mergeBufferAttributes() has been renamed to mergeAttributes()."),A(D)}},"./node_modules/super-three/examples/jsm/utils/WorkerPool.js":(c,u,h)=>{h.r(u),h.d(u,{WorkerPool:()=>d});class d{constructor(p=4){this.pool=p,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(p){if(!this.workers[p]){const A=this.workerCreator();A.addEventListener("message",this._onMessage.bind(this,p)),this.workers[p]=A}}_getIdleWorker(){for(let p=0;p<this.pool;p++)if(!(this.workerStatus&1<<p))return p;return-1}_onMessage(p,A){const g=this.workersResolve[p];if(g&&g(A),this.queue.length){const{resolve:v,msg:b,transfer:x}=this.queue.shift();this.workersResolve[p]=v,this.workers[p].postMessage(b,x)}else this.workerStatus^=1<<p}setWorkerCreator(p){this.workerCreator=p}setWorkerLimit(p){this.pool=p}postMessage(p,A){return new Promise(g=>{const v=this._getIdleWorker();v!==-1?(this._initWorker(v),this.workerStatus|=1<<v,this.workersResolve[v]=g,this.workers[v].postMessage(p,A)):this.queue.push({resolve:g,msg:p,transfer:A})})}dispose(){this.workers.forEach(p=>p.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./package.json":c=>{c.exports=JSON.parse('{"name":"aframe","version":"1.5.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.4.2 1.5.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"@ungap/custom-elements":"^1.1.0","buffer":"^6.0.3","custom-event-polyfill":"^1.0.6","debug":"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","object-assign":"^4.0.1","present":"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"0.158.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^20.0.0","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},i={};function o(c){var u=i[c];if(u!==void 0)return u.exports;var h=i[c]={id:c,exports:{}};return n[c].call(h.exports,h,h.exports,o),h.exports}o.m=n,o.n=c=>{var u=c&&c.__esModule?()=>c.default:()=>c;return o.d(u,{a:u}),u},o.d=(c,u)=>{for(var h in u)o.o(u,h)&&!o.o(c,h)&&Object.defineProperty(c,h,{enumerable:!0,get:u[h]})},o.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),o.o=(c,u)=>Object.prototype.hasOwnProperty.call(c,u),o.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},o.b=document.baseURI||self.location.href,o.nc=void 0;var a=o("./src/index.js");return a})())})(eU);const uC=.1;AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(s){const e=this.el;if(this.active&&this.checkpoint!==s){if(this.checkpoint&&e.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=s,this.sync(),this.position.distanceTo(this.targetPosition)<uC){this.checkpoint=null;return}e.emit("navigation-start",{checkpoint:s}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,e.emit("navigation-end",{checkpoint:s}),e.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const s=this.data,e=this.offset,n=this.position,i=this.targetPosition,o=this.checkpoint;return this.sync(),n.distanceTo(i)<uC?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:o}),e.set(0,0,0)):(e.setLength(s.animateSpeed),e)},sync:function(){const s=this.offset,e=this.position,n=this.targetPosition;e.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(n),n.add(this.checkpoint.components.checkpoint.getOffset()),s.copy(n).sub(e)}});var tU=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16});function nU(s,e,n){this.type=s,this.index=e,this.pressed=n.pressed,this.value=n.value}var iU=nU;const Qu=tU,i1=iU,vc=.2,vl={LEFT:"left",RIGHT:"right"},yl={MOVEMENT:1,ROTATION:2};AFRAME.registerComponent("gamepad-controls",{GamepadButton:Qu,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){const s=this.el.sceneEl;this.system=s.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const e=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=e.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=e.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,s.addBehavior(this)},update:function(){this.tick()},tick:function(s,e){this.updateButtonState(),this.updateRotation(e)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const s=this._dpadVector,e=this._moveVector;this.getDpad(s),this.getJoystick(yl.MOVEMENT,e);const n=s.x||e.x,i=s.y||e.y;return Math.abs(n)>vc||Math.abs(i)>vc},getVelocityDelta:function(){const s=this._dpadVector,e=this._moveVector;this.getDpad(s),this.getJoystick(yl.MOVEMENT,e);const n=s.x||e.x,i=s.y||e.y,o=new THREE.Vector3;return Math.abs(n)>vc&&(o.x+=n),Math.abs(i)>vc&&(o.z+=i),o},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const s=this._lookVector;return this.getJoystick(yl.ROTATION,s),Math.abs(s.x)>vc||Math.abs(s.y)>vc},updateRotation:function(s){if(!this.isRotationActive())return;const e=this.data,n=this.yaw,i=this.pitch;n.rotation.y=this.el.object3D.rotation.y,i.rotation.x=this.el.object3D.rotation.x;const o=this._lookVector;this.getJoystick(yl.ROTATION,o),Math.abs(o.x)<=vc&&(o.x=0),Math.abs(o.y)<=vc&&(o.y=0),o.multiplyScalar(e.rotationSensitivity*s/1e3),n.rotation.y-=o.x,i.rotation.x-=o.y,i.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,i.rotation.x)),this.el.object3D.rotation.set(i.rotation.x,n.rotation.y,0)},updateButtonState:function(){const s=this.getGamepad(vl.RIGHT);if(this.data.enabled&&s)for(var e=0;e<s.buttons.length;e++)s.buttons[e].pressed&&!this.buttons[e]?this.emit(new i1("gamepadbuttondown",e,s.buttons[e])):!s.buttons[e].pressed&&this.buttons[e]&&this.emit(new i1("gamepadbuttonup",e,s.buttons[e])),this.buttons[e]=s.buttons[e].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(s){this.el.emit(s.type,s),this.el.emit(s.type+":"+s.index,new i1(s.type,s.index,s))},getGamepad:function(){const s=[],e=[];return function(n){const i=this.el.sceneEl.components["proxy-controls"],o=i&&i.isConnected()&&i.getGamepad(0);if(o)return o;s.length=0;for(let c=0;c<this.system.controllers.length;c++){const u=this.system.controllers[c],h=u?u.gamepad:null;if(s.push(h),h&&u.handedness===n)return h}const a=navigator.getGamepads?navigator.getGamepads():e;for(let c=0;c<a.length;c++){const u=a[c];if(u&&u.hand===n)return u}return s[0]||a[0]}}(),getButton:function(s){return this.getGamepad(vl.RIGHT).buttons[s]},getAxis:function(s){return this.getGamepad(s>1?vl.RIGHT:vl.LEFT).axes[s]},getJoystick:function(s,e){const n=this.getGamepad(s===yl.MOVEMENT?vl.LEFT:vl.RIGHT);if(!n)return e.set(0,0);if(n.mapping==="xr-standard")switch(s){case yl.MOVEMENT:return e.set(n.axes[2],n.axes[3]);case yl.ROTATION:return e.set(n.axes[2],0)}else switch(s){case yl.MOVEMENT:return e.set(n.axes[0],n.axes[1]);case yl.ROTATION:return e.set(n.axes[2],n.axes[3])}throw new Error('Unexpected joystick index "%d".',s)},getDpad:function(s){const e=this.getGamepad(vl.LEFT);return!e||!e.buttons[Qu.DPAD_RIGHT]?s.set(0,0):s.set((e.buttons[Qu.DPAD_RIGHT].pressed?1:0)+(e.buttons[Qu.DPAD_LEFT].pressed?-1:0),(e.buttons[Qu.DPAD_UP].pressed?-1:0)+(e.buttons[Qu.DPAD_DOWN].pressed?1:0))},isConnected:function(){const s=this.getGamepad(vl.LEFT);return!!(s&&s.connected)},getID:function(){return this.getGamepad(vl.LEFT).id}});(function(s){var e="KeyboardEvent"in s;e||(s.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var n=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,i=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,o=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,a=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function c(T,L){return String(T).indexOf(L)!==-1}var u=function(){return c(navigator.platform,"Win")?"win":c(navigator.platform,"Mac")?"mac":c(navigator.platform,"CrOS")?"cros":c(navigator.platform,"Linux")?"linux":c(navigator.userAgent,"iPad")||c(navigator.platform,"iPod")||c(navigator.platform,"iPhone")?"ios":""}(),h=function(){return c(navigator.userAgent,"Chrome/")?"chrome":c(navigator.vendor,"Apple")?"safari":c(navigator.userAgent,"MSIE")?"ie":c(navigator.userAgent,"Gecko/")?"moz":c(navigator.userAgent,"Opera/")?"opera":""}(),d=h+"-"+u;function f(T,L,B){(d===L||h===L||u===L)&&Object.keys(B).forEach(function(F){T[F]=B[F]})}function p(T,L){var B={};return Object.keys(T).forEach(function(F){var D=T[F];L in D&&(B[D[L]]=D)}),B}var A={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:i},92:{code:"OSRight",location:o},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:a},97:{code:"Numpad1",keyCap:"1",location:a},98:{code:"Numpad2",keyCap:"2",location:a},99:{code:"Numpad3",keyCap:"3",location:a},100:{code:"Numpad4",keyCap:"4",location:a},101:{code:"Numpad5",keyCap:"5",location:a},102:{code:"Numpad6",keyCap:"6",location:a},103:{code:"Numpad7",keyCap:"7",location:a},104:{code:"Numpad8",keyCap:"8",location:a},105:{code:"Numpad9",keyCap:"9",location:a},106:{code:"NumpadMultiply",keyCap:"*",location:a},107:{code:"NumpadAdd",keyCap:"+",location:a},108:{code:"NumpadComma",keyCap:",",location:a},109:{code:"NumpadSubtract",keyCap:"-",location:a},110:{code:"NumpadDecimal",keyCap:".",location:a},111:{code:"NumpadDivide",keyCap:"/",location:a},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:a},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:i},161:{code:"ShiftRight",location:o},162:{code:"ControlLeft",location:i},163:{code:"ControlRight",location:o},164:{code:"AltLeft",location:i},165:{code:"AltRight",location:o},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};f(A,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:a},189:{code:"NumpadSubtract",keyCap:"-",location:a}}),f(A,"moz-mac",{12:{code:"NumLock",location:a},173:{code:"Minus",keyCap:"-"}}),f(A,"moz-win",{173:{code:"Minus",keyCap:"-"}}),f(A,"chrome-mac",{93:{code:"OSRight",location:o}}),f(A,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),f(A,"ios",{10:{code:"Enter",location:n}}),f(A,"safari-mac",{91:{code:"OSLeft",location:i},93:{code:"OSRight",location:o},229:{code:"KeyQ",keyCap:"Q"}});var g={};u==="cros"&&(g["U+00A0"]={code:"ShiftLeft",location:i},g["U+00A1"]={code:"ShiftRight",location:o},g["U+00A2"]={code:"ControlLeft",location:i},g["U+00A3"]={code:"ControlRight",location:o},g["U+00A4"]={code:"AltLeft",location:i},g["U+00A5"]={code:"AltRight",location:o}),d==="chrome-mac"&&(g["U+0010"]={code:"ContextMenu"}),d==="safari-mac"&&(g["U+0010"]={code:"ContextMenu"}),u==="ios"&&(g["U+0010"]={code:"Function"},g["U+001C"]={code:"ArrowLeft"},g["U+001D"]={code:"ArrowRight"},g["U+001E"]={code:"ArrowUp"},g["U+001F"]={code:"ArrowDown"},g["U+0001"]={code:"Home"},g["U+0004"]={code:"End"},g["U+000B"]={code:"PageUp"},g["U+000C"]={code:"PageDown"});var v=[];v[i]={16:{code:"ShiftLeft",location:i},17:{code:"ControlLeft",location:i},18:{code:"AltLeft",location:i}},v[o]={16:{code:"ShiftRight",location:o},17:{code:"ControlRight",location:o},18:{code:"AltRight",location:o}},v[a]={13:{code:"NumpadEnter",location:a}},f(v[a],"moz",{109:{code:"NumpadSubtract",location:a},107:{code:"NumpadAdd",location:a}}),f(v[i],"moz-mac",{224:{code:"OSLeft",location:i}}),f(v[o],"moz-mac",{224:{code:"OSRight",location:o}}),f(v[o],"moz-win",{91:{code:"OSRight",location:o}}),f(v[o],"mac",{93:{code:"OSRight",location:o}}),f(v[a],"chrome-mac",{12:{code:"NumLock",location:a}}),f(v[a],"safari-mac",{12:{code:"NumLock",location:a},187:{code:"NumpadAdd",location:a},189:{code:"NumpadSubtract",location:a},190:{code:"NumpadDecimal",location:a},191:{code:"NumpadDivide",location:a}});var b={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};f(b,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var x={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},E=p(A,"code");try{var S=e&&"location"in new KeyboardEvent("")}catch{}function M(T){var L="keyCode"in T?T.keyCode:"which"in T?T.which:0,B=function(){if(S||"keyLocation"in T){var D=S?T.location:T.keyLocation;if(D&&L in v[D])return v[D][L]}return"keyIdentifier"in T&&T.keyIdentifier in g?g[T.keyIdentifier]:L in A?A[L]:null}();if(!B)return null;var F=function(){var D=b[B.code];return D?T.shiftKey&&"shiftKey"in D?D.shiftKey:D.key:B.code}();return{code:B.code,key:F,location:B.location,keyCap:B.keyCap}}function C(T,L){if(T=String(T),!E.hasOwnProperty(T))return"Undefined";if(L&&String(L).toLowerCase()!=="en-us")throw Error("Unsupported locale");var B=E[T];return B.keyCap||B.code||"Undefined"}"KeyboardEvent"in s&&"defineProperty"in Object&&function(){function T(B,F,D){F in B||Object.defineProperty(B,F,D)}if(T(KeyboardEvent.prototype,"code",{get:function(){var B=M(this);return B?B.code:""}}),"key"in KeyboardEvent.prototype){var L=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var B=L.get.call(this);return x.hasOwnProperty(B)?x[B]:B}})}T(KeyboardEvent.prototype,"key",{get:function(){var B=M(this);return B&&"key"in B?B.key:"Unidentified"}}),T(KeyboardEvent.prototype,"location",{get:function(){var B=M(this);return B&&"location"in B?B.location:n}}),T(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in s.KeyboardEvent||(s.KeyboardEvent.queryKeyCap=C),s.identifyKey=function(T){if(!("code"in T)){var L=M(T);T.code=L?L.code:"",T.key=L&&"key"in L?L.key:"Unidentified",T.location="location"in T?T.location:"keyLocation"in T?T.keyLocation:L&&"location"in L?L.location:n,T.locale=""}}})(window);const rU="__keyboard-controls-proxy",sU=window.KeyboardEvent;AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const s=this.data,e=this.getKeys();return this.dVelocity.set(0,0,0),s.enabled&&((e.KeyW||e.ArrowUp)&&(this.dVelocity.z-=1),(e.KeyA||e.ArrowLeft)&&(this.dVelocity.x-=1),(e.KeyS||e.ArrowDown)&&(this.dVelocity.z+=1),(e.KeyD||e.ArrowRight)&&(this.dVelocity.x+=1),e.ShiftLeft&&(this.dVelocity=this.dVelocity.multiplyScalar(2))),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(const s in this.localKeys)this.localKeys.hasOwnProperty(s)&&delete this.localKeys[s]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(s){AFRAME.utils.shouldCaptureKeyEvent(s)&&(this.localKeys[s.code]=!0,this.emit(s))},onKeyUp:function(s){AFRAME.utils.shouldCaptureKeyEvent(s)&&(delete this.localKeys[s.code],this.emit(s))},onBlur:function(){for(const s in this.localKeys)this.localKeys.hasOwnProperty(s)&&delete this.localKeys[s]},emit:function(s){rU in s&&this.el.emit(s.type,s),this.el.emit(s.type+":"+s.code,new sU(s.type,s)),this.data.debug&&console.log(s.type+":"+s.code)},isPressed:function(s){return s in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const s=this.el.sceneEl.components["proxy-controls"];return s&&s.isConnected()}});AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const s=this.el.sceneEl,e=s.canvas;if(!e){s.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}e.addEventListener("touchstart",this.onTouchStart),e.addEventListener("touchend",this.onTouchEnd);const n=s.getAttribute("vr-mode-ui");n&&n.cardboardModeEnabled&&s.addEventListener("enter-vr",this.onEnterVR)},removeEventListeners:function(){const s=this.el.sceneEl&&this.el.sceneEl.canvas;s&&(s.removeEventListener("touchstart",this.onTouchStart),s.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function(s){this.direction=-1,this.data.reverseEnabled&&s.touches&&s.touches.length===2&&(this.direction=1),s.preventDefault()},onTouchEnd:function(s){this.direction=0,s.preventDefault()},onEnterVR:function(){const s=this.el.sceneEl.xrSession;s&&(s.addEventListener("selectstart",this.onTouchStart),s.addEventListener("selectend",this.onTouchEnd))}});const r1="-controls",oU=.2,aU=1e-5,lU="moved";AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const s=this.el;this.data.camera||(this.data.camera=s.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.eventDetail={},this.navGroup=null,this.navNode=null,s.sceneEl.hasLoaded?this.injectControls():s.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(s){const e=this.el,n=this.data,i=e.sceneEl.systems.nav;if(e.sceneEl.hasLoaded&&this.injectControls(),i&&n.constrainToNavMesh!==s.constrainToNavMesh&&(n.constrainToNavMesh?i.addAgent(this):i.removeAgent(this)),n.enabled!==s.enabled)for(let o=0;o<n.controls.length;o++){const a=n.controls[o]+r1;this.el.setAttribute(a,{enabled:this.data.enabled})}},injectControls:function(){const s=this.data;for(let e=0;e<s.controls.length;e++){const n=s.controls[e]+r1;this.el.setAttribute(n,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const s=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(i,o){if(!o)return;const a=this.el,c=this.data;if(!c.enabled)return;this.updateVelocityCtrl();const u=this.velocityCtrl,h=this.velocity;if(u)if(o/1e3>oU?h.set(0,0,0):this.updateVelocity(o),c.constrainToNavMesh&&u.isNavMeshConstrained!==!1){if(h.lengthSq()<aU)return;s.copy(a.object3D.position),e.copy(h).multiplyScalar(o/1e3).add(s);const d=a.sceneEl.systems.nav;this.navGroup=this.navGroup===null?d.getGroup(s):this.navGroup,this.navNode=this.navNode||d.getNode(s,this.navGroup),this.navNode=d.clampStep(s,e,this.navGroup,this.navNode,n),a.object3D.position.copy(n)}else a.hasAttribute("velocity")?a.setAttribute("velocity",h):(a.object3D.position.x+=h.x*o/1e3,a.object3D.position.y+=h.y*o/1e3,a.object3D.position.z+=h.z*o/1e3)}}(),updateVelocityCtrl:function(){const s=this.data;if(s.enabled){for(let e=0,n=s.controls.length;e<n;e++){const i=this.el.components[s.controls[e]+r1];if(i&&i.isVelocityActive()){this.velocityCtrl=i;return}}this.velocityCtrl=null}},updateVelocity:function(){const s=new THREE.Vector2,e=new THREE.Quaternion;return function(n){let i;const o=this.el,a=this.velocityCtrl,c=this.velocity,u=this.data;if(a)if(a.getVelocityDelta)i=a.getVelocityDelta(n);else if(a.getVelocity){c.copy(a.getVelocity());return}else if(a.getPositionDelta){c.copy(a.getPositionDelta(n).multiplyScalar(1e3/n));return}else throw new Error("Incompatible movement controls: ",a);if(o.hasAttribute("velocity")&&!u.constrainToNavMesh&&c.copy(this.el.getAttribute("velocity")),i&&u.enabled){const h=u.camera;e.copy(h.object3D.quaternion),e.premultiply(o.object3D.quaternion),i.applyQuaternion(e);const d=i.length();u.fly?(c.copy(i),c.multiplyScalar(this.data.speed*16.66667)):(s.set(i.x,i.z),s.setLength(d*this.data.speed*16.66667),c.x=s.x,c.y=0,c.z=s.y),(c.x!==0||c.y!==0||c.z!==0)&&(this.eventDetail.velocity=c,this.el.emit(lU,this.eventDetail))}}}()});AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const s=this.data,e=this.el.sceneEl;switch(e.addEventListener("axismove",this.onAxisMove),s.mode){case"swipe":case"touch":e.addEventListener("trackpadtouchstart",this.onTouchStart),e.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":e.addEventListener("trackpaddown",this.onTouchStart),e.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const s=this.el.sceneEl;s.removeEventListener("axismove",this.onAxisMove),s.removeEventListener("trackpadtouchstart",this.onTouchStart),s.removeEventListener("trackpadtouchend",this.onTouchEnd),s.removeEventListener("trackpaddown",this.onTouchStart),s.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(s){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}s.preventDefault()},onTouchEnd:function(s){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,s.preventDefault()},onAxisMove:function(s){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(s);case"touch":case"press":return this.handleTouchAxis(s)}},handleSwipeAxis:function(s){const e=this.data,n=s.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=n[0],this.startingAxisData[1]=n[1]),this.startingAxisData.length>0){let i=0,o=0;e.enableNegX&&n[0]<this.startingAxisData[0]&&(i=-1),e.enablePosX&&n[0]>this.startingAxisData[0]&&(i=1),e.enablePosZ&&n[1]>this.startingAxisData[1]&&(o=-1),e.enableNegZ&&n[1]<this.startingAxisData[1]&&(o=1);const a=Math.abs(this.startingAxisData[1]-n[1]);Math.abs(this.startingAxisData[0]-n[0])>a?(this.zVel=0,this.xVel=i,this.isMoving=!0):(this.xVel=0,this.zVel=o,this.isMoving=!0)}},handleTouchAxis:function(s){const e=this.data,n=s.detail.axis;let i=0,o=0;e.enableNegX&&n[0]<0&&(i=-1),e.enablePosX&&n[0]>0&&(i=1),e.enablePosZ&&n[1]>0&&(o=-1),e.enableNegZ&&n[1]<0&&(o=1),Math.abs(n[0])>Math.abs(n[1])?(this.zVel=0,this.xVel=i):(this.xVel=0,this.zVel=o)}});const Q0=(s,e)=>{const n=e.x-s.x,i=e.y-s.y;return Math.sqrt(n*n+i*i)},cU=(s,e)=>{const n=e.x-s.x,i=e.y-s.y;return uU(Math.atan2(i,n))},hU=(s,e,n)=>{const i={x:0,y:0};return n=Ab(n),i.x=s.x-e*Math.cos(n),i.y=s.y-e*Math.sin(n),i},Ab=s=>s*(Math.PI/180),uU=s=>s*(180/Math.PI),dU=s=>isNaN(s.buttons)?s.pressure!==0:s.buttons!==0,s1=new Map,dC=s=>{s1.has(s)&&clearTimeout(s1.get(s)),s1.set(s,setTimeout(s,100))},ov=(s,e,n)=>{const i=e.split(/[ ,]+/g);let o;for(let a=0;a<i.length;a+=1)o=i[a],s.addEventListener?s.addEventListener(o,n,!1):s.attachEvent&&s.attachEvent(o,n)},fC=(s,e,n)=>{const i=e.split(/[ ,]+/g);let o;for(let a=0;a<i.length;a+=1)o=i[a],s.removeEventListener?s.removeEventListener(o,n):s.detachEvent&&s.detachEvent(o,n)},iI=s=>(s.preventDefault(),s.type.match(/^touch/)?s.changedTouches:s),pC=()=>{const s=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:s,y:e}},mC=(s,e)=>{e.top||e.right||e.bottom||e.left?(s.style.top=e.top,s.style.right=e.right,s.style.bottom=e.bottom,s.style.left=e.left):(s.style.left=e.x+"px",s.style.top=e.y+"px")},C_=(s,e,n)=>{const i=rI(s);for(let o in i)if(i.hasOwnProperty(o))if(typeof e=="string")i[o]=e+" "+n;else{let a="";for(let c=0,u=e.length;c<u;c+=1)a+=e[c]+" "+n+", ";i[o]=a.slice(0,-2)}return i},fU=(s,e)=>{const n=rI(s);for(let i in n)n.hasOwnProperty(i)&&(n[i]=e);return n},rI=s=>{const e={};return e[s]="",["webkit","Moz","o"].forEach(function(i){e[i+s.charAt(0).toUpperCase()+s.slice(1)]=""}),e},o1=(s,e)=>{for(let n in e)e.hasOwnProperty(n)&&(s[n]=e[n]);return s},pU=(s,e)=>{const n={};for(let i in s)s.hasOwnProperty(i)&&e.hasOwnProperty(i)?n[i]=e[i]:s.hasOwnProperty(i)&&(n[i]=s[i]);return n},vb=(s,e)=>{if(s.length)for(let n=0,i=s.length;n<i;n+=1)e(s[n]);else e(s)},mU=(s,e,n)=>({x:Math.min(Math.max(s.x,e.x-n),e.x+n),y:Math.min(Math.max(s.y,e.y-n),e.y+n)});var gU="ontouchstart"in window,AU=!!window.PointerEvent,vU=!!window.MSPointerEvent,lp={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},qd,om={};AU?qd=lp.pointer:vU?qd=lp.MSPointer:gU?(qd=lp.touch,om=lp.mouse):qd=lp.mouse;function ic(){}ic.prototype.on=function(s,e){var n=this,i=s.split(/[ ,]+/g),o;n._handlers_=n._handlers_||{};for(var a=0;a<i.length;a+=1)o=i[a],n._handlers_[o]=n._handlers_[o]||[],n._handlers_[o].push(e);return n};ic.prototype.off=function(s,e){var n=this;return n._handlers_=n._handlers_||{},s===void 0?n._handlers_={}:e===void 0?n._handlers_[s]=null:n._handlers_[s]&&n._handlers_[s].indexOf(e)>=0&&n._handlers_[s].splice(n._handlers_[s].indexOf(e),1),n};ic.prototype.trigger=function(s,e){var n=this,i=s.split(/[ ,]+/g),o;n._handlers_=n._handlers_||{};for(var a=0;a<i.length;a+=1)o=i[a],n._handlers_[o]&&n._handlers_[o].length&&n._handlers_[o].forEach(function(c){c.call(n,{type:o,target:n},e)})};ic.prototype.config=function(s){var e=this;e.options=e.defaults||{},s&&(e.options=pU(e.options,s))};ic.prototype.bindEvt=function(s,e){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[e]=function(){typeof n["on"+e]=="function"?n["on"+e].apply(n,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},ov(s,qd[e],n._domHandlers_[e]),om[e]&&ov(s,om[e],n._domHandlers_[e]),n};ic.prototype.unbindEvt=function(s,e){var n=this;return n._domHandlers_=n._domHandlers_||{},fC(s,qd[e],n._domHandlers_[e]),om[e]&&fC(s,om[e],n._domHandlers_[e]),delete n._domHandlers_[e],this};function vs(s,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=s,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=vs.id,vs.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}vs.prototype=new ic;vs.constructor=vs;vs.id=0;vs.prototype.buildEl=function(s){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};vs.prototype.stylize=function(){if(this.options.dataOnly)return this;var s=this.options.fadeTime+"ms",e=fU("borderRadius","50%"),n=C_("transition","opacity",s),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},o1(i.el,n),this.options.shape==="circle"&&o1(i.back,e),o1(i.front,e),this.applyStyles(i),this};vs.prototype.applyStyles=function(s){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var n in s[e])this.ui[e].style[n]=s[e][n];return this};vs.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};vs.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};vs.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};vs.prototype.show=function(s){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof s=="function"&&s.call(this)},e.options.fadeTime)),e};vs.prototype.hide=function(s){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var n=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=n,typeof s=="function"&&s.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const n=e.options.restJoystick,i={};i.x=n===!0||n.x!==!1?0:e.instance.frontPosition.x,i.y=n===!0||n.y!==!1?0:e.instance.frontPosition.y,e.setPosition(s,i)}return e};vs.prototype.setPosition=function(s,e){var n=this;n.frontPosition={x:e.x,y:e.y};var i=n.options.fadeTime+"ms",o={};o.front=C_("transition",["transform"],i);var a={front:{}};a.front={transform:"translate("+n.frontPosition.x+"px,"+n.frontPosition.y+"px)"},n.applyStyles(o),n.applyStyles(a),n.restTimeout=setTimeout(function(){typeof s=="function"&&s.call(n),n.restCallback()},n.options.fadeTime)};vs.prototype.restCallback=function(){var s=this,e={};e.front=C_("transition","none",""),s.applyStyles(e),s.trigger("rested",s.instance)};vs.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};vs.prototype.computeDirection=function(s){var e=s.angle.radian,n=Math.PI/4,i=Math.PI/2,o,a,c;if(e>n&&e<n*3&&!s.lockX?o="up":e>-n&&e<=n&&!s.lockY?o="left":e>-n*3&&e<=-n&&!s.lockX?o="down":s.lockY||(o="right"),s.lockY||(e>-i&&e<i?a="left":a="right"),s.lockX||(e>0?c="up":c="down"),s.force>this.options.threshold){var u={},h;for(h in this.direction)this.direction.hasOwnProperty(h)&&(u[h]=this.direction[h]);var d={};this.direction={x:a,y:c,angle:o},s.direction=this.direction;for(h in u)u[h]===this.direction[h]&&(d[h]=!0);if(d.x&&d.y&&d.angle)return s;(!d.x||!d.y)&&this.trigger("plain",s),d.x||this.trigger("plain:"+a,s),d.y||this.trigger("plain:"+c,s),d.angle||this.trigger("dir dir:"+o,s)}else this.resetDirection();return s};function ns(s,e){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=s,n.id=ns.id,ns.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(e),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);const i=getComputedStyle(n.options.zone.parentElement);return i&&i.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}ns.prototype=new ic;ns.constructor=ns;ns.id=0;ns.prototype.prepareNipples=function(){var s=this,e=s.nipples;e.on=s.on.bind(s),e.off=s.off.bind(s),e.options=s.options,e.destroy=s.destroy.bind(s),e.ids=s.ids,e.id=s.id,e.processOnMove=s.processOnMove.bind(s),e.processOnEnd=s.processOnEnd.bind(s),e.get=function(n){if(n===void 0)return e[0];for(var i=0,o=e.length;i<o;i+=1)if(e[i].identifier===n)return e[i];return!1}};ns.prototype.bindings=function(){var s=this;s.bindEvt(s.options.zone,"start"),s.options.zone.style.touchAction="none",s.options.zone.style.msTouchAction="none"};ns.prototype.begin=function(){var s=this,e=s.options;if(e.mode==="static"){var n=s.createNipple(e.position,s.manager.getIdentifier());n.add(),s.idles.push(n)}};ns.prototype.createNipple=function(s,e){var n=this,i=n.manager.scroll,o={},a=n.options,c={x:n.parentIsFlex?i.x:i.x+n.box.left,y:n.parentIsFlex?i.y:i.y+n.box.top};if(s.x&&s.y)o={x:s.x-c.x,y:s.y-c.y};else if(s.top||s.right||s.bottom||s.left){var u=document.createElement("DIV");u.style.display="hidden",u.style.top=s.top,u.style.right=s.right,u.style.bottom=s.bottom,u.style.left=s.left,u.style.position="absolute",a.zone.appendChild(u);var h=u.getBoundingClientRect();a.zone.removeChild(u),o=s,s={x:h.left+i.x,y:h.top+i.y}}var d=new vs(n,{color:a.color,size:a.size,threshold:a.threshold,fadeTime:a.fadeTime,dataOnly:a.dataOnly,restJoystick:a.restJoystick,restOpacity:a.restOpacity,mode:a.mode,identifier:e,position:s,zone:a.zone,frontPosition:{x:0,y:0},shape:a.shape});return a.dataOnly||(mC(d.ui.el,o),mC(d.ui.front,d.frontPosition)),n.nipples.push(d),n.trigger("added "+d.identifier+":added",d),n.manager.trigger("added "+d.identifier+":added",d),n.bindNipple(d),d};ns.prototype.updateBox=function(){var s=this;s.box=s.options.zone.getBoundingClientRect()};ns.prototype.bindNipple=function(s){var e=this,n,i=function(o,a){n=o.type+" "+a.id+":"+o.type,e.trigger(n,a)};s.on("destroyed",e.onDestroyed.bind(e)),s.on("shown hidden rested dir plain",i),s.on("dir:up dir:right dir:down dir:left",i),s.on("plain:up plain:right plain:down plain:left",i)};ns.prototype.pressureFn=function(s,e,n){var i=this,o=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval(function(){var a=s.force||s.pressure||s.webkitForce||0;a!==o&&(e.trigger("pressure",a),i.trigger("pressure "+e.identifier+":pressure",a),o=a)}.bind(i),100)};ns.prototype.onstart=function(s){var e=this,n=e.options,i=s;s=iI(s),e.updateBox();var o=function(a){e.actives.length<n.maxNumberOfNipples?e.processOnStart(a):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(c){if(Object.values(i.touches).findIndex(function(h){return h.identifier===c})<0){var u=[s[0]];u.identifier=c,e.processOnEnd(u)}}),e.actives.length<n.maxNumberOfNipples&&e.processOnStart(a))};return vb(s,o),e.manager.bindDocument(),!1};ns.prototype.processOnStart=function(s){var e=this,n=e.options,i,o=e.manager.getIdentifier(s),a=s.force||s.pressure||s.webkitForce||0,c={x:s.pageX,y:s.pageY},u=e.getOrCreate(o,c);u.identifier!==o&&e.manager.removeIdentifier(u.identifier),u.identifier=o;var h=function(f){f.trigger("start",f),e.trigger("start "+f.id+":start",f),f.show(),a>0&&e.pressureFn(s,f,f.identifier),e.processOnMove(s)};if((i=e.idles.indexOf(u))>=0&&e.idles.splice(i,1),e.actives.push(u),e.ids.push(u.identifier),n.mode!=="semi")h(u);else{var d=Q0(c,u.position);if(d<=n.catchDistance)h(u);else{u.destroy(),e.processOnStart(s);return}}return u};ns.prototype.getOrCreate=function(s,e){var n=this,i=n.options,o;return/(semi|static)/.test(i.mode)?(o=n.idles[0],o?(n.idles.splice(0,1),o):i.mode==="semi"?n.createNipple(e,s):(console.warn("Coudln't find the needed nipple."),!1)):(o=n.createNipple(e,s),o)};ns.prototype.processOnMove=function(s){var e=this,n=e.options,i=e.manager.getIdentifier(s),o=e.nipples.get(i),a=e.manager.scroll;if(!dU(s)){this.processOnEnd(s);return}if(!o){console.error("Found zombie joystick with ID "+i),e.manager.removeIdentifier(i);return}if(n.dynamicPage){var c=o.el.getBoundingClientRect();o.position={x:a.x+c.left,y:a.y+c.top}}o.identifier=i;var u=o.options.size/2,h={x:s.pageX,y:s.pageY};n.lockX&&(h.y=o.position.y),n.lockY&&(h.x=o.position.x);var d=Q0(h,o.position),f=cU(h,o.position),p=Ab(f),A=d/u,g={distance:d,position:h},v,b;if(o.options.shape==="circle"?(v=Math.min(d,u),b=hU(o.position,v,f)):(b=mU(h,o.position,u),v=Q0(b,o.position)),n.follow){if(d>u){let M=h.x-b.x,C=h.y-b.y;o.position.x+=M,o.position.y+=C,o.el.style.top=o.position.y-(e.box.top+a.y)+"px",o.el.style.left=o.position.x-(e.box.left+a.x)+"px",d=Q0(h,o.position)}}else h=b,d=v;var x=h.x-o.position.x,E=h.y-o.position.y;o.frontPosition={x,y:E},n.dataOnly||(o.ui.front.style.transform="translate("+x+"px,"+E+"px)");var S={identifier:o.identifier,position:h,force:A,pressure:s.force||s.pressure||s.webkitForce||0,distance:d,angle:{radian:p,degree:f},vector:{x:x/u,y:-E/u},raw:g,instance:o,lockX:n.lockX,lockY:n.lockY};S=o.computeDirection(S),S.angle={radian:Ab(180-f),degree:180-f},o.trigger("move",S),e.trigger("move "+o.id+":move",S)};ns.prototype.processOnEnd=function(s){var e=this,n=e.options,i=e.manager.getIdentifier(s),o=e.nipples.get(i),a=e.manager.removeIdentifier(o.identifier);o&&(n.dataOnly||o.hide(function(){n.mode==="dynamic"&&(o.trigger("removed",o),e.trigger("removed "+o.id+":removed",o),e.manager.trigger("removed "+o.id+":removed",o),o.destroy())}),clearInterval(e.pressureIntervals[o.identifier]),o.resetDirection(),o.trigger("end",o),e.trigger("end "+o.id+":end",o),e.ids.indexOf(o.identifier)>=0&&e.ids.splice(e.ids.indexOf(o.identifier),1),e.actives.indexOf(o)>=0&&e.actives.splice(e.actives.indexOf(o),1),/(semi|static)/.test(n.mode)?e.idles.push(o):e.nipples.indexOf(o)>=0&&e.nipples.splice(e.nipples.indexOf(o),1),e.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(e.manager.ids[a.id]=a.identifier))};ns.prototype.onDestroyed=function(s,e){var n=this;n.nipples.indexOf(e)>=0&&n.nipples.splice(n.nipples.indexOf(e),1),n.actives.indexOf(e)>=0&&n.actives.splice(n.actives.indexOf(e),1),n.idles.indexOf(e)>=0&&n.idles.splice(n.idles.indexOf(e),1),n.ids.indexOf(e.identifier)>=0&&n.ids.splice(n.ids.indexOf(e.identifier),1),n.manager.removeIdentifier(e.identifier),n.manager.unbindDocument()};ns.prototype.destroy=function(){var s=this;s.unbindEvt(s.options.zone,"start"),s.nipples.forEach(function(n){n.destroy()});for(var e in s.pressureIntervals)s.pressureIntervals.hasOwnProperty(e)&&clearInterval(s.pressureIntervals[e]);s.trigger("destroyed",s.nipples),s.manager.unbindDocument(),s.off()};function Ps(s){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=pC(),e.config(s),e.prepareCollections();var n=function(){var o;e.collections.forEach(function(a){a.forEach(function(c){o=c.el.getBoundingClientRect(),c.position={x:e.scroll.x+o.left,y:e.scroll.y+o.top}})})};ov(window,"resize",function(){dC(n)});var i=function(){e.scroll=pC()};return ov(window,"scroll",function(){dC(i)}),e.collections}Ps.prototype=new ic;Ps.constructor=Ps;Ps.prototype.prepareCollections=function(){var s=this;s.collections.create=s.create.bind(s),s.collections.on=s.on.bind(s),s.collections.off=s.off.bind(s),s.collections.destroy=s.destroy.bind(s),s.collections.get=function(e){var n;return s.collections.every(function(i){return n=i.get(e),!n}),n}};Ps.prototype.create=function(s){return this.createCollection(s)};Ps.prototype.createCollection=function(s){var e=this,n=new ns(e,s);return e.bindCollection(n),e.collections.push(n),n};Ps.prototype.bindCollection=function(s){var e=this,n,i=function(o,a){n=o.type+" "+a.id+":"+o.type,e.trigger(n,a)};s.on("destroyed",e.onDestroyed.bind(e)),s.on("shown hidden rested dir plain",i),s.on("dir:up dir:right dir:down dir:left",i),s.on("plain:up plain:right plain:down plain:left",i)};Ps.prototype.bindDocument=function(){var s=this;s.binded||(s.bindEvt(document,"move").bindEvt(document,"end"),s.binded=!0)};Ps.prototype.unbindDocument=function(s){var e=this;(!Object.keys(e.ids).length||s===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};Ps.prototype.getIdentifier=function(s){var e;return s?(e=s.identifier===void 0?s.pointerId:s.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};Ps.prototype.removeIdentifier=function(s){var e={};for(var n in this.ids)if(this.ids[n]===s){e.id=n,e.identifier=this.ids[n],delete this.ids[n];break}return e};Ps.prototype.onmove=function(s){var e=this;return e.onAny("move",s),!1};Ps.prototype.onend=function(s){var e=this;return e.onAny("end",s),!1};Ps.prototype.oncancel=function(s){var e=this;return e.onAny("end",s),!1};Ps.prototype.onAny=function(s,e){var n=this,i,o="processOn"+s.charAt(0).toUpperCase()+s.slice(1);e=iI(e);var a=function(u,h,d){d.ids.indexOf(h)>=0&&(d[o](u),u._found_=!0)},c=function(u){i=n.getIdentifier(u),vb(n.collections,a.bind(null,u,i)),u._found_||n.removeIdentifier(i)};return vb(e,c),!1};Ps.prototype.destroy=function(){var s=this;s.unbindDocument(!0),s.ids={},s.index=0,s.collections.forEach(function(e){e.destroy()}),s.off()};Ps.prototype.onDestroyed=function(s,e){var n=this;if(n.collections.indexOf(e)<0)return!1;n.collections.splice(n.collections.indexOf(e),1)};const gC=new Ps,AC={create:function(s){return gC.create(s)},factory:gC};AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;const s=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=s.pitchObject,this.yawObject=s.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update(s){(this.data.moveJoystickPosition!==s.moveJoystickPosition||this.data.sideMargin!==s.sideMargin||this.data.bottomMargin!==s.bottomMargin||this.data.mode!==s.mode)&&this.removeMoveJoystick(),(this.data.lookJoystickPosition!==s.lookJoystickPosition||this.data.sideMargin!==s.sideMargin||this.data.bottomMargin!==s.bottomMargin||this.data.mode!==s.mode)&&this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause(){this.moving=!1,this.rotating=!1},remove(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive(){return this.data.enabled&&this.moving},getVelocityDelta(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){const s=this.moveData.force<1?this.moveData.force:1,e=this.moveData.angle.radian,n=Math.cos(e)*s,i=-Math.sin(e)*s;this.dVelocity.set(n,0,i)}return this.dVelocity},isRotationActive(){return this.data.enabled&&this.rotating},updateRotation(s){if(!this.isRotationActive())return;const e=this.lookData.force<1?this.lookData.force:1,n=this.lookData.angle.radian,i=this.lookVector;i.x=Math.cos(n)*e,i.y=Math.sin(n)*e,i.multiplyScalar(this.data.rotationSensitivity*s/1e3),this.yawObject.rotation.y-=i.x;let o=this.pitchObject.rotation.x+i.y;o=Math.max(-Math.PI/2,Math.min(Math.PI/2,o)),this.pitchObject.rotation.x=o},tick:function(s,e){this.updateRotation(e)},initLeftZone(){const s=document.createElement("div");s.setAttribute("id","joystickLeftZone"),s.setAttribute("style",`position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(s),this.leftZone=s},initRightZone(){const s=document.createElement("div");s.setAttribute("id","joystickRightZone"),s.setAttribute("style",`position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(s),this.rightZone=s},createMoveJoystick(){if(this.moveJoystick)return;this.initLeftZone();const s={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",s.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=AC.create(s),this.moveJoystick.on("move",(e,n)=>{this.moveData=n,this.moving=!0}),this.moveJoystick.on("end",(e,n)=>{this.moving=!1})},createLookJoystick(){if(this.lookJoystick)return;this.initRightZone();const s={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",s.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=AC.create(s),this.lookJoystick.on("move",(e,n)=>{this.lookData=n,this.rotating=!0}),this.lookJoystick.on("end",(e,n)=>{this.rotating=!1})},removeMoveJoystick(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}});const a1={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(a1)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const s=this.el.getObject3D("mesh");s?this.load(s):this.el.addEventListener("model-loaded",e=>{this.load(e.detail.model)})},load:function(s){const e=this.el;this.model=s,this.mixer=new THREE.AnimationMixer(s),this.mixer.addEventListener("loop",n=>{e.emit("animation-loop",{action:n.action,loopDelta:n.loopDelta})}),this.mixer.addEventListener("finished",n=>{e.emit("animation-finished",{action:n.action,direction:n.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(s){if(!s)return;const e=this.data,n=AFRAME.utils.diff(e,s);if("clip"in n){this.stopAction(),e.clip&&this.playAction();return}this.activeActions.forEach(i=>{"duration"in n&&e.duration&&i.setDuration(e.duration),"clampWhenFinished"in n&&(i.clampWhenFinished=e.clampWhenFinished),("loop"in n||"repetitions"in n)&&i.setLoop(a1[e.loop],e.repetitions),"timeScale"in n&&i.setEffectiveTimeScale(e.timeScale)})},stopAction:function(){const s=this.data;for(let e=0;e<this.activeActions.length;e++)s.crossFadeDuration?this.activeActions[e].fadeOut(s.crossFadeDuration):this.activeActions[e].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const s=this.model,e=this.data,n=s.animations||(s.geometry||{}).animations||[];if(!n.length)return;const i=e.useRegExp?e.clip:yU(e.clip);for(let o,a=0;o=n[a];a++)if(o.name.match(i)){const c=this.mixer.clipAction(o,s);c.enabled=!0,c.clampWhenFinished=e.clampWhenFinished,e.duration&&c.setDuration(e.duration),e.timeScale!==1&&c.setEffectiveTimeScale(e.timeScale),c.startAt(this.mixer.time-e.startAt/1e3),c.setLoop(a1[e.loop],e.repetitions).fadeIn(e.crossFadeDuration).play(),this.activeActions.push(c)}},tick:function(s,e){this.mixer&&!isNaN(e)&&this.mixer.update(e/1e3)}});function yU(s){return new RegExp("^"+s.split(/\*+/).map(xU).join(".*")+"$")}function xU(s){return s.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}var EU=THREE.ColladaLoader=function(s){this.manager=s!==void 0?s:THREE.DefaultLoadingManager};THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(s,e,n,i){var o=this,a=o.path===void 0?THREE.LoaderUtils.extractUrlBase(s):o.path,c=new THREE.FileLoader(o.manager);c.setPath(o.path),c.load(s,function(u){e(o.parse(u,a))},n,i)},setPath:function(s){return this.path=s,this},setResourcePath:function(s){return this.resourcePath=s,this},options:{set convertUpAxis(s){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(s){return this.crossOrigin=s,this},parse:function(s,e){function n(ae,le){for(var ce=[],ge=ae.childNodes,Ae=0,tt=ge.length;Ae<tt;Ae++){var xt=ge[Ae];xt.nodeName===le&&ce.push(xt)}return ce}function i(ae){if(ae.length===0)return[];for(var le=ae.trim().split(/\s+/),ce=new Array(le.length),ge=0,Ae=le.length;ge<Ae;ge++)ce[ge]=le[ge];return ce}function o(ae){if(ae.length===0)return[];for(var le=ae.trim().split(/\s+/),ce=new Array(le.length),ge=0,Ae=le.length;ge<Ae;ge++)ce[ge]=parseFloat(le[ge]);return ce}function a(ae){if(ae.length===0)return[];for(var le=ae.trim().split(/\s+/),ce=new Array(le.length),ge=0,Ae=le.length;ge<Ae;ge++)ce[ge]=parseInt(le[ge]);return ce}function c(ae){return ae.substring(1)}function u(){return"three_default_"+Ue++}function h(ae){return Object.keys(ae).length===0}function d(ae){return{unit:f(n(ae,"unit")[0]),upAxis:p(n(ae,"up_axis")[0])}}function f(ae){return ae!==void 0&&ae.hasAttribute("meter")===!0?parseFloat(ae.getAttribute("meter")):1}function p(ae){return ae!==void 0?ae.textContent:"Y_UP"}function A(ae,le,ce,ge){var Ae=n(ae,le)[0];if(Ae!==void 0)for(var tt=n(Ae,ce),xt=0;xt<tt.length;xt++)ge(tt[xt])}function g(ae,le){for(var ce in ae){var ge=ae[ce];ge.build=le(ae[ce])}}function v(ae,le){return ae.build!==void 0||(ae.build=le(ae)),ae.build}function b(ae){for(var le={sources:{},samplers:{},channels:{}},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1){var tt;switch(Ae.nodeName){case"source":tt=Ae.getAttribute("id"),le.sources[tt]=Re(Ae);break;case"sampler":tt=Ae.getAttribute("id"),le.samplers[tt]=x(Ae);break;case"channel":tt=Ae.getAttribute("target"),le.channels[tt]=E(Ae);break;default:console.log(Ae)}}}Ke.animations[ae.getAttribute("id")]=le}function x(ae){for(var le={inputs:{}},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var tt=c(Ae.getAttribute("source")),xt=Ae.getAttribute("semantic");le.inputs[xt]=tt;break}}return le}function E(ae){var le={},ce=ae.getAttribute("target"),ge=ce.split("/"),Ae=ge.shift(),tt=ge.shift(),xt=tt.indexOf("(")!==-1,Dt=tt.indexOf(".")!==-1;if(Dt)ge=tt.split("."),tt=ge.shift(),le.member=ge.shift();else if(xt){var Yt=tt.split("(");tt=Yt.shift();for(var on=0;on<Yt.length;on++)Yt[on]=parseInt(Yt[on].replace(/\)/,""));le.indices=Yt}return le.id=Ae,le.sid=tt,le.arraySyntax=xt,le.memberSyntax=Dt,le.sampler=c(ae.getAttribute("source")),le}function S(ae){var le=[],ce=ae.channels,ge=ae.samplers,Ae=ae.sources;for(var tt in ce)if(ce.hasOwnProperty(tt)){var xt=ce[tt],Dt=ge[xt.sampler],Yt=Dt.inputs.INPUT,on=Dt.inputs.OUTPUT,kt=Ae[Yt],bn=Ae[on],oi=C(xt,kt,bn);D(oi,le)}return le}function M(ae){return v(Ke.animations[ae],S)}function C(ae,le,ce){var ge=Ke.nodes[ae.id],Ae=jn(ge.id),tt=ge.transforms[ae.sid],xt=ge.matrix.clone().transpose(),Dt,Yt,on,kt,bn,oi,Vn={};switch(tt){case"matrix":for(on=0,kt=le.array.length;on<kt;on++)if(Dt=le.array[on],Yt=on*ce.stride,Vn[Dt]===void 0&&(Vn[Dt]={}),ae.arraySyntax===!0){var Wn=ce.array[Yt],Nn=ae.indices[0]+4*ae.indices[1];Vn[Dt][Nn]=Wn}else for(bn=0,oi=ce.stride;bn<oi;bn++)Vn[Dt][bn]=ce.array[Yt+bn];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',tt);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',tt);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',tt);break}var ai=T(Vn,xt),li={name:Ae.uuid,keyframes:ai};return li}function T(ae,le){var ce=[];for(var ge in ae)ce.push({time:parseFloat(ge),value:ae[ge]});ce.sort(tt);for(var Ae=0;Ae<16;Ae++)P(ce,Ae,le.elements[Ae]);return ce;function tt(xt,Dt){return xt.time-Dt.time}}var L=new THREE.Vector3,B=new THREE.Vector3,F=new THREE.Quaternion;function D(ae,le){for(var ce=ae.keyframes,ge=ae.name,Ae=[],tt=[],xt=[],Dt=[],Yt=0,on=ce.length;Yt<on;Yt++){var kt=ce[Yt],bn=kt.time,oi=kt.value;be.fromArray(oi).transpose(),be.decompose(L,F,B),Ae.push(bn),tt.push(L.x,L.y,L.z),xt.push(F.x,F.y,F.z,F.w),Dt.push(B.x,B.y,B.z)}return tt.length>0&&le.push(new THREE.VectorKeyframeTrack(ge+".position",Ae,tt)),xt.length>0&&le.push(new THREE.QuaternionKeyframeTrack(ge+".quaternion",Ae,xt)),Dt.length>0&&le.push(new THREE.VectorKeyframeTrack(ge+".scale",Ae,Dt)),le}function P(ae,le,ce){var ge,Ae=!0,tt,xt;for(tt=0,xt=ae.length;tt<xt;tt++)ge=ae[tt],ge.value[le]===void 0?ge.value[le]=null:Ae=!1;if(Ae===!0)for(tt=0,xt=ae.length;tt<xt;tt++)ge=ae[tt],ge.value[le]=ce;else U(ae,le)}function U(ae,le){for(var ce,ge,Ae=0,tt=ae.length;Ae<tt;Ae++){var xt=ae[Ae];if(xt.value[le]===null){if(ce=K(ae,Ae,le),ge=J(ae,Ae,le),ce===null){xt.value[le]=ge.value[le];continue}if(ge===null){xt.value[le]=ce.value[le];continue}z(xt,ce,ge,le)}}}function K(ae,le,ce){for(;le>=0;){var ge=ae[le];if(ge.value[ce]!==null)return ge;le--}return null}function J(ae,le,ce){for(;le<ae.length;){var ge=ae[le];if(ge.value[ce]!==null)return ge;le++}return null}function z(ae,le,ce,ge){if(ce.time-le.time===0){ae.value[ge]=le.value[ge];return}ae.value[ge]=(ae.time-le.time)*(ce.value[ge]-le.value[ge])/(ce.time-le.time)+le.value[ge]}function j(ae){for(var le={name:ae.getAttribute("id")||"default",start:parseFloat(ae.getAttribute("start")||0),end:parseFloat(ae.getAttribute("end")||0),animations:[]},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"instance_animation":le.animations.push(c(Ae.getAttribute("url")));break}}Ke.clips[ae.getAttribute("id")]=le}function G(ae){for(var le=[],ce=ae.name,ge=ae.end-ae.start||-1,Ae=ae.animations,tt=0,xt=Ae.length;tt<xt;tt++)for(var Dt=M(Ae[tt]),Yt=0,on=Dt.length;Yt<on;Yt++)le.push(Dt[Yt]);return new THREE.AnimationClip(ce,ge,le)}function H(ae){return v(Ke.clips[ae],G)}function te(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"skin":le.id=c(Ae.getAttribute("source")),le.skin=Z(Ae);break;case"morph":le.id=c(Ae.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Ke.controllers[ae.getAttribute("id")]=le}function Z(ae){for(var le={sources:{}},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"bind_shape_matrix":le.bindShapeMatrix=o(Ae.textContent);break;case"source":var tt=Ae.getAttribute("id");le.sources[tt]=Re(Ae);break;case"joints":le.joints=ee(Ae);break;case"vertex_weights":le.vertexWeights=oe(Ae);break}}return le}function ee(ae){for(var le={inputs:{}},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var tt=Ae.getAttribute("semantic"),xt=c(Ae.getAttribute("source"));le.inputs[tt]=xt;break}}return le}function oe(ae){for(var le={inputs:{}},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var tt=Ae.getAttribute("semantic"),xt=c(Ae.getAttribute("source")),Dt=parseInt(Ae.getAttribute("offset"));le.inputs[tt]={id:xt,offset:Dt};break;case"vcount":le.vcount=a(Ae.textContent);break;case"v":le.v=a(Ae.textContent);break}}return le}function xe(ae){var le={id:ae.id},ce=Ke.geometries[le.id];return ae.skin!==void 0&&(le.skin=Pe(ae.skin),ce.sources.skinIndices=le.skin.indices,ce.sources.skinWeights=le.skin.weights),le}function Pe(ae){var le=4,ce={joints:[],indices:{array:[],stride:le},weights:{array:[],stride:le}},ge=ae.sources,Ae=ae.vertexWeights,tt=Ae.vcount,xt=Ae.v,Dt=Ae.inputs.JOINT.offset,Yt=Ae.inputs.WEIGHT.offset,on=ae.sources[ae.joints.inputs.JOINT],kt=ae.sources[ae.joints.inputs.INV_BIND_MATRIX],bn=ge[Ae.inputs.WEIGHT.id].array,oi=0,Vn,Wn,Nn;for(Vn=0,Nn=tt.length;Vn<Nn;Vn++){var ai=tt[Vn],li=[];for(Wn=0;Wn<ai;Wn++){var xi=xt[oi+Dt],Bi=xt[oi+Yt],hr=bn[Bi];li.push({index:xi,weight:hr}),oi+=2}for(li.sort(eo),Wn=0;Wn<le;Wn++){var Li=li[Wn];Li!==void 0?(ce.indices.array.push(Li.index),ce.weights.array.push(Li.weight)):(ce.indices.array.push(0),ce.weights.array.push(0))}}for(ae.bindShapeMatrix?ce.bindMatrix=new THREE.Matrix4().fromArray(ae.bindShapeMatrix).transpose():ce.bindMatrix=new THREE.Matrix4().identity(),Vn=0,Nn=on.array.length;Vn<Nn;Vn++){var Fr=on.array[Vn],bi=new THREE.Matrix4().fromArray(kt.array,Vn*kt.stride).transpose();ce.joints.push({name:Fr,boneInverse:bi})}return ce;function eo(Kr,qo){return qo.weight-Kr.weight}}function me(ae){return v(Ke.controllers[ae],xe)}function Ce(ae){var le={init_from:n(ae,"init_from")[0].textContent};Ke.images[ae.getAttribute("id")]=le}function Je(ae){return ae.build!==void 0?ae.build:ae.init_from}function Oe(ae){var le=Ke.images[ae];return le!==void 0?v(le,Je):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",ae),null)}function $e(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"profile_COMMON":le.profile=nt(Ae);break}}Ke.effects[ae.getAttribute("id")]=le}function nt(ae){for(var le={surfaces:{},samplers:{}},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"newparam":gt(Ae,le);break;case"technique":le.technique=mn(Ae);break;case"extra":le.extra=Fe(Ae);break}}return le}function gt(ae,le){for(var ce=ae.getAttribute("sid"),ge=0,Ae=ae.childNodes.length;ge<Ae;ge++){var tt=ae.childNodes[ge];if(tt.nodeType===1)switch(tt.nodeName){case"surface":le.surfaces[ce]=Tt(tt);break;case"sampler2D":le.samplers[ce]=Ze(tt);break}}}function Tt(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"init_from":le.init_from=Ae.textContent;break}}return le}function Ze(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"source":le.source=Ae.textContent;break}}return le}function mn(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"constant":case"lambert":case"blinn":case"phong":le.type=Ae.nodeName,le.parameters=Ft(Ae);break}}return le}function Ft(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":le[Ae.nodeName]=Qt(Ae);break;case"transparent":le[Ae.nodeName]={opaque:Ae.getAttribute("opaque"),data:Qt(Ae)};break}}return le}function Qt(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"color":le[Ae.nodeName]=o(Ae.textContent);break;case"float":le[Ae.nodeName]=parseFloat(Ae.textContent);break;case"texture":le[Ae.nodeName]={id:Ae.getAttribute("texture"),extra:Xt(Ae)};break}}return le}function Xt(ae){for(var le={technique:{}},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"extra":Tn(Ae,le);break}}return le}function Tn(ae,le){for(var ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"technique":vn(Ae,le);break}}}function vn(ae,le){for(var ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":le.technique[Ae.nodeName]=parseFloat(Ae.textContent);break;case"wrapU":case"wrapV":Ae.textContent.toUpperCase()==="TRUE"?le.technique[Ae.nodeName]=1:Ae.textContent.toUpperCase()==="FALSE"?le.technique[Ae.nodeName]=0:le.technique[Ae.nodeName]=parseInt(Ae.textContent);break}}}function Fe(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"technique":le.technique=Te(Ae);break}}return le}function Te(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"double_sided":le[Ae.nodeName]=parseInt(Ae.textContent);break}}return le}function pt(ae){return ae}function Nt(ae){return v(Ke.effects[ae],pt)}function zt(ae){for(var le={name:ae.getAttribute("name")},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"instance_effect":le.url=c(Ae.getAttribute("url"));break}}Ke.materials[ae.getAttribute("id")]=le}function Vt(ae){var le,ce=ae.slice((ae.lastIndexOf(".")-1>>>0)+2);switch(ce=ce.toLowerCase(),ce){case"tga":le=se;break;default:le=Y}return le}function fn(ae){var le=Nt(ae.url),ce=le.profile.technique,ge=le.profile.extra,Ae;switch(ce.type){case"phong":case"blinn":Ae=new THREE.MeshPhongMaterial;break;case"lambert":Ae=new THREE.MeshLambertMaterial;break;default:Ae=new THREE.MeshBasicMaterial;break}Ae.name=ae.name;function tt(oi){var Vn=le.profile.samplers[oi.id],Wn=null;if(Vn!==void 0){var Nn=le.profile.surfaces[Vn.source];Wn=Oe(Nn.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),Wn=Oe(oi.id);if(Wn!==null){var ai=Vt(Wn);if(ai!==void 0){var li=ai.load(Wn),xi=oi.extra;if(xi!==void 0&&xi.technique!==void 0&&h(xi.technique)===!1){var Bi=xi.technique;li.wrapS=Bi.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,li.wrapT=Bi.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,li.offset.set(Bi.offsetU||0,Bi.offsetV||0),li.repeat.set(Bi.repeatU||1,Bi.repeatV||1)}else li.wrapS=THREE.RepeatWrapping,li.wrapT=THREE.RepeatWrapping;return li}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",Wn),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",oi.id),null}var xt=ce.parameters;for(var Dt in xt){var Yt=xt[Dt];switch(Dt){case"diffuse":Yt.color&&Ae.color.fromArray(Yt.color),Yt.texture&&(Ae.map=tt(Yt.texture));break;case"specular":Yt.color&&Ae.specular&&Ae.specular.fromArray(Yt.color),Yt.texture&&(Ae.specularMap=tt(Yt.texture));break;case"bump":Yt.texture&&(Ae.normalMap=tt(Yt.texture));break;case"ambient":Yt.texture&&(Ae.lightMap=tt(Yt.texture));break;case"shininess":Yt.float&&Ae.shininess&&(Ae.shininess=Yt.float);break;case"emission":Yt.color&&Ae.emissive&&Ae.emissive.fromArray(Yt.color),Yt.texture&&(Ae.emissiveMap=tt(Yt.texture));break}}var on=xt.transparent,kt=xt.transparency;if(kt===void 0&&on&&(kt={float:1}),on===void 0&&kt&&(on={opaque:"A_ONE",data:{color:[1,1,1,1]}}),on&&kt)if(on.data.texture)Ae.transparent=!0;else{var bn=on.data.color;switch(on.opaque){case"A_ONE":Ae.opacity=bn[3]*kt.float;break;case"RGB_ZERO":Ae.opacity=1-bn[0]*kt.float;break;case"A_ZERO":Ae.opacity=1-bn[3]*kt.float;break;case"RGB_ONE":Ae.opacity=bn[0]*kt.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',on.opaque)}Ae.opacity<1&&(Ae.transparent=!0)}return ge!==void 0&&ge.technique!==void 0&&ge.technique.double_sided===1&&(Ae.side=THREE.DoubleSide),Ae}function mt(ae){return v(Ke.materials[ae],fn)}function Ee(ae){for(var le={name:ae.getAttribute("name")},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"optics":le.optics=_e(Ae);break}}Ke.cameras[ae.getAttribute("id")]=le}function _e(ae){for(var le=0;le<ae.childNodes.length;le++){var ce=ae.childNodes[le];switch(ce.nodeName){case"technique_common":return Ne(ce)}}return{}}function Ne(ae){for(var le={},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];switch(ge.nodeName){case"perspective":case"orthographic":le.technique=ge.nodeName,le.parameters=ye(ge);break}}return le}function ye(ae){for(var le={},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];switch(ge.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":le[ge.nodeName]=parseFloat(ge.textContent);break}}return le}function De(ae){var le;switch(ae.optics.technique){case"perspective":le=new THREE.PerspectiveCamera(ae.optics.parameters.yfov,ae.optics.parameters.aspect_ratio,ae.optics.parameters.znear,ae.optics.parameters.zfar);break;case"orthographic":var ce=ae.optics.parameters.ymag,ge=ae.optics.parameters.xmag,Ae=ae.optics.parameters.aspect_ratio;ge=ge===void 0?ce*Ae:ge,ce=ce===void 0?ge/Ae:ce,ge*=.5,ce*=.5,le=new THREE.OrthographicCamera(-ge,ge,ce,-ce,ae.optics.parameters.znear,ae.optics.parameters.zfar);break;default:le=new THREE.PerspectiveCamera;break}return le.name=ae.name,le}function ke(ae){var le=Ke.cameras[ae];return le!==void 0?v(le,De):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",ae),null)}function Ye(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"technique_common":le=Qe(Ae);break}}Ke.lights[ae.getAttribute("id")]=le}function Qe(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"directional":case"point":case"spot":case"ambient":le.technique=Ae.nodeName,le.parameters=ne(Ae)}}return le}function ne(ae){for(var le={},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"color":var tt=o(Ae.textContent);le.color=new THREE.Color().fromArray(tt);break;case"falloff_angle":le.falloffAngle=parseFloat(Ae.textContent);break;case"quadratic_attenuation":var xt=parseFloat(Ae.textContent);le.distance=xt?Math.sqrt(1/xt):0;break}}return le}function W(ae){var le;switch(ae.technique){case"directional":le=new THREE.DirectionalLight;break;case"point":le=new THREE.PointLight;break;case"spot":le=new THREE.SpotLight;break;case"ambient":le=new THREE.AmbientLight;break}return ae.parameters.color&&le.color.copy(ae.parameters.color),ae.parameters.distance&&(le.distance=ae.parameters.distance),le}function k(ae){var le=Ke.lights[ae];return le!==void 0?v(le,W):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",ae),null)}function he(ae){var le={name:ae.getAttribute("name"),sources:{},vertices:{},primitives:[]},ce=n(ae,"mesh")[0];if(ce!==void 0){for(var ge=0;ge<ce.childNodes.length;ge++){var Ae=ce.childNodes[ge];if(Ae.nodeType===1){var tt=Ae.getAttribute("id");switch(Ae.nodeName){case"source":le.sources[tt]=Re(Ae);break;case"vertices":le.vertices=We(Ae);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Ae.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":le.primitives.push(ve(Ae));break;default:console.log(Ae)}}}Ke.geometries[ae.getAttribute("id")]=le}}function Re(ae){for(var le={array:[],stride:3},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"float_array":le.array=o(ge.textContent);break;case"Name_array":le.array=i(ge.textContent);break;case"technique_common":var Ae=n(ge,"accessor")[0];Ae!==void 0&&(le.stride=parseInt(Ae.getAttribute("stride")));break}}return le}function We(ae){for(var le={},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];ge.nodeType===1&&(le[ge.getAttribute("semantic")]=c(ge.getAttribute("source")))}return le}function ve(ae){for(var le={type:ae.nodeName,material:ae.getAttribute("material"),count:parseInt(ae.getAttribute("count")),inputs:{},stride:0,hasUV:!1},ce=0,ge=ae.childNodes.length;ce<ge;ce++){var Ae=ae.childNodes[ce];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var tt=c(Ae.getAttribute("source")),xt=Ae.getAttribute("semantic"),Dt=parseInt(Ae.getAttribute("offset")),Yt=parseInt(Ae.getAttribute("set")),on=Yt>0?xt+Yt:xt;le.inputs[on]={id:tt,offset:Dt},le.stride=Math.max(le.stride,Dt+1),xt==="TEXCOORD"&&(le.hasUV=!0);break;case"vcount":le.vcount=a(Ae.textContent);break;case"p":le.p=a(Ae.textContent);break}}return le}function at(ae){for(var le={},ce=0;ce<ae.length;ce++){var ge=ae[ce];le[ge.type]===void 0&&(le[ge.type]=[]),le[ge.type].push(ge)}return le}function At(ae){for(var le=0,ce=0,ge=ae.length;ce<ge;ce++){var Ae=ae[ce];Ae.hasUV===!0&&le++}le>0&&le<ae.length&&(ae.uvsNeedsFix=!0)}function Ct(ae){var le={},ce=ae.sources,ge=ae.vertices,Ae=ae.primitives;if(Ae.length===0)return{};var tt=at(Ae);for(var xt in tt){var Dt=tt[xt];At(Dt),le[xt]=Pt(Dt,ce,ge)}return le}function Pt(ae,le,ce){for(var ge={},Ae={array:[],stride:0},tt={array:[],stride:0},xt={array:[],stride:0},Dt={array:[],stride:0},Yt={array:[],stride:0},on={array:[],stride:4},kt={array:[],stride:4},bn=new THREE.BufferGeometry,oi=[],Vn=0,Wn=0;Wn<ae.length;Wn++){var Nn=ae[Wn],ai=Nn.inputs,li=0;switch(Nn.type){case"lines":case"linestrips":li=Nn.count*2;break;case"triangles":li=Nn.count*3;break;case"polylist":for(var xi=0;xi<Nn.count;xi++){var Bi=Nn.vcount[xi];switch(Bi){case 3:li+=3;break;case 4:li+=6;break;default:li+=(Bi-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",Nn.type)}bn.addGroup(Vn,li,Wn),Vn+=li,Nn.material&&oi.push(Nn.material);for(var hr in ai){var Li=ai[hr];switch(hr){case"VERTEX":for(var Fr in ce){var bi=ce[Fr];switch(Fr){case"POSITION":var eo=Ae.array.length;if($t(Nn,le[bi],Li.offset,Ae.array),Ae.stride=le[bi].stride,le.skinWeights&&le.skinIndices&&($t(Nn,le.skinIndices,Li.offset,on.array),$t(Nn,le.skinWeights,Li.offset,kt.array)),Nn.hasUV===!1&&ae.uvsNeedsFix===!0)for(var li=(Ae.array.length-eo)/Ae.stride,Kr=0;Kr<li;Kr++)xt.array.push(0,0);break;case"NORMAL":$t(Nn,le[bi],Li.offset,tt.array),tt.stride=le[bi].stride;break;case"COLOR":$t(Nn,le[bi],Li.offset,Yt.array),Yt.stride=le[bi].stride;break;case"TEXCOORD":$t(Nn,le[bi],Li.offset,xt.array),xt.stride=le[bi].stride;break;case"TEXCOORD1":$t(Nn,le[bi],Li.offset,Dt.array),xt.stride=le[bi].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Fr)}}break;case"NORMAL":$t(Nn,le[Li.id],Li.offset,tt.array),tt.stride=le[Li.id].stride;break;case"COLOR":$t(Nn,le[Li.id],Li.offset,Yt.array),Yt.stride=le[Li.id].stride;break;case"TEXCOORD":$t(Nn,le[Li.id],Li.offset,xt.array),xt.stride=le[Li.id].stride;break;case"TEXCOORD1":$t(Nn,le[Li.id],Li.offset,Dt.array),Dt.stride=le[Li.id].stride;break}}}return Ae.array.length>0&&bn.addAttribute("position",new THREE.Float32BufferAttribute(Ae.array,Ae.stride)),tt.array.length>0&&bn.addAttribute("normal",new THREE.Float32BufferAttribute(tt.array,tt.stride)),Yt.array.length>0&&bn.addAttribute("color",new THREE.Float32BufferAttribute(Yt.array,Yt.stride)),xt.array.length>0&&bn.addAttribute("uv",new THREE.Float32BufferAttribute(xt.array,xt.stride)),Dt.array.length>0&&bn.addAttribute("uv2",new THREE.Float32BufferAttribute(Dt.array,Dt.stride)),on.array.length>0&&bn.addAttribute("skinIndex",new THREE.Float32BufferAttribute(on.array,on.stride)),kt.array.length>0&&bn.addAttribute("skinWeight",new THREE.Float32BufferAttribute(kt.array,kt.stride)),ge.data=bn,ge.type=ae[0].type,ge.materialKeys=oi,ge}function $t(ae,le,ce,ge){var Ae=ae.p,tt=ae.stride,xt=ae.vcount;function Dt(hr){for(var Li=Ae[hr+ce]*on,Fr=Li+on;Li<Fr;Li++)ge.push(Yt[Li])}var Yt=le.array,on=le.stride;if(ae.vcount!==void 0)for(var kt=0,bn=0,oi=xt.length;bn<oi;bn++){var Vn=xt[bn];if(Vn===4){var Wn=kt+tt*0,Nn=kt+tt*1,ai=kt+tt*2,li=kt+tt*3;Dt(Wn),Dt(Nn),Dt(li),Dt(Nn),Dt(ai),Dt(li)}else if(Vn===3){var Wn=kt+tt*0,Nn=kt+tt*1,ai=kt+tt*2;Dt(Wn),Dt(Nn),Dt(ai)}else if(Vn>4)for(var xi=1,Bi=Vn-2;xi<=Bi;xi++){var Wn=kt+tt*0,Nn=kt+tt*xi,ai=kt+tt*(xi+1);Dt(Wn),Dt(Nn),Dt(ai)}kt+=tt*Vn}else for(var bn=0,oi=Ae.length;bn<oi;bn+=tt)Dt(bn)}function Bn(ae){return v(Ke.geometries[ae],Ct)}function pi(ae){for(var le={name:ae.getAttribute("name")||"",joints:{},links:[]},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"technique_common":sn(ge,le);break}}Ke.kinematicsModels[ae.getAttribute("id")]=le}function Ri(ae){return ae.build!==void 0?ae.build:ae}function Fn(ae){return v(Ke.kinematicsModels[ae],Ri)}function sn(ae,le){for(var ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"joint":le.joints[ge.getAttribute("sid")]=Rt(ge);break;case"link":le.links.push(si(ge));break}}}function Rt(ae){for(var le,ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"prismatic":case"revolute":le=gn(ge);break}}return le}function gn(ae,ce){for(var ce={sid:ae.getAttribute("sid"),name:ae.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:ae.nodeName,static:!1,zeroPosition:0,middlePosition:0},ge=0;ge<ae.childNodes.length;ge++){var Ae=ae.childNodes[ge];if(Ae.nodeType===1)switch(Ae.nodeName){case"axis":var tt=o(Ae.textContent);ce.axis.fromArray(tt);break;case"limits":var xt=Ae.getElementsByTagName("max")[0],Dt=Ae.getElementsByTagName("min")[0];ce.limits.max=parseFloat(xt.textContent),ce.limits.min=parseFloat(Dt.textContent);break}}return ce.limits.min>=ce.limits.max&&(ce.static=!0),ce.middlePosition=(ce.limits.min+ce.limits.max)/2,ce}function si(ae){for(var le={sid:ae.getAttribute("sid"),name:ae.getAttribute("name")||"",attachments:[],transforms:[]},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"attachment_full":le.attachments.push(Ln(ge));break;case"matrix":case"translate":case"rotate":le.transforms.push(Jn(ge));break}}return le}function Ln(ae){for(var le={joint:ae.getAttribute("joint").split("/").pop(),transforms:[],links:[]},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"link":le.links.push(si(ge));break;case"matrix":case"translate":case"rotate":le.transforms.push(Jn(ge));break}}return le}function Jn(ae){var le={type:ae.nodeName},ce=o(ae.textContent);switch(le.type){case"matrix":le.obj=new THREE.Matrix4,le.obj.fromArray(ce).transpose();break;case"translate":le.obj=new THREE.Vector3,le.obj.fromArray(ce);break;case"rotate":le.obj=new THREE.Vector3,le.obj.fromArray(ce),le.angle=THREE.MathUtils.degToRad(ce[3]);break}return le}function $n(ae){for(var le={name:ae.getAttribute("name")||"",rigidBodies:{}},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"rigid_body":le.rigidBodies[ge.getAttribute("name")]={},Ei(ge,le.rigidBodies[ge.getAttribute("name")]);break}}Ke.physicsModels[ae.getAttribute("id")]=le}function Ei(ae,le){for(var ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"technique_common":Fi(ge,le);break}}}function Fi(ae,le){for(var ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"inertia":le.inertia=o(ge.textContent);break;case"mass":le.mass=o(ge.textContent)[0];break}}}function Vi(ae){for(var le={bindJointAxis:[]},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"bind_joint_axis":le.bindJointAxis.push(lr(ge));break}}Ke.kinematicsScenes[c(ae.getAttribute("url"))]=le}function lr(ae){for(var le={target:ae.getAttribute("target").split("/").pop()},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"axis":var Ae=ge.getElementsByTagName("param")[0];le.axis=Ae.textContent;var tt=le.axis.split("inst_").pop().split("axis")[0];le.jointIndex=tt.substr(0,tt.length-1);break}}return le}function cr(ae){return ae.build!==void 0?ae.build:ae}function Le(ae){return v(Ke.kinematicsScenes[ae],cr)}function ht(){var ae=Object.keys(Ke.kinematicsModels)[0],le=Object.keys(Ke.kinematicsScenes)[0],ce=Object.keys(Ke.visualScenes)[0];if(ae===void 0||le===void 0)return;for(var ge=Fn(ae),Ae=Le(le),tt=Zn(ce),xt=Ae.bindJointAxis,Dt={},Yt=0,on=xt.length;Yt<on;Yt++){var kt=xt[Yt],bn=Kn.querySelector('[sid="'+kt.target+'"]');if(bn){var oi=bn.parentElement;Vn(kt.jointIndex,oi)}}function Vn(Nn,ai){var li=ai.getAttribute("name"),xi=ge.joints[Nn];tt.traverse(function(Bi){Bi.name===li&&(Dt[Nn]={object:Bi,transforms:yt(ai),joint:xi,position:xi.zeroPosition})})}var Wn=new THREE.Matrix4;we={joints:ge&&ge.joints,getJointValue:function(Nn){var ai=Dt[Nn];if(ai)return ai.position;console.warn("THREE.ColladaLoader: Joint "+Nn+" doesn't exist.")},setJointValue:function(Nn,ai){var li=Dt[Nn];if(li){var xi=li.joint;if(ai>xi.limits.max||ai<xi.limits.min)console.warn("THREE.ColladaLoader: Joint "+Nn+" value "+ai+" outside of limits (min: "+xi.limits.min+", max: "+xi.limits.max+").");else if(xi.static)console.warn("THREE.ColladaLoader: Joint "+Nn+" is static.");else{var Bi=li.object,hr=xi.axis,Li=li.transforms;be.identity();for(var Fr=0;Fr<Li.length;Fr++){var bi=Li[Fr];if(bi.sid&&bi.sid.indexOf(Nn)!==-1)switch(xi.type){case"revolute":be.multiply(Wn.makeRotationAxis(hr,THREE.MathUtils.degToRad(ai)));break;case"prismatic":be.multiply(Wn.makeTranslation(hr.x*ai,hr.y*ai,hr.z*ai));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+xi.type);break}else switch(bi.type){case"matrix":be.multiply(bi.obj);break;case"translate":be.multiply(Wn.makeTranslation(bi.obj.x,bi.obj.y,bi.obj.z));break;case"scale":be.scale(bi.obj);break;case"rotate":be.multiply(Wn.makeRotationAxis(bi.obj,bi.angle));break}}Bi.matrix.copy(be),Bi.matrix.decompose(Bi.position,Bi.quaternion,Bi.scale),Dt[Nn].position=ai}}else console.log("THREE.ColladaLoader: "+Nn+" does not exist.")}}}function yt(ae){for(var le=[],ce=Kn.querySelector('[id="'+ae.id+'"]'),ge=0;ge<ce.childNodes.length;ge++){var Ae=ce.childNodes[ge];if(Ae.nodeType===1)switch(Ae.nodeName){case"matrix":var xt=o(Ae.textContent),tt=new THREE.Matrix4().fromArray(xt).transpose();le.push({sid:Ae.getAttribute("sid"),type:Ae.nodeName,obj:tt});break;case"translate":case"scale":var xt=o(Ae.textContent),Dt=new THREE.Vector3().fromArray(xt);le.push({sid:Ae.getAttribute("sid"),type:Ae.nodeName,obj:Dt});break;case"rotate":var xt=o(Ae.textContent),Dt=new THREE.Vector3().fromArray(xt),Yt=THREE.MathUtils.degToRad(xt[3]);le.push({sid:Ae.getAttribute("sid"),type:Ae.nodeName,obj:Dt,angle:Yt});break}}return le}function de(ae){for(var le=ae.getElementsByTagName("node"),ce=0;ce<le.length;ce++){var ge=le[ce];ge.hasAttribute("id")===!1&&ge.setAttribute("id",u())}}var be=new THREE.Matrix4,Ve=new THREE.Vector3;function dt(ae){for(var le={name:ae.getAttribute("name")||"",type:ae.getAttribute("type"),id:ae.getAttribute("id"),sid:ae.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];if(ge.nodeType===1)switch(ge.nodeName){case"node":le.nodes.push(ge.getAttribute("id")),dt(ge);break;case"instance_camera":le.instanceCameras.push(c(ge.getAttribute("url")));break;case"instance_controller":le.instanceControllers.push(ut(ge));break;case"instance_light":le.instanceLights.push(c(ge.getAttribute("url")));break;case"instance_geometry":le.instanceGeometries.push(ut(ge));break;case"instance_node":le.instanceNodes.push(c(ge.getAttribute("url")));break;case"matrix":var tt=o(ge.textContent);le.matrix.multiply(be.fromArray(tt).transpose()),le.transforms[ge.getAttribute("sid")]=ge.nodeName;break;case"translate":var tt=o(ge.textContent);Ve.fromArray(tt),le.matrix.multiply(be.makeTranslation(Ve.x,Ve.y,Ve.z)),le.transforms[ge.getAttribute("sid")]=ge.nodeName;break;case"rotate":var tt=o(ge.textContent),Ae=THREE.MathUtils.degToRad(tt[3]);le.matrix.multiply(be.makeRotationAxis(Ve.fromArray(tt),Ae)),le.transforms[ge.getAttribute("sid")]=ge.nodeName;break;case"scale":var tt=o(ge.textContent);le.matrix.scale(Ve.fromArray(tt)),le.transforms[ge.getAttribute("sid")]=ge.nodeName;break;case"extra":break;default:console.log(ge)}}return Dn(le.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",le.id):Ke.nodes[le.id]=le,le}function ut(ae){for(var le={id:c(ae.getAttribute("url")),materials:{},skeletons:[]},ce=0;ce<ae.childNodes.length;ce++){var ge=ae.childNodes[ce];switch(ge.nodeName){case"bind_material":for(var Ae=ge.getElementsByTagName("instance_material"),tt=0;tt<Ae.length;tt++){var xt=Ae[tt],Dt=xt.getAttribute("symbol"),Yt=xt.getAttribute("target");le.materials[Dt]=c(Yt)}break;case"skeleton":le.skeletons.push(c(ge.textContent));break}}return le}function _t(ae,le){var ce=[],ge=[],Ae,tt,xt;for(Ae=0;Ae<ae.length;Ae++){var Dt=ae[Ae],Yt;if(Dn(Dt))Yt=jn(Dt),It(Yt,le,ce);else if(vi(Dt))for(var on=Ke.visualScenes[Dt],kt=on.children,tt=0;tt<kt.length;tt++){var bn=kt[tt];if(bn.type==="JOINT"){var Yt=jn(bn.id);It(Yt,le,ce)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Dt)}for(Ae=0;Ae<le.length;Ae++)for(tt=0;tt<ce.length;tt++)if(xt=ce[tt],xt.bone.name===le[Ae].name){ge[Ae]=xt,xt.processed=!0;break}for(Ae=0;Ae<ce.length;Ae++)xt=ce[Ae],xt.processed===!1&&(ge.push(xt),xt.processed=!0);var oi=[],Vn=[];for(Ae=0;Ae<ge.length;Ae++)xt=ge[Ae],oi.push(xt.bone),Vn.push(xt.boneInverse);return new THREE.Skeleton(oi,Vn)}function It(ae,le,ce){ae.traverse(function(ge){if(ge.isBone===!0){for(var Ae,tt=0;tt<le.length;tt++){var xt=le[tt];if(xt.name===ge.name){Ae=xt.boneInverse;break}}Ae===void 0&&(Ae=new THREE.Matrix4),ce.push({bone:ge,boneInverse:Ae,processed:!1})}})}function Zt(ae){for(var le=[],ce=ae.matrix,ge=ae.nodes,Ae=ae.type,tt=ae.instanceCameras,xt=ae.instanceControllers,Dt=ae.instanceLights,Yt=ae.instanceGeometries,on=ae.instanceNodes,kt=0,bn=ge.length;kt<bn;kt++)le.push(jn(ge[kt]));for(var kt=0,bn=tt.length;kt<bn;kt++){var oi=ke(tt[kt]);oi!==null&&le.push(oi.clone())}for(var kt=0,bn=xt.length;kt<bn;kt++)for(var Vn=xt[kt],Wn=me(Vn.id),Nn=Bn(Wn.id),ai=Pn(Nn,Vn.materials),li=Vn.skeletons,xi=Wn.skin.joints,Bi=_t(li,xi),hr=0,Li=ai.length;hr<Li;hr++){var bi=ai[hr];bi.isSkinnedMesh&&(bi.bind(Bi,Wn.skin.bindMatrix),bi.normalizeSkinWeights()),le.push(bi)}for(var kt=0,bn=Dt.length;kt<bn;kt++){var Fr=k(Dt[kt]);Fr!==null&&le.push(Fr.clone())}for(var kt=0,bn=Yt.length;kt<bn;kt++)for(var Vn=Yt[kt],Nn=Bn(Vn.id),ai=Pn(Nn,Vn.materials),hr=0,Li=ai.length;hr<Li;hr++)le.push(ai[hr]);for(var kt=0,bn=on.length;kt<bn;kt++)le.push(jn(on[kt]).clone());var bi;if(ge.length===0&&le.length===1)bi=le[0];else{bi=Ae==="JOINT"?new THREE.Bone:new THREE.Group;for(var kt=0;kt<le.length;kt++)bi.add(le[kt])}return bi.name===""&&(bi.name=Ae==="JOINT"?ae.sid:ae.name),bi.matrix.copy(ce),bi.matrix.decompose(bi.position,bi.quaternion,bi.scale),bi}var Wt=new THREE.MeshBasicMaterial({color:16711935});function Lt(ae,le){for(var ce=[],ge=0,Ae=ae.length;ge<Ae;ge++){var tt=le[ae[ge]];tt===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",ae[ge]),ce.push(Wt)):ce.push(mt(tt))}return ce}function Pn(ae,le){var ce=[];for(var ge in ae){var Ae=ae[ge],tt=Lt(Ae.materialKeys,le);tt.length===0&&(ge==="lines"||ge==="linestrips"?tt.push(new THREE.LineBasicMaterial):tt.push(new THREE.MeshPhongMaterial));var xt=Ae.data.attributes.skinIndex!==void 0;if(xt)for(var Dt=0,Yt=tt.length;Dt<Yt;Dt++)tt[Dt].skinning=!0;var on=tt.length===1?tt[0]:tt,kt;switch(ge){case"lines":kt=new THREE.LineSegments(Ae.data,on);break;case"linestrips":kt=new THREE.Line(Ae.data,on);break;case"triangles":case"polylist":xt?kt=new THREE.SkinnedMesh(Ae.data,on):kt=new THREE.Mesh(Ae.data,on);break}ce.push(kt)}return ce}function Dn(ae){return Ke.nodes[ae]!==void 0}function jn(ae){return v(Ke.nodes[ae],Zt)}function di(ae){var le={name:ae.getAttribute("name"),children:[]};de(ae);for(var ce=n(ae,"node"),ge=0;ge<ce.length;ge++)le.children.push(dt(ce[ge]));Ke.visualScenes[ae.getAttribute("id")]=le}function Cn(ae){var le=new THREE.Group;le.name=ae.name;for(var ce=ae.children,ge=0;ge<ce.length;ge++){var Ae=ce[ge];le.add(jn(Ae.id))}return le}function vi(ae){return Ke.visualScenes[ae]!==void 0}function Zn(ae){return v(Ke.visualScenes[ae],Cn)}function nr(ae){var le=n(ae,"instance_visual_scene")[0];return Zn(c(le.getAttribute("url")))}function Rr(){var ae=Ke.clips;if(h(ae)===!0){if(h(Ke.animations)===!1){var le=[];for(var ce in Ke.animations)for(var ge=M(ce),Ae=0,tt=ge.length;Ae<tt;Ae++)le.push(ge[Ae]);pe.push(new THREE.AnimationClip("default",-1,le))}}else for(var ce in ae)pe.push(H(ce))}if(s.length===0)return{scene:new THREE.Scene};var Rn=new DOMParser().parseFromString(s,"application/xml"),Kn=n(Rn,"COLLADA")[0],zi=Kn.getAttribute("version");console.log("THREE.ColladaLoader: File version",zi);var Si=d(n(Kn,"asset")[0]),Y=new THREE.TextureLoader(this.manager);Y.setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);var se;THREE.TGALoader&&(se=new THREE.TGALoader(this.manager),se.setPath(this.resourcePath||e));var pe=[],we={},Ue=0,Ke={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};A(Kn,"library_animations","animation",b),A(Kn,"library_animation_clips","animation_clip",j),A(Kn,"library_controllers","controller",te),A(Kn,"library_images","image",Ce),A(Kn,"library_effects","effect",$e),A(Kn,"library_materials","material",zt),A(Kn,"library_cameras","camera",Ee),A(Kn,"library_lights","light",Ye),A(Kn,"library_geometries","geometry",he),A(Kn,"library_nodes","node",dt),A(Kn,"library_visual_scenes","visual_scene",di),A(Kn,"library_kinematics_models","kinematics_model",pi),A(Kn,"library_physics_models","physics_model",$n),A(Kn,"scene","instance_kinematics_scene",Vi),g(Ke.animations,S),g(Ke.clips,G),g(Ke.controllers,xe),g(Ke.images,Je),g(Ke.effects,pt),g(Ke.materials,fn),g(Ke.cameras,De),g(Ke.lights,W),g(Ke.geometries,Ct),g(Ke.visualScenes,Cn),Rr(),ht();var ft=nr(n(Kn,"scene")[0]);return Si.upAxis==="Z_UP"&&ft.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),ft.scale.multiplyScalar(Si.unit),{animations:pe,kinematics:we,library:Ke,scene:ft}}};THREE.ColladaLoader=EU;AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var s=this,e=this.el,n=this.data,i=this.el.sceneEl.systems.renderer;n&&(this.remove(),this.loader.load(n,function(o){s.model=o.scene,s.model.traverse(function(a){if(a.isMesh){var c=a.material;c.color&&i.applyColorCorrection(c.color),c.map&&i.applyColorCorrection(c.map),c.emissive&&i.applyColorCorrection(c.emissive),c.emissiveMap&&i.applyColorCorrection(c.emissiveMap)}}),e.setObject3D("mesh",s.model),e.emit("model-loaded",{format:"collada",model:s.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const sI="159",yb=0,bU=1,vC=1,yC=100,xC=204,EC=205,bC=3,S_=0,_C="attached",_U="detached",oI=300,wU=303,av=1e3,Yd=1001,wC=1002,lv=1003,MU=1006,CU=1008,SU=1009,TU=1014,aI=1015,RU=1020,lI=1023,l1=1026,MC=1027,cv=2300,hv=2301,c1=2302,CC=2400,SC=2401,TC=2402,IU=2500,BU=3e3,h1=3001,cI=0,X0="",po="srgb",T_="srgb-linear",LU="display-p3",hI="display-p3-linear",xb="linear",RC="srgb",IC="rec709",BC="p3",Xu=7680,LC=519,PU=515,PC=35044,Yh=2e3,Eb=2001;let Fv=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const o=this._listeners[e];if(o!==void 0){const a=o.indexOf(n);a!==-1&&o.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const o=i.slice(0);for(let a=0,c=o.length;a<c;a++)o[a].call(this,e);e.target=null}}};const Ws=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let DC=1234567;const Yp=Math.PI/180,am=180/Math.PI;function Jc(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Ws[s&255]+Ws[s>>8&255]+Ws[s>>16&255]+Ws[s>>24&255]+"-"+Ws[e&255]+Ws[e>>8&255]+"-"+Ws[e>>16&15|64]+Ws[e>>24&255]+"-"+Ws[n&63|128]+Ws[n>>8&255]+"-"+Ws[n>>16&255]+Ws[n>>24&255]+Ws[i&255]+Ws[i>>8&255]+Ws[i>>16&255]+Ws[i>>24&255]).toLowerCase()}function Ns(s,e,n){return Math.max(e,Math.min(n,s))}function R_(s,e){return(s%e+e)%e}function DU(s,e,n,i,o){return i+(s-e)*(o-i)/(n-e)}function OU(s,e,n){return s!==e?(n-s)/(e-s):0}function $p(s,e,n){return(1-n)*s+n*e}function FU(s,e,n,i){return $p(s,e,1-Math.exp(-n*i))}function NU(s,e=1){return e-Math.abs(R_(s,e*2)-e)}function UU(s,e,n){return s<=e?0:s>=n?1:(s=(s-e)/(n-e),s*s*(3-2*s))}function kU(s,e,n){return s<=e?0:s>=n?1:(s=(s-e)/(n-e),s*s*s*(s*(s*6-15)+10))}function zU(s,e){return s+Math.floor(Math.random()*(e-s+1))}function GU(s,e){return s+Math.random()*(e-s)}function VU(s){return s*(.5-Math.random())}function HU(s){s!==void 0&&(DC=s);let e=DC+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function jU(s){return s*Yp}function WU(s){return s*am}function QU(s){return(s&s-1)===0&&s!==0}function XU(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function KU(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function qU(s,e,n,i,o){const a=Math.cos,c=Math.sin,u=a(n/2),h=c(n/2),d=a((e+i)/2),f=c((e+i)/2),p=a((e-i)/2),A=c((e-i)/2),g=a((i-e)/2),v=c((i-e)/2);switch(o){case"XYX":s.set(u*f,h*p,h*A,u*d);break;case"YZY":s.set(h*A,u*f,h*p,u*d);break;case"ZXZ":s.set(h*p,h*A,u*f,u*d);break;case"XZX":s.set(u*f,h*v,h*g,u*d);break;case"YXY":s.set(h*g,u*f,h*v,u*d);break;case"ZYZ":s.set(h*v,h*g,u*f,u*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}function Xd(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function lo(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const uo={DEG2RAD:Yp,RAD2DEG:am,generateUUID:Jc,clamp:Ns,euclideanModulo:R_,mapLinear:DU,inverseLerp:OU,lerp:$p,damp:FU,pingpong:NU,smoothstep:UU,smootherstep:kU,randInt:zU,randFloat:GU,randFloatSpread:VU,seededRandom:HU,degToRad:jU,radToDeg:WU,isPowerOfTwo:QU,ceilPowerOfTwo:XU,floorPowerOfTwo:KU,setQuaternionFromProperEuler:qU,normalize:lo,denormalize:Xd};let gs=class uI{constructor(e=0,n=0){uI.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6],this.y=o[1]*n+o[4]*i+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Ns(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),o=Math.sin(n),a=this.x-e.x,c=this.y-e.y;return this.x=a*i-c*o+e.x,this.y=a*o+c*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Zc=class dI{constructor(e,n,i,o,a,c,u,h,d){dI.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,o,a,c,u,h,d)}set(e,n,i,o,a,c,u,h,d){const f=this.elements;return f[0]=e,f[1]=o,f[2]=u,f[3]=n,f[4]=a,f[5]=h,f[6]=i,f[7]=c,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,o=n.elements,a=this.elements,c=i[0],u=i[3],h=i[6],d=i[1],f=i[4],p=i[7],A=i[2],g=i[5],v=i[8],b=o[0],x=o[3],E=o[6],S=o[1],M=o[4],C=o[7],T=o[2],L=o[5],B=o[8];return a[0]=c*b+u*S+h*T,a[3]=c*x+u*M+h*L,a[6]=c*E+u*C+h*B,a[1]=d*b+f*S+p*T,a[4]=d*x+f*M+p*L,a[7]=d*E+f*C+p*B,a[2]=A*b+g*S+v*T,a[5]=A*x+g*M+v*L,a[8]=A*E+g*C+v*B,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8];return n*c*f-n*u*d-i*a*f+i*u*h+o*a*d-o*c*h}invert(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8],p=f*c-u*d,A=u*h-f*a,g=d*a-c*h,v=n*p+i*A+o*g;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/v;return e[0]=p*b,e[1]=(o*d-f*i)*b,e[2]=(u*i-o*c)*b,e[3]=A*b,e[4]=(f*n-o*h)*b,e[5]=(o*a-u*n)*b,e[6]=g*b,e[7]=(i*h-d*n)*b,e[8]=(c*n-i*a)*b,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,o,a,c,u){const h=Math.cos(a),d=Math.sin(a);return this.set(i*h,i*d,-i*(h*c+d*u)+c+e,-o*d,o*h,-o*(-d*c+h*u)+u+n,0,0,1),this}scale(e,n){return this.premultiply(u1.makeScale(e,n)),this}rotate(e){return this.premultiply(u1.makeRotation(-e)),this}translate(e,n){return this.premultiply(u1.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let o=0;o<9;o++)if(n[o]!==i[o])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const u1=new Zc;function YU(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function bb(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}const OC={};function d1(s){s in OC||(OC[s]=!0,console.warn(s))}const FC=new Zc().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),NC=new Zc().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),hA={[T_]:{transfer:xb,primaries:IC,toReference:s=>s,fromReference:s=>s},[po]:{transfer:RC,primaries:IC,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[hI]:{transfer:xb,primaries:BC,toReference:s=>s.applyMatrix3(NC),fromReference:s=>s.applyMatrix3(FC)},[LU]:{transfer:RC,primaries:BC,toReference:s=>s.convertSRGBToLinear().applyMatrix3(NC),fromReference:s=>s.applyMatrix3(FC).convertLinearToSRGB()}},$U=new Set([T_,hI]),ga={enabled:!0,_workingColorSpace:T_,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(s){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!s},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!$U.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,n){if(this.enabled===!1||e===n||!e||!n)return s;const i=hA[e].toReference,o=hA[n].fromReference;return o(i(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return hA[s].primaries},getTransfer:function(s){return s===X0?xb:hA[s].transfer}};function nf(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function f1(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let Ku,JU=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Ku===void 0&&(Ku=bb("canvas")),Ku.width=e.width,Ku.height=e.height;const i=Ku.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=Ku}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=bb("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const o=i.getImageData(0,0,e.width,e.height),a=o.data;for(let c=0;c<a.length;c++)a[c]=nf(a[c]/255)*255;return i.putImageData(o,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(nf(n[i]/255)*255):n[i]=nf(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},ZU=0,ek=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ZU++}),this.uuid=Jc(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},o=this.data;if(o!==null){let a;if(Array.isArray(o)){a=[];for(let c=0,u=o.length;c<u;c++)o[c].isDataTexture?a.push(p1(o[c].image)):a.push(p1(o[c]))}else a=p1(o);i.url=a}return n||(e.images[this.uuid]=i),i}};function p1(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?JU.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let tk=0,ql=class K0 extends Fv{constructor(e=K0.DEFAULT_IMAGE,n=K0.DEFAULT_MAPPING,i=Yd,o=Yd,a=MU,c=CU,u=lI,h=SU,d=K0.DEFAULT_ANISOTROPY,f=X0){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:tk++}),this.uuid=Jc(),this.name="",this.source=new ek(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=o,this.magFilter=a,this.minFilter=c,this.anisotropy=d,this.format=u,this.internalFormat=null,this.type=h,this.offset=new gs(0,0),this.repeat=new gs(1,1),this.center=new gs(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zc,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(d1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===h1?po:X0),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==oI)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case av:e.x=e.x-Math.floor(e.x);break;case Yd:e.x=e.x<0?0:1;break;case wC:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case av:e.y=e.y-Math.floor(e.y);break;case Yd:e.y=e.y<0?0:1;break;case wC:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return d1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===po?h1:BU}set encoding(e){d1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===h1?po:X0}};ql.DEFAULT_IMAGE=null;ql.DEFAULT_MAPPING=oI;ql.DEFAULT_ANISOTROPY=1;let To=class fI{constructor(e=0,n=0,i=0,o=1){fI.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,o){return this.x=e,this.y=n,this.z=i,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,o=this.z,a=this.w,c=e.elements;return this.x=c[0]*n+c[4]*i+c[8]*o+c[12]*a,this.y=c[1]*n+c[5]*i+c[9]*o+c[13]*a,this.z=c[2]*n+c[6]*i+c[10]*o+c[14]*a,this.w=c[3]*n+c[7]*i+c[11]*o+c[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,o,a;const h=e.elements,d=h[0],f=h[4],p=h[8],A=h[1],g=h[5],v=h[9],b=h[2],x=h[6],E=h[10];if(Math.abs(f-A)<.01&&Math.abs(p-b)<.01&&Math.abs(v-x)<.01){if(Math.abs(f+A)<.1&&Math.abs(p+b)<.1&&Math.abs(v+x)<.1&&Math.abs(d+g+E-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const M=(d+1)/2,C=(g+1)/2,T=(E+1)/2,L=(f+A)/4,B=(p+b)/4,F=(v+x)/4;return M>C&&M>T?M<.01?(i=0,o=.707106781,a=.707106781):(i=Math.sqrt(M),o=L/i,a=B/i):C>T?C<.01?(i=.707106781,o=0,a=.707106781):(o=Math.sqrt(C),i=L/o,a=F/o):T<.01?(i=.707106781,o=.707106781,a=0):(a=Math.sqrt(T),i=B/a,o=F/a),this.set(i,o,a,n),this}let S=Math.sqrt((x-v)*(x-v)+(p-b)*(p-b)+(A-f)*(A-f));return Math.abs(S)<.001&&(S=1),this.x=(x-v)/S,this.y=(p-b)/S,this.z=(A-f)/S,this.w=Math.acos((d+g+E-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},So=class{constructor(e=0,n=0,i=0,o=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=o}static slerpFlat(e,n,i,o,a,c,u){let h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];const A=a[c+0],g=a[c+1],v=a[c+2],b=a[c+3];if(u===0){e[n+0]=h,e[n+1]=d,e[n+2]=f,e[n+3]=p;return}if(u===1){e[n+0]=A,e[n+1]=g,e[n+2]=v,e[n+3]=b;return}if(p!==b||h!==A||d!==g||f!==v){let x=1-u;const E=h*A+d*g+f*v+p*b,S=E>=0?1:-1,M=1-E*E;if(M>Number.EPSILON){const T=Math.sqrt(M),L=Math.atan2(T,E*S);x=Math.sin(x*L)/T,u=Math.sin(u*L)/T}const C=u*S;if(h=h*x+A*C,d=d*x+g*C,f=f*x+v*C,p=p*x+b*C,x===1-u){const T=1/Math.sqrt(h*h+d*d+f*f+p*p);h*=T,d*=T,f*=T,p*=T}}e[n]=h,e[n+1]=d,e[n+2]=f,e[n+3]=p}static multiplyQuaternionsFlat(e,n,i,o,a,c){const u=i[o],h=i[o+1],d=i[o+2],f=i[o+3],p=a[c],A=a[c+1],g=a[c+2],v=a[c+3];return e[n]=u*v+f*p+h*g-d*A,e[n+1]=h*v+f*A+d*p-u*g,e[n+2]=d*v+f*g+u*A-h*p,e[n+3]=f*v-u*p-h*A-d*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,o){return this._x=e,this._y=n,this._z=i,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const i=e._x,o=e._y,a=e._z,c=e._order,u=Math.cos,h=Math.sin,d=u(i/2),f=u(o/2),p=u(a/2),A=h(i/2),g=h(o/2),v=h(a/2);switch(c){case"XYZ":this._x=A*f*p+d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p-A*g*v;break;case"YXZ":this._x=A*f*p+d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p+A*g*v;break;case"ZXY":this._x=A*f*p-d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p-A*g*v;break;case"ZYX":this._x=A*f*p-d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p+A*g*v;break;case"YZX":this._x=A*f*p+d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p-A*g*v;break;case"XZY":this._x=A*f*p-d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p+A*g*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,o=Math.sin(i);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],o=n[4],a=n[8],c=n[1],u=n[5],h=n[9],d=n[2],f=n[6],p=n[10],A=i+u+p;if(A>0){const g=.5/Math.sqrt(A+1);this._w=.25/g,this._x=(f-h)*g,this._y=(a-d)*g,this._z=(c-o)*g}else if(i>u&&i>p){const g=2*Math.sqrt(1+i-u-p);this._w=(f-h)/g,this._x=.25*g,this._y=(o+c)/g,this._z=(a+d)/g}else if(u>p){const g=2*Math.sqrt(1+u-i-p);this._w=(a-d)/g,this._x=(o+c)/g,this._y=.25*g,this._z=(h+f)/g}else{const g=2*Math.sqrt(1+p-i-u);this._w=(c-o)/g,this._x=(a+d)/g,this._y=(h+f)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ns(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const o=Math.min(1,n/i);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,o=e._y,a=e._z,c=e._w,u=n._x,h=n._y,d=n._z,f=n._w;return this._x=i*f+c*u+o*d-a*h,this._y=o*f+c*h+a*u-i*d,this._z=a*f+c*d+i*h-o*u,this._w=c*f-i*u-o*h-a*d,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,o=this._y,a=this._z,c=this._w;let u=c*e._w+i*e._x+o*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=c,this._x=i,this._y=o,this._z=a,this;const h=1-u*u;if(h<=Number.EPSILON){const g=1-n;return this._w=g*c+n*this._w,this._x=g*i+n*this._x,this._y=g*o+n*this._y,this._z=g*a+n*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(h),f=Math.atan2(d,u),p=Math.sin((1-n)*f)/d,A=Math.sin(n*f)/d;return this._w=c*p+this._w*A,this._x=i*p+this._x*A,this._y=o*p+this._y*A,this._z=a*p+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),o=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(n*Math.cos(o),i*Math.sin(a),i*Math.cos(a),n*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Mt=class pI{constructor(e=0,n=0,i=0){pI.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(UC.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(UC.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,o=this.z,a=e.elements;return this.x=a[0]*n+a[3]*i+a[6]*o,this.y=a[1]*n+a[4]*i+a[7]*o,this.z=a[2]*n+a[5]*i+a[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,o=this.z,a=e.elements,c=1/(a[3]*n+a[7]*i+a[11]*o+a[15]);return this.x=(a[0]*n+a[4]*i+a[8]*o+a[12])*c,this.y=(a[1]*n+a[5]*i+a[9]*o+a[13])*c,this.z=(a[2]*n+a[6]*i+a[10]*o+a[14])*c,this}applyQuaternion(e){const n=this.x,i=this.y,o=this.z,a=e.x,c=e.y,u=e.z,h=e.w,d=2*(c*o-u*i),f=2*(u*n-a*o),p=2*(a*i-c*n);return this.x=n+h*d+c*p-u*f,this.y=i+h*f+u*d-a*p,this.z=o+h*p+a*f-c*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,o=this.z,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*o,this.y=a[1]*n+a[5]*i+a[9]*o,this.z=a[2]*n+a[6]*i+a[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,o=e.y,a=e.z,c=n.x,u=n.y,h=n.z;return this.x=o*h-a*u,this.y=a*c-i*h,this.z=i*u-o*c,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return m1.copy(this).projectOnVector(e),this.sub(m1)}reflect(e){return this.sub(m1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Ns(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,o=this.z-e.z;return n*n+i*i+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const o=Math.sin(n)*e;return this.x=o*Math.sin(i),this.y=Math.cos(n)*e,this.z=o*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=o,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const m1=new Mt,UC=new So;let Af=class{constructor(e=new Mt(1/0,1/0,1/0),n=new Mt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Aa.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Aa.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Aa.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const a=i.getAttribute("position");if(n===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let c=0,u=a.count;c<u;c++)e.isMesh===!0?e.getVertexPosition(c,Aa):Aa.fromBufferAttribute(a,c),Aa.applyMatrix4(e.matrixWorld),this.expandByPoint(Aa);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),uA.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),uA.copy(i.boundingBox)),uA.applyMatrix4(e.matrixWorld),this.union(uA)}const o=e.children;for(let a=0,c=o.length;a<c;a++)this.expandByObject(o[a],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Aa),Aa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(cp),dA.subVectors(this.max,cp),qu.subVectors(e.a,cp),Yu.subVectors(e.b,cp),$u.subVectors(e.c,cp),yc.subVectors(Yu,qu),xc.subVectors($u,Yu),Ph.subVectors(qu,$u);let n=[0,-yc.z,yc.y,0,-xc.z,xc.y,0,-Ph.z,Ph.y,yc.z,0,-yc.x,xc.z,0,-xc.x,Ph.z,0,-Ph.x,-yc.y,yc.x,0,-xc.y,xc.x,0,-Ph.y,Ph.x,0];return!g1(n,qu,Yu,$u,dA)||(n=[1,0,0,0,1,0,0,0,1],!g1(n,qu,Yu,$u,dA))?!1:(fA.crossVectors(yc,xc),n=[fA.x,fA.y,fA.z],g1(n,qu,Yu,$u,dA))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Aa).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Aa).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(xl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};const xl=[new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt],Aa=new Mt,uA=new Af,qu=new Mt,Yu=new Mt,$u=new Mt,yc=new Mt,xc=new Mt,Ph=new Mt,cp=new Mt,dA=new Mt,fA=new Mt,Dh=new Mt;function g1(s,e,n,i,o){for(let a=0,c=s.length-3;a<=c;a+=3){Dh.fromArray(s,a);const u=o.x*Math.abs(Dh.x)+o.y*Math.abs(Dh.y)+o.z*Math.abs(Dh.z),h=e.dot(Dh),d=n.dot(Dh),f=i.dot(Dh);if(Math.max(-Math.max(h,d,f),Math.min(h,d,f))>u)return!1}return!0}const nk=new Af,hp=new Mt,A1=new Mt;let vf=class{constructor(e=new Mt,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):nk.setFromPoints(e).getCenter(i);let o=0;for(let a=0,c=e.length;a<c;a++)o=Math.max(o,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;hp.subVectors(e,this.center);const n=hp.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),o=(i-this.radius)*.5;this.center.addScaledVector(hp,o/i),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(A1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(hp.copy(e.center).add(A1)),this.expandByPoint(hp.copy(e.center).sub(A1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const El=new Mt,v1=new Mt,pA=new Mt,Ec=new Mt,y1=new Mt,mA=new Mt,x1=new Mt;let I_=class{constructor(e=new Mt,n=new Mt(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,El)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=El.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(El.copy(this.origin).addScaledVector(this.direction,n),El.distanceToSquared(e))}distanceSqToSegment(e,n,i,o){v1.copy(e).add(n).multiplyScalar(.5),pA.copy(n).sub(e).normalize(),Ec.copy(this.origin).sub(v1);const a=e.distanceTo(n)*.5,c=-this.direction.dot(pA),u=Ec.dot(this.direction),h=-Ec.dot(pA),d=Ec.lengthSq(),f=Math.abs(1-c*c);let p,A,g,v;if(f>0)if(p=c*h-u,A=c*u-h,v=a*f,p>=0)if(A>=-v)if(A<=v){const b=1/f;p*=b,A*=b,g=p*(p+c*A+2*u)+A*(c*p+A+2*h)+d}else A=a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;else A=-a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;else A<=-v?(p=Math.max(0,-(-c*a+u)),A=p>0?-a:Math.min(Math.max(-a,-h),a),g=-p*p+A*(A+2*h)+d):A<=v?(p=0,A=Math.min(Math.max(-a,-h),a),g=A*(A+2*h)+d):(p=Math.max(0,-(c*a+u)),A=p>0?a:Math.min(Math.max(-a,-h),a),g=-p*p+A*(A+2*h)+d);else A=c>0?-a:a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;return i&&i.copy(this.origin).addScaledVector(this.direction,p),o&&o.copy(v1).addScaledVector(pA,A),g}intersectSphere(e,n){El.subVectors(e.center,this.origin);const i=El.dot(this.direction),o=El.dot(El)-i*i,a=e.radius*e.radius;if(o>a)return null;const c=Math.sqrt(a-o),u=i-c,h=i+c;return h<0?null:u<0?this.at(h,n):this.at(u,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,o,a,c,u,h;const d=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,A=this.origin;return d>=0?(i=(e.min.x-A.x)*d,o=(e.max.x-A.x)*d):(i=(e.max.x-A.x)*d,o=(e.min.x-A.x)*d),f>=0?(a=(e.min.y-A.y)*f,c=(e.max.y-A.y)*f):(a=(e.max.y-A.y)*f,c=(e.min.y-A.y)*f),i>c||a>o||((a>i||isNaN(i))&&(i=a),(c<o||isNaN(o))&&(o=c),p>=0?(u=(e.min.z-A.z)*p,h=(e.max.z-A.z)*p):(u=(e.max.z-A.z)*p,h=(e.min.z-A.z)*p),i>h||u>o)||((u>i||i!==i)&&(i=u),(h<o||o!==o)&&(o=h),o<0)?null:this.at(i>=0?i:o,n)}intersectsBox(e){return this.intersectBox(e,El)!==null}intersectTriangle(e,n,i,o,a){y1.subVectors(n,e),mA.subVectors(i,e),x1.crossVectors(y1,mA);let c=this.direction.dot(x1),u;if(c>0){if(o)return null;u=1}else if(c<0)u=-1,c=-c;else return null;Ec.subVectors(this.origin,e);const h=u*this.direction.dot(mA.crossVectors(Ec,mA));if(h<0)return null;const d=u*this.direction.dot(y1.cross(Ec));if(d<0||h+d>c)return null;const f=-u*Ec.dot(x1);return f<0?null:this.at(f/c,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ii=class _b{constructor(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x){_b.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x)}set(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x){const E=this.elements;return E[0]=e,E[4]=n,E[8]=i,E[12]=o,E[1]=a,E[5]=c,E[9]=u,E[13]=h,E[2]=d,E[6]=f,E[10]=p,E[14]=A,E[3]=g,E[7]=v,E[11]=b,E[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new _b().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,o=1/Ju.setFromMatrixColumn(e,0).length(),a=1/Ju.setFromMatrixColumn(e,1).length(),c=1/Ju.setFromMatrixColumn(e,2).length();return n[0]=i[0]*o,n[1]=i[1]*o,n[2]=i[2]*o,n[3]=0,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[7]=0,n[8]=i[8]*c,n[9]=i[9]*c,n[10]=i[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,o=e.y,a=e.z,c=Math.cos(i),u=Math.sin(i),h=Math.cos(o),d=Math.sin(o),f=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){const A=c*f,g=c*p,v=u*f,b=u*p;n[0]=h*f,n[4]=-h*p,n[8]=d,n[1]=g+v*d,n[5]=A-b*d,n[9]=-u*h,n[2]=b-A*d,n[6]=v+g*d,n[10]=c*h}else if(e.order==="YXZ"){const A=h*f,g=h*p,v=d*f,b=d*p;n[0]=A+b*u,n[4]=v*u-g,n[8]=c*d,n[1]=c*p,n[5]=c*f,n[9]=-u,n[2]=g*u-v,n[6]=b+A*u,n[10]=c*h}else if(e.order==="ZXY"){const A=h*f,g=h*p,v=d*f,b=d*p;n[0]=A-b*u,n[4]=-c*p,n[8]=v+g*u,n[1]=g+v*u,n[5]=c*f,n[9]=b-A*u,n[2]=-c*d,n[6]=u,n[10]=c*h}else if(e.order==="ZYX"){const A=c*f,g=c*p,v=u*f,b=u*p;n[0]=h*f,n[4]=v*d-g,n[8]=A*d+b,n[1]=h*p,n[5]=b*d+A,n[9]=g*d-v,n[2]=-d,n[6]=u*h,n[10]=c*h}else if(e.order==="YZX"){const A=c*h,g=c*d,v=u*h,b=u*d;n[0]=h*f,n[4]=b-A*p,n[8]=v*p+g,n[1]=p,n[5]=c*f,n[9]=-u*f,n[2]=-d*f,n[6]=g*p+v,n[10]=A-b*p}else if(e.order==="XZY"){const A=c*h,g=c*d,v=u*h,b=u*d;n[0]=h*f,n[4]=-p,n[8]=d*f,n[1]=A*p+b,n[5]=c*f,n[9]=g*p-v,n[2]=v*p-g,n[6]=u*f,n[10]=b*p+A}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ik,e,rk)}lookAt(e,n,i){const o=this.elements;return ko.subVectors(e,n),ko.lengthSq()===0&&(ko.z=1),ko.normalize(),bc.crossVectors(i,ko),bc.lengthSq()===0&&(Math.abs(i.z)===1?ko.x+=1e-4:ko.z+=1e-4,ko.normalize(),bc.crossVectors(i,ko)),bc.normalize(),gA.crossVectors(ko,bc),o[0]=bc.x,o[4]=gA.x,o[8]=ko.x,o[1]=bc.y,o[5]=gA.y,o[9]=ko.y,o[2]=bc.z,o[6]=gA.z,o[10]=ko.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,o=n.elements,a=this.elements,c=i[0],u=i[4],h=i[8],d=i[12],f=i[1],p=i[5],A=i[9],g=i[13],v=i[2],b=i[6],x=i[10],E=i[14],S=i[3],M=i[7],C=i[11],T=i[15],L=o[0],B=o[4],F=o[8],D=o[12],P=o[1],U=o[5],K=o[9],J=o[13],z=o[2],j=o[6],G=o[10],H=o[14],te=o[3],Z=o[7],ee=o[11],oe=o[15];return a[0]=c*L+u*P+h*z+d*te,a[4]=c*B+u*U+h*j+d*Z,a[8]=c*F+u*K+h*G+d*ee,a[12]=c*D+u*J+h*H+d*oe,a[1]=f*L+p*P+A*z+g*te,a[5]=f*B+p*U+A*j+g*Z,a[9]=f*F+p*K+A*G+g*ee,a[13]=f*D+p*J+A*H+g*oe,a[2]=v*L+b*P+x*z+E*te,a[6]=v*B+b*U+x*j+E*Z,a[10]=v*F+b*K+x*G+E*ee,a[14]=v*D+b*J+x*H+E*oe,a[3]=S*L+M*P+C*z+T*te,a[7]=S*B+M*U+C*j+T*Z,a[11]=S*F+M*K+C*G+T*ee,a[15]=S*D+M*J+C*H+T*oe,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],o=e[8],a=e[12],c=e[1],u=e[5],h=e[9],d=e[13],f=e[2],p=e[6],A=e[10],g=e[14],v=e[3],b=e[7],x=e[11],E=e[15];return v*(+a*h*p-o*d*p-a*u*A+i*d*A+o*u*g-i*h*g)+b*(+n*h*g-n*d*A+a*c*A-o*c*g+o*d*f-a*h*f)+x*(+n*d*p-n*u*g-a*c*p+i*c*g+a*u*f-i*d*f)+E*(-o*u*f-n*h*p+n*u*A+o*c*p-i*c*A+i*h*f)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=n,o[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8],p=e[9],A=e[10],g=e[11],v=e[12],b=e[13],x=e[14],E=e[15],S=p*x*d-b*A*d+b*h*g-u*x*g-p*h*E+u*A*E,M=v*A*d-f*x*d-v*h*g+c*x*g+f*h*E-c*A*E,C=f*b*d-v*p*d+v*u*g-c*b*g-f*u*E+c*p*E,T=v*p*h-f*b*h-v*u*A+c*b*A+f*u*x-c*p*x,L=n*S+i*M+o*C+a*T;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const B=1/L;return e[0]=S*B,e[1]=(b*A*a-p*x*a-b*o*g+i*x*g+p*o*E-i*A*E)*B,e[2]=(u*x*a-b*h*a+b*o*d-i*x*d-u*o*E+i*h*E)*B,e[3]=(p*h*a-u*A*a-p*o*d+i*A*d+u*o*g-i*h*g)*B,e[4]=M*B,e[5]=(f*x*a-v*A*a+v*o*g-n*x*g-f*o*E+n*A*E)*B,e[6]=(v*h*a-c*x*a-v*o*d+n*x*d+c*o*E-n*h*E)*B,e[7]=(c*A*a-f*h*a+f*o*d-n*A*d-c*o*g+n*h*g)*B,e[8]=C*B,e[9]=(v*p*a-f*b*a-v*i*g+n*b*g+f*i*E-n*p*E)*B,e[10]=(c*b*a-v*u*a+v*i*d-n*b*d-c*i*E+n*u*E)*B,e[11]=(f*u*a-c*p*a-f*i*d+n*p*d+c*i*g-n*u*g)*B,e[12]=T*B,e[13]=(f*b*o-v*p*o+v*i*A-n*b*A-f*i*x+n*p*x)*B,e[14]=(v*u*o-c*b*o-v*i*h+n*b*h+c*i*x-n*u*x)*B,e[15]=(c*p*o-f*u*o+f*i*h-n*p*h-c*i*A+n*u*A)*B,this}scale(e){const n=this.elements,i=e.x,o=e.y,a=e.z;return n[0]*=i,n[4]*=o,n[8]*=a,n[1]*=i,n[5]*=o,n[9]*=a,n[2]*=i,n[6]*=o,n[10]*=a,n[3]*=i,n[7]*=o,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,o))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),o=Math.sin(n),a=1-i,c=e.x,u=e.y,h=e.z,d=a*c,f=a*u;return this.set(d*c+i,d*u-o*h,d*h+o*u,0,d*u+o*h,f*u+i,f*h-o*c,0,d*h-o*u,f*h+o*c,a*h*h+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,o,a,c){return this.set(1,i,a,0,e,1,c,0,n,o,1,0,0,0,0,1),this}compose(e,n,i){const o=this.elements,a=n._x,c=n._y,u=n._z,h=n._w,d=a+a,f=c+c,p=u+u,A=a*d,g=a*f,v=a*p,b=c*f,x=c*p,E=u*p,S=h*d,M=h*f,C=h*p,T=i.x,L=i.y,B=i.z;return o[0]=(1-(b+E))*T,o[1]=(g+C)*T,o[2]=(v-M)*T,o[3]=0,o[4]=(g-C)*L,o[5]=(1-(A+E))*L,o[6]=(x+S)*L,o[7]=0,o[8]=(v+M)*B,o[9]=(x-S)*B,o[10]=(1-(A+b))*B,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,n,i){const o=this.elements;let a=Ju.set(o[0],o[1],o[2]).length();const c=Ju.set(o[4],o[5],o[6]).length(),u=Ju.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),e.x=o[12],e.y=o[13],e.z=o[14],va.copy(this);const d=1/a,f=1/c,p=1/u;return va.elements[0]*=d,va.elements[1]*=d,va.elements[2]*=d,va.elements[4]*=f,va.elements[5]*=f,va.elements[6]*=f,va.elements[8]*=p,va.elements[9]*=p,va.elements[10]*=p,n.setFromRotationMatrix(va),i.x=a,i.y=c,i.z=u,this}makePerspective(e,n,i,o,a,c,u=Yh){const h=this.elements,d=2*a/(n-e),f=2*a/(i-o),p=(n+e)/(n-e),A=(i+o)/(i-o);let g,v;if(u===Yh)g=-(c+a)/(c-a),v=-2*c*a/(c-a);else if(u===Eb)g=-c/(c-a),v=-c*a/(c-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return h[0]=d,h[4]=0,h[8]=p,h[12]=0,h[1]=0,h[5]=f,h[9]=A,h[13]=0,h[2]=0,h[6]=0,h[10]=g,h[14]=v,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,n,i,o,a,c,u=Yh){const h=this.elements,d=1/(n-e),f=1/(i-o),p=1/(c-a),A=(n+e)*d,g=(i+o)*f;let v,b;if(u===Yh)v=(c+a)*p,b=-2*p;else if(u===Eb)v=a*p,b=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return h[0]=2*d,h[4]=0,h[8]=0,h[12]=-A,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-g,h[2]=0,h[6]=0,h[10]=b,h[14]=-v,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let o=0;o<16;o++)if(n[o]!==i[o])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}};const Ju=new Mt,va=new Ii,ik=new Mt(0,0,0),rk=new Mt(1,1,1),bc=new Mt,gA=new Mt,ko=new Mt,kC=new Ii,zC=new So;let ra=class mI{constructor(e=0,n=0,i=0,o=mI.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,o=this._order){return this._x=e,this._y=n,this._z=i,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const o=e.elements,a=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],A=o[6],g=o[10];switch(n){case"XYZ":this._y=Math.asin(Ns(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,g),this._z=Math.atan2(-c,a)):(this._x=Math.atan2(A,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Ns(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,g),this._z=Math.atan2(h,d)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ns(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-p,g),this._z=Math.atan2(-c,d)):(this._y=0,this._z=Math.atan2(h,a));break;case"ZYX":this._y=Math.asin(-Ns(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(A,g),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-c,d));break;case"YZX":this._z=Math.asin(Ns(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(u,g));break;case"XZY":this._z=Math.asin(-Ns(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(A,d),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-f,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return kC.makeRotationFromQuaternion(e),this.setFromRotationMatrix(kC,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return zC.setFromEuler(this),this.setFromQuaternion(zC,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};ra.DEFAULT_ORDER="XYZ";let sk=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},ok=0;const GC=new Mt,Zu=new So,bl=new Ii,AA=new Mt,up=new Mt,ak=new Mt,lk=new So,VC=new Mt(1,0,0),HC=new Mt(0,1,0),jC=new Mt(0,0,1),ck={type:"added"},hk={type:"removed"};let Us=class q0 extends Fv{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ok++}),this.uuid=Jc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=q0.DEFAULT_UP.clone();const e=new Mt,n=new ra,i=new So,o=new Mt(1,1,1);function a(){i.setFromEuler(n,!1)}function c(){n.setFromQuaternion(i,void 0,!1)}n._onChange(a),i._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Ii},normalMatrix:{value:new Zc}}),this.matrix=new Ii,this.matrixWorld=new Ii,this.matrixAutoUpdate=q0.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=q0.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new sk,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Zu.setFromAxisAngle(e,n),this.quaternion.multiply(Zu),this}rotateOnWorldAxis(e,n){return Zu.setFromAxisAngle(e,n),this.quaternion.premultiply(Zu),this}rotateX(e){return this.rotateOnAxis(VC,e)}rotateY(e){return this.rotateOnAxis(HC,e)}rotateZ(e){return this.rotateOnAxis(jC,e)}translateOnAxis(e,n){return GC.copy(e).applyQuaternion(this.quaternion),this.position.add(GC.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(VC,e)}translateY(e){return this.translateOnAxis(HC,e)}translateZ(e){return this.translateOnAxis(jC,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(bl.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?AA.copy(e):AA.set(e,n,i);const o=this.parent;this.updateWorldMatrix(!0,!1),up.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bl.lookAt(up,AA,this.up):bl.lookAt(AA,up,this.up),this.quaternion.setFromRotationMatrix(bl),o&&(bl.extractRotation(o.matrixWorld),Zu.setFromRotationMatrix(bl),this.quaternion.premultiply(Zu.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ck)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(hk)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),bl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),bl.multiply(e.parent.matrixWorld)),e.applyMatrix4(bl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,o=this.children.length;i<o;i++){const c=this.children[i].getObjectByProperty(e,n);if(c!==void 0)return c}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const o=this.children;for(let a=0,c=o.length;a<c;a++)o[a].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(up,e,ak),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(up,lk,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,o=n.length;i<o;i++){const a=n[i];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const o=this.children;for(let a=0,c=o.length;a<c;a++){const u=o[a];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.visibility=this._visibility,o.active=this._active,o.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),o.maxGeometryCount=this._maxGeometryCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.geometryCount=this._geometryCount,o.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(o.boundingSphere={center:o.boundingSphere.center.toArray(),radius:o.boundingSphere.radius}),this.boundingBox!==null&&(o.boundingBox={min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}));function a(u,h){return u[h.uuid]===void 0&&(u[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=a(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const h=u.shapes;if(Array.isArray(h))for(let d=0,f=h.length;d<f;d++){const p=h[d];a(e.shapes,p)}else a(e.shapes,h)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let h=0,d=this.material.length;h<d;h++)u.push(a(e.materials,this.material[h]));o.material=u}else o.material=a(e.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++){const h=this.animations[u];o.animations.push(a(e.animations,h))}}if(n){const u=c(e.geometries),h=c(e.materials),d=c(e.textures),f=c(e.images),p=c(e.shapes),A=c(e.skeletons),g=c(e.animations),v=c(e.nodes);u.length>0&&(i.geometries=u),h.length>0&&(i.materials=h),d.length>0&&(i.textures=d),f.length>0&&(i.images=f),p.length>0&&(i.shapes=p),A.length>0&&(i.skeletons=A),g.length>0&&(i.animations=g),v.length>0&&(i.nodes=v)}return i.object=o,i;function c(u){const h=[];for(const d in u){const f=u[d];delete f.metadata,h.push(f)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const o=e.children[i];this.add(o.clone())}return this}};Us.DEFAULT_UP=new Mt(0,1,0);Us.DEFAULT_MATRIX_AUTO_UPDATE=!0;Us.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ya=new Mt,_l=new Mt,E1=new Mt,wl=new Mt,ed=new Mt,td=new Mt,WC=new Mt,b1=new Mt,_1=new Mt,w1=new Mt;let vA=!1,yA=class jh{constructor(e=new Mt,n=new Mt,i=new Mt){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,o){o.subVectors(i,n),ya.subVectors(e,n),o.cross(ya);const a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}static getBarycoord(e,n,i,o,a){ya.subVectors(o,n),_l.subVectors(i,n),E1.subVectors(e,n);const c=ya.dot(ya),u=ya.dot(_l),h=ya.dot(E1),d=_l.dot(_l),f=_l.dot(E1),p=c*d-u*u;if(p===0)return a.set(-2,-1,-1);const A=1/p,g=(d*h-u*f)*A,v=(c*f-u*h)*A;return a.set(1-g-v,v,g)}static containsPoint(e,n,i,o){return this.getBarycoord(e,n,i,o,wl),wl.x>=0&&wl.y>=0&&wl.x+wl.y<=1}static getUV(e,n,i,o,a,c,u,h){return vA===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),vA=!0),this.getInterpolation(e,n,i,o,a,c,u,h)}static getInterpolation(e,n,i,o,a,c,u,h){return this.getBarycoord(e,n,i,o,wl),h.setScalar(0),h.addScaledVector(a,wl.x),h.addScaledVector(c,wl.y),h.addScaledVector(u,wl.z),h}static isFrontFacing(e,n,i,o){return ya.subVectors(i,n),_l.subVectors(e,n),ya.cross(_l).dot(o)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,o){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,n,i,o){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ya.subVectors(this.c,this.b),_l.subVectors(this.a,this.b),ya.cross(_l).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return jh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return jh.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,o,a){return vA===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),vA=!0),jh.getInterpolation(e,this.a,this.b,this.c,n,i,o,a)}getInterpolation(e,n,i,o,a){return jh.getInterpolation(e,this.a,this.b,this.c,n,i,o,a)}containsPoint(e){return jh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return jh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,o=this.b,a=this.c;let c,u;ed.subVectors(o,i),td.subVectors(a,i),b1.subVectors(e,i);const h=ed.dot(b1),d=td.dot(b1);if(h<=0&&d<=0)return n.copy(i);_1.subVectors(e,o);const f=ed.dot(_1),p=td.dot(_1);if(f>=0&&p<=f)return n.copy(o);const A=h*p-f*d;if(A<=0&&h>=0&&f<=0)return c=h/(h-f),n.copy(i).addScaledVector(ed,c);w1.subVectors(e,a);const g=ed.dot(w1),v=td.dot(w1);if(v>=0&&g<=v)return n.copy(a);const b=g*d-h*v;if(b<=0&&d>=0&&v<=0)return u=d/(d-v),n.copy(i).addScaledVector(td,u);const x=f*v-g*p;if(x<=0&&p-f>=0&&g-v>=0)return WC.subVectors(a,o),u=(p-f)/(p-f+(g-v)),n.copy(o).addScaledVector(WC,u);const E=1/(x+b+A);return c=b*E,u=A*E,n.copy(i).addScaledVector(ed,c).addScaledVector(td,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const gI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_c={h:0,s:0,l:0},xA={h:0,s:0,l:0};function M1(s,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?s+(e-s)*6*n:n<1/2?e:n<2/3?s+(e-s)*6*(2/3-n):s}let as=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const o=e;o&&o.isColor?this.copy(o):typeof o=="number"?this.setHex(o):typeof o=="string"&&this.setStyle(o)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=po){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ga.toWorkingColorSpace(this,n),this}setRGB(e,n,i,o=ga.workingColorSpace){return this.r=e,this.g=n,this.b=i,ga.toWorkingColorSpace(this,o),this}setHSL(e,n,i,o=ga.workingColorSpace){if(e=R_(e,1),n=Ns(n,0,1),i=Ns(i,0,1),n===0)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+n):i+n-i*n,c=2*i-a;this.r=M1(c,a,e+1/3),this.g=M1(c,a,e),this.b=M1(c,a,e-1/3)}return ga.toWorkingColorSpace(this,o),this}setStyle(e,n=po){function i(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const c=o[1],u=o[2];switch(c){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=o[1],c=a.length;if(c===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(c===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=po){const i=gI[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=nf(e.r),this.g=nf(e.g),this.b=nf(e.b),this}copyLinearToSRGB(e){return this.r=f1(e.r),this.g=f1(e.g),this.b=f1(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=po){return ga.fromWorkingColorSpace(Qs.copy(this),e),Math.round(Ns(Qs.r*255,0,255))*65536+Math.round(Ns(Qs.g*255,0,255))*256+Math.round(Ns(Qs.b*255,0,255))}getHexString(e=po){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=ga.workingColorSpace){ga.fromWorkingColorSpace(Qs.copy(this),n);const i=Qs.r,o=Qs.g,a=Qs.b,c=Math.max(i,o,a),u=Math.min(i,o,a);let h,d;const f=(u+c)/2;if(u===c)h=0,d=0;else{const p=c-u;switch(d=f<=.5?p/(c+u):p/(2-c-u),c){case i:h=(o-a)/p+(o<a?6:0);break;case o:h=(a-i)/p+2;break;case a:h=(i-o)/p+4;break}h/=6}return e.h=h,e.s=d,e.l=f,e}getRGB(e,n=ga.workingColorSpace){return ga.fromWorkingColorSpace(Qs.copy(this),n),e.r=Qs.r,e.g=Qs.g,e.b=Qs.b,e}getStyle(e=po){ga.fromWorkingColorSpace(Qs.copy(this),e);const n=Qs.r,i=Qs.g,o=Qs.b;return e!==po?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(o*255)})`}offsetHSL(e,n,i){return this.getHSL(_c),this.setHSL(_c.h+e,_c.s+n,_c.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(_c),e.getHSL(xA);const i=$p(_c.h,xA.h,n),o=$p(_c.s,xA.s,n),a=$p(_c.l,xA.l,n);return this.setHSL(i,o,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,o=this.b,a=e.elements;return this.r=a[0]*n+a[3]*i+a[6]*o,this.g=a[1]*n+a[4]*i+a[7]*o,this.b=a[2]*n+a[5]*i+a[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Qs=new as;as.NAMES=gI;let uk=0,Nv=class extends Fv{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:uk++}),this.uuid=Jc(),this.name="",this.type="Material",this.blending=vC,this.side=yb,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xC,this.blendDst=EC,this.blendEquation=yC,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new as(0,0,0),this.blendAlpha=0,this.depthFunc=bC,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=LC,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Xu,this.stencilZFail=Xu,this.stencilZPass=Xu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const o=this[n];if(o===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}o&&o.isColor?o.set(i):o&&o.isVector3&&i&&i.isVector3?o.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==vC&&(i.blending=this.blending),this.side!==yb&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==xC&&(i.blendSrc=this.blendSrc),this.blendDst!==EC&&(i.blendDst=this.blendDst),this.blendEquation!==yC&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==bC&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==LC&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Xu&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Xu&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Xu&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function o(a){const c=[];for(const u in a){const h=a[u];delete h.metadata,c.push(h)}return c}if(n){const a=o(e.textures),c=o(e.images);a.length>0&&(i.textures=a),c.length>0&&(i.images=c)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const o=n.length;i=new Array(o);for(let a=0;a!==o;++a)i[a]=n[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},dk=class extends Nv{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new as(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=S_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const rs=new Mt,EA=new gs;let rf=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=PC,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=aI,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn('THREE.BufferAttribute: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let o=0,a=this.itemSize;o<a;o++)this.array[e+o]=n.array[i+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)EA.fromBufferAttribute(this,n),EA.applyMatrix3(e),this.setXY(n,EA.x,EA.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)rs.fromBufferAttribute(this,n),rs.applyMatrix3(e),this.setXYZ(n,rs.x,rs.y,rs.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)rs.fromBufferAttribute(this,n),rs.applyMatrix4(e),this.setXYZ(n,rs.x,rs.y,rs.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)rs.fromBufferAttribute(this,n),rs.applyNormalMatrix(e),this.setXYZ(n,rs.x,rs.y,rs.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)rs.fromBufferAttribute(this,n),rs.transformDirection(e),this.setXYZ(n,rs.x,rs.y,rs.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Xd(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=lo(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Xd(n,this.array)),n}setX(e,n){return this.normalized&&(n=lo(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Xd(n,this.array)),n}setY(e,n){return this.normalized&&(n=lo(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Xd(n,this.array)),n}setZ(e,n){return this.normalized&&(n=lo(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Xd(n,this.array)),n}setW(e,n){return this.normalized&&(n=lo(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=lo(n,this.array),i=lo(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,o){return e*=this.itemSize,this.normalized&&(n=lo(n,this.array),i=lo(i,this.array),o=lo(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=o,this}setXYZW(e,n,i,o,a){return e*=this.itemSize,this.normalized&&(n=lo(n,this.array),i=lo(i,this.array),o=lo(o,this.array),a=lo(a,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=o,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==PC&&(e.usage=this.usage),e}},AI=class extends rf{constructor(e,n,i){super(new Uint16Array(e),n,i)}},fk=class extends rf{constructor(e,n,i){super(new Uint32Array(e),n,i)}},zc=class extends rf{constructor(e,n,i){super(new Float32Array(e),n,i)}},pk=0;const ea=new Ii,C1=new Us,nd=new Mt,zo=new Af,dp=new Af,Ss=new Mt;let Jp=class vI extends Fv{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:pk++}),this.uuid=Jc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(YU(e)?fk:AI)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const a=new Zc().getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}const o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ea.makeRotationFromQuaternion(e),this.applyMatrix4(ea),this}rotateX(e){return ea.makeRotationX(e),this.applyMatrix4(ea),this}rotateY(e){return ea.makeRotationY(e),this.applyMatrix4(ea),this}rotateZ(e){return ea.makeRotationZ(e),this.applyMatrix4(ea),this}translate(e,n,i){return ea.makeTranslation(e,n,i),this.applyMatrix4(ea),this}scale(e,n,i){return ea.makeScale(e,n,i),this.applyMatrix4(ea),this}lookAt(e){return C1.lookAt(e),C1.updateMatrix(),this.applyMatrix4(C1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(nd).negate(),this.translate(nd.x,nd.y,nd.z),this}setFromPoints(e){const n=[];for(let i=0,o=e.length;i<o;i++){const a=e[i];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new zc(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Af);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Mt(-1/0,-1/0,-1/0),new Mt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,o=n.length;i<o;i++){const a=n[i];zo.setFromBufferAttribute(a),this.morphTargetsRelative?(Ss.addVectors(this.boundingBox.min,zo.min),this.boundingBox.expandByPoint(Ss),Ss.addVectors(this.boundingBox.max,zo.max),this.boundingBox.expandByPoint(Ss)):(this.boundingBox.expandByPoint(zo.min),this.boundingBox.expandByPoint(zo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new vf);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Mt,1/0);return}if(e){const i=this.boundingSphere.center;if(zo.setFromBufferAttribute(e),n)for(let a=0,c=n.length;a<c;a++){const u=n[a];dp.setFromBufferAttribute(u),this.morphTargetsRelative?(Ss.addVectors(zo.min,dp.min),zo.expandByPoint(Ss),Ss.addVectors(zo.max,dp.max),zo.expandByPoint(Ss)):(zo.expandByPoint(dp.min),zo.expandByPoint(dp.max))}zo.getCenter(i);let o=0;for(let a=0,c=e.count;a<c;a++)Ss.fromBufferAttribute(e,a),o=Math.max(o,i.distanceToSquared(Ss));if(n)for(let a=0,c=n.length;a<c;a++){const u=n[a],h=this.morphTargetsRelative;for(let d=0,f=u.count;d<f;d++)Ss.fromBufferAttribute(u,d),h&&(nd.fromBufferAttribute(e,d),Ss.add(nd)),o=Math.max(o,i.distanceToSquared(Ss))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,o=n.position.array,a=n.normal.array,c=n.uv.array,u=o.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new rf(new Float32Array(4*u),4));const h=this.getAttribute("tangent").array,d=[],f=[];for(let P=0;P<u;P++)d[P]=new Mt,f[P]=new Mt;const p=new Mt,A=new Mt,g=new Mt,v=new gs,b=new gs,x=new gs,E=new Mt,S=new Mt;function M(P,U,K){p.fromArray(o,P*3),A.fromArray(o,U*3),g.fromArray(o,K*3),v.fromArray(c,P*2),b.fromArray(c,U*2),x.fromArray(c,K*2),A.sub(p),g.sub(p),b.sub(v),x.sub(v);const J=1/(b.x*x.y-x.x*b.y);isFinite(J)&&(E.copy(A).multiplyScalar(x.y).addScaledVector(g,-b.y).multiplyScalar(J),S.copy(g).multiplyScalar(b.x).addScaledVector(A,-x.x).multiplyScalar(J),d[P].add(E),d[U].add(E),d[K].add(E),f[P].add(S),f[U].add(S),f[K].add(S))}let C=this.groups;C.length===0&&(C=[{start:0,count:i.length}]);for(let P=0,U=C.length;P<U;++P){const K=C[P],J=K.start,z=K.count;for(let j=J,G=J+z;j<G;j+=3)M(i[j+0],i[j+1],i[j+2])}const T=new Mt,L=new Mt,B=new Mt,F=new Mt;function D(P){B.fromArray(a,P*3),F.copy(B);const U=d[P];T.copy(U),T.sub(B.multiplyScalar(B.dot(U))).normalize(),L.crossVectors(F,U);const J=L.dot(f[P])<0?-1:1;h[P*4]=T.x,h[P*4+1]=T.y,h[P*4+2]=T.z,h[P*4+3]=J}for(let P=0,U=C.length;P<U;++P){const K=C[P],J=K.start,z=K.count;for(let j=J,G=J+z;j<G;j+=3)D(i[j+0]),D(i[j+1]),D(i[j+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new rf(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let A=0,g=i.count;A<g;A++)i.setXYZ(A,0,0,0);const o=new Mt,a=new Mt,c=new Mt,u=new Mt,h=new Mt,d=new Mt,f=new Mt,p=new Mt;if(e)for(let A=0,g=e.count;A<g;A+=3){const v=e.getX(A+0),b=e.getX(A+1),x=e.getX(A+2);o.fromBufferAttribute(n,v),a.fromBufferAttribute(n,b),c.fromBufferAttribute(n,x),f.subVectors(c,a),p.subVectors(o,a),f.cross(p),u.fromBufferAttribute(i,v),h.fromBufferAttribute(i,b),d.fromBufferAttribute(i,x),u.add(f),h.add(f),d.add(f),i.setXYZ(v,u.x,u.y,u.z),i.setXYZ(b,h.x,h.y,h.z),i.setXYZ(x,d.x,d.y,d.z)}else for(let A=0,g=n.count;A<g;A+=3)o.fromBufferAttribute(n,A+0),a.fromBufferAttribute(n,A+1),c.fromBufferAttribute(n,A+2),f.subVectors(c,a),p.subVectors(o,a),f.cross(p),i.setXYZ(A+0,f.x,f.y,f.z),i.setXYZ(A+1,f.x,f.y,f.z),i.setXYZ(A+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Ss.fromBufferAttribute(e,n),Ss.normalize(),e.setXYZ(n,Ss.x,Ss.y,Ss.z)}toNonIndexed(){function e(u,h){const d=u.array,f=u.itemSize,p=u.normalized,A=new d.constructor(h.length*f);let g=0,v=0;for(let b=0,x=h.length;b<x;b++){u.isInterleavedBufferAttribute?g=h[b]*u.data.stride+u.offset:g=h[b]*f;for(let E=0;E<f;E++)A[v++]=d[g++]}return new rf(A,f,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new vI,i=this.index.array,o=this.attributes;for(const u in o){const h=o[u],d=e(h,i);n.setAttribute(u,d)}const a=this.morphAttributes;for(const u in a){const h=[],d=a[u];for(let f=0,p=d.length;f<p;f++){const A=d[f],g=e(A,i);h.push(g)}n.morphAttributes[u]=h}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let u=0,h=c.length;u<h;u++){const d=c[u];n.addGroup(d.start,d.count,d.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const d in h)h[d]!==void 0&&(e[d]=h[d]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const h in i){const d=i[h];e.data.attributes[h]=d.toJSON(e.data)}const o={};let a=!1;for(const h in this.morphAttributes){const d=this.morphAttributes[h],f=[];for(let p=0,A=d.length;p<A;p++){const g=d[p];f.push(g.toJSON(e.data))}f.length>0&&(o[h]=f,a=!0)}a&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const o=e.attributes;for(const d in o){const f=o[d];this.setAttribute(d,f.clone(n))}const a=e.morphAttributes;for(const d in a){const f=[],p=a[d];for(let A=0,g=p.length;A<g;A++)f.push(p[A].clone(n));this.morphAttributes[d]=f}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let d=0,f=c.length;d<f;d++){const p=c[d];this.addGroup(p.start,p.count,p.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const QC=new Ii,Oh=new I_,bA=new vf,XC=new Mt,id=new Mt,rd=new Mt,sd=new Mt,S1=new Mt,_A=new Mt,wA=new gs,MA=new gs,CA=new gs,KC=new Mt,qC=new Mt,YC=new Mt,SA=new Mt,TA=new Mt;let yI=class extends Us{constructor(e=new Jp,n=new dk){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=o.length;a<c;a++){const u=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(e,n){const i=this.geometry,o=i.attributes.position,a=i.morphAttributes.position,c=i.morphTargetsRelative;n.fromBufferAttribute(o,e);const u=this.morphTargetInfluences;if(a&&u){_A.set(0,0,0);for(let h=0,d=a.length;h<d;h++){const f=u[h],p=a[h];f!==0&&(S1.fromBufferAttribute(p,e),c?_A.addScaledVector(S1,f):_A.addScaledVector(S1.sub(n),f))}n.add(_A)}return n}raycast(e,n){const i=this.geometry,o=this.material,a=this.matrixWorld;o!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),bA.copy(i.boundingSphere),bA.applyMatrix4(a),Oh.copy(e.ray).recast(e.near),!(bA.containsPoint(Oh.origin)===!1&&(Oh.intersectSphere(bA,XC)===null||Oh.origin.distanceToSquared(XC)>(e.far-e.near)**2))&&(QC.copy(a).invert(),Oh.copy(e.ray).applyMatrix4(QC),!(i.boundingBox!==null&&Oh.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Oh)))}_computeIntersections(e,n,i){let o;const a=this.geometry,c=this.material,u=a.index,h=a.attributes.position,d=a.attributes.uv,f=a.attributes.uv1,p=a.attributes.normal,A=a.groups,g=a.drawRange;if(u!==null)if(Array.isArray(c))for(let v=0,b=A.length;v<b;v++){const x=A[v],E=c[x.materialIndex],S=Math.max(x.start,g.start),M=Math.min(u.count,Math.min(x.start+x.count,g.start+g.count));for(let C=S,T=M;C<T;C+=3){const L=u.getX(C),B=u.getX(C+1),F=u.getX(C+2);o=RA(this,E,e,i,d,f,p,L,B,F),o&&(o.faceIndex=Math.floor(C/3),o.face.materialIndex=x.materialIndex,n.push(o))}}else{const v=Math.max(0,g.start),b=Math.min(u.count,g.start+g.count);for(let x=v,E=b;x<E;x+=3){const S=u.getX(x),M=u.getX(x+1),C=u.getX(x+2);o=RA(this,c,e,i,d,f,p,S,M,C),o&&(o.faceIndex=Math.floor(x/3),n.push(o))}}else if(h!==void 0)if(Array.isArray(c))for(let v=0,b=A.length;v<b;v++){const x=A[v],E=c[x.materialIndex],S=Math.max(x.start,g.start),M=Math.min(h.count,Math.min(x.start+x.count,g.start+g.count));for(let C=S,T=M;C<T;C+=3){const L=C,B=C+1,F=C+2;o=RA(this,E,e,i,d,f,p,L,B,F),o&&(o.faceIndex=Math.floor(C/3),o.face.materialIndex=x.materialIndex,n.push(o))}}else{const v=Math.max(0,g.start),b=Math.min(h.count,g.start+g.count);for(let x=v,E=b;x<E;x+=3){const S=x,M=x+1,C=x+2;o=RA(this,c,e,i,d,f,p,S,M,C),o&&(o.faceIndex=Math.floor(x/3),n.push(o))}}}};function mk(s,e,n,i,o,a,c,u){let h;if(e.side===bU?h=i.intersectTriangle(c,a,o,!0,u):h=i.intersectTriangle(o,a,c,e.side===yb,u),h===null)return null;TA.copy(u),TA.applyMatrix4(s.matrixWorld);const d=n.ray.origin.distanceTo(TA);return d<n.near||d>n.far?null:{distance:d,point:TA.clone(),object:s}}function RA(s,e,n,i,o,a,c,u,h,d){s.getVertexPosition(u,id),s.getVertexPosition(h,rd),s.getVertexPosition(d,sd);const f=mk(s,e,n,i,id,rd,sd,SA);if(f){o&&(wA.fromBufferAttribute(o,u),MA.fromBufferAttribute(o,h),CA.fromBufferAttribute(o,d),f.uv=yA.getInterpolation(SA,id,rd,sd,wA,MA,CA,new gs)),a&&(wA.fromBufferAttribute(a,u),MA.fromBufferAttribute(a,h),CA.fromBufferAttribute(a,d),f.uv1=yA.getInterpolation(SA,id,rd,sd,wA,MA,CA,new gs),f.uv2=f.uv1),c&&(KC.fromBufferAttribute(c,u),qC.fromBufferAttribute(c,h),YC.fromBufferAttribute(c,d),f.normal=yA.getInterpolation(SA,id,rd,sd,KC,qC,YC,new Mt),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const p={a:u,b:h,c:d,normal:new Mt,materialIndex:0};yA.getNormal(id,rd,sd,p.normal),f.face=p}return f}let xI=class extends Us{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ii,this.projectionMatrix=new Ii,this.projectionMatrixInverse=new Ii,this.coordinateSystem=Yh}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},B_=class extends xI{constructor(e=50,n=1,i=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=o,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=am*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Yp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return am*2*Math.atan(Math.tan(Yp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,i,o,a,c){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=o,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Yp*.5*this.fov)/this.zoom,i=2*n,o=this.aspect*i,a=-.5*o;const c=this.view;if(this.view!==null&&this.view.enabled){const h=c.fullWidth,d=c.fullHeight;a+=c.offsetX*o/h,n-=c.offsetY*i/d,o*=c.width/h,i*=c.height/d}const u=this.filmOffset;u!==0&&(a+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+o,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const T1=new Mt,gk=new Mt,Ak=new Zc;let od=class{constructor(e=new Mt(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,o){return this.normal.set(e,n,i),this.constant=o,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const o=T1.subVectors(i,n).cross(gk.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(T1),o=this.normal.dot(i);if(o===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/o;return a<0||a>1?null:n.copy(e.start).addScaledVector(i,a)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||Ak.getNormalMatrix(e),o=this.coplanarPoint(T1).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const Fh=new vf,IA=new Mt;let vk=class{constructor(e=new od,n=new od,i=new od,o=new od,a=new od,c=new od){this.planes=[e,n,i,o,a,c]}set(e,n,i,o,a,c){const u=this.planes;return u[0].copy(e),u[1].copy(n),u[2].copy(i),u[3].copy(o),u[4].copy(a),u[5].copy(c),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Yh){const i=this.planes,o=e.elements,a=o[0],c=o[1],u=o[2],h=o[3],d=o[4],f=o[5],p=o[6],A=o[7],g=o[8],v=o[9],b=o[10],x=o[11],E=o[12],S=o[13],M=o[14],C=o[15];if(i[0].setComponents(h-a,A-d,x-g,C-E).normalize(),i[1].setComponents(h+a,A+d,x+g,C+E).normalize(),i[2].setComponents(h+c,A+f,x+v,C+S).normalize(),i[3].setComponents(h-c,A-f,x-v,C-S).normalize(),i[4].setComponents(h-u,A-p,x-b,C-M).normalize(),n===Yh)i[5].setComponents(h+u,A+p,x+b,C+M).normalize();else if(n===Eb)i[5].setComponents(u,p,b,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Fh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Fh.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Fh)}intersectsSprite(e){return Fh.center.set(0,0,0),Fh.radius=.7071067811865476,Fh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Fh)}intersectsSphere(e){const n=this.planes,i=e.center,o=-e.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(i)<o)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const o=n[i];if(IA.x=o.normal.x>0?e.max.x:e.min.x,IA.y=o.normal.y>0?e.max.y:e.min.y,IA.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(IA)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},EI=class extends xI{constructor(e=-1,n=1,i=1,o=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=o,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,o,a,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=o,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let a=i-e,c=i+e,u=o+n,h=o-n;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=d*this.view.offsetX,c=a+d*this.view.width,u-=f*this.view.offsetY,h=u-f*this.view.height}this.projectionMatrix.makeOrthographic(a,c,u,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}},yk=class extends ql{constructor(e,n,i,o,a,c,u,h,d,f){if(f=f!==void 0?f:l1,f!==l1&&f!==MC)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&f===l1&&(i=TU),i===void 0&&f===MC&&(i=RU),super(null,o,a,c,u,h,f,i,d),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=u!==void 0?u:lv,this.minFilter=h!==void 0?h:lv,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}};const xk=new yk(1,1);xk.compareFunction=PU;let $C=class extends Us{constructor(){super(),this.isGroup=!0,this.type="Group"}};const JC=new Mt,ZC=new To,eS=new To,Ek=new Mt,tS=new Ii,BA=new Mt,R1=new vf,nS=new Ii,I1=new I_;class bk extends yI{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=_C,this.bindMatrix=new Ii,this.bindMatrixInverse=new Ii,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Af),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,BA),this.boundingBox.expandByPoint(BA)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new vf),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,BA),this.boundingSphere.expandByPoint(BA)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,o=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),R1.copy(this.boundingSphere),R1.applyMatrix4(o),e.ray.intersectsSphere(R1)!==!1&&(nS.copy(o).invert(),I1.copy(e.ray).applyMatrix4(nS),!(this.boundingBox!==null&&I1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,I1)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new To,n=this.geometry.attributes.skinWeight;for(let i=0,o=n.count;i<o;i++){e.fromBufferAttribute(n,i);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===_C?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===_U?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,o=this.geometry;ZC.fromBufferAttribute(o.attributes.skinIndex,e),eS.fromBufferAttribute(o.attributes.skinWeight,e),JC.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let a=0;a<4;a++){const c=eS.getComponent(a);if(c!==0){const u=ZC.getComponent(a);tS.multiplyMatrices(i.bones[u].matrixWorld,i.boneInverses[u]),n.addScaledVector(Ek.copy(JC).applyMatrix4(tS),c)}}return n.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,n){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,n)}}class wb extends Us{constructor(){super(),this.isBone=!0,this.type="Bone"}}class _k extends ql{constructor(e=null,n=1,i=1,o,a,c,u,h,d=lv,f=lv,p,A){super(null,c,u,h,d,f,o,a,p,A),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const iS=new Ii,wk=new Ii;class L_{constructor(e=[],n=[]){this.uuid=Jc(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,o=this.bones.length;i<o;i++)this.boneInverses.push(new Ii)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new Ii;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture;for(let a=0,c=e.length;a<c;a++){const u=e[a]?e[a].matrixWorld:wk;iS.multiplyMatrices(u,n[a]),iS.toArray(i,a*16)}o!==null&&(o.needsUpdate=!0)}clone(){return new L_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new _k(n,e,e,lI,aI);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const o=this.bones[n];if(o.name===e)return o}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,o=e.bones.length;i<o;i++){const a=e.bones[i];let c=n[a];c===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),c=new wb),this.bones.push(c),this.boneInverses.push(new Ii().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let o=0,a=n.length;o<a;o++){const c=n[o];e.bones.push(c.uuid);const u=i[o];e.boneInverses.push(u.toArray())}return e}}let bI=class extends Nv{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new as(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const rS=new Mt,sS=new Mt,oS=new Ii,B1=new I_,LA=new vf;let Mk=class extends Us{constructor(e=new Jp,n=new bI){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let o=1,a=n.count;o<a;o++)rS.fromBufferAttribute(n,o-1),sS.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=rS.distanceTo(sS);e.setAttribute("lineDistance",new zc(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,o=this.matrixWorld,a=e.params.Line.threshold,c=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),LA.copy(i.boundingSphere),LA.applyMatrix4(o),LA.radius+=a,e.ray.intersectsSphere(LA)===!1)return;oS.copy(o).invert(),B1.copy(e.ray).applyMatrix4(oS);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),h=u*u,d=new Mt,f=new Mt,p=new Mt,A=new Mt,g=this.isLineSegments?2:1,v=i.index,x=i.attributes.position;if(v!==null){const E=Math.max(0,c.start),S=Math.min(v.count,c.start+c.count);for(let M=E,C=S-1;M<C;M+=g){const T=v.getX(M),L=v.getX(M+1);if(d.fromBufferAttribute(x,T),f.fromBufferAttribute(x,L),B1.distanceSqToSegment(d,f,A,p)>h)continue;A.applyMatrix4(this.matrixWorld);const F=e.ray.origin.distanceTo(A);F<e.near||F>e.far||n.push({distance:F,point:p.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{const E=Math.max(0,c.start),S=Math.min(x.count,c.start+c.count);for(let M=E,C=S-1;M<C;M+=g){if(d.fromBufferAttribute(x,M),f.fromBufferAttribute(x,M+1),B1.distanceSqToSegment(d,f,A,p)>h)continue;A.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(A);L<e.near||L>e.far||n.push({distance:L,point:p.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=o.length;a<c;a++){const u=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}},Ck=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,o=this.getPoint(0),a=0;n.push(0);for(let c=1;c<=e;c++)i=this.getPoint(c/e),a+=i.distanceTo(o),n.push(a),o=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let o=0;const a=i.length;let c;n?c=n:c=e*i[a-1];let u=0,h=a-1,d;for(;u<=h;)if(o=Math.floor(u+(h-u)/2),d=i[o]-c,d<0)u=o+1;else if(d>0)h=o-1;else{h=o;break}if(o=h,i[o]===c)return o/(a-1);const f=i[o],A=i[o+1]-f,g=(c-f)/A;return(o+g)/(a-1)}getTangent(e,n){let o=e-1e-4,a=e+1e-4;o<0&&(o=0),a>1&&(a=1);const c=this.getPoint(o),u=this.getPoint(a),h=n||(c.isVector2?new gs:new Mt);return h.copy(u).sub(c).normalize(),h}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new Mt,o=[],a=[],c=[],u=new Mt,h=new Ii;for(let g=0;g<=e;g++){const v=g/e;o[g]=this.getTangentAt(v,new Mt)}a[0]=new Mt,c[0]=new Mt;let d=Number.MAX_VALUE;const f=Math.abs(o[0].x),p=Math.abs(o[0].y),A=Math.abs(o[0].z);f<=d&&(d=f,i.set(1,0,0)),p<=d&&(d=p,i.set(0,1,0)),A<=d&&i.set(0,0,1),u.crossVectors(o[0],i).normalize(),a[0].crossVectors(o[0],u),c[0].crossVectors(o[0],a[0]);for(let g=1;g<=e;g++){if(a[g]=a[g-1].clone(),c[g]=c[g-1].clone(),u.crossVectors(o[g-1],o[g]),u.length()>Number.EPSILON){u.normalize();const v=Math.acos(Ns(o[g-1].dot(o[g]),-1,1));a[g].applyMatrix4(h.makeRotationAxis(u,v))}c[g].crossVectors(o[g],a[g])}if(n===!0){let g=Math.acos(Ns(a[0].dot(a[e]),-1,1));g/=e,o[0].dot(u.crossVectors(a[0],a[e]))>0&&(g=-g);for(let v=1;v<=e;v++)a[v].applyMatrix4(h.makeRotationAxis(o[v],g*v)),c[v].crossVectors(o[v],a[v])}return{tangents:o,normals:a,binormals:c}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};const Sk={triangulate:function(s,e,n=2){const i=e&&e.length,o=i?e[0]*n:s.length;let a=_I(s,0,o,n,!0);const c=[];if(!a||a.next===a.prev)return c;let u,h,d,f,p,A,g;if(i&&(a=Lk(s,e,a,n)),s.length>80*n){u=d=s[0],h=f=s[1];for(let v=n;v<o;v+=n)p=s[v],A=s[v+1],p<u&&(u=p),A<h&&(h=A),p>d&&(d=p),A>f&&(f=A);g=Math.max(d-u,f-h),g=g!==0?32767/g:0}return lm(a,c,n,u,h,g,0),c}};function _I(s,e,n,i,o){let a,c;if(o===Hk(s,e,n,i)>0)for(a=e;a<n;a+=i)c=aS(a,s[a],s[a+1],c);else for(a=n-i;a>=e;a-=i)c=aS(a,s[a],s[a+1],c);return c&&Uv(c,c.next)&&(hm(c),c=c.next),c}function su(s,e){if(!s)return s;e||(e=s);let n=s,i;do if(i=!1,!n.steiner&&(Uv(n,n.next)||Wr(n.prev,n,n.next)===0)){if(hm(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function lm(s,e,n,i,o,a,c){if(!s)return;!c&&a&&Nk(s,i,o,a);let u=s,h,d;for(;s.prev!==s.next;){if(h=s.prev,d=s.next,a?Rk(s,i,o,a):Tk(s)){e.push(h.i/n|0),e.push(s.i/n|0),e.push(d.i/n|0),hm(s),s=d.next,u=d.next;continue}if(s=d,s===u){c?c===1?(s=Ik(su(s),e,n),lm(s,e,n,i,o,a,2)):c===2&&Bk(s,e,n,i,o,a):lm(su(s),e,n,i,o,a,1);break}}}function Tk(s){const e=s.prev,n=s,i=s.next;if(Wr(e,n,i)>=0)return!1;const o=e.x,a=n.x,c=i.x,u=e.y,h=n.y,d=i.y,f=o<a?o<c?o:c:a<c?a:c,p=u<h?u<d?u:d:h<d?h:d,A=o>a?o>c?o:c:a>c?a:c,g=u>h?u>d?u:d:h>d?h:d;let v=i.next;for(;v!==e;){if(v.x>=f&&v.x<=A&&v.y>=p&&v.y<=g&&$d(o,u,a,h,c,d,v.x,v.y)&&Wr(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function Rk(s,e,n,i){const o=s.prev,a=s,c=s.next;if(Wr(o,a,c)>=0)return!1;const u=o.x,h=a.x,d=c.x,f=o.y,p=a.y,A=c.y,g=u<h?u<d?u:d:h<d?h:d,v=f<p?f<A?f:A:p<A?p:A,b=u>h?u>d?u:d:h>d?h:d,x=f>p?f>A?f:A:p>A?p:A,E=Mb(g,v,e,n,i),S=Mb(b,x,e,n,i);let M=s.prevZ,C=s.nextZ;for(;M&&M.z>=E&&C&&C.z<=S;){if(M.x>=g&&M.x<=b&&M.y>=v&&M.y<=x&&M!==o&&M!==c&&$d(u,f,h,p,d,A,M.x,M.y)&&Wr(M.prev,M,M.next)>=0||(M=M.prevZ,C.x>=g&&C.x<=b&&C.y>=v&&C.y<=x&&C!==o&&C!==c&&$d(u,f,h,p,d,A,C.x,C.y)&&Wr(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;M&&M.z>=E;){if(M.x>=g&&M.x<=b&&M.y>=v&&M.y<=x&&M!==o&&M!==c&&$d(u,f,h,p,d,A,M.x,M.y)&&Wr(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;C&&C.z<=S;){if(C.x>=g&&C.x<=b&&C.y>=v&&C.y<=x&&C!==o&&C!==c&&$d(u,f,h,p,d,A,C.x,C.y)&&Wr(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Ik(s,e,n){let i=s;do{const o=i.prev,a=i.next.next;!Uv(o,a)&&wI(o,i,i.next,a)&&cm(o,a)&&cm(a,o)&&(e.push(o.i/n|0),e.push(i.i/n|0),e.push(a.i/n|0),hm(i),hm(i.next),i=s=a),i=i.next}while(i!==s);return su(i)}function Bk(s,e,n,i,o,a){let c=s;do{let u=c.next.next;for(;u!==c.prev;){if(c.i!==u.i&&zk(c,u)){let h=MI(c,u);c=su(c,c.next),h=su(h,h.next),lm(c,e,n,i,o,a,0),lm(h,e,n,i,o,a,0);return}u=u.next}c=c.next}while(c!==s)}function Lk(s,e,n,i){const o=[];let a,c,u,h,d;for(a=0,c=e.length;a<c;a++)u=e[a]*i,h=a<c-1?e[a+1]*i:s.length,d=_I(s,u,h,i,!1),d===d.next&&(d.steiner=!0),o.push(kk(d));for(o.sort(Pk),a=0;a<o.length;a++)n=Dk(o[a],n);return n}function Pk(s,e){return s.x-e.x}function Dk(s,e){const n=Ok(s,e);if(!n)return e;const i=MI(n,s);return su(i,i.next),su(n,n.next)}function Ok(s,e){let n=e,i=-1/0,o;const a=s.x,c=s.y;do{if(c<=n.y&&c>=n.next.y&&n.next.y!==n.y){const A=n.x+(c-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(A<=a&&A>i&&(i=A,o=n.x<n.next.x?n:n.next,A===a))return o}n=n.next}while(n!==e);if(!o)return null;const u=o,h=o.x,d=o.y;let f=1/0,p;n=o;do a>=n.x&&n.x>=h&&a!==n.x&&$d(c<d?a:i,c,h,d,c<d?i:a,c,n.x,n.y)&&(p=Math.abs(c-n.y)/(a-n.x),cm(n,s)&&(p<f||p===f&&(n.x>o.x||n.x===o.x&&Fk(o,n)))&&(o=n,f=p)),n=n.next;while(n!==u);return o}function Fk(s,e){return Wr(s.prev,s,e.prev)<0&&Wr(e.next,s,s.next)<0}function Nk(s,e,n,i){let o=s;do o.z===0&&(o.z=Mb(o.x,o.y,e,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==s);o.prevZ.nextZ=null,o.prevZ=null,Uk(o)}function Uk(s){let e,n,i,o,a,c,u,h,d=1;do{for(n=s,s=null,a=null,c=0;n;){for(c++,i=n,u=0,e=0;e<d&&(u++,i=i.nextZ,!!i);e++);for(h=d;u>0||h>0&&i;)u!==0&&(h===0||!i||n.z<=i.z)?(o=n,n=n.nextZ,u--):(o=i,i=i.nextZ,h--),a?a.nextZ=o:s=o,o.prevZ=a,a=o;n=i}a.nextZ=null,d*=2}while(c>1);return s}function Mb(s,e,n,i,o){return s=(s-n)*o|0,e=(e-i)*o|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function kk(s){let e=s,n=s;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==s);return n}function $d(s,e,n,i,o,a,c,u){return(o-c)*(e-u)>=(s-c)*(a-u)&&(s-c)*(i-u)>=(n-c)*(e-u)&&(n-c)*(a-u)>=(o-c)*(i-u)}function zk(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!Gk(s,e)&&(cm(s,e)&&cm(e,s)&&Vk(s,e)&&(Wr(s.prev,s,e.prev)||Wr(s,e.prev,e))||Uv(s,e)&&Wr(s.prev,s,s.next)>0&&Wr(e.prev,e,e.next)>0)}function Wr(s,e,n){return(e.y-s.y)*(n.x-e.x)-(e.x-s.x)*(n.y-e.y)}function Uv(s,e){return s.x===e.x&&s.y===e.y}function wI(s,e,n,i){const o=DA(Wr(s,e,n)),a=DA(Wr(s,e,i)),c=DA(Wr(n,i,s)),u=DA(Wr(n,i,e));return!!(o!==a&&c!==u||o===0&&PA(s,n,e)||a===0&&PA(s,i,e)||c===0&&PA(n,s,i)||u===0&&PA(n,e,i))}function PA(s,e,n){return e.x<=Math.max(s.x,n.x)&&e.x>=Math.min(s.x,n.x)&&e.y<=Math.max(s.y,n.y)&&e.y>=Math.min(s.y,n.y)}function DA(s){return s>0?1:s<0?-1:0}function Gk(s,e){let n=s;do{if(n.i!==s.i&&n.next.i!==s.i&&n.i!==e.i&&n.next.i!==e.i&&wI(n,n.next,s,e))return!0;n=n.next}while(n!==s);return!1}function cm(s,e){return Wr(s.prev,s,s.next)<0?Wr(s,e,s.next)>=0&&Wr(s,s.prev,e)>=0:Wr(s,e,s.prev)<0||Wr(s,s.next,e)<0}function Vk(s,e){let n=s,i=!1;const o=(s.x+e.x)/2,a=(s.y+e.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==s);return i}function MI(s,e){const n=new Cb(s.i,s.x,s.y),i=new Cb(e.i,e.x,e.y),o=s.next,a=e.prev;return s.next=e,e.prev=s,n.next=o,o.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function aS(s,e,n,i){const o=new Cb(s,e,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function hm(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Cb(s,e,n){this.i=s,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Hk(s,e,n,i){let o=0;for(let a=e,c=n-i;a<n;a+=i)o+=(s[c]-s[a])*(s[a+1]+s[c+1]),c=a;return o}class P_{static area(e){const n=e.length;let i=0;for(let o=n-1,a=0;a<n;o=a++)i+=e[o].x*e[a].y-e[a].x*e[o].y;return i*.5}static isClockWise(e){return P_.area(e)<0}static triangulateShape(e,n){const i=[],o=[],a=[];lS(e),cS(i,e);let c=e.length;n.forEach(lS);for(let h=0;h<n.length;h++)o.push(c),c+=n[h].length,cS(i,n[h]);const u=Sk.triangulate(i,o);for(let h=0;h<u.length;h+=3)a.push(u.slice(h,h+3));return a}}function lS(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function cS(s,e){for(let n=0;n<e.length;n++)s.push(e[n].x),s.push(e[n].y)}class L1 extends Nv{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new as(16777215),this.specular=new as(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new as(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cI,this.normalScale=new gs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=S_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}let jk=class extends Nv{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new as(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new as(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cI,this.normalScale=new gs(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=S_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};function OA(s,e,n){return!s||!n&&s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function Wk(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function Qk(s){function e(o,a){return s[o]-s[a]}const n=s.length,i=new Array(n);for(let o=0;o!==n;++o)i[o]=o;return i.sort(e),i}function hS(s,e,n){const i=s.length,o=new s.constructor(i);for(let a=0,c=0;c!==i;++a){const u=n[a]*e;for(let h=0;h!==e;++h)o[c++]=s[u+h]}return o}function CI(s,e,n,i){let o=1,a=s[0];for(;a!==void 0&&a[i]===void 0;)a=s[o++];if(a===void 0)return;let c=a[i];if(c!==void 0)if(Array.isArray(c))do c=a[i],c!==void 0&&(e.push(a.time),n.push.apply(n,c)),a=s[o++];while(a!==void 0);else if(c.toArray!==void 0)do c=a[i],c!==void 0&&(e.push(a.time),c.toArray(n,n.length)),a=s[o++];while(a!==void 0);else do c=a[i],c!==void 0&&(e.push(a.time),n.push(c)),a=s[o++];while(a!==void 0)}class kv{constructor(e,n,i,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=o!==void 0?o:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,o=n[i],a=n[i-1];n:{e:{let c;t:{i:if(!(e<o)){for(let u=i+2;;){if(o===void 0){if(e<a)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===u)break;if(a=o,o=n[++i],e<o)break e}c=n.length;break t}if(!(e>=a)){const u=n[1];e<u&&(i=2,a=u);for(let h=i-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===h)break;if(o=a,a=n[--i-1],e>=a)break e}c=i,i=0;break t}break n}for(;i<c;){const u=i+c>>>1;e<n[u]?c=u:i=u+1}if(o=n[i],a=n[i-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(o===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,a,o)}return this.interpolate_(i,a,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,o=this.valueSize,a=e*o;for(let c=0;c!==o;++c)n[c]=i[a+c];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Xk extends kv{constructor(e,n,i,o){super(e,n,i,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:CC,endingEnd:CC}}intervalChanged_(e,n,i){const o=this.parameterPositions;let a=e-2,c=e+1,u=o[a],h=o[c];if(u===void 0)switch(this.getSettings_().endingStart){case SC:a=e,u=2*n-i;break;case TC:a=o.length-2,u=n+o[a]-o[a+1];break;default:a=e,u=i}if(h===void 0)switch(this.getSettings_().endingEnd){case SC:c=e,h=2*i-n;break;case TC:c=1,h=i+o[1]-o[0];break;default:c=e-1,h=n}const d=(i-n)*.5,f=this.valueSize;this._weightPrev=d/(n-u),this._weightNext=d/(h-i),this._offsetPrev=a*f,this._offsetNext=c*f}interpolate_(e,n,i,o){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,h=e*u,d=h-u,f=this._offsetPrev,p=this._offsetNext,A=this._weightPrev,g=this._weightNext,v=(i-n)/(o-n),b=v*v,x=b*v,E=-A*x+2*A*b-A*v,S=(1+A)*x+(-1.5-2*A)*b+(-.5+A)*v+1,M=(-1-g)*x+(1.5+g)*b+.5*v,C=g*x-g*b;for(let T=0;T!==u;++T)a[T]=E*c[f+T]+S*c[d+T]+M*c[h+T]+C*c[p+T];return a}}class Kk extends kv{constructor(e,n,i,o){super(e,n,i,o)}interpolate_(e,n,i,o){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,h=e*u,d=h-u,f=(i-n)/(o-n),p=1-f;for(let A=0;A!==u;++A)a[A]=c[d+A]*p+c[h+A]*f;return a}}class qk extends kv{constructor(e,n,i,o){super(e,n,i,o)}interpolate_(e){return this.copySampleValue_(e-1)}}class rl{constructor(e,n,i,o){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=OA(n,this.TimeBufferType),this.values=OA(i,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:OA(e.times,Array),values:OA(e.values,Array)};const o=e.getInterpolation();o!==e.DefaultInterpolation&&(i.interpolation=o)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new qk(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Kk(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Xk(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case cv:n=this.InterpolantFactoryMethodDiscrete;break;case hv:n=this.InterpolantFactoryMethodLinear;break;case c1:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return cv;case this.InterpolantFactoryMethodLinear:return hv;case this.InterpolantFactoryMethodSmooth:return c1}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,o=n.length;i!==o;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,o=n.length;i!==o;++i)n[i]*=e}return this}trim(e,n){const i=this.times,o=i.length;let a=0,c=o-1;for(;a!==o&&i[a]<e;)++a;for(;c!==-1&&i[c]>n;)--c;if(++c,a!==0||c!==o){a>=c&&(c=Math.max(c,1),a=c-1);const u=this.getValueSize();this.times=i.slice(a,c),this.values=this.values.slice(a*u,c*u)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,o=this.values,a=i.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let u=0;u!==a;u++){const h=i[u];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,h),e=!1;break}if(c!==null&&c>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,h,c),e=!1;break}c=h}if(o!==void 0&&Wk(o))for(let u=0,h=o.length;u!==h;++u){const d=o[u];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,d),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),o=this.getInterpolation()===c1,a=e.length-1;let c=1;for(let u=1;u<a;++u){let h=!1;const d=e[u],f=e[u+1];if(d!==f&&(u!==1||d!==e[0]))if(o)h=!0;else{const p=u*i,A=p-i,g=p+i;for(let v=0;v!==i;++v){const b=n[p+v];if(b!==n[A+v]||b!==n[g+v]){h=!0;break}}}if(h){if(u!==c){e[c]=e[u];const p=u*i,A=c*i;for(let g=0;g!==i;++g)n[A+g]=n[p+g]}++c}}if(a>0){e[c]=e[a];for(let u=a*i,h=c*i,d=0;d!==i;++d)n[h+d]=n[u+d];++c}return c!==e.length?(this.times=e.slice(0,c),this.values=n.slice(0,c*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,o=new i(this.name,e,n);return o.createInterpolant=this.createInterpolant,o}}rl.prototype.TimeBufferType=Float32Array;rl.prototype.ValueBufferType=Float32Array;rl.prototype.DefaultInterpolation=hv;class yf extends rl{}yf.prototype.ValueTypeName="bool";yf.prototype.ValueBufferType=Array;yf.prototype.DefaultInterpolation=cv;yf.prototype.InterpolantFactoryMethodLinear=void 0;yf.prototype.InterpolantFactoryMethodSmooth=void 0;class SI extends rl{}SI.prototype.ValueTypeName="color";class um extends rl{}um.prototype.ValueTypeName="number";class Yk extends kv{constructor(e,n,i,o){super(e,n,i,o)}interpolate_(e,n,i,o){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,h=(i-n)/(o-n);let d=e*u;for(let f=d+u;d!==f;d+=4)So.slerpFlat(a,0,c,d-u,c,d,h);return a}}class ou extends rl{InterpolantFactoryMethodLinear(e){return new Yk(this.times,this.values,this.getValueSize(),e)}}ou.prototype.ValueTypeName="quaternion";ou.prototype.DefaultInterpolation=hv;ou.prototype.InterpolantFactoryMethodSmooth=void 0;class xf extends rl{}xf.prototype.ValueTypeName="string";xf.prototype.ValueBufferType=Array;xf.prototype.DefaultInterpolation=cv;xf.prototype.InterpolantFactoryMethodLinear=void 0;xf.prototype.InterpolantFactoryMethodSmooth=void 0;class dm extends rl{}dm.prototype.ValueTypeName="vector";class $k{constructor(e,n=-1,i,o=IU){this.name=e,this.tracks=i,this.duration=n,this.blendMode=o,this.uuid=Jc(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,o=1/(e.fps||1);for(let c=0,u=i.length;c!==u;++c)n.push(Zk(i[c]).scale(o));const a=new this(e.name,e.duration,n,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const n=[],i=e.tracks,o={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,c=i.length;a!==c;++a)n.push(rl.toJSON(i[a]));return o}static CreateFromMorphTargetSequence(e,n,i,o){const a=n.length,c=[];for(let u=0;u<a;u++){let h=[],d=[];h.push((u+a-1)%a,u,(u+1)%a),d.push(0,1,0);const f=Qk(h);h=hS(h,1,f),d=hS(d,1,f),!o&&h[0]===0&&(h.push(a),d.push(d[0])),c.push(new um(".morphTargetInfluences["+n[u].name+"]",h,d).scale(1/i))}return new this(e,-1,c)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const o=e;i=o.geometry&&o.geometry.animations||o.animations}for(let o=0;o<i.length;o++)if(i[o].name===n)return i[o];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const o={},a=/^([\w-]*?)([\d]+)$/;for(let u=0,h=e.length;u<h;u++){const d=e[u],f=d.name.match(a);if(f&&f.length>1){const p=f[1];let A=o[p];A||(o[p]=A=[]),A.push(d)}}const c=[];for(const u in o)c.push(this.CreateFromMorphTargetSequence(u,o[u],n,i));return c}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(p,A,g,v,b){if(g.length!==0){const x=[],E=[];CI(g,x,E,v),x.length!==0&&b.push(new p(A,x,E))}},o=[],a=e.name||"default",c=e.fps||30,u=e.blendMode;let h=e.length||-1;const d=e.hierarchy||[];for(let p=0;p<d.length;p++){const A=d[p].keys;if(!(!A||A.length===0))if(A[0].morphTargets){const g={};let v;for(v=0;v<A.length;v++)if(A[v].morphTargets)for(let b=0;b<A[v].morphTargets.length;b++)g[A[v].morphTargets[b]]=-1;for(const b in g){const x=[],E=[];for(let S=0;S!==A[v].morphTargets.length;++S){const M=A[v];x.push(M.time),E.push(M.morphTarget===b?1:0)}o.push(new um(".morphTargetInfluence["+b+"]",x,E))}h=g.length*c}else{const g=".bones["+n[p].name+"]";i(dm,g+".position",A,"pos",o),i(ou,g+".quaternion",A,"rot",o),i(dm,g+".scale",A,"scl",o)}}return o.length===0?null:new this(a,h,o,u)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,o=e.length;i!==o;++i){const a=this.tracks[i];n=Math.max(n,a.times[a.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Jk(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return um;case"vector":case"vector2":case"vector3":case"vector4":return dm;case"color":return SI;case"quaternion":return ou;case"bool":case"boolean":return yf;case"string":return xf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function Zk(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Jk(s.type);if(s.times===void 0){const n=[],i=[];CI(s.keys,n,i,"value"),s.times=n,s.values=i}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const uv={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};let e6=class{constructor(e,n,i){const o=this;let a=!1,c=0,u=0,h;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(f){u++,a===!1&&o.onStart!==void 0&&o.onStart(f,c,u),a=!0},this.itemEnd=function(f){c++,o.onProgress!==void 0&&o.onProgress(f,c,u),c===u&&(a=!1,o.onLoad!==void 0&&o.onLoad())},this.itemError=function(f){o.onError!==void 0&&o.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,p){return d.push(f,p),this},this.removeHandler=function(f){const p=d.indexOf(f);return p!==-1&&d.splice(p,2),this},this.getHandler=function(f){for(let p=0,A=d.length;p<A;p+=2){const g=d[p],v=d[p+1];if(g.global&&(g.lastIndex=0),g.test(f))return v}return null}}};const t6=new e6;let au=class{constructor(e){this.manager=e!==void 0?e:t6,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(o,a){i.load(e,o,n,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};au.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ml={};class n6 extends Error{constructor(e,n){super(e),this.response=n}}class i6 extends au{constructor(e){super(e)}load(e,n,i,o){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=uv.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(a),this.manager.itemEnd(e)},0),a;if(Ml[e]!==void 0){Ml[e].push({onLoad:n,onProgress:i,onError:o});return}Ml[e]=[],Ml[e].push({onLoad:n,onProgress:i,onError:o});const c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,h=this.responseType;fetch(c).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;const f=Ml[e],p=d.body.getReader(),A=d.headers.get("Content-Length")||d.headers.get("X-File-Size"),g=A?parseInt(A):0,v=g!==0;let b=0;const x=new ReadableStream({start(E){S();function S(){p.read().then(({done:M,value:C})=>{if(M)E.close();else{b+=C.byteLength;const T=new ProgressEvent("progress",{lengthComputable:v,loaded:b,total:g});for(let L=0,B=f.length;L<B;L++){const F=f[L];F.onProgress&&F.onProgress(T)}E.enqueue(C),S()}})}}});return new Response(x)}else throw new n6(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(h){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(f=>new DOMParser().parseFromString(f,u));case"json":return d.json();default:if(u===void 0)return d.text();{const p=/charset="?([^;"\s]*)"?/i.exec(u),A=p&&p[1]?p[1].toLowerCase():void 0,g=new TextDecoder(A);return d.arrayBuffer().then(v=>g.decode(v))}}}).then(d=>{uv.add(e,d);const f=Ml[e];delete Ml[e];for(let p=0,A=f.length;p<A;p++){const g=f[p];g.onLoad&&g.onLoad(d)}}).catch(d=>{const f=Ml[e];if(f===void 0)throw this.manager.itemError(e),d;delete Ml[e];for(let p=0,A=f.length;p<A;p++){const g=f[p];g.onError&&g.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}let r6=class extends au{constructor(e){super(e)}load(e,n,i,o){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=uv.get(e);if(c!==void 0)return a.manager.itemStart(e),setTimeout(function(){n&&n(c),a.manager.itemEnd(e)},0),c;const u=bb("img");function h(){f(),uv.add(e,this),n&&n(this),a.manager.itemEnd(e)}function d(p){f(),o&&o(p),a.manager.itemError(e),a.manager.itemEnd(e)}function f(){u.removeEventListener("load",h,!1),u.removeEventListener("error",d,!1)}return u.addEventListener("load",h,!1),u.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(e),u.src=e,u}},s6=class extends au{constructor(e){super(e)}load(e,n,i,o){const a=new ql,c=new r6(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(u){a.image=u,a.needsUpdate=!0,n!==void 0&&n(a)},i,o),a}},zv=class extends Us{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new as(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}};const P1=new Ii,uS=new Mt,dS=new Mt;let D_=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gs(512,512),this.map=null,this.mapPass=null,this.matrix=new Ii,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vk,this._frameExtents=new gs(1,1),this._viewportCount=1,this._viewports=[new To(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;uS.setFromMatrixPosition(e.matrixWorld),n.position.copy(uS),dS.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(dS),n.updateMatrixWorld(),P1.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(P1),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(P1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};class o6 extends D_{constructor(){super(new B_(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=am*2*e.angle*this.focus,o=this.mapSize.width/this.mapSize.height,a=e.distance||n.far;(i!==n.fov||o!==n.aspect||a!==n.far)&&(n.fov=i,n.aspect=o,n.far=a,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class a6 extends zv{constructor(e,n,i=0,o=Math.PI/3,a=0,c=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Us.DEFAULT_UP),this.updateMatrix(),this.target=new Us,this.distance=i,this.angle=o,this.penumbra=a,this.decay=c,this.map=null,this.shadow=new o6}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const fS=new Ii,fp=new Mt,D1=new Mt;class l6 extends D_{constructor(){super(new B_(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new gs(4,2),this._viewportCount=6,this._viewports=[new To(2,1,1,1),new To(0,1,1,1),new To(3,1,1,1),new To(1,1,1,1),new To(3,0,1,1),new To(1,0,1,1)],this._cubeDirections=[new Mt(1,0,0),new Mt(-1,0,0),new Mt(0,0,1),new Mt(0,0,-1),new Mt(0,1,0),new Mt(0,-1,0)],this._cubeUps=[new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,1,0),new Mt(0,0,1),new Mt(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,o=this.matrix,a=e.distance||i.far;a!==i.far&&(i.far=a,i.updateProjectionMatrix()),fp.setFromMatrixPosition(e.matrixWorld),i.position.copy(fp),D1.copy(i.position),D1.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(D1),i.updateMatrixWorld(),o.makeTranslation(-fp.x,-fp.y,-fp.z),fS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fS)}}class pS extends zv{constructor(e,n,i=0,o=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=o,this.shadow=new l6}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let c6=class extends D_{constructor(){super(new EI(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},h6=class extends zv{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Us.DEFAULT_UP),this.updateMatrix(),this.target=new Us,this.shadow=new c6}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},u6=class extends zv{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}};class d6{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,o=e.length;i<o;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}const O_="\\[\\]\\.:\\/",f6=new RegExp("["+O_+"]","g"),F_="[^"+O_+"]",p6="[^"+O_.replace("\\.","")+"]",m6=/((?:WC+[\/:])*)/.source.replace("WC",F_),g6=/(WCOD+)?/.source.replace("WCOD",p6),A6=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",F_),v6=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",F_),y6=new RegExp("^"+m6+g6+A6+v6+"$"),x6=["material","materials","bones","map"];class E6{constructor(e,n,i){const o=i||Ar.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,o)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,o=this._bindings[i];o!==void 0&&o.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let o=this._targetGroup.nCachedObjects_,a=i.length;o!==a;++o)i[o].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Ar{constructor(e,n,i){this.path=n,this.parsedPath=i||Ar.parseTrackName(n),this.node=Ar.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Ar.Composite(e,n,i):new Ar(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(f6,"")}static parseTrackName(e){const n=y6.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},o=i.nodeName&&i.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){const a=i.nodeName.substring(o+1);x6.indexOf(a)!==-1&&(i.nodeName=i.nodeName.substring(0,o),i.objectName=a)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(a){for(let c=0;c<a.length;c++){const u=a[c];if(u.name===n||u.uuid===n)return u;const h=i(u.children);if(h)return h}return null},o=i(e.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let o=0,a=i.length;o!==a;++o)e[n++]=i[o]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let o=0,a=i.length;o!==a;++o)i[o]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let o=0,a=i.length;o!==a;++o)i[o]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let o=0,a=i.length;o!==a;++o)i[o]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,o=n.propertyName;let a=n.propertyIndex;if(e||(e=Ar.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let d=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===d){d=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(d!==void 0){if(e[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[d]}}const c=e[o];if(c===void 0){const d=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+o+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(a!==void 0){if(o==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}h=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=a}else c.fromArray!==void 0&&c.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(h=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=o;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ar.Composite=E6;Ar.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ar.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ar.prototype.GetterByBindingType=[Ar.prototype._getValue_direct,Ar.prototype._getValue_array,Ar.prototype._getValue_arrayElement,Ar.prototype._getValue_toArray];Ar.prototype.SetterByBindingTypeAndVersioning=[[Ar.prototype._setValue_direct,Ar.prototype._setValue_direct_setNeedsUpdate,Ar.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ar.prototype._setValue_array,Ar.prototype._setValue_array_setNeedsUpdate,Ar.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ar.prototype._setValue_arrayElement,Ar.prototype._setValue_arrayElement_setNeedsUpdate,Ar.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ar.prototype._setValue_fromArray,Ar.prototype._setValue_fromArray_setNeedsUpdate,Ar.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:sI}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=sI);/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/var mS=function(s){return URL.createObjectURL(new Blob([s],{type:"text/javascript"}))};try{URL.revokeObjectURL(mS(""))}catch{mS=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var oa=Uint8Array,Vc=Uint16Array,Sb=Uint32Array,TI=new oa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),RI=new oa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),b6=new oa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),II=function(s,e){for(var n=new Vc(31),i=0;i<31;++i)n[i]=e+=1<<s[i-1];for(var o=new Sb(n[30]),i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)o[a]=a-n[i]<<5|i;return[n,o]},BI=II(TI,2),LI=BI[0],_6=BI[1];LI[28]=258,_6[258]=28;var w6=II(RI,0),M6=w6[0],Tb=new Vc(32768);for(var Or=0;Or<32768;++Or){var wc=(Or&43690)>>>1|(Or&21845)<<1;wc=(wc&52428)>>>2|(wc&13107)<<2,wc=(wc&61680)>>>4|(wc&3855)<<4,Tb[Or]=((wc&65280)>>>8|(wc&255)<<8)>>>1}var Zp=function(s,e,n){for(var i=s.length,o=0,a=new Vc(e);o<i;++o)++a[s[o]-1];var c=new Vc(e);for(o=0;o<e;++o)c[o]=c[o-1]+a[o-1]<<1;var u;if(n){u=new Vc(1<<e);var h=15-e;for(o=0;o<i;++o)if(s[o])for(var d=o<<4|s[o],f=e-s[o],p=c[s[o]-1]++<<f,A=p|(1<<f)-1;p<=A;++p)u[Tb[p]>>>h]=d}else for(u=new Vc(i),o=0;o<i;++o)s[o]&&(u[o]=Tb[c[s[o]-1]++]>>>15-s[o]);return u},_m=new oa(288);for(var Or=0;Or<144;++Or)_m[Or]=8;for(var Or=144;Or<256;++Or)_m[Or]=9;for(var Or=256;Or<280;++Or)_m[Or]=7;for(var Or=280;Or<288;++Or)_m[Or]=8;var PI=new oa(32);for(var Or=0;Or<32;++Or)PI[Or]=5;var C6=Zp(_m,9,1),S6=Zp(PI,5,1),O1=function(s){for(var e=s[0],n=1;n<s.length;++n)s[n]>e&&(e=s[n]);return e},xa=function(s,e,n){var i=e/8|0;return(s[i]|s[i+1]<<8)>>(e&7)&n},F1=function(s,e){var n=e/8|0;return(s[n]|s[n+1]<<8|s[n+2]<<16)>>(e&7)},T6=function(s){return(s/8|0)+(s&7&&1)},R6=function(s,e,n){(e==null||e<0)&&(e=0),(n==null||n>s.length)&&(n=s.length);var i=new(s instanceof Vc?Vc:s instanceof Sb?Sb:oa)(n-e);return i.set(s.subarray(e,n)),i},I6=function(s,e,n){var i=s.length;if(!i||n&&!n.l&&i<5)return e||new oa(0);var o=!e||n,a=!n||n.i;n||(n={}),e||(e=new oa(i*3));var c=function(Je){var Oe=e.length;if(Je>Oe){var $e=new oa(Math.max(Oe*2,Je));$e.set(e),e=$e}},u=n.f||0,h=n.p||0,d=n.b||0,f=n.l,p=n.d,A=n.m,g=n.n,v=i*8;do{if(!f){n.f=u=xa(s,h,1);var b=xa(s,h+1,3);if(h+=3,b)if(b==1)f=C6,p=S6,A=9,g=5;else if(b==2){var M=xa(s,h,31)+257,C=xa(s,h+10,15)+4,T=M+xa(s,h+5,31)+1;h+=14;for(var L=new oa(T),B=new oa(19),F=0;F<C;++F)B[b6[F]]=xa(s,h+F*3,7);h+=C*3;for(var D=O1(B),P=(1<<D)-1,U=Zp(B,D,1),F=0;F<T;){var K=U[xa(s,h,P)];h+=K&15;var x=K>>>4;if(x<16)L[F++]=x;else{var J=0,z=0;for(x==16?(z=3+xa(s,h,3),h+=2,J=L[F-1]):x==17?(z=3+xa(s,h,7),h+=3):x==18&&(z=11+xa(s,h,127),h+=7);z--;)L[F++]=J}}var j=L.subarray(0,M),G=L.subarray(M);A=O1(j),g=O1(G),f=Zp(j,A,1),p=Zp(G,g,1)}else throw"invalid block type";else{var x=T6(h)+4,E=s[x-4]|s[x-3]<<8,S=x+E;if(S>i){if(a)throw"unexpected EOF";break}o&&c(d+E),e.set(s.subarray(x,S),d),n.b=d+=E,n.p=h=S*8;continue}if(h>v){if(a)throw"unexpected EOF";break}}o&&c(d+131072);for(var H=(1<<A)-1,te=(1<<g)-1,Z=h;;Z=h){var J=f[F1(s,h)&H],ee=J>>>4;if(h+=J&15,h>v){if(a)throw"unexpected EOF";break}if(!J)throw"invalid length/literal";if(ee<256)e[d++]=ee;else if(ee==256){Z=h,f=null;break}else{var oe=ee-254;if(ee>264){var F=ee-257,xe=TI[F];oe=xa(s,h,(1<<xe)-1)+LI[F],h+=xe}var Pe=p[F1(s,h)&te],me=Pe>>>4;if(!Pe)throw"invalid distance";h+=Pe&15;var G=M6[me];if(me>3){var xe=RI[me];G+=F1(s,h)&(1<<xe)-1,h+=xe}if(h>v){if(a)throw"unexpected EOF";break}o&&c(d+131072);for(var Ce=d+oe;d<Ce;d+=4)e[d]=e[d-G],e[d+1]=e[d+1-G],e[d+2]=e[d+2-G],e[d+3]=e[d+3-G];d=Ce}}n.l=f,n.p=Z,n.b=d,f&&(u=1,n.m=A,n.d=p,n.n=g)}while(!u);return d==e.length?e:R6(e,0,d)},B6=new oa(0),L6=function(s){if((s[0]&15)!=8||s[0]>>>4>7||(s[0]<<8|s[1])%31)throw"invalid zlib data";if(s[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function P6(s,e){return I6((L6(s),s.subarray(2,-4)),e)}var D6=typeof TextDecoder<"u"&&new TextDecoder,O6=0;try{D6.decode(B6,{stream:!0}),O6=1}catch{}function DI(s,e,n){const i=n.length-s-1;if(e>=n[i])return i-1;if(e<=n[s])return s;let o=s,a=i,c=Math.floor((o+a)/2);for(;e<n[c]||e>=n[c+1];)e<n[c]?a=c:o=c,c=Math.floor((o+a)/2);return c}function F6(s,e,n,i){const o=[],a=[],c=[];o[0]=1;for(let u=1;u<=n;++u){a[u]=e-i[s+1-u],c[u]=i[s+u]-e;let h=0;for(let d=0;d<u;++d){const f=c[d+1],p=a[u-d],A=o[d]/(f+p);o[d]=h+f*A,h=p*A}o[u]=h}return o}function N6(s,e,n,i){const o=DI(s,i,e),a=F6(o,i,s,e),c=new To(0,0,0,0);for(let u=0;u<=s;++u){const h=n[o-s+u],d=a[u],f=h.w*d;c.x+=h.x*f,c.y+=h.y*f,c.z+=h.z*f,c.w+=h.w*d}return c}function U6(s,e,n,i,o){const a=[];for(let p=0;p<=n;++p)a[p]=0;const c=[];for(let p=0;p<=i;++p)c[p]=a.slice(0);const u=[];for(let p=0;p<=n;++p)u[p]=a.slice(0);u[0][0]=1;const h=a.slice(0),d=a.slice(0);for(let p=1;p<=n;++p){h[p]=e-o[s+1-p],d[p]=o[s+p]-e;let A=0;for(let g=0;g<p;++g){const v=d[g+1],b=h[p-g];u[p][g]=v+b;const x=u[g][p-1]/u[p][g];u[g][p]=A+v*x,A=b*x}u[p][p]=A}for(let p=0;p<=n;++p)c[0][p]=u[p][n];for(let p=0;p<=n;++p){let A=0,g=1;const v=[];for(let b=0;b<=n;++b)v[b]=a.slice(0);v[0][0]=1;for(let b=1;b<=i;++b){let x=0;const E=p-b,S=n-b;p>=b&&(v[g][0]=v[A][0]/u[S+1][E],x=v[g][0]*u[E][S]);const M=E>=-1?1:-E,C=p-1<=S?b-1:n-p;for(let L=M;L<=C;++L)v[g][L]=(v[A][L]-v[A][L-1])/u[S+1][E+L],x+=v[g][L]*u[E+L][S];p<=S&&(v[g][b]=-v[A][b-1]/u[S+1][p],x+=v[g][b]*u[p][S]),c[b][p]=x;const T=A;A=g,g=T}}let f=n;for(let p=1;p<=i;++p){for(let A=0;A<=n;++A)c[p][A]*=f;f*=n-p}return c}function k6(s,e,n,i,o){const a=o<s?o:s,c=[],u=DI(s,i,e),h=U6(u,i,s,a,e),d=[];for(let f=0;f<n.length;++f){const p=n[f].clone(),A=p.w;p.x*=A,p.y*=A,p.z*=A,d[f]=p}for(let f=0;f<=a;++f){const p=d[u-s].clone().multiplyScalar(h[f][0]);for(let A=1;A<=s;++A)p.add(d[u-s+A].clone().multiplyScalar(h[f][A]));c[f]=p}for(let f=a+1;f<=o+1;++f)c[f]=new To(0,0,0);return c}function z6(s,e){let n=1;for(let o=2;o<=s;++o)n*=o;let i=1;for(let o=2;o<=e;++o)i*=o;for(let o=2;o<=s-e;++o)i*=o;return n/i}function G6(s){const e=s.length,n=[],i=[];for(let a=0;a<e;++a){const c=s[a];n[a]=new Mt(c.x,c.y,c.z),i[a]=c.w}const o=[];for(let a=0;a<e;++a){const c=n[a].clone();for(let u=1;u<=a;++u)c.sub(o[a-u].clone().multiplyScalar(z6(a,u)*i[u]));o[a]=c.divideScalar(i[0])}return o}function V6(s,e,n,i,o){const a=k6(s,e,n,i,o);return G6(a)}class H6 extends Ck{constructor(e,n,i,o,a){super(),this.degree=e,this.knots=n,this.controlPoints=[],this.startKnot=o||0,this.endKnot=a||this.knots.length-1;for(let c=0;c<i.length;++c){const u=i[c];this.controlPoints[c]=new To(u.x,u.y,u.z,u.w)}}getPoint(e,n=new Mt){const i=n,o=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),a=N6(this.degree,this.knots,this.controlPoints,o);return a.w!==1&&a.divideScalar(a.w),i.set(a.x,a.y,a.z)}getTangent(e,n=new Mt){const i=n,o=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),a=V6(this.degree,this.knots,this.controlPoints,o,1);return i.copy(a[1]).normalize(),i}}let Zi,es,co;class j6 extends au{constructor(e){super(e)}load(e,n,i,o){const a=this,c=a.path===""?d6.extractUrlBase(e):a.path,u=new i6(this.manager);u.setPath(a.path),u.setResponseType("arraybuffer"),u.setRequestHeader(a.requestHeader),u.setWithCredentials(a.withCredentials),u.load(e,function(h){try{n(a.parse(h,c))}catch(d){o?o(d):console.error(d),a.manager.itemError(e)}},i,o)}parse(e,n){if(Y6(e))Zi=new q6().parse(e);else{const o=UI(e);if(!$6(o))throw new Error("THREE.FBXLoader: Unknown format.");if(AS(o)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+AS(o));Zi=new K6().parse(o)}const i=new s6(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);return new W6(i,this.manager).parse(Zi)}}class W6{constructor(e,n){this.textureLoader=e,this.manager=n}parse(){es=this.parseConnections();const e=this.parseImages(),n=this.parseTextures(e),i=this.parseMaterials(n),o=this.parseDeformers(),a=new Q6().parse(o);return this.parseScene(o,a,i),co}parseConnections(){const e=new Map;return"Connections"in Zi&&Zi.Connections.connections.forEach(function(i){const o=i[0],a=i[1],c=i[2];e.has(o)||e.set(o,{parents:[],children:[]});const u={ID:a,relationship:c};e.get(o).parents.push(u),e.has(a)||e.set(a,{parents:[],children:[]});const h={ID:o,relationship:c};e.get(a).children.push(h)}),e}parseImages(){const e={},n={};if("Video"in Zi.Objects){const i=Zi.Objects.Video;for(const o in i){const a=i[o],c=parseInt(o);if(e[c]=a.RelativeFilename||a.Filename,"Content"in a){const u=a.Content instanceof ArrayBuffer&&a.Content.byteLength>0,h=typeof a.Content=="string"&&a.Content!=="";if(u||h){const d=this.parseImage(i[o]);n[a.RelativeFilename||a.Filename]=d}}}}for(const i in e){const o=e[i];n[o]!==void 0?e[i]=n[o]:e[i]=e[i].split("\\").pop()}return e}parseImage(e){const n=e.Content,i=e.RelativeFilename||e.Filename,o=i.slice(i.lastIndexOf(".")+1).toLowerCase();let a;switch(o){case"bmp":a="image/bmp";break;case"jpg":case"jpeg":a="image/jpeg";break;case"png":a="image/png";break;case"tif":a="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",i),a="image/tga";break;default:console.warn('FBXLoader: Image type "'+o+'" is not supported.');return}if(typeof n=="string")return"data:"+a+";base64,"+n;{const c=new Uint8Array(n);return window.URL.createObjectURL(new Blob([c],{type:a}))}}parseTextures(e){const n=new Map;if("Texture"in Zi.Objects){const i=Zi.Objects.Texture;for(const o in i){const a=this.parseTexture(i[o],e);n.set(parseInt(o),a)}}return n}parseTexture(e,n){const i=this.loadTexture(e,n);i.ID=e.id,i.name=e.attrName;const o=e.WrapModeU,a=e.WrapModeV,c=o!==void 0?o.value:0,u=a!==void 0?a.value:0;if(i.wrapS=c===0?av:Yd,i.wrapT=u===0?av:Yd,"Scaling"in e){const h=e.Scaling.value;i.repeat.x=h[0],i.repeat.y=h[1]}if("Translation"in e){const h=e.Translation.value;i.offset.x=h[0],i.offset.y=h[1]}return i}loadTexture(e,n){let i;const o=this.textureLoader.path,a=es.get(e.id).children;a!==void 0&&a.length>0&&n[a[0].ID]!==void 0&&(i=n[a[0].ID],(i.indexOf("blob:")===0||i.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let c;const u=e.FileName.slice(-3).toLowerCase();if(u==="tga"){const h=this.manager.getHandler(".tga");h===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),c=new ql):(h.setPath(this.textureLoader.path),c=h.load(i))}else if(u==="dds"){const h=this.manager.getHandler(".dds");h===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",e.RelativeFilename),c=new ql):(h.setPath(this.textureLoader.path),c=h.load(i))}else u==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),c=new ql):c=this.textureLoader.load(i);return this.textureLoader.setPath(o),c}parseMaterials(e){const n=new Map;if("Material"in Zi.Objects){const i=Zi.Objects.Material;for(const o in i){const a=this.parseMaterial(i[o],e);a!==null&&n.set(parseInt(o),a)}}return n}parseMaterial(e,n){const i=e.id,o=e.attrName;let a=e.ShadingModel;if(typeof a=="object"&&(a=a.value),!es.has(i))return null;const c=this.parseParameters(e,n,i);let u;switch(a.toLowerCase()){case"phong":u=new L1;break;case"lambert":u=new jk;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',a),u=new L1;break}return u.setValues(c),u.name=o,u}parseParameters(e,n,i){const o={};e.BumpFactor&&(o.bumpScale=e.BumpFactor.value),e.Diffuse?o.color=new as().fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(o.color=new as().fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(o.displacementScale=e.DisplacementFactor.value),e.Emissive?o.emissive=new as().fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(o.emissive=new as().fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(o.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(o.opacity=parseFloat(e.Opacity.value)),o.opacity<1&&(o.transparent=!0),e.ReflectionFactor&&(o.reflectivity=e.ReflectionFactor.value),e.Shininess&&(o.shininess=e.Shininess.value),e.Specular?o.specular=new as().fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&e.SpecularColor.type==="Color"&&(o.specular=new as().fromArray(e.SpecularColor.value).convertSRGBToLinear());const a=this;return es.get(i).children.forEach(function(c){const u=c.relationship;switch(u){case"Bump":o.bumpMap=a.getTexture(n,c.ID);break;case"Maya|TEX_ao_map":o.aoMap=a.getTexture(n,c.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":o.map=a.getTexture(n,c.ID),o.map!==void 0&&(o.map.colorSpace=po);break;case"DisplacementColor":o.displacementMap=a.getTexture(n,c.ID);break;case"EmissiveColor":o.emissiveMap=a.getTexture(n,c.ID),o.emissiveMap!==void 0&&(o.emissiveMap.colorSpace=po);break;case"NormalMap":case"Maya|TEX_normal_map":o.normalMap=a.getTexture(n,c.ID);break;case"ReflectionColor":o.envMap=a.getTexture(n,c.ID),o.envMap!==void 0&&(o.envMap.mapping=wU,o.envMap.colorSpace=po);break;case"SpecularColor":o.specularMap=a.getTexture(n,c.ID),o.specularMap!==void 0&&(o.specularMap.colorSpace=po);break;case"TransparentColor":case"TransparencyFactor":o.alphaMap=a.getTexture(n,c.ID),o.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",u);break}}),o}getTexture(e,n){return"LayeredTexture"in Zi.Objects&&n in Zi.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=es.get(n).children[0].ID),e.get(n)}parseDeformers(){const e={},n={};if("Deformer"in Zi.Objects){const i=Zi.Objects.Deformer;for(const o in i){const a=i[o],c=es.get(parseInt(o));if(a.attrType==="Skin"){const u=this.parseSkeleton(c,i);u.ID=o,c.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),u.geometryID=c.parents[0].ID,e[o]=u}else if(a.attrType==="BlendShape"){const u={id:o};u.rawTargets=this.parseMorphTargets(c,i),u.id=o,c.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[o]=u}}}return{skeletons:e,morphTargets:n}}parseSkeleton(e,n){const i=[];return e.children.forEach(function(o){const a=n[o.ID];if(a.attrType!=="Cluster")return;const c={ID:o.ID,indices:[],weights:[],transformLink:new Ii().fromArray(a.TransformLink.a)};"Indexes"in a&&(c.indices=a.Indexes.a,c.weights=a.Weights.a),i.push(c)}),{rawBones:i,bones:[]}}parseMorphTargets(e,n){const i=[];for(let o=0;o<e.children.length;o++){const a=e.children[o],c=n[a.ID],u={name:c.attrName,initialWeight:c.DeformPercent,id:c.id,fullWeights:c.FullWeights.a};if(c.attrType!=="BlendShapeChannel")return;u.geoID=es.get(parseInt(a.ID)).children.filter(function(h){return h.relationship===void 0})[0].ID,i.push(u)}return i}parseScene(e,n,i){co=new $C;const o=this.parseModels(e.skeletons,n,i),a=Zi.Objects.Model,c=this;o.forEach(function(h){const d=a[h.ID];c.setLookAtProperties(h,d),es.get(h.ID).parents.forEach(function(p){const A=o.get(p.ID);A!==void 0&&A.add(h)}),h.parent===null&&co.add(h)}),this.bindSkeleton(e.skeletons,n,o),this.addGlobalSceneSettings(),co.traverse(function(h){if(h.userData.transformData){h.parent&&(h.userData.transformData.parentMatrix=h.parent.matrix,h.userData.transformData.parentMatrixWorld=h.parent.matrixWorld);const d=FI(h.userData.transformData);h.applyMatrix4(d),h.updateWorldMatrix()}});const u=new X6().parse();co.children.length===1&&co.children[0].isGroup&&(co.children[0].animations=u,co=co.children[0]),co.animations=u}parseModels(e,n,i){const o=new Map,a=Zi.Objects.Model;for(const c in a){const u=parseInt(c),h=a[c],d=es.get(u);let f=this.buildSkeleton(d,e,u,h.attrName);if(!f){switch(h.attrType){case"Camera":f=this.createCamera(d);break;case"Light":f=this.createLight(d);break;case"Mesh":f=this.createMesh(d,n,i);break;case"NurbsCurve":f=this.createCurve(d,n);break;case"LimbNode":case"Root":f=new wb;break;case"Null":default:f=new $C;break}f.name=h.attrName?Ar.sanitizeNodeName(h.attrName):"",f.userData.originalName=h.attrName,f.ID=u}this.getTransformData(f,h),o.set(u,f)}return o}buildSkeleton(e,n,i,o){let a=null;return e.parents.forEach(function(c){for(const u in n){const h=n[u];h.rawBones.forEach(function(d,f){if(d.ID===c.ID){const p=a;a=new wb,a.matrixWorld.copy(d.transformLink),a.name=o?Ar.sanitizeNodeName(o):"",a.userData.originalName=o,a.ID=i,h.bones[f]=a,p!==null&&a.add(p)}})}}),a}createCamera(e){let n,i;if(e.children.forEach(function(o){const a=Zi.Objects.NodeAttribute[o.ID];a!==void 0&&(i=a)}),i===void 0)n=new Us;else{let o=0;i.CameraProjectionType!==void 0&&i.CameraProjectionType.value===1&&(o=1);let a=1;i.NearPlane!==void 0&&(a=i.NearPlane.value/1e3);let c=1e3;i.FarPlane!==void 0&&(c=i.FarPlane.value/1e3);let u=window.innerWidth,h=window.innerHeight;i.AspectWidth!==void 0&&i.AspectHeight!==void 0&&(u=i.AspectWidth.value,h=i.AspectHeight.value);const d=u/h;let f=45;i.FieldOfView!==void 0&&(f=i.FieldOfView.value);const p=i.FocalLength?i.FocalLength.value:null;switch(o){case 0:n=new B_(f,d,a,c),p!==null&&n.setFocalLength(p);break;case 1:n=new EI(-u/2,u/2,h/2,-h/2,a,c);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+o+"."),n=new Us;break}}return n}createLight(e){let n,i;if(e.children.forEach(function(o){const a=Zi.Objects.NodeAttribute[o.ID];a!==void 0&&(i=a)}),i===void 0)n=new Us;else{let o;i.LightType===void 0?o=0:o=i.LightType.value;let a=16777215;i.Color!==void 0&&(a=new as().fromArray(i.Color.value).convertSRGBToLinear());let c=i.Intensity===void 0?1:i.Intensity.value/100;i.CastLightOnObject!==void 0&&i.CastLightOnObject.value===0&&(c=0);let u=0;i.FarAttenuationEnd!==void 0&&(i.EnableFarAttenuation!==void 0&&i.EnableFarAttenuation.value===0?u=0:u=i.FarAttenuationEnd.value);const h=1;switch(o){case 0:n=new pS(a,c,u,h);break;case 1:n=new h6(a,c);break;case 2:let d=Math.PI/3;i.InnerAngle!==void 0&&(d=uo.degToRad(i.InnerAngle.value));let f=0;i.OuterAngle!==void 0&&(f=uo.degToRad(i.OuterAngle.value),f=Math.max(f,1)),n=new a6(a,c,u,d,f,h);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),n=new pS(a,c);break}i.CastShadows!==void 0&&i.CastShadows.value===1&&(n.castShadow=!0)}return n}createMesh(e,n,i){let o,a=null,c=null;const u=[];return e.children.forEach(function(h){n.has(h.ID)&&(a=n.get(h.ID)),i.has(h.ID)&&u.push(i.get(h.ID))}),u.length>1?c=u:u.length>0?c=u[0]:(c=new L1({name:au.DEFAULT_MATERIAL_NAME,color:13421772}),u.push(c)),"color"in a.attributes&&u.forEach(function(h){h.vertexColors=!0}),a.FBX_Deformer?(o=new bk(a,c),o.normalizeSkinWeights()):o=new yI(a,c),o}createCurve(e,n){const i=e.children.reduce(function(a,c){return n.has(c.ID)&&(a=n.get(c.ID)),a},null),o=new bI({name:au.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Mk(i,o)}getTransformData(e,n){const i={};"InheritType"in n&&(i.inheritType=parseInt(n.InheritType.value)),"RotationOrder"in n?i.eulerOrder=NI(n.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in n&&(i.translation=n.Lcl_Translation.value),"PreRotation"in n&&(i.preRotation=n.PreRotation.value),"Lcl_Rotation"in n&&(i.rotation=n.Lcl_Rotation.value),"PostRotation"in n&&(i.postRotation=n.PostRotation.value),"Lcl_Scaling"in n&&(i.scale=n.Lcl_Scaling.value),"ScalingOffset"in n&&(i.scalingOffset=n.ScalingOffset.value),"ScalingPivot"in n&&(i.scalingPivot=n.ScalingPivot.value),"RotationOffset"in n&&(i.rotationOffset=n.RotationOffset.value),"RotationPivot"in n&&(i.rotationPivot=n.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,n){"LookAtProperty"in n&&es.get(e.ID).children.forEach(function(o){if(o.relationship==="LookAtProperty"){const a=Zi.Objects.Model[o.ID];if("Lcl_Translation"in a){const c=a.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(c),co.add(e.target)):e.lookAt(new Mt().fromArray(c))}}})}bindSkeleton(e,n,i){const o=this.parsePoseNodes();for(const a in e){const c=e[a];es.get(parseInt(c.ID)).parents.forEach(function(h){if(n.has(h.ID)){const d=h.ID;es.get(d).parents.forEach(function(p){i.has(p.ID)&&i.get(p.ID).bind(new L_(c.bones),o[p.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in Zi.Objects){const n=Zi.Objects.Pose;for(const i in n)if(n[i].attrType==="BindPose"&&n[i].NbPoseNodes>0){const o=n[i].PoseNode;Array.isArray(o)?o.forEach(function(a){e[a.Node]=new Ii().fromArray(a.Matrix.a)}):e[o.Node]=new Ii().fromArray(o.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in Zi){if("AmbientColor"in Zi.GlobalSettings){const e=Zi.GlobalSettings.AmbientColor.value,n=e[0],i=e[1],o=e[2];if(n!==0||i!==0||o!==0){const a=new as(n,i,o).convertSRGBToLinear();co.add(new u6(a,1))}}"UnitScaleFactor"in Zi.GlobalSettings&&(co.userData.unitScaleFactor=Zi.GlobalSettings.UnitScaleFactor.value)}}}class Q6{constructor(){this.negativeMaterialIndices=!1}parse(e){const n=new Map;if("Geometry"in Zi.Objects){const i=Zi.Objects.Geometry;for(const o in i){const a=es.get(parseInt(o)),c=this.parseGeometry(a,i[o],e);n.set(parseInt(o),c)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),n}parseGeometry(e,n,i){switch(n.attrType){case"Mesh":return this.parseMeshGeometry(e,n,i);case"NurbsCurve":return this.parseNurbsGeometry(n)}}parseMeshGeometry(e,n,i){const o=i.skeletons,a=[],c=e.parents.map(function(p){return Zi.Objects.Model[p.ID]});if(c.length===0)return;const u=e.children.reduce(function(p,A){return o[A.ID]!==void 0&&(p=o[A.ID]),p},null);e.children.forEach(function(p){i.morphTargets[p.ID]!==void 0&&a.push(i.morphTargets[p.ID])});const h=c[0],d={};"RotationOrder"in h&&(d.eulerOrder=NI(h.RotationOrder.value)),"InheritType"in h&&(d.inheritType=parseInt(h.InheritType.value)),"GeometricTranslation"in h&&(d.translation=h.GeometricTranslation.value),"GeometricRotation"in h&&(d.rotation=h.GeometricRotation.value),"GeometricScaling"in h&&(d.scale=h.GeometricScaling.value);const f=FI(d);return this.genGeometry(n,u,a,f)}genGeometry(e,n,i,o){const a=new Jp;e.attrName&&(a.name=e.attrName);const c=this.parseGeoNode(e,n),u=this.genBuffers(c),h=new zc(u.vertex,3);if(h.applyMatrix4(o),a.setAttribute("position",h),u.colors.length>0&&a.setAttribute("color",new zc(u.colors,3)),n&&(a.setAttribute("skinIndex",new AI(u.weightsIndices,4)),a.setAttribute("skinWeight",new zc(u.vertexWeights,4)),a.FBX_Deformer=n),u.normal.length>0){const d=new Zc().getNormalMatrix(o),f=new zc(u.normal,3);f.applyNormalMatrix(d),a.setAttribute("normal",f)}if(u.uvs.forEach(function(d,f){const p=f===0?"uv":`uv${f}`;a.setAttribute(p,new zc(u.uvs[f],2))}),c.material&&c.material.mappingType!=="AllSame"){let d=u.materialIndex[0],f=0;if(u.materialIndex.forEach(function(p,A){p!==d&&(a.addGroup(f,A-f,d),d=p,f=A)}),a.groups.length>0){const p=a.groups[a.groups.length-1],A=p.start+p.count;A!==u.materialIndex.length&&a.addGroup(A,u.materialIndex.length-A,d)}a.groups.length===0&&a.addGroup(0,u.materialIndex.length,u.materialIndex[0])}return this.addMorphTargets(a,e,i,o),a}parseGeoNode(e,n){const i={};if(i.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],i.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let o=0;for(;e.LayerElementUV[o];)e.LayerElementUV[o].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[o])),o++}return i.weightTable={},n!==null&&(i.skeleton=n,n.rawBones.forEach(function(o,a){o.indices.forEach(function(c,u){i.weightTable[c]===void 0&&(i.weightTable[c]=[]),i.weightTable[c].push({id:a,weight:o.weights[u]})})})),i}genBuffers(e){const n={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,o=0,a=!1,c=[],u=[],h=[],d=[],f=[],p=[];const A=this;return e.vertexIndices.forEach(function(g,v){let b,x=!1;g<0&&(g=g^-1,x=!0);let E=[],S=[];if(c.push(g*3,g*3+1,g*3+2),e.color){const M=FA(v,i,g,e.color);h.push(M[0],M[1],M[2])}if(e.skeleton){if(e.weightTable[g]!==void 0&&e.weightTable[g].forEach(function(M){S.push(M.weight),E.push(M.id)}),S.length>4){a||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),a=!0);const M=[0,0,0,0],C=[0,0,0,0];S.forEach(function(T,L){let B=T,F=E[L];C.forEach(function(D,P,U){if(B>D){U[P]=B,B=D;const K=M[P];M[P]=F,F=K}})}),E=M,S=C}for(;S.length<4;)S.push(0),E.push(0);for(let M=0;M<4;++M)f.push(S[M]),p.push(E[M])}if(e.normal){const M=FA(v,i,g,e.normal);u.push(M[0],M[1],M[2])}e.material&&e.material.mappingType!=="AllSame"&&(b=FA(v,i,g,e.material)[0],b<0&&(A.negativeMaterialIndices=!0,b=0)),e.uv&&e.uv.forEach(function(M,C){const T=FA(v,i,g,M);d[C]===void 0&&(d[C]=[]),d[C].push(T[0]),d[C].push(T[1])}),o++,x&&(A.genFace(n,e,c,b,u,h,d,f,p,o),i++,o=0,c=[],u=[],h=[],d=[],f=[],p=[])}),n}getNormalNewell(e){const n=new Mt(0,0,0);for(let i=0;i<e.length;i++){const o=e[i],a=e[(i+1)%e.length];n.x+=(o.y-a.y)*(o.z+a.z),n.y+=(o.z-a.z)*(o.x+a.x),n.z+=(o.x-a.x)*(o.y+a.y)}return n.normalize(),n}getNormalTangentAndBitangent(e){const n=this.getNormalNewell(e),o=(Math.abs(n.z)>.5?new Mt(0,1,0):new Mt(0,0,1)).cross(n).normalize(),a=n.clone().cross(o).normalize();return{normal:n,tangent:o,bitangent:a}}flattenVertex(e,n,i){return new gs(e.dot(n),e.dot(i))}genFace(e,n,i,o,a,c,u,h,d,f){let p;if(f>3){const A=[];for(let x=0;x<i.length;x+=3)A.push(new Mt(n.vertexPositions[i[x]],n.vertexPositions[i[x+1]],n.vertexPositions[i[x+2]]));const{tangent:g,bitangent:v}=this.getNormalTangentAndBitangent(A),b=[];for(const x of A)b.push(this.flattenVertex(x,g,v));p=P_.triangulateShape(b,[])}else p=[[0,1,2]];for(const[A,g,v]of p)e.vertex.push(n.vertexPositions[i[A*3]]),e.vertex.push(n.vertexPositions[i[A*3+1]]),e.vertex.push(n.vertexPositions[i[A*3+2]]),e.vertex.push(n.vertexPositions[i[g*3]]),e.vertex.push(n.vertexPositions[i[g*3+1]]),e.vertex.push(n.vertexPositions[i[g*3+2]]),e.vertex.push(n.vertexPositions[i[v*3]]),e.vertex.push(n.vertexPositions[i[v*3+1]]),e.vertex.push(n.vertexPositions[i[v*3+2]]),n.skeleton&&(e.vertexWeights.push(h[A*4]),e.vertexWeights.push(h[A*4+1]),e.vertexWeights.push(h[A*4+2]),e.vertexWeights.push(h[A*4+3]),e.vertexWeights.push(h[g*4]),e.vertexWeights.push(h[g*4+1]),e.vertexWeights.push(h[g*4+2]),e.vertexWeights.push(h[g*4+3]),e.vertexWeights.push(h[v*4]),e.vertexWeights.push(h[v*4+1]),e.vertexWeights.push(h[v*4+2]),e.vertexWeights.push(h[v*4+3]),e.weightsIndices.push(d[A*4]),e.weightsIndices.push(d[A*4+1]),e.weightsIndices.push(d[A*4+2]),e.weightsIndices.push(d[A*4+3]),e.weightsIndices.push(d[g*4]),e.weightsIndices.push(d[g*4+1]),e.weightsIndices.push(d[g*4+2]),e.weightsIndices.push(d[g*4+3]),e.weightsIndices.push(d[v*4]),e.weightsIndices.push(d[v*4+1]),e.weightsIndices.push(d[v*4+2]),e.weightsIndices.push(d[v*4+3])),n.color&&(e.colors.push(c[A*3]),e.colors.push(c[A*3+1]),e.colors.push(c[A*3+2]),e.colors.push(c[g*3]),e.colors.push(c[g*3+1]),e.colors.push(c[g*3+2]),e.colors.push(c[v*3]),e.colors.push(c[v*3+1]),e.colors.push(c[v*3+2])),n.material&&n.material.mappingType!=="AllSame"&&(e.materialIndex.push(o),e.materialIndex.push(o),e.materialIndex.push(o)),n.normal&&(e.normal.push(a[A*3]),e.normal.push(a[A*3+1]),e.normal.push(a[A*3+2]),e.normal.push(a[g*3]),e.normal.push(a[g*3+1]),e.normal.push(a[g*3+2]),e.normal.push(a[v*3]),e.normal.push(a[v*3+1]),e.normal.push(a[v*3+2])),n.uv&&n.uv.forEach(function(b,x){e.uvs[x]===void 0&&(e.uvs[x]=[]),e.uvs[x].push(u[x][A*2]),e.uvs[x].push(u[x][A*2+1]),e.uvs[x].push(u[x][g*2]),e.uvs[x].push(u[x][g*2+1]),e.uvs[x].push(u[x][v*2]),e.uvs[x].push(u[x][v*2+1])})}addMorphTargets(e,n,i,o){if(i.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const a=this;i.forEach(function(c){c.rawTargets.forEach(function(u){const h=Zi.Objects.Geometry[u.geoID];h!==void 0&&a.genMorphGeometry(e,n,h,o,u.name)})})}genMorphGeometry(e,n,i,o,a){const c=n.PolygonVertexIndex!==void 0?n.PolygonVertexIndex.a:[],u=i.Vertices!==void 0?i.Vertices.a:[],h=i.Indexes!==void 0?i.Indexes.a:[],d=e.attributes.position.count*3,f=new Float32Array(d);for(let v=0;v<h.length;v++){const b=h[v]*3;f[b]=u[v*3],f[b+1]=u[v*3+1],f[b+2]=u[v*3+2]}const p={vertexIndices:c,vertexPositions:f},A=this.genBuffers(p),g=new zc(A.vertex,3);g.name=a||i.attrName,g.applyMatrix4(o),e.morphAttributes.position.push(g)}parseNormals(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,o=e.Normals.a;let a=[];return i==="IndexToDirect"&&("NormalIndex"in e?a=e.NormalIndex.a:"NormalsIndex"in e&&(a=e.NormalsIndex.a)),{dataSize:3,buffer:o,indices:a,mappingType:n,referenceType:i}}parseUVs(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,o=e.UV.a;let a=[];return i==="IndexToDirect"&&(a=e.UVIndex.a),{dataSize:2,buffer:o,indices:a,mappingType:n,referenceType:i}}parseVertexColors(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,o=e.Colors.a;let a=[];i==="IndexToDirect"&&(a=e.ColorIndex.a);for(let c=0,u=new as;c<o.length;c+=4)u.fromArray(o,c).convertSRGBToLinear().toArray(o,c);return{dataSize:4,buffer:o,indices:a,mappingType:n,referenceType:i}}parseMaterialIndices(e){const n=e.MappingInformationType,i=e.ReferenceInformationType;if(n==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const o=e.Materials.a,a=[];for(let c=0;c<o.length;++c)a.push(c);return{dataSize:1,buffer:o,indices:a,mappingType:n,referenceType:i}}parseNurbsGeometry(e){const n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Jp;const i=n-1,o=e.KnotVector.a,a=[],c=e.Points.a;for(let p=0,A=c.length;p<A;p+=4)a.push(new To().fromArray(c,p));let u,h;if(e.Form==="Closed")a.push(a[0]);else if(e.Form==="Periodic"){u=i,h=o.length-1-u;for(let p=0;p<i;++p)a.push(a[p])}const f=new H6(i,o,a,u,h).getPoints(a.length*12);return new Jp().setFromPoints(f)}}class X6{parse(){const e=[],n=this.parseClips();if(n!==void 0)for(const i in n){const o=n[i],a=this.addClip(o);e.push(a)}return e}parseClips(){if(Zi.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const n=this.parseAnimationLayers(e);return this.parseAnimStacks(n)}parseAnimationCurveNodes(){const e=Zi.Objects.AnimationCurveNode,n=new Map;for(const i in e){const o=e[i];if(o.attrName.match(/S|R|T|DeformPercent/)!==null){const a={id:o.id,attr:o.attrName,curves:{}};n.set(a.id,a)}}return n}parseAnimationCurves(e){const n=Zi.Objects.AnimationCurve;for(const i in n){const o={id:n[i].id,times:n[i].KeyTime.a.map(J6),values:n[i].KeyValueFloat.a},a=es.get(o.id);if(a!==void 0){const c=a.parents[0].ID,u=a.parents[0].relationship;u.match(/X/)?e.get(c).curves.x=o:u.match(/Y/)?e.get(c).curves.y=o:u.match(/Z/)?e.get(c).curves.z=o:u.match(/DeformPercent/)&&e.has(c)&&(e.get(c).curves.morph=o)}}}parseAnimationLayers(e){const n=Zi.Objects.AnimationLayer,i=new Map;for(const o in n){const a=[],c=es.get(parseInt(o));c!==void 0&&(c.children.forEach(function(h,d){if(e.has(h.ID)){const f=e.get(h.ID);if(f.curves.x!==void 0||f.curves.y!==void 0||f.curves.z!==void 0){if(a[d]===void 0){const p=es.get(h.ID).parents.filter(function(A){return A.relationship!==void 0})[0].ID;if(p!==void 0){const A=Zi.Objects.Model[p.toString()];if(A===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",h);return}const g={modelName:A.attrName?Ar.sanitizeNodeName(A.attrName):"",ID:A.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};co.traverse(function(v){v.ID===A.id&&(g.transform=v.matrix,v.userData.transformData&&(g.eulerOrder=v.userData.transformData.eulerOrder))}),g.transform||(g.transform=new Ii),"PreRotation"in A&&(g.preRotation=A.PreRotation.value),"PostRotation"in A&&(g.postRotation=A.PostRotation.value),a[d]=g}}a[d]&&(a[d][f.attr]=f)}else if(f.curves.morph!==void 0){if(a[d]===void 0){const p=es.get(h.ID).parents.filter(function(E){return E.relationship!==void 0})[0].ID,A=es.get(p).parents[0].ID,g=es.get(A).parents[0].ID,v=es.get(g).parents[0].ID,b=Zi.Objects.Model[v],x={modelName:b.attrName?Ar.sanitizeNodeName(b.attrName):"",morphName:Zi.Objects.Deformer[p].attrName};a[d]=x}a[d][f.attr]=f}}}),i.set(parseInt(o),a))}return i}parseAnimStacks(e){const n=Zi.Objects.AnimationStack,i={};for(const o in n){const a=es.get(parseInt(o)).children;a.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const c=e.get(a[0].ID);i[o]={name:n[o].attrName,layer:c}}return i}addClip(e){let n=[];const i=this;return e.layer.forEach(function(o){n=n.concat(i.generateTracks(o))}),new $k(e.name,-1,n)}generateTracks(e){const n=[];let i=new Mt,o=new Mt;if(e.transform&&e.transform.decompose(i,new So,o),i=i.toArray(),o=o.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");a!==void 0&&n.push(a)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const a=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);a!==void 0&&n.push(a)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.S.curves,o,"scale");a!==void 0&&n.push(a)}if(e.DeformPercent!==void 0){const a=this.generateMorphTrack(e);a!==void 0&&n.push(a)}return n}generateVectorTrack(e,n,i,o){const a=this.getTimesForAllAxes(n),c=this.getKeyframeTrackValues(a,n,i);return new dm(e+"."+o,a,c)}generateRotationTrack(e,n,i,o,a){let c,u;if(n.x!==void 0&&n.y!==void 0&&n.z!==void 0){const p=this.interpolateRotations(n.x,n.y,n.z,a);c=p[0],u=p[1]}i!==void 0&&(i=i.map(uo.degToRad),i.push(a),i=new ra().fromArray(i),i=new So().setFromEuler(i)),o!==void 0&&(o=o.map(uo.degToRad),o.push(a),o=new ra().fromArray(o),o=new So().setFromEuler(o).invert());const h=new So,d=new ra,f=[];if(!u||!c)return new ou(e+".quaternion",[],[]);for(let p=0;p<u.length;p+=3)d.set(u[p],u[p+1],u[p+2],a),h.setFromEuler(d),i!==void 0&&h.premultiply(i),o!==void 0&&h.multiply(o),p>2&&new So().fromArray(f,(p-3)/3*4).dot(h)<0&&h.set(-h.x,-h.y,-h.z,-h.w),h.toArray(f,p/3*4);return new ou(e+".quaternion",c,f)}generateMorphTrack(e){const n=e.DeformPercent.curves.morph,i=n.values.map(function(a){return a/100}),o=co.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new um(e.modelName+".morphTargetInfluences["+o+"]",n.times,i)}getTimesForAllAxes(e){let n=[];if(e.x!==void 0&&(n=n.concat(e.x.times)),e.y!==void 0&&(n=n.concat(e.y.times)),e.z!==void 0&&(n=n.concat(e.z.times)),n=n.sort(function(i,o){return i-o}),n.length>1){let i=1,o=n[0];for(let a=1;a<n.length;a++){const c=n[a];c!==o&&(n[i]=c,o=c,i++)}n=n.slice(0,i)}return n}getKeyframeTrackValues(e,n,i){const o=i,a=[];let c=-1,u=-1,h=-1;return e.forEach(function(d){if(n.x&&(c=n.x.times.indexOf(d)),n.y&&(u=n.y.times.indexOf(d)),n.z&&(h=n.z.times.indexOf(d)),c!==-1){const f=n.x.values[c];a.push(f),o[0]=f}else a.push(o[0]);if(u!==-1){const f=n.y.values[u];a.push(f),o[1]=f}else a.push(o[1]);if(h!==-1){const f=n.z.values[h];a.push(f),o[2]=f}else a.push(o[2])}),a}interpolateRotations(e,n,i,o){const a=[],c=[];a.push(e.times[0]),c.push(uo.degToRad(e.values[0])),c.push(uo.degToRad(n.values[0])),c.push(uo.degToRad(i.values[0]));for(let u=1;u<e.values.length;u++){const h=[e.values[u-1],n.values[u-1],i.values[u-1]];if(isNaN(h[0])||isNaN(h[1])||isNaN(h[2]))continue;const d=h.map(uo.degToRad),f=[e.values[u],n.values[u],i.values[u]];if(isNaN(f[0])||isNaN(f[1])||isNaN(f[2]))continue;const p=f.map(uo.degToRad),A=[f[0]-h[0],f[1]-h[1],f[2]-h[2]],g=[Math.abs(A[0]),Math.abs(A[1]),Math.abs(A[2])];if(g[0]>=180||g[1]>=180||g[2]>=180){const b=Math.max(...g)/180,x=new ra(...d,o),E=new ra(...p,o),S=new So().setFromEuler(x),M=new So().setFromEuler(E);S.dot(M)&&M.set(-M.x,-M.y,-M.z,-M.w);const C=e.times[u-1],T=e.times[u]-C,L=new So,B=new ra;for(let F=0;F<1;F+=1/b)L.copy(S.clone().slerp(M.clone(),F)),a.push(C+F*T),B.setFromQuaternion(L,o),c.push(B.x),c.push(B.y),c.push(B.z)}else a.push(e.times[u]),c.push(uo.degToRad(e.values[u])),c.push(uo.degToRad(n.values[u])),c.push(uo.degToRad(i.values[u]))}return[a,c]}}class K6{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,n){this.currentProp=e,this.currentPropName=n}parse(e){this.currentIndent=0,this.allNodes=new OI,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const n=this,i=e.split(/[\r\n]+/);return i.forEach(function(o,a){const c=o.match(/^[\s\t]*;/),u=o.match(/^[\s\t]*$/);if(c||u)return;const h=o.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),d=o.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),f=o.match("^\\t{"+(n.currentIndent-1)+"}}");h?n.parseNodeBegin(o,h):d?n.parseNodeProperty(o,d,i[++a]):f?n.popStack():o.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(o)}),this.allNodes}parseNodeBegin(e,n){const i=n[1].trim().replace(/^"/,"").replace(/"$/,""),o=n[2].split(",").map(function(h){return h.trim().replace(/^"/,"").replace(/"$/,"")}),a={name:i},c=this.parseNodeAttr(o),u=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(i,a):i in u?(i==="PoseNode"?u.PoseNode.push(a):u[i].id!==void 0&&(u[i]={},u[i][u[i].id]=u[i]),c.id!==""&&(u[i][c.id]=a)):typeof c.id=="number"?(u[i]={},u[i][c.id]=a):i!=="Properties70"&&(i==="PoseNode"?u[i]=[a]:u[i]=a),typeof c.id=="number"&&(a.id=c.id),c.name!==""&&(a.attrName=c.name),c.type!==""&&(a.attrType=c.type),this.pushStack(a)}parseNodeAttr(e){let n=e[0];e[0]!==""&&(n=parseInt(e[0]),isNaN(n)&&(n=e[0]));let i="",o="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),o=e[2]),{id:n,name:i,type:o}}parseNodeProperty(e,n,i){let o=n[1].replace(/^"/,"").replace(/"$/,"").trim(),a=n[2].replace(/^"/,"").replace(/"$/,"").trim();o==="Content"&&a===","&&(a=i.replace(/"/g,"").replace(/,$/,"").trim());const c=this.getCurrentNode();if(c.name==="Properties70"){this.parseNodeSpecialProperty(e,o,a);return}if(o==="C"){const h=a.split(",").slice(1),d=parseInt(h[0]),f=parseInt(h[1]);let p=a.split(",").slice(3);p=p.map(function(A){return A.trim().replace(/^"/,"")}),o="connections",a=[d,f],e8(a,p),c[o]===void 0&&(c[o]=[])}o==="Node"&&(c.id=a),o in c&&Array.isArray(c[o])?c[o].push(a):o!=="a"?c[o]=a:c.a=a,this.setCurrentProp(c,o),o==="a"&&a.slice(-1)!==","&&(c.a=U1(a))}parseNodePropertyContinued(e){const n=this.getCurrentNode();n.a+=e,e.slice(-1)!==","&&(n.a=U1(n.a))}parseNodeSpecialProperty(e,n,i){const o=i.split('",').map(function(f){return f.trim().replace(/^\"/,"").replace(/\s/,"_")}),a=o[0],c=o[1],u=o[2],h=o[3];let d=o[4];switch(c){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":d=parseFloat(d);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":d=U1(d);break}this.getPrevNode()[a]={type:c,type2:u,flag:h,value:d},this.setCurrentProp(this.getPrevNode(),a)}}class q6{parse(e){const n=new gS(e);n.skip(23);const i=n.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const o=new OI;for(;!this.endOfContent(n);){const a=this.parseNode(n,i);a!==null&&o.add(a.name,a)}return o}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,n){const i={},o=n>=7500?e.getUint64():e.getUint32(),a=n>=7500?e.getUint64():e.getUint32();n>=7500?e.getUint64():e.getUint32();const c=e.getUint8(),u=e.getString(c);if(o===0)return null;const h=[];for(let A=0;A<a;A++)h.push(this.parseProperty(e));const d=h.length>0?h[0]:"",f=h.length>1?h[1]:"",p=h.length>2?h[2]:"";for(i.singleProperty=a===1&&e.getOffset()===o;o>e.getOffset();){const A=this.parseNode(e,n);A!==null&&this.parseSubNode(u,i,A)}return i.propertyList=h,typeof d=="number"&&(i.id=d),f!==""&&(i.attrName=f),p!==""&&(i.attrType=p),u!==""&&(i.name=u),i}parseSubNode(e,n,i){if(i.singleProperty===!0){const o=i.propertyList[0];Array.isArray(o)?(n[i.name]=i,i.a=o):n[i.name]=o}else if(e==="Connections"&&i.name==="C"){const o=[];i.propertyList.forEach(function(a,c){c!==0&&o.push(a)}),n.connections===void 0&&(n.connections=[]),n.connections.push(o)}else if(i.name==="Properties70")Object.keys(i).forEach(function(a){n[a]=i[a]});else if(e==="Properties70"&&i.name==="P"){let o=i.propertyList[0],a=i.propertyList[1];const c=i.propertyList[2],u=i.propertyList[3];let h;o.indexOf("Lcl ")===0&&(o=o.replace("Lcl ","Lcl_")),a.indexOf("Lcl ")===0&&(a=a.replace("Lcl ","Lcl_")),a==="Color"||a==="ColorRGB"||a==="Vector"||a==="Vector3D"||a.indexOf("Lcl_")===0?h=[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:h=i.propertyList[4],n[o]={type:a,type2:c,flag:u,value:h}}else n[i.name]===void 0?typeof i.id=="number"?(n[i.name]={},n[i.name][i.id]=i):n[i.name]=i:i.name==="PoseNode"?(Array.isArray(n[i.name])||(n[i.name]=[n[i.name]]),n[i.name].push(i)):n[i.name][i.id]===void 0&&(n[i.name][i.id]=i)}parseProperty(e){const n=e.getString(1);let i;switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const o=e.getUint32(),a=e.getUint32(),c=e.getUint32();if(a===0)switch(n){case"b":case"c":return e.getBooleanArray(o);case"d":return e.getFloat64Array(o);case"f":return e.getFloat32Array(o);case"i":return e.getInt32Array(o);case"l":return e.getInt64Array(o)}const u=P6(new Uint8Array(e.getArrayBuffer(c))),h=new gS(u.buffer);switch(n){case"b":case"c":return h.getBooleanArray(o);case"d":return h.getFloat64Array(o);case"f":return h.getFloat32Array(o);case"i":return h.getInt32Array(o);case"l":return h.getInt64Array(o)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}class gS{constructor(e,n){this.dv=new DataView(e),this.offset=0,this.littleEndian=n!==void 0?n:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const n=[];for(let i=0;i<e;i++)n.push(this.getBoolean());return n}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getInt32());return n}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n&2147483648?(n=~n&4294967295,e=~e&4294967295,e===4294967295&&(n=n+1&4294967295),e=e+1&4294967295,-(n*4294967296+e)):n*4294967296+e}getInt64Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getInt64());return n}getUint64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getFloat32());return n}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getFloat64());return n}getArrayBuffer(e){const n=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}getString(e){const n=this.offset;let i=new Uint8Array(this.dv.buffer,n,e);this.skip(e);const o=i.indexOf(0);return o>=0&&(i=new Uint8Array(this.dv.buffer,n,o)),this._textDecoder.decode(i)}}class OI{add(e,n){this[e]=n}}function Y6(s){const e="Kaydara FBX Binary  \0";return s.byteLength>=e.length&&e===UI(s,0,e.length)}function $6(s){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function i(o){const a=s[o-1];return s=s.slice(n+o),n++,a}for(let o=0;o<e.length;++o)if(i(1)===e[o])return!1;return!0}function AS(s){const e=/FBXVersion: (\d+)/,n=s.match(e);if(n)return parseInt(n[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function J6(s){return s/46186158e3}const Z6=[];function FA(s,e,n,i){let o;switch(i.mappingType){case"ByPolygonVertex":o=s;break;case"ByPolygon":o=e;break;case"ByVertice":o=n;break;case"AllSame":o=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}i.referenceType==="IndexToDirect"&&(o=i.indices[o]);const a=o*i.dataSize,c=a+i.dataSize;return t8(Z6,i.buffer,a,c)}const N1=new ra,ad=new Mt;function FI(s){const e=new Ii,n=new Ii,i=new Ii,o=new Ii,a=new Ii,c=new Ii,u=new Ii,h=new Ii,d=new Ii,f=new Ii,p=new Ii,A=new Ii,g=s.inheritType?s.inheritType:0;if(s.translation&&e.setPosition(ad.fromArray(s.translation)),s.preRotation){const P=s.preRotation.map(uo.degToRad);P.push(s.eulerOrder||ra.DEFAULT_ORDER),n.makeRotationFromEuler(N1.fromArray(P))}if(s.rotation){const P=s.rotation.map(uo.degToRad);P.push(s.eulerOrder||ra.DEFAULT_ORDER),i.makeRotationFromEuler(N1.fromArray(P))}if(s.postRotation){const P=s.postRotation.map(uo.degToRad);P.push(s.eulerOrder||ra.DEFAULT_ORDER),o.makeRotationFromEuler(N1.fromArray(P)),o.invert()}s.scale&&a.scale(ad.fromArray(s.scale)),s.scalingOffset&&u.setPosition(ad.fromArray(s.scalingOffset)),s.scalingPivot&&c.setPosition(ad.fromArray(s.scalingPivot)),s.rotationOffset&&h.setPosition(ad.fromArray(s.rotationOffset)),s.rotationPivot&&d.setPosition(ad.fromArray(s.rotationPivot)),s.parentMatrixWorld&&(p.copy(s.parentMatrix),f.copy(s.parentMatrixWorld));const v=n.clone().multiply(i).multiply(o),b=new Ii;b.extractRotation(f);const x=new Ii;x.copyPosition(f);const E=x.clone().invert().multiply(f),S=b.clone().invert().multiply(E),M=a,C=new Ii;if(g===0)C.copy(b).multiply(v).multiply(S).multiply(M);else if(g===1)C.copy(b).multiply(S).multiply(v).multiply(M);else{const U=new Ii().scale(new Mt().setFromMatrixScale(p)).clone().invert(),K=S.clone().multiply(U);C.copy(b).multiply(v).multiply(K).multiply(M)}const T=d.clone().invert(),L=c.clone().invert();let B=e.clone().multiply(h).multiply(d).multiply(n).multiply(i).multiply(o).multiply(T).multiply(u).multiply(c).multiply(a).multiply(L);const F=new Ii().copyPosition(B),D=f.clone().multiply(F);return A.copyPosition(D),B=A.clone().multiply(C),B.premultiply(f.invert()),B}function NI(s){s=s||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return s===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[s]}function U1(s){return s.split(",").map(function(n){return parseFloat(n)})}function UI(s,e,n){return e===void 0&&(e=0),n===void 0&&(n=s.byteLength),new TextDecoder().decode(new Uint8Array(s,e,n))}function e8(s,e){for(let n=0,i=s.length,o=e.length;n<o;n++,i++)s[i]=e[n]}function t8(s,e,n,i){for(let o=n,a=0;o<i;o++,a++)s[a]=e[o];return s}THREE.FBXLoader=j6;AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const s=this.data;if(!s.src)return;this.remove();const e=new THREE.FBXLoader;s.crossorigin&&e.setCrossOrigin(s.crossorigin),e.load(s.src,this.load.bind(this))},load:function(s){this.model=s,this.el.setObject3D("mesh",s),this.el.emit("model-loaded",{format:"fbx",model:s})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});function n8(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function i8(s,e){var n=document.createElement("script");return n.type="text/javascript",n.async=!0,n.id=e,n.src=s,n}function k1(s){const e=document.getElementById(s),n=e.parentNode;try{n&&n.removeChild(e)}catch{}}function r8(s){const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(s,e)}function s8(s,e,n){return new n(function(i,o){const a=e.timeout||5e3,c=n8(),u=i8(s,c),h=setTimeout(function(){o(new Error("Script request to "+s+" timed out")),k1(c)},a),d=function(f){clearTimeout(f)};u.addEventListener("load",function(f){i({ok:!0}),d(h),k1(c)}),u.addEventListener("error",function(f){o(new Error("Script request to "+s+" failed "+f)),d(h),k1(c)}),r8(u)})}function o8(s){return s=s||{},function(e,n){return n=n||{},s8(e,n,s.Promise||Promise)}}var a8=o8;const l8=a8(),c8="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",h8=function(){let s;return function(){return s=s||l8(c8),s}}();AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=h8().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const s=this,e=this.el,n=this.data;n&&(this.remove(),this.loaderPromise.then(()=>{this.loader.load(n,function(o){s.model=o.scene,s.model.animations=o.animations,e.setObject3D("mesh",s.model),e.emit("model-loaded",{format:"gltf",model:s.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let s;const e=this.data;e.src&&(this.remove(),s=new THREE.ObjectLoader,e.crossorigin&&s.setCrossOrigin(e.crossorigin),s.load(e.src,n=>{n.traverse(i=>{i instanceof THREE.SkinnedMesh&&i.material&&(i.material.skinning=!!(i.geometry&&i.geometry.bones||[]).length)}),this.load(n)}))},load:function(s){this.model=s,this.el.setObject3D("mesh",s),this.el.emit("model-loaded",{format:"json",model:s})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const s=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!s)throw new Error("No `checkpoint-controls` component found.");s.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}});function u8(s){return s?Array.isArray(s)?s:s.materials?s.materials:[s]:[]}function pp(s,e,n,i){s&&(e=e||[],s.traverse(o=>{if(!o.isMesh)return;u8(o.material).forEach(c=>{c&&!("envMap"in c)||e.length&&e.indexOf(c.name)===-1||(c.envMap=n,c.reflectivity=i,c.needsUpdate=!0)})}))}AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const s=this.data;this.texture=new THREE.CubeTextureLoader().load([s.path+"posx."+s.extension,s.path+"negx."+s.extension,s.path+"posy."+s.extension,s.path+"negy."+s.extension,s.path+"posz."+s.extension,s.path+"negz."+s.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{const e=this.el.getObject3D("mesh"),n=this.data;pp(e,n.materials,this.texture,n.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(s){const e=this.data,n=this.el.getObject3D("mesh");let i=[],o=[];if(e.materials.length&&(s.materials?(i=e.materials.filter(a=>!s.materials.includes(a)),o=s.materials.filter(a=>!e.materials.includes(a))):i=e.materials),i.length&&pp(n,i,this.texture,e.reflectivity),o.length&&pp(n,o,null,1),s.materials&&e.reflectivity!==s.reflectivity){const a=e.materials.filter(c=>s.materials.includes(c));a.length&&pp(n,a,this.texture,e.reflectivity)}this.data.enableBackground&&!s.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&s.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const s=this.el.getObject3D("mesh"),e=this.data;pp(s,e.materials,null,1),e.enableBackground&&this.setBackground(null)},setBackground:function(s){this.el.sceneEl.object3D.background=s}});AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const s=this.el;s.addEventListener("hit",this.onHit),s.addEventListener("gripdown",this.onGripClose),s.addEventListener("gripup",this.onGripOpen),s.addEventListener("trackpaddown",this.onGripClose),s.addEventListener("trackpadup",this.onGripOpen),s.addEventListener("triggerdown",this.onGripClose),s.addEventListener("triggerup",this.onGripOpen)},pause:function(){const s=this.el;s.removeEventListener("hit",this.onHit),s.removeEventListener("gripdown",this.onGripClose),s.removeEventListener("gripup",this.onGripOpen),s.removeEventListener("trackpaddown",this.onGripClose),s.removeEventListener("trackpadup",this.onGripOpen),s.removeEventListener("triggerdown",this.onGripClose),s.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const s=this.hitEl;this.grabbing=!1,s&&(s.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(s){const e=s.detail.el;e.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(e.addState(this.GRABBED_STATE),this.hitEl=e,this.constraint=new CANNON.LockConstraint(this.el.body,e.body),this.system.addConstraint(this.constraint))}});AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(s=>{s.isMesh&&(s.material=this.material)})}});AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){const s=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(s,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const s=this.data;let e;s.objects?e=this.el.sceneEl.querySelectorAll(s.objects):e=this.el.sceneEl.children,this.els=Array.prototype.slice.call(e)},tick:function(){const s=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Box3,a=[],c=new Map;return function(u){if(!this.data.enabled)return;const h=this.prevCheckTime;if(h&&u-h<this.data.interval)return;this.prevCheckTime=u;const d=this.el,f=this.data,p=d.getObject3D("mesh");let A;if(!p)return;a.length=0,c.clear(),d.object3D.getWorldPosition(s),d.object3D.getWorldScale(n),A=f.radius*v(n),this.els.forEach(g),a.sort((b,x)=>c.get(b)>c.get(x)?1:-1).forEach(this.handleHit),this.collisions.filter(b=>!c.has(b)).forEach(this.handleHitEnd),d8(this.collisions,a);function g(b){let x,E,S,M;b.isEntity&&(E=b.getObject3D("mesh"),E&&(o.setFromObject(E).getSize(i),M=Math.max(i.x,i.y,i.z)/2,x=Math.sqrt(2*M*M),o.getCenter(e),x&&(S=s.distanceTo(e),S<x+A&&(a.push(b),c.set(b,S)))))}function v(b){return Math.max(b.x,b.y,b.z)}}}(),handleHit:function(s){s.emit("hit"),s.addState(this.data.state),this.eventDetail.el=s,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(s){s.emit("hitend"),s.removeState(this.data.state),this.eventDetail.el=s,this.el.emit("hitend",this.eventDetail)}});function d8(s,e){s.length=0;for(let n=0;n<e.length;n++)s[n]=e[n]}AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var s=this;const e=this.el.getObject3D("mesh");if(this.el.sceneEl.object3D,!e)return;let n;if(e.traverse(o=>{o.isMesh&&(!s.nodeName||o.name===s.nodeName)&&(n=o)}),!n)return;const i=n.geometry.clone();n.updateWorldMatrix(!0,!1),i.applyMatrix4(n.matrixWorld),this.system.setNavMeshGeometry(i),this.hasLoadedNavMesh=!0}});AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const s=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(i,o){const a=this.el,c=this.data,u=this.raycaster,h=c.speed*o/1e3;if(!c.active)return;if(!this.path.length){const v=this.el.object3D.position;this.group=this.group||this.system.getGroup(v),this.path=this.system.getPath(v,s.copy(c.destination),this.group)||[],a.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",c.destination),this.el.setAttribute("nav-agent",{active:!1}),a.emit("navigation-end");return}const d=a.object3D.position,f=this.path[0];e.subVectors(f,d);const p=e.length();let A;if(p<h){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),a.emit("navigation-end");return}n.copy(d),A=this.path[0]}else n.copy(e.setLength(h)).add(d),A=f;A.y=d.y,a.object3D.lookAt(A),u.ray.origin.copy(n),u.ray.origin.y+=1.5,u.ray.direction={x:0,y:-1,z:0};const g=u.intersectObject(this.system.getNavMesh());g.length?(e.subVectors(g[0].point,d),d.add(e.setLength(h))):d.copy(n)}}()});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const kI="159",Rb=0,f8=1,vS=1,yS=100,xS=204,ES=205,bS=3,p8=0,zI=300,_S=1e3,NA=1001,wS=1002,MS=1003,m8=1006,g8=1008,A8=1009,v8=1014,y8=1015,x8=1020,E8=1023,z1=1026,CS=1027,b8=3e3,G1=3001,Y0="",Ia="srgb",N_="srgb-linear",_8="display-p3",GI="display-p3-linear",Ib="linear",SS="srgb",TS="rec709",RS="p3",ld=7680,IS=519,w8=515,BS=35044,UA=2e3,LS=2001;let Gv=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const o=this._listeners[e];if(o!==void 0){const a=o.indexOf(n);a!==-1&&o.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const o=i.slice(0);for(let a=0,c=o.length;a<c;a++)o[a].call(this,e);e.target=null}}};const Xs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function wm(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Xs[s&255]+Xs[s>>8&255]+Xs[s>>16&255]+Xs[s>>24&255]+"-"+Xs[e&255]+Xs[e>>8&255]+"-"+Xs[e>>16&15|64]+Xs[e>>24&255]+"-"+Xs[n&63|128]+Xs[n>>8&255]+"-"+Xs[n>>16&255]+Xs[n>>24&255]+Xs[i&255]+Xs[i>>8&255]+Xs[i>>16&255]+Xs[i>>24&255]).toLowerCase()}function Ro(s,e,n){return Math.max(e,Math.min(n,s))}function M8(s,e){return(s%e+e)%e}function V1(s,e,n){return(1-n)*s+n*e}function mp(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function Co(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}let ca=class VI{constructor(e=0,n=0){VI.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6],this.y=o[1]*n+o[4]*i+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Ro(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),o=Math.sin(n),a=this.x-e.x,c=this.y-e.y;return this.x=a*i-c*o+e.x,this.y=a*o+c*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},cu=class HI{constructor(e,n,i,o,a,c,u,h,d){HI.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,o,a,c,u,h,d)}set(e,n,i,o,a,c,u,h,d){const f=this.elements;return f[0]=e,f[1]=o,f[2]=u,f[3]=n,f[4]=a,f[5]=h,f[6]=i,f[7]=c,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,o=n.elements,a=this.elements,c=i[0],u=i[3],h=i[6],d=i[1],f=i[4],p=i[7],A=i[2],g=i[5],v=i[8],b=o[0],x=o[3],E=o[6],S=o[1],M=o[4],C=o[7],T=o[2],L=o[5],B=o[8];return a[0]=c*b+u*S+h*T,a[3]=c*x+u*M+h*L,a[6]=c*E+u*C+h*B,a[1]=d*b+f*S+p*T,a[4]=d*x+f*M+p*L,a[7]=d*E+f*C+p*B,a[2]=A*b+g*S+v*T,a[5]=A*x+g*M+v*L,a[8]=A*E+g*C+v*B,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8];return n*c*f-n*u*d-i*a*f+i*u*h+o*a*d-o*c*h}invert(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8],p=f*c-u*d,A=u*h-f*a,g=d*a-c*h,v=n*p+i*A+o*g;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/v;return e[0]=p*b,e[1]=(o*d-f*i)*b,e[2]=(u*i-o*c)*b,e[3]=A*b,e[4]=(f*n-o*h)*b,e[5]=(o*a-u*n)*b,e[6]=g*b,e[7]=(i*h-d*n)*b,e[8]=(c*n-i*a)*b,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,o,a,c,u){const h=Math.cos(a),d=Math.sin(a);return this.set(i*h,i*d,-i*(h*c+d*u)+c+e,-o*d,o*h,-o*(-d*c+h*u)+u+n,0,0,1),this}scale(e,n){return this.premultiply(H1.makeScale(e,n)),this}rotate(e){return this.premultiply(H1.makeRotation(-e)),this}translate(e,n){return this.premultiply(H1.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let o=0;o<9;o++)if(n[o]!==i[o])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const H1=new cu;function C8(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function PS(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}const DS={};function j1(s){s in DS||(DS[s]=!0,console.warn(s))}const OS=new cu().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),FS=new cu().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),kA={[N_]:{transfer:Ib,primaries:TS,toReference:s=>s,fromReference:s=>s},[Ia]:{transfer:SS,primaries:TS,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[GI]:{transfer:Ib,primaries:RS,toReference:s=>s.applyMatrix3(FS),fromReference:s=>s.applyMatrix3(OS)},[_8]:{transfer:SS,primaries:RS,toReference:s=>s.convertSRGBToLinear().applyMatrix3(FS),fromReference:s=>s.applyMatrix3(OS).convertLinearToSRGB()}},S8=new Set([N_,GI]),Ea={enabled:!0,_workingColorSpace:N_,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(s){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!s},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!S8.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,n){if(this.enabled===!1||e===n||!e||!n)return s;const i=kA[e].toReference,o=kA[n].fromReference;return o(i(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return kA[s].primaries},getTransfer:function(s){return s===Y0?Ib:kA[s].transfer}};function sf(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function W1(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let cd,T8=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{cd===void 0&&(cd=PS("canvas")),cd.width=e.width,cd.height=e.height;const i=cd.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=cd}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=PS("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const o=i.getImageData(0,0,e.width,e.height),a=o.data;for(let c=0;c<a.length;c++)a[c]=sf(a[c]/255)*255;return i.putImageData(o,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(sf(n[i]/255)*255):n[i]=sf(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},R8=0,I8=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:R8++}),this.uuid=wm(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},o=this.data;if(o!==null){let a;if(Array.isArray(o)){a=[];for(let c=0,u=o.length;c<u;c++)o[c].isDataTexture?a.push(Q1(o[c].image)):a.push(Q1(o[c]))}else a=Q1(o);i.url=a}return n||(e.images[this.uuid]=i),i}};function Q1(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?T8.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let B8=0,Vv=class $0 extends Gv{constructor(e=$0.DEFAULT_IMAGE,n=$0.DEFAULT_MAPPING,i=NA,o=NA,a=m8,c=g8,u=E8,h=A8,d=$0.DEFAULT_ANISOTROPY,f=Y0){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:B8++}),this.uuid=wm(),this.name="",this.source=new I8(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=o,this.magFilter=a,this.minFilter=c,this.anisotropy=d,this.format=u,this.internalFormat=null,this.type=h,this.offset=new ca(0,0),this.repeat=new ca(1,1),this.center=new ca(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cu,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(j1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===G1?Ia:Y0),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==zI)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case _S:e.x=e.x-Math.floor(e.x);break;case NA:e.x=e.x<0?0:1;break;case wS:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case _S:e.y=e.y-Math.floor(e.y);break;case NA:e.y=e.y<0?0:1;break;case wS:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return j1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Ia?G1:b8}set encoding(e){j1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===G1?Ia:Y0}};Vv.DEFAULT_IMAGE=null;Vv.DEFAULT_MAPPING=zI;Vv.DEFAULT_ANISOTROPY=1;let Mm=class{constructor(e=0,n=0,i=0,o=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=o}static slerpFlat(e,n,i,o,a,c,u){let h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];const A=a[c+0],g=a[c+1],v=a[c+2],b=a[c+3];if(u===0){e[n+0]=h,e[n+1]=d,e[n+2]=f,e[n+3]=p;return}if(u===1){e[n+0]=A,e[n+1]=g,e[n+2]=v,e[n+3]=b;return}if(p!==b||h!==A||d!==g||f!==v){let x=1-u;const E=h*A+d*g+f*v+p*b,S=E>=0?1:-1,M=1-E*E;if(M>Number.EPSILON){const T=Math.sqrt(M),L=Math.atan2(T,E*S);x=Math.sin(x*L)/T,u=Math.sin(u*L)/T}const C=u*S;if(h=h*x+A*C,d=d*x+g*C,f=f*x+v*C,p=p*x+b*C,x===1-u){const T=1/Math.sqrt(h*h+d*d+f*f+p*p);h*=T,d*=T,f*=T,p*=T}}e[n]=h,e[n+1]=d,e[n+2]=f,e[n+3]=p}static multiplyQuaternionsFlat(e,n,i,o,a,c){const u=i[o],h=i[o+1],d=i[o+2],f=i[o+3],p=a[c],A=a[c+1],g=a[c+2],v=a[c+3];return e[n]=u*v+f*p+h*g-d*A,e[n+1]=h*v+f*A+d*p-u*g,e[n+2]=d*v+f*g+u*A-h*p,e[n+3]=f*v-u*p-h*A-d*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,o){return this._x=e,this._y=n,this._z=i,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const i=e._x,o=e._y,a=e._z,c=e._order,u=Math.cos,h=Math.sin,d=u(i/2),f=u(o/2),p=u(a/2),A=h(i/2),g=h(o/2),v=h(a/2);switch(c){case"XYZ":this._x=A*f*p+d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p-A*g*v;break;case"YXZ":this._x=A*f*p+d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p+A*g*v;break;case"ZXY":this._x=A*f*p-d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p-A*g*v;break;case"ZYX":this._x=A*f*p-d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p+A*g*v;break;case"YZX":this._x=A*f*p+d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p-A*g*v;break;case"XZY":this._x=A*f*p-d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p+A*g*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,o=Math.sin(i);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],o=n[4],a=n[8],c=n[1],u=n[5],h=n[9],d=n[2],f=n[6],p=n[10],A=i+u+p;if(A>0){const g=.5/Math.sqrt(A+1);this._w=.25/g,this._x=(f-h)*g,this._y=(a-d)*g,this._z=(c-o)*g}else if(i>u&&i>p){const g=2*Math.sqrt(1+i-u-p);this._w=(f-h)/g,this._x=.25*g,this._y=(o+c)/g,this._z=(a+d)/g}else if(u>p){const g=2*Math.sqrt(1+u-i-p);this._w=(a-d)/g,this._x=(o+c)/g,this._y=.25*g,this._z=(h+f)/g}else{const g=2*Math.sqrt(1+p-i-u);this._w=(c-o)/g,this._x=(a+d)/g,this._y=(h+f)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ro(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const o=Math.min(1,n/i);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,o=e._y,a=e._z,c=e._w,u=n._x,h=n._y,d=n._z,f=n._w;return this._x=i*f+c*u+o*d-a*h,this._y=o*f+c*h+a*u-i*d,this._z=a*f+c*d+i*h-o*u,this._w=c*f-i*u-o*h-a*d,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,o=this._y,a=this._z,c=this._w;let u=c*e._w+i*e._x+o*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=c,this._x=i,this._y=o,this._z=a,this;const h=1-u*u;if(h<=Number.EPSILON){const g=1-n;return this._w=g*c+n*this._w,this._x=g*i+n*this._x,this._y=g*o+n*this._y,this._z=g*a+n*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(h),f=Math.atan2(d,u),p=Math.sin((1-n)*f)/d,A=Math.sin(n*f)/d;return this._w=c*p+this._w*A,this._x=i*p+this._x*A,this._y=o*p+this._y*A,this._z=a*p+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),o=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(n*Math.cos(o),i*Math.sin(a),i*Math.cos(a),n*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},jt=class jI{constructor(e=0,n=0,i=0){jI.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(NS.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(NS.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,o=this.z,a=e.elements;return this.x=a[0]*n+a[3]*i+a[6]*o,this.y=a[1]*n+a[4]*i+a[7]*o,this.z=a[2]*n+a[5]*i+a[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,o=this.z,a=e.elements,c=1/(a[3]*n+a[7]*i+a[11]*o+a[15]);return this.x=(a[0]*n+a[4]*i+a[8]*o+a[12])*c,this.y=(a[1]*n+a[5]*i+a[9]*o+a[13])*c,this.z=(a[2]*n+a[6]*i+a[10]*o+a[14])*c,this}applyQuaternion(e){const n=this.x,i=this.y,o=this.z,a=e.x,c=e.y,u=e.z,h=e.w,d=2*(c*o-u*i),f=2*(u*n-a*o),p=2*(a*i-c*n);return this.x=n+h*d+c*p-u*f,this.y=i+h*f+u*d-a*p,this.z=o+h*p+a*f-c*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,o=this.z,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*o,this.y=a[1]*n+a[5]*i+a[9]*o,this.z=a[2]*n+a[6]*i+a[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,o=e.y,a=e.z,c=n.x,u=n.y,h=n.z;return this.x=o*h-a*u,this.y=a*c-i*h,this.z=i*u-o*c,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return X1.copy(this).projectOnVector(e),this.sub(X1)}reflect(e){return this.sub(X1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Ro(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,o=this.z-e.z;return n*n+i*i+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const o=Math.sin(n)*e;return this.x=o*Math.sin(i),this.y=Math.cos(n)*e,this.z=o*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=o,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const X1=new jt,NS=new Mm;let Cm=class{constructor(e=new jt(1/0,1/0,1/0),n=new jt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(ba.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(ba.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=ba.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const a=i.getAttribute("position");if(n===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let c=0,u=a.count;c<u;c++)e.isMesh===!0?e.getVertexPosition(c,ba):ba.fromBufferAttribute(a,c),ba.applyMatrix4(e.matrixWorld),this.expandByPoint(ba);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),zA.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),zA.copy(i.boundingBox)),zA.applyMatrix4(e.matrixWorld),this.union(zA)}const o=e.children;for(let a=0,c=o.length;a<c;a++)this.expandByObject(o[a],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ba),ba.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gp),GA.subVectors(this.max,gp),hd.subVectors(e.a,gp),ud.subVectors(e.b,gp),dd.subVectors(e.c,gp),Mc.subVectors(ud,hd),Cc.subVectors(dd,ud),Nh.subVectors(hd,dd);let n=[0,-Mc.z,Mc.y,0,-Cc.z,Cc.y,0,-Nh.z,Nh.y,Mc.z,0,-Mc.x,Cc.z,0,-Cc.x,Nh.z,0,-Nh.x,-Mc.y,Mc.x,0,-Cc.y,Cc.x,0,-Nh.y,Nh.x,0];return!K1(n,hd,ud,dd,GA)||(n=[1,0,0,0,1,0,0,0,1],!K1(n,hd,ud,dd,GA))?!1:(VA.crossVectors(Mc,Cc),n=[VA.x,VA.y,VA.z],K1(n,hd,ud,dd,GA))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ba).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ba).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Cl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Cl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Cl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Cl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Cl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Cl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Cl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Cl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Cl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};const Cl=[new jt,new jt,new jt,new jt,new jt,new jt,new jt,new jt],ba=new jt,zA=new Cm,hd=new jt,ud=new jt,dd=new jt,Mc=new jt,Cc=new jt,Nh=new jt,gp=new jt,GA=new jt,VA=new jt,Uh=new jt;function K1(s,e,n,i,o){for(let a=0,c=s.length-3;a<=c;a+=3){Uh.fromArray(s,a);const u=o.x*Math.abs(Uh.x)+o.y*Math.abs(Uh.y)+o.z*Math.abs(Uh.z),h=e.dot(Uh),d=n.dot(Uh),f=i.dot(Uh);if(Math.max(-Math.max(h,d,f),Math.min(h,d,f))>u)return!1}return!0}const L8=new Cm,Ap=new jt,q1=new jt;let U_=class{constructor(e=new jt,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):L8.setFromPoints(e).getCenter(i);let o=0;for(let a=0,c=e.length;a<c;a++)o=Math.max(o,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ap.subVectors(e,this.center);const n=Ap.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),o=(i-this.radius)*.5;this.center.addScaledVector(Ap,o/i),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(q1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ap.copy(e.center).add(q1)),this.expandByPoint(Ap.copy(e.center).sub(q1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const Sl=new jt,Y1=new jt,HA=new jt,Sc=new jt,$1=new jt,jA=new jt,J1=new jt;let WI=class{constructor(e=new jt,n=new jt(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Sl)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Sl.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Sl.copy(this.origin).addScaledVector(this.direction,n),Sl.distanceToSquared(e))}distanceSqToSegment(e,n,i,o){Y1.copy(e).add(n).multiplyScalar(.5),HA.copy(n).sub(e).normalize(),Sc.copy(this.origin).sub(Y1);const a=e.distanceTo(n)*.5,c=-this.direction.dot(HA),u=Sc.dot(this.direction),h=-Sc.dot(HA),d=Sc.lengthSq(),f=Math.abs(1-c*c);let p,A,g,v;if(f>0)if(p=c*h-u,A=c*u-h,v=a*f,p>=0)if(A>=-v)if(A<=v){const b=1/f;p*=b,A*=b,g=p*(p+c*A+2*u)+A*(c*p+A+2*h)+d}else A=a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;else A=-a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;else A<=-v?(p=Math.max(0,-(-c*a+u)),A=p>0?-a:Math.min(Math.max(-a,-h),a),g=-p*p+A*(A+2*h)+d):A<=v?(p=0,A=Math.min(Math.max(-a,-h),a),g=A*(A+2*h)+d):(p=Math.max(0,-(c*a+u)),A=p>0?a:Math.min(Math.max(-a,-h),a),g=-p*p+A*(A+2*h)+d);else A=c>0?-a:a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;return i&&i.copy(this.origin).addScaledVector(this.direction,p),o&&o.copy(Y1).addScaledVector(HA,A),g}intersectSphere(e,n){Sl.subVectors(e.center,this.origin);const i=Sl.dot(this.direction),o=Sl.dot(Sl)-i*i,a=e.radius*e.radius;if(o>a)return null;const c=Math.sqrt(a-o),u=i-c,h=i+c;return h<0?null:u<0?this.at(h,n):this.at(u,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,o,a,c,u,h;const d=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,A=this.origin;return d>=0?(i=(e.min.x-A.x)*d,o=(e.max.x-A.x)*d):(i=(e.max.x-A.x)*d,o=(e.min.x-A.x)*d),f>=0?(a=(e.min.y-A.y)*f,c=(e.max.y-A.y)*f):(a=(e.max.y-A.y)*f,c=(e.min.y-A.y)*f),i>c||a>o||((a>i||isNaN(i))&&(i=a),(c<o||isNaN(o))&&(o=c),p>=0?(u=(e.min.z-A.z)*p,h=(e.max.z-A.z)*p):(u=(e.max.z-A.z)*p,h=(e.min.z-A.z)*p),i>h||u>o)||((u>i||i!==i)&&(i=u),(h<o||o!==o)&&(o=h),o<0)?null:this.at(i>=0?i:o,n)}intersectsBox(e){return this.intersectBox(e,Sl)!==null}intersectTriangle(e,n,i,o,a){$1.subVectors(n,e),jA.subVectors(i,e),J1.crossVectors($1,jA);let c=this.direction.dot(J1),u;if(c>0){if(o)return null;u=1}else if(c<0)u=-1,c=-c;else return null;Sc.subVectors(this.origin,e);const h=u*this.direction.dot(jA.crossVectors(Sc,jA));if(h<0)return null;const d=u*this.direction.dot($1.cross(Sc));if(d<0||h+d>c)return null;const f=-u*Sc.dot(J1);return f<0?null:this.at(f/c,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Yl=class Bb{constructor(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x){Bb.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x)}set(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x){const E=this.elements;return E[0]=e,E[4]=n,E[8]=i,E[12]=o,E[1]=a,E[5]=c,E[9]=u,E[13]=h,E[2]=d,E[6]=f,E[10]=p,E[14]=A,E[3]=g,E[7]=v,E[11]=b,E[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bb().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,o=1/fd.setFromMatrixColumn(e,0).length(),a=1/fd.setFromMatrixColumn(e,1).length(),c=1/fd.setFromMatrixColumn(e,2).length();return n[0]=i[0]*o,n[1]=i[1]*o,n[2]=i[2]*o,n[3]=0,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[7]=0,n[8]=i[8]*c,n[9]=i[9]*c,n[10]=i[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,o=e.y,a=e.z,c=Math.cos(i),u=Math.sin(i),h=Math.cos(o),d=Math.sin(o),f=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){const A=c*f,g=c*p,v=u*f,b=u*p;n[0]=h*f,n[4]=-h*p,n[8]=d,n[1]=g+v*d,n[5]=A-b*d,n[9]=-u*h,n[2]=b-A*d,n[6]=v+g*d,n[10]=c*h}else if(e.order==="YXZ"){const A=h*f,g=h*p,v=d*f,b=d*p;n[0]=A+b*u,n[4]=v*u-g,n[8]=c*d,n[1]=c*p,n[5]=c*f,n[9]=-u,n[2]=g*u-v,n[6]=b+A*u,n[10]=c*h}else if(e.order==="ZXY"){const A=h*f,g=h*p,v=d*f,b=d*p;n[0]=A-b*u,n[4]=-c*p,n[8]=v+g*u,n[1]=g+v*u,n[5]=c*f,n[9]=b-A*u,n[2]=-c*d,n[6]=u,n[10]=c*h}else if(e.order==="ZYX"){const A=c*f,g=c*p,v=u*f,b=u*p;n[0]=h*f,n[4]=v*d-g,n[8]=A*d+b,n[1]=h*p,n[5]=b*d+A,n[9]=g*d-v,n[2]=-d,n[6]=u*h,n[10]=c*h}else if(e.order==="YZX"){const A=c*h,g=c*d,v=u*h,b=u*d;n[0]=h*f,n[4]=b-A*p,n[8]=v*p+g,n[1]=p,n[5]=c*f,n[9]=-u*f,n[2]=-d*f,n[6]=g*p+v,n[10]=A-b*p}else if(e.order==="XZY"){const A=c*h,g=c*d,v=u*h,b=u*d;n[0]=h*f,n[4]=-p,n[8]=d*f,n[1]=A*p+b,n[5]=c*f,n[9]=g*p-v,n[2]=v*p-g,n[6]=u*f,n[10]=b*p+A}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(P8,e,D8)}lookAt(e,n,i){const o=this.elements;return Go.subVectors(e,n),Go.lengthSq()===0&&(Go.z=1),Go.normalize(),Tc.crossVectors(i,Go),Tc.lengthSq()===0&&(Math.abs(i.z)===1?Go.x+=1e-4:Go.z+=1e-4,Go.normalize(),Tc.crossVectors(i,Go)),Tc.normalize(),WA.crossVectors(Go,Tc),o[0]=Tc.x,o[4]=WA.x,o[8]=Go.x,o[1]=Tc.y,o[5]=WA.y,o[9]=Go.y,o[2]=Tc.z,o[6]=WA.z,o[10]=Go.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,o=n.elements,a=this.elements,c=i[0],u=i[4],h=i[8],d=i[12],f=i[1],p=i[5],A=i[9],g=i[13],v=i[2],b=i[6],x=i[10],E=i[14],S=i[3],M=i[7],C=i[11],T=i[15],L=o[0],B=o[4],F=o[8],D=o[12],P=o[1],U=o[5],K=o[9],J=o[13],z=o[2],j=o[6],G=o[10],H=o[14],te=o[3],Z=o[7],ee=o[11],oe=o[15];return a[0]=c*L+u*P+h*z+d*te,a[4]=c*B+u*U+h*j+d*Z,a[8]=c*F+u*K+h*G+d*ee,a[12]=c*D+u*J+h*H+d*oe,a[1]=f*L+p*P+A*z+g*te,a[5]=f*B+p*U+A*j+g*Z,a[9]=f*F+p*K+A*G+g*ee,a[13]=f*D+p*J+A*H+g*oe,a[2]=v*L+b*P+x*z+E*te,a[6]=v*B+b*U+x*j+E*Z,a[10]=v*F+b*K+x*G+E*ee,a[14]=v*D+b*J+x*H+E*oe,a[3]=S*L+M*P+C*z+T*te,a[7]=S*B+M*U+C*j+T*Z,a[11]=S*F+M*K+C*G+T*ee,a[15]=S*D+M*J+C*H+T*oe,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],o=e[8],a=e[12],c=e[1],u=e[5],h=e[9],d=e[13],f=e[2],p=e[6],A=e[10],g=e[14],v=e[3],b=e[7],x=e[11],E=e[15];return v*(+a*h*p-o*d*p-a*u*A+i*d*A+o*u*g-i*h*g)+b*(+n*h*g-n*d*A+a*c*A-o*c*g+o*d*f-a*h*f)+x*(+n*d*p-n*u*g-a*c*p+i*c*g+a*u*f-i*d*f)+E*(-o*u*f-n*h*p+n*u*A+o*c*p-i*c*A+i*h*f)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=n,o[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8],p=e[9],A=e[10],g=e[11],v=e[12],b=e[13],x=e[14],E=e[15],S=p*x*d-b*A*d+b*h*g-u*x*g-p*h*E+u*A*E,M=v*A*d-f*x*d-v*h*g+c*x*g+f*h*E-c*A*E,C=f*b*d-v*p*d+v*u*g-c*b*g-f*u*E+c*p*E,T=v*p*h-f*b*h-v*u*A+c*b*A+f*u*x-c*p*x,L=n*S+i*M+o*C+a*T;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const B=1/L;return e[0]=S*B,e[1]=(b*A*a-p*x*a-b*o*g+i*x*g+p*o*E-i*A*E)*B,e[2]=(u*x*a-b*h*a+b*o*d-i*x*d-u*o*E+i*h*E)*B,e[3]=(p*h*a-u*A*a-p*o*d+i*A*d+u*o*g-i*h*g)*B,e[4]=M*B,e[5]=(f*x*a-v*A*a+v*o*g-n*x*g-f*o*E+n*A*E)*B,e[6]=(v*h*a-c*x*a-v*o*d+n*x*d+c*o*E-n*h*E)*B,e[7]=(c*A*a-f*h*a+f*o*d-n*A*d-c*o*g+n*h*g)*B,e[8]=C*B,e[9]=(v*p*a-f*b*a-v*i*g+n*b*g+f*i*E-n*p*E)*B,e[10]=(c*b*a-v*u*a+v*i*d-n*b*d-c*i*E+n*u*E)*B,e[11]=(f*u*a-c*p*a-f*i*d+n*p*d+c*i*g-n*u*g)*B,e[12]=T*B,e[13]=(f*b*o-v*p*o+v*i*A-n*b*A-f*i*x+n*p*x)*B,e[14]=(v*u*o-c*b*o-v*i*h+n*b*h+c*i*x-n*u*x)*B,e[15]=(c*p*o-f*u*o+f*i*h-n*p*h-c*i*A+n*u*A)*B,this}scale(e){const n=this.elements,i=e.x,o=e.y,a=e.z;return n[0]*=i,n[4]*=o,n[8]*=a,n[1]*=i,n[5]*=o,n[9]*=a,n[2]*=i,n[6]*=o,n[10]*=a,n[3]*=i,n[7]*=o,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,o))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),o=Math.sin(n),a=1-i,c=e.x,u=e.y,h=e.z,d=a*c,f=a*u;return this.set(d*c+i,d*u-o*h,d*h+o*u,0,d*u+o*h,f*u+i,f*h-o*c,0,d*h-o*u,f*h+o*c,a*h*h+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,o,a,c){return this.set(1,i,a,0,e,1,c,0,n,o,1,0,0,0,0,1),this}compose(e,n,i){const o=this.elements,a=n._x,c=n._y,u=n._z,h=n._w,d=a+a,f=c+c,p=u+u,A=a*d,g=a*f,v=a*p,b=c*f,x=c*p,E=u*p,S=h*d,M=h*f,C=h*p,T=i.x,L=i.y,B=i.z;return o[0]=(1-(b+E))*T,o[1]=(g+C)*T,o[2]=(v-M)*T,o[3]=0,o[4]=(g-C)*L,o[5]=(1-(A+E))*L,o[6]=(x+S)*L,o[7]=0,o[8]=(v+M)*B,o[9]=(x-S)*B,o[10]=(1-(A+b))*B,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,n,i){const o=this.elements;let a=fd.set(o[0],o[1],o[2]).length();const c=fd.set(o[4],o[5],o[6]).length(),u=fd.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),e.x=o[12],e.y=o[13],e.z=o[14],_a.copy(this);const d=1/a,f=1/c,p=1/u;return _a.elements[0]*=d,_a.elements[1]*=d,_a.elements[2]*=d,_a.elements[4]*=f,_a.elements[5]*=f,_a.elements[6]*=f,_a.elements[8]*=p,_a.elements[9]*=p,_a.elements[10]*=p,n.setFromRotationMatrix(_a),i.x=a,i.y=c,i.z=u,this}makePerspective(e,n,i,o,a,c,u=UA){const h=this.elements,d=2*a/(n-e),f=2*a/(i-o),p=(n+e)/(n-e),A=(i+o)/(i-o);let g,v;if(u===UA)g=-(c+a)/(c-a),v=-2*c*a/(c-a);else if(u===LS)g=-c/(c-a),v=-c*a/(c-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return h[0]=d,h[4]=0,h[8]=p,h[12]=0,h[1]=0,h[5]=f,h[9]=A,h[13]=0,h[2]=0,h[6]=0,h[10]=g,h[14]=v,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,n,i,o,a,c,u=UA){const h=this.elements,d=1/(n-e),f=1/(i-o),p=1/(c-a),A=(n+e)*d,g=(i+o)*f;let v,b;if(u===UA)v=(c+a)*p,b=-2*p;else if(u===LS)v=a*p,b=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return h[0]=2*d,h[4]=0,h[8]=0,h[12]=-A,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-g,h[2]=0,h[6]=0,h[10]=b,h[14]=-v,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let o=0;o<16;o++)if(n[o]!==i[o])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}};const fd=new jt,_a=new Yl,P8=new jt(0,0,0),D8=new jt(1,1,1),Tc=new jt,WA=new jt,Go=new jt,US=new Yl,kS=new Mm;let QI=class XI{constructor(e=0,n=0,i=0,o=XI.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,o=this._order){return this._x=e,this._y=n,this._z=i,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const o=e.elements,a=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],A=o[6],g=o[10];switch(n){case"XYZ":this._y=Math.asin(Ro(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,g),this._z=Math.atan2(-c,a)):(this._x=Math.atan2(A,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Ro(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,g),this._z=Math.atan2(h,d)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ro(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-p,g),this._z=Math.atan2(-c,d)):(this._y=0,this._z=Math.atan2(h,a));break;case"ZYX":this._y=Math.asin(-Ro(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(A,g),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-c,d));break;case"YZX":this._z=Math.asin(Ro(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(u,g));break;case"XZY":this._z=Math.asin(-Ro(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(A,d),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-f,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return US.makeRotationFromQuaternion(e),this.setFromRotationMatrix(US,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return kS.setFromEuler(this),this.setFromQuaternion(kS,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};QI.DEFAULT_ORDER="XYZ";let O8=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},F8=0;const zS=new jt,pd=new Mm,Tl=new Yl,QA=new jt,vp=new jt,N8=new jt,U8=new Mm,GS=new jt(1,0,0),VS=new jt(0,1,0),HS=new jt(0,0,1),k8={type:"added"},z8={type:"removed"};let Kc=class J0 extends Gv{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:F8++}),this.uuid=wm(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=J0.DEFAULT_UP.clone();const e=new jt,n=new QI,i=new Mm,o=new jt(1,1,1);function a(){i.setFromEuler(n,!1)}function c(){n.setFromQuaternion(i,void 0,!1)}n._onChange(a),i._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Yl},normalMatrix:{value:new cu}}),this.matrix=new Yl,this.matrixWorld=new Yl,this.matrixAutoUpdate=J0.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=J0.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new O8,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return pd.setFromAxisAngle(e,n),this.quaternion.multiply(pd),this}rotateOnWorldAxis(e,n){return pd.setFromAxisAngle(e,n),this.quaternion.premultiply(pd),this}rotateX(e){return this.rotateOnAxis(GS,e)}rotateY(e){return this.rotateOnAxis(VS,e)}rotateZ(e){return this.rotateOnAxis(HS,e)}translateOnAxis(e,n){return zS.copy(e).applyQuaternion(this.quaternion),this.position.add(zS.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(GS,e)}translateY(e){return this.translateOnAxis(VS,e)}translateZ(e){return this.translateOnAxis(HS,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Tl.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?QA.copy(e):QA.set(e,n,i);const o=this.parent;this.updateWorldMatrix(!0,!1),vp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tl.lookAt(vp,QA,this.up):Tl.lookAt(QA,vp,this.up),this.quaternion.setFromRotationMatrix(Tl),o&&(Tl.extractRotation(o.matrixWorld),pd.setFromRotationMatrix(Tl),this.quaternion.premultiply(pd.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(k8)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(z8)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Tl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Tl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Tl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,o=this.children.length;i<o;i++){const c=this.children[i].getObjectByProperty(e,n);if(c!==void 0)return c}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const o=this.children;for(let a=0,c=o.length;a<c;a++)o[a].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vp,e,N8),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vp,U8,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,o=n.length;i<o;i++){const a=n[i];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const o=this.children;for(let a=0,c=o.length;a<c;a++){const u=o[a];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.visibility=this._visibility,o.active=this._active,o.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),o.maxGeometryCount=this._maxGeometryCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.geometryCount=this._geometryCount,o.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(o.boundingSphere={center:o.boundingSphere.center.toArray(),radius:o.boundingSphere.radius}),this.boundingBox!==null&&(o.boundingBox={min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}));function a(u,h){return u[h.uuid]===void 0&&(u[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=a(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const h=u.shapes;if(Array.isArray(h))for(let d=0,f=h.length;d<f;d++){const p=h[d];a(e.shapes,p)}else a(e.shapes,h)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let h=0,d=this.material.length;h<d;h++)u.push(a(e.materials,this.material[h]));o.material=u}else o.material=a(e.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++){const h=this.animations[u];o.animations.push(a(e.animations,h))}}if(n){const u=c(e.geometries),h=c(e.materials),d=c(e.textures),f=c(e.images),p=c(e.shapes),A=c(e.skeletons),g=c(e.animations),v=c(e.nodes);u.length>0&&(i.geometries=u),h.length>0&&(i.materials=h),d.length>0&&(i.textures=d),f.length>0&&(i.images=f),p.length>0&&(i.shapes=p),A.length>0&&(i.skeletons=A),g.length>0&&(i.animations=g),v.length>0&&(i.nodes=v)}return i.object=o,i;function c(u){const h=[];for(const d in u){const f=u[d];delete f.metadata,h.push(f)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const o=e.children[i];this.add(o.clone())}return this}};Kc.DEFAULT_UP=new jt(0,1,0);Kc.DEFAULT_MATRIX_AUTO_UPDATE=!0;Kc.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const wa=new jt,Rl=new jt,Z1=new jt,Il=new jt,md=new jt,gd=new jt,jS=new jt,eE=new jt,tE=new jt,nE=new jt;let XA=!1,jp=class Wh{constructor(e=new jt,n=new jt,i=new jt){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,o){o.subVectors(i,n),wa.subVectors(e,n),o.cross(wa);const a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}static getBarycoord(e,n,i,o,a){wa.subVectors(o,n),Rl.subVectors(i,n),Z1.subVectors(e,n);const c=wa.dot(wa),u=wa.dot(Rl),h=wa.dot(Z1),d=Rl.dot(Rl),f=Rl.dot(Z1),p=c*d-u*u;if(p===0)return a.set(-2,-1,-1);const A=1/p,g=(d*h-u*f)*A,v=(c*f-u*h)*A;return a.set(1-g-v,v,g)}static containsPoint(e,n,i,o){return this.getBarycoord(e,n,i,o,Il),Il.x>=0&&Il.y>=0&&Il.x+Il.y<=1}static getUV(e,n,i,o,a,c,u,h){return XA===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),XA=!0),this.getInterpolation(e,n,i,o,a,c,u,h)}static getInterpolation(e,n,i,o,a,c,u,h){return this.getBarycoord(e,n,i,o,Il),h.setScalar(0),h.addScaledVector(a,Il.x),h.addScaledVector(c,Il.y),h.addScaledVector(u,Il.z),h}static isFrontFacing(e,n,i,o){return wa.subVectors(i,n),Rl.subVectors(e,n),wa.cross(Rl).dot(o)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,o){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,n,i,o){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return wa.subVectors(this.c,this.b),Rl.subVectors(this.a,this.b),wa.cross(Rl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Wh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Wh.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,o,a){return XA===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),XA=!0),Wh.getInterpolation(e,this.a,this.b,this.c,n,i,o,a)}getInterpolation(e,n,i,o,a){return Wh.getInterpolation(e,this.a,this.b,this.c,n,i,o,a)}containsPoint(e){return Wh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Wh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,o=this.b,a=this.c;let c,u;md.subVectors(o,i),gd.subVectors(a,i),eE.subVectors(e,i);const h=md.dot(eE),d=gd.dot(eE);if(h<=0&&d<=0)return n.copy(i);tE.subVectors(e,o);const f=md.dot(tE),p=gd.dot(tE);if(f>=0&&p<=f)return n.copy(o);const A=h*p-f*d;if(A<=0&&h>=0&&f<=0)return c=h/(h-f),n.copy(i).addScaledVector(md,c);nE.subVectors(e,a);const g=md.dot(nE),v=gd.dot(nE);if(v>=0&&g<=v)return n.copy(a);const b=g*d-h*v;if(b<=0&&d>=0&&v<=0)return u=d/(d-v),n.copy(i).addScaledVector(gd,u);const x=f*v-g*p;if(x<=0&&p-f>=0&&g-v>=0)return jS.subVectors(a,o),u=(p-f)/(p-f+(g-v)),n.copy(o).addScaledVector(jS,u);const E=1/(x+b+A);return c=b*E,u=A*E,n.copy(i).addScaledVector(md,c).addScaledVector(gd,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const KI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Rc={h:0,s:0,l:0},KA={h:0,s:0,l:0};function iE(s,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?s+(e-s)*6*n:n<1/2?e:n<2/3?s+(e-s)*6*(2/3-n):s}let La=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const o=e;o&&o.isColor?this.copy(o):typeof o=="number"?this.setHex(o):typeof o=="string"&&this.setStyle(o)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Ia){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ea.toWorkingColorSpace(this,n),this}setRGB(e,n,i,o=Ea.workingColorSpace){return this.r=e,this.g=n,this.b=i,Ea.toWorkingColorSpace(this,o),this}setHSL(e,n,i,o=Ea.workingColorSpace){if(e=M8(e,1),n=Ro(n,0,1),i=Ro(i,0,1),n===0)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+n):i+n-i*n,c=2*i-a;this.r=iE(c,a,e+1/3),this.g=iE(c,a,e),this.b=iE(c,a,e-1/3)}return Ea.toWorkingColorSpace(this,o),this}setStyle(e,n=Ia){function i(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const c=o[1],u=o[2];switch(c){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=o[1],c=a.length;if(c===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(c===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Ia){const i=KI[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=sf(e.r),this.g=sf(e.g),this.b=sf(e.b),this}copyLinearToSRGB(e){return this.r=W1(e.r),this.g=W1(e.g),this.b=W1(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ia){return Ea.fromWorkingColorSpace(Ks.copy(this),e),Math.round(Ro(Ks.r*255,0,255))*65536+Math.round(Ro(Ks.g*255,0,255))*256+Math.round(Ro(Ks.b*255,0,255))}getHexString(e=Ia){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Ea.workingColorSpace){Ea.fromWorkingColorSpace(Ks.copy(this),n);const i=Ks.r,o=Ks.g,a=Ks.b,c=Math.max(i,o,a),u=Math.min(i,o,a);let h,d;const f=(u+c)/2;if(u===c)h=0,d=0;else{const p=c-u;switch(d=f<=.5?p/(c+u):p/(2-c-u),c){case i:h=(o-a)/p+(o<a?6:0);break;case o:h=(a-i)/p+2;break;case a:h=(i-o)/p+4;break}h/=6}return e.h=h,e.s=d,e.l=f,e}getRGB(e,n=Ea.workingColorSpace){return Ea.fromWorkingColorSpace(Ks.copy(this),n),e.r=Ks.r,e.g=Ks.g,e.b=Ks.b,e}getStyle(e=Ia){Ea.fromWorkingColorSpace(Ks.copy(this),e);const n=Ks.r,i=Ks.g,o=Ks.b;return e!==Ia?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(o*255)})`}offsetHSL(e,n,i){return this.getHSL(Rc),this.setHSL(Rc.h+e,Rc.s+n,Rc.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Rc),e.getHSL(KA);const i=V1(Rc.h,KA.h,n),o=V1(Rc.s,KA.s,n),a=V1(Rc.l,KA.l,n);return this.setHSL(i,o,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,o=this.b,a=e.elements;return this.r=a[0]*n+a[3]*i+a[6]*o,this.g=a[1]*n+a[4]*i+a[7]*o,this.b=a[2]*n+a[5]*i+a[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ks=new La;La.NAMES=KI;let G8=0,qI=class extends Gv{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:G8++}),this.uuid=wm(),this.name="",this.type="Material",this.blending=vS,this.side=Rb,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xS,this.blendDst=ES,this.blendEquation=yS,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new La(0,0,0),this.blendAlpha=0,this.depthFunc=bS,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=IS,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ld,this.stencilZFail=ld,this.stencilZPass=ld,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const o=this[n];if(o===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}o&&o.isColor?o.set(i):o&&o.isVector3&&i&&i.isVector3?o.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==vS&&(i.blending=this.blending),this.side!==Rb&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==xS&&(i.blendSrc=this.blendSrc),this.blendDst!==ES&&(i.blendDst=this.blendDst),this.blendEquation!==yS&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==bS&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==IS&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ld&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ld&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ld&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function o(a){const c=[];for(const u in a){const h=a[u];delete h.metadata,c.push(h)}return c}if(n){const a=o(e.textures),c=o(e.images);a.length>0&&(i.textures=a),c.length>0&&(i.images=c)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const o=n.length;i=new Array(o);for(let a=0;a!==o;++a)i[a]=n[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Kd=class extends qI{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new La(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=p8,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const ss=new jt,qA=new ca;let jc=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=BS,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=y8,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn('THREE.BufferAttribute: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let o=0,a=this.itemSize;o<a;o++)this.array[e+o]=n.array[i+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)qA.fromBufferAttribute(this,n),qA.applyMatrix3(e),this.setXY(n,qA.x,qA.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)ss.fromBufferAttribute(this,n),ss.applyMatrix3(e),this.setXYZ(n,ss.x,ss.y,ss.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)ss.fromBufferAttribute(this,n),ss.applyMatrix4(e),this.setXYZ(n,ss.x,ss.y,ss.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ss.fromBufferAttribute(this,n),ss.applyNormalMatrix(e),this.setXYZ(n,ss.x,ss.y,ss.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ss.fromBufferAttribute(this,n),ss.transformDirection(e),this.setXYZ(n,ss.x,ss.y,ss.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=mp(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Co(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=mp(n,this.array)),n}setX(e,n){return this.normalized&&(n=Co(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=mp(n,this.array)),n}setY(e,n){return this.normalized&&(n=Co(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=mp(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Co(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=mp(n,this.array)),n}setW(e,n){return this.normalized&&(n=Co(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Co(n,this.array),i=Co(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,o){return e*=this.itemSize,this.normalized&&(n=Co(n,this.array),i=Co(i,this.array),o=Co(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=o,this}setXYZW(e,n,i,o,a){return e*=this.itemSize,this.normalized&&(n=Co(n,this.array),i=Co(i,this.array),o=Co(o,this.array),a=Co(a,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=o,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==BS&&(e.usage=this.usage),e}},V8=class extends jc{constructor(e,n,i){super(new Uint16Array(e),n,i)}},H8=class extends jc{constructor(e,n,i){super(new Uint32Array(e),n,i)}},Wc=class extends jc{constructor(e,n,i){super(new Float32Array(e),n,i)}},j8=0;const ta=new Yl,rE=new Kc,Ad=new jt,Vo=new Cm,yp=new Cm,Ts=new jt;let Ef=class YI extends Gv{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:j8++}),this.uuid=wm(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(C8(e)?H8:V8)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const a=new cu().getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}const o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ta.makeRotationFromQuaternion(e),this.applyMatrix4(ta),this}rotateX(e){return ta.makeRotationX(e),this.applyMatrix4(ta),this}rotateY(e){return ta.makeRotationY(e),this.applyMatrix4(ta),this}rotateZ(e){return ta.makeRotationZ(e),this.applyMatrix4(ta),this}translate(e,n,i){return ta.makeTranslation(e,n,i),this.applyMatrix4(ta),this}scale(e,n,i){return ta.makeScale(e,n,i),this.applyMatrix4(ta),this}lookAt(e){return rE.lookAt(e),rE.updateMatrix(),this.applyMatrix4(rE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ad).negate(),this.translate(Ad.x,Ad.y,Ad.z),this}setFromPoints(e){const n=[];for(let i=0,o=e.length;i<o;i++){const a=e[i];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Wc(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cm);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new jt(-1/0,-1/0,-1/0),new jt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,o=n.length;i<o;i++){const a=n[i];Vo.setFromBufferAttribute(a),this.morphTargetsRelative?(Ts.addVectors(this.boundingBox.min,Vo.min),this.boundingBox.expandByPoint(Ts),Ts.addVectors(this.boundingBox.max,Vo.max),this.boundingBox.expandByPoint(Ts)):(this.boundingBox.expandByPoint(Vo.min),this.boundingBox.expandByPoint(Vo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new U_);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new jt,1/0);return}if(e){const i=this.boundingSphere.center;if(Vo.setFromBufferAttribute(e),n)for(let a=0,c=n.length;a<c;a++){const u=n[a];yp.setFromBufferAttribute(u),this.morphTargetsRelative?(Ts.addVectors(Vo.min,yp.min),Vo.expandByPoint(Ts),Ts.addVectors(Vo.max,yp.max),Vo.expandByPoint(Ts)):(Vo.expandByPoint(yp.min),Vo.expandByPoint(yp.max))}Vo.getCenter(i);let o=0;for(let a=0,c=e.count;a<c;a++)Ts.fromBufferAttribute(e,a),o=Math.max(o,i.distanceToSquared(Ts));if(n)for(let a=0,c=n.length;a<c;a++){const u=n[a],h=this.morphTargetsRelative;for(let d=0,f=u.count;d<f;d++)Ts.fromBufferAttribute(u,d),h&&(Ad.fromBufferAttribute(e,d),Ts.add(Ad)),o=Math.max(o,i.distanceToSquared(Ts))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,o=n.position.array,a=n.normal.array,c=n.uv.array,u=o.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new jc(new Float32Array(4*u),4));const h=this.getAttribute("tangent").array,d=[],f=[];for(let P=0;P<u;P++)d[P]=new jt,f[P]=new jt;const p=new jt,A=new jt,g=new jt,v=new ca,b=new ca,x=new ca,E=new jt,S=new jt;function M(P,U,K){p.fromArray(o,P*3),A.fromArray(o,U*3),g.fromArray(o,K*3),v.fromArray(c,P*2),b.fromArray(c,U*2),x.fromArray(c,K*2),A.sub(p),g.sub(p),b.sub(v),x.sub(v);const J=1/(b.x*x.y-x.x*b.y);isFinite(J)&&(E.copy(A).multiplyScalar(x.y).addScaledVector(g,-b.y).multiplyScalar(J),S.copy(g).multiplyScalar(b.x).addScaledVector(A,-x.x).multiplyScalar(J),d[P].add(E),d[U].add(E),d[K].add(E),f[P].add(S),f[U].add(S),f[K].add(S))}let C=this.groups;C.length===0&&(C=[{start:0,count:i.length}]);for(let P=0,U=C.length;P<U;++P){const K=C[P],J=K.start,z=K.count;for(let j=J,G=J+z;j<G;j+=3)M(i[j+0],i[j+1],i[j+2])}const T=new jt,L=new jt,B=new jt,F=new jt;function D(P){B.fromArray(a,P*3),F.copy(B);const U=d[P];T.copy(U),T.sub(B.multiplyScalar(B.dot(U))).normalize(),L.crossVectors(F,U);const J=L.dot(f[P])<0?-1:1;h[P*4]=T.x,h[P*4+1]=T.y,h[P*4+2]=T.z,h[P*4+3]=J}for(let P=0,U=C.length;P<U;++P){const K=C[P],J=K.start,z=K.count;for(let j=J,G=J+z;j<G;j+=3)D(i[j+0]),D(i[j+1]),D(i[j+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new jc(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let A=0,g=i.count;A<g;A++)i.setXYZ(A,0,0,0);const o=new jt,a=new jt,c=new jt,u=new jt,h=new jt,d=new jt,f=new jt,p=new jt;if(e)for(let A=0,g=e.count;A<g;A+=3){const v=e.getX(A+0),b=e.getX(A+1),x=e.getX(A+2);o.fromBufferAttribute(n,v),a.fromBufferAttribute(n,b),c.fromBufferAttribute(n,x),f.subVectors(c,a),p.subVectors(o,a),f.cross(p),u.fromBufferAttribute(i,v),h.fromBufferAttribute(i,b),d.fromBufferAttribute(i,x),u.add(f),h.add(f),d.add(f),i.setXYZ(v,u.x,u.y,u.z),i.setXYZ(b,h.x,h.y,h.z),i.setXYZ(x,d.x,d.y,d.z)}else for(let A=0,g=n.count;A<g;A+=3)o.fromBufferAttribute(n,A+0),a.fromBufferAttribute(n,A+1),c.fromBufferAttribute(n,A+2),f.subVectors(c,a),p.subVectors(o,a),f.cross(p),i.setXYZ(A+0,f.x,f.y,f.z),i.setXYZ(A+1,f.x,f.y,f.z),i.setXYZ(A+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Ts.fromBufferAttribute(e,n),Ts.normalize(),e.setXYZ(n,Ts.x,Ts.y,Ts.z)}toNonIndexed(){function e(u,h){const d=u.array,f=u.itemSize,p=u.normalized,A=new d.constructor(h.length*f);let g=0,v=0;for(let b=0,x=h.length;b<x;b++){u.isInterleavedBufferAttribute?g=h[b]*u.data.stride+u.offset:g=h[b]*f;for(let E=0;E<f;E++)A[v++]=d[g++]}return new jc(A,f,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new YI,i=this.index.array,o=this.attributes;for(const u in o){const h=o[u],d=e(h,i);n.setAttribute(u,d)}const a=this.morphAttributes;for(const u in a){const h=[],d=a[u];for(let f=0,p=d.length;f<p;f++){const A=d[f],g=e(A,i);h.push(g)}n.morphAttributes[u]=h}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let u=0,h=c.length;u<h;u++){const d=c[u];n.addGroup(d.start,d.count,d.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const d in h)h[d]!==void 0&&(e[d]=h[d]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const h in i){const d=i[h];e.data.attributes[h]=d.toJSON(e.data)}const o={};let a=!1;for(const h in this.morphAttributes){const d=this.morphAttributes[h],f=[];for(let p=0,A=d.length;p<A;p++){const g=d[p];f.push(g.toJSON(e.data))}f.length>0&&(o[h]=f,a=!0)}a&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const o=e.attributes;for(const d in o){const f=o[d];this.setAttribute(d,f.clone(n))}const a=e.morphAttributes;for(const d in a){const f=[],p=a[d];for(let A=0,g=p.length;A<g;A++)f.push(p[A].clone(n));this.morphAttributes[d]=f}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let d=0,f=c.length;d<f;d++){const p=c[d];this.addGroup(p.start,p.count,p.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const WS=new Yl,kh=new WI,YA=new U_,QS=new jt,vd=new jt,yd=new jt,xd=new jt,sE=new jt,$A=new jt,JA=new ca,ZA=new ca,e0=new ca,XS=new jt,KS=new jt,qS=new jt,t0=new jt,n0=new jt;let xp=class extends Kc{constructor(e=new Ef,n=new Kd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=o.length;a<c;a++){const u=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(e,n){const i=this.geometry,o=i.attributes.position,a=i.morphAttributes.position,c=i.morphTargetsRelative;n.fromBufferAttribute(o,e);const u=this.morphTargetInfluences;if(a&&u){$A.set(0,0,0);for(let h=0,d=a.length;h<d;h++){const f=u[h],p=a[h];f!==0&&(sE.fromBufferAttribute(p,e),c?$A.addScaledVector(sE,f):$A.addScaledVector(sE.sub(n),f))}n.add($A)}return n}raycast(e,n){const i=this.geometry,o=this.material,a=this.matrixWorld;o!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),YA.copy(i.boundingSphere),YA.applyMatrix4(a),kh.copy(e.ray).recast(e.near),!(YA.containsPoint(kh.origin)===!1&&(kh.intersectSphere(YA,QS)===null||kh.origin.distanceToSquared(QS)>(e.far-e.near)**2))&&(WS.copy(a).invert(),kh.copy(e.ray).applyMatrix4(WS),!(i.boundingBox!==null&&kh.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,kh)))}_computeIntersections(e,n,i){let o;const a=this.geometry,c=this.material,u=a.index,h=a.attributes.position,d=a.attributes.uv,f=a.attributes.uv1,p=a.attributes.normal,A=a.groups,g=a.drawRange;if(u!==null)if(Array.isArray(c))for(let v=0,b=A.length;v<b;v++){const x=A[v],E=c[x.materialIndex],S=Math.max(x.start,g.start),M=Math.min(u.count,Math.min(x.start+x.count,g.start+g.count));for(let C=S,T=M;C<T;C+=3){const L=u.getX(C),B=u.getX(C+1),F=u.getX(C+2);o=i0(this,E,e,i,d,f,p,L,B,F),o&&(o.faceIndex=Math.floor(C/3),o.face.materialIndex=x.materialIndex,n.push(o))}}else{const v=Math.max(0,g.start),b=Math.min(u.count,g.start+g.count);for(let x=v,E=b;x<E;x+=3){const S=u.getX(x),M=u.getX(x+1),C=u.getX(x+2);o=i0(this,c,e,i,d,f,p,S,M,C),o&&(o.faceIndex=Math.floor(x/3),n.push(o))}}else if(h!==void 0)if(Array.isArray(c))for(let v=0,b=A.length;v<b;v++){const x=A[v],E=c[x.materialIndex],S=Math.max(x.start,g.start),M=Math.min(h.count,Math.min(x.start+x.count,g.start+g.count));for(let C=S,T=M;C<T;C+=3){const L=C,B=C+1,F=C+2;o=i0(this,E,e,i,d,f,p,L,B,F),o&&(o.faceIndex=Math.floor(C/3),o.face.materialIndex=x.materialIndex,n.push(o))}}else{const v=Math.max(0,g.start),b=Math.min(h.count,g.start+g.count);for(let x=v,E=b;x<E;x+=3){const S=x,M=x+1,C=x+2;o=i0(this,c,e,i,d,f,p,S,M,C),o&&(o.faceIndex=Math.floor(x/3),n.push(o))}}}};function W8(s,e,n,i,o,a,c,u){let h;if(e.side===f8?h=i.intersectTriangle(c,a,o,!0,u):h=i.intersectTriangle(o,a,c,e.side===Rb,u),h===null)return null;n0.copy(u),n0.applyMatrix4(s.matrixWorld);const d=n.ray.origin.distanceTo(n0);return d<n.near||d>n.far?null:{distance:d,point:n0.clone(),object:s}}function i0(s,e,n,i,o,a,c,u,h,d){s.getVertexPosition(u,vd),s.getVertexPosition(h,yd),s.getVertexPosition(d,xd);const f=W8(s,e,n,i,vd,yd,xd,t0);if(f){o&&(JA.fromBufferAttribute(o,u),ZA.fromBufferAttribute(o,h),e0.fromBufferAttribute(o,d),f.uv=jp.getInterpolation(t0,vd,yd,xd,JA,ZA,e0,new ca)),a&&(JA.fromBufferAttribute(a,u),ZA.fromBufferAttribute(a,h),e0.fromBufferAttribute(a,d),f.uv1=jp.getInterpolation(t0,vd,yd,xd,JA,ZA,e0,new ca),f.uv2=f.uv1),c&&(XS.fromBufferAttribute(c,u),KS.fromBufferAttribute(c,h),qS.fromBufferAttribute(c,d),f.normal=jp.getInterpolation(t0,vd,yd,xd,XS,KS,qS,new jt),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const p={a:u,b:h,c:d,normal:new jt,materialIndex:0};jp.getNormal(vd,yd,xd,p.normal),f.face=p}return f}let oE=class $I extends Ef{constructor(e=1,n=1,i=1,o=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:o,heightSegments:a,depthSegments:c};const u=this;o=Math.floor(o),a=Math.floor(a),c=Math.floor(c);const h=[],d=[],f=[],p=[];let A=0,g=0;v("z","y","x",-1,-1,i,n,e,c,a,0),v("z","y","x",1,-1,i,n,-e,c,a,1),v("x","z","y",1,1,e,i,n,o,c,2),v("x","z","y",1,-1,e,i,-n,o,c,3),v("x","y","z",1,-1,e,n,i,o,a,4),v("x","y","z",-1,-1,e,n,-i,o,a,5),this.setIndex(h),this.setAttribute("position",new Wc(d,3)),this.setAttribute("normal",new Wc(f,3)),this.setAttribute("uv",new Wc(p,2));function v(b,x,E,S,M,C,T,L,B,F,D){const P=C/B,U=T/F,K=C/2,J=T/2,z=L/2,j=B+1,G=F+1;let H=0,te=0;const Z=new jt;for(let ee=0;ee<G;ee++){const oe=ee*U-J;for(let xe=0;xe<j;xe++){const Pe=xe*P-K;Z[b]=Pe*S,Z[x]=oe*M,Z[E]=z,d.push(Z.x,Z.y,Z.z),Z[b]=0,Z[x]=0,Z[E]=L>0?1:-1,f.push(Z.x,Z.y,Z.z),p.push(xe/B),p.push(1-ee/F),H+=1}}for(let ee=0;ee<F;ee++)for(let oe=0;oe<B;oe++){const xe=A+oe+j*ee,Pe=A+oe+j*(ee+1),me=A+(oe+1)+j*(ee+1),Ce=A+(oe+1)+j*ee;h.push(xe,Pe,Ce),h.push(Pe,me,Ce),te+=6}u.addGroup(g,te,D),g+=te,A+=H}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $I(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};const aE=new jt,Q8=new jt,X8=new cu;let YS=class{constructor(e=new jt(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,o){return this.normal.set(e,n,i),this.constant=o,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const o=aE.subVectors(i,n).cross(Q8.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(aE),o=this.normal.dot(i);if(o===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/o;return a<0||a>1?null:n.copy(e.start).addScaledVector(i,a)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||X8.getNormalMatrix(e),o=this.coplanarPoint(aE).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},K8=class extends Vv{constructor(e,n,i,o,a,c,u,h,d,f){if(f=f!==void 0?f:z1,f!==z1&&f!==CS)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&f===z1&&(i=v8),i===void 0&&f===CS&&(i=x8),super(null,o,a,c,u,h,f,i,d),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=u!==void 0?u:MS,this.minFilter=h!==void 0?h:MS,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}};const q8=new K8(1,1);q8.compareFunction=w8;let JI=class extends qI{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new La(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const $S=new jt,JS=new jt,ZS=new Yl,lE=new WI,r0=new U_;let Y8=class extends Kc{constructor(e=new Ef,n=new JI){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let o=1,a=n.count;o<a;o++)$S.fromBufferAttribute(n,o-1),JS.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=$S.distanceTo(JS);e.setAttribute("lineDistance",new Wc(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,o=this.matrixWorld,a=e.params.Line.threshold,c=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),r0.copy(i.boundingSphere),r0.applyMatrix4(o),r0.radius+=a,e.ray.intersectsSphere(r0)===!1)return;ZS.copy(o).invert(),lE.copy(e.ray).applyMatrix4(ZS);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),h=u*u,d=new jt,f=new jt,p=new jt,A=new jt,g=this.isLineSegments?2:1,v=i.index,x=i.attributes.position;if(v!==null){const E=Math.max(0,c.start),S=Math.min(v.count,c.start+c.count);for(let M=E,C=S-1;M<C;M+=g){const T=v.getX(M),L=v.getX(M+1);if(d.fromBufferAttribute(x,T),f.fromBufferAttribute(x,L),lE.distanceSqToSegment(d,f,A,p)>h)continue;A.applyMatrix4(this.matrixWorld);const F=e.ray.origin.distanceTo(A);F<e.near||F>e.far||n.push({distance:F,point:p.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{const E=Math.max(0,c.start),S=Math.min(x.count,c.start+c.count);for(let M=E,C=S-1;M<C;M+=g){if(d.fromBufferAttribute(x,M),f.fromBufferAttribute(x,M+1),lE.distanceSqToSegment(d,f,A,p)>h)continue;A.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(A);L<e.near||L>e.far||n.push({distance:L,point:p.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=o.length;a<c;a++){const u=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}},eT=class ZI extends Ef{constructor(e=1,n=32,i=16,o=0,a=Math.PI*2,c=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:o,phiLength:a,thetaStart:c,thetaLength:u},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const h=Math.min(c+u,Math.PI);let d=0;const f=[],p=new jt,A=new jt,g=[],v=[],b=[],x=[];for(let E=0;E<=i;E++){const S=[],M=E/i;let C=0;E===0&&c===0?C=.5/n:E===i&&h===Math.PI&&(C=-.5/n);for(let T=0;T<=n;T++){const L=T/n;p.x=-e*Math.cos(o+L*a)*Math.sin(c+M*u),p.y=e*Math.cos(c+M*u),p.z=e*Math.sin(o+L*a)*Math.sin(c+M*u),v.push(p.x,p.y,p.z),A.copy(p).normalize(),b.push(A.x,A.y,A.z),x.push(L+C,1-M),S.push(d++)}f.push(S)}for(let E=0;E<i;E++)for(let S=0;S<n;S++){const M=f[E][S+1],C=f[E][S],T=f[E+1][S],L=f[E+1][S+1];(E!==0||c>0)&&g.push(M,C,L),(E!==i-1||h<Math.PI)&&g.push(C,T,L)}this.setIndex(g),this.setAttribute("position",new Wc(v,3)),this.setAttribute("normal",new Wc(b,3)),this.setAttribute("uv",new Wc(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ZI(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:kI}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=kI);class ts{static roundNumber(e,n){const i=Math.pow(10,n);return Math.round(e*i)/i}static sample(e){return e[Math.floor(Math.random()*e.length)]}static distanceToSquared(e,n){var i=e.x-n.x,o=e.y-n.y,a=e.z-n.z;return i*i+o*o+a*a}static isPointInPoly(e,n){for(var i=!1,o=-1,a=e.length,c=a-1;++o<a;c=o)(e[o].z<=n.z&&n.z<e[c].z||e[c].z<=n.z&&n.z<e[o].z)&&n.x<(e[c].x-e[o].x)*(n.z-e[o].z)/(e[c].z-e[o].z)+e[o].x&&(i=!i);return i}static isVectorInPolygon(e,n,i){var o=1e5,a=-1e5,c=[];return n.vertexIds.forEach(u=>{o=Math.min(i[u].y,o),a=Math.max(i[u].y,a),c.push(i[u])}),!!(e.y<a+.5&&e.y>o-.5&&this.isPointInPoly(c,e))}static triarea2(e,n,i){return(i.x-e.x)*(n.z-e.z)-(n.x-e.x)*(i.z-e.z)}static vequal(e,n){return this.distanceToSquared(e,n)<1e-5}static mergeVertices(e,n=1e-4){n=Math.max(n,Number.EPSILON);for(var i={},o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,u=0,h=[],d=[],f=Math.log10(1/n),p=Math.pow(10,f),A=0;A<c;A++){var g=o?o.getX(A):A,v="";v+=~~(a.getX(g)*p)+",",v+=~~(a.getY(g)*p)+",",(v+=~~(a.getZ(g)*p)+",")in i?h.push(i[v]):(d.push(a.getX(g)),d.push(a.getY(g)),d.push(a.getZ(g)),i[v]=u,h.push(u),u++)}const b=new jc(new Float32Array(d),a.itemSize,a.normalized),x=new Ef;return x.setAttribute("position",b),x.setIndex(h),x}}class $8{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.sinkDown(this.content.length-1)}pop(){const e=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),e}remove(e){const n=this.content.indexOf(e),i=this.content.pop();n!==this.content.length-1&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(e)?this.sinkDown(n):this.bubbleUp(n))}size(){return this.content.length}rescoreElement(e){this.sinkDown(this.content.indexOf(e))}sinkDown(e){const n=this.content[e];for(;e>0;){const i=(e+1>>1)-1,o=this.content[i];if(!(this.scoreFunction(n)<this.scoreFunction(o)))break;this.content[i]=n,this.content[e]=o,e=i}}bubbleUp(e){const n=this.content.length,i=this.content[e],o=this.scoreFunction(i);for(;;){const a=e+1<<1,c=a-1;let u,h=null;if(c<n&&(u=this.scoreFunction(this.content[c]),u<o&&(h=c)),a<n&&this.scoreFunction(this.content[a])<(h===null?o:u)&&(h=a),h===null)break;this.content[e]=this.content[h],this.content[h]=i,e=h}}}class J8{constructor(){this.portals=[]}push(e,n){n===void 0&&(n=e),this.portals.push({left:e,right:n})}stringPull(){const e=this.portals,n=[];let i,o,a,c=0,u=0,h=0;i=e[0].left,o=e[0].left,a=e[0].right,n.push(i);for(let d=1;d<e.length;d++){const f=e[d].left,p=e[d].right;if(ts.triarea2(i,a,p)<=0){if(!(ts.vequal(i,a)||ts.triarea2(i,o,p)>0)){n.push(o),i=o,c=u,o=i,a=i,u=c,h=c,d=c;continue}a=p,h=d}if(ts.triarea2(i,o,f)>=0){if(!(ts.vequal(i,o)||ts.triarea2(i,a,f)<0)){n.push(a),i=a,c=h,o=i,a=i,u=c,h=c,d=c;continue}o=f,u=d}}return n.length!==0&&ts.vequal(n[n.length-1],e[e.length-1].left)||n.push(e[e.length-1].left),this.path=n,n}}class Lb{constructor(){this.zones={}}static createZone(e,n=1e-4){return class{static buildZone(i,o){const a=this._buildNavigationMesh(i,o),c={};a.vertices.forEach(h=>{h.x=ts.roundNumber(h.x,2),h.y=ts.roundNumber(h.y,2),h.z=ts.roundNumber(h.z,2)}),c.vertices=a.vertices;const u=this._buildPolygonGroups(a);return c.groups=new Array(u.length),u.forEach((h,d)=>{const f=new Map;h.forEach((A,g)=>{f.set(A,g)});const p=new Array(h.length);h.forEach((A,g)=>{const v=[];A.neighbours.forEach(E=>v.push(f.get(E)));const b=[];A.neighbours.forEach(E=>b.push(this._getSharedVerticesInOrder(A,E)));const x=new jt(0,0,0);x.add(c.vertices[A.vertexIds[0]]),x.add(c.vertices[A.vertexIds[1]]),x.add(c.vertices[A.vertexIds[2]]),x.divideScalar(3),x.x=ts.roundNumber(x.x,2),x.y=ts.roundNumber(x.y,2),x.z=ts.roundNumber(x.z,2),p[g]={id:g,neighbours:v,vertexIds:A.vertexIds,centroid:x,portals:b}}),c.groups[d]=p}),c}static _buildNavigationMesh(i,o){return i=ts.mergeVertices(i,o),this._buildPolygonsFromGeometry(i)}static _spreadGroupId(i){let o=new Set([i]);for(;o.size>0;){const a=o;o=new Set,a.forEach(c=>{c.group=i.group,c.neighbours.forEach(u=>{u.group===void 0&&o.add(u)})})}}static _buildPolygonGroups(i){const o=[];return i.polygons.forEach(a=>{a.group!==void 0?o[a.group].push(a):(a.group=o.length,this._spreadGroupId(a),o.push([a]))}),o}static _buildPolygonNeighbours(i,o){const a=new Set,c=o[i.vertexIds[1]],u=o[i.vertexIds[2]];return o[i.vertexIds[0]].forEach(h=>{h!==i&&(c.includes(h)||u.includes(h))&&a.add(h)}),c.forEach(h=>{h!==i&&u.includes(h)&&a.add(h)}),a}static _buildPolygonsFromGeometry(i){const o=[],a=[],c=i.attributes.position,u=i.index,h=[];for(let d=0;d<c.count;d++)a.push(new jt().fromBufferAttribute(c,d)),h[d]=[];for(let d=0;d<i.index.count;d+=3){const f=u.getX(d),p=u.getX(d+1),A=u.getX(d+2),g={vertexIds:[f,p,A],neighbours:null};o.push(g),h[f].push(g),h[p].push(g),h[A].push(g)}return o.forEach(d=>{d.neighbours=this._buildPolygonNeighbours(d,h)}),{polygons:o,vertices:a}}static _getSharedVerticesInOrder(i,o){const a=i.vertexIds,c=a[0],u=a[1],h=a[2],d=o.vertexIds,f=d.includes(c),p=d.includes(u),A=d.includes(h);return f&&p&&A?Array.from(a):f&&p?[c,u]:p&&A?[u,h]:f&&A?[h,c]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}.buildZone(e,n)}setZoneData(e,n){this.zones[e]=n}getRandomNode(e,n,i,o){if(!this.zones[e])return new jt;i=i||null,o=o||0;const a=[];return this.zones[e].groups[n].forEach(c=>{i&&o?ts.distanceToSquared(i,c.centroid)<o*o&&a.push(c.centroid):a.push(c.centroid)}),ts.sample(a)||new jt}getClosestNode(e,n,i,o=!1){const a=this.zones[n].vertices;let c=null,u=1/0;return this.zones[n].groups[i].forEach(h=>{const d=ts.distanceToSquared(h.centroid,e);d<u&&(!o||ts.isVectorInPolygon(e,h,a))&&(c=h,u=d)}),c}findPath(e,n,i,o){const a=this.zones[i].groups[o],c=this.zones[i].vertices,u=this.getClosestNode(e,i,o,!0),h=this.getClosestNode(n,i,o,!0);if(!u||!h)return null;const d=class{static init(g){for(let v=0;v<g.length;v++){const b=g[v];b.f=0,b.g=0,b.h=0,b.cost=1,b.visited=!1,b.closed=!1,b.parent=null}}static cleanUp(g){for(let v=0;v<g.length;v++){const b=g[v];delete b.f,delete b.g,delete b.h,delete b.cost,delete b.visited,delete b.closed,delete b.parent}}static heap(){return new $8(function(g){return g.f})}static search(g,v,b){this.init(g);const x=this.heap();for(x.push(v);x.size()>0;){const E=x.pop();if(E===b){let M=E;const C=[];for(;M.parent;)C.push(M),M=M.parent;return this.cleanUp(C),C.reverse()}E.closed=!0;const S=this.neighbours(g,E);for(let M=0,C=S.length;M<C;M++){const T=S[M];if(T.closed)continue;const L=E.g+T.cost,B=T.visited;if(!B||L<T.g){if(T.visited=!0,T.parent=E,!T.centroid||!b.centroid)throw new Error("Unexpected state");T.h=T.h||this.heuristic(T.centroid,b.centroid),T.g=L,T.f=T.g+T.h,B?x.rescoreElement(T):x.push(T)}}}return[]}static heuristic(g,v){return ts.distanceToSquared(g,v)}static neighbours(g,v){const b=[];for(let x=0;x<v.neighbours.length;x++)b.push(g[v.neighbours[x]]);return b}}.search(a,u,h),f=function(g,v){for(var b=0;b<g.neighbours.length;b++)if(g.neighbours[b]===v.id)return g.portals[b]},p=new J8;p.push(e);for(let g=0;g<d.length;g++){const v=d[g],b=d[g+1];if(b){const x=f(v,b);p.push(c[x[0]],c[x[1]])}}p.push(n),p.stringPull();const A=p.path.map(g=>new jt(g.x,g.y,g.z));return A.shift(),A}}Lb.prototype.getGroup=function(){const s=new YS;return function(e,n,i=!1){if(!this.zones[e])return null;let o=null,a=Math.pow(50,2);const c=this.zones[e];for(let u=0;u<c.groups.length;u++){const h=c.groups[u];for(const d of h){if(i&&(s.setFromCoplanarPoints(c.vertices[d.vertexIds[0]],c.vertices[d.vertexIds[1]],c.vertices[d.vertexIds[2]]),Math.abs(s.distanceToPoint(n))<.01)&&ts.isPointInPoly([c.vertices[d.vertexIds[0]],c.vertices[d.vertexIds[1]],c.vertices[d.vertexIds[2]]],n))return u;const f=ts.distanceToSquared(d.centroid,n);f<a&&(o=u,a=f)}}return o}}(),Lb.prototype.clampStep=function(){const s=new jt,e=new YS,n=new jp,i=new jt;let o,a,c=new jt;return function(u,h,d,f,p,A){const g=this.zones[f].vertices,v=this.zones[f].groups[p],b=[d],x={};x[d.id]=0,o=void 0,c.set(0,0,0),a=1/0,e.setFromCoplanarPoints(g[d.vertexIds[0]],g[d.vertexIds[1]],g[d.vertexIds[2]]),e.projectPoint(h,s),i.copy(s);for(let E=b.pop();E;E=b.pop()){n.set(g[E.vertexIds[0]],g[E.vertexIds[1]],g[E.vertexIds[2]]),n.closestPointToPoint(i,s),s.distanceToSquared(i)<a&&(o=E,c.copy(s),a=s.distanceToSquared(i));const S=x[E.id];if(!(S>2))for(let M=0;M<E.neighbours.length;M++){const C=v[E.neighbours[M]];C.id in x||(b.push(C),x[C.id]=S+1)}}return A.copy(c),o}}();const Ed={PLAYER:new La(15631215).convertSRGBToLinear().getHex(),TARGET:new La(14469912).convertSRGBToLinear().getHex(),PATH:new La(41903).convertSRGBToLinear().getHex(),WAYPOINT:new La(41903).convertSRGBToLinear().getHex(),CLAMPED_STEP:new La(14472114).convertSRGBToLinear().getHex(),CLOSEST_NODE:new La(4417387).convertSRGBToLinear().getHex()};class Z8 extends Kc{constructor(){super(),this._playerMarker=new xp(new eT(.25,32,32),new Kd({color:Ed.PLAYER})),this._targetMarker=new xp(new oE(.3,.3,.3),new Kd({color:Ed.TARGET})),this._nodeMarker=new xp(new oE(.1,.8,.1),new Kd({color:Ed.CLOSEST_NODE})),this._stepMarker=new xp(new oE(.1,1,.1),new Kd({color:Ed.CLAMPED_STEP})),this._pathMarker=new Kc,this._pathLineMaterial=new JI({color:Ed.PATH,linewidth:2}),this._pathPointMaterial=new Kd({color:Ed.WAYPOINT}),this._pathPointGeometry=new eT(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(e=>{e.visible=!1,this.add(e)})}setPath(e){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);e=[this._playerMarker.position].concat(e);const n=new Ef;n.setAttribute("position",new jc(new Float32Array(3*e.length),3));for(let i=0;i<e.length;i++)n.attributes.position.setXYZ(i,e[i].x,e[i].y+.2,e[i].z);this._pathMarker.add(new Y8(n,this._pathLineMaterial));for(let i=0;i<e.length-1;i++){const o=new xp(this._pathPointGeometry,this._pathPointMaterial);o.position.copy(e[i]),o.position.y+=.2,this._pathMarker.add(o)}return this._pathMarker.visible=!0,this}setPlayerPosition(e){return this._playerMarker.position.copy(e),this._playerMarker.visible=!0,this}setTargetPosition(e){return this._targetMarker.position.copy(e),this._targetMarker.visible=!0,this}setNodePosition(e){return this._nodeMarker.position.copy(e),this._nodeMarker.visible=!0,this}setStepPosition(e){return this._stepMarker.position.copy(e),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(e=>{e.visible=!1}),this}}const e7=Object.freeze(Object.defineProperty({__proto__:null,Pathfinding:Lb,PathfindingHelper:Z8},Symbol.toStringTag,{value:"Module"})),t7=M_(e7),{Pathfinding:eB}=t7,Ep=new eB,bp="level";AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(s){this.navMesh=new THREE.Mesh(s),Ep.setZoneData(bp,eB.createZone(s)),Array.from(this.agents).forEach(e=>e.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(s){this.agents.add(s)},removeAgent:function(s){this.agents.delete(s)},getPath:function(s,e,n){return this.navMesh?Ep.findPath(s,e,bp,n):null},getGroup:function(s){return this.navMesh?Ep.getGroup(bp,s):null},getNode:function(s,e){return this.navMesh?Ep.getClosestNode(s,bp,e,!0):null},clampStep:function(s,e,n,i,o){if(this.navMesh){if(!i)return o.copy(e),this.getNode(e,n)}else return o.copy(e),null;return Ep.clampStep(s,e,i,bp,n,o)}});AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}});AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}});AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const s=this.el,e=this.data;let n=s.components.material;const i=new THREE.PlaneGeometry(e.width,e.depth,e.density,e.density);this.waves=[];const o=i.getAttribute("position");for(let a=0;a<o.count;a++)this.waves.push({z:o.getZ(a),ang:Math.random()*Math.PI*2,amp:e.amplitude+Math.random()*e.amplitudeVariance,speed:(e.speed+Math.random()*e.speedVariance)/1e3});n||(n={},n.material=new THREE.MeshPhongMaterial({color:e.color,transparent:e.opacity<1,opacity:e.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(i,n.material),s.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(s,e){if(!e)return;const n=this.mesh.geometry.getAttribute("position");for(let i=0;i<n.count;i++){const o=this.waves[i],a=o.z+Math.sin(o.ang)*o.amp;n.setZ(i,a),o.ang+=o.speed*e}n.needsUpdate=!0}});AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}});AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const s=this.el,e=this.data;let n=s.components.material;if(!e.path.length){console.error("[a-tube] `path` property expected but not found.");return}const i=new THREE.CatmullRomCurve3(e.path.map(function(a){return a=a.split(" "),new THREE.Vector3(Number(a[0]),Number(a[1]),Number(a[2]))})),o=new THREE.TubeGeometry(i,e.segments,e.radius,e.radialSegments,e.closed);n||(n={},n.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(o,n.material),this.el.setObject3D("mesh",this.mesh)},update:function(s){Object.keys(s).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}});var ri=function(s){return typeof s=="function"?s:typeof s=="string"?function(e){return e[s]}:function(e){return s}};const n7=Object.freeze(Object.defineProperty({__proto__:null,default:ri},Symbol.toStringTag,{value:"Module"})),i7=M_(n7);/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Hv="161",Ja={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},bd={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},r7=0,tT=1,s7=2,tB=1,o7=2,zl=3,qc=0,Ao=1,jl=2,$l=0,of=1,nT=2,iT=3,rT=4,a7=5,Kh=100,l7=101,c7=102,sT=103,oT=104,h7=200,u7=201,d7=202,f7=203,Pb=204,Db=205,p7=206,m7=207,g7=208,A7=209,v7=210,y7=211,x7=212,E7=213,b7=214,_7=0,w7=1,M7=2,dv=3,C7=4,S7=5,T7=6,R7=7,k_=0,I7=1,B7=2,Qc=0,L7=1,P7=2,D7=3,O7=4,F7=5,N7=6,nB=300,hf=301,uf=302,Ob=303,Fb=304,jv=306,Nb=1e3,Pa=1001,Ub=1002,mo=1003,aT=1004,_p=1005,fo=1006,cE=1007,$h=1008,Xc=1009,U7=1010,k7=1011,z_=1012,iB=1013,Hc=1014,Wl=1015,df=1016,rB=1017,sB=1018,eu=1020,z7=1021,Da=1023,G7=1024,V7=1025,tu=1026,ff=1027,H7=1028,oB=1029,j7=1030,aB=1031,lB=1033,hE=33776,uE=33777,dE=33778,fE=33779,lT=35840,cT=35841,hT=35842,uT=35843,cB=36196,dT=37492,fT=37496,pT=37808,mT=37809,gT=37810,AT=37811,vT=37812,yT=37813,xT=37814,ET=37815,bT=37816,_T=37817,wT=37818,MT=37819,CT=37820,ST=37821,pE=36492,TT=36494,RT=36495,W7=36283,IT=36284,BT=36285,LT=36286,hB=3e3,nu=3001,Q7=3200,X7=3201,uB=0,K7=1,aa="",ms="srgb",tc="srgb-linear",G_="display-p3",Wv="display-p3-linear",fv="linear",Dr="srgb",pv="rec709",mv="p3",_d=7680,PT=519,q7=512,Y7=513,$7=514,dB=515,J7=516,Z7=517,ez=518,tz=519,kb=35044,DT="300 es",zb=1035,Ql=2e3,gv=2001;class Ga{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const o=this._listeners[e];if(o!==void 0){const a=o.indexOf(n);a!==-1&&o.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const o=i.slice(0);for(let a=0,c=o.length;a<c;a++)o[a].call(this,e);e.target=null}}}const qs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let OT=1234567;const em=Math.PI/180,fm=180/Math.PI;function Jl(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(qs[s&255]+qs[s>>8&255]+qs[s>>16&255]+qs[s>>24&255]+"-"+qs[e&255]+qs[e>>8&255]+"-"+qs[e>>16&15|64]+qs[e>>24&255]+"-"+qs[n&63|128]+qs[n>>8&255]+"-"+qs[n>>16&255]+qs[n>>24&255]+qs[i&255]+qs[i>>8&255]+qs[i>>16&255]+qs[i>>24&255]).toLowerCase()}function Is(s,e,n){return Math.max(e,Math.min(n,s))}function V_(s,e){return(s%e+e)%e}function nz(s,e,n,i,o){return i+(s-e)*(o-i)/(n-e)}function iz(s,e,n){return s!==e?(n-s)/(e-s):0}function tm(s,e,n){return(1-n)*s+n*e}function rz(s,e,n,i){return tm(s,e,1-Math.exp(-n*i))}function sz(s,e=1){return e-Math.abs(V_(s,e*2)-e)}function oz(s,e,n){return s<=e?0:s>=n?1:(s=(s-e)/(n-e),s*s*(3-2*s))}function az(s,e,n){return s<=e?0:s>=n?1:(s=(s-e)/(n-e),s*s*s*(s*(s*6-15)+10))}function lz(s,e){return s+Math.floor(Math.random()*(e-s+1))}function cz(s,e){return s+Math.random()*(e-s)}function hz(s){return s*(.5-Math.random())}function uz(s){s!==void 0&&(OT=s);let e=OT+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function dz(s){return s*em}function fz(s){return s*fm}function Gb(s){return(s&s-1)===0&&s!==0}function pz(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function Av(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function mz(s,e,n,i,o){const a=Math.cos,c=Math.sin,u=a(n/2),h=c(n/2),d=a((e+i)/2),f=c((e+i)/2),p=a((e-i)/2),A=c((e-i)/2),g=a((i-e)/2),v=c((i-e)/2);switch(o){case"XYX":s.set(u*f,h*p,h*A,u*d);break;case"YZY":s.set(h*A,u*f,h*p,u*d);break;case"ZXZ":s.set(h*p,h*A,u*f,u*d);break;case"XZX":s.set(u*f,h*v,h*g,u*d);break;case"YXY":s.set(h*g,u*f,h*v,u*d);break;case"ZYZ":s.set(h*v,h*g,u*f,u*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}function Oa(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function _r(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const Vb={DEG2RAD:em,RAD2DEG:fm,generateUUID:Jl,clamp:Is,euclideanModulo:V_,mapLinear:nz,inverseLerp:iz,lerp:tm,damp:rz,pingpong:sz,smoothstep:oz,smootherstep:az,randInt:lz,randFloat:cz,randFloatSpread:hz,seededRandom:uz,degToRad:dz,radToDeg:fz,isPowerOfTwo:Gb,ceilPowerOfTwo:pz,floorPowerOfTwo:Av,setQuaternionFromProperEuler:mz,normalize:_r,denormalize:Oa};class Mn{constructor(e=0,n=0){Mn.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6],this.y=o[1]*n+o[4]*i+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Is(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),o=Math.sin(n),a=this.x-e.x,c=this.y-e.y;return this.x=a*i-c*o+e.x,this.y=a*o+c*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class tr{constructor(e,n,i,o,a,c,u,h,d){tr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,o,a,c,u,h,d)}set(e,n,i,o,a,c,u,h,d){const f=this.elements;return f[0]=e,f[1]=o,f[2]=u,f[3]=n,f[4]=a,f[5]=h,f[6]=i,f[7]=c,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,o=n.elements,a=this.elements,c=i[0],u=i[3],h=i[6],d=i[1],f=i[4],p=i[7],A=i[2],g=i[5],v=i[8],b=o[0],x=o[3],E=o[6],S=o[1],M=o[4],C=o[7],T=o[2],L=o[5],B=o[8];return a[0]=c*b+u*S+h*T,a[3]=c*x+u*M+h*L,a[6]=c*E+u*C+h*B,a[1]=d*b+f*S+p*T,a[4]=d*x+f*M+p*L,a[7]=d*E+f*C+p*B,a[2]=A*b+g*S+v*T,a[5]=A*x+g*M+v*L,a[8]=A*E+g*C+v*B,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8];return n*c*f-n*u*d-i*a*f+i*u*h+o*a*d-o*c*h}invert(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8],p=f*c-u*d,A=u*h-f*a,g=d*a-c*h,v=n*p+i*A+o*g;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/v;return e[0]=p*b,e[1]=(o*d-f*i)*b,e[2]=(u*i-o*c)*b,e[3]=A*b,e[4]=(f*n-o*h)*b,e[5]=(o*a-u*n)*b,e[6]=g*b,e[7]=(i*h-d*n)*b,e[8]=(c*n-i*a)*b,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,o,a,c,u){const h=Math.cos(a),d=Math.sin(a);return this.set(i*h,i*d,-i*(h*c+d*u)+c+e,-o*d,o*h,-o*(-d*c+h*u)+u+n,0,0,1),this}scale(e,n){return this.premultiply(mE.makeScale(e,n)),this}rotate(e){return this.premultiply(mE.makeRotation(-e)),this}translate(e,n){return this.premultiply(mE.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let o=0;o<9;o++)if(n[o]!==i[o])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const mE=new tr;function fB(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function pm(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function gz(){const s=pm("canvas");return s.style.display="block",s}const FT={};function iu(s){s in FT||(FT[s]=!0,console.warn(s))}const NT=new tr().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),UT=new tr().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),s0={[tc]:{transfer:fv,primaries:pv,toReference:s=>s,fromReference:s=>s},[ms]:{transfer:Dr,primaries:pv,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[Wv]:{transfer:fv,primaries:mv,toReference:s=>s.applyMatrix3(UT),fromReference:s=>s.applyMatrix3(NT)},[G_]:{transfer:Dr,primaries:mv,toReference:s=>s.convertSRGBToLinear().applyMatrix3(UT),fromReference:s=>s.applyMatrix3(NT).convertLinearToSRGB()}},Az=new Set([tc,Wv]),Mr={enabled:!0,_workingColorSpace:tc,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!Az.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,n){if(this.enabled===!1||e===n||!e||!n)return s;const i=s0[e].toReference,o=s0[n].fromReference;return o(i(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return s0[s].primaries},getTransfer:function(s){return s===aa?fv:s0[s].transfer}};function af(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function gE(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let wd;class pB{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{wd===void 0&&(wd=pm("canvas")),wd.width=e.width,wd.height=e.height;const i=wd.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=wd}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=pm("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const o=i.getImageData(0,0,e.width,e.height),a=o.data;for(let c=0;c<a.length;c++)a[c]=af(a[c]/255)*255;return i.putImageData(o,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(af(n[i]/255)*255):n[i]=af(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let vz=0;class mB{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:vz++}),this.uuid=Jl(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},o=this.data;if(o!==null){let a;if(Array.isArray(o)){a=[];for(let c=0,u=o.length;c<u;c++)o[c].isDataTexture?a.push(AE(o[c].image)):a.push(AE(o[c]))}else a=AE(o);i.url=a}return n||(e.images[this.uuid]=i),i}}function AE(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?pB.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let yz=0;class Js extends Ga{constructor(e=Js.DEFAULT_IMAGE,n=Js.DEFAULT_MAPPING,i=Pa,o=Pa,a=fo,c=$h,u=Da,h=Xc,d=Js.DEFAULT_ANISOTROPY,f=aa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yz++}),this.uuid=Jl(),this.name="",this.source=new mB(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=o,this.magFilter=a,this.minFilter=c,this.anisotropy=d,this.format=u,this.internalFormat=null,this.type=h,this.offset=new Mn(0,0),this.repeat=new Mn(1,1),this.center=new Mn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new tr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(iu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===nu?ms:aa),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==nB)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Nb:e.x=e.x-Math.floor(e.x);break;case Pa:e.x=e.x<0?0:1;break;case Ub:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Nb:e.y=e.y-Math.floor(e.y);break;case Pa:e.y=e.y<0?0:1;break;case Ub:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return iu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ms?nu:hB}set encoding(e){iu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===nu?ms:aa}}Js.DEFAULT_IMAGE=null;Js.DEFAULT_MAPPING=nB;Js.DEFAULT_ANISOTROPY=1;class Bs{constructor(e=0,n=0,i=0,o=1){Bs.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,o){return this.x=e,this.y=n,this.z=i,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,o=this.z,a=this.w,c=e.elements;return this.x=c[0]*n+c[4]*i+c[8]*o+c[12]*a,this.y=c[1]*n+c[5]*i+c[9]*o+c[13]*a,this.z=c[2]*n+c[6]*i+c[10]*o+c[14]*a,this.w=c[3]*n+c[7]*i+c[11]*o+c[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,o,a;const h=e.elements,d=h[0],f=h[4],p=h[8],A=h[1],g=h[5],v=h[9],b=h[2],x=h[6],E=h[10];if(Math.abs(f-A)<.01&&Math.abs(p-b)<.01&&Math.abs(v-x)<.01){if(Math.abs(f+A)<.1&&Math.abs(p+b)<.1&&Math.abs(v+x)<.1&&Math.abs(d+g+E-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const M=(d+1)/2,C=(g+1)/2,T=(E+1)/2,L=(f+A)/4,B=(p+b)/4,F=(v+x)/4;return M>C&&M>T?M<.01?(i=0,o=.707106781,a=.707106781):(i=Math.sqrt(M),o=L/i,a=B/i):C>T?C<.01?(i=.707106781,o=0,a=.707106781):(o=Math.sqrt(C),i=L/o,a=F/o):T<.01?(i=.707106781,o=.707106781,a=0):(a=Math.sqrt(T),i=B/a,o=F/a),this.set(i,o,a,n),this}let S=Math.sqrt((x-v)*(x-v)+(p-b)*(p-b)+(A-f)*(A-f));return Math.abs(S)<.001&&(S=1),this.x=(x-v)/S,this.y=(p-b)/S,this.z=(A-f)/S,this.w=Math.acos((d+g+E-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class xz extends Ga{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Bs(0,0,e,n),this.scissorTest=!1,this.viewport=new Bs(0,0,e,n);const o={width:e,height:n,depth:1};i.encoding!==void 0&&(iu("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===nu?ms:aa),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:fo,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Js(o,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,n,i=1){(this.width!==e||this.height!==n||this.depth!==i)&&(this.width=e,this.height=n,this.depth=i,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new mB(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Yc extends xz{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class gB extends Js{constructor(e=null,n=1,i=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:o},this.magFilter=mo,this.minFilter=mo,this.wrapR=Pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ez extends Js{constructor(e=null,n=1,i=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:o},this.magFilter=mo,this.minFilter=mo,this.wrapR=Pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class za{constructor(e=0,n=0,i=0,o=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=o}static slerpFlat(e,n,i,o,a,c,u){let h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];const A=a[c+0],g=a[c+1],v=a[c+2],b=a[c+3];if(u===0){e[n+0]=h,e[n+1]=d,e[n+2]=f,e[n+3]=p;return}if(u===1){e[n+0]=A,e[n+1]=g,e[n+2]=v,e[n+3]=b;return}if(p!==b||h!==A||d!==g||f!==v){let x=1-u;const E=h*A+d*g+f*v+p*b,S=E>=0?1:-1,M=1-E*E;if(M>Number.EPSILON){const T=Math.sqrt(M),L=Math.atan2(T,E*S);x=Math.sin(x*L)/T,u=Math.sin(u*L)/T}const C=u*S;if(h=h*x+A*C,d=d*x+g*C,f=f*x+v*C,p=p*x+b*C,x===1-u){const T=1/Math.sqrt(h*h+d*d+f*f+p*p);h*=T,d*=T,f*=T,p*=T}}e[n]=h,e[n+1]=d,e[n+2]=f,e[n+3]=p}static multiplyQuaternionsFlat(e,n,i,o,a,c){const u=i[o],h=i[o+1],d=i[o+2],f=i[o+3],p=a[c],A=a[c+1],g=a[c+2],v=a[c+3];return e[n]=u*v+f*p+h*g-d*A,e[n+1]=h*v+f*A+d*p-u*g,e[n+2]=d*v+f*g+u*A-h*p,e[n+3]=f*v-u*p-h*A-d*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,o){return this._x=e,this._y=n,this._z=i,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,o=e._y,a=e._z,c=e._order,u=Math.cos,h=Math.sin,d=u(i/2),f=u(o/2),p=u(a/2),A=h(i/2),g=h(o/2),v=h(a/2);switch(c){case"XYZ":this._x=A*f*p+d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p-A*g*v;break;case"YXZ":this._x=A*f*p+d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p+A*g*v;break;case"ZXY":this._x=A*f*p-d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p-A*g*v;break;case"ZYX":this._x=A*f*p-d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p+A*g*v;break;case"YZX":this._x=A*f*p+d*g*v,this._y=d*g*p+A*f*v,this._z=d*f*v-A*g*p,this._w=d*f*p-A*g*v;break;case"XZY":this._x=A*f*p-d*g*v,this._y=d*g*p-A*f*v,this._z=d*f*v+A*g*p,this._w=d*f*p+A*g*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,o=Math.sin(i);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],o=n[4],a=n[8],c=n[1],u=n[5],h=n[9],d=n[2],f=n[6],p=n[10],A=i+u+p;if(A>0){const g=.5/Math.sqrt(A+1);this._w=.25/g,this._x=(f-h)*g,this._y=(a-d)*g,this._z=(c-o)*g}else if(i>u&&i>p){const g=2*Math.sqrt(1+i-u-p);this._w=(f-h)/g,this._x=.25*g,this._y=(o+c)/g,this._z=(a+d)/g}else if(u>p){const g=2*Math.sqrt(1+u-i-p);this._w=(a-d)/g,this._x=(o+c)/g,this._y=.25*g,this._z=(h+f)/g}else{const g=2*Math.sqrt(1+p-i-u);this._w=(c-o)/g,this._x=(a+d)/g,this._y=(h+f)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Is(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const o=Math.min(1,n/i);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,o=e._y,a=e._z,c=e._w,u=n._x,h=n._y,d=n._z,f=n._w;return this._x=i*f+c*u+o*d-a*h,this._y=o*f+c*h+a*u-i*d,this._z=a*f+c*d+i*h-o*u,this._w=c*f-i*u-o*h-a*d,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,o=this._y,a=this._z,c=this._w;let u=c*e._w+i*e._x+o*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=c,this._x=i,this._y=o,this._z=a,this;const h=1-u*u;if(h<=Number.EPSILON){const g=1-n;return this._w=g*c+n*this._w,this._x=g*i+n*this._x,this._y=g*o+n*this._y,this._z=g*a+n*this._z,this.normalize(),this}const d=Math.sqrt(h),f=Math.atan2(d,u),p=Math.sin((1-n)*f)/d,A=Math.sin(n*f)/d;return this._w=c*p+this._w*A,this._x=i*p+this._x*A,this._y=o*p+this._y*A,this._z=a*p+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),o=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(n*Math.cos(o),i*Math.sin(a),i*Math.cos(a),n*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class it{constructor(e=0,n=0,i=0){it.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(kT.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(kT.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,o=this.z,a=e.elements;return this.x=a[0]*n+a[3]*i+a[6]*o,this.y=a[1]*n+a[4]*i+a[7]*o,this.z=a[2]*n+a[5]*i+a[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,o=this.z,a=e.elements,c=1/(a[3]*n+a[7]*i+a[11]*o+a[15]);return this.x=(a[0]*n+a[4]*i+a[8]*o+a[12])*c,this.y=(a[1]*n+a[5]*i+a[9]*o+a[13])*c,this.z=(a[2]*n+a[6]*i+a[10]*o+a[14])*c,this}applyQuaternion(e){const n=this.x,i=this.y,o=this.z,a=e.x,c=e.y,u=e.z,h=e.w,d=2*(c*o-u*i),f=2*(u*n-a*o),p=2*(a*i-c*n);return this.x=n+h*d+c*p-u*f,this.y=i+h*f+u*d-a*p,this.z=o+h*p+a*f-c*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,o=this.z,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*o,this.y=a[1]*n+a[5]*i+a[9]*o,this.z=a[2]*n+a[6]*i+a[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,o=e.y,a=e.z,c=n.x,u=n.y,h=n.z;return this.x=o*h-a*u,this.y=a*c-i*h,this.z=i*u-o*c,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return vE.copy(this).projectOnVector(e),this.sub(vE)}reflect(e){return this.sub(vE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Is(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,o=this.z-e.z;return n*n+i*i+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const o=Math.sin(n)*e;return this.x=o*Math.sin(i),this.y=Math.cos(n)*e,this.z=o*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=o,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const vE=new it,kT=new za;class hu{constructor(e=new it(1/0,1/0,1/0),n=new it(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Ma.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Ma.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Ma.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const a=i.getAttribute("position");if(n===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let c=0,u=a.count;c<u;c++)e.isMesh===!0?e.getVertexPosition(c,Ma):Ma.fromBufferAttribute(a,c),Ma.applyMatrix4(e.matrixWorld),this.expandByPoint(Ma);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),o0.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),o0.copy(i.boundingBox)),o0.applyMatrix4(e.matrixWorld),this.union(o0)}const o=e.children;for(let a=0,c=o.length;a<c;a++)this.expandByObject(o[a],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ma),Ma.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(wp),a0.subVectors(this.max,wp),Md.subVectors(e.a,wp),Cd.subVectors(e.b,wp),Sd.subVectors(e.c,wp),Ic.subVectors(Cd,Md),Bc.subVectors(Sd,Cd),zh.subVectors(Md,Sd);let n=[0,-Ic.z,Ic.y,0,-Bc.z,Bc.y,0,-zh.z,zh.y,Ic.z,0,-Ic.x,Bc.z,0,-Bc.x,zh.z,0,-zh.x,-Ic.y,Ic.x,0,-Bc.y,Bc.x,0,-zh.y,zh.x,0];return!yE(n,Md,Cd,Sd,a0)||(n=[1,0,0,0,1,0,0,0,1],!yE(n,Md,Cd,Sd,a0))?!1:(l0.crossVectors(Ic,Bc),n=[l0.x,l0.y,l0.z],yE(n,Md,Cd,Sd,a0))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ma).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ma).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Bl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Bl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Bl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Bl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Bl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Bl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Bl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Bl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Bl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Bl=[new it,new it,new it,new it,new it,new it,new it,new it],Ma=new it,o0=new hu,Md=new it,Cd=new it,Sd=new it,Ic=new it,Bc=new it,zh=new it,wp=new it,a0=new it,l0=new it,Gh=new it;function yE(s,e,n,i,o){for(let a=0,c=s.length-3;a<=c;a+=3){Gh.fromArray(s,a);const u=o.x*Math.abs(Gh.x)+o.y*Math.abs(Gh.y)+o.z*Math.abs(Gh.z),h=e.dot(Gh),d=n.dot(Gh),f=i.dot(Gh);if(Math.max(-Math.max(h,d,f),Math.min(h,d,f))>u)return!1}return!0}const bz=new hu,Mp=new it,xE=new it;class Qv{constructor(e=new it,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):bz.setFromPoints(e).getCenter(i);let o=0;for(let a=0,c=e.length;a<c;a++)o=Math.max(o,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Mp.subVectors(e,this.center);const n=Mp.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),o=(i-this.radius)*.5;this.center.addScaledVector(Mp,o/i),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(xE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Mp.copy(e.center).add(xE)),this.expandByPoint(Mp.copy(e.center).sub(xE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ll=new it,EE=new it,c0=new it,Lc=new it,bE=new it,h0=new it,_E=new it;class Xv{constructor(e=new it,n=new it(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ll)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Ll.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Ll.copy(this.origin).addScaledVector(this.direction,n),Ll.distanceToSquared(e))}distanceSqToSegment(e,n,i,o){EE.copy(e).add(n).multiplyScalar(.5),c0.copy(n).sub(e).normalize(),Lc.copy(this.origin).sub(EE);const a=e.distanceTo(n)*.5,c=-this.direction.dot(c0),u=Lc.dot(this.direction),h=-Lc.dot(c0),d=Lc.lengthSq(),f=Math.abs(1-c*c);let p,A,g,v;if(f>0)if(p=c*h-u,A=c*u-h,v=a*f,p>=0)if(A>=-v)if(A<=v){const b=1/f;p*=b,A*=b,g=p*(p+c*A+2*u)+A*(c*p+A+2*h)+d}else A=a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;else A=-a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;else A<=-v?(p=Math.max(0,-(-c*a+u)),A=p>0?-a:Math.min(Math.max(-a,-h),a),g=-p*p+A*(A+2*h)+d):A<=v?(p=0,A=Math.min(Math.max(-a,-h),a),g=A*(A+2*h)+d):(p=Math.max(0,-(c*a+u)),A=p>0?a:Math.min(Math.max(-a,-h),a),g=-p*p+A*(A+2*h)+d);else A=c>0?-a:a,p=Math.max(0,-(c*A+u)),g=-p*p+A*(A+2*h)+d;return i&&i.copy(this.origin).addScaledVector(this.direction,p),o&&o.copy(EE).addScaledVector(c0,A),g}intersectSphere(e,n){Ll.subVectors(e.center,this.origin);const i=Ll.dot(this.direction),o=Ll.dot(Ll)-i*i,a=e.radius*e.radius;if(o>a)return null;const c=Math.sqrt(a-o),u=i-c,h=i+c;return h<0?null:u<0?this.at(h,n):this.at(u,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,o,a,c,u,h;const d=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,A=this.origin;return d>=0?(i=(e.min.x-A.x)*d,o=(e.max.x-A.x)*d):(i=(e.max.x-A.x)*d,o=(e.min.x-A.x)*d),f>=0?(a=(e.min.y-A.y)*f,c=(e.max.y-A.y)*f):(a=(e.max.y-A.y)*f,c=(e.min.y-A.y)*f),i>c||a>o||((a>i||isNaN(i))&&(i=a),(c<o||isNaN(o))&&(o=c),p>=0?(u=(e.min.z-A.z)*p,h=(e.max.z-A.z)*p):(u=(e.max.z-A.z)*p,h=(e.min.z-A.z)*p),i>h||u>o)||((u>i||i!==i)&&(i=u),(h<o||o!==o)&&(o=h),o<0)?null:this.at(i>=0?i:o,n)}intersectsBox(e){return this.intersectBox(e,Ll)!==null}intersectTriangle(e,n,i,o,a){bE.subVectors(n,e),h0.subVectors(i,e),_E.crossVectors(bE,h0);let c=this.direction.dot(_E),u;if(c>0){if(o)return null;u=1}else if(c<0)u=-1,c=-c;else return null;Lc.subVectors(this.origin,e);const h=u*this.direction.dot(h0.crossVectors(Lc,h0));if(h<0)return null;const d=u*this.direction.dot(bE.cross(Lc));if(d<0||h+d>c)return null;const f=-u*Lc.dot(_E);return f<0?null:this.at(f/c,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Gr{constructor(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x){Gr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x)}set(e,n,i,o,a,c,u,h,d,f,p,A,g,v,b,x){const E=this.elements;return E[0]=e,E[4]=n,E[8]=i,E[12]=o,E[1]=a,E[5]=c,E[9]=u,E[13]=h,E[2]=d,E[6]=f,E[10]=p,E[14]=A,E[3]=g,E[7]=v,E[11]=b,E[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Gr().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,o=1/Td.setFromMatrixColumn(e,0).length(),a=1/Td.setFromMatrixColumn(e,1).length(),c=1/Td.setFromMatrixColumn(e,2).length();return n[0]=i[0]*o,n[1]=i[1]*o,n[2]=i[2]*o,n[3]=0,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[7]=0,n[8]=i[8]*c,n[9]=i[9]*c,n[10]=i[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,o=e.y,a=e.z,c=Math.cos(i),u=Math.sin(i),h=Math.cos(o),d=Math.sin(o),f=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){const A=c*f,g=c*p,v=u*f,b=u*p;n[0]=h*f,n[4]=-h*p,n[8]=d,n[1]=g+v*d,n[5]=A-b*d,n[9]=-u*h,n[2]=b-A*d,n[6]=v+g*d,n[10]=c*h}else if(e.order==="YXZ"){const A=h*f,g=h*p,v=d*f,b=d*p;n[0]=A+b*u,n[4]=v*u-g,n[8]=c*d,n[1]=c*p,n[5]=c*f,n[9]=-u,n[2]=g*u-v,n[6]=b+A*u,n[10]=c*h}else if(e.order==="ZXY"){const A=h*f,g=h*p,v=d*f,b=d*p;n[0]=A-b*u,n[4]=-c*p,n[8]=v+g*u,n[1]=g+v*u,n[5]=c*f,n[9]=b-A*u,n[2]=-c*d,n[6]=u,n[10]=c*h}else if(e.order==="ZYX"){const A=c*f,g=c*p,v=u*f,b=u*p;n[0]=h*f,n[4]=v*d-g,n[8]=A*d+b,n[1]=h*p,n[5]=b*d+A,n[9]=g*d-v,n[2]=-d,n[6]=u*h,n[10]=c*h}else if(e.order==="YZX"){const A=c*h,g=c*d,v=u*h,b=u*d;n[0]=h*f,n[4]=b-A*p,n[8]=v*p+g,n[1]=p,n[5]=c*f,n[9]=-u*f,n[2]=-d*f,n[6]=g*p+v,n[10]=A-b*p}else if(e.order==="XZY"){const A=c*h,g=c*d,v=u*h,b=u*d;n[0]=h*f,n[4]=-p,n[8]=d*f,n[1]=A*p+b,n[5]=c*f,n[9]=g*p-v,n[2]=v*p-g,n[6]=u*f,n[10]=b*p+A}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(_z,e,wz)}lookAt(e,n,i){const o=this.elements;return Ho.subVectors(e,n),Ho.lengthSq()===0&&(Ho.z=1),Ho.normalize(),Pc.crossVectors(i,Ho),Pc.lengthSq()===0&&(Math.abs(i.z)===1?Ho.x+=1e-4:Ho.z+=1e-4,Ho.normalize(),Pc.crossVectors(i,Ho)),Pc.normalize(),u0.crossVectors(Ho,Pc),o[0]=Pc.x,o[4]=u0.x,o[8]=Ho.x,o[1]=Pc.y,o[5]=u0.y,o[9]=Ho.y,o[2]=Pc.z,o[6]=u0.z,o[10]=Ho.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,o=n.elements,a=this.elements,c=i[0],u=i[4],h=i[8],d=i[12],f=i[1],p=i[5],A=i[9],g=i[13],v=i[2],b=i[6],x=i[10],E=i[14],S=i[3],M=i[7],C=i[11],T=i[15],L=o[0],B=o[4],F=o[8],D=o[12],P=o[1],U=o[5],K=o[9],J=o[13],z=o[2],j=o[6],G=o[10],H=o[14],te=o[3],Z=o[7],ee=o[11],oe=o[15];return a[0]=c*L+u*P+h*z+d*te,a[4]=c*B+u*U+h*j+d*Z,a[8]=c*F+u*K+h*G+d*ee,a[12]=c*D+u*J+h*H+d*oe,a[1]=f*L+p*P+A*z+g*te,a[5]=f*B+p*U+A*j+g*Z,a[9]=f*F+p*K+A*G+g*ee,a[13]=f*D+p*J+A*H+g*oe,a[2]=v*L+b*P+x*z+E*te,a[6]=v*B+b*U+x*j+E*Z,a[10]=v*F+b*K+x*G+E*ee,a[14]=v*D+b*J+x*H+E*oe,a[3]=S*L+M*P+C*z+T*te,a[7]=S*B+M*U+C*j+T*Z,a[11]=S*F+M*K+C*G+T*ee,a[15]=S*D+M*J+C*H+T*oe,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],o=e[8],a=e[12],c=e[1],u=e[5],h=e[9],d=e[13],f=e[2],p=e[6],A=e[10],g=e[14],v=e[3],b=e[7],x=e[11],E=e[15];return v*(+a*h*p-o*d*p-a*u*A+i*d*A+o*u*g-i*h*g)+b*(+n*h*g-n*d*A+a*c*A-o*c*g+o*d*f-a*h*f)+x*(+n*d*p-n*u*g-a*c*p+i*c*g+a*u*f-i*d*f)+E*(-o*u*f-n*h*p+n*u*A+o*c*p-i*c*A+i*h*f)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=n,o[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],o=e[2],a=e[3],c=e[4],u=e[5],h=e[6],d=e[7],f=e[8],p=e[9],A=e[10],g=e[11],v=e[12],b=e[13],x=e[14],E=e[15],S=p*x*d-b*A*d+b*h*g-u*x*g-p*h*E+u*A*E,M=v*A*d-f*x*d-v*h*g+c*x*g+f*h*E-c*A*E,C=f*b*d-v*p*d+v*u*g-c*b*g-f*u*E+c*p*E,T=v*p*h-f*b*h-v*u*A+c*b*A+f*u*x-c*p*x,L=n*S+i*M+o*C+a*T;if(L===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const B=1/L;return e[0]=S*B,e[1]=(b*A*a-p*x*a-b*o*g+i*x*g+p*o*E-i*A*E)*B,e[2]=(u*x*a-b*h*a+b*o*d-i*x*d-u*o*E+i*h*E)*B,e[3]=(p*h*a-u*A*a-p*o*d+i*A*d+u*o*g-i*h*g)*B,e[4]=M*B,e[5]=(f*x*a-v*A*a+v*o*g-n*x*g-f*o*E+n*A*E)*B,e[6]=(v*h*a-c*x*a-v*o*d+n*x*d+c*o*E-n*h*E)*B,e[7]=(c*A*a-f*h*a+f*o*d-n*A*d-c*o*g+n*h*g)*B,e[8]=C*B,e[9]=(v*p*a-f*b*a-v*i*g+n*b*g+f*i*E-n*p*E)*B,e[10]=(c*b*a-v*u*a+v*i*d-n*b*d-c*i*E+n*u*E)*B,e[11]=(f*u*a-c*p*a-f*i*d+n*p*d+c*i*g-n*u*g)*B,e[12]=T*B,e[13]=(f*b*o-v*p*o+v*i*A-n*b*A-f*i*x+n*p*x)*B,e[14]=(v*u*o-c*b*o-v*i*h+n*b*h+c*i*x-n*u*x)*B,e[15]=(c*p*o-f*u*o+f*i*h-n*p*h-c*i*A+n*u*A)*B,this}scale(e){const n=this.elements,i=e.x,o=e.y,a=e.z;return n[0]*=i,n[4]*=o,n[8]*=a,n[1]*=i,n[5]*=o,n[9]*=a,n[2]*=i,n[6]*=o,n[10]*=a,n[3]*=i,n[7]*=o,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,o))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),o=Math.sin(n),a=1-i,c=e.x,u=e.y,h=e.z,d=a*c,f=a*u;return this.set(d*c+i,d*u-o*h,d*h+o*u,0,d*u+o*h,f*u+i,f*h-o*c,0,d*h-o*u,f*h+o*c,a*h*h+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,o,a,c){return this.set(1,i,a,0,e,1,c,0,n,o,1,0,0,0,0,1),this}compose(e,n,i){const o=this.elements,a=n._x,c=n._y,u=n._z,h=n._w,d=a+a,f=c+c,p=u+u,A=a*d,g=a*f,v=a*p,b=c*f,x=c*p,E=u*p,S=h*d,M=h*f,C=h*p,T=i.x,L=i.y,B=i.z;return o[0]=(1-(b+E))*T,o[1]=(g+C)*T,o[2]=(v-M)*T,o[3]=0,o[4]=(g-C)*L,o[5]=(1-(A+E))*L,o[6]=(x+S)*L,o[7]=0,o[8]=(v+M)*B,o[9]=(x-S)*B,o[10]=(1-(A+b))*B,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,n,i){const o=this.elements;let a=Td.set(o[0],o[1],o[2]).length();const c=Td.set(o[4],o[5],o[6]).length(),u=Td.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),e.x=o[12],e.y=o[13],e.z=o[14],Ca.copy(this);const d=1/a,f=1/c,p=1/u;return Ca.elements[0]*=d,Ca.elements[1]*=d,Ca.elements[2]*=d,Ca.elements[4]*=f,Ca.elements[5]*=f,Ca.elements[6]*=f,Ca.elements[8]*=p,Ca.elements[9]*=p,Ca.elements[10]*=p,n.setFromRotationMatrix(Ca),i.x=a,i.y=c,i.z=u,this}makePerspective(e,n,i,o,a,c,u=Ql){const h=this.elements,d=2*a/(n-e),f=2*a/(i-o),p=(n+e)/(n-e),A=(i+o)/(i-o);let g,v;if(u===Ql)g=-(c+a)/(c-a),v=-2*c*a/(c-a);else if(u===gv)g=-c/(c-a),v=-c*a/(c-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return h[0]=d,h[4]=0,h[8]=p,h[12]=0,h[1]=0,h[5]=f,h[9]=A,h[13]=0,h[2]=0,h[6]=0,h[10]=g,h[14]=v,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,n,i,o,a,c,u=Ql){const h=this.elements,d=1/(n-e),f=1/(i-o),p=1/(c-a),A=(n+e)*d,g=(i+o)*f;let v,b;if(u===Ql)v=(c+a)*p,b=-2*p;else if(u===gv)v=a*p,b=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return h[0]=2*d,h[4]=0,h[8]=0,h[12]=-A,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-g,h[2]=0,h[6]=0,h[10]=b,h[14]=-v,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let o=0;o<16;o++)if(n[o]!==i[o])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const Td=new it,Ca=new Gr,_z=new it(0,0,0),wz=new it(1,1,1),Pc=new it,u0=new it,Ho=new it,zT=new Gr,GT=new za;class Kv{constructor(e=0,n=0,i=0,o=Kv.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,o=this._order){return this._x=e,this._y=n,this._z=i,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const o=e.elements,a=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],A=o[6],g=o[10];switch(n){case"XYZ":this._y=Math.asin(Is(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,g),this._z=Math.atan2(-c,a)):(this._x=Math.atan2(A,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Is(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,g),this._z=Math.atan2(h,d)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(Is(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-p,g),this._z=Math.atan2(-c,d)):(this._y=0,this._z=Math.atan2(h,a));break;case"ZYX":this._y=Math.asin(-Is(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(A,g),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-c,d));break;case"YZX":this._z=Math.asin(Is(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(u,g));break;case"XZY":this._z=Math.asin(-Is(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(A,d),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-f,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return zT.makeRotationFromQuaternion(e),this.setFromRotationMatrix(zT,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return GT.setFromEuler(this),this.setFromQuaternion(GT,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Kv.DEFAULT_ORDER="XYZ";class H_{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Mz=0;const VT=new it,Rd=new za,Pl=new Gr,d0=new it,Cp=new it,Cz=new it,Sz=new za,HT=new it(1,0,0),jT=new it(0,1,0),WT=new it(0,0,1),Tz={type:"added"},Rz={type:"removed"};class Ls extends Ga{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Mz++}),this.uuid=Jl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ls.DEFAULT_UP.clone();const e=new it,n=new Kv,i=new za,o=new it(1,1,1);function a(){i.setFromEuler(n,!1)}function c(){n.setFromQuaternion(i,void 0,!1)}n._onChange(a),i._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Gr},normalMatrix:{value:new tr}}),this.matrix=new Gr,this.matrixWorld=new Gr,this.matrixAutoUpdate=Ls.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ls.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new H_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Rd.setFromAxisAngle(e,n),this.quaternion.multiply(Rd),this}rotateOnWorldAxis(e,n){return Rd.setFromAxisAngle(e,n),this.quaternion.premultiply(Rd),this}rotateX(e){return this.rotateOnAxis(HT,e)}rotateY(e){return this.rotateOnAxis(jT,e)}rotateZ(e){return this.rotateOnAxis(WT,e)}translateOnAxis(e,n){return VT.copy(e).applyQuaternion(this.quaternion),this.position.add(VT.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(HT,e)}translateY(e){return this.translateOnAxis(jT,e)}translateZ(e){return this.translateOnAxis(WT,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Pl.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?d0.copy(e):d0.set(e,n,i);const o=this.parent;this.updateWorldMatrix(!0,!1),Cp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Pl.lookAt(Cp,d0,this.up):Pl.lookAt(d0,Cp,this.up),this.quaternion.setFromRotationMatrix(Pl),o&&(Pl.extractRotation(o.matrixWorld),Rd.setFromRotationMatrix(Pl),this.quaternion.premultiply(Rd.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Tz)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Rz)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Pl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Pl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Pl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,o=this.children.length;i<o;i++){const c=this.children[i].getObjectByProperty(e,n);if(c!==void 0)return c}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const o=this.children;for(let a=0,c=o.length;a<c;a++)o[a].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cp,e,Cz),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cp,Sz,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,o=n.length;i<o;i++){const a=n[i];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const o=this.children;for(let a=0,c=o.length;a<c;a++){const u=o[a];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.visibility=this._visibility,o.active=this._active,o.bounds=this._bounds.map(u=>({boxInitialized:u.boxInitialized,boxMin:u.box.min.toArray(),boxMax:u.box.max.toArray(),sphereInitialized:u.sphereInitialized,sphereRadius:u.sphere.radius,sphereCenter:u.sphere.center.toArray()})),o.maxGeometryCount=this._maxGeometryCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.geometryCount=this._geometryCount,o.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(o.boundingSphere={center:o.boundingSphere.center.toArray(),radius:o.boundingSphere.radius}),this.boundingBox!==null&&(o.boundingBox={min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}));function a(u,h){return u[h.uuid]===void 0&&(u[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=a(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const h=u.shapes;if(Array.isArray(h))for(let d=0,f=h.length;d<f;d++){const p=h[d];a(e.shapes,p)}else a(e.shapes,h)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let h=0,d=this.material.length;h<d;h++)u.push(a(e.materials,this.material[h]));o.material=u}else o.material=a(e.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++){const h=this.animations[u];o.animations.push(a(e.animations,h))}}if(n){const u=c(e.geometries),h=c(e.materials),d=c(e.textures),f=c(e.images),p=c(e.shapes),A=c(e.skeletons),g=c(e.animations),v=c(e.nodes);u.length>0&&(i.geometries=u),h.length>0&&(i.materials=h),d.length>0&&(i.textures=d),f.length>0&&(i.images=f),p.length>0&&(i.shapes=p),A.length>0&&(i.skeletons=A),g.length>0&&(i.animations=g),v.length>0&&(i.nodes=v)}return i.object=o,i;function c(u){const h=[];for(const d in u){const f=u[d];delete f.metadata,h.push(f)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const o=e.children[i];this.add(o.clone())}return this}}Ls.DEFAULT_UP=new it(0,1,0);Ls.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ls.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Sa=new it,Dl=new it,wE=new it,Ol=new it,Id=new it,Bd=new it,QT=new it,ME=new it,CE=new it,SE=new it;class Fa{constructor(e=new it,n=new it,i=new it){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,o){o.subVectors(i,n),Sa.subVectors(e,n),o.cross(Sa);const a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}static getBarycoord(e,n,i,o,a){Sa.subVectors(o,n),Dl.subVectors(i,n),wE.subVectors(e,n);const c=Sa.dot(Sa),u=Sa.dot(Dl),h=Sa.dot(wE),d=Dl.dot(Dl),f=Dl.dot(wE),p=c*d-u*u;if(p===0)return a.set(0,0,0),null;const A=1/p,g=(d*h-u*f)*A,v=(c*f-u*h)*A;return a.set(1-g-v,v,g)}static containsPoint(e,n,i,o){return this.getBarycoord(e,n,i,o,Ol)===null?!1:Ol.x>=0&&Ol.y>=0&&Ol.x+Ol.y<=1}static getInterpolation(e,n,i,o,a,c,u,h){return this.getBarycoord(e,n,i,o,Ol)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(a,Ol.x),h.addScaledVector(c,Ol.y),h.addScaledVector(u,Ol.z),h)}static isFrontFacing(e,n,i,o){return Sa.subVectors(i,n),Dl.subVectors(e,n),Sa.cross(Dl).dot(o)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,o){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,n,i,o){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sa.subVectors(this.c,this.b),Dl.subVectors(this.a,this.b),Sa.cross(Dl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Fa.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Fa.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,o,a){return Fa.getInterpolation(e,this.a,this.b,this.c,n,i,o,a)}containsPoint(e){return Fa.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Fa.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,o=this.b,a=this.c;let c,u;Id.subVectors(o,i),Bd.subVectors(a,i),ME.subVectors(e,i);const h=Id.dot(ME),d=Bd.dot(ME);if(h<=0&&d<=0)return n.copy(i);CE.subVectors(e,o);const f=Id.dot(CE),p=Bd.dot(CE);if(f>=0&&p<=f)return n.copy(o);const A=h*p-f*d;if(A<=0&&h>=0&&f<=0)return c=h/(h-f),n.copy(i).addScaledVector(Id,c);SE.subVectors(e,a);const g=Id.dot(SE),v=Bd.dot(SE);if(v>=0&&g<=v)return n.copy(a);const b=g*d-h*v;if(b<=0&&d>=0&&v<=0)return u=d/(d-v),n.copy(i).addScaledVector(Bd,u);const x=f*v-g*p;if(x<=0&&p-f>=0&&g-v>=0)return QT.subVectors(a,o),u=(p-f)/(p-f+(g-v)),n.copy(o).addScaledVector(QT,u);const E=1/(x+b+A);return c=b*E,u=A*E,n.copy(i).addScaledVector(Id,c).addScaledVector(Bd,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const AB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Dc={h:0,s:0,l:0},f0={h:0,s:0,l:0};function TE(s,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?s+(e-s)*6*n:n<1/2?e:n<2/3?s+(e-s)*6*(2/3-n):s}let or=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const o=e;o&&o.isColor?this.copy(o):typeof o=="number"?this.setHex(o):typeof o=="string"&&this.setStyle(o)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=ms){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Mr.toWorkingColorSpace(this,n),this}setRGB(e,n,i,o=Mr.workingColorSpace){return this.r=e,this.g=n,this.b=i,Mr.toWorkingColorSpace(this,o),this}setHSL(e,n,i,o=Mr.workingColorSpace){if(e=V_(e,1),n=Is(n,0,1),i=Is(i,0,1),n===0)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+n):i+n-i*n,c=2*i-a;this.r=TE(c,a,e+1/3),this.g=TE(c,a,e),this.b=TE(c,a,e-1/3)}return Mr.toWorkingColorSpace(this,o),this}setStyle(e,n=ms){function i(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const c=o[1],u=o[2];switch(c){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=o[1],c=a.length;if(c===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(c===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=ms){const i=AB[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=af(e.r),this.g=af(e.g),this.b=af(e.b),this}copyLinearToSRGB(e){return this.r=gE(e.r),this.g=gE(e.g),this.b=gE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ms){return Mr.fromWorkingColorSpace(Ys.copy(this),e),Math.round(Is(Ys.r*255,0,255))*65536+Math.round(Is(Ys.g*255,0,255))*256+Math.round(Is(Ys.b*255,0,255))}getHexString(e=ms){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Mr.workingColorSpace){Mr.fromWorkingColorSpace(Ys.copy(this),n);const i=Ys.r,o=Ys.g,a=Ys.b,c=Math.max(i,o,a),u=Math.min(i,o,a);let h,d;const f=(u+c)/2;if(u===c)h=0,d=0;else{const p=c-u;switch(d=f<=.5?p/(c+u):p/(2-c-u),c){case i:h=(o-a)/p+(o<a?6:0);break;case o:h=(a-i)/p+2;break;case a:h=(i-o)/p+4;break}h/=6}return e.h=h,e.s=d,e.l=f,e}getRGB(e,n=Mr.workingColorSpace){return Mr.fromWorkingColorSpace(Ys.copy(this),n),e.r=Ys.r,e.g=Ys.g,e.b=Ys.b,e}getStyle(e=ms){Mr.fromWorkingColorSpace(Ys.copy(this),e);const n=Ys.r,i=Ys.g,o=Ys.b;return e!==ms?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(o*255)})`}offsetHSL(e,n,i){return this.getHSL(Dc),this.setHSL(Dc.h+e,Dc.s+n,Dc.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Dc),e.getHSL(f0);const i=tm(Dc.h,f0.h,n),o=tm(Dc.s,f0.s,n),a=tm(Dc.l,f0.l,n);return this.setHSL(i,o,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,o=this.b,a=e.elements;return this.r=a[0]*n+a[3]*i+a[6]*o,this.g=a[1]*n+a[4]*i+a[7]*o,this.b=a[2]*n+a[5]*i+a[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ys=new or;or.NAMES=AB;let Iz=0;class uu extends Ga{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Iz++}),this.uuid=Jl(),this.name="",this.type="Material",this.blending=of,this.side=qc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Pb,this.blendDst=Db,this.blendEquation=Kh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new or(0,0,0),this.blendAlpha=0,this.depthFunc=dv,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=PT,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=_d,this.stencilZFail=_d,this.stencilZPass=_d,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const o=this[n];if(o===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}o&&o.isColor?o.set(i):o&&o.isVector3&&i&&i.isVector3?o.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==of&&(i.blending=this.blending),this.side!==qc&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Pb&&(i.blendSrc=this.blendSrc),this.blendDst!==Db&&(i.blendDst=this.blendDst),this.blendEquation!==Kh&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==dv&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==PT&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==_d&&(i.stencilFail=this.stencilFail),this.stencilZFail!==_d&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==_d&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function o(a){const c=[];for(const u in a){const h=a[u];delete h.metadata,c.push(h)}return c}if(n){const a=o(e.textures),c=o(e.images);a.length>0&&(i.textures=a),c.length>0&&(i.images=c)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const o=n.length;i=new Array(o);for(let a=0;a!==o;++a)i[a]=n[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class qv extends uu{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=k_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const os=new it,p0=new Mn;class ha{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=kb,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Wl,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return iu("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let o=0,a=this.itemSize;o<a;o++)this.array[e+o]=n.array[i+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)p0.fromBufferAttribute(this,n),p0.applyMatrix3(e),this.setXY(n,p0.x,p0.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)os.fromBufferAttribute(this,n),os.applyMatrix3(e),this.setXYZ(n,os.x,os.y,os.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)os.fromBufferAttribute(this,n),os.applyMatrix4(e),this.setXYZ(n,os.x,os.y,os.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)os.fromBufferAttribute(this,n),os.applyNormalMatrix(e),this.setXYZ(n,os.x,os.y,os.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)os.fromBufferAttribute(this,n),os.transformDirection(e),this.setXYZ(n,os.x,os.y,os.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Oa(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=_r(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Oa(n,this.array)),n}setX(e,n){return this.normalized&&(n=_r(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Oa(n,this.array)),n}setY(e,n){return this.normalized&&(n=_r(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Oa(n,this.array)),n}setZ(e,n){return this.normalized&&(n=_r(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Oa(n,this.array)),n}setW(e,n){return this.normalized&&(n=_r(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=_r(n,this.array),i=_r(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,o){return e*=this.itemSize,this.normalized&&(n=_r(n,this.array),i=_r(i,this.array),o=_r(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=o,this}setXYZW(e,n,i,o,a){return e*=this.itemSize,this.normalized&&(n=_r(n,this.array),i=_r(i,this.array),o=_r(o,this.array),a=_r(a,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=o,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==kb&&(e.usage=this.usage),e}}class vB extends ha{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class yB extends ha{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class As extends ha{constructor(e,n,i){super(new Float32Array(e),n,i)}}let Bz=0;const na=new Gr,RE=new Ls,Ld=new it,jo=new hu,Sp=new hu,Rs=new it;class Lo extends Ga{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Bz++}),this.uuid=Jl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(fB(e)?yB:vB)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const a=new tr().getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}const o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return na.makeRotationFromQuaternion(e),this.applyMatrix4(na),this}rotateX(e){return na.makeRotationX(e),this.applyMatrix4(na),this}rotateY(e){return na.makeRotationY(e),this.applyMatrix4(na),this}rotateZ(e){return na.makeRotationZ(e),this.applyMatrix4(na),this}translate(e,n,i){return na.makeTranslation(e,n,i),this.applyMatrix4(na),this}scale(e,n,i){return na.makeScale(e,n,i),this.applyMatrix4(na),this}lookAt(e){return RE.lookAt(e),RE.updateMatrix(),this.applyMatrix4(RE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ld).negate(),this.translate(Ld.x,Ld.y,Ld.z),this}setFromPoints(e){const n=[];for(let i=0,o=e.length;i<o;i++){const a=e[i];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new As(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hu);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new it(-1/0,-1/0,-1/0),new it(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,o=n.length;i<o;i++){const a=n[i];jo.setFromBufferAttribute(a),this.morphTargetsRelative?(Rs.addVectors(this.boundingBox.min,jo.min),this.boundingBox.expandByPoint(Rs),Rs.addVectors(this.boundingBox.max,jo.max),this.boundingBox.expandByPoint(Rs)):(this.boundingBox.expandByPoint(jo.min),this.boundingBox.expandByPoint(jo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qv);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new it,1/0);return}if(e){const i=this.boundingSphere.center;if(jo.setFromBufferAttribute(e),n)for(let a=0,c=n.length;a<c;a++){const u=n[a];Sp.setFromBufferAttribute(u),this.morphTargetsRelative?(Rs.addVectors(jo.min,Sp.min),jo.expandByPoint(Rs),Rs.addVectors(jo.max,Sp.max),jo.expandByPoint(Rs)):(jo.expandByPoint(Sp.min),jo.expandByPoint(Sp.max))}jo.getCenter(i);let o=0;for(let a=0,c=e.count;a<c;a++)Rs.fromBufferAttribute(e,a),o=Math.max(o,i.distanceToSquared(Rs));if(n)for(let a=0,c=n.length;a<c;a++){const u=n[a],h=this.morphTargetsRelative;for(let d=0,f=u.count;d<f;d++)Rs.fromBufferAttribute(u,d),h&&(Ld.fromBufferAttribute(e,d),Rs.add(Ld)),o=Math.max(o,i.distanceToSquared(Rs))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,o=n.position.array,a=n.normal.array,c=n.uv.array,u=o.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ha(new Float32Array(4*u),4));const h=this.getAttribute("tangent").array,d=[],f=[];for(let P=0;P<u;P++)d[P]=new it,f[P]=new it;const p=new it,A=new it,g=new it,v=new Mn,b=new Mn,x=new Mn,E=new it,S=new it;function M(P,U,K){p.fromArray(o,P*3),A.fromArray(o,U*3),g.fromArray(o,K*3),v.fromArray(c,P*2),b.fromArray(c,U*2),x.fromArray(c,K*2),A.sub(p),g.sub(p),b.sub(v),x.sub(v);const J=1/(b.x*x.y-x.x*b.y);isFinite(J)&&(E.copy(A).multiplyScalar(x.y).addScaledVector(g,-b.y).multiplyScalar(J),S.copy(g).multiplyScalar(b.x).addScaledVector(A,-x.x).multiplyScalar(J),d[P].add(E),d[U].add(E),d[K].add(E),f[P].add(S),f[U].add(S),f[K].add(S))}let C=this.groups;C.length===0&&(C=[{start:0,count:i.length}]);for(let P=0,U=C.length;P<U;++P){const K=C[P],J=K.start,z=K.count;for(let j=J,G=J+z;j<G;j+=3)M(i[j+0],i[j+1],i[j+2])}const T=new it,L=new it,B=new it,F=new it;function D(P){B.fromArray(a,P*3),F.copy(B);const U=d[P];T.copy(U),T.sub(B.multiplyScalar(B.dot(U))).normalize(),L.crossVectors(F,U);const J=L.dot(f[P])<0?-1:1;h[P*4]=T.x,h[P*4+1]=T.y,h[P*4+2]=T.z,h[P*4+3]=J}for(let P=0,U=C.length;P<U;++P){const K=C[P],J=K.start,z=K.count;for(let j=J,G=J+z;j<G;j+=3)D(i[j+0]),D(i[j+1]),D(i[j+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new ha(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let A=0,g=i.count;A<g;A++)i.setXYZ(A,0,0,0);const o=new it,a=new it,c=new it,u=new it,h=new it,d=new it,f=new it,p=new it;if(e)for(let A=0,g=e.count;A<g;A+=3){const v=e.getX(A+0),b=e.getX(A+1),x=e.getX(A+2);o.fromBufferAttribute(n,v),a.fromBufferAttribute(n,b),c.fromBufferAttribute(n,x),f.subVectors(c,a),p.subVectors(o,a),f.cross(p),u.fromBufferAttribute(i,v),h.fromBufferAttribute(i,b),d.fromBufferAttribute(i,x),u.add(f),h.add(f),d.add(f),i.setXYZ(v,u.x,u.y,u.z),i.setXYZ(b,h.x,h.y,h.z),i.setXYZ(x,d.x,d.y,d.z)}else for(let A=0,g=n.count;A<g;A+=3)o.fromBufferAttribute(n,A+0),a.fromBufferAttribute(n,A+1),c.fromBufferAttribute(n,A+2),f.subVectors(c,a),p.subVectors(o,a),f.cross(p),i.setXYZ(A+0,f.x,f.y,f.z),i.setXYZ(A+1,f.x,f.y,f.z),i.setXYZ(A+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Rs.fromBufferAttribute(e,n),Rs.normalize(),e.setXYZ(n,Rs.x,Rs.y,Rs.z)}toNonIndexed(){function e(u,h){const d=u.array,f=u.itemSize,p=u.normalized,A=new d.constructor(h.length*f);let g=0,v=0;for(let b=0,x=h.length;b<x;b++){u.isInterleavedBufferAttribute?g=h[b]*u.data.stride+u.offset:g=h[b]*f;for(let E=0;E<f;E++)A[v++]=d[g++]}return new ha(A,f,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Lo,i=this.index.array,o=this.attributes;for(const u in o){const h=o[u],d=e(h,i);n.setAttribute(u,d)}const a=this.morphAttributes;for(const u in a){const h=[],d=a[u];for(let f=0,p=d.length;f<p;f++){const A=d[f],g=e(A,i);h.push(g)}n.morphAttributes[u]=h}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let u=0,h=c.length;u<h;u++){const d=c[u];n.addGroup(d.start,d.count,d.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const d in h)h[d]!==void 0&&(e[d]=h[d]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const h in i){const d=i[h];e.data.attributes[h]=d.toJSON(e.data)}const o={};let a=!1;for(const h in this.morphAttributes){const d=this.morphAttributes[h],f=[];for(let p=0,A=d.length;p<A;p++){const g=d[p];f.push(g.toJSON(e.data))}f.length>0&&(o[h]=f,a=!0)}a&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const o=e.attributes;for(const d in o){const f=o[d];this.setAttribute(d,f.clone(n))}const a=e.morphAttributes;for(const d in a){const f=[],p=a[d];for(let A=0,g=p.length;A<g;A++)f.push(p[A].clone(n));this.morphAttributes[d]=f}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let d=0,f=c.length;d<f;d++){const p=c[d];this.addGroup(p.start,p.count,p.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const XT=new Gr,Vh=new Xv,m0=new Qv,KT=new it,Pd=new it,Dd=new it,Od=new it,IE=new it,g0=new it,A0=new Mn,v0=new Mn,y0=new Mn,qT=new it,YT=new it,$T=new it,x0=new it,E0=new it;class Qo extends Ls{constructor(e=new Lo,n=new qv){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=o.length;a<c;a++){const u=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(e,n){const i=this.geometry,o=i.attributes.position,a=i.morphAttributes.position,c=i.morphTargetsRelative;n.fromBufferAttribute(o,e);const u=this.morphTargetInfluences;if(a&&u){g0.set(0,0,0);for(let h=0,d=a.length;h<d;h++){const f=u[h],p=a[h];f!==0&&(IE.fromBufferAttribute(p,e),c?g0.addScaledVector(IE,f):g0.addScaledVector(IE.sub(n),f))}n.add(g0)}return n}raycast(e,n){const i=this.geometry,o=this.material,a=this.matrixWorld;o!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),m0.copy(i.boundingSphere),m0.applyMatrix4(a),Vh.copy(e.ray).recast(e.near),!(m0.containsPoint(Vh.origin)===!1&&(Vh.intersectSphere(m0,KT)===null||Vh.origin.distanceToSquared(KT)>(e.far-e.near)**2))&&(XT.copy(a).invert(),Vh.copy(e.ray).applyMatrix4(XT),!(i.boundingBox!==null&&Vh.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Vh)))}_computeIntersections(e,n,i){let o;const a=this.geometry,c=this.material,u=a.index,h=a.attributes.position,d=a.attributes.uv,f=a.attributes.uv1,p=a.attributes.normal,A=a.groups,g=a.drawRange;if(u!==null)if(Array.isArray(c))for(let v=0,b=A.length;v<b;v++){const x=A[v],E=c[x.materialIndex],S=Math.max(x.start,g.start),M=Math.min(u.count,Math.min(x.start+x.count,g.start+g.count));for(let C=S,T=M;C<T;C+=3){const L=u.getX(C),B=u.getX(C+1),F=u.getX(C+2);o=b0(this,E,e,i,d,f,p,L,B,F),o&&(o.faceIndex=Math.floor(C/3),o.face.materialIndex=x.materialIndex,n.push(o))}}else{const v=Math.max(0,g.start),b=Math.min(u.count,g.start+g.count);for(let x=v,E=b;x<E;x+=3){const S=u.getX(x),M=u.getX(x+1),C=u.getX(x+2);o=b0(this,c,e,i,d,f,p,S,M,C),o&&(o.faceIndex=Math.floor(x/3),n.push(o))}}else if(h!==void 0)if(Array.isArray(c))for(let v=0,b=A.length;v<b;v++){const x=A[v],E=c[x.materialIndex],S=Math.max(x.start,g.start),M=Math.min(h.count,Math.min(x.start+x.count,g.start+g.count));for(let C=S,T=M;C<T;C+=3){const L=C,B=C+1,F=C+2;o=b0(this,E,e,i,d,f,p,L,B,F),o&&(o.faceIndex=Math.floor(C/3),o.face.materialIndex=x.materialIndex,n.push(o))}}else{const v=Math.max(0,g.start),b=Math.min(h.count,g.start+g.count);for(let x=v,E=b;x<E;x+=3){const S=x,M=x+1,C=x+2;o=b0(this,c,e,i,d,f,p,S,M,C),o&&(o.faceIndex=Math.floor(x/3),n.push(o))}}}}function Lz(s,e,n,i,o,a,c,u){let h;if(e.side===Ao?h=i.intersectTriangle(c,a,o,!0,u):h=i.intersectTriangle(o,a,c,e.side===qc,u),h===null)return null;E0.copy(u),E0.applyMatrix4(s.matrixWorld);const d=n.ray.origin.distanceTo(E0);return d<n.near||d>n.far?null:{distance:d,point:E0.clone(),object:s}}function b0(s,e,n,i,o,a,c,u,h,d){s.getVertexPosition(u,Pd),s.getVertexPosition(h,Dd),s.getVertexPosition(d,Od);const f=Lz(s,e,n,i,Pd,Dd,Od,x0);if(f){o&&(A0.fromBufferAttribute(o,u),v0.fromBufferAttribute(o,h),y0.fromBufferAttribute(o,d),f.uv=Fa.getInterpolation(x0,Pd,Dd,Od,A0,v0,y0,new Mn)),a&&(A0.fromBufferAttribute(a,u),v0.fromBufferAttribute(a,h),y0.fromBufferAttribute(a,d),f.uv1=Fa.getInterpolation(x0,Pd,Dd,Od,A0,v0,y0,new Mn),f.uv2=f.uv1),c&&(qT.fromBufferAttribute(c,u),YT.fromBufferAttribute(c,h),$T.fromBufferAttribute(c,d),f.normal=Fa.getInterpolation(x0,Pd,Dd,Od,qT,YT,$T,new it),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const p={a:u,b:h,c:d,normal:new it,materialIndex:0};Fa.getNormal(Pd,Dd,Od,p.normal),f.face=p}return f}class Sm extends Lo{constructor(e=1,n=1,i=1,o=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:o,heightSegments:a,depthSegments:c};const u=this;o=Math.floor(o),a=Math.floor(a),c=Math.floor(c);const h=[],d=[],f=[],p=[];let A=0,g=0;v("z","y","x",-1,-1,i,n,e,c,a,0),v("z","y","x",1,-1,i,n,-e,c,a,1),v("x","z","y",1,1,e,i,n,o,c,2),v("x","z","y",1,-1,e,i,-n,o,c,3),v("x","y","z",1,-1,e,n,i,o,a,4),v("x","y","z",-1,-1,e,n,-i,o,a,5),this.setIndex(h),this.setAttribute("position",new As(d,3)),this.setAttribute("normal",new As(f,3)),this.setAttribute("uv",new As(p,2));function v(b,x,E,S,M,C,T,L,B,F,D){const P=C/B,U=T/F,K=C/2,J=T/2,z=L/2,j=B+1,G=F+1;let H=0,te=0;const Z=new it;for(let ee=0;ee<G;ee++){const oe=ee*U-J;for(let xe=0;xe<j;xe++){const Pe=xe*P-K;Z[b]=Pe*S,Z[x]=oe*M,Z[E]=z,d.push(Z.x,Z.y,Z.z),Z[b]=0,Z[x]=0,Z[E]=L>0?1:-1,f.push(Z.x,Z.y,Z.z),p.push(xe/B),p.push(1-ee/F),H+=1}}for(let ee=0;ee<F;ee++)for(let oe=0;oe<B;oe++){const xe=A+oe+j*ee,Pe=A+oe+j*(ee+1),me=A+(oe+1)+j*(ee+1),Ce=A+(oe+1)+j*ee;h.push(xe,Pe,Ce),h.push(Pe,me,Ce),te+=6}u.addGroup(g,te,D),g+=te,A+=H}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sm(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function pf(s){const e={};for(const n in s){e[n]={};for(const i in s[n]){const o=s[n][i];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=o.clone():Array.isArray(o)?e[n][i]=o.slice():e[n][i]=o}}return e}function ho(s){const e={};for(let n=0;n<s.length;n++){const i=pf(s[n]);for(const o in i)e[o]=i[o]}return e}function Pz(s){const e=[];for(let n=0;n<s.length;n++)e.push(s[n].clone());return e}function xB(s){return s.getRenderTarget()===null?s.outputColorSpace:Mr.workingColorSpace}const EB={clone:pf,merge:ho};var Dz=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Oz=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class nl extends uu{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Dz,this.fragmentShader=Oz,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=pf(e.uniforms),this.uniformsGroups=Pz(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const o in this.uniforms){const c=this.uniforms[o].value;c&&c.isTexture?n.uniforms[o]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?n.uniforms[o]={type:"c",value:c.getHex()}:c&&c.isVector2?n.uniforms[o]={type:"v2",value:c.toArray()}:c&&c.isVector3?n.uniforms[o]={type:"v3",value:c.toArray()}:c&&c.isVector4?n.uniforms[o]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?n.uniforms[o]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?n.uniforms[o]={type:"m4",value:c.toArray()}:n.uniforms[o]={value:c}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const o in this.extensions)this.extensions[o]===!0&&(i[o]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class bB extends Ls{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Gr,this.projectionMatrix=new Gr,this.projectionMatrixInverse=new Gr,this.coordinateSystem=Ql}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Oc=new it,JT=new Mn,ZT=new Mn;class sa extends bB{constructor(e=50,n=1,i=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=o,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=fm*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(em*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return fm*2*Math.atan(Math.tan(em*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Oc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Oc.x,Oc.y).multiplyScalar(-e/Oc.z),Oc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Oc.x,Oc.y).multiplyScalar(-e/Oc.z)}getViewSize(e,n){return this.getViewBounds(e,JT,ZT),n.subVectors(ZT,JT)}setViewOffset(e,n,i,o,a,c){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=o,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(em*.5*this.fov)/this.zoom,i=2*n,o=this.aspect*i,a=-.5*o;const c=this.view;if(this.view!==null&&this.view.enabled){const h=c.fullWidth,d=c.fullHeight;a+=c.offsetX*o/h,n-=c.offsetY*i/d,o*=c.width/h,i*=c.height/d}const u=this.filmOffset;u!==0&&(a+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+o,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Fd=-90,Nd=1;class Fz extends Ls{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const o=new sa(Fd,Nd,e,n);o.layers=this.layers,this.add(o);const a=new sa(Fd,Nd,e,n);a.layers=this.layers,this.add(a);const c=new sa(Fd,Nd,e,n);c.layers=this.layers,this.add(c);const u=new sa(Fd,Nd,e,n);u.layers=this.layers,this.add(u);const h=new sa(Fd,Nd,e,n);h.layers=this.layers,this.add(h);const d=new sa(Fd,Nd,e,n);d.layers=this.layers,this.add(d)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,o,a,c,u,h]=n;for(const d of n)this.remove(d);if(e===Ql)i.up.set(0,1,0),i.lookAt(1,0,0),o.up.set(0,1,0),o.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===gv)i.up.set(0,-1,0),i.lookAt(-1,0,0),o.up.set(0,-1,0),o.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const d of n)this.add(d),d.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:o}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,c,u,h,d,f]=this.children,p=e.getRenderTarget(),A=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const b=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,o),e.render(n,a),e.setRenderTarget(i,1,o),e.render(n,c),e.setRenderTarget(i,2,o),e.render(n,u),e.setRenderTarget(i,3,o),e.render(n,h),e.setRenderTarget(i,4,o),e.render(n,d),i.texture.generateMipmaps=b,e.setRenderTarget(i,5,o),e.render(n,f),e.setRenderTarget(p,A,g),e.xr.enabled=v,i.texture.needsPMREMUpdate=!0}}class _B extends Js{constructor(e,n,i,o,a,c,u,h,d,f){e=e!==void 0?e:[],n=n!==void 0?n:hf,super(e,n,i,o,a,c,u,h,d,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Nz extends Yc{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},o=[i,i,i,i,i,i];n.encoding!==void 0&&(iu("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===nu?ms:aa),this.texture=new _B(o,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:fo}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},o=new Sm(5,5,5),a=new nl({name:"CubemapFromEquirect",uniforms:pf(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Ao,blending:$l});a.uniforms.tEquirect.value=n;const c=new Qo(o,a),u=n.minFilter;return n.minFilter===$h&&(n.minFilter=fo),new Fz(1,10,this).update(e,c),n.minFilter=u,c.geometry.dispose(),c.material.dispose(),this}clear(e,n,i,o){const a=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(n,i,o);e.setRenderTarget(a)}}const BE=new it,Uz=new it,kz=new tr;class Vl{constructor(e=new it(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,o){return this.normal.set(e,n,i),this.constant=o,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const o=BE.subVectors(i,n).cross(Uz.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(BE),o=this.normal.dot(i);if(o===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/o;return a<0||a>1?null:n.copy(e.start).addScaledVector(i,a)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||kz.getNormalMatrix(e),o=this.coplanarPoint(BE).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Hh=new Qv,_0=new it;class j_{constructor(e=new Vl,n=new Vl,i=new Vl,o=new Vl,a=new Vl,c=new Vl){this.planes=[e,n,i,o,a,c]}set(e,n,i,o,a,c){const u=this.planes;return u[0].copy(e),u[1].copy(n),u[2].copy(i),u[3].copy(o),u[4].copy(a),u[5].copy(c),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Ql){const i=this.planes,o=e.elements,a=o[0],c=o[1],u=o[2],h=o[3],d=o[4],f=o[5],p=o[6],A=o[7],g=o[8],v=o[9],b=o[10],x=o[11],E=o[12],S=o[13],M=o[14],C=o[15];if(i[0].setComponents(h-a,A-d,x-g,C-E).normalize(),i[1].setComponents(h+a,A+d,x+g,C+E).normalize(),i[2].setComponents(h+c,A+f,x+v,C+S).normalize(),i[3].setComponents(h-c,A-f,x-v,C-S).normalize(),i[4].setComponents(h-u,A-p,x-b,C-M).normalize(),n===Ql)i[5].setComponents(h+u,A+p,x+b,C+M).normalize();else if(n===gv)i[5].setComponents(u,p,b,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Hh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Hh.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Hh)}intersectsSprite(e){return Hh.center.set(0,0,0),Hh.radius=.7071067811865476,Hh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Hh)}intersectsSphere(e){const n=this.planes,i=e.center,o=-e.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(i)<o)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const o=n[i];if(_0.x=o.normal.x>0?e.max.x:e.min.x,_0.y=o.normal.y>0?e.max.y:e.min.y,_0.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(_0)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function wB(){let s=null,e=!1,n=null,i=null;function o(a,c){n(a,c),i=s.requestAnimationFrame(o)}return{start:function(){e!==!0&&n!==null&&(i=s.requestAnimationFrame(o),e=!0)},stop:function(){s.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(a){n=a},setContext:function(a){s=a}}}function zz(s,e){const n=e.isWebGL2,i=new WeakMap;function o(d,f){const p=d.array,A=d.usage,g=p.byteLength,v=s.createBuffer();s.bindBuffer(f,v),s.bufferData(f,p,A),d.onUploadCallback();let b;if(p instanceof Float32Array)b=s.FLOAT;else if(p instanceof Uint16Array)if(d.isFloat16BufferAttribute)if(n)b=s.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else b=s.UNSIGNED_SHORT;else if(p instanceof Int16Array)b=s.SHORT;else if(p instanceof Uint32Array)b=s.UNSIGNED_INT;else if(p instanceof Int32Array)b=s.INT;else if(p instanceof Int8Array)b=s.BYTE;else if(p instanceof Uint8Array)b=s.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)b=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:v,type:b,bytesPerElement:p.BYTES_PER_ELEMENT,version:d.version,size:g}}function a(d,f,p){const A=f.array,g=f._updateRange,v=f.updateRanges;if(s.bindBuffer(p,d),g.count===-1&&v.length===0&&s.bufferSubData(p,0,A),v.length!==0){for(let b=0,x=v.length;b<x;b++){const E=v[b];n?s.bufferSubData(p,E.start*A.BYTES_PER_ELEMENT,A,E.start,E.count):s.bufferSubData(p,E.start*A.BYTES_PER_ELEMENT,A.subarray(E.start,E.start+E.count))}f.clearUpdateRanges()}g.count!==-1&&(n?s.bufferSubData(p,g.offset*A.BYTES_PER_ELEMENT,A,g.offset,g.count):s.bufferSubData(p,g.offset*A.BYTES_PER_ELEMENT,A.subarray(g.offset,g.offset+g.count)),g.count=-1),f.onUploadCallback()}function c(d){return d.isInterleavedBufferAttribute&&(d=d.data),i.get(d)}function u(d){d.isInterleavedBufferAttribute&&(d=d.data);const f=i.get(d);f&&(s.deleteBuffer(f.buffer),i.delete(d))}function h(d,f){if(d.isGLBufferAttribute){const A=i.get(d);(!A||A.version<d.version)&&i.set(d,{buffer:d.buffer,type:d.type,bytesPerElement:d.elementSize,version:d.version});return}d.isInterleavedBufferAttribute&&(d=d.data);const p=i.get(d);if(p===void 0)i.set(d,o(d,f));else if(p.version<d.version){if(p.size!==d.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");a(p.buffer,d,f),p.version=d.version}}return{get:c,remove:u,update:h}}class Yv extends Lo{constructor(e=1,n=1,i=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:o};const a=e/2,c=n/2,u=Math.floor(i),h=Math.floor(o),d=u+1,f=h+1,p=e/u,A=n/h,g=[],v=[],b=[],x=[];for(let E=0;E<f;E++){const S=E*A-c;for(let M=0;M<d;M++){const C=M*p-a;v.push(C,-S,0),b.push(0,0,1),x.push(M/u),x.push(1-E/h)}}for(let E=0;E<h;E++)for(let S=0;S<u;S++){const M=S+d*E,C=S+d*(E+1),T=S+1+d*(E+1),L=S+1+d*E;g.push(M,C,L),g.push(C,T,L)}this.setIndex(g),this.setAttribute("position",new As(v,3)),this.setAttribute("normal",new As(b,3)),this.setAttribute("uv",new As(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yv(e.width,e.height,e.widthSegments,e.heightSegments)}}var Gz=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Vz=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Hz=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,jz=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Wz=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Qz=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Xz=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Kz=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,qz=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Yz=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,$z=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Jz=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Zz=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,e9=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,t9=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,n9=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,i9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,r9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,s9=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,o9=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,a9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,l9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,c9=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,h9=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,u9=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,d9=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,f9=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,p9=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,m9=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,g9=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,A9="gl_FragColor = linearToOutputTexel( gl_FragColor );",v9=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,y9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,x9=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,E9=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,b9=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,_9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,w9=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,M9=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,C9=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,S9=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,T9=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,R9=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,I9=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,B9=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,L9=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,P9=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,D9=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,O9=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,F9=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,N9=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,U9=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,k9=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,z9=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,G9=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,V9=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,H9=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,j9=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,W9=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Q9=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,X9=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,K9=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,q9=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Y9=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,$9=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,J9=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Z9=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,eG=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,tG=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,nG=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,iG=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,rG=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,sG=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,oG=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,aG=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,lG=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,cG=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,hG=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,uG=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,dG=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,fG=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,pG=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,mG=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,gG=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,AG=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,vG=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,yG=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,xG=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,EG=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,bG=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,_G=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,wG=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,MG=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,CG=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,SG=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,TG=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,RG=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,IG=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,BG=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,LG=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,PG=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,DG=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,OG=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,FG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,NG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,UG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,kG=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const zG=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,GG=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,VG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,HG=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,jG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,WG=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,QG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,XG=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,KG=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,qG=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,YG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,$G=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,JG=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ZG=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,eV=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,tV=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nV=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iV=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rV=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,sV=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oV=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,aV=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,lV=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cV=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hV=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,uV=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dV=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fV=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pV=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,mV=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,gV=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,AV=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vV=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,yV=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,qi={alphahash_fragment:Gz,alphahash_pars_fragment:Vz,alphamap_fragment:Hz,alphamap_pars_fragment:jz,alphatest_fragment:Wz,alphatest_pars_fragment:Qz,aomap_fragment:Xz,aomap_pars_fragment:Kz,batching_pars_vertex:qz,batching_vertex:Yz,begin_vertex:$z,beginnormal_vertex:Jz,bsdfs:Zz,iridescence_fragment:e9,bumpmap_pars_fragment:t9,clipping_planes_fragment:n9,clipping_planes_pars_fragment:i9,clipping_planes_pars_vertex:r9,clipping_planes_vertex:s9,color_fragment:o9,color_pars_fragment:a9,color_pars_vertex:l9,color_vertex:c9,common:h9,cube_uv_reflection_fragment:u9,defaultnormal_vertex:d9,displacementmap_pars_vertex:f9,displacementmap_vertex:p9,emissivemap_fragment:m9,emissivemap_pars_fragment:g9,colorspace_fragment:A9,colorspace_pars_fragment:v9,envmap_fragment:y9,envmap_common_pars_fragment:x9,envmap_pars_fragment:E9,envmap_pars_vertex:b9,envmap_physical_pars_fragment:D9,envmap_vertex:_9,fog_vertex:w9,fog_pars_vertex:M9,fog_fragment:C9,fog_pars_fragment:S9,gradientmap_pars_fragment:T9,lightmap_fragment:R9,lightmap_pars_fragment:I9,lights_lambert_fragment:B9,lights_lambert_pars_fragment:L9,lights_pars_begin:P9,lights_toon_fragment:O9,lights_toon_pars_fragment:F9,lights_phong_fragment:N9,lights_phong_pars_fragment:U9,lights_physical_fragment:k9,lights_physical_pars_fragment:z9,lights_fragment_begin:G9,lights_fragment_maps:V9,lights_fragment_end:H9,logdepthbuf_fragment:j9,logdepthbuf_pars_fragment:W9,logdepthbuf_pars_vertex:Q9,logdepthbuf_vertex:X9,map_fragment:K9,map_pars_fragment:q9,map_particle_fragment:Y9,map_particle_pars_fragment:$9,metalnessmap_fragment:J9,metalnessmap_pars_fragment:Z9,morphcolor_vertex:eG,morphnormal_vertex:tG,morphtarget_pars_vertex:nG,morphtarget_vertex:iG,normal_fragment_begin:rG,normal_fragment_maps:sG,normal_pars_fragment:oG,normal_pars_vertex:aG,normal_vertex:lG,normalmap_pars_fragment:cG,clearcoat_normal_fragment_begin:hG,clearcoat_normal_fragment_maps:uG,clearcoat_pars_fragment:dG,iridescence_pars_fragment:fG,opaque_fragment:pG,packing:mG,premultiplied_alpha_fragment:gG,project_vertex:AG,dithering_fragment:vG,dithering_pars_fragment:yG,roughnessmap_fragment:xG,roughnessmap_pars_fragment:EG,shadowmap_pars_fragment:bG,shadowmap_pars_vertex:_G,shadowmap_vertex:wG,shadowmask_pars_fragment:MG,skinbase_vertex:CG,skinning_pars_vertex:SG,skinning_vertex:TG,skinnormal_vertex:RG,specularmap_fragment:IG,specularmap_pars_fragment:BG,tonemapping_fragment:LG,tonemapping_pars_fragment:PG,transmission_fragment:DG,transmission_pars_fragment:OG,uv_pars_fragment:FG,uv_pars_vertex:NG,uv_vertex:UG,worldpos_vertex:kG,background_vert:zG,background_frag:GG,backgroundCube_vert:VG,backgroundCube_frag:HG,cube_vert:jG,cube_frag:WG,depth_vert:QG,depth_frag:XG,distanceRGBA_vert:KG,distanceRGBA_frag:qG,equirect_vert:YG,equirect_frag:$G,linedashed_vert:JG,linedashed_frag:ZG,meshbasic_vert:eV,meshbasic_frag:tV,meshlambert_vert:nV,meshlambert_frag:iV,meshmatcap_vert:rV,meshmatcap_frag:sV,meshnormal_vert:oV,meshnormal_frag:aV,meshphong_vert:lV,meshphong_frag:cV,meshphysical_vert:hV,meshphysical_frag:uV,meshtoon_vert:dV,meshtoon_frag:fV,points_vert:pV,points_frag:mV,shadow_vert:gV,shadow_frag:AV,sprite_vert:vV,sprite_frag:yV},On={common:{diffuse:{value:new or(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new tr},alphaMap:{value:null},alphaMapTransform:{value:new tr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new tr}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new tr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new tr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new tr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new tr},normalScale:{value:new Mn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new tr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new tr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new tr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new tr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new or(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new or(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new tr},alphaTest:{value:0},uvTransform:{value:new tr}},sprite:{diffuse:{value:new or(16777215)},opacity:{value:1},center:{value:new Mn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new tr},alphaMap:{value:null},alphaMapTransform:{value:new tr},alphaTest:{value:0}}},Za={basic:{uniforms:ho([On.common,On.specularmap,On.envmap,On.aomap,On.lightmap,On.fog]),vertexShader:qi.meshbasic_vert,fragmentShader:qi.meshbasic_frag},lambert:{uniforms:ho([On.common,On.specularmap,On.envmap,On.aomap,On.lightmap,On.emissivemap,On.bumpmap,On.normalmap,On.displacementmap,On.fog,On.lights,{emissive:{value:new or(0)}}]),vertexShader:qi.meshlambert_vert,fragmentShader:qi.meshlambert_frag},phong:{uniforms:ho([On.common,On.specularmap,On.envmap,On.aomap,On.lightmap,On.emissivemap,On.bumpmap,On.normalmap,On.displacementmap,On.fog,On.lights,{emissive:{value:new or(0)},specular:{value:new or(1118481)},shininess:{value:30}}]),vertexShader:qi.meshphong_vert,fragmentShader:qi.meshphong_frag},standard:{uniforms:ho([On.common,On.envmap,On.aomap,On.lightmap,On.emissivemap,On.bumpmap,On.normalmap,On.displacementmap,On.roughnessmap,On.metalnessmap,On.fog,On.lights,{emissive:{value:new or(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:qi.meshphysical_vert,fragmentShader:qi.meshphysical_frag},toon:{uniforms:ho([On.common,On.aomap,On.lightmap,On.emissivemap,On.bumpmap,On.normalmap,On.displacementmap,On.gradientmap,On.fog,On.lights,{emissive:{value:new or(0)}}]),vertexShader:qi.meshtoon_vert,fragmentShader:qi.meshtoon_frag},matcap:{uniforms:ho([On.common,On.bumpmap,On.normalmap,On.displacementmap,On.fog,{matcap:{value:null}}]),vertexShader:qi.meshmatcap_vert,fragmentShader:qi.meshmatcap_frag},points:{uniforms:ho([On.points,On.fog]),vertexShader:qi.points_vert,fragmentShader:qi.points_frag},dashed:{uniforms:ho([On.common,On.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:qi.linedashed_vert,fragmentShader:qi.linedashed_frag},depth:{uniforms:ho([On.common,On.displacementmap]),vertexShader:qi.depth_vert,fragmentShader:qi.depth_frag},normal:{uniforms:ho([On.common,On.bumpmap,On.normalmap,On.displacementmap,{opacity:{value:1}}]),vertexShader:qi.meshnormal_vert,fragmentShader:qi.meshnormal_frag},sprite:{uniforms:ho([On.sprite,On.fog]),vertexShader:qi.sprite_vert,fragmentShader:qi.sprite_frag},background:{uniforms:{uvTransform:{value:new tr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:qi.background_vert,fragmentShader:qi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:qi.backgroundCube_vert,fragmentShader:qi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:qi.cube_vert,fragmentShader:qi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:qi.equirect_vert,fragmentShader:qi.equirect_frag},distanceRGBA:{uniforms:ho([On.common,On.displacementmap,{referencePosition:{value:new it},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:qi.distanceRGBA_vert,fragmentShader:qi.distanceRGBA_frag},shadow:{uniforms:ho([On.lights,On.fog,{color:{value:new or(0)},opacity:{value:1}}]),vertexShader:qi.shadow_vert,fragmentShader:qi.shadow_frag}};Za.physical={uniforms:ho([Za.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new tr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new tr},clearcoatNormalScale:{value:new Mn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new tr},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new tr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new tr},sheen:{value:0},sheenColor:{value:new or(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new tr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new tr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new tr},transmissionSamplerSize:{value:new Mn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new tr},attenuationDistance:{value:0},attenuationColor:{value:new or(0)},specularColor:{value:new or(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new tr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new tr},anisotropyVector:{value:new Mn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new tr}}]),vertexShader:qi.meshphysical_vert,fragmentShader:qi.meshphysical_frag};const w0={r:0,b:0,g:0};function xV(s,e,n,i,o,a,c){const u=new or(0);let h=a===!0?0:1,d,f,p=null,A=0,g=null;function v(x,E){let S=!1,M=E.isScene===!0?E.background:null;M&&M.isTexture&&(M=(E.backgroundBlurriness>0?n:e).get(M)),M===null?b(u,h):M&&M.isColor&&(b(M,1),S=!0);const C=s.xr.getEnvironmentBlendMode();C==="additive"?i.buffers.color.setClear(0,0,0,1,c):C==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,c),(s.autoClear||S)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil),M&&(M.isCubeTexture||M.mapping===jv)?(f===void 0&&(f=new Qo(new Sm(1,1,1),new nl({name:"BackgroundCubeMaterial",uniforms:pf(Za.backgroundCube.uniforms),vertexShader:Za.backgroundCube.vertexShader,fragmentShader:Za.backgroundCube.fragmentShader,side:Ao,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(T,L,B){this.matrixWorld.copyPosition(B.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(f)),f.material.uniforms.envMap.value=M,f.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=E.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,f.material.toneMapped=Mr.getTransfer(M.colorSpace)!==Dr,(p!==M||A!==M.version||g!==s.toneMapping)&&(f.material.needsUpdate=!0,p=M,A=M.version,g=s.toneMapping),f.layers.enableAll(),x.unshift(f,f.geometry,f.material,0,0,null)):M&&M.isTexture&&(d===void 0&&(d=new Qo(new Yv(2,2),new nl({name:"BackgroundMaterial",uniforms:pf(Za.background.uniforms),vertexShader:Za.background.vertexShader,fragmentShader:Za.background.fragmentShader,side:qc,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(d)),d.material.uniforms.t2D.value=M,d.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,d.material.toneMapped=Mr.getTransfer(M.colorSpace)!==Dr,M.matrixAutoUpdate===!0&&M.updateMatrix(),d.material.uniforms.uvTransform.value.copy(M.matrix),(p!==M||A!==M.version||g!==s.toneMapping)&&(d.material.needsUpdate=!0,p=M,A=M.version,g=s.toneMapping),d.layers.enableAll(),x.unshift(d,d.geometry,d.material,0,0,null))}function b(x,E){x.getRGB(w0,xB(s)),i.buffers.color.setClear(w0.r,w0.g,w0.b,E,c)}return{getClearColor:function(){return u},setClearColor:function(x,E=1){u.set(x),h=E,b(u,h)},getClearAlpha:function(){return h},setClearAlpha:function(x){h=x,b(u,h)},render:v}}function EV(s,e,n,i){const o=s.getParameter(s.MAX_VERTEX_ATTRIBS),a=i.isWebGL2?null:e.get("OES_vertex_array_object"),c=i.isWebGL2||a!==null,u={},h=x(null);let d=h,f=!1;function p(z,j,G,H,te){let Z=!1;if(c){const ee=b(H,G,j);d!==ee&&(d=ee,g(d.object)),Z=E(z,H,G,te),Z&&S(z,H,G,te)}else{const ee=j.wireframe===!0;(d.geometry!==H.id||d.program!==G.id||d.wireframe!==ee)&&(d.geometry=H.id,d.program=G.id,d.wireframe=ee,Z=!0)}te!==null&&n.update(te,s.ELEMENT_ARRAY_BUFFER),(Z||f)&&(f=!1,F(z,j,G,H),te!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n.get(te).buffer))}function A(){return i.isWebGL2?s.createVertexArray():a.createVertexArrayOES()}function g(z){return i.isWebGL2?s.bindVertexArray(z):a.bindVertexArrayOES(z)}function v(z){return i.isWebGL2?s.deleteVertexArray(z):a.deleteVertexArrayOES(z)}function b(z,j,G){const H=G.wireframe===!0;let te=u[z.id];te===void 0&&(te={},u[z.id]=te);let Z=te[j.id];Z===void 0&&(Z={},te[j.id]=Z);let ee=Z[H];return ee===void 0&&(ee=x(A()),Z[H]=ee),ee}function x(z){const j=[],G=[],H=[];for(let te=0;te<o;te++)j[te]=0,G[te]=0,H[te]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:G,attributeDivisors:H,object:z,attributes:{},index:null}}function E(z,j,G,H){const te=d.attributes,Z=j.attributes;let ee=0;const oe=G.getAttributes();for(const xe in oe)if(oe[xe].location>=0){const me=te[xe];let Ce=Z[xe];if(Ce===void 0&&(xe==="instanceMatrix"&&z.instanceMatrix&&(Ce=z.instanceMatrix),xe==="instanceColor"&&z.instanceColor&&(Ce=z.instanceColor)),me===void 0||me.attribute!==Ce||Ce&&me.data!==Ce.data)return!0;ee++}return d.attributesNum!==ee||d.index!==H}function S(z,j,G,H){const te={},Z=j.attributes;let ee=0;const oe=G.getAttributes();for(const xe in oe)if(oe[xe].location>=0){let me=Z[xe];me===void 0&&(xe==="instanceMatrix"&&z.instanceMatrix&&(me=z.instanceMatrix),xe==="instanceColor"&&z.instanceColor&&(me=z.instanceColor));const Ce={};Ce.attribute=me,me&&me.data&&(Ce.data=me.data),te[xe]=Ce,ee++}d.attributes=te,d.attributesNum=ee,d.index=H}function M(){const z=d.newAttributes;for(let j=0,G=z.length;j<G;j++)z[j]=0}function C(z){T(z,0)}function T(z,j){const G=d.newAttributes,H=d.enabledAttributes,te=d.attributeDivisors;G[z]=1,H[z]===0&&(s.enableVertexAttribArray(z),H[z]=1),te[z]!==j&&((i.isWebGL2?s:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](z,j),te[z]=j)}function L(){const z=d.newAttributes,j=d.enabledAttributes;for(let G=0,H=j.length;G<H;G++)j[G]!==z[G]&&(s.disableVertexAttribArray(G),j[G]=0)}function B(z,j,G,H,te,Z,ee){ee===!0?s.vertexAttribIPointer(z,j,G,te,Z):s.vertexAttribPointer(z,j,G,H,te,Z)}function F(z,j,G,H){if(i.isWebGL2===!1&&(z.isInstancedMesh||H.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;M();const te=H.attributes,Z=G.getAttributes(),ee=j.defaultAttributeValues;for(const oe in Z){const xe=Z[oe];if(xe.location>=0){let Pe=te[oe];if(Pe===void 0&&(oe==="instanceMatrix"&&z.instanceMatrix&&(Pe=z.instanceMatrix),oe==="instanceColor"&&z.instanceColor&&(Pe=z.instanceColor)),Pe!==void 0){const me=Pe.normalized,Ce=Pe.itemSize,Je=n.get(Pe);if(Je===void 0)continue;const Oe=Je.buffer,$e=Je.type,nt=Je.bytesPerElement,gt=i.isWebGL2===!0&&($e===s.INT||$e===s.UNSIGNED_INT||Pe.gpuType===iB);if(Pe.isInterleavedBufferAttribute){const Tt=Pe.data,Ze=Tt.stride,mn=Pe.offset;if(Tt.isInstancedInterleavedBuffer){for(let Ft=0;Ft<xe.locationSize;Ft++)T(xe.location+Ft,Tt.meshPerAttribute);z.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Tt.meshPerAttribute*Tt.count)}else for(let Ft=0;Ft<xe.locationSize;Ft++)C(xe.location+Ft);s.bindBuffer(s.ARRAY_BUFFER,Oe);for(let Ft=0;Ft<xe.locationSize;Ft++)B(xe.location+Ft,Ce/xe.locationSize,$e,me,Ze*nt,(mn+Ce/xe.locationSize*Ft)*nt,gt)}else{if(Pe.isInstancedBufferAttribute){for(let Tt=0;Tt<xe.locationSize;Tt++)T(xe.location+Tt,Pe.meshPerAttribute);z.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Pe.meshPerAttribute*Pe.count)}else for(let Tt=0;Tt<xe.locationSize;Tt++)C(xe.location+Tt);s.bindBuffer(s.ARRAY_BUFFER,Oe);for(let Tt=0;Tt<xe.locationSize;Tt++)B(xe.location+Tt,Ce/xe.locationSize,$e,me,Ce*nt,Ce/xe.locationSize*Tt*nt,gt)}}else if(ee!==void 0){const me=ee[oe];if(me!==void 0)switch(me.length){case 2:s.vertexAttrib2fv(xe.location,me);break;case 3:s.vertexAttrib3fv(xe.location,me);break;case 4:s.vertexAttrib4fv(xe.location,me);break;default:s.vertexAttrib1fv(xe.location,me)}}}}L()}function D(){K();for(const z in u){const j=u[z];for(const G in j){const H=j[G];for(const te in H)v(H[te].object),delete H[te];delete j[G]}delete u[z]}}function P(z){if(u[z.id]===void 0)return;const j=u[z.id];for(const G in j){const H=j[G];for(const te in H)v(H[te].object),delete H[te];delete j[G]}delete u[z.id]}function U(z){for(const j in u){const G=u[j];if(G[z.id]===void 0)continue;const H=G[z.id];for(const te in H)v(H[te].object),delete H[te];delete G[z.id]}}function K(){J(),f=!0,d!==h&&(d=h,g(d.object))}function J(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:p,reset:K,resetDefaultState:J,dispose:D,releaseStatesOfGeometry:P,releaseStatesOfProgram:U,initAttributes:M,enableAttribute:C,disableUnusedAttributes:L}}function bV(s,e,n,i){const o=i.isWebGL2;let a;function c(f){a=f}function u(f,p){s.drawArrays(a,f,p),n.update(p,a,1)}function h(f,p,A){if(A===0)return;let g,v;if(o)g=s,v="drawArraysInstanced";else if(g=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",g===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[v](a,f,p,A),n.update(p,a,A)}function d(f,p,A){if(A===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let v=0;v<A;v++)this.render(f[v],p[v]);else{g.multiDrawArraysWEBGL(a,f,0,p,0,A);let v=0;for(let b=0;b<A;b++)v+=p[b];n.update(v,a,1)}}this.setMode=c,this.render=u,this.renderInstances=h,this.renderMultiDraw=d}function _V(s,e,n){let i;function o(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const B=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(B.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(B){if(B==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";B="mediump"}return B==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const c=typeof WebGL2RenderingContext<"u"&&s.constructor.name==="WebGL2RenderingContext";let u=n.precision!==void 0?n.precision:"highp";const h=a(u);h!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",h,"instead."),u=h);const d=c||e.has("WEBGL_draw_buffers"),f=n.logarithmicDepthBuffer===!0,p=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),A=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=s.getParameter(s.MAX_TEXTURE_SIZE),v=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),b=s.getParameter(s.MAX_VERTEX_ATTRIBS),x=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),E=s.getParameter(s.MAX_VARYING_VECTORS),S=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),M=A>0,C=c||e.has("OES_texture_float"),T=M&&C,L=c?s.getParameter(s.MAX_SAMPLES):0;return{isWebGL2:c,drawBuffers:d,getMaxAnisotropy:o,getMaxPrecision:a,precision:u,logarithmicDepthBuffer:f,maxTextures:p,maxVertexTextures:A,maxTextureSize:g,maxCubemapSize:v,maxAttributes:b,maxVertexUniforms:x,maxVaryings:E,maxFragmentUniforms:S,vertexTextures:M,floatFragmentTextures:C,floatVertexTextures:T,maxSamples:L}}function wV(s){const e=this;let n=null,i=0,o=!1,a=!1;const c=new Vl,u=new tr,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(p,A){const g=p.length!==0||A||i!==0||o;return o=A,i=p.length,g},this.beginShadows=function(){a=!0,f(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(p,A){n=f(p,A,0)},this.setState=function(p,A,g){const v=p.clippingPlanes,b=p.clipIntersection,x=p.clipShadows,E=s.get(p);if(!o||v===null||v.length===0||a&&!x)a?f(null):d();else{const S=a?0:i,M=S*4;let C=E.clippingState||null;h.value=C,C=f(v,A,M,g);for(let T=0;T!==M;++T)C[T]=n[T];E.clippingState=C,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=S}};function d(){h.value!==n&&(h.value=n,h.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function f(p,A,g,v){const b=p!==null?p.length:0;let x=null;if(b!==0){if(x=h.value,v!==!0||x===null){const E=g+b*4,S=A.matrixWorldInverse;u.getNormalMatrix(S),(x===null||x.length<E)&&(x=new Float32Array(E));for(let M=0,C=g;M!==b;++M,C+=4)c.copy(p[M]).applyMatrix4(S,u),c.normal.toArray(x,C),x[C+3]=c.constant}h.value=x,h.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,x}}function MV(s){let e=new WeakMap;function n(c,u){return u===Ob?c.mapping=hf:u===Fb&&(c.mapping=uf),c}function i(c){if(c&&c.isTexture){const u=c.mapping;if(u===Ob||u===Fb)if(e.has(c)){const h=e.get(c).texture;return n(h,c.mapping)}else{const h=c.image;if(h&&h.height>0){const d=new Nz(h.height);return d.fromEquirectangularTexture(s,c),e.set(c,d),c.addEventListener("dispose",o),n(d.texture,c.mapping)}else return null}}return c}function o(c){const u=c.target;u.removeEventListener("dispose",o);const h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}function a(){e=new WeakMap}return{get:i,dispose:a}}class W_ extends bB{constructor(e=-1,n=1,i=1,o=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=o,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,o,a,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=o,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let a=i-e,c=i+e,u=o+n,h=o-n;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=d*this.view.offsetX,c=a+d*this.view.width,u-=f*this.view.offsetY,h=u-f*this.view.height}this.projectionMatrix.makeOrthographic(a,c,u,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const Jd=4,e3=[.125,.215,.35,.446,.526,.582],qh=20,LE=new W_,t3=new or;let PE=null,DE=0,OE=0;const Qh=(1+Math.sqrt(5))/2,Ud=1/Qh,n3=[new it(1,1,1),new it(-1,1,1),new it(1,1,-1),new it(-1,1,-1),new it(0,Qh,Ud),new it(0,Qh,-Ud),new it(Ud,0,Qh),new it(-Ud,0,Qh),new it(Qh,Ud,0),new it(-Qh,Ud,0)];class i3{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,o=100){PE=this._renderer.getRenderTarget(),DE=this._renderer.getActiveCubeFace(),OE=this._renderer.getActiveMipmapLevel(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,i,o,a),n>0&&this._blur(a,0,0,n),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=o3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=s3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(PE,DE,OE),e.scissorTest=!1,M0(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===hf||e.mapping===uf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),PE=this._renderer.getRenderTarget(),DE=this._renderer.getActiveCubeFace(),OE=this._renderer.getActiveMipmapLevel();const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:fo,minFilter:fo,generateMipmaps:!1,type:df,format:Da,colorSpace:tc,depthBuffer:!1},o=r3(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=r3(e,n,i);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=CV(a)),this._blurMaterial=SV(a,e,n)}return o}_compileMaterial(e){const n=new Qo(this._lodPlanes[0],e);this._renderer.compile(n,LE)}_sceneToCubeUV(e,n,i,o){const u=new sa(90,1,n,i),h=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],f=this._renderer,p=f.autoClear,A=f.toneMapping;f.getClearColor(t3),f.toneMapping=Qc,f.autoClear=!1;const g=new qv({name:"PMREM.Background",side:Ao,depthWrite:!1,depthTest:!1}),v=new Qo(new Sm,g);let b=!1;const x=e.background;x?x.isColor&&(g.color.copy(x),e.background=null,b=!0):(g.color.copy(t3),b=!0);for(let E=0;E<6;E++){const S=E%3;S===0?(u.up.set(0,h[E],0),u.lookAt(d[E],0,0)):S===1?(u.up.set(0,0,h[E]),u.lookAt(0,d[E],0)):(u.up.set(0,h[E],0),u.lookAt(0,0,d[E]));const M=this._cubeSize;M0(o,S*M,E>2?M:0,M,M),f.setRenderTarget(o),b&&f.render(v,u),f.render(e,u)}v.geometry.dispose(),v.material.dispose(),f.toneMapping=A,f.autoClear=p,e.background=x}_textureToCubeUV(e,n){const i=this._renderer,o=e.mapping===hf||e.mapping===uf;o?(this._cubemapMaterial===null&&(this._cubemapMaterial=o3()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=s3());const a=o?this._cubemapMaterial:this._equirectMaterial,c=new Qo(this._lodPlanes[0],a),u=a.uniforms;u.envMap.value=e;const h=this._cubeSize;M0(n,0,0,3*h,2*h),i.setRenderTarget(n),i.render(c,LE)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let o=1;o<this._lodPlanes.length;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),c=n3[(o-1)%n3.length];this._blur(e,o-1,o,a,c)}n.autoClear=i}_blur(e,n,i,o,a){const c=this._pingPongRenderTarget;this._halfBlur(e,c,n,i,o,"latitudinal",a),this._halfBlur(c,e,i,i,o,"longitudinal",a)}_halfBlur(e,n,i,o,a,c,u){const h=this._renderer,d=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,p=new Qo(this._lodPlanes[o],d),A=d.uniforms,g=this._sizeLods[i]-1,v=isFinite(a)?Math.PI/(2*g):2*Math.PI/(2*qh-1),b=a/v,x=isFinite(a)?1+Math.floor(f*b):qh;x>qh&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${qh}`);const E=[];let S=0;for(let B=0;B<qh;++B){const F=B/b,D=Math.exp(-F*F/2);E.push(D),B===0?S+=D:B<x&&(S+=2*D)}for(let B=0;B<E.length;B++)E[B]=E[B]/S;A.envMap.value=e.texture,A.samples.value=x,A.weights.value=E,A.latitudinal.value=c==="latitudinal",u&&(A.poleAxis.value=u);const{_lodMax:M}=this;A.dTheta.value=v,A.mipInt.value=M-i;const C=this._sizeLods[o],T=3*C*(o>M-Jd?o-M+Jd:0),L=4*(this._cubeSize-C);M0(n,T,L,3*C,2*C),h.setRenderTarget(n),h.render(p,LE)}}function CV(s){const e=[],n=[],i=[];let o=s;const a=s-Jd+1+e3.length;for(let c=0;c<a;c++){const u=Math.pow(2,o);n.push(u);let h=1/u;c>s-Jd?h=e3[c-s+Jd-1]:c===0&&(h=0),i.push(h);const d=1/(u-2),f=-d,p=1+d,A=[f,f,p,f,p,p,f,f,p,p,f,p],g=6,v=6,b=3,x=2,E=1,S=new Float32Array(b*v*g),M=new Float32Array(x*v*g),C=new Float32Array(E*v*g);for(let L=0;L<g;L++){const B=L%3*2/3-1,F=L>2?0:-1,D=[B,F,0,B+2/3,F,0,B+2/3,F+1,0,B,F,0,B+2/3,F+1,0,B,F+1,0];S.set(D,b*v*L),M.set(A,x*v*L);const P=[L,L,L,L,L,L];C.set(P,E*v*L)}const T=new Lo;T.setAttribute("position",new ha(S,b)),T.setAttribute("uv",new ha(M,x)),T.setAttribute("faceIndex",new ha(C,E)),e.push(T),o>Jd&&o--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function r3(s,e,n){const i=new Yc(s,e,n);return i.texture.mapping=jv,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function M0(s,e,n,i,o){s.viewport.set(e,n,i,o),s.scissor.set(e,n,i,o)}function SV(s,e,n){const i=new Float32Array(qh),o=new it(0,1,0);return new nl({name:"SphericalGaussianBlur",defines:{n:qh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:Q_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$l,depthTest:!1,depthWrite:!1})}function s3(){return new nl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Q_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$l,depthTest:!1,depthWrite:!1})}function o3(){return new nl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Q_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$l,depthTest:!1,depthWrite:!1})}function Q_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function TV(s){let e=new WeakMap,n=null;function i(u){if(u&&u.isTexture){const h=u.mapping,d=h===Ob||h===Fb,f=h===hf||h===uf;if(d||f)if(u.isRenderTargetTexture&&u.needsPMREMUpdate===!0){u.needsPMREMUpdate=!1;let p=e.get(u);return n===null&&(n=new i3(s)),p=d?n.fromEquirectangular(u,p):n.fromCubemap(u,p),e.set(u,p),p.texture}else{if(e.has(u))return e.get(u).texture;{const p=u.image;if(d&&p&&p.height>0||f&&p&&o(p)){n===null&&(n=new i3(s));const A=d?n.fromEquirectangular(u):n.fromCubemap(u);return e.set(u,A),u.addEventListener("dispose",a),A.texture}else return null}}}return u}function o(u){let h=0;const d=6;for(let f=0;f<d;f++)u[f]!==void 0&&h++;return h===d}function a(u){const h=u.target;h.removeEventListener("dispose",a);const d=e.get(h);d!==void 0&&(e.delete(h),d.dispose())}function c(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:c}}function RV(s){const e={};function n(i){if(e[i]!==void 0)return e[i];let o;switch(i){case"WEBGL_depth_texture":o=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=s.getExtension(i)}return e[i]=o,o}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?(n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance")):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){const o=n(i);return o===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),o}}}function IV(s,e,n,i){const o={},a=new WeakMap;function c(p){const A=p.target;A.index!==null&&e.remove(A.index);for(const v in A.attributes)e.remove(A.attributes[v]);for(const v in A.morphAttributes){const b=A.morphAttributes[v];for(let x=0,E=b.length;x<E;x++)e.remove(b[x])}A.removeEventListener("dispose",c),delete o[A.id];const g=a.get(A);g&&(e.remove(g),a.delete(A)),i.releaseStatesOfGeometry(A),A.isInstancedBufferGeometry===!0&&delete A._maxInstanceCount,n.memory.geometries--}function u(p,A){return o[A.id]===!0||(A.addEventListener("dispose",c),o[A.id]=!0,n.memory.geometries++),A}function h(p){const A=p.attributes;for(const v in A)e.update(A[v],s.ARRAY_BUFFER);const g=p.morphAttributes;for(const v in g){const b=g[v];for(let x=0,E=b.length;x<E;x++)e.update(b[x],s.ARRAY_BUFFER)}}function d(p){const A=[],g=p.index,v=p.attributes.position;let b=0;if(g!==null){const S=g.array;b=g.version;for(let M=0,C=S.length;M<C;M+=3){const T=S[M+0],L=S[M+1],B=S[M+2];A.push(T,L,L,B,B,T)}}else if(v!==void 0){const S=v.array;b=v.version;for(let M=0,C=S.length/3-1;M<C;M+=3){const T=M+0,L=M+1,B=M+2;A.push(T,L,L,B,B,T)}}else return;const x=new(fB(A)?yB:vB)(A,1);x.version=b;const E=a.get(p);E&&e.remove(E),a.set(p,x)}function f(p){const A=a.get(p);if(A){const g=p.index;g!==null&&A.version<g.version&&d(p)}else d(p);return a.get(p)}return{get:u,update:h,getWireframeAttribute:f}}function BV(s,e,n,i){const o=i.isWebGL2;let a;function c(g){a=g}let u,h;function d(g){u=g.type,h=g.bytesPerElement}function f(g,v){s.drawElements(a,v,u,g*h),n.update(v,a,1)}function p(g,v,b){if(b===0)return;let x,E;if(o)x=s,E="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),E="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[E](a,v,u,g*h,b),n.update(v,a,b)}function A(g,v,b){if(b===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let E=0;E<b;E++)this.render(g[E]/h,v[E]);else{x.multiDrawElementsWEBGL(a,v,0,u,g,0,b);let E=0;for(let S=0;S<b;S++)E+=v[S];n.update(E,a,1)}}this.setMode=c,this.setIndex=d,this.render=f,this.renderInstances=p,this.renderMultiDraw=A}function LV(s){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,c,u){switch(n.calls++,c){case s.TRIANGLES:n.triangles+=u*(a/3);break;case s.LINES:n.lines+=u*(a/2);break;case s.LINE_STRIP:n.lines+=u*(a-1);break;case s.LINE_LOOP:n.lines+=u*a;break;case s.POINTS:n.points+=u*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function o(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:o,update:i}}function PV(s,e){return s[0]-e[0]}function DV(s,e){return Math.abs(e[1])-Math.abs(s[1])}function OV(s,e,n){const i={},o=new Float32Array(8),a=new WeakMap,c=new Bs,u=[];for(let d=0;d<8;d++)u[d]=[d,0];function h(d,f,p){const A=d.morphTargetInfluences;if(e.isWebGL2===!0){const g=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,v=g!==void 0?g.length:0;let b=a.get(f);if(b===void 0||b.count!==v){let z=function(){K.dispose(),a.delete(f),f.removeEventListener("dispose",z)};b!==void 0&&b.texture.dispose();const S=f.morphAttributes.position!==void 0,M=f.morphAttributes.normal!==void 0,C=f.morphAttributes.color!==void 0,T=f.morphAttributes.position||[],L=f.morphAttributes.normal||[],B=f.morphAttributes.color||[];let F=0;S===!0&&(F=1),M===!0&&(F=2),C===!0&&(F=3);let D=f.attributes.position.count*F,P=1;D>e.maxTextureSize&&(P=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);const U=new Float32Array(D*P*4*v),K=new gB(U,D,P,v);K.type=Wl,K.needsUpdate=!0;const J=F*4;for(let j=0;j<v;j++){const G=T[j],H=L[j],te=B[j],Z=D*P*4*j;for(let ee=0;ee<G.count;ee++){const oe=ee*J;S===!0&&(c.fromBufferAttribute(G,ee),U[Z+oe+0]=c.x,U[Z+oe+1]=c.y,U[Z+oe+2]=c.z,U[Z+oe+3]=0),M===!0&&(c.fromBufferAttribute(H,ee),U[Z+oe+4]=c.x,U[Z+oe+5]=c.y,U[Z+oe+6]=c.z,U[Z+oe+7]=0),C===!0&&(c.fromBufferAttribute(te,ee),U[Z+oe+8]=c.x,U[Z+oe+9]=c.y,U[Z+oe+10]=c.z,U[Z+oe+11]=te.itemSize===4?c.w:1)}}b={count:v,texture:K,size:new Mn(D,P)},a.set(f,b),f.addEventListener("dispose",z)}let x=0;for(let S=0;S<A.length;S++)x+=A[S];const E=f.morphTargetsRelative?1:1-x;p.getUniforms().setValue(s,"morphTargetBaseInfluence",E),p.getUniforms().setValue(s,"morphTargetInfluences",A),p.getUniforms().setValue(s,"morphTargetsTexture",b.texture,n),p.getUniforms().setValue(s,"morphTargetsTextureSize",b.size)}else{const g=A===void 0?0:A.length;let v=i[f.id];if(v===void 0||v.length!==g){v=[];for(let M=0;M<g;M++)v[M]=[M,0];i[f.id]=v}for(let M=0;M<g;M++){const C=v[M];C[0]=M,C[1]=A[M]}v.sort(DV);for(let M=0;M<8;M++)M<g&&v[M][1]?(u[M][0]=v[M][0],u[M][1]=v[M][1]):(u[M][0]=Number.MAX_SAFE_INTEGER,u[M][1]=0);u.sort(PV);const b=f.morphAttributes.position,x=f.morphAttributes.normal;let E=0;for(let M=0;M<8;M++){const C=u[M],T=C[0],L=C[1];T!==Number.MAX_SAFE_INTEGER&&L?(b&&f.getAttribute("morphTarget"+M)!==b[T]&&f.setAttribute("morphTarget"+M,b[T]),x&&f.getAttribute("morphNormal"+M)!==x[T]&&f.setAttribute("morphNormal"+M,x[T]),o[M]=L,E+=L):(b&&f.hasAttribute("morphTarget"+M)===!0&&f.deleteAttribute("morphTarget"+M),x&&f.hasAttribute("morphNormal"+M)===!0&&f.deleteAttribute("morphNormal"+M),o[M]=0)}const S=f.morphTargetsRelative?1:1-E;p.getUniforms().setValue(s,"morphTargetBaseInfluence",S),p.getUniforms().setValue(s,"morphTargetInfluences",o)}}return{update:h}}function FV(s,e,n,i){let o=new WeakMap;function a(h){const d=i.render.frame,f=h.geometry,p=e.get(h,f);if(o.get(p)!==d&&(e.update(p),o.set(p,d)),h.isInstancedMesh&&(h.hasEventListener("dispose",u)===!1&&h.addEventListener("dispose",u),o.get(h)!==d&&(n.update(h.instanceMatrix,s.ARRAY_BUFFER),h.instanceColor!==null&&n.update(h.instanceColor,s.ARRAY_BUFFER),o.set(h,d))),h.isSkinnedMesh){const A=h.skeleton;o.get(A)!==d&&(A.update(),o.set(A,d))}return p}function c(){o=new WeakMap}function u(h){const d=h.target;d.removeEventListener("dispose",u),n.remove(d.instanceMatrix),d.instanceColor!==null&&n.remove(d.instanceColor)}return{update:a,dispose:c}}class MB extends Js{constructor(e,n,i,o,a,c,u,h,d,f){if(f=f!==void 0?f:tu,f!==tu&&f!==ff)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&f===tu&&(i=Hc),i===void 0&&f===ff&&(i=eu),super(null,o,a,c,u,h,f,i,d),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=u!==void 0?u:mo,this.minFilter=h!==void 0?h:mo,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}const CB=new Js,SB=new MB(1,1);SB.compareFunction=dB;const TB=new gB,RB=new Ez,IB=new _B,a3=[],l3=[],c3=new Float32Array(16),h3=new Float32Array(9),u3=new Float32Array(4);function bf(s,e,n){const i=s[0];if(i<=0||i>0)return s;const o=e*n;let a=a3[o];if(a===void 0&&(a=new Float32Array(o),a3[o]=a),e!==0){i.toArray(a,0);for(let c=1,u=0;c!==e;++c)u+=n,s[c].toArray(a,u)}return a}function ys(s,e){if(s.length!==e.length)return!1;for(let n=0,i=s.length;n<i;n++)if(s[n]!==e[n])return!1;return!0}function xs(s,e){for(let n=0,i=e.length;n<i;n++)s[n]=e[n]}function $v(s,e){let n=l3[e];n===void 0&&(n=new Int32Array(e),l3[e]=n);for(let i=0;i!==e;++i)n[i]=s.allocateTextureUnit();return n}function NV(s,e){const n=this.cache;n[0]!==e&&(s.uniform1f(this.addr,e),n[0]=e)}function UV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ys(n,e))return;s.uniform2fv(this.addr,e),xs(n,e)}}function kV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(ys(n,e))return;s.uniform3fv(this.addr,e),xs(n,e)}}function zV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ys(n,e))return;s.uniform4fv(this.addr,e),xs(n,e)}}function GV(s,e){const n=this.cache,i=e.elements;if(i===void 0){if(ys(n,e))return;s.uniformMatrix2fv(this.addr,!1,e),xs(n,e)}else{if(ys(n,i))return;u3.set(i),s.uniformMatrix2fv(this.addr,!1,u3),xs(n,i)}}function VV(s,e){const n=this.cache,i=e.elements;if(i===void 0){if(ys(n,e))return;s.uniformMatrix3fv(this.addr,!1,e),xs(n,e)}else{if(ys(n,i))return;h3.set(i),s.uniformMatrix3fv(this.addr,!1,h3),xs(n,i)}}function HV(s,e){const n=this.cache,i=e.elements;if(i===void 0){if(ys(n,e))return;s.uniformMatrix4fv(this.addr,!1,e),xs(n,e)}else{if(ys(n,i))return;c3.set(i),s.uniformMatrix4fv(this.addr,!1,c3),xs(n,i)}}function jV(s,e){const n=this.cache;n[0]!==e&&(s.uniform1i(this.addr,e),n[0]=e)}function WV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ys(n,e))return;s.uniform2iv(this.addr,e),xs(n,e)}}function QV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ys(n,e))return;s.uniform3iv(this.addr,e),xs(n,e)}}function XV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ys(n,e))return;s.uniform4iv(this.addr,e),xs(n,e)}}function KV(s,e){const n=this.cache;n[0]!==e&&(s.uniform1ui(this.addr,e),n[0]=e)}function qV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ys(n,e))return;s.uniform2uiv(this.addr,e),xs(n,e)}}function YV(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ys(n,e))return;s.uniform3uiv(this.addr,e),xs(n,e)}}function $V(s,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ys(n,e))return;s.uniform4uiv(this.addr,e),xs(n,e)}}function JV(s,e,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(s.uniform1i(this.addr,o),i[0]=o);const a=this.type===s.SAMPLER_2D_SHADOW?SB:CB;n.setTexture2D(e||a,o)}function ZV(s,e,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(s.uniform1i(this.addr,o),i[0]=o),n.setTexture3D(e||RB,o)}function eH(s,e,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(s.uniform1i(this.addr,o),i[0]=o),n.setTextureCube(e||IB,o)}function tH(s,e,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(s.uniform1i(this.addr,o),i[0]=o),n.setTexture2DArray(e||TB,o)}function nH(s){switch(s){case 5126:return NV;case 35664:return UV;case 35665:return kV;case 35666:return zV;case 35674:return GV;case 35675:return VV;case 35676:return HV;case 5124:case 35670:return jV;case 35667:case 35671:return WV;case 35668:case 35672:return QV;case 35669:case 35673:return XV;case 5125:return KV;case 36294:return qV;case 36295:return YV;case 36296:return $V;case 35678:case 36198:case 36298:case 36306:case 35682:return JV;case 35679:case 36299:case 36307:return ZV;case 35680:case 36300:case 36308:case 36293:return eH;case 36289:case 36303:case 36311:case 36292:return tH}}function iH(s,e){s.uniform1fv(this.addr,e)}function rH(s,e){const n=bf(e,this.size,2);s.uniform2fv(this.addr,n)}function sH(s,e){const n=bf(e,this.size,3);s.uniform3fv(this.addr,n)}function oH(s,e){const n=bf(e,this.size,4);s.uniform4fv(this.addr,n)}function aH(s,e){const n=bf(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,n)}function lH(s,e){const n=bf(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,n)}function cH(s,e){const n=bf(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,n)}function hH(s,e){s.uniform1iv(this.addr,e)}function uH(s,e){s.uniform2iv(this.addr,e)}function dH(s,e){s.uniform3iv(this.addr,e)}function fH(s,e){s.uniform4iv(this.addr,e)}function pH(s,e){s.uniform1uiv(this.addr,e)}function mH(s,e){s.uniform2uiv(this.addr,e)}function gH(s,e){s.uniform3uiv(this.addr,e)}function AH(s,e){s.uniform4uiv(this.addr,e)}function vH(s,e,n){const i=this.cache,o=e.length,a=$v(n,o);ys(i,a)||(s.uniform1iv(this.addr,a),xs(i,a));for(let c=0;c!==o;++c)n.setTexture2D(e[c]||CB,a[c])}function yH(s,e,n){const i=this.cache,o=e.length,a=$v(n,o);ys(i,a)||(s.uniform1iv(this.addr,a),xs(i,a));for(let c=0;c!==o;++c)n.setTexture3D(e[c]||RB,a[c])}function xH(s,e,n){const i=this.cache,o=e.length,a=$v(n,o);ys(i,a)||(s.uniform1iv(this.addr,a),xs(i,a));for(let c=0;c!==o;++c)n.setTextureCube(e[c]||IB,a[c])}function EH(s,e,n){const i=this.cache,o=e.length,a=$v(n,o);ys(i,a)||(s.uniform1iv(this.addr,a),xs(i,a));for(let c=0;c!==o;++c)n.setTexture2DArray(e[c]||TB,a[c])}function bH(s){switch(s){case 5126:return iH;case 35664:return rH;case 35665:return sH;case 35666:return oH;case 35674:return aH;case 35675:return lH;case 35676:return cH;case 5124:case 35670:return hH;case 35667:case 35671:return uH;case 35668:case 35672:return dH;case 35669:case 35673:return fH;case 5125:return pH;case 36294:return mH;case 36295:return gH;case 36296:return AH;case 35678:case 36198:case 36298:case 36306:case 35682:return vH;case 35679:case 36299:case 36307:return yH;case 35680:case 36300:case 36308:case 36293:return xH;case 36289:case 36303:case 36311:case 36292:return EH}}class _H{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=nH(n.type)}}class wH{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=bH(n.type)}}class MH{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const o=this.seq;for(let a=0,c=o.length;a!==c;++a){const u=o[a];u.setValue(e,n[u.id],i)}}}const FE=/(\w+)(\])?(\[|\.)?/g;function d3(s,e){s.seq.push(e),s.map[e.id]=e}function CH(s,e,n){const i=s.name,o=i.length;for(FE.lastIndex=0;;){const a=FE.exec(i),c=FE.lastIndex;let u=a[1];const h=a[2]==="]",d=a[3];if(h&&(u=u|0),d===void 0||d==="["&&c+2===o){d3(n,d===void 0?new _H(u,s,e):new wH(u,s,e));break}else{let p=n.map[u];p===void 0&&(p=new MH(u),d3(n,p)),n=p}}}class Z0{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let o=0;o<i;++o){const a=e.getActiveUniform(n,o),c=e.getUniformLocation(n,a.name);CH(a,c,this)}}setValue(e,n,i,o){const a=this.map[n];a!==void 0&&a.setValue(e,i,o)}setOptional(e,n,i){const o=n[i];o!==void 0&&this.setValue(e,i,o)}static upload(e,n,i,o){for(let a=0,c=n.length;a!==c;++a){const u=n[a],h=i[u.id];h.needsUpdate!==!1&&u.setValue(e,h.value,o)}}static seqWithValue(e,n){const i=[];for(let o=0,a=e.length;o!==a;++o){const c=e[o];c.id in n&&i.push(c)}return i}}function f3(s,e,n){const i=s.createShader(e);return s.shaderSource(i,n),s.compileShader(i),i}const SH=37297;let TH=0;function RH(s,e){const n=s.split(`
`),i=[],o=Math.max(e-6,0),a=Math.min(e+6,n.length);for(let c=o;c<a;c++){const u=c+1;i.push(`${u===e?">":" "} ${u}: ${n[c]}`)}return i.join(`
`)}function IH(s){const e=Mr.getPrimaries(Mr.workingColorSpace),n=Mr.getPrimaries(s);let i;switch(e===n?i="":e===mv&&n===pv?i="LinearDisplayP3ToLinearSRGB":e===pv&&n===mv&&(i="LinearSRGBToLinearDisplayP3"),s){case tc:case Wv:return[i,"LinearTransferOETF"];case ms:case G_:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",s),[i,"LinearTransferOETF"]}}function p3(s,e,n){const i=s.getShaderParameter(e,s.COMPILE_STATUS),o=s.getShaderInfoLog(e).trim();if(i&&o==="")return"";const a=/ERROR: 0:(\d+)/.exec(o);if(a){const c=parseInt(a[1]);return n.toUpperCase()+`

`+o+`

`+RH(s.getShaderSource(e),c)}else return o}function BH(s,e){const n=IH(e);return`vec4 ${s}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function LH(s,e){let n;switch(e){case L7:n="Linear";break;case P7:n="Reinhard";break;case D7:n="OptimizedCineon";break;case O7:n="ACESFilmic";break;case N7:n="AgX";break;case F7:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+s+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function PH(s){return[s.extensionDerivatives||s.envMapCubeUVHeight||s.bumpMap||s.normalMapTangentSpace||s.clearcoatNormalMap||s.flatShading||s.alphaToCoverage||s.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(s.extensionFragDepth||s.logarithmicDepthBuffer)&&s.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",s.extensionDrawBuffers&&s.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(s.extensionShaderTextureLOD||s.envMap||s.transmission)&&s.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Zd).join(`
`)}function DH(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Zd).join(`
`)}function OH(s){const e=[];for(const n in s){const i=s[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function FH(s,e){const n={},i=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let o=0;o<i;o++){const a=s.getActiveAttrib(e,o),c=a.name;let u=1;a.type===s.FLOAT_MAT2&&(u=2),a.type===s.FLOAT_MAT3&&(u=3),a.type===s.FLOAT_MAT4&&(u=4),n[c]={type:a.type,location:s.getAttribLocation(e,c),locationSize:u}}return n}function Zd(s){return s!==""}function m3(s,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function g3(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const NH=/^[ \t]*#include +<([\w\d./]+)>/gm;function Hb(s){return s.replace(NH,kH)}const UH=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function kH(s,e){let n=qi[e];if(n===void 0){const i=UH.get(e);if(i!==void 0)n=qi[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Hb(n)}const zH=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function A3(s){return s.replace(zH,GH)}function GH(s,e,n,i){let o="";for(let a=parseInt(e);a<parseInt(n);a++)o+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return o}function v3(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	`;return s.isWebGL2&&(e+=`precision ${s.precision} sampler3D;
		precision ${s.precision} sampler2DArray;
		precision ${s.precision} sampler2DShadow;
		precision ${s.precision} samplerCubeShadow;
		precision ${s.precision} sampler2DArrayShadow;
		precision ${s.precision} isampler2D;
		precision ${s.precision} isampler3D;
		precision ${s.precision} isamplerCube;
		precision ${s.precision} isampler2DArray;
		precision ${s.precision} usampler2D;
		precision ${s.precision} usampler3D;
		precision ${s.precision} usamplerCube;
		precision ${s.precision} usampler2DArray;
		`),s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function VH(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===tB?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===o7?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===zl&&(e="SHADOWMAP_TYPE_VSM"),e}function HH(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case hf:case uf:e="ENVMAP_TYPE_CUBE";break;case jv:e="ENVMAP_TYPE_CUBE_UV";break}return e}function jH(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case uf:e="ENVMAP_MODE_REFRACTION";break}return e}function WH(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case k_:e="ENVMAP_BLENDING_MULTIPLY";break;case I7:e="ENVMAP_BLENDING_MIX";break;case B7:e="ENVMAP_BLENDING_ADD";break}return e}function QH(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function XH(s,e,n,i){const o=s.getContext(),a=n.defines;let c=n.vertexShader,u=n.fragmentShader;const h=VH(n),d=HH(n),f=jH(n),p=WH(n),A=QH(n),g=n.isWebGL2?"":PH(n),v=DH(n),b=OH(a),x=o.createProgram();let E,S,M=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(E=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b].filter(Zd).join(`
`),E.length>0&&(E+=`
`),S=[g,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b].filter(Zd).join(`
`),S.length>0&&(S+=`
`)):(E=[v3(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Zd).join(`
`),S=[g,v3(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",A?"#define CUBEUV_TEXEL_WIDTH "+A.texelWidth:"",A?"#define CUBEUV_TEXEL_HEIGHT "+A.texelHeight:"",A?"#define CUBEUV_MAX_MIP "+A.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Qc?"#define TONE_MAPPING":"",n.toneMapping!==Qc?qi.tonemapping_pars_fragment:"",n.toneMapping!==Qc?LH("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",qi.colorspace_pars_fragment,BH("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Zd).join(`
`)),c=Hb(c),c=m3(c,n),c=g3(c,n),u=Hb(u),u=m3(u,n),u=g3(u,n),c=A3(c),u=A3(u),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,E=[v,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,S=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===DT?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===DT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const C=M+E+c,T=M+S+u,L=f3(o,o.VERTEX_SHADER,C),B=f3(o,o.FRAGMENT_SHADER,T);o.attachShader(x,L),o.attachShader(x,B),n.index0AttributeName!==void 0?o.bindAttribLocation(x,0,n.index0AttributeName):n.morphTargets===!0&&o.bindAttribLocation(x,0,"position"),o.linkProgram(x);function F(K){if(s.debug.checkShaderErrors){const J=o.getProgramInfoLog(x).trim(),z=o.getShaderInfoLog(L).trim(),j=o.getShaderInfoLog(B).trim();let G=!0,H=!0;if(o.getProgramParameter(x,o.LINK_STATUS)===!1)if(G=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(o,x,L,B);else{const te=p3(o,L,"vertex"),Z=p3(o,B,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(x,o.VALIDATE_STATUS)+`

Material Name: `+K.name+`
Material Type: `+K.type+`

Program Info Log: `+J+`
`+te+`
`+Z)}else J!==""?console.warn("THREE.WebGLProgram: Program Info Log:",J):(z===""||j==="")&&(H=!1);H&&(K.diagnostics={runnable:G,programLog:J,vertexShader:{log:z,prefix:E},fragmentShader:{log:j,prefix:S}})}o.deleteShader(L),o.deleteShader(B),D=new Z0(o,x),P=FH(o,x)}let D;this.getUniforms=function(){return D===void 0&&F(this),D};let P;this.getAttributes=function(){return P===void 0&&F(this),P};let U=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return U===!1&&(U=o.getProgramParameter(x,SH)),U},this.destroy=function(){i.releaseStatesOfProgram(this),o.deleteProgram(x),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=TH++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=L,this.fragmentShader=B,this}let KH=0;class qH{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,o=this._getShaderStage(n),a=this._getShaderStage(i),c=this._getShaderCacheForMaterial(e);return c.has(o)===!1&&(c.add(o),o.usedTimes++),c.has(a)===!1&&(c.add(a),a.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new YH(e),n.set(e,i)),i}}class YH{constructor(e){this.id=KH++,this.code=e,this.usedTimes=0}}function $H(s,e,n,i,o,a,c){const u=new H_,h=new qH,d=new Set,f=[],p=o.isWebGL2,A=o.logarithmicDepthBuffer,g=o.vertexTextures;let v=o.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(P){return d.add(P),P===0?"uv":`uv${P}`}function E(P,U,K,J,z){const j=J.fog,G=z.geometry,H=P.isMeshStandardMaterial?J.environment:null,te=(P.isMeshStandardMaterial?n:e).get(P.envMap||H),Z=te&&te.mapping===jv?te.image.height:null,ee=b[P.type];P.precision!==null&&(v=o.getMaxPrecision(P.precision),v!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",v,"instead."));const oe=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,xe=oe!==void 0?oe.length:0;let Pe=0;G.morphAttributes.position!==void 0&&(Pe=1),G.morphAttributes.normal!==void 0&&(Pe=2),G.morphAttributes.color!==void 0&&(Pe=3);let me,Ce,Je,Oe;if(ee){const Bn=Za[ee];me=Bn.vertexShader,Ce=Bn.fragmentShader}else me=P.vertexShader,Ce=P.fragmentShader,h.update(P),Je=h.getVertexShaderID(P),Oe=h.getFragmentShaderID(P);const $e=s.getRenderTarget(),nt=z.isInstancedMesh===!0,gt=z.isBatchedMesh===!0,Tt=!!P.map,Ze=!!P.matcap,mn=!!te,Ft=!!P.aoMap,Qt=!!P.lightMap,Xt=!!P.bumpMap,Tn=!!P.normalMap,vn=!!P.displacementMap,Fe=!!P.emissiveMap,Te=!!P.metalnessMap,pt=!!P.roughnessMap,Nt=P.anisotropy>0,zt=P.clearcoat>0,Vt=P.iridescence>0,fn=P.sheen>0,mt=P.transmission>0,Ee=Nt&&!!P.anisotropyMap,_e=zt&&!!P.clearcoatMap,Ne=zt&&!!P.clearcoatNormalMap,ye=zt&&!!P.clearcoatRoughnessMap,De=Vt&&!!P.iridescenceMap,ke=Vt&&!!P.iridescenceThicknessMap,Ye=fn&&!!P.sheenColorMap,Qe=fn&&!!P.sheenRoughnessMap,ne=!!P.specularMap,W=!!P.specularColorMap,k=!!P.specularIntensityMap,he=mt&&!!P.transmissionMap,Re=mt&&!!P.thicknessMap,We=!!P.gradientMap,ve=!!P.alphaMap,at=P.alphaTest>0,At=!!P.alphaHash,Ct=!!P.extensions;let Pt=Qc;P.toneMapped&&($e===null||$e.isXRRenderTarget===!0)&&(Pt=s.toneMapping);const $t={isWebGL2:p,shaderID:ee,shaderType:P.type,shaderName:P.name,vertexShader:me,fragmentShader:Ce,defines:P.defines,customVertexShaderID:Je,customFragmentShaderID:Oe,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:v,batching:gt,instancing:nt,instancingColor:nt&&z.instanceColor!==null,supportsVertexTextures:g,outputColorSpace:$e===null?s.outputColorSpace:$e.isXRRenderTarget===!0?$e.texture.colorSpace:tc,alphaToCoverage:!!P.alphaToCoverage,map:Tt,matcap:Ze,envMap:mn,envMapMode:mn&&te.mapping,envMapCubeUVHeight:Z,aoMap:Ft,lightMap:Qt,bumpMap:Xt,normalMap:Tn,displacementMap:g&&vn,emissiveMap:Fe,normalMapObjectSpace:Tn&&P.normalMapType===K7,normalMapTangentSpace:Tn&&P.normalMapType===uB,metalnessMap:Te,roughnessMap:pt,anisotropy:Nt,anisotropyMap:Ee,clearcoat:zt,clearcoatMap:_e,clearcoatNormalMap:Ne,clearcoatRoughnessMap:ye,iridescence:Vt,iridescenceMap:De,iridescenceThicknessMap:ke,sheen:fn,sheenColorMap:Ye,sheenRoughnessMap:Qe,specularMap:ne,specularColorMap:W,specularIntensityMap:k,transmission:mt,transmissionMap:he,thicknessMap:Re,gradientMap:We,opaque:P.transparent===!1&&P.blending===of&&P.alphaToCoverage===!1,alphaMap:ve,alphaTest:at,alphaHash:At,combine:P.combine,mapUv:Tt&&x(P.map.channel),aoMapUv:Ft&&x(P.aoMap.channel),lightMapUv:Qt&&x(P.lightMap.channel),bumpMapUv:Xt&&x(P.bumpMap.channel),normalMapUv:Tn&&x(P.normalMap.channel),displacementMapUv:vn&&x(P.displacementMap.channel),emissiveMapUv:Fe&&x(P.emissiveMap.channel),metalnessMapUv:Te&&x(P.metalnessMap.channel),roughnessMapUv:pt&&x(P.roughnessMap.channel),anisotropyMapUv:Ee&&x(P.anisotropyMap.channel),clearcoatMapUv:_e&&x(P.clearcoatMap.channel),clearcoatNormalMapUv:Ne&&x(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ye&&x(P.clearcoatRoughnessMap.channel),iridescenceMapUv:De&&x(P.iridescenceMap.channel),iridescenceThicknessMapUv:ke&&x(P.iridescenceThicknessMap.channel),sheenColorMapUv:Ye&&x(P.sheenColorMap.channel),sheenRoughnessMapUv:Qe&&x(P.sheenRoughnessMap.channel),specularMapUv:ne&&x(P.specularMap.channel),specularColorMapUv:W&&x(P.specularColorMap.channel),specularIntensityMapUv:k&&x(P.specularIntensityMap.channel),transmissionMapUv:he&&x(P.transmissionMap.channel),thicknessMapUv:Re&&x(P.thicknessMap.channel),alphaMapUv:ve&&x(P.alphaMap.channel),vertexTangents:!!G.attributes.tangent&&(Tn||Nt),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!G.attributes.color&&G.attributes.color.itemSize===4,pointsUvs:z.isPoints===!0&&!!G.attributes.uv&&(Tt||ve),fog:!!j,useFog:P.fog===!0,fogExp2:!!j&&j.isFogExp2,flatShading:P.flatShading===!0,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:A,skinning:z.isSkinnedMesh===!0,morphTargets:G.morphAttributes.position!==void 0,morphNormals:G.morphAttributes.normal!==void 0,morphColors:G.morphAttributes.color!==void 0,morphTargetsCount:xe,morphTextureStride:Pe,numDirLights:U.directional.length,numPointLights:U.point.length,numSpotLights:U.spot.length,numSpotLightMaps:U.spotLightMap.length,numRectAreaLights:U.rectArea.length,numHemiLights:U.hemi.length,numDirLightShadows:U.directionalShadowMap.length,numPointLightShadows:U.pointShadowMap.length,numSpotLightShadows:U.spotShadowMap.length,numSpotLightShadowsWithMaps:U.numSpotLightShadowsWithMaps,numLightProbes:U.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:P.dithering,shadowMapEnabled:s.shadowMap.enabled&&K.length>0,shadowMapType:s.shadowMap.type,toneMapping:Pt,useLegacyLights:s._useLegacyLights,decodeVideoTexture:Tt&&P.map.isVideoTexture===!0&&Mr.getTransfer(P.map.colorSpace)===Dr,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===jl,flipSided:P.side===Ao,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionDerivatives:Ct&&P.extensions.derivatives===!0,extensionFragDepth:Ct&&P.extensions.fragDepth===!0,extensionDrawBuffers:Ct&&P.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ct&&P.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Ct&&P.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Ct&&P.extensions.multiDraw===!0&&i.has("WEBGL_multi_draw"),rendererExtensionFragDepth:p||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:P.customProgramCacheKey()};return $t.vertexUv1s=d.has(1),$t.vertexUv2s=d.has(2),$t.vertexUv3s=d.has(3),d.clear(),$t}function S(P){const U=[];if(P.shaderID?U.push(P.shaderID):(U.push(P.customVertexShaderID),U.push(P.customFragmentShaderID)),P.defines!==void 0)for(const K in P.defines)U.push(K),U.push(P.defines[K]);return P.isRawShaderMaterial===!1&&(M(U,P),C(U,P),U.push(s.outputColorSpace)),U.push(P.customProgramCacheKey),U.join()}function M(P,U){P.push(U.precision),P.push(U.outputColorSpace),P.push(U.envMapMode),P.push(U.envMapCubeUVHeight),P.push(U.mapUv),P.push(U.alphaMapUv),P.push(U.lightMapUv),P.push(U.aoMapUv),P.push(U.bumpMapUv),P.push(U.normalMapUv),P.push(U.displacementMapUv),P.push(U.emissiveMapUv),P.push(U.metalnessMapUv),P.push(U.roughnessMapUv),P.push(U.anisotropyMapUv),P.push(U.clearcoatMapUv),P.push(U.clearcoatNormalMapUv),P.push(U.clearcoatRoughnessMapUv),P.push(U.iridescenceMapUv),P.push(U.iridescenceThicknessMapUv),P.push(U.sheenColorMapUv),P.push(U.sheenRoughnessMapUv),P.push(U.specularMapUv),P.push(U.specularColorMapUv),P.push(U.specularIntensityMapUv),P.push(U.transmissionMapUv),P.push(U.thicknessMapUv),P.push(U.combine),P.push(U.fogExp2),P.push(U.sizeAttenuation),P.push(U.morphTargetsCount),P.push(U.morphAttributeCount),P.push(U.numDirLights),P.push(U.numPointLights),P.push(U.numSpotLights),P.push(U.numSpotLightMaps),P.push(U.numHemiLights),P.push(U.numRectAreaLights),P.push(U.numDirLightShadows),P.push(U.numPointLightShadows),P.push(U.numSpotLightShadows),P.push(U.numSpotLightShadowsWithMaps),P.push(U.numLightProbes),P.push(U.shadowMapType),P.push(U.toneMapping),P.push(U.numClippingPlanes),P.push(U.numClipIntersection),P.push(U.depthPacking)}function C(P,U){u.disableAll(),U.isWebGL2&&u.enable(0),U.supportsVertexTextures&&u.enable(1),U.instancing&&u.enable(2),U.instancingColor&&u.enable(3),U.matcap&&u.enable(4),U.envMap&&u.enable(5),U.normalMapObjectSpace&&u.enable(6),U.normalMapTangentSpace&&u.enable(7),U.clearcoat&&u.enable(8),U.iridescence&&u.enable(9),U.alphaTest&&u.enable(10),U.vertexColors&&u.enable(11),U.vertexAlphas&&u.enable(12),U.vertexUv1s&&u.enable(13),U.vertexUv2s&&u.enable(14),U.vertexUv3s&&u.enable(15),U.vertexTangents&&u.enable(16),U.anisotropy&&u.enable(17),U.alphaHash&&u.enable(18),U.batching&&u.enable(19),P.push(u.mask),u.disableAll(),U.fog&&u.enable(0),U.useFog&&u.enable(1),U.flatShading&&u.enable(2),U.logarithmicDepthBuffer&&u.enable(3),U.skinning&&u.enable(4),U.morphTargets&&u.enable(5),U.morphNormals&&u.enable(6),U.morphColors&&u.enable(7),U.premultipliedAlpha&&u.enable(8),U.shadowMapEnabled&&u.enable(9),U.useLegacyLights&&u.enable(10),U.doubleSided&&u.enable(11),U.flipSided&&u.enable(12),U.useDepthPacking&&u.enable(13),U.dithering&&u.enable(14),U.transmission&&u.enable(15),U.sheen&&u.enable(16),U.opaque&&u.enable(17),U.pointsUvs&&u.enable(18),U.decodeVideoTexture&&u.enable(19),U.alphaToCoverage&&u.enable(20),P.push(u.mask)}function T(P){const U=b[P.type];let K;if(U){const J=Za[U];K=EB.clone(J.uniforms)}else K=P.uniforms;return K}function L(P,U){let K;for(let J=0,z=f.length;J<z;J++){const j=f[J];if(j.cacheKey===U){K=j,++K.usedTimes;break}}return K===void 0&&(K=new XH(s,U,P,a),f.push(K)),K}function B(P){if(--P.usedTimes===0){const U=f.indexOf(P);f[U]=f[f.length-1],f.pop(),P.destroy()}}function F(P){h.remove(P)}function D(){h.dispose()}return{getParameters:E,getProgramCacheKey:S,getUniforms:T,acquireProgram:L,releaseProgram:B,releaseShaderCache:F,programs:f,dispose:D}}function JH(){let s=new WeakMap;function e(a){let c=s.get(a);return c===void 0&&(c={},s.set(a,c)),c}function n(a){s.delete(a)}function i(a,c,u){s.get(a)[c]=u}function o(){s=new WeakMap}return{get:e,remove:n,update:i,dispose:o}}function ZH(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function y3(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function x3(){const s=[];let e=0;const n=[],i=[],o=[];function a(){e=0,n.length=0,i.length=0,o.length=0}function c(p,A,g,v,b,x){let E=s[e];return E===void 0?(E={id:p.id,object:p,geometry:A,material:g,groupOrder:v,renderOrder:p.renderOrder,z:b,group:x},s[e]=E):(E.id=p.id,E.object=p,E.geometry=A,E.material=g,E.groupOrder=v,E.renderOrder=p.renderOrder,E.z=b,E.group=x),e++,E}function u(p,A,g,v,b,x){const E=c(p,A,g,v,b,x);g.transmission>0?i.push(E):g.transparent===!0?o.push(E):n.push(E)}function h(p,A,g,v,b,x){const E=c(p,A,g,v,b,x);g.transmission>0?i.unshift(E):g.transparent===!0?o.unshift(E):n.unshift(E)}function d(p,A){n.length>1&&n.sort(p||ZH),i.length>1&&i.sort(A||y3),o.length>1&&o.sort(A||y3)}function f(){for(let p=e,A=s.length;p<A;p++){const g=s[p];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:n,transmissive:i,transparent:o,init:a,push:u,unshift:h,finish:f,sort:d}}function ej(){let s=new WeakMap;function e(i,o){const a=s.get(i);let c;return a===void 0?(c=new x3,s.set(i,[c])):o>=a.length?(c=new x3,a.push(c)):c=a[o],c}function n(){s=new WeakMap}return{get:e,dispose:n}}function tj(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new it,color:new or};break;case"SpotLight":n={position:new it,direction:new it,color:new or,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new it,color:new or,distance:0,decay:0};break;case"HemisphereLight":n={direction:new it,skyColor:new or,groundColor:new or};break;case"RectAreaLight":n={color:new or,position:new it,halfWidth:new it,halfHeight:new it};break}return s[e.id]=n,n}}}function nj(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Mn};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Mn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Mn,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=n,n}}}let ij=0;function rj(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function sj(s,e){const n=new tj,i=nj(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let f=0;f<9;f++)o.probe.push(new it);const a=new it,c=new Gr,u=new Gr;function h(f,p){let A=0,g=0,v=0;for(let K=0;K<9;K++)o.probe[K].set(0,0,0);let b=0,x=0,E=0,S=0,M=0,C=0,T=0,L=0,B=0,F=0,D=0;f.sort(rj);const P=p===!0?Math.PI:1;for(let K=0,J=f.length;K<J;K++){const z=f[K],j=z.color,G=z.intensity,H=z.distance,te=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)A+=j.r*G*P,g+=j.g*G*P,v+=j.b*G*P;else if(z.isLightProbe){for(let Z=0;Z<9;Z++)o.probe[Z].addScaledVector(z.sh.coefficients[Z],G);D++}else if(z.isDirectionalLight){const Z=n.get(z);if(Z.color.copy(z.color).multiplyScalar(z.intensity*P),z.castShadow){const ee=z.shadow,oe=i.get(z);oe.shadowBias=ee.bias,oe.shadowNormalBias=ee.normalBias,oe.shadowRadius=ee.radius,oe.shadowMapSize=ee.mapSize,o.directionalShadow[b]=oe,o.directionalShadowMap[b]=te,o.directionalShadowMatrix[b]=z.shadow.matrix,C++}o.directional[b]=Z,b++}else if(z.isSpotLight){const Z=n.get(z);Z.position.setFromMatrixPosition(z.matrixWorld),Z.color.copy(j).multiplyScalar(G*P),Z.distance=H,Z.coneCos=Math.cos(z.angle),Z.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),Z.decay=z.decay,o.spot[E]=Z;const ee=z.shadow;if(z.map&&(o.spotLightMap[B]=z.map,B++,ee.updateMatrices(z),z.castShadow&&F++),o.spotLightMatrix[E]=ee.matrix,z.castShadow){const oe=i.get(z);oe.shadowBias=ee.bias,oe.shadowNormalBias=ee.normalBias,oe.shadowRadius=ee.radius,oe.shadowMapSize=ee.mapSize,o.spotShadow[E]=oe,o.spotShadowMap[E]=te,L++}E++}else if(z.isRectAreaLight){const Z=n.get(z);Z.color.copy(j).multiplyScalar(G),Z.halfWidth.set(z.width*.5,0,0),Z.halfHeight.set(0,z.height*.5,0),o.rectArea[S]=Z,S++}else if(z.isPointLight){const Z=n.get(z);if(Z.color.copy(z.color).multiplyScalar(z.intensity*P),Z.distance=z.distance,Z.decay=z.decay,z.castShadow){const ee=z.shadow,oe=i.get(z);oe.shadowBias=ee.bias,oe.shadowNormalBias=ee.normalBias,oe.shadowRadius=ee.radius,oe.shadowMapSize=ee.mapSize,oe.shadowCameraNear=ee.camera.near,oe.shadowCameraFar=ee.camera.far,o.pointShadow[x]=oe,o.pointShadowMap[x]=te,o.pointShadowMatrix[x]=z.shadow.matrix,T++}o.point[x]=Z,x++}else if(z.isHemisphereLight){const Z=n.get(z);Z.skyColor.copy(z.color).multiplyScalar(G*P),Z.groundColor.copy(z.groundColor).multiplyScalar(G*P),o.hemi[M]=Z,M++}}S>0&&(e.isWebGL2?s.has("OES_texture_float_linear")===!0?(o.rectAreaLTC1=On.LTC_FLOAT_1,o.rectAreaLTC2=On.LTC_FLOAT_2):(o.rectAreaLTC1=On.LTC_HALF_1,o.rectAreaLTC2=On.LTC_HALF_2):s.has("OES_texture_float_linear")===!0?(o.rectAreaLTC1=On.LTC_FLOAT_1,o.rectAreaLTC2=On.LTC_FLOAT_2):s.has("OES_texture_half_float_linear")===!0?(o.rectAreaLTC1=On.LTC_HALF_1,o.rectAreaLTC2=On.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=A,o.ambient[1]=g,o.ambient[2]=v;const U=o.hash;(U.directionalLength!==b||U.pointLength!==x||U.spotLength!==E||U.rectAreaLength!==S||U.hemiLength!==M||U.numDirectionalShadows!==C||U.numPointShadows!==T||U.numSpotShadows!==L||U.numSpotMaps!==B||U.numLightProbes!==D)&&(o.directional.length=b,o.spot.length=E,o.rectArea.length=S,o.point.length=x,o.hemi.length=M,o.directionalShadow.length=C,o.directionalShadowMap.length=C,o.pointShadow.length=T,o.pointShadowMap.length=T,o.spotShadow.length=L,o.spotShadowMap.length=L,o.directionalShadowMatrix.length=C,o.pointShadowMatrix.length=T,o.spotLightMatrix.length=L+B-F,o.spotLightMap.length=B,o.numSpotLightShadowsWithMaps=F,o.numLightProbes=D,U.directionalLength=b,U.pointLength=x,U.spotLength=E,U.rectAreaLength=S,U.hemiLength=M,U.numDirectionalShadows=C,U.numPointShadows=T,U.numSpotShadows=L,U.numSpotMaps=B,U.numLightProbes=D,o.version=ij++)}function d(f,p){let A=0,g=0,v=0,b=0,x=0;const E=p.matrixWorldInverse;for(let S=0,M=f.length;S<M;S++){const C=f[S];if(C.isDirectionalLight){const T=o.directional[A];T.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(a),T.direction.transformDirection(E),A++}else if(C.isSpotLight){const T=o.spot[v];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(E),T.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(a),T.direction.transformDirection(E),v++}else if(C.isRectAreaLight){const T=o.rectArea[b];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(E),u.identity(),c.copy(C.matrixWorld),c.premultiply(E),u.extractRotation(c),T.halfWidth.set(C.width*.5,0,0),T.halfHeight.set(0,C.height*.5,0),T.halfWidth.applyMatrix4(u),T.halfHeight.applyMatrix4(u),b++}else if(C.isPointLight){const T=o.point[g];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(E),g++}else if(C.isHemisphereLight){const T=o.hemi[x];T.direction.setFromMatrixPosition(C.matrixWorld),T.direction.transformDirection(E),x++}}}return{setup:h,setupView:d,state:o}}function E3(s,e){const n=new sj(s,e),i=[],o=[];function a(){i.length=0,o.length=0}function c(p){i.push(p)}function u(p){o.push(p)}function h(p){n.setup(i,p)}function d(p){n.setupView(i,p)}return{init:a,state:{lightsArray:i,shadowsArray:o,lights:n},setupLights:h,setupLightsView:d,pushLight:c,pushShadow:u}}function oj(s,e){let n=new WeakMap;function i(a,c=0){const u=n.get(a);let h;return u===void 0?(h=new E3(s,e),n.set(a,[h])):c>=u.length?(h=new E3(s,e),u.push(h)):h=u[c],h}function o(){n=new WeakMap}return{get:i,dispose:o}}class aj extends uu{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Q7,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class lj extends uu{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const cj=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,hj=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function uj(s,e,n){let i=new j_;const o=new Mn,a=new Mn,c=new Bs,u=new aj({depthPacking:X7}),h=new lj,d={},f=n.maxTextureSize,p={[qc]:Ao,[Ao]:qc,[jl]:jl},A=new nl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Mn},radius:{value:4}},vertexShader:cj,fragmentShader:hj}),g=A.clone();g.defines.HORIZONTAL_PASS=1;const v=new Lo;v.setAttribute("position",new ha(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new Qo(v,A),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=tB;let E=this.type;this.render=function(L,B,F){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||L.length===0)return;const D=s.getRenderTarget(),P=s.getActiveCubeFace(),U=s.getActiveMipmapLevel(),K=s.state;K.setBlending($l),K.buffers.color.setClear(1,1,1,1),K.buffers.depth.setTest(!0),K.setScissorTest(!1);const J=E!==zl&&this.type===zl,z=E===zl&&this.type!==zl;for(let j=0,G=L.length;j<G;j++){const H=L[j],te=H.shadow;if(te===void 0){console.warn("THREE.WebGLShadowMap:",H,"has no shadow.");continue}if(te.autoUpdate===!1&&te.needsUpdate===!1)continue;o.copy(te.mapSize);const Z=te.getFrameExtents();if(o.multiply(Z),a.copy(te.mapSize),(o.x>f||o.y>f)&&(o.x>f&&(a.x=Math.floor(f/Z.x),o.x=a.x*Z.x,te.mapSize.x=a.x),o.y>f&&(a.y=Math.floor(f/Z.y),o.y=a.y*Z.y,te.mapSize.y=a.y)),te.map===null||J===!0||z===!0){const oe=this.type!==zl?{minFilter:mo,magFilter:mo}:{};te.map!==null&&te.map.dispose(),te.map=new Yc(o.x,o.y,oe),te.map.texture.name=H.name+".shadowMap",te.camera.updateProjectionMatrix()}s.setRenderTarget(te.map),s.clear();const ee=te.getViewportCount();for(let oe=0;oe<ee;oe++){const xe=te.getViewport(oe);c.set(a.x*xe.x,a.y*xe.y,a.x*xe.z,a.y*xe.w),K.viewport(c),te.updateMatrices(H,oe),i=te.getFrustum(),C(B,F,te.camera,H,this.type)}te.isPointLightShadow!==!0&&this.type===zl&&S(te,F),te.needsUpdate=!1}E=this.type,x.needsUpdate=!1,s.setRenderTarget(D,P,U)};function S(L,B){const F=e.update(b);A.defines.VSM_SAMPLES!==L.blurSamples&&(A.defines.VSM_SAMPLES=L.blurSamples,g.defines.VSM_SAMPLES=L.blurSamples,A.needsUpdate=!0,g.needsUpdate=!0),L.mapPass===null&&(L.mapPass=new Yc(o.x,o.y)),A.uniforms.shadow_pass.value=L.map.texture,A.uniforms.resolution.value=L.mapSize,A.uniforms.radius.value=L.radius,s.setRenderTarget(L.mapPass),s.clear(),s.renderBufferDirect(B,null,F,A,b,null),g.uniforms.shadow_pass.value=L.mapPass.texture,g.uniforms.resolution.value=L.mapSize,g.uniforms.radius.value=L.radius,s.setRenderTarget(L.map),s.clear(),s.renderBufferDirect(B,null,F,g,b,null)}function M(L,B,F,D){let P=null;const U=F.isPointLight===!0?L.customDistanceMaterial:L.customDepthMaterial;if(U!==void 0)P=U;else if(P=F.isPointLight===!0?h:u,s.localClippingEnabled&&B.clipShadows===!0&&Array.isArray(B.clippingPlanes)&&B.clippingPlanes.length!==0||B.displacementMap&&B.displacementScale!==0||B.alphaMap&&B.alphaTest>0||B.map&&B.alphaTest>0){const K=P.uuid,J=B.uuid;let z=d[K];z===void 0&&(z={},d[K]=z);let j=z[J];j===void 0&&(j=P.clone(),z[J]=j,B.addEventListener("dispose",T)),P=j}if(P.visible=B.visible,P.wireframe=B.wireframe,D===zl?P.side=B.shadowSide!==null?B.shadowSide:B.side:P.side=B.shadowSide!==null?B.shadowSide:p[B.side],P.alphaMap=B.alphaMap,P.alphaTest=B.alphaTest,P.map=B.map,P.clipShadows=B.clipShadows,P.clippingPlanes=B.clippingPlanes,P.clipIntersection=B.clipIntersection,P.displacementMap=B.displacementMap,P.displacementScale=B.displacementScale,P.displacementBias=B.displacementBias,P.wireframeLinewidth=B.wireframeLinewidth,P.linewidth=B.linewidth,F.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const K=s.properties.get(P);K.light=F}return P}function C(L,B,F,D,P){if(L.visible===!1)return;if(L.layers.test(B.layers)&&(L.isMesh||L.isLine||L.isPoints)&&(L.castShadow||L.receiveShadow&&P===zl)&&(!L.frustumCulled||i.intersectsObject(L))){L.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,L.matrixWorld);const J=e.update(L),z=L.material;if(Array.isArray(z)){const j=J.groups;for(let G=0,H=j.length;G<H;G++){const te=j[G],Z=z[te.materialIndex];if(Z&&Z.visible){const ee=M(L,Z,D,P);L.onBeforeShadow(s,L,B,F,J,ee,te),s.renderBufferDirect(F,null,J,ee,L,te),L.onAfterShadow(s,L,B,F,J,ee,te)}}}else if(z.visible){const j=M(L,z,D,P);L.onBeforeShadow(s,L,B,F,J,j,null),s.renderBufferDirect(F,null,J,j,L,null),L.onAfterShadow(s,L,B,F,J,j,null)}}const K=L.children;for(let J=0,z=K.length;J<z;J++)C(K[J],B,F,D,P)}function T(L){L.target.removeEventListener("dispose",T);for(const F in d){const D=d[F],P=L.target.uuid;P in D&&(D[P].dispose(),delete D[P])}}}function dj(s,e,n){const i=n.isWebGL2;function o(){let ve=!1;const at=new Bs;let At=null;const Ct=new Bs(0,0,0,0);return{setMask:function(Pt){At!==Pt&&!ve&&(s.colorMask(Pt,Pt,Pt,Pt),At=Pt)},setLocked:function(Pt){ve=Pt},setClear:function(Pt,$t,Bn,pi,Ri){Ri===!0&&(Pt*=pi,$t*=pi,Bn*=pi),at.set(Pt,$t,Bn,pi),Ct.equals(at)===!1&&(s.clearColor(Pt,$t,Bn,pi),Ct.copy(at))},reset:function(){ve=!1,At=null,Ct.set(-1,0,0,0)}}}function a(){let ve=!1,at=null,At=null,Ct=null;return{setTest:function(Pt){Pt?nt(s.DEPTH_TEST):gt(s.DEPTH_TEST)},setMask:function(Pt){at!==Pt&&!ve&&(s.depthMask(Pt),at=Pt)},setFunc:function(Pt){if(At!==Pt){switch(Pt){case _7:s.depthFunc(s.NEVER);break;case w7:s.depthFunc(s.ALWAYS);break;case M7:s.depthFunc(s.LESS);break;case dv:s.depthFunc(s.LEQUAL);break;case C7:s.depthFunc(s.EQUAL);break;case S7:s.depthFunc(s.GEQUAL);break;case T7:s.depthFunc(s.GREATER);break;case R7:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}At=Pt}},setLocked:function(Pt){ve=Pt},setClear:function(Pt){Ct!==Pt&&(s.clearDepth(Pt),Ct=Pt)},reset:function(){ve=!1,at=null,At=null,Ct=null}}}function c(){let ve=!1,at=null,At=null,Ct=null,Pt=null,$t=null,Bn=null,pi=null,Ri=null;return{setTest:function(Fn){ve||(Fn?nt(s.STENCIL_TEST):gt(s.STENCIL_TEST))},setMask:function(Fn){at!==Fn&&!ve&&(s.stencilMask(Fn),at=Fn)},setFunc:function(Fn,sn,Rt){(At!==Fn||Ct!==sn||Pt!==Rt)&&(s.stencilFunc(Fn,sn,Rt),At=Fn,Ct=sn,Pt=Rt)},setOp:function(Fn,sn,Rt){($t!==Fn||Bn!==sn||pi!==Rt)&&(s.stencilOp(Fn,sn,Rt),$t=Fn,Bn=sn,pi=Rt)},setLocked:function(Fn){ve=Fn},setClear:function(Fn){Ri!==Fn&&(s.clearStencil(Fn),Ri=Fn)},reset:function(){ve=!1,at=null,At=null,Ct=null,Pt=null,$t=null,Bn=null,pi=null,Ri=null}}}const u=new o,h=new a,d=new c,f=new WeakMap,p=new WeakMap;let A={},g={},v=new WeakMap,b=[],x=null,E=!1,S=null,M=null,C=null,T=null,L=null,B=null,F=null,D=new or(0,0,0),P=0,U=!1,K=null,J=null,z=null,j=null,G=null;const H=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let te=!1,Z=0;const ee=s.getParameter(s.VERSION);ee.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(ee)[1]),te=Z>=1):ee.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(ee)[1]),te=Z>=2);let oe=null,xe={};const Pe=s.getParameter(s.SCISSOR_BOX),me=s.getParameter(s.VIEWPORT),Ce=new Bs().fromArray(Pe),Je=new Bs().fromArray(me);function Oe(ve,at,At,Ct){const Pt=new Uint8Array(4),$t=s.createTexture();s.bindTexture(ve,$t),s.texParameteri(ve,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(ve,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let Bn=0;Bn<At;Bn++)i&&(ve===s.TEXTURE_3D||ve===s.TEXTURE_2D_ARRAY)?s.texImage3D(at,0,s.RGBA,1,1,Ct,0,s.RGBA,s.UNSIGNED_BYTE,Pt):s.texImage2D(at+Bn,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,Pt);return $t}const $e={};$e[s.TEXTURE_2D]=Oe(s.TEXTURE_2D,s.TEXTURE_2D,1),$e[s.TEXTURE_CUBE_MAP]=Oe(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&($e[s.TEXTURE_2D_ARRAY]=Oe(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),$e[s.TEXTURE_3D]=Oe(s.TEXTURE_3D,s.TEXTURE_3D,1,1)),u.setClear(0,0,0,1),h.setClear(1),d.setClear(0),nt(s.DEPTH_TEST),h.setFunc(dv),vn(!1),Fe(tT),nt(s.CULL_FACE),Xt($l);function nt(ve){A[ve]!==!0&&(s.enable(ve),A[ve]=!0)}function gt(ve){A[ve]!==!1&&(s.disable(ve),A[ve]=!1)}function Tt(ve,at){return g[ve]!==at?(s.bindFramebuffer(ve,at),g[ve]=at,i&&(ve===s.DRAW_FRAMEBUFFER&&(g[s.FRAMEBUFFER]=at),ve===s.FRAMEBUFFER&&(g[s.DRAW_FRAMEBUFFER]=at)),!0):!1}function Ze(ve,at){let At=b,Ct=!1;if(ve)if(At=v.get(at),At===void 0&&(At=[],v.set(at,At)),ve.isWebGLMultipleRenderTargets){const Pt=ve.texture;if(At.length!==Pt.length||At[0]!==s.COLOR_ATTACHMENT0){for(let $t=0,Bn=Pt.length;$t<Bn;$t++)At[$t]=s.COLOR_ATTACHMENT0+$t;At.length=Pt.length,Ct=!0}}else At[0]!==s.COLOR_ATTACHMENT0&&(At[0]=s.COLOR_ATTACHMENT0,Ct=!0);else At[0]!==s.BACK&&(At[0]=s.BACK,Ct=!0);Ct&&(n.isWebGL2?s.drawBuffers(At):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(At))}function mn(ve){return x!==ve?(s.useProgram(ve),x=ve,!0):!1}const Ft={[Kh]:s.FUNC_ADD,[l7]:s.FUNC_SUBTRACT,[c7]:s.FUNC_REVERSE_SUBTRACT};if(i)Ft[sT]=s.MIN,Ft[oT]=s.MAX;else{const ve=e.get("EXT_blend_minmax");ve!==null&&(Ft[sT]=ve.MIN_EXT,Ft[oT]=ve.MAX_EXT)}const Qt={[h7]:s.ZERO,[u7]:s.ONE,[d7]:s.SRC_COLOR,[Pb]:s.SRC_ALPHA,[v7]:s.SRC_ALPHA_SATURATE,[g7]:s.DST_COLOR,[p7]:s.DST_ALPHA,[f7]:s.ONE_MINUS_SRC_COLOR,[Db]:s.ONE_MINUS_SRC_ALPHA,[A7]:s.ONE_MINUS_DST_COLOR,[m7]:s.ONE_MINUS_DST_ALPHA,[y7]:s.CONSTANT_COLOR,[x7]:s.ONE_MINUS_CONSTANT_COLOR,[E7]:s.CONSTANT_ALPHA,[b7]:s.ONE_MINUS_CONSTANT_ALPHA};function Xt(ve,at,At,Ct,Pt,$t,Bn,pi,Ri,Fn){if(ve===$l){E===!0&&(gt(s.BLEND),E=!1);return}if(E===!1&&(nt(s.BLEND),E=!0),ve!==a7){if(ve!==S||Fn!==U){if((M!==Kh||L!==Kh)&&(s.blendEquation(s.FUNC_ADD),M=Kh,L=Kh),Fn)switch(ve){case of:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case nT:s.blendFunc(s.ONE,s.ONE);break;case iT:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case rT:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ve);break}else switch(ve){case of:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case nT:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case iT:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case rT:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ve);break}C=null,T=null,B=null,F=null,D.set(0,0,0),P=0,S=ve,U=Fn}return}Pt=Pt||at,$t=$t||At,Bn=Bn||Ct,(at!==M||Pt!==L)&&(s.blendEquationSeparate(Ft[at],Ft[Pt]),M=at,L=Pt),(At!==C||Ct!==T||$t!==B||Bn!==F)&&(s.blendFuncSeparate(Qt[At],Qt[Ct],Qt[$t],Qt[Bn]),C=At,T=Ct,B=$t,F=Bn),(pi.equals(D)===!1||Ri!==P)&&(s.blendColor(pi.r,pi.g,pi.b,Ri),D.copy(pi),P=Ri),S=ve,U=!1}function Tn(ve,at){ve.side===jl?gt(s.CULL_FACE):nt(s.CULL_FACE);let At=ve.side===Ao;at&&(At=!At),vn(At),ve.blending===of&&ve.transparent===!1?Xt($l):Xt(ve.blending,ve.blendEquation,ve.blendSrc,ve.blendDst,ve.blendEquationAlpha,ve.blendSrcAlpha,ve.blendDstAlpha,ve.blendColor,ve.blendAlpha,ve.premultipliedAlpha),h.setFunc(ve.depthFunc),h.setTest(ve.depthTest),h.setMask(ve.depthWrite),u.setMask(ve.colorWrite);const Ct=ve.stencilWrite;d.setTest(Ct),Ct&&(d.setMask(ve.stencilWriteMask),d.setFunc(ve.stencilFunc,ve.stencilRef,ve.stencilFuncMask),d.setOp(ve.stencilFail,ve.stencilZFail,ve.stencilZPass)),pt(ve.polygonOffset,ve.polygonOffsetFactor,ve.polygonOffsetUnits),ve.alphaToCoverage===!0?nt(s.SAMPLE_ALPHA_TO_COVERAGE):gt(s.SAMPLE_ALPHA_TO_COVERAGE)}function vn(ve){K!==ve&&(ve?s.frontFace(s.CW):s.frontFace(s.CCW),K=ve)}function Fe(ve){ve!==r7?(nt(s.CULL_FACE),ve!==J&&(ve===tT?s.cullFace(s.BACK):ve===s7?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):gt(s.CULL_FACE),J=ve}function Te(ve){ve!==z&&(te&&s.lineWidth(ve),z=ve)}function pt(ve,at,At){ve?(nt(s.POLYGON_OFFSET_FILL),(j!==at||G!==At)&&(s.polygonOffset(at,At),j=at,G=At)):gt(s.POLYGON_OFFSET_FILL)}function Nt(ve){ve?nt(s.SCISSOR_TEST):gt(s.SCISSOR_TEST)}function zt(ve){ve===void 0&&(ve=s.TEXTURE0+H-1),oe!==ve&&(s.activeTexture(ve),oe=ve)}function Vt(ve,at,At){At===void 0&&(oe===null?At=s.TEXTURE0+H-1:At=oe);let Ct=xe[At];Ct===void 0&&(Ct={type:void 0,texture:void 0},xe[At]=Ct),(Ct.type!==ve||Ct.texture!==at)&&(oe!==At&&(s.activeTexture(At),oe=At),s.bindTexture(ve,at||$e[ve]),Ct.type=ve,Ct.texture=at)}function fn(){const ve=xe[oe];ve!==void 0&&ve.type!==void 0&&(s.bindTexture(ve.type,null),ve.type=void 0,ve.texture=void 0)}function mt(){try{s.compressedTexImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Ee(){try{s.compressedTexImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function _e(){try{s.texSubImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Ne(){try{s.texSubImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function ye(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function De(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function ke(){try{s.texStorage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Ye(){try{s.texStorage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Qe(){try{s.texImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function ne(){try{s.texImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function W(ve){Ce.equals(ve)===!1&&(s.scissor(ve.x,ve.y,ve.z,ve.w),Ce.copy(ve))}function k(ve){Je.equals(ve)===!1&&(s.viewport(ve.x,ve.y,ve.z,ve.w),Je.copy(ve))}function he(ve,at){let At=p.get(at);At===void 0&&(At=new WeakMap,p.set(at,At));let Ct=At.get(ve);Ct===void 0&&(Ct=s.getUniformBlockIndex(at,ve.name),At.set(ve,Ct))}function Re(ve,at){const Ct=p.get(at).get(ve);f.get(at)!==Ct&&(s.uniformBlockBinding(at,Ct,ve.__bindingPointIndex),f.set(at,Ct))}function We(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),i===!0&&(s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null)),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),A={},oe=null,xe={},g={},v=new WeakMap,b=[],x=null,E=!1,S=null,M=null,C=null,T=null,L=null,B=null,F=null,D=new or(0,0,0),P=0,U=!1,K=null,J=null,z=null,j=null,G=null,Ce.set(0,0,s.canvas.width,s.canvas.height),Je.set(0,0,s.canvas.width,s.canvas.height),u.reset(),h.reset(),d.reset()}return{buffers:{color:u,depth:h,stencil:d},enable:nt,disable:gt,bindFramebuffer:Tt,drawBuffers:Ze,useProgram:mn,setBlending:Xt,setMaterial:Tn,setFlipSided:vn,setCullFace:Fe,setLineWidth:Te,setPolygonOffset:pt,setScissorTest:Nt,activeTexture:zt,bindTexture:Vt,unbindTexture:fn,compressedTexImage2D:mt,compressedTexImage3D:Ee,texImage2D:Qe,texImage3D:ne,updateUBOMapping:he,uniformBlockBinding:Re,texStorage2D:ke,texStorage3D:Ye,texSubImage2D:_e,texSubImage3D:Ne,compressedTexSubImage2D:ye,compressedTexSubImage3D:De,scissor:W,viewport:k,reset:We}}function fj(s,e,n,i,o,a,c){const u=o.isWebGL2,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let p;const A=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(Fe,Te){return g?new OffscreenCanvas(Fe,Te):pm("canvas")}function b(Fe,Te,pt,Nt){let zt=1;if((Fe.width>Nt||Fe.height>Nt)&&(zt=Nt/Math.max(Fe.width,Fe.height)),zt<1||Te===!0)if(typeof HTMLImageElement<"u"&&Fe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Fe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Fe instanceof ImageBitmap){const Vt=Te?Av:Math.floor,fn=Vt(zt*Fe.width),mt=Vt(zt*Fe.height);p===void 0&&(p=v(fn,mt));const Ee=pt?v(fn,mt):p;return Ee.width=fn,Ee.height=mt,Ee.getContext("2d").drawImage(Fe,0,0,fn,mt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Fe.width+"x"+Fe.height+") to ("+fn+"x"+mt+")."),Ee}else return"data"in Fe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Fe.width+"x"+Fe.height+")."),Fe;return Fe}function x(Fe){return Gb(Fe.width)&&Gb(Fe.height)}function E(Fe){return u?!1:Fe.wrapS!==Pa||Fe.wrapT!==Pa||Fe.minFilter!==mo&&Fe.minFilter!==fo}function S(Fe,Te){return Fe.generateMipmaps&&Te&&Fe.minFilter!==mo&&Fe.minFilter!==fo}function M(Fe){s.generateMipmap(Fe)}function C(Fe,Te,pt,Nt,zt=!1){if(u===!1)return Te;if(Fe!==null){if(s[Fe]!==void 0)return s[Fe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Fe+"'")}let Vt=Te;if(Te===s.RED&&(pt===s.FLOAT&&(Vt=s.R32F),pt===s.HALF_FLOAT&&(Vt=s.R16F),pt===s.UNSIGNED_BYTE&&(Vt=s.R8)),Te===s.RED_INTEGER&&(pt===s.UNSIGNED_BYTE&&(Vt=s.R8UI),pt===s.UNSIGNED_SHORT&&(Vt=s.R16UI),pt===s.UNSIGNED_INT&&(Vt=s.R32UI),pt===s.BYTE&&(Vt=s.R8I),pt===s.SHORT&&(Vt=s.R16I),pt===s.INT&&(Vt=s.R32I)),Te===s.RG&&(pt===s.FLOAT&&(Vt=s.RG32F),pt===s.HALF_FLOAT&&(Vt=s.RG16F),pt===s.UNSIGNED_BYTE&&(Vt=s.RG8)),Te===s.RGBA){const fn=zt?fv:Mr.getTransfer(Nt);pt===s.FLOAT&&(Vt=s.RGBA32F),pt===s.HALF_FLOAT&&(Vt=s.RGBA16F),pt===s.UNSIGNED_BYTE&&(Vt=fn===Dr?s.SRGB8_ALPHA8:s.RGBA8),pt===s.UNSIGNED_SHORT_4_4_4_4&&(Vt=s.RGBA4),pt===s.UNSIGNED_SHORT_5_5_5_1&&(Vt=s.RGB5_A1)}return(Vt===s.R16F||Vt===s.R32F||Vt===s.RG16F||Vt===s.RG32F||Vt===s.RGBA16F||Vt===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Vt}function T(Fe,Te,pt){return S(Fe,pt)===!0||Fe.isFramebufferTexture&&Fe.minFilter!==mo&&Fe.minFilter!==fo?Math.log2(Math.max(Te.width,Te.height))+1:Fe.mipmaps!==void 0&&Fe.mipmaps.length>0?Fe.mipmaps.length:Fe.isCompressedTexture&&Array.isArray(Fe.image)?Te.mipmaps.length:1}function L(Fe){return Fe===mo||Fe===aT||Fe===_p?s.NEAREST:s.LINEAR}function B(Fe){const Te=Fe.target;Te.removeEventListener("dispose",B),D(Te),Te.isVideoTexture&&f.delete(Te)}function F(Fe){const Te=Fe.target;Te.removeEventListener("dispose",F),U(Te)}function D(Fe){const Te=i.get(Fe);if(Te.__webglInit===void 0)return;const pt=Fe.source,Nt=A.get(pt);if(Nt){const zt=Nt[Te.__cacheKey];zt.usedTimes--,zt.usedTimes===0&&P(Fe),Object.keys(Nt).length===0&&A.delete(pt)}i.remove(Fe)}function P(Fe){const Te=i.get(Fe);s.deleteTexture(Te.__webglTexture);const pt=Fe.source,Nt=A.get(pt);delete Nt[Te.__cacheKey],c.memory.textures--}function U(Fe){const Te=Fe.texture,pt=i.get(Fe),Nt=i.get(Te);if(Nt.__webglTexture!==void 0&&(s.deleteTexture(Nt.__webglTexture),c.memory.textures--),Fe.depthTexture&&Fe.depthTexture.dispose(),Fe.isWebGLCubeRenderTarget)for(let zt=0;zt<6;zt++){if(Array.isArray(pt.__webglFramebuffer[zt]))for(let Vt=0;Vt<pt.__webglFramebuffer[zt].length;Vt++)s.deleteFramebuffer(pt.__webglFramebuffer[zt][Vt]);else s.deleteFramebuffer(pt.__webglFramebuffer[zt]);pt.__webglDepthbuffer&&s.deleteRenderbuffer(pt.__webglDepthbuffer[zt])}else{if(Array.isArray(pt.__webglFramebuffer))for(let zt=0;zt<pt.__webglFramebuffer.length;zt++)s.deleteFramebuffer(pt.__webglFramebuffer[zt]);else s.deleteFramebuffer(pt.__webglFramebuffer);if(pt.__webglDepthbuffer&&s.deleteRenderbuffer(pt.__webglDepthbuffer),pt.__webglMultisampledFramebuffer&&s.deleteFramebuffer(pt.__webglMultisampledFramebuffer),pt.__webglColorRenderbuffer)for(let zt=0;zt<pt.__webglColorRenderbuffer.length;zt++)pt.__webglColorRenderbuffer[zt]&&s.deleteRenderbuffer(pt.__webglColorRenderbuffer[zt]);pt.__webglDepthRenderbuffer&&s.deleteRenderbuffer(pt.__webglDepthRenderbuffer)}if(Fe.isWebGLMultipleRenderTargets)for(let zt=0,Vt=Te.length;zt<Vt;zt++){const fn=i.get(Te[zt]);fn.__webglTexture&&(s.deleteTexture(fn.__webglTexture),c.memory.textures--),i.remove(Te[zt])}i.remove(Te),i.remove(Fe)}let K=0;function J(){K=0}function z(){const Fe=K;return Fe>=o.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Fe+" texture units while this GPU supports only "+o.maxTextures),K+=1,Fe}function j(Fe){const Te=[];return Te.push(Fe.wrapS),Te.push(Fe.wrapT),Te.push(Fe.wrapR||0),Te.push(Fe.magFilter),Te.push(Fe.minFilter),Te.push(Fe.anisotropy),Te.push(Fe.internalFormat),Te.push(Fe.format),Te.push(Fe.type),Te.push(Fe.generateMipmaps),Te.push(Fe.premultiplyAlpha),Te.push(Fe.flipY),Te.push(Fe.unpackAlignment),Te.push(Fe.colorSpace),Te.join()}function G(Fe,Te){const pt=i.get(Fe);if(Fe.isVideoTexture&&Tn(Fe),Fe.isRenderTargetTexture===!1&&Fe.version>0&&pt.__version!==Fe.version){const Nt=Fe.image;if(Nt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Nt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ce(pt,Fe,Te);return}}n.bindTexture(s.TEXTURE_2D,pt.__webglTexture,s.TEXTURE0+Te)}function H(Fe,Te){const pt=i.get(Fe);if(Fe.version>0&&pt.__version!==Fe.version){Ce(pt,Fe,Te);return}n.bindTexture(s.TEXTURE_2D_ARRAY,pt.__webglTexture,s.TEXTURE0+Te)}function te(Fe,Te){const pt=i.get(Fe);if(Fe.version>0&&pt.__version!==Fe.version){Ce(pt,Fe,Te);return}n.bindTexture(s.TEXTURE_3D,pt.__webglTexture,s.TEXTURE0+Te)}function Z(Fe,Te){const pt=i.get(Fe);if(Fe.version>0&&pt.__version!==Fe.version){Je(pt,Fe,Te);return}n.bindTexture(s.TEXTURE_CUBE_MAP,pt.__webglTexture,s.TEXTURE0+Te)}const ee={[Nb]:s.REPEAT,[Pa]:s.CLAMP_TO_EDGE,[Ub]:s.MIRRORED_REPEAT},oe={[mo]:s.NEAREST,[aT]:s.NEAREST_MIPMAP_NEAREST,[_p]:s.NEAREST_MIPMAP_LINEAR,[fo]:s.LINEAR,[cE]:s.LINEAR_MIPMAP_NEAREST,[$h]:s.LINEAR_MIPMAP_LINEAR},xe={[q7]:s.NEVER,[tz]:s.ALWAYS,[Y7]:s.LESS,[dB]:s.LEQUAL,[$7]:s.EQUAL,[ez]:s.GEQUAL,[J7]:s.GREATER,[Z7]:s.NOTEQUAL};function Pe(Fe,Te,pt){if(Te.type===Wl&&e.has("OES_texture_float_linear")===!1&&(Te.magFilter===fo||Te.magFilter===cE||Te.magFilter===_p||Te.magFilter===$h||Te.minFilter===fo||Te.minFilter===cE||Te.minFilter===_p||Te.minFilter===$h)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),pt?(s.texParameteri(Fe,s.TEXTURE_WRAP_S,ee[Te.wrapS]),s.texParameteri(Fe,s.TEXTURE_WRAP_T,ee[Te.wrapT]),(Fe===s.TEXTURE_3D||Fe===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Fe,s.TEXTURE_WRAP_R,ee[Te.wrapR]),s.texParameteri(Fe,s.TEXTURE_MAG_FILTER,oe[Te.magFilter]),s.texParameteri(Fe,s.TEXTURE_MIN_FILTER,oe[Te.minFilter])):(s.texParameteri(Fe,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(Fe,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),(Fe===s.TEXTURE_3D||Fe===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Fe,s.TEXTURE_WRAP_R,s.CLAMP_TO_EDGE),(Te.wrapS!==Pa||Te.wrapT!==Pa)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),s.texParameteri(Fe,s.TEXTURE_MAG_FILTER,L(Te.magFilter)),s.texParameteri(Fe,s.TEXTURE_MIN_FILTER,L(Te.minFilter)),Te.minFilter!==mo&&Te.minFilter!==fo&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Te.compareFunction&&(s.texParameteri(Fe,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(Fe,s.TEXTURE_COMPARE_FUNC,xe[Te.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Nt=e.get("EXT_texture_filter_anisotropic");if(Te.magFilter===mo||Te.minFilter!==_p&&Te.minFilter!==$h||Te.type===Wl&&e.has("OES_texture_float_linear")===!1||u===!1&&Te.type===df&&e.has("OES_texture_half_float_linear")===!1)return;(Te.anisotropy>1||i.get(Te).__currentAnisotropy)&&(s.texParameterf(Fe,Nt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Te.anisotropy,o.getMaxAnisotropy())),i.get(Te).__currentAnisotropy=Te.anisotropy)}}function me(Fe,Te){let pt=!1;Fe.__webglInit===void 0&&(Fe.__webglInit=!0,Te.addEventListener("dispose",B));const Nt=Te.source;let zt=A.get(Nt);zt===void 0&&(zt={},A.set(Nt,zt));const Vt=j(Te);if(Vt!==Fe.__cacheKey){zt[Vt]===void 0&&(zt[Vt]={texture:s.createTexture(),usedTimes:0},c.memory.textures++,pt=!0),zt[Vt].usedTimes++;const fn=zt[Fe.__cacheKey];fn!==void 0&&(zt[Fe.__cacheKey].usedTimes--,fn.usedTimes===0&&P(Te)),Fe.__cacheKey=Vt,Fe.__webglTexture=zt[Vt].texture}return pt}function Ce(Fe,Te,pt){let Nt=s.TEXTURE_2D;(Te.isDataArrayTexture||Te.isCompressedArrayTexture)&&(Nt=s.TEXTURE_2D_ARRAY),Te.isData3DTexture&&(Nt=s.TEXTURE_3D);const zt=me(Fe,Te),Vt=Te.source;n.bindTexture(Nt,Fe.__webglTexture,s.TEXTURE0+pt);const fn=i.get(Vt);if(Vt.version!==fn.__version||zt===!0){n.activeTexture(s.TEXTURE0+pt);const mt=Mr.getPrimaries(Mr.workingColorSpace),Ee=Te.colorSpace===aa?null:Mr.getPrimaries(Te.colorSpace),_e=Te.colorSpace===aa||mt===Ee?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,Te.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Te.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,Te.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,_e);const Ne=E(Te)&&x(Te.image)===!1;let ye=b(Te.image,Ne,!1,o.maxTextureSize);ye=vn(Te,ye);const De=x(ye)||u,ke=a.convert(Te.format,Te.colorSpace);let Ye=a.convert(Te.type),Qe=C(Te.internalFormat,ke,Ye,Te.colorSpace,Te.isVideoTexture);Pe(Nt,Te,De);let ne;const W=Te.mipmaps,k=u&&Te.isVideoTexture!==!0&&Qe!==cB,he=fn.__version===void 0||zt===!0,Re=Vt.dataReady,We=T(Te,ye,De);if(Te.isDepthTexture)Qe=s.DEPTH_COMPONENT,u?Te.type===Wl?Qe=s.DEPTH_COMPONENT32F:Te.type===Hc?Qe=s.DEPTH_COMPONENT24:Te.type===eu?Qe=s.DEPTH24_STENCIL8:Qe=s.DEPTH_COMPONENT16:Te.type===Wl&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Te.format===tu&&Qe===s.DEPTH_COMPONENT&&Te.type!==z_&&Te.type!==Hc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Te.type=Hc,Ye=a.convert(Te.type)),Te.format===ff&&Qe===s.DEPTH_COMPONENT&&(Qe=s.DEPTH_STENCIL,Te.type!==eu&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Te.type=eu,Ye=a.convert(Te.type))),he&&(k?n.texStorage2D(s.TEXTURE_2D,1,Qe,ye.width,ye.height):n.texImage2D(s.TEXTURE_2D,0,Qe,ye.width,ye.height,0,ke,Ye,null));else if(Te.isDataTexture)if(W.length>0&&De){k&&he&&n.texStorage2D(s.TEXTURE_2D,We,Qe,W[0].width,W[0].height);for(let ve=0,at=W.length;ve<at;ve++)ne=W[ve],k?Re&&n.texSubImage2D(s.TEXTURE_2D,ve,0,0,ne.width,ne.height,ke,Ye,ne.data):n.texImage2D(s.TEXTURE_2D,ve,Qe,ne.width,ne.height,0,ke,Ye,ne.data);Te.generateMipmaps=!1}else k?(he&&n.texStorage2D(s.TEXTURE_2D,We,Qe,ye.width,ye.height),Re&&n.texSubImage2D(s.TEXTURE_2D,0,0,0,ye.width,ye.height,ke,Ye,ye.data)):n.texImage2D(s.TEXTURE_2D,0,Qe,ye.width,ye.height,0,ke,Ye,ye.data);else if(Te.isCompressedTexture)if(Te.isCompressedArrayTexture){k&&he&&n.texStorage3D(s.TEXTURE_2D_ARRAY,We,Qe,W[0].width,W[0].height,ye.depth);for(let ve=0,at=W.length;ve<at;ve++)ne=W[ve],Te.format!==Da?ke!==null?k?Re&&n.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,ve,0,0,0,ne.width,ne.height,ye.depth,ke,ne.data,0,0):n.compressedTexImage3D(s.TEXTURE_2D_ARRAY,ve,Qe,ne.width,ne.height,ye.depth,0,ne.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):k?Re&&n.texSubImage3D(s.TEXTURE_2D_ARRAY,ve,0,0,0,ne.width,ne.height,ye.depth,ke,Ye,ne.data):n.texImage3D(s.TEXTURE_2D_ARRAY,ve,Qe,ne.width,ne.height,ye.depth,0,ke,Ye,ne.data)}else{k&&he&&n.texStorage2D(s.TEXTURE_2D,We,Qe,W[0].width,W[0].height);for(let ve=0,at=W.length;ve<at;ve++)ne=W[ve],Te.format!==Da?ke!==null?k?Re&&n.compressedTexSubImage2D(s.TEXTURE_2D,ve,0,0,ne.width,ne.height,ke,ne.data):n.compressedTexImage2D(s.TEXTURE_2D,ve,Qe,ne.width,ne.height,0,ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):k?Re&&n.texSubImage2D(s.TEXTURE_2D,ve,0,0,ne.width,ne.height,ke,Ye,ne.data):n.texImage2D(s.TEXTURE_2D,ve,Qe,ne.width,ne.height,0,ke,Ye,ne.data)}else if(Te.isDataArrayTexture)k?(he&&n.texStorage3D(s.TEXTURE_2D_ARRAY,We,Qe,ye.width,ye.height,ye.depth),Re&&n.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,ye.width,ye.height,ye.depth,ke,Ye,ye.data)):n.texImage3D(s.TEXTURE_2D_ARRAY,0,Qe,ye.width,ye.height,ye.depth,0,ke,Ye,ye.data);else if(Te.isData3DTexture)k?(he&&n.texStorage3D(s.TEXTURE_3D,We,Qe,ye.width,ye.height,ye.depth),Re&&n.texSubImage3D(s.TEXTURE_3D,0,0,0,0,ye.width,ye.height,ye.depth,ke,Ye,ye.data)):n.texImage3D(s.TEXTURE_3D,0,Qe,ye.width,ye.height,ye.depth,0,ke,Ye,ye.data);else if(Te.isFramebufferTexture){if(he)if(k)n.texStorage2D(s.TEXTURE_2D,We,Qe,ye.width,ye.height);else{let ve=ye.width,at=ye.height;for(let At=0;At<We;At++)n.texImage2D(s.TEXTURE_2D,At,Qe,ve,at,0,ke,Ye,null),ve>>=1,at>>=1}}else if(W.length>0&&De){k&&he&&n.texStorage2D(s.TEXTURE_2D,We,Qe,W[0].width,W[0].height);for(let ve=0,at=W.length;ve<at;ve++)ne=W[ve],k?Re&&n.texSubImage2D(s.TEXTURE_2D,ve,0,0,ke,Ye,ne):n.texImage2D(s.TEXTURE_2D,ve,Qe,ke,Ye,ne);Te.generateMipmaps=!1}else k?(he&&n.texStorage2D(s.TEXTURE_2D,We,Qe,ye.width,ye.height),Re&&n.texSubImage2D(s.TEXTURE_2D,0,0,0,ke,Ye,ye)):n.texImage2D(s.TEXTURE_2D,0,Qe,ke,Ye,ye);S(Te,De)&&M(Nt),fn.__version=Vt.version,Te.onUpdate&&Te.onUpdate(Te)}Fe.__version=Te.version}function Je(Fe,Te,pt){if(Te.image.length!==6)return;const Nt=me(Fe,Te),zt=Te.source;n.bindTexture(s.TEXTURE_CUBE_MAP,Fe.__webglTexture,s.TEXTURE0+pt);const Vt=i.get(zt);if(zt.version!==Vt.__version||Nt===!0){n.activeTexture(s.TEXTURE0+pt);const fn=Mr.getPrimaries(Mr.workingColorSpace),mt=Te.colorSpace===aa?null:Mr.getPrimaries(Te.colorSpace),Ee=Te.colorSpace===aa||fn===mt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,Te.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Te.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,Te.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ee);const _e=Te.isCompressedTexture||Te.image[0].isCompressedTexture,Ne=Te.image[0]&&Te.image[0].isDataTexture,ye=[];for(let ve=0;ve<6;ve++)!_e&&!Ne?ye[ve]=b(Te.image[ve],!1,!0,o.maxCubemapSize):ye[ve]=Ne?Te.image[ve].image:Te.image[ve],ye[ve]=vn(Te,ye[ve]);const De=ye[0],ke=x(De)||u,Ye=a.convert(Te.format,Te.colorSpace),Qe=a.convert(Te.type),ne=C(Te.internalFormat,Ye,Qe,Te.colorSpace),W=u&&Te.isVideoTexture!==!0,k=Vt.__version===void 0||Nt===!0,he=zt.dataReady;let Re=T(Te,De,ke);Pe(s.TEXTURE_CUBE_MAP,Te,ke);let We;if(_e){W&&k&&n.texStorage2D(s.TEXTURE_CUBE_MAP,Re,ne,De.width,De.height);for(let ve=0;ve<6;ve++){We=ye[ve].mipmaps;for(let at=0;at<We.length;at++){const At=We[at];Te.format!==Da?Ye!==null?W?he&&n.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at,0,0,At.width,At.height,Ye,At.data):n.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at,ne,At.width,At.height,0,At.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):W?he&&n.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at,0,0,At.width,At.height,Ye,Qe,At.data):n.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at,ne,At.width,At.height,0,Ye,Qe,At.data)}}}else{We=Te.mipmaps,W&&k&&(We.length>0&&Re++,n.texStorage2D(s.TEXTURE_CUBE_MAP,Re,ne,ye[0].width,ye[0].height));for(let ve=0;ve<6;ve++)if(Ne){W?he&&n.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,0,0,ye[ve].width,ye[ve].height,Ye,Qe,ye[ve].data):n.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,ne,ye[ve].width,ye[ve].height,0,Ye,Qe,ye[ve].data);for(let at=0;at<We.length;at++){const Ct=We[at].image[ve].image;W?he&&n.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at+1,0,0,Ct.width,Ct.height,Ye,Qe,Ct.data):n.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at+1,ne,Ct.width,Ct.height,0,Ye,Qe,Ct.data)}}else{W?he&&n.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,0,0,Ye,Qe,ye[ve]):n.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,ne,Ye,Qe,ye[ve]);for(let at=0;at<We.length;at++){const At=We[at];W?he&&n.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at+1,0,0,Ye,Qe,At.image[ve]):n.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ve,at+1,ne,Ye,Qe,At.image[ve])}}}S(Te,ke)&&M(s.TEXTURE_CUBE_MAP),Vt.__version=zt.version,Te.onUpdate&&Te.onUpdate(Te)}Fe.__version=Te.version}function Oe(Fe,Te,pt,Nt,zt,Vt){const fn=a.convert(pt.format,pt.colorSpace),mt=a.convert(pt.type),Ee=C(pt.internalFormat,fn,mt,pt.colorSpace);if(!i.get(Te).__hasExternalTextures){const Ne=Math.max(1,Te.width>>Vt),ye=Math.max(1,Te.height>>Vt);zt===s.TEXTURE_3D||zt===s.TEXTURE_2D_ARRAY?n.texImage3D(zt,Vt,Ee,Ne,ye,Te.depth,0,fn,mt,null):n.texImage2D(zt,Vt,Ee,Ne,ye,0,fn,mt,null)}n.bindFramebuffer(s.FRAMEBUFFER,Fe),Xt(Te)?h.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Nt,zt,i.get(pt).__webglTexture,0,Qt(Te)):(zt===s.TEXTURE_2D||zt>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&zt<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,Nt,zt,i.get(pt).__webglTexture,Vt),n.bindFramebuffer(s.FRAMEBUFFER,null)}function $e(Fe,Te,pt){if(s.bindRenderbuffer(s.RENDERBUFFER,Fe),Te.depthBuffer&&!Te.stencilBuffer){let Nt=u===!0?s.DEPTH_COMPONENT24:s.DEPTH_COMPONENT16;if(pt||Xt(Te)){const zt=Te.depthTexture;zt&&zt.isDepthTexture&&(zt.type===Wl?Nt=s.DEPTH_COMPONENT32F:zt.type===Hc&&(Nt=s.DEPTH_COMPONENT24));const Vt=Qt(Te);Xt(Te)?h.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Vt,Nt,Te.width,Te.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,Vt,Nt,Te.width,Te.height)}else s.renderbufferStorage(s.RENDERBUFFER,Nt,Te.width,Te.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,Fe)}else if(Te.depthBuffer&&Te.stencilBuffer){const Nt=Qt(Te);pt&&Xt(Te)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,Nt,s.DEPTH24_STENCIL8,Te.width,Te.height):Xt(Te)?h.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Nt,s.DEPTH24_STENCIL8,Te.width,Te.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,Te.width,Te.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,Fe)}else{const Nt=Te.isWebGLMultipleRenderTargets===!0?Te.texture:[Te.texture];for(let zt=0;zt<Nt.length;zt++){const Vt=Nt[zt],fn=a.convert(Vt.format,Vt.colorSpace),mt=a.convert(Vt.type),Ee=C(Vt.internalFormat,fn,mt,Vt.colorSpace),_e=Qt(Te);pt&&Xt(Te)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,_e,Ee,Te.width,Te.height):Xt(Te)?h.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,_e,Ee,Te.width,Te.height):s.renderbufferStorage(s.RENDERBUFFER,Ee,Te.width,Te.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function nt(Fe,Te){if(Te&&Te.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(s.FRAMEBUFFER,Fe),!(Te.depthTexture&&Te.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(Te.depthTexture).__webglTexture||Te.depthTexture.image.width!==Te.width||Te.depthTexture.image.height!==Te.height)&&(Te.depthTexture.image.width=Te.width,Te.depthTexture.image.height=Te.height,Te.depthTexture.needsUpdate=!0),G(Te.depthTexture,0);const Nt=i.get(Te.depthTexture).__webglTexture,zt=Qt(Te);if(Te.depthTexture.format===tu)Xt(Te)?h.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Nt,0,zt):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Nt,0);else if(Te.depthTexture.format===ff)Xt(Te)?h.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Nt,0,zt):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Nt,0);else throw new Error("Unknown depthTexture format")}function gt(Fe){const Te=i.get(Fe),pt=Fe.isWebGLCubeRenderTarget===!0;if(Fe.depthTexture&&!Te.__autoAllocateDepthBuffer){if(pt)throw new Error("target.depthTexture not supported in Cube render targets");nt(Te.__webglFramebuffer,Fe)}else if(pt){Te.__webglDepthbuffer=[];for(let Nt=0;Nt<6;Nt++)n.bindFramebuffer(s.FRAMEBUFFER,Te.__webglFramebuffer[Nt]),Te.__webglDepthbuffer[Nt]=s.createRenderbuffer(),$e(Te.__webglDepthbuffer[Nt],Fe,!1)}else n.bindFramebuffer(s.FRAMEBUFFER,Te.__webglFramebuffer),Te.__webglDepthbuffer=s.createRenderbuffer(),$e(Te.__webglDepthbuffer,Fe,!1);n.bindFramebuffer(s.FRAMEBUFFER,null)}function Tt(Fe,Te,pt){const Nt=i.get(Fe);Te!==void 0&&Oe(Nt.__webglFramebuffer,Fe,Fe.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),pt!==void 0&&gt(Fe)}function Ze(Fe){const Te=Fe.texture,pt=i.get(Fe),Nt=i.get(Te);Fe.addEventListener("dispose",F),Fe.isWebGLMultipleRenderTargets!==!0&&(Nt.__webglTexture===void 0&&(Nt.__webglTexture=s.createTexture()),Nt.__version=Te.version,c.memory.textures++);const zt=Fe.isWebGLCubeRenderTarget===!0,Vt=Fe.isWebGLMultipleRenderTargets===!0,fn=x(Fe)||u;if(zt){pt.__webglFramebuffer=[];for(let mt=0;mt<6;mt++)if(u&&Te.mipmaps&&Te.mipmaps.length>0){pt.__webglFramebuffer[mt]=[];for(let Ee=0;Ee<Te.mipmaps.length;Ee++)pt.__webglFramebuffer[mt][Ee]=s.createFramebuffer()}else pt.__webglFramebuffer[mt]=s.createFramebuffer()}else{if(u&&Te.mipmaps&&Te.mipmaps.length>0){pt.__webglFramebuffer=[];for(let mt=0;mt<Te.mipmaps.length;mt++)pt.__webglFramebuffer[mt]=s.createFramebuffer()}else pt.__webglFramebuffer=s.createFramebuffer();if(Vt)if(o.drawBuffers){const mt=Fe.texture;for(let Ee=0,_e=mt.length;Ee<_e;Ee++){const Ne=i.get(mt[Ee]);Ne.__webglTexture===void 0&&(Ne.__webglTexture=s.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(u&&Fe.samples>0&&Xt(Fe)===!1){const mt=Vt?Te:[Te];pt.__webglMultisampledFramebuffer=s.createFramebuffer(),pt.__webglColorRenderbuffer=[],n.bindFramebuffer(s.FRAMEBUFFER,pt.__webglMultisampledFramebuffer);for(let Ee=0;Ee<mt.length;Ee++){const _e=mt[Ee];pt.__webglColorRenderbuffer[Ee]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,pt.__webglColorRenderbuffer[Ee]);const Ne=a.convert(_e.format,_e.colorSpace),ye=a.convert(_e.type),De=C(_e.internalFormat,Ne,ye,_e.colorSpace,Fe.isXRRenderTarget===!0),ke=Qt(Fe);s.renderbufferStorageMultisample(s.RENDERBUFFER,ke,De,Fe.width,Fe.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Ee,s.RENDERBUFFER,pt.__webglColorRenderbuffer[Ee])}s.bindRenderbuffer(s.RENDERBUFFER,null),Fe.depthBuffer&&(pt.__webglDepthRenderbuffer=s.createRenderbuffer(),$e(pt.__webglDepthRenderbuffer,Fe,!0)),n.bindFramebuffer(s.FRAMEBUFFER,null)}}if(zt){n.bindTexture(s.TEXTURE_CUBE_MAP,Nt.__webglTexture),Pe(s.TEXTURE_CUBE_MAP,Te,fn);for(let mt=0;mt<6;mt++)if(u&&Te.mipmaps&&Te.mipmaps.length>0)for(let Ee=0;Ee<Te.mipmaps.length;Ee++)Oe(pt.__webglFramebuffer[mt][Ee],Fe,Te,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+mt,Ee);else Oe(pt.__webglFramebuffer[mt],Fe,Te,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+mt,0);S(Te,fn)&&M(s.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Vt){const mt=Fe.texture;for(let Ee=0,_e=mt.length;Ee<_e;Ee++){const Ne=mt[Ee],ye=i.get(Ne);n.bindTexture(s.TEXTURE_2D,ye.__webglTexture),Pe(s.TEXTURE_2D,Ne,fn),Oe(pt.__webglFramebuffer,Fe,Ne,s.COLOR_ATTACHMENT0+Ee,s.TEXTURE_2D,0),S(Ne,fn)&&M(s.TEXTURE_2D)}n.unbindTexture()}else{let mt=s.TEXTURE_2D;if((Fe.isWebGL3DRenderTarget||Fe.isWebGLArrayRenderTarget)&&(u?mt=Fe.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(mt,Nt.__webglTexture),Pe(mt,Te,fn),u&&Te.mipmaps&&Te.mipmaps.length>0)for(let Ee=0;Ee<Te.mipmaps.length;Ee++)Oe(pt.__webglFramebuffer[Ee],Fe,Te,s.COLOR_ATTACHMENT0,mt,Ee);else Oe(pt.__webglFramebuffer,Fe,Te,s.COLOR_ATTACHMENT0,mt,0);S(Te,fn)&&M(mt),n.unbindTexture()}Fe.depthBuffer&&gt(Fe)}function mn(Fe){const Te=x(Fe)||u,pt=Fe.isWebGLMultipleRenderTargets===!0?Fe.texture:[Fe.texture];for(let Nt=0,zt=pt.length;Nt<zt;Nt++){const Vt=pt[Nt];if(S(Vt,Te)){const fn=Fe.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,mt=i.get(Vt).__webglTexture;n.bindTexture(fn,mt),M(fn),n.unbindTexture()}}}function Ft(Fe){if(u&&Fe.samples>0&&Xt(Fe)===!1){const Te=Fe.isWebGLMultipleRenderTargets?Fe.texture:[Fe.texture],pt=Fe.width,Nt=Fe.height;let zt=s.COLOR_BUFFER_BIT;const Vt=[],fn=Fe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,mt=i.get(Fe),Ee=Fe.isWebGLMultipleRenderTargets===!0;if(Ee)for(let _e=0;_e<Te.length;_e++)n.bindFramebuffer(s.FRAMEBUFFER,mt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+_e,s.RENDERBUFFER,null),n.bindFramebuffer(s.FRAMEBUFFER,mt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+_e,s.TEXTURE_2D,null,0);n.bindFramebuffer(s.READ_FRAMEBUFFER,mt.__webglMultisampledFramebuffer),n.bindFramebuffer(s.DRAW_FRAMEBUFFER,mt.__webglFramebuffer);for(let _e=0;_e<Te.length;_e++){Vt.push(s.COLOR_ATTACHMENT0+_e),Fe.depthBuffer&&Vt.push(fn);const Ne=mt.__ignoreDepthValues!==void 0?mt.__ignoreDepthValues:!1;if(Ne===!1&&(Fe.depthBuffer&&(zt|=s.DEPTH_BUFFER_BIT),Fe.stencilBuffer&&(zt|=s.STENCIL_BUFFER_BIT)),Ee&&s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,mt.__webglColorRenderbuffer[_e]),Ne===!0&&(s.invalidateFramebuffer(s.READ_FRAMEBUFFER,[fn]),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[fn])),Ee){const ye=i.get(Te[_e]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,ye,0)}s.blitFramebuffer(0,0,pt,Nt,0,0,pt,Nt,zt,s.NEAREST),d&&s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Vt)}if(n.bindFramebuffer(s.READ_FRAMEBUFFER,null),n.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),Ee)for(let _e=0;_e<Te.length;_e++){n.bindFramebuffer(s.FRAMEBUFFER,mt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+_e,s.RENDERBUFFER,mt.__webglColorRenderbuffer[_e]);const Ne=i.get(Te[_e]).__webglTexture;n.bindFramebuffer(s.FRAMEBUFFER,mt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+_e,s.TEXTURE_2D,Ne,0)}n.bindFramebuffer(s.DRAW_FRAMEBUFFER,mt.__webglMultisampledFramebuffer)}}function Qt(Fe){return Math.min(o.maxSamples,Fe.samples)}function Xt(Fe){const Te=i.get(Fe);return u&&Fe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Te.__useRenderToTexture!==!1}function Tn(Fe){const Te=c.render.frame;f.get(Fe)!==Te&&(f.set(Fe,Te),Fe.update())}function vn(Fe,Te){const pt=Fe.colorSpace,Nt=Fe.format,zt=Fe.type;return Fe.isCompressedTexture===!0||Fe.isVideoTexture===!0||Fe.format===zb||pt!==tc&&pt!==aa&&(Mr.getTransfer(pt)===Dr?u===!1?e.has("EXT_sRGB")===!0&&Nt===Da?(Fe.format=zb,Fe.minFilter=fo,Fe.generateMipmaps=!1):Te=pB.sRGBToLinear(Te):(Nt!==Da||zt!==Xc)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",pt)),Te}this.allocateTextureUnit=z,this.resetTextureUnits=J,this.setTexture2D=G,this.setTexture2DArray=H,this.setTexture3D=te,this.setTextureCube=Z,this.rebindTextures=Tt,this.setupRenderTarget=Ze,this.updateRenderTargetMipmap=mn,this.updateMultisampleRenderTarget=Ft,this.setupDepthRenderbuffer=gt,this.setupFrameBufferTexture=Oe,this.useMultisampledRTT=Xt}function pj(s,e,n){const i=n.isWebGL2;function o(a,c=aa){let u;const h=Mr.getTransfer(c);if(a===Xc)return s.UNSIGNED_BYTE;if(a===rB)return s.UNSIGNED_SHORT_4_4_4_4;if(a===sB)return s.UNSIGNED_SHORT_5_5_5_1;if(a===U7)return s.BYTE;if(a===k7)return s.SHORT;if(a===z_)return s.UNSIGNED_SHORT;if(a===iB)return s.INT;if(a===Hc)return s.UNSIGNED_INT;if(a===Wl)return s.FLOAT;if(a===df)return i?s.HALF_FLOAT:(u=e.get("OES_texture_half_float"),u!==null?u.HALF_FLOAT_OES:null);if(a===z7)return s.ALPHA;if(a===Da)return s.RGBA;if(a===G7)return s.LUMINANCE;if(a===V7)return s.LUMINANCE_ALPHA;if(a===tu)return s.DEPTH_COMPONENT;if(a===ff)return s.DEPTH_STENCIL;if(a===zb)return u=e.get("EXT_sRGB"),u!==null?u.SRGB_ALPHA_EXT:null;if(a===H7)return s.RED;if(a===oB)return s.RED_INTEGER;if(a===j7)return s.RG;if(a===aB)return s.RG_INTEGER;if(a===lB)return s.RGBA_INTEGER;if(a===hE||a===uE||a===dE||a===fE)if(h===Dr)if(u=e.get("WEBGL_compressed_texture_s3tc_srgb"),u!==null){if(a===hE)return u.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===uE)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===dE)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===fE)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(u=e.get("WEBGL_compressed_texture_s3tc"),u!==null){if(a===hE)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===uE)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===dE)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===fE)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===lT||a===cT||a===hT||a===uT)if(u=e.get("WEBGL_compressed_texture_pvrtc"),u!==null){if(a===lT)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===cT)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===hT)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===uT)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===cB)return u=e.get("WEBGL_compressed_texture_etc1"),u!==null?u.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===dT||a===fT)if(u=e.get("WEBGL_compressed_texture_etc"),u!==null){if(a===dT)return h===Dr?u.COMPRESSED_SRGB8_ETC2:u.COMPRESSED_RGB8_ETC2;if(a===fT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:u.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===pT||a===mT||a===gT||a===AT||a===vT||a===yT||a===xT||a===ET||a===bT||a===_T||a===wT||a===MT||a===CT||a===ST)if(u=e.get("WEBGL_compressed_texture_astc"),u!==null){if(a===pT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:u.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===mT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:u.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===gT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:u.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===AT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:u.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===vT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:u.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===yT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:u.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===xT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:u.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===ET)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:u.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===bT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:u.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===_T)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:u.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===wT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:u.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===MT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:u.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===CT)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:u.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===ST)return h===Dr?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:u.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===pE||a===TT||a===RT)if(u=e.get("EXT_texture_compression_bptc"),u!==null){if(a===pE)return h===Dr?u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:u.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(a===TT)return u.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(a===RT)return u.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(a===W7||a===IT||a===BT||a===LT)if(u=e.get("EXT_texture_compression_rgtc"),u!==null){if(a===pE)return u.COMPRESSED_RED_RGTC1_EXT;if(a===IT)return u.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===BT)return u.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===LT)return u.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===eu?i?s.UNSIGNED_INT_24_8:(u=e.get("WEBGL_depth_texture"),u!==null?u.UNSIGNED_INT_24_8_WEBGL:null):s[a]!==void 0?s[a]:null}return{convert:o}}class mj extends sa{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let ef=class extends Ls{constructor(){super(),this.isGroup=!0,this.type="Group"}};const gj={type:"move"};class NE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ef,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ef,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new it,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new it),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ef,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new it,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new it),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let o=null,a=null,c=null;const u=this._targetRay,h=this._grip,d=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(d&&e.hand){c=!0;for(const b of e.hand.values()){const x=n.getJointPose(b,i),E=this._getHandJoint(d,b);x!==null&&(E.matrix.fromArray(x.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,E.jointRadius=x.radius),E.visible=x!==null}const f=d.joints["index-finger-tip"],p=d.joints["thumb-tip"],A=f.position.distanceTo(p.position),g=.02,v=.005;d.inputState.pinching&&A>g+v?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&A<=g-v&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(a=n.getPose(e.gripSpace,i),a!==null&&(h.matrix.fromArray(a.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,a.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(a.linearVelocity)):h.hasLinearVelocity=!1,a.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(a.angularVelocity)):h.hasAngularVelocity=!1));u!==null&&(o=n.getPose(e.targetRaySpace,i),o===null&&a!==null&&(o=a),o!==null&&(u.matrix.fromArray(o.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,o.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(o.linearVelocity)):u.hasLinearVelocity=!1,o.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(o.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(gj)))}return u!==null&&(u.visible=o!==null),h!==null&&(h.visible=a!==null),d!==null&&(d.visible=c!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new ef;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}const Aj=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,vj=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class yj{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const o=new Js,a=e.properties.get(o);a.__webglTexture=n.texture,(n.depthNear!=i.depthNear||n.depthFar!=i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=o}}render(e,n){if(this.texture!==null){if(this.mesh===null){const i=n.cameras[0].viewport,o=new nl({extensions:{fragDepth:!0},vertexShader:Aj,fragmentShader:vj,uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new Qo(new Yv(20,20),o)}e.render(this.mesh,n)}}reset(){this.texture=null,this.mesh=null}}class xj extends Ga{constructor(e,n){super();const i=this;let o=null,a=1,c=null,u="local-floor",h=1,d=null,f=null,p=null,A=null,g=null,v=null;const b=new yj,x=n.getContextAttributes();let E=null,S=null;const M=[],C=[],T=new Mn;let L=null;const B=new sa;B.layers.enable(1),B.viewport=new Bs;const F=new sa;F.layers.enable(2),F.viewport=new Bs;const D=[B,F],P=new mj;P.layers.enable(1),P.layers.enable(2);let U=null,K=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(me){let Ce=M[me];return Ce===void 0&&(Ce=new NE,M[me]=Ce),Ce.getTargetRaySpace()},this.getControllerGrip=function(me){let Ce=M[me];return Ce===void 0&&(Ce=new NE,M[me]=Ce),Ce.getGripSpace()},this.getHand=function(me){let Ce=M[me];return Ce===void 0&&(Ce=new NE,M[me]=Ce),Ce.getHandSpace()};function J(me){const Ce=C.indexOf(me.inputSource);if(Ce===-1)return;const Je=M[Ce];Je!==void 0&&(Je.update(me.inputSource,me.frame,d||c),Je.dispatchEvent({type:me.type,data:me.inputSource}))}function z(){o.removeEventListener("select",J),o.removeEventListener("selectstart",J),o.removeEventListener("selectend",J),o.removeEventListener("squeeze",J),o.removeEventListener("squeezestart",J),o.removeEventListener("squeezeend",J),o.removeEventListener("end",z),o.removeEventListener("inputsourceschange",j);for(let me=0;me<M.length;me++){const Ce=C[me];Ce!==null&&(C[me]=null,M[me].disconnect(Ce))}U=null,K=null,b.reset(),e.setRenderTarget(E),g=null,A=null,p=null,o=null,S=null,Pe.stop(),i.isPresenting=!1,e.setPixelRatio(L),e.setSize(T.width,T.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(me){a=me,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(me){u=me,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||c},this.setReferenceSpace=function(me){d=me},this.getBaseLayer=function(){return A!==null?A:g},this.getBinding=function(){return p},this.getFrame=function(){return v},this.getSession=function(){return o},this.setSession=async function(me){if(o=me,o!==null){if(E=e.getRenderTarget(),o.addEventListener("select",J),o.addEventListener("selectstart",J),o.addEventListener("selectend",J),o.addEventListener("squeeze",J),o.addEventListener("squeezestart",J),o.addEventListener("squeezeend",J),o.addEventListener("end",z),o.addEventListener("inputsourceschange",j),x.xrCompatible!==!0&&await n.makeXRCompatible(),L=e.getPixelRatio(),e.getSize(T),o.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ce={antialias:o.renderState.layers===void 0?x.antialias:!0,alpha:!0,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:a};g=new XRWebGLLayer(o,n,Ce),o.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),S=new Yc(g.framebufferWidth,g.framebufferHeight,{format:Da,type:Xc,colorSpace:e.outputColorSpace,stencilBuffer:x.stencil})}else{let Ce=null,Je=null,Oe=null;x.depth&&(Oe=x.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Ce=x.stencil?ff:tu,Je=x.stencil?eu:Hc);const $e={colorFormat:n.RGBA8,depthFormat:Oe,scaleFactor:a};p=new XRWebGLBinding(o,n),A=p.createProjectionLayer($e),o.updateRenderState({layers:[A]}),e.setPixelRatio(1),e.setSize(A.textureWidth,A.textureHeight,!1),S=new Yc(A.textureWidth,A.textureHeight,{format:Da,type:Xc,depthTexture:new MB(A.textureWidth,A.textureHeight,Je,void 0,void 0,void 0,void 0,void 0,void 0,Ce),stencilBuffer:x.stencil,colorSpace:e.outputColorSpace,samples:x.antialias?4:0});const nt=e.properties.get(S);nt.__ignoreDepthValues=A.ignoreDepthValues}S.isXRRenderTarget=!0,this.setFoveation(h),d=null,c=await o.requestReferenceSpace(u),Pe.setContext(o),Pe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(o!==null)return o.environmentBlendMode};function j(me){for(let Ce=0;Ce<me.removed.length;Ce++){const Je=me.removed[Ce],Oe=C.indexOf(Je);Oe>=0&&(C[Oe]=null,M[Oe].disconnect(Je))}for(let Ce=0;Ce<me.added.length;Ce++){const Je=me.added[Ce];let Oe=C.indexOf(Je);if(Oe===-1){for(let nt=0;nt<M.length;nt++)if(nt>=C.length){C.push(Je),Oe=nt;break}else if(C[nt]===null){C[nt]=Je,Oe=nt;break}if(Oe===-1)break}const $e=M[Oe];$e&&$e.connect(Je)}}const G=new it,H=new it;function te(me,Ce,Je){G.setFromMatrixPosition(Ce.matrixWorld),H.setFromMatrixPosition(Je.matrixWorld);const Oe=G.distanceTo(H),$e=Ce.projectionMatrix.elements,nt=Je.projectionMatrix.elements,gt=$e[14]/($e[10]-1),Tt=$e[14]/($e[10]+1),Ze=($e[9]+1)/$e[5],mn=($e[9]-1)/$e[5],Ft=($e[8]-1)/$e[0],Qt=(nt[8]+1)/nt[0],Xt=gt*Ft,Tn=gt*Qt,vn=Oe/(-Ft+Qt),Fe=vn*-Ft;Ce.matrixWorld.decompose(me.position,me.quaternion,me.scale),me.translateX(Fe),me.translateZ(vn),me.matrixWorld.compose(me.position,me.quaternion,me.scale),me.matrixWorldInverse.copy(me.matrixWorld).invert();const Te=gt+vn,pt=Tt+vn,Nt=Xt-Fe,zt=Tn+(Oe-Fe),Vt=Ze*Tt/pt*Te,fn=mn*Tt/pt*Te;me.projectionMatrix.makePerspective(Nt,zt,Vt,fn,Te,pt),me.projectionMatrixInverse.copy(me.projectionMatrix).invert()}function Z(me,Ce){Ce===null?me.matrixWorld.copy(me.matrix):me.matrixWorld.multiplyMatrices(Ce.matrixWorld,me.matrix),me.matrixWorldInverse.copy(me.matrixWorld).invert()}this.updateCamera=function(me){if(o===null)return;b.texture!==null&&(me.near=b.depthNear,me.far=b.depthFar),P.near=F.near=B.near=me.near,P.far=F.far=B.far=me.far,(U!==P.near||K!==P.far)&&(o.updateRenderState({depthNear:P.near,depthFar:P.far}),U=P.near,K=P.far,B.near=U,B.far=K,F.near=U,F.far=K,B.updateProjectionMatrix(),F.updateProjectionMatrix(),me.updateProjectionMatrix());const Ce=me.parent,Je=P.cameras;Z(P,Ce);for(let Oe=0;Oe<Je.length;Oe++)Z(Je[Oe],Ce);Je.length===2?te(P,B,F):P.projectionMatrix.copy(B.projectionMatrix),ee(me,P,Ce)};function ee(me,Ce,Je){Je===null?me.matrix.copy(Ce.matrixWorld):(me.matrix.copy(Je.matrixWorld),me.matrix.invert(),me.matrix.multiply(Ce.matrixWorld)),me.matrix.decompose(me.position,me.quaternion,me.scale),me.updateMatrixWorld(!0),me.projectionMatrix.copy(Ce.projectionMatrix),me.projectionMatrixInverse.copy(Ce.projectionMatrixInverse),me.isPerspectiveCamera&&(me.fov=fm*2*Math.atan(1/me.projectionMatrix.elements[5]),me.zoom=1)}this.getCamera=function(){return P},this.getFoveation=function(){if(!(A===null&&g===null))return h},this.setFoveation=function(me){h=me,A!==null&&(A.fixedFoveation=me),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=me)},this.hasDepthSensing=function(){return b.texture!==null};let oe=null;function xe(me,Ce){if(f=Ce.getViewerPose(d||c),v=Ce,f!==null){const Je=f.views;g!==null&&(e.setRenderTargetFramebuffer(S,g.framebuffer),e.setRenderTarget(S));let Oe=!1;Je.length!==P.cameras.length&&(P.cameras.length=0,Oe=!0);for(let nt=0;nt<Je.length;nt++){const gt=Je[nt];let Tt=null;if(g!==null)Tt=g.getViewport(gt);else{const mn=p.getViewSubImage(A,gt);Tt=mn.viewport,nt===0&&(e.setRenderTargetTextures(S,mn.colorTexture,A.ignoreDepthValues?void 0:mn.depthStencilTexture),e.setRenderTarget(S))}let Ze=D[nt];Ze===void 0&&(Ze=new sa,Ze.layers.enable(nt),Ze.viewport=new Bs,D[nt]=Ze),Ze.matrix.fromArray(gt.transform.matrix),Ze.matrix.decompose(Ze.position,Ze.quaternion,Ze.scale),Ze.projectionMatrix.fromArray(gt.projectionMatrix),Ze.projectionMatrixInverse.copy(Ze.projectionMatrix).invert(),Ze.viewport.set(Tt.x,Tt.y,Tt.width,Tt.height),nt===0&&(P.matrix.copy(Ze.matrix),P.matrix.decompose(P.position,P.quaternion,P.scale)),Oe===!0&&P.cameras.push(Ze)}const $e=o.enabledFeatures;if($e&&$e.includes("depth-sensing")){const nt=p.getDepthInformation(Je[0]);nt&&nt.isValid&&nt.texture&&b.init(e,nt,o.renderState)}}for(let Je=0;Je<M.length;Je++){const Oe=C[Je],$e=M[Je];Oe!==null&&$e!==void 0&&$e.update(Oe,Ce,d||c)}b.render(e,P),oe&&oe(me,Ce),Ce.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Ce}),v=null}const Pe=new wB;Pe.setAnimationLoop(xe),this.setAnimationLoop=function(me){oe=me},this.dispose=function(){}}}function Ej(s,e){function n(x,E){x.matrixAutoUpdate===!0&&x.updateMatrix(),E.value.copy(x.matrix)}function i(x,E){E.color.getRGB(x.fogColor.value,xB(s)),E.isFog?(x.fogNear.value=E.near,x.fogFar.value=E.far):E.isFogExp2&&(x.fogDensity.value=E.density)}function o(x,E,S,M,C){E.isMeshBasicMaterial||E.isMeshLambertMaterial?a(x,E):E.isMeshToonMaterial?(a(x,E),p(x,E)):E.isMeshPhongMaterial?(a(x,E),f(x,E)):E.isMeshStandardMaterial?(a(x,E),A(x,E),E.isMeshPhysicalMaterial&&g(x,E,C)):E.isMeshMatcapMaterial?(a(x,E),v(x,E)):E.isMeshDepthMaterial?a(x,E):E.isMeshDistanceMaterial?(a(x,E),b(x,E)):E.isMeshNormalMaterial?a(x,E):E.isLineBasicMaterial?(c(x,E),E.isLineDashedMaterial&&u(x,E)):E.isPointsMaterial?h(x,E,S,M):E.isSpriteMaterial?d(x,E):E.isShadowMaterial?(x.color.value.copy(E.color),x.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function a(x,E){x.opacity.value=E.opacity,E.color&&x.diffuse.value.copy(E.color),E.emissive&&x.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(x.map.value=E.map,n(E.map,x.mapTransform)),E.alphaMap&&(x.alphaMap.value=E.alphaMap,n(E.alphaMap,x.alphaMapTransform)),E.bumpMap&&(x.bumpMap.value=E.bumpMap,n(E.bumpMap,x.bumpMapTransform),x.bumpScale.value=E.bumpScale,E.side===Ao&&(x.bumpScale.value*=-1)),E.normalMap&&(x.normalMap.value=E.normalMap,n(E.normalMap,x.normalMapTransform),x.normalScale.value.copy(E.normalScale),E.side===Ao&&x.normalScale.value.negate()),E.displacementMap&&(x.displacementMap.value=E.displacementMap,n(E.displacementMap,x.displacementMapTransform),x.displacementScale.value=E.displacementScale,x.displacementBias.value=E.displacementBias),E.emissiveMap&&(x.emissiveMap.value=E.emissiveMap,n(E.emissiveMap,x.emissiveMapTransform)),E.specularMap&&(x.specularMap.value=E.specularMap,n(E.specularMap,x.specularMapTransform)),E.alphaTest>0&&(x.alphaTest.value=E.alphaTest);const S=e.get(E).envMap;if(S&&(x.envMap.value=S,x.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=E.reflectivity,x.ior.value=E.ior,x.refractionRatio.value=E.refractionRatio),E.lightMap){x.lightMap.value=E.lightMap;const M=s._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=E.lightMapIntensity*M,n(E.lightMap,x.lightMapTransform)}E.aoMap&&(x.aoMap.value=E.aoMap,x.aoMapIntensity.value=E.aoMapIntensity,n(E.aoMap,x.aoMapTransform))}function c(x,E){x.diffuse.value.copy(E.color),x.opacity.value=E.opacity,E.map&&(x.map.value=E.map,n(E.map,x.mapTransform))}function u(x,E){x.dashSize.value=E.dashSize,x.totalSize.value=E.dashSize+E.gapSize,x.scale.value=E.scale}function h(x,E,S,M){x.diffuse.value.copy(E.color),x.opacity.value=E.opacity,x.size.value=E.size*S,x.scale.value=M*.5,E.map&&(x.map.value=E.map,n(E.map,x.uvTransform)),E.alphaMap&&(x.alphaMap.value=E.alphaMap,n(E.alphaMap,x.alphaMapTransform)),E.alphaTest>0&&(x.alphaTest.value=E.alphaTest)}function d(x,E){x.diffuse.value.copy(E.color),x.opacity.value=E.opacity,x.rotation.value=E.rotation,E.map&&(x.map.value=E.map,n(E.map,x.mapTransform)),E.alphaMap&&(x.alphaMap.value=E.alphaMap,n(E.alphaMap,x.alphaMapTransform)),E.alphaTest>0&&(x.alphaTest.value=E.alphaTest)}function f(x,E){x.specular.value.copy(E.specular),x.shininess.value=Math.max(E.shininess,1e-4)}function p(x,E){E.gradientMap&&(x.gradientMap.value=E.gradientMap)}function A(x,E){x.metalness.value=E.metalness,E.metalnessMap&&(x.metalnessMap.value=E.metalnessMap,n(E.metalnessMap,x.metalnessMapTransform)),x.roughness.value=E.roughness,E.roughnessMap&&(x.roughnessMap.value=E.roughnessMap,n(E.roughnessMap,x.roughnessMapTransform)),e.get(E).envMap&&(x.envMapIntensity.value=E.envMapIntensity)}function g(x,E,S){x.ior.value=E.ior,E.sheen>0&&(x.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),x.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(x.sheenColorMap.value=E.sheenColorMap,n(E.sheenColorMap,x.sheenColorMapTransform)),E.sheenRoughnessMap&&(x.sheenRoughnessMap.value=E.sheenRoughnessMap,n(E.sheenRoughnessMap,x.sheenRoughnessMapTransform))),E.clearcoat>0&&(x.clearcoat.value=E.clearcoat,x.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(x.clearcoatMap.value=E.clearcoatMap,n(E.clearcoatMap,x.clearcoatMapTransform)),E.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap,n(E.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),E.clearcoatNormalMap&&(x.clearcoatNormalMap.value=E.clearcoatNormalMap,n(E.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),E.side===Ao&&x.clearcoatNormalScale.value.negate())),E.iridescence>0&&(x.iridescence.value=E.iridescence,x.iridescenceIOR.value=E.iridescenceIOR,x.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(x.iridescenceMap.value=E.iridescenceMap,n(E.iridescenceMap,x.iridescenceMapTransform)),E.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=E.iridescenceThicknessMap,n(E.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),E.transmission>0&&(x.transmission.value=E.transmission,x.transmissionSamplerMap.value=S.texture,x.transmissionSamplerSize.value.set(S.width,S.height),E.transmissionMap&&(x.transmissionMap.value=E.transmissionMap,n(E.transmissionMap,x.transmissionMapTransform)),x.thickness.value=E.thickness,E.thicknessMap&&(x.thicknessMap.value=E.thicknessMap,n(E.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=E.attenuationDistance,x.attenuationColor.value.copy(E.attenuationColor)),E.anisotropy>0&&(x.anisotropyVector.value.set(E.anisotropy*Math.cos(E.anisotropyRotation),E.anisotropy*Math.sin(E.anisotropyRotation)),E.anisotropyMap&&(x.anisotropyMap.value=E.anisotropyMap,n(E.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=E.specularIntensity,x.specularColor.value.copy(E.specularColor),E.specularColorMap&&(x.specularColorMap.value=E.specularColorMap,n(E.specularColorMap,x.specularColorMapTransform)),E.specularIntensityMap&&(x.specularIntensityMap.value=E.specularIntensityMap,n(E.specularIntensityMap,x.specularIntensityMapTransform))}function v(x,E){E.matcap&&(x.matcap.value=E.matcap)}function b(x,E){const S=e.get(E).light;x.referencePosition.value.setFromMatrixPosition(S.matrixWorld),x.nearDistance.value=S.shadow.camera.near,x.farDistance.value=S.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:o}}function bj(s,e,n,i){let o={},a={},c=[];const u=n.isWebGL2?s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS):0;function h(S,M){const C=M.program;i.uniformBlockBinding(S,C)}function d(S,M){let C=o[S.id];C===void 0&&(v(S),C=f(S),o[S.id]=C,S.addEventListener("dispose",x));const T=M.program;i.updateUBOMapping(S,T);const L=e.render.frame;a[S.id]!==L&&(A(S),a[S.id]=L)}function f(S){const M=p();S.__bindingPointIndex=M;const C=s.createBuffer(),T=S.__size,L=S.usage;return s.bindBuffer(s.UNIFORM_BUFFER,C),s.bufferData(s.UNIFORM_BUFFER,T,L),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,M,C),C}function p(){for(let S=0;S<u;S++)if(c.indexOf(S)===-1)return c.push(S),S;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function A(S){const M=o[S.id],C=S.uniforms,T=S.__cache;s.bindBuffer(s.UNIFORM_BUFFER,M);for(let L=0,B=C.length;L<B;L++){const F=Array.isArray(C[L])?C[L]:[C[L]];for(let D=0,P=F.length;D<P;D++){const U=F[D];if(g(U,L,D,T)===!0){const K=U.__offset,J=Array.isArray(U.value)?U.value:[U.value];let z=0;for(let j=0;j<J.length;j++){const G=J[j],H=b(G);typeof G=="number"||typeof G=="boolean"?(U.__data[0]=G,s.bufferSubData(s.UNIFORM_BUFFER,K+z,U.__data)):G.isMatrix3?(U.__data[0]=G.elements[0],U.__data[1]=G.elements[1],U.__data[2]=G.elements[2],U.__data[3]=0,U.__data[4]=G.elements[3],U.__data[5]=G.elements[4],U.__data[6]=G.elements[5],U.__data[7]=0,U.__data[8]=G.elements[6],U.__data[9]=G.elements[7],U.__data[10]=G.elements[8],U.__data[11]=0):(G.toArray(U.__data,z),z+=H.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,K,U.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function g(S,M,C,T){const L=S.value,B=M+"_"+C;if(T[B]===void 0)return typeof L=="number"||typeof L=="boolean"?T[B]=L:T[B]=L.clone(),!0;{const F=T[B];if(typeof L=="number"||typeof L=="boolean"){if(F!==L)return T[B]=L,!0}else if(F.equals(L)===!1)return F.copy(L),!0}return!1}function v(S){const M=S.uniforms;let C=0;const T=16;for(let B=0,F=M.length;B<F;B++){const D=Array.isArray(M[B])?M[B]:[M[B]];for(let P=0,U=D.length;P<U;P++){const K=D[P],J=Array.isArray(K.value)?K.value:[K.value];for(let z=0,j=J.length;z<j;z++){const G=J[z],H=b(G),te=C%T;te!==0&&T-te<H.boundary&&(C+=T-te),K.__data=new Float32Array(H.storage/Float32Array.BYTES_PER_ELEMENT),K.__offset=C,C+=H.storage}}}const L=C%T;return L>0&&(C+=T-L),S.__size=C,S.__cache={},this}function b(S){const M={boundary:0,storage:0};return typeof S=="number"||typeof S=="boolean"?(M.boundary=4,M.storage=4):S.isVector2?(M.boundary=8,M.storage=8):S.isVector3||S.isColor?(M.boundary=16,M.storage=12):S.isVector4?(M.boundary=16,M.storage=16):S.isMatrix3?(M.boundary=48,M.storage=48):S.isMatrix4?(M.boundary=64,M.storage=64):S.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",S),M}function x(S){const M=S.target;M.removeEventListener("dispose",x);const C=c.indexOf(M.__bindingPointIndex);c.splice(C,1),s.deleteBuffer(o[M.id]),delete o[M.id],delete a[M.id]}function E(){for(const S in o)s.deleteBuffer(o[S]);c=[],o={},a={}}return{bind:h,update:d,dispose:E}}class BB{constructor(e={}){const{canvas:n=gz(),context:i=null,depth:o=!0,stencil:a=!0,alpha:c=!1,antialias:u=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:d=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let A;i!==null?A=i.getContextAttributes().alpha:A=c;const g=new Uint32Array(4),v=new Int32Array(4);let b=null,x=null;const E=[],S=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ms,this._useLegacyLights=!1,this.toneMapping=Qc,this.toneMappingExposure=1;const M=this;let C=!1,T=0,L=0,B=null,F=-1,D=null;const P=new Bs,U=new Bs;let K=null;const J=new or(0);let z=0,j=n.width,G=n.height,H=1,te=null,Z=null;const ee=new Bs(0,0,j,G),oe=new Bs(0,0,j,G);let xe=!1;const Pe=new j_;let me=!1,Ce=!1,Je=null;const Oe=new Gr,$e=new Mn,nt=new it,gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Tt(){return B===null?H:1}let Ze=i;function mn(Le,ht){for(let yt=0;yt<Le.length;yt++){const de=Le[yt],be=n.getContext(de,ht);if(be!==null)return be}return null}try{const Le={alpha:!0,depth:o,stencil:a,antialias:u,premultipliedAlpha:h,preserveDrawingBuffer:d,powerPreference:f,failIfMajorPerformanceCaveat:p};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${Hv}`),n.addEventListener("webglcontextlost",We,!1),n.addEventListener("webglcontextrestored",ve,!1),n.addEventListener("webglcontextcreationerror",at,!1),Ze===null){const ht=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&ht.shift(),Ze=mn(ht,Le),Ze===null)throw mn(ht)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ze instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Ze.getShaderPrecisionFormat===void 0&&(Ze.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Le){throw console.error("THREE.WebGLRenderer: "+Le.message),Le}let Ft,Qt,Xt,Tn,vn,Fe,Te,pt,Nt,zt,Vt,fn,mt,Ee,_e,Ne,ye,De,ke,Ye,Qe,ne,W,k;function he(){Ft=new RV(Ze),Qt=new _V(Ze,Ft,e),Ft.init(Qt),ne=new pj(Ze,Ft,Qt),Xt=new dj(Ze,Ft,Qt),Tn=new LV(Ze),vn=new JH,Fe=new fj(Ze,Ft,Xt,vn,Qt,ne,Tn),Te=new MV(M),pt=new TV(M),Nt=new zz(Ze,Qt),W=new EV(Ze,Ft,Nt,Qt),zt=new IV(Ze,Nt,Tn,W),Vt=new FV(Ze,zt,Nt,Tn),ke=new OV(Ze,Qt,Fe),Ne=new wV(vn),fn=new $H(M,Te,pt,Ft,Qt,W,Ne),mt=new Ej(M,vn),Ee=new ej,_e=new oj(Ft,Qt),De=new xV(M,Te,pt,Xt,Vt,A,h),ye=new uj(M,Vt,Qt),k=new bj(Ze,Tn,Qt,Xt),Ye=new bV(Ze,Ft,Tn,Qt),Qe=new BV(Ze,Ft,Tn,Qt),Tn.programs=fn.programs,M.capabilities=Qt,M.extensions=Ft,M.properties=vn,M.renderLists=Ee,M.shadowMap=ye,M.state=Xt,M.info=Tn}he();const Re=new xj(M,Ze);this.xr=Re,this.getContext=function(){return Ze},this.getContextAttributes=function(){return Ze.getContextAttributes()},this.forceContextLoss=function(){const Le=Ft.get("WEBGL_lose_context");Le&&Le.loseContext()},this.forceContextRestore=function(){const Le=Ft.get("WEBGL_lose_context");Le&&Le.restoreContext()},this.getPixelRatio=function(){return H},this.setPixelRatio=function(Le){Le!==void 0&&(H=Le,this.setSize(j,G,!1))},this.getSize=function(Le){return Le.set(j,G)},this.setSize=function(Le,ht,yt=!0){if(Re.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}j=Le,G=ht,n.width=Math.floor(Le*H),n.height=Math.floor(ht*H),yt===!0&&(n.style.width=Le+"px",n.style.height=ht+"px"),this.setViewport(0,0,Le,ht)},this.getDrawingBufferSize=function(Le){return Le.set(j*H,G*H).floor()},this.setDrawingBufferSize=function(Le,ht,yt){j=Le,G=ht,H=yt,n.width=Math.floor(Le*yt),n.height=Math.floor(ht*yt),this.setViewport(0,0,Le,ht)},this.getCurrentViewport=function(Le){return Le.copy(P)},this.getViewport=function(Le){return Le.copy(ee)},this.setViewport=function(Le,ht,yt,de){Le.isVector4?ee.set(Le.x,Le.y,Le.z,Le.w):ee.set(Le,ht,yt,de),Xt.viewport(P.copy(ee).multiplyScalar(H).floor())},this.getScissor=function(Le){return Le.copy(oe)},this.setScissor=function(Le,ht,yt,de){Le.isVector4?oe.set(Le.x,Le.y,Le.z,Le.w):oe.set(Le,ht,yt,de),Xt.scissor(U.copy(oe).multiplyScalar(H).floor())},this.getScissorTest=function(){return xe},this.setScissorTest=function(Le){Xt.setScissorTest(xe=Le)},this.setOpaqueSort=function(Le){te=Le},this.setTransparentSort=function(Le){Z=Le},this.getClearColor=function(Le){return Le.copy(De.getClearColor())},this.setClearColor=function(){De.setClearColor.apply(De,arguments)},this.getClearAlpha=function(){return De.getClearAlpha()},this.setClearAlpha=function(){De.setClearAlpha.apply(De,arguments)},this.clear=function(Le=!0,ht=!0,yt=!0){let de=0;if(Le){let be=!1;if(B!==null){const Ve=B.texture.format;be=Ve===lB||Ve===aB||Ve===oB}if(be){const Ve=B.texture.type,dt=Ve===Xc||Ve===Hc||Ve===z_||Ve===eu||Ve===rB||Ve===sB,ut=De.getClearColor(),_t=De.getClearAlpha(),It=ut.r,Zt=ut.g,Wt=ut.b;dt?(g[0]=It,g[1]=Zt,g[2]=Wt,g[3]=_t,Ze.clearBufferuiv(Ze.COLOR,0,g)):(v[0]=It,v[1]=Zt,v[2]=Wt,v[3]=_t,Ze.clearBufferiv(Ze.COLOR,0,v))}else de|=Ze.COLOR_BUFFER_BIT}ht&&(de|=Ze.DEPTH_BUFFER_BIT),yt&&(de|=Ze.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ze.clear(de)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",We,!1),n.removeEventListener("webglcontextrestored",ve,!1),n.removeEventListener("webglcontextcreationerror",at,!1),Ee.dispose(),_e.dispose(),vn.dispose(),Te.dispose(),pt.dispose(),Vt.dispose(),W.dispose(),k.dispose(),fn.dispose(),Re.dispose(),Re.removeEventListener("sessionstart",Ri),Re.removeEventListener("sessionend",Fn),Je&&(Je.dispose(),Je=null),sn.stop()};function We(Le){Le.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const Le=Tn.autoReset,ht=ye.enabled,yt=ye.autoUpdate,de=ye.needsUpdate,be=ye.type;he(),Tn.autoReset=Le,ye.enabled=ht,ye.autoUpdate=yt,ye.needsUpdate=de,ye.type=be}function at(Le){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Le.statusMessage)}function At(Le){const ht=Le.target;ht.removeEventListener("dispose",At),Ct(ht)}function Ct(Le){Pt(Le),vn.remove(Le)}function Pt(Le){const ht=vn.get(Le).programs;ht!==void 0&&(ht.forEach(function(yt){fn.releaseProgram(yt)}),Le.isShaderMaterial&&fn.releaseShaderCache(Le))}this.renderBufferDirect=function(Le,ht,yt,de,be,Ve){ht===null&&(ht=gt);const dt=be.isMesh&&be.matrixWorld.determinant()<0,ut=Vi(Le,ht,yt,de,be);Xt.setMaterial(de,dt);let _t=yt.index,It=1;if(de.wireframe===!0){if(_t=zt.getWireframeAttribute(yt),_t===void 0)return;It=2}const Zt=yt.drawRange,Wt=yt.attributes.position;let Lt=Zt.start*It,Pn=(Zt.start+Zt.count)*It;Ve!==null&&(Lt=Math.max(Lt,Ve.start*It),Pn=Math.min(Pn,(Ve.start+Ve.count)*It)),_t!==null?(Lt=Math.max(Lt,0),Pn=Math.min(Pn,_t.count)):Wt!=null&&(Lt=Math.max(Lt,0),Pn=Math.min(Pn,Wt.count));const Dn=Pn-Lt;if(Dn<0||Dn===1/0)return;W.setup(be,de,ut,yt,_t);let jn,di=Ye;if(_t!==null&&(jn=Nt.get(_t),di=Qe,di.setIndex(jn)),be.isMesh)de.wireframe===!0?(Xt.setLineWidth(de.wireframeLinewidth*Tt()),di.setMode(Ze.LINES)):di.setMode(Ze.TRIANGLES);else if(be.isLine){let Cn=de.linewidth;Cn===void 0&&(Cn=1),Xt.setLineWidth(Cn*Tt()),be.isLineSegments?di.setMode(Ze.LINES):be.isLineLoop?di.setMode(Ze.LINE_LOOP):di.setMode(Ze.LINE_STRIP)}else be.isPoints?di.setMode(Ze.POINTS):be.isSprite&&di.setMode(Ze.TRIANGLES);if(be.isBatchedMesh)di.renderMultiDraw(be._multiDrawStarts,be._multiDrawCounts,be._multiDrawCount);else if(be.isInstancedMesh)di.renderInstances(Lt,Dn,be.count);else if(yt.isInstancedBufferGeometry){const Cn=yt._maxInstanceCount!==void 0?yt._maxInstanceCount:1/0,vi=Math.min(yt.instanceCount,Cn);di.renderInstances(Lt,Dn,vi)}else di.render(Lt,Dn)};function $t(Le,ht,yt){Le.transparent===!0&&Le.side===jl&&Le.forceSinglePass===!1?(Le.side=Ao,Le.needsUpdate=!0,$n(Le,ht,yt),Le.side=qc,Le.needsUpdate=!0,$n(Le,ht,yt),Le.side=jl):$n(Le,ht,yt)}this.compile=function(Le,ht,yt=null){yt===null&&(yt=Le),x=_e.get(yt),x.init(),S.push(x),yt.traverseVisible(function(be){be.isLight&&be.layers.test(ht.layers)&&(x.pushLight(be),be.castShadow&&x.pushShadow(be))}),Le!==yt&&Le.traverseVisible(function(be){be.isLight&&be.layers.test(ht.layers)&&(x.pushLight(be),be.castShadow&&x.pushShadow(be))}),x.setupLights(M._useLegacyLights);const de=new Set;return Le.traverse(function(be){const Ve=be.material;if(Ve)if(Array.isArray(Ve))for(let dt=0;dt<Ve.length;dt++){const ut=Ve[dt];$t(ut,yt,be),de.add(ut)}else $t(Ve,yt,be),de.add(Ve)}),S.pop(),x=null,de},this.compileAsync=function(Le,ht,yt=null){const de=this.compile(Le,ht,yt);return new Promise(be=>{function Ve(){if(de.forEach(function(dt){vn.get(dt).currentProgram.isReady()&&de.delete(dt)}),de.size===0){be(Le);return}setTimeout(Ve,10)}Ft.get("KHR_parallel_shader_compile")!==null?Ve():setTimeout(Ve,10)})};let Bn=null;function pi(Le){Bn&&Bn(Le)}function Ri(){sn.stop()}function Fn(){sn.start()}const sn=new wB;sn.setAnimationLoop(pi),typeof self<"u"&&sn.setContext(self),this.setAnimationLoop=function(Le){Bn=Le,Re.setAnimationLoop(Le),Le===null?sn.stop():sn.start()},Re.addEventListener("sessionstart",Ri),Re.addEventListener("sessionend",Fn),this.render=function(Le,ht){if(ht!==void 0&&ht.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(C===!0)return;Le.matrixWorldAutoUpdate===!0&&Le.updateMatrixWorld(),ht.parent===null&&ht.matrixWorldAutoUpdate===!0&&ht.updateMatrixWorld(),Re.enabled===!0&&Re.isPresenting===!0&&(Re.cameraAutoUpdate===!0&&Re.updateCamera(ht),ht=Re.getCamera()),Le.isScene===!0&&Le.onBeforeRender(M,Le,ht,B),x=_e.get(Le,S.length),x.init(),S.push(x),Oe.multiplyMatrices(ht.projectionMatrix,ht.matrixWorldInverse),Pe.setFromProjectionMatrix(Oe),Ce=this.localClippingEnabled,me=Ne.init(this.clippingPlanes,Ce),b=Ee.get(Le,E.length),b.init(),E.push(b),Rt(Le,ht,0,M.sortObjects),b.finish(),M.sortObjects===!0&&b.sort(te,Z),this.info.render.frame++,me===!0&&Ne.beginShadows();const yt=x.state.shadowsArray;if(ye.render(yt,Le,ht),me===!0&&Ne.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Re.enabled===!1||Re.isPresenting===!1||Re.hasDepthSensing()===!1)&&De.render(b,Le),x.setupLights(M._useLegacyLights),ht.isArrayCamera){const de=ht.cameras;for(let be=0,Ve=de.length;be<Ve;be++){const dt=de[be];gn(b,Le,dt,dt.viewport)}}else gn(b,Le,ht);B!==null&&(Fe.updateMultisampleRenderTarget(B),Fe.updateRenderTargetMipmap(B)),Le.isScene===!0&&Le.onAfterRender(M,Le,ht),W.resetDefaultState(),F=-1,D=null,S.pop(),S.length>0?x=S[S.length-1]:x=null,E.pop(),E.length>0?b=E[E.length-1]:b=null};function Rt(Le,ht,yt,de){if(Le.visible===!1)return;if(Le.layers.test(ht.layers)){if(Le.isGroup)yt=Le.renderOrder;else if(Le.isLOD)Le.autoUpdate===!0&&Le.update(ht);else if(Le.isLight)x.pushLight(Le),Le.castShadow&&x.pushShadow(Le);else if(Le.isSprite){if(!Le.frustumCulled||Pe.intersectsSprite(Le)){de&&nt.setFromMatrixPosition(Le.matrixWorld).applyMatrix4(Oe);const dt=Vt.update(Le),ut=Le.material;ut.visible&&b.push(Le,dt,ut,yt,nt.z,null)}}else if((Le.isMesh||Le.isLine||Le.isPoints)&&(!Le.frustumCulled||Pe.intersectsObject(Le))){const dt=Vt.update(Le),ut=Le.material;if(de&&(Le.boundingSphere!==void 0?(Le.boundingSphere===null&&Le.computeBoundingSphere(),nt.copy(Le.boundingSphere.center)):(dt.boundingSphere===null&&dt.computeBoundingSphere(),nt.copy(dt.boundingSphere.center)),nt.applyMatrix4(Le.matrixWorld).applyMatrix4(Oe)),Array.isArray(ut)){const _t=dt.groups;for(let It=0,Zt=_t.length;It<Zt;It++){const Wt=_t[It],Lt=ut[Wt.materialIndex];Lt&&Lt.visible&&b.push(Le,dt,Lt,yt,nt.z,Wt)}}else ut.visible&&b.push(Le,dt,ut,yt,nt.z,null)}}const Ve=Le.children;for(let dt=0,ut=Ve.length;dt<ut;dt++)Rt(Ve[dt],ht,yt,de)}function gn(Le,ht,yt,de){const be=Le.opaque,Ve=Le.transmissive,dt=Le.transparent;x.setupLightsView(yt),me===!0&&Ne.setGlobalState(M.clippingPlanes,yt),Ve.length>0&&si(be,Ve,ht,yt),de&&Xt.viewport(P.copy(de)),be.length>0&&Ln(be,ht,yt),Ve.length>0&&Ln(Ve,ht,yt),dt.length>0&&Ln(dt,ht,yt),Xt.buffers.depth.setTest(!0),Xt.buffers.depth.setMask(!0),Xt.buffers.color.setMask(!0),Xt.setPolygonOffset(!1)}function si(Le,ht,yt,de){if((yt.isScene===!0?yt.overrideMaterial:null)!==null)return;const Ve=Qt.isWebGL2;Je===null&&(Je=new Yc(1,1,{generateMipmaps:!0,type:Ft.has("EXT_color_buffer_half_float")?df:Xc,minFilter:$h,samples:Ve?4:0})),M.getDrawingBufferSize($e),Ve?Je.setSize($e.x,$e.y):Je.setSize(Av($e.x),Av($e.y));const dt=M.getRenderTarget();M.setRenderTarget(Je),M.getClearColor(J),z=M.getClearAlpha(),z<1&&M.setClearColor(16777215,.5),M.clear();const ut=M.toneMapping;M.toneMapping=Qc,Ln(Le,yt,de),Fe.updateMultisampleRenderTarget(Je),Fe.updateRenderTargetMipmap(Je);let _t=!1;for(let It=0,Zt=ht.length;It<Zt;It++){const Wt=ht[It],Lt=Wt.object,Pn=Wt.geometry,Dn=Wt.material,jn=Wt.group;if(Dn.side===jl&&Lt.layers.test(de.layers)){const di=Dn.side;Dn.side=Ao,Dn.needsUpdate=!0,Jn(Lt,yt,de,Pn,Dn,jn),Dn.side=di,Dn.needsUpdate=!0,_t=!0}}_t===!0&&(Fe.updateMultisampleRenderTarget(Je),Fe.updateRenderTargetMipmap(Je)),M.setRenderTarget(dt),M.setClearColor(J,z),M.toneMapping=ut}function Ln(Le,ht,yt){const de=ht.isScene===!0?ht.overrideMaterial:null;for(let be=0,Ve=Le.length;be<Ve;be++){const dt=Le[be],ut=dt.object,_t=dt.geometry,It=de===null?dt.material:de,Zt=dt.group;ut.layers.test(yt.layers)&&Jn(ut,ht,yt,_t,It,Zt)}}function Jn(Le,ht,yt,de,be,Ve){Le.onBeforeRender(M,ht,yt,de,be,Ve),Le.modelViewMatrix.multiplyMatrices(yt.matrixWorldInverse,Le.matrixWorld),Le.normalMatrix.getNormalMatrix(Le.modelViewMatrix),be.onBeforeRender(M,ht,yt,de,Le,Ve),be.transparent===!0&&be.side===jl&&be.forceSinglePass===!1?(be.side=Ao,be.needsUpdate=!0,M.renderBufferDirect(yt,ht,de,be,Le,Ve),be.side=qc,be.needsUpdate=!0,M.renderBufferDirect(yt,ht,de,be,Le,Ve),be.side=jl):M.renderBufferDirect(yt,ht,de,be,Le,Ve),Le.onAfterRender(M,ht,yt,de,be,Ve)}function $n(Le,ht,yt){ht.isScene!==!0&&(ht=gt);const de=vn.get(Le),be=x.state.lights,Ve=x.state.shadowsArray,dt=be.state.version,ut=fn.getParameters(Le,be.state,Ve,ht,yt),_t=fn.getProgramCacheKey(ut);let It=de.programs;de.environment=Le.isMeshStandardMaterial?ht.environment:null,de.fog=ht.fog,de.envMap=(Le.isMeshStandardMaterial?pt:Te).get(Le.envMap||de.environment),It===void 0&&(Le.addEventListener("dispose",At),It=new Map,de.programs=It);let Zt=It.get(_t);if(Zt!==void 0){if(de.currentProgram===Zt&&de.lightsStateVersion===dt)return Fi(Le,ut),Zt}else ut.uniforms=fn.getUniforms(Le),Le.onBuild(yt,ut,M),Le.onBeforeCompile(ut,M),Zt=fn.acquireProgram(ut,_t),It.set(_t,Zt),de.uniforms=ut.uniforms;const Wt=de.uniforms;return(!Le.isShaderMaterial&&!Le.isRawShaderMaterial||Le.clipping===!0)&&(Wt.clippingPlanes=Ne.uniform),Fi(Le,ut),de.needsLights=cr(Le),de.lightsStateVersion=dt,de.needsLights&&(Wt.ambientLightColor.value=be.state.ambient,Wt.lightProbe.value=be.state.probe,Wt.directionalLights.value=be.state.directional,Wt.directionalLightShadows.value=be.state.directionalShadow,Wt.spotLights.value=be.state.spot,Wt.spotLightShadows.value=be.state.spotShadow,Wt.rectAreaLights.value=be.state.rectArea,Wt.ltc_1.value=be.state.rectAreaLTC1,Wt.ltc_2.value=be.state.rectAreaLTC2,Wt.pointLights.value=be.state.point,Wt.pointLightShadows.value=be.state.pointShadow,Wt.hemisphereLights.value=be.state.hemi,Wt.directionalShadowMap.value=be.state.directionalShadowMap,Wt.directionalShadowMatrix.value=be.state.directionalShadowMatrix,Wt.spotShadowMap.value=be.state.spotShadowMap,Wt.spotLightMatrix.value=be.state.spotLightMatrix,Wt.spotLightMap.value=be.state.spotLightMap,Wt.pointShadowMap.value=be.state.pointShadowMap,Wt.pointShadowMatrix.value=be.state.pointShadowMatrix),de.currentProgram=Zt,de.uniformsList=null,Zt}function Ei(Le){if(Le.uniformsList===null){const ht=Le.currentProgram.getUniforms();Le.uniformsList=Z0.seqWithValue(ht.seq,Le.uniforms)}return Le.uniformsList}function Fi(Le,ht){const yt=vn.get(Le);yt.outputColorSpace=ht.outputColorSpace,yt.batching=ht.batching,yt.instancing=ht.instancing,yt.instancingColor=ht.instancingColor,yt.skinning=ht.skinning,yt.morphTargets=ht.morphTargets,yt.morphNormals=ht.morphNormals,yt.morphColors=ht.morphColors,yt.morphTargetsCount=ht.morphTargetsCount,yt.numClippingPlanes=ht.numClippingPlanes,yt.numIntersection=ht.numClipIntersection,yt.vertexAlphas=ht.vertexAlphas,yt.vertexTangents=ht.vertexTangents,yt.toneMapping=ht.toneMapping}function Vi(Le,ht,yt,de,be){ht.isScene!==!0&&(ht=gt),Fe.resetTextureUnits();const Ve=ht.fog,dt=de.isMeshStandardMaterial?ht.environment:null,ut=B===null?M.outputColorSpace:B.isXRRenderTarget===!0?B.texture.colorSpace:tc,_t=(de.isMeshStandardMaterial?pt:Te).get(de.envMap||dt),It=de.vertexColors===!0&&!!yt.attributes.color&&yt.attributes.color.itemSize===4,Zt=!!yt.attributes.tangent&&(!!de.normalMap||de.anisotropy>0),Wt=!!yt.morphAttributes.position,Lt=!!yt.morphAttributes.normal,Pn=!!yt.morphAttributes.color;let Dn=Qc;de.toneMapped&&(B===null||B.isXRRenderTarget===!0)&&(Dn=M.toneMapping);const jn=yt.morphAttributes.position||yt.morphAttributes.normal||yt.morphAttributes.color,di=jn!==void 0?jn.length:0,Cn=vn.get(de),vi=x.state.lights;if(me===!0&&(Ce===!0||Le!==D)){const se=Le===D&&de.id===F;Ne.setState(de,Le,se)}let Zn=!1;de.version===Cn.__version?(Cn.needsLights&&Cn.lightsStateVersion!==vi.state.version||Cn.outputColorSpace!==ut||be.isBatchedMesh&&Cn.batching===!1||!be.isBatchedMesh&&Cn.batching===!0||be.isInstancedMesh&&Cn.instancing===!1||!be.isInstancedMesh&&Cn.instancing===!0||be.isSkinnedMesh&&Cn.skinning===!1||!be.isSkinnedMesh&&Cn.skinning===!0||be.isInstancedMesh&&Cn.instancingColor===!0&&be.instanceColor===null||be.isInstancedMesh&&Cn.instancingColor===!1&&be.instanceColor!==null||Cn.envMap!==_t||de.fog===!0&&Cn.fog!==Ve||Cn.numClippingPlanes!==void 0&&(Cn.numClippingPlanes!==Ne.numPlanes||Cn.numIntersection!==Ne.numIntersection)||Cn.vertexAlphas!==It||Cn.vertexTangents!==Zt||Cn.morphTargets!==Wt||Cn.morphNormals!==Lt||Cn.morphColors!==Pn||Cn.toneMapping!==Dn||Qt.isWebGL2===!0&&Cn.morphTargetsCount!==di)&&(Zn=!0):(Zn=!0,Cn.__version=de.version);let nr=Cn.currentProgram;Zn===!0&&(nr=$n(de,ht,be));let Rr=!1,Rn=!1,Kn=!1;const zi=nr.getUniforms(),Si=Cn.uniforms;if(Xt.useProgram(nr.program)&&(Rr=!0,Rn=!0,Kn=!0),de.id!==F&&(F=de.id,Rn=!0),Rr||D!==Le){zi.setValue(Ze,"projectionMatrix",Le.projectionMatrix),zi.setValue(Ze,"viewMatrix",Le.matrixWorldInverse);const se=zi.map.cameraPosition;se!==void 0&&se.setValue(Ze,nt.setFromMatrixPosition(Le.matrixWorld)),Qt.logarithmicDepthBuffer&&zi.setValue(Ze,"logDepthBufFC",2/(Math.log(Le.far+1)/Math.LN2)),(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial)&&zi.setValue(Ze,"isOrthographic",Le.isOrthographicCamera===!0),D!==Le&&(D=Le,Rn=!0,Kn=!0)}if(be.isSkinnedMesh){zi.setOptional(Ze,be,"bindMatrix"),zi.setOptional(Ze,be,"bindMatrixInverse");const se=be.skeleton;se&&(Qt.floatVertexTextures?(se.boneTexture===null&&se.computeBoneTexture(),zi.setValue(Ze,"boneTexture",se.boneTexture,Fe)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}be.isBatchedMesh&&(zi.setOptional(Ze,be,"batchingTexture"),zi.setValue(Ze,"batchingTexture",be._matricesTexture,Fe));const Y=yt.morphAttributes;if((Y.position!==void 0||Y.normal!==void 0||Y.color!==void 0&&Qt.isWebGL2===!0)&&ke.update(be,yt,nr),(Rn||Cn.receiveShadow!==be.receiveShadow)&&(Cn.receiveShadow=be.receiveShadow,zi.setValue(Ze,"receiveShadow",be.receiveShadow)),de.isMeshGouraudMaterial&&de.envMap!==null&&(Si.envMap.value=_t,Si.flipEnvMap.value=_t.isCubeTexture&&_t.isRenderTargetTexture===!1?-1:1),Rn&&(zi.setValue(Ze,"toneMappingExposure",M.toneMappingExposure),Cn.needsLights&&lr(Si,Kn),Ve&&de.fog===!0&&mt.refreshFogUniforms(Si,Ve),mt.refreshMaterialUniforms(Si,de,H,G,Je),Z0.upload(Ze,Ei(Cn),Si,Fe)),de.isShaderMaterial&&de.uniformsNeedUpdate===!0&&(Z0.upload(Ze,Ei(Cn),Si,Fe),de.uniformsNeedUpdate=!1),de.isSpriteMaterial&&zi.setValue(Ze,"center",be.center),zi.setValue(Ze,"modelViewMatrix",be.modelViewMatrix),zi.setValue(Ze,"normalMatrix",be.normalMatrix),zi.setValue(Ze,"modelMatrix",be.matrixWorld),de.isShaderMaterial||de.isRawShaderMaterial){const se=de.uniformsGroups;for(let pe=0,we=se.length;pe<we;pe++)if(Qt.isWebGL2){const Ue=se[pe];k.update(Ue,nr),k.bind(Ue,nr)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return nr}function lr(Le,ht){Le.ambientLightColor.needsUpdate=ht,Le.lightProbe.needsUpdate=ht,Le.directionalLights.needsUpdate=ht,Le.directionalLightShadows.needsUpdate=ht,Le.pointLights.needsUpdate=ht,Le.pointLightShadows.needsUpdate=ht,Le.spotLights.needsUpdate=ht,Le.spotLightShadows.needsUpdate=ht,Le.rectAreaLights.needsUpdate=ht,Le.hemisphereLights.needsUpdate=ht}function cr(Le){return Le.isMeshLambertMaterial||Le.isMeshToonMaterial||Le.isMeshPhongMaterial||Le.isMeshStandardMaterial||Le.isShadowMaterial||Le.isShaderMaterial&&Le.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return B},this.setRenderTargetTextures=function(Le,ht,yt){vn.get(Le.texture).__webglTexture=ht,vn.get(Le.depthTexture).__webglTexture=yt;const de=vn.get(Le);de.__hasExternalTextures=!0,de.__hasExternalTextures&&(de.__autoAllocateDepthBuffer=yt===void 0,de.__autoAllocateDepthBuffer||Ft.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),de.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Le,ht){const yt=vn.get(Le);yt.__webglFramebuffer=ht,yt.__useDefaultFramebuffer=ht===void 0},this.setRenderTarget=function(Le,ht=0,yt=0){B=Le,T=ht,L=yt;let de=!0,be=null,Ve=!1,dt=!1;if(Le){const _t=vn.get(Le);_t.__useDefaultFramebuffer!==void 0?(Xt.bindFramebuffer(Ze.FRAMEBUFFER,null),de=!1):_t.__webglFramebuffer===void 0?Fe.setupRenderTarget(Le):_t.__hasExternalTextures&&Fe.rebindTextures(Le,vn.get(Le.texture).__webglTexture,vn.get(Le.depthTexture).__webglTexture);const It=Le.texture;(It.isData3DTexture||It.isDataArrayTexture||It.isCompressedArrayTexture)&&(dt=!0);const Zt=vn.get(Le).__webglFramebuffer;Le.isWebGLCubeRenderTarget?(Array.isArray(Zt[ht])?be=Zt[ht][yt]:be=Zt[ht],Ve=!0):Qt.isWebGL2&&Le.samples>0&&Fe.useMultisampledRTT(Le)===!1?be=vn.get(Le).__webglMultisampledFramebuffer:Array.isArray(Zt)?be=Zt[yt]:be=Zt,P.copy(Le.viewport),U.copy(Le.scissor),K=Le.scissorTest}else P.copy(ee).multiplyScalar(H).floor(),U.copy(oe).multiplyScalar(H).floor(),K=xe;if(Xt.bindFramebuffer(Ze.FRAMEBUFFER,be)&&Qt.drawBuffers&&de&&Xt.drawBuffers(Le,be),Xt.viewport(P),Xt.scissor(U),Xt.setScissorTest(K),Ve){const _t=vn.get(Le.texture);Ze.framebufferTexture2D(Ze.FRAMEBUFFER,Ze.COLOR_ATTACHMENT0,Ze.TEXTURE_CUBE_MAP_POSITIVE_X+ht,_t.__webglTexture,yt)}else if(dt){const _t=vn.get(Le.texture),It=ht||0;Ze.framebufferTextureLayer(Ze.FRAMEBUFFER,Ze.COLOR_ATTACHMENT0,_t.__webglTexture,yt||0,It)}F=-1},this.readRenderTargetPixels=function(Le,ht,yt,de,be,Ve,dt){if(!(Le&&Le.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ut=vn.get(Le).__webglFramebuffer;if(Le.isWebGLCubeRenderTarget&&dt!==void 0&&(ut=ut[dt]),ut){Xt.bindFramebuffer(Ze.FRAMEBUFFER,ut);try{const _t=Le.texture,It=_t.format,Zt=_t.type;if(It!==Da&&ne.convert(It)!==Ze.getParameter(Ze.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Wt=Zt===df&&(Ft.has("EXT_color_buffer_half_float")||Qt.isWebGL2&&Ft.has("EXT_color_buffer_float"));if(Zt!==Xc&&ne.convert(Zt)!==Ze.getParameter(Ze.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Zt===Wl&&(Qt.isWebGL2||Ft.has("OES_texture_float")||Ft.has("WEBGL_color_buffer_float")))&&!Wt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ht>=0&&ht<=Le.width-de&&yt>=0&&yt<=Le.height-be&&Ze.readPixels(ht,yt,de,be,ne.convert(It),ne.convert(Zt),Ve)}finally{const _t=B!==null?vn.get(B).__webglFramebuffer:null;Xt.bindFramebuffer(Ze.FRAMEBUFFER,_t)}}},this.copyFramebufferToTexture=function(Le,ht,yt=0){const de=Math.pow(2,-yt),be=Math.floor(ht.image.width*de),Ve=Math.floor(ht.image.height*de);Fe.setTexture2D(ht,0),Ze.copyTexSubImage2D(Ze.TEXTURE_2D,yt,0,0,Le.x,Le.y,be,Ve),Xt.unbindTexture()},this.copyTextureToTexture=function(Le,ht,yt,de=0){const be=ht.image.width,Ve=ht.image.height,dt=ne.convert(yt.format),ut=ne.convert(yt.type);Fe.setTexture2D(yt,0),Ze.pixelStorei(Ze.UNPACK_FLIP_Y_WEBGL,yt.flipY),Ze.pixelStorei(Ze.UNPACK_PREMULTIPLY_ALPHA_WEBGL,yt.premultiplyAlpha),Ze.pixelStorei(Ze.UNPACK_ALIGNMENT,yt.unpackAlignment),ht.isDataTexture?Ze.texSubImage2D(Ze.TEXTURE_2D,de,Le.x,Le.y,be,Ve,dt,ut,ht.image.data):ht.isCompressedTexture?Ze.compressedTexSubImage2D(Ze.TEXTURE_2D,de,Le.x,Le.y,ht.mipmaps[0].width,ht.mipmaps[0].height,dt,ht.mipmaps[0].data):Ze.texSubImage2D(Ze.TEXTURE_2D,de,Le.x,Le.y,dt,ut,ht.image),de===0&&yt.generateMipmaps&&Ze.generateMipmap(Ze.TEXTURE_2D),Xt.unbindTexture()},this.copyTextureToTexture3D=function(Le,ht,yt,de,be=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ve=Le.max.x-Le.min.x+1,dt=Le.max.y-Le.min.y+1,ut=Le.max.z-Le.min.z+1,_t=ne.convert(de.format),It=ne.convert(de.type);let Zt;if(de.isData3DTexture)Fe.setTexture3D(de,0),Zt=Ze.TEXTURE_3D;else if(de.isDataArrayTexture||de.isCompressedArrayTexture)Fe.setTexture2DArray(de,0),Zt=Ze.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ze.pixelStorei(Ze.UNPACK_FLIP_Y_WEBGL,de.flipY),Ze.pixelStorei(Ze.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),Ze.pixelStorei(Ze.UNPACK_ALIGNMENT,de.unpackAlignment);const Wt=Ze.getParameter(Ze.UNPACK_ROW_LENGTH),Lt=Ze.getParameter(Ze.UNPACK_IMAGE_HEIGHT),Pn=Ze.getParameter(Ze.UNPACK_SKIP_PIXELS),Dn=Ze.getParameter(Ze.UNPACK_SKIP_ROWS),jn=Ze.getParameter(Ze.UNPACK_SKIP_IMAGES),di=yt.isCompressedTexture?yt.mipmaps[be]:yt.image;Ze.pixelStorei(Ze.UNPACK_ROW_LENGTH,di.width),Ze.pixelStorei(Ze.UNPACK_IMAGE_HEIGHT,di.height),Ze.pixelStorei(Ze.UNPACK_SKIP_PIXELS,Le.min.x),Ze.pixelStorei(Ze.UNPACK_SKIP_ROWS,Le.min.y),Ze.pixelStorei(Ze.UNPACK_SKIP_IMAGES,Le.min.z),yt.isDataTexture||yt.isData3DTexture?Ze.texSubImage3D(Zt,be,ht.x,ht.y,ht.z,Ve,dt,ut,_t,It,di.data):yt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ze.compressedTexSubImage3D(Zt,be,ht.x,ht.y,ht.z,Ve,dt,ut,_t,di.data)):Ze.texSubImage3D(Zt,be,ht.x,ht.y,ht.z,Ve,dt,ut,_t,It,di),Ze.pixelStorei(Ze.UNPACK_ROW_LENGTH,Wt),Ze.pixelStorei(Ze.UNPACK_IMAGE_HEIGHT,Lt),Ze.pixelStorei(Ze.UNPACK_SKIP_PIXELS,Pn),Ze.pixelStorei(Ze.UNPACK_SKIP_ROWS,Dn),Ze.pixelStorei(Ze.UNPACK_SKIP_IMAGES,jn),be===0&&de.generateMipmaps&&Ze.generateMipmap(Zt),Xt.unbindTexture()},this.initTexture=function(Le){Le.isCubeTexture?Fe.setTextureCube(Le,0):Le.isData3DTexture?Fe.setTexture3D(Le,0):Le.isDataArrayTexture||Le.isCompressedArrayTexture?Fe.setTexture2DArray(Le,0):Fe.setTexture2D(Le,0),Xt.unbindTexture()},this.resetState=function(){T=0,L=0,B=null,Xt.reset(),W.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ql}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=e===G_?"display-p3":"srgb",n.unpackColorSpace=Mr.workingColorSpace===Wv?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===ms?nu:hB}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===nu?ms:tc}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class _j extends BB{}_j.prototype.isWebGL1Renderer=!0;class wj extends Ls{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}}class Mj{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=kb,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Jl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return iu("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let o=0,a=this.stride;o<a;o++)this.array[e+o]=n.array[i+o];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Jl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Jl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ao=new it;class vv{constructor(e,n,i,o=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=o}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)ao.fromBufferAttribute(this,n),ao.applyMatrix4(e),this.setXYZ(n,ao.x,ao.y,ao.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ao.fromBufferAttribute(this,n),ao.applyNormalMatrix(e),this.setXYZ(n,ao.x,ao.y,ao.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ao.fromBufferAttribute(this,n),ao.transformDirection(e),this.setXYZ(n,ao.x,ao.y,ao.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=Oa(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=_r(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=_r(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=_r(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=_r(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=_r(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Oa(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Oa(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Oa(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Oa(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=_r(n,this.array),i=_r(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,o){return e=e*this.data.stride+this.offset,this.normalized&&(n=_r(n,this.array),i=_r(i,this.array),o=_r(o,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=o,this}setXYZW(e,n,i,o,a){return e=e*this.data.stride+this.offset,this.normalized&&(n=_r(n,this.array),i=_r(i,this.array),o=_r(o,this.array),a=_r(a,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=o,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const o=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)n.push(this.data.array[o+a])}return new ha(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new vv(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const o=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)n.push(this.data.array[o+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class LB extends uu{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new or(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let kd;const Tp=new it,zd=new it,Gd=new it,Vd=new Mn,Rp=new Mn,PB=new Gr,C0=new it,Ip=new it,S0=new it,b3=new Mn,UE=new Mn,_3=new Mn;class Cj extends Ls{constructor(e=new LB){if(super(),this.isSprite=!0,this.type="Sprite",kd===void 0){kd=new Lo;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Mj(n,5);kd.setIndex([0,1,2,0,2,3]),kd.setAttribute("position",new vv(i,3,0,!1)),kd.setAttribute("uv",new vv(i,2,3,!1))}this.geometry=kd,this.material=e,this.center=new Mn(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),zd.setFromMatrixScale(this.matrixWorld),PB.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Gd.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&zd.multiplyScalar(-Gd.z);const i=this.material.rotation;let o,a;i!==0&&(a=Math.cos(i),o=Math.sin(i));const c=this.center;T0(C0.set(-.5,-.5,0),Gd,c,zd,o,a),T0(Ip.set(.5,-.5,0),Gd,c,zd,o,a),T0(S0.set(.5,.5,0),Gd,c,zd,o,a),b3.set(0,0),UE.set(1,0),_3.set(1,1);let u=e.ray.intersectTriangle(C0,Ip,S0,!1,Tp);if(u===null&&(T0(Ip.set(-.5,.5,0),Gd,c,zd,o,a),UE.set(0,1),u=e.ray.intersectTriangle(C0,S0,Ip,!1,Tp),u===null))return;const h=e.ray.origin.distanceTo(Tp);h<e.near||h>e.far||n.push({distance:h,point:Tp.clone(),uv:Fa.getInterpolation(Tp,C0,Ip,S0,b3,UE,_3,new Mn),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function T0(s,e,n,i,o,a){Vd.subVectors(s,n).addScalar(.5).multiply(i),o!==void 0?(Rp.x=a*Vd.x-o*Vd.y,Rp.y=o*Vd.x+a*Vd.y):Rp.copy(Vd),s.copy(e),s.x+=Rp.x,s.y+=Rp.y,s.applyMatrix4(PB)}class DB extends uu{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new or(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const w3=new it,M3=new it,C3=new Gr,kE=new Xv,R0=new Qv;class Sj extends Ls{constructor(e=new Lo,n=new DB){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let o=1,a=n.count;o<a;o++)w3.fromBufferAttribute(n,o-1),M3.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=w3.distanceTo(M3);e.setAttribute("lineDistance",new As(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,o=this.matrixWorld,a=e.params.Line.threshold,c=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),R0.copy(i.boundingSphere),R0.applyMatrix4(o),R0.radius+=a,e.ray.intersectsSphere(R0)===!1)return;C3.copy(o).invert(),kE.copy(e.ray).applyMatrix4(C3);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),h=u*u,d=new it,f=new it,p=new it,A=new it,g=this.isLineSegments?2:1,v=i.index,x=i.attributes.position;if(v!==null){const E=Math.max(0,c.start),S=Math.min(v.count,c.start+c.count);for(let M=E,C=S-1;M<C;M+=g){const T=v.getX(M),L=v.getX(M+1);if(d.fromBufferAttribute(x,T),f.fromBufferAttribute(x,L),kE.distanceSqToSegment(d,f,A,p)>h)continue;A.applyMatrix4(this.matrixWorld);const F=e.ray.origin.distanceTo(A);F<e.near||F>e.far||n.push({distance:F,point:p.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{const E=Math.max(0,c.start),S=Math.min(x.count,c.start+c.count);for(let M=E,C=S-1;M<C;M+=g){if(d.fromBufferAttribute(x,M),f.fromBufferAttribute(x,M+1),kE.distanceSqToSegment(d,f,A,p)>h)continue;A.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(A);L<e.near||L>e.far||n.push({distance:L,point:p.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=o.length;a<c;a++){const u=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}class rc{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,o=this.getPoint(0),a=0;n.push(0);for(let c=1;c<=e;c++)i=this.getPoint(c/e),a+=i.distanceTo(o),n.push(a),o=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let o=0;const a=i.length;let c;n?c=n:c=e*i[a-1];let u=0,h=a-1,d;for(;u<=h;)if(o=Math.floor(u+(h-u)/2),d=i[o]-c,d<0)u=o+1;else if(d>0)h=o-1;else{h=o;break}if(o=h,i[o]===c)return o/(a-1);const f=i[o],A=i[o+1]-f,g=(c-f)/A;return(o+g)/(a-1)}getTangent(e,n){let o=e-1e-4,a=e+1e-4;o<0&&(o=0),a>1&&(a=1);const c=this.getPoint(o),u=this.getPoint(a),h=n||(c.isVector2?new Mn:new it);return h.copy(u).sub(c).normalize(),h}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new it,o=[],a=[],c=[],u=new it,h=new Gr;for(let g=0;g<=e;g++){const v=g/e;o[g]=this.getTangentAt(v,new it)}a[0]=new it,c[0]=new it;let d=Number.MAX_VALUE;const f=Math.abs(o[0].x),p=Math.abs(o[0].y),A=Math.abs(o[0].z);f<=d&&(d=f,i.set(1,0,0)),p<=d&&(d=p,i.set(0,1,0)),A<=d&&i.set(0,0,1),u.crossVectors(o[0],i).normalize(),a[0].crossVectors(o[0],u),c[0].crossVectors(o[0],a[0]);for(let g=1;g<=e;g++){if(a[g]=a[g-1].clone(),c[g]=c[g-1].clone(),u.crossVectors(o[g-1],o[g]),u.length()>Number.EPSILON){u.normalize();const v=Math.acos(Is(o[g-1].dot(o[g]),-1,1));a[g].applyMatrix4(h.makeRotationAxis(u,v))}c[g].crossVectors(o[g],a[g])}if(n===!0){let g=Math.acos(Is(a[0].dot(a[e]),-1,1));g/=e,o[0].dot(u.crossVectors(a[0],a[e]))>0&&(g=-g);for(let v=1;v<=e;v++)a[v].applyMatrix4(h.makeRotationAxis(o[v],g*v)),c[v].crossVectors(o[v],a[v])}return{tangents:o,normals:a,binormals:c}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class OB extends rc{constructor(e=0,n=0,i=1,o=1,a=0,c=Math.PI*2,u=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=o,this.aStartAngle=a,this.aEndAngle=c,this.aClockwise=u,this.aRotation=h}getPoint(e,n){const i=n||new Mn,o=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const c=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=o;for(;a>o;)a-=o;a<Number.EPSILON&&(c?a=0:a=o),this.aClockwise===!0&&!c&&(a===o?a=-o:a=a-o);const u=this.aStartAngle+e*a;let h=this.aX+this.xRadius*Math.cos(u),d=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const f=Math.cos(this.aRotation),p=Math.sin(this.aRotation),A=h-this.aX,g=d-this.aY;h=A*f-g*p+this.aX,d=A*p+g*f+this.aY}return i.set(h,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Tj extends OB{constructor(e,n,i,o,a,c){super(e,n,i,i,o,a,c),this.isArcCurve=!0,this.type="ArcCurve"}}function X_(){let s=0,e=0,n=0,i=0;function o(a,c,u,h){s=a,e=u,n=-3*a+3*c-2*u-h,i=2*a-2*c+u+h}return{initCatmullRom:function(a,c,u,h,d){o(c,u,d*(u-a),d*(h-c))},initNonuniformCatmullRom:function(a,c,u,h,d,f,p){let A=(c-a)/d-(u-a)/(d+f)+(u-c)/f,g=(u-c)/f-(h-c)/(f+p)+(h-u)/p;A*=f,g*=f,o(c,u,A,g)},calc:function(a){const c=a*a,u=c*a;return s+e*a+n*c+i*u}}}const I0=new it,zE=new X_,GE=new X_,VE=new X_;class Rj extends rc{constructor(e=[],n=!1,i="centripetal",o=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=o}getPoint(e,n=new it){const i=n,o=this.points,a=o.length,c=(a-(this.closed?0:1))*e;let u=Math.floor(c),h=c-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/a)+1)*a:h===0&&u===a-1&&(u=a-2,h=1);let d,f;this.closed||u>0?d=o[(u-1)%a]:(I0.subVectors(o[0],o[1]).add(o[0]),d=I0);const p=o[u%a],A=o[(u+1)%a];if(this.closed||u+2<a?f=o[(u+2)%a]:(I0.subVectors(o[a-1],o[a-2]).add(o[a-1]),f=I0),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let v=Math.pow(d.distanceToSquared(p),g),b=Math.pow(p.distanceToSquared(A),g),x=Math.pow(A.distanceToSquared(f),g);b<1e-4&&(b=1),v<1e-4&&(v=b),x<1e-4&&(x=b),zE.initNonuniformCatmullRom(d.x,p.x,A.x,f.x,v,b,x),GE.initNonuniformCatmullRom(d.y,p.y,A.y,f.y,v,b,x),VE.initNonuniformCatmullRom(d.z,p.z,A.z,f.z,v,b,x)}else this.curveType==="catmullrom"&&(zE.initCatmullRom(d.x,p.x,A.x,f.x,this.tension),GE.initCatmullRom(d.y,p.y,A.y,f.y,this.tension),VE.initCatmullRom(d.z,p.z,A.z,f.z,this.tension));return i.set(zE.calc(h),GE.calc(h),VE.calc(h)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const o=e.points[n];this.points.push(o.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const o=this.points[n];e.points.push(o.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const o=e.points[n];this.points.push(new it().fromArray(o))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function S3(s,e,n,i,o){const a=(i-e)*.5,c=(o-n)*.5,u=s*s,h=s*u;return(2*n-2*i+a+c)*h+(-3*n+3*i-2*a-c)*u+a*s+n}function Ij(s,e){const n=1-s;return n*n*e}function Bj(s,e){return 2*(1-s)*s*e}function Lj(s,e){return s*s*e}function nm(s,e,n,i){return Ij(s,e)+Bj(s,n)+Lj(s,i)}function Pj(s,e){const n=1-s;return n*n*n*e}function Dj(s,e){const n=1-s;return 3*n*n*s*e}function Oj(s,e){return 3*(1-s)*s*s*e}function Fj(s,e){return s*s*s*e}function im(s,e,n,i,o){return Pj(s,e)+Dj(s,n)+Oj(s,i)+Fj(s,o)}class Nj extends rc{constructor(e=new Mn,n=new Mn,i=new Mn,o=new Mn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=o}getPoint(e,n=new Mn){const i=n,o=this.v0,a=this.v1,c=this.v2,u=this.v3;return i.set(im(e,o.x,a.x,c.x,u.x),im(e,o.y,a.y,c.y,u.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class FB extends rc{constructor(e=new it,n=new it,i=new it,o=new it){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=o}getPoint(e,n=new it){const i=n,o=this.v0,a=this.v1,c=this.v2,u=this.v3;return i.set(im(e,o.x,a.x,c.x,u.x),im(e,o.y,a.y,c.y,u.y),im(e,o.z,a.z,c.z,u.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Uj extends rc{constructor(e=new Mn,n=new Mn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Mn){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Mn){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class kj extends rc{constructor(e=new it,n=new it){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new it){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new it){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zj extends rc{constructor(e=new Mn,n=new Mn,i=new Mn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Mn){const i=n,o=this.v0,a=this.v1,c=this.v2;return i.set(nm(e,o.x,a.x,c.x),nm(e,o.y,a.y,c.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class K_ extends rc{constructor(e=new it,n=new it,i=new it){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new it){const i=n,o=this.v0,a=this.v1,c=this.v2;return i.set(nm(e,o.x,a.x,c.x),nm(e,o.y,a.y,c.y),nm(e,o.z,a.z,c.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Gj extends rc{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Mn){const i=n,o=this.points,a=(o.length-1)*e,c=Math.floor(a),u=a-c,h=o[c===0?c:c-1],d=o[c],f=o[c>o.length-2?o.length-1:c+1],p=o[c>o.length-3?o.length-1:c+2];return i.set(S3(u,h.x,d.x,f.x,p.x),S3(u,h.y,d.y,f.y,p.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const o=e.points[n];this.points.push(o.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const o=this.points[n];e.points.push(o.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const o=e.points[n];this.points.push(new Mn().fromArray(o))}return this}}var Vj=Object.freeze({__proto__:null,ArcCurve:Tj,CatmullRomCurve3:Rj,CubicBezierCurve:Nj,CubicBezierCurve3:FB,EllipseCurve:OB,LineCurve:Uj,LineCurve3:kj,QuadraticBezierCurve:zj,QuadraticBezierCurve3:K_,SplineCurve:Gj});class Jv extends Lo{constructor(e=1,n=1,i=1,o=32,a=1,c=!1,u=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:o,heightSegments:a,openEnded:c,thetaStart:u,thetaLength:h};const d=this;o=Math.floor(o),a=Math.floor(a);const f=[],p=[],A=[],g=[];let v=0;const b=[],x=i/2;let E=0;S(),c===!1&&(e>0&&M(!0),n>0&&M(!1)),this.setIndex(f),this.setAttribute("position",new As(p,3)),this.setAttribute("normal",new As(A,3)),this.setAttribute("uv",new As(g,2));function S(){const C=new it,T=new it;let L=0;const B=(n-e)/i;for(let F=0;F<=a;F++){const D=[],P=F/a,U=P*(n-e)+e;for(let K=0;K<=o;K++){const J=K/o,z=J*h+u,j=Math.sin(z),G=Math.cos(z);T.x=U*j,T.y=-P*i+x,T.z=U*G,p.push(T.x,T.y,T.z),C.set(j,B,G).normalize(),A.push(C.x,C.y,C.z),g.push(J,1-P),D.push(v++)}b.push(D)}for(let F=0;F<o;F++)for(let D=0;D<a;D++){const P=b[D][F],U=b[D+1][F],K=b[D+1][F+1],J=b[D][F+1];f.push(P,U,J),f.push(U,K,J),L+=6}d.addGroup(E,L,0),E+=L}function M(C){const T=v,L=new Mn,B=new it;let F=0;const D=C===!0?e:n,P=C===!0?1:-1;for(let K=1;K<=o;K++)p.push(0,x*P,0),A.push(0,P,0),g.push(.5,.5),v++;const U=v;for(let K=0;K<=o;K++){const z=K/o*h+u,j=Math.cos(z),G=Math.sin(z);B.x=D*G,B.y=x*P,B.z=D*j,p.push(B.x,B.y,B.z),A.push(0,P,0),L.x=j*.5+.5,L.y=G*.5*P+.5,g.push(L.x,L.y),v++}for(let K=0;K<o;K++){const J=T+K,z=U+K;C===!0?f.push(z,z+1,J):f.push(z+1,z,J),F+=3}d.addGroup(E,F,C===!0?1:2),E+=F}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jv(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class q_ extends Jv{constructor(e=1,n=1,i=32,o=1,a=!1,c=0,u=Math.PI*2){super(0,e,n,i,o,a,c,u),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:c,thetaLength:u}}static fromJSON(e){return new q_(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Tm extends Lo{constructor(e=1,n=32,i=16,o=0,a=Math.PI*2,c=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:o,phiLength:a,thetaStart:c,thetaLength:u},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const h=Math.min(c+u,Math.PI);let d=0;const f=[],p=new it,A=new it,g=[],v=[],b=[],x=[];for(let E=0;E<=i;E++){const S=[],M=E/i;let C=0;E===0&&c===0?C=.5/n:E===i&&h===Math.PI&&(C=-.5/n);for(let T=0;T<=n;T++){const L=T/n;p.x=-e*Math.cos(o+L*a)*Math.sin(c+M*u),p.y=e*Math.cos(c+M*u),p.z=e*Math.sin(o+L*a)*Math.sin(c+M*u),v.push(p.x,p.y,p.z),A.copy(p).normalize(),b.push(A.x,A.y,A.z),x.push(L+C,1-M),S.push(d++)}f.push(S)}for(let E=0;E<i;E++)for(let S=0;S<n;S++){const M=f[E][S+1],C=f[E][S],T=f[E+1][S],L=f[E+1][S+1];(E!==0||c>0)&&g.push(M,C,L),(E!==i-1||h<Math.PI)&&g.push(C,T,L)}this.setIndex(g),this.setAttribute("position",new As(v,3)),this.setAttribute("normal",new As(b,3)),this.setAttribute("uv",new As(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Y_ extends Lo{constructor(e=new K_(new it(-1,-1,0),new it(-1,1,0),new it(1,1,0)),n=64,i=1,o=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:o,closed:a};const c=e.computeFrenetFrames(n,a);this.tangents=c.tangents,this.normals=c.normals,this.binormals=c.binormals;const u=new it,h=new it,d=new Mn;let f=new it;const p=[],A=[],g=[],v=[];b(),this.setIndex(v),this.setAttribute("position",new As(p,3)),this.setAttribute("normal",new As(A,3)),this.setAttribute("uv",new As(g,2));function b(){for(let M=0;M<n;M++)x(M);x(a===!1?n:0),S(),E()}function x(M){f=e.getPointAt(M/n,f);const C=c.normals[M],T=c.binormals[M];for(let L=0;L<=o;L++){const B=L/o*Math.PI*2,F=Math.sin(B),D=-Math.cos(B);h.x=D*C.x+F*T.x,h.y=D*C.y+F*T.y,h.z=D*C.z+F*T.z,h.normalize(),A.push(h.x,h.y,h.z),u.x=f.x+i*h.x,u.y=f.y+i*h.y,u.z=f.z+i*h.z,p.push(u.x,u.y,u.z)}}function E(){for(let M=1;M<=n;M++)for(let C=1;C<=o;C++){const T=(o+1)*(M-1)+(C-1),L=(o+1)*M+(C-1),B=(o+1)*M+C,F=(o+1)*(M-1)+C;v.push(T,L,F),v.push(L,B,F)}}function S(){for(let M=0;M<=n;M++)for(let C=0;C<=o;C++)d.x=M/n,d.y=C/o,g.push(d.x,d.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Y_(new Vj[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Hj extends uu{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uB,this.normalScale=new Mn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=k_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const T3={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class jj{constructor(e,n,i){const o=this;let a=!1,c=0,u=0,h;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(f){u++,a===!1&&o.onStart!==void 0&&o.onStart(f,c,u),a=!0},this.itemEnd=function(f){c++,o.onProgress!==void 0&&o.onProgress(f,c,u),c===u&&(a=!1,o.onLoad!==void 0&&o.onLoad())},this.itemError=function(f){o.onError!==void 0&&o.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,p){return d.push(f,p),this},this.removeHandler=function(f){const p=d.indexOf(f);return p!==-1&&d.splice(p,2),this},this.getHandler=function(f){for(let p=0,A=d.length;p<A;p+=2){const g=d[p],v=d[p+1];if(g.global&&(g.lastIndex=0),g.test(f))return v}return null}}}const Wj=new jj;class $_{constructor(e){this.manager=e!==void 0?e:Wj,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(o,a){i.load(e,o,n,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}$_.DEFAULT_MATERIAL_NAME="__DEFAULT";class Qj extends $_{constructor(e){super(e)}load(e,n,i,o){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=T3.get(e);if(c!==void 0)return a.manager.itemStart(e),setTimeout(function(){n&&n(c),a.manager.itemEnd(e)},0),c;const u=pm("img");function h(){f(),T3.add(e,this),n&&n(this),a.manager.itemEnd(e)}function d(p){f(),o&&o(p),a.manager.itemError(e),a.manager.itemEnd(e)}function f(){u.removeEventListener("load",h,!1),u.removeEventListener("error",d,!1)}return u.addEventListener("load",h,!1),u.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(e),u.src=e,u}}class Xj extends $_{constructor(e){super(e)}load(e,n,i,o){const a=new Js,c=new Qj(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(u){a.image=u,a.needsUpdate=!0,n!==void 0&&n(a)},i,o),a}}class NB extends Ls{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new or(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}const HE=new Gr,R3=new it,I3=new it;class Kj{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Mn(512,512),this.map=null,this.mapPass=null,this.matrix=new Gr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new j_,this._frameExtents=new Mn(1,1),this._viewportCount=1,this._viewports=[new Bs(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;R3.setFromMatrixPosition(e.matrixWorld),n.position.copy(R3),I3.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(I3),n.updateMatrixWorld(),HE.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(HE),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(HE)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class qj extends Kj{constructor(){super(new W_(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Yj extends NB{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ls.DEFAULT_UP),this.updateMatrix(),this.target=new Ls,this.shadow=new qj}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class $j extends NB{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class UB{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=B3(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=B3();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function B3(){return(typeof performance>"u"?Date:performance).now()}class kB{constructor(e,n,i=0,o=1/0){this.ray=new Xv(e,n),this.near=i,this.far=o,this.camera=null,this.layers=new H_,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,i=[]){return jb(e,this,i,n),i.sort(L3),i}intersectObjects(e,n=!0,i=[]){for(let o=0,a=e.length;o<a;o++)jb(e[o],this,i,n);return i.sort(L3),i}}function L3(s,e){return s.distance-e.distance}function jb(s,e,n,i){if(s.layers.test(e.layers)&&s.raycast(e,n),i===!0){const o=s.children;for(let a=0,c=o.length;a<c;a++)jb(o[a],e,n,!0)}}class Wb{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Is(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Hv}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Hv);function zB(s,e,n){var i,o=1;s==null&&(s=0),e==null&&(e=0),n==null&&(n=0);function a(){var c,u=i.length,h,d=0,f=0,p=0;for(c=0;c<u;++c)h=i[c],d+=h.x||0,f+=h.y||0,p+=h.z||0;for(d=(d/u-s)*o,f=(f/u-e)*o,p=(p/u-n)*o,c=0;c<u;++c)h=i[c],d&&(h.x-=d),f&&(h.y-=f),p&&(h.z-=p)}return a.initialize=function(c){i=c},a.x=function(c){return arguments.length?(s=+c,a):s},a.y=function(c){return arguments.length?(e=+c,a):e},a.z=function(c){return arguments.length?(n=+c,a):n},a.strength=function(c){return arguments.length?(o=+c,a):o},a}function Jj(s){const e=+this._x.call(null,s);return GB(this.cover(e),e,s)}function GB(s,e,n){if(isNaN(e))return s;var i,o=s._root,a={data:n},c=s._x0,u=s._x1,h,d,f,p,A;if(!o)return s._root=a,s;for(;o.length;)if((f=e>=(h=(c+u)/2))?c=h:u=h,i=o,!(o=o[p=+f]))return i[p]=a,s;if(d=+s._x.call(null,o.data),e===d)return a.next=o,i?i[p]=a:s._root=a,s;do i=i?i[p]=new Array(2):s._root=new Array(2),(f=e>=(h=(c+u)/2))?c=h:u=h;while((p=+f)==(A=+(d>=h)));return i[A]=o,i[p]=a,s}function Zj(s){Array.isArray(s)||(s=Array.from(s));const e=s.length,n=new Float64Array(e);let i=1/0,o=-1/0;for(let a=0,c;a<e;++a)isNaN(c=+this._x.call(null,s[a]))||(n[a]=c,c<i&&(i=c),c>o&&(o=c));if(i>o)return this;this.cover(i).cover(o);for(let a=0;a<e;++a)GB(this,n[a],s[a]);return this}function eW(s){if(isNaN(s=+s))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(s))+1;else{for(var i=n-e||1,o=this._root,a,c;e>s||s>=n;)switch(c=+(s<e),a=new Array(2),a[c]=o,o=a,i*=2,c){case 0:n=e+i;break;case 1:e=n-i;break}this._root&&this._root.length&&(this._root=o)}return this._x0=e,this._x1=n,this}function tW(){var s=[];return this.visit(function(e){if(!e.length)do s.push(e.data);while(e=e.next)}),s}function nW(s){return arguments.length?this.cover(+s[0][0]).cover(+s[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Zl(s,e,n){this.node=s,this.x0=e,this.x1=n}function iW(s,e){var n,i=this._x0,o,a,c=this._x1,u=[],h=this._root,d,f;for(h&&u.push(new Zl(h,i,c)),e==null?e=1/0:(i=s-e,c=s+e);d=u.pop();)if(!(!(h=d.node)||(o=d.x0)>c||(a=d.x1)<i))if(h.length){var p=(o+a)/2;u.push(new Zl(h[1],p,a),new Zl(h[0],o,p)),(f=+(s>=p))&&(d=u[u.length-1],u[u.length-1]=u[u.length-1-f],u[u.length-1-f]=d)}else{var A=Math.abs(s-+this._x.call(null,h.data));A<e&&(e=A,i=s-A,c=s+A,n=h.data)}return n}function rW(s){if(isNaN(h=+this._x.call(null,s)))return this;var e,n=this._root,i,o,a,c=this._x0,u=this._x1,h,d,f,p,A;if(!n)return this;if(n.length)for(;;){if((f=h>=(d=(c+u)/2))?c=d:u=d,e=n,!(n=n[p=+f]))return this;if(!n.length)break;e[p+1&1]&&(i=e,A=p)}for(;n.data!==s;)if(o=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,o?(a?o.next=a:delete o.next,this):e?(a?e[p]=a:delete e[p],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(i?i[A]=n:this._root=n),this):(this._root=a,this)}function sW(s){for(var e=0,n=s.length;e<n;++e)this.remove(s[e]);return this}function oW(){return this._root}function aW(){var s=0;return this.visit(function(e){if(!e.length)do++s;while(e=e.next)}),s}function lW(s){var e=[],n,i=this._root,o,a,c;for(i&&e.push(new Zl(i,this._x0,this._x1));n=e.pop();)if(!s(i=n.node,a=n.x0,c=n.x1)&&i.length){var u=(a+c)/2;(o=i[1])&&e.push(new Zl(o,u,c)),(o=i[0])&&e.push(new Zl(o,a,u))}return this}function cW(s){var e=[],n=[],i;for(this._root&&e.push(new Zl(this._root,this._x0,this._x1));i=e.pop();){var o=i.node;if(o.length){var a,c=i.x0,u=i.x1,h=(c+u)/2;(a=o[0])&&e.push(new Zl(a,c,h)),(a=o[1])&&e.push(new Zl(a,h,u))}n.push(i)}for(;i=n.pop();)s(i.node,i.x0,i.x1);return this}function hW(s){return s[0]}function uW(s){return arguments.length?(this._x=s,this):this._x}function VB(s,e){var n=new J_(e??hW,NaN,NaN);return s==null?n:n.addAll(s)}function J_(s,e,n){this._x=s,this._x0=e,this._x1=n,this._root=void 0}function P3(s){for(var e={data:s.data},n=e;s=s.next;)n=n.next={data:s.data};return e}var Po=VB.prototype=J_.prototype;Po.copy=function(){var s=new J_(this._x,this._x0,this._x1),e=this._root,n,i;if(!e)return s;if(!e.length)return s._root=P3(e),s;for(n=[{source:e,target:s._root=new Array(2)}];e=n.pop();)for(var o=0;o<2;++o)(i=e.source[o])&&(i.length?n.push({source:i,target:e.target[o]=new Array(2)}):e.target[o]=P3(i));return s};Po.add=Jj;Po.addAll=Zj;Po.cover=eW;Po.data=tW;Po.extent=nW;Po.find=iW;Po.remove=rW;Po.removeAll=sW;Po.root=oW;Po.size=aW;Po.visit=lW;Po.visitAfter=cW;Po.x=uW;function dW(s){const e=+this._x.call(null,s),n=+this._y.call(null,s);return HB(this.cover(e,n),e,n,s)}function HB(s,e,n,i){if(isNaN(e)||isNaN(n))return s;var o,a=s._root,c={data:i},u=s._x0,h=s._y0,d=s._x1,f=s._y1,p,A,g,v,b,x,E,S;if(!a)return s._root=c,s;for(;a.length;)if((b=e>=(p=(u+d)/2))?u=p:d=p,(x=n>=(A=(h+f)/2))?h=A:f=A,o=a,!(a=a[E=x<<1|b]))return o[E]=c,s;if(g=+s._x.call(null,a.data),v=+s._y.call(null,a.data),e===g&&n===v)return c.next=a,o?o[E]=c:s._root=c,s;do o=o?o[E]=new Array(4):s._root=new Array(4),(b=e>=(p=(u+d)/2))?u=p:d=p,(x=n>=(A=(h+f)/2))?h=A:f=A;while((E=x<<1|b)===(S=(v>=A)<<1|g>=p));return o[S]=a,o[E]=c,s}function fW(s){var e,n,i=s.length,o,a,c=new Array(i),u=new Array(i),h=1/0,d=1/0,f=-1/0,p=-1/0;for(n=0;n<i;++n)isNaN(o=+this._x.call(null,e=s[n]))||isNaN(a=+this._y.call(null,e))||(c[n]=o,u[n]=a,o<h&&(h=o),o>f&&(f=o),a<d&&(d=a),a>p&&(p=a));if(h>f||d>p)return this;for(this.cover(h,d).cover(f,p),n=0;n<i;++n)HB(this,c[n],u[n],s[n]);return this}function pW(s,e){if(isNaN(s=+s)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,o=this._x1,a=this._y1;if(isNaN(n))o=(n=Math.floor(s))+1,a=(i=Math.floor(e))+1;else{for(var c=o-n||1,u=this._root,h,d;n>s||s>=o||i>e||e>=a;)switch(d=(e<i)<<1|s<n,h=new Array(4),h[d]=u,u=h,c*=2,d){case 0:o=n+c,a=i+c;break;case 1:n=o-c,a=i+c;break;case 2:o=n+c,i=a-c;break;case 3:n=o-c,i=a-c;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=o,this._y1=a,this}function mW(){var s=[];return this.visit(function(e){if(!e.length)do s.push(e.data);while(e=e.next)}),s}function gW(s){return arguments.length?this.cover(+s[0][0],+s[0][1]).cover(+s[1][0],+s[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function go(s,e,n,i,o){this.node=s,this.x0=e,this.y0=n,this.x1=i,this.y1=o}function AW(s,e,n){var i,o=this._x0,a=this._y0,c,u,h,d,f=this._x1,p=this._y1,A=[],g=this._root,v,b;for(g&&A.push(new go(g,o,a,f,p)),n==null?n=1/0:(o=s-n,a=e-n,f=s+n,p=e+n,n*=n);v=A.pop();)if(!(!(g=v.node)||(c=v.x0)>f||(u=v.y0)>p||(h=v.x1)<o||(d=v.y1)<a))if(g.length){var x=(c+h)/2,E=(u+d)/2;A.push(new go(g[3],x,E,h,d),new go(g[2],c,E,x,d),new go(g[1],x,u,h,E),new go(g[0],c,u,x,E)),(b=(e>=E)<<1|s>=x)&&(v=A[A.length-1],A[A.length-1]=A[A.length-1-b],A[A.length-1-b]=v)}else{var S=s-+this._x.call(null,g.data),M=e-+this._y.call(null,g.data),C=S*S+M*M;if(C<n){var T=Math.sqrt(n=C);o=s-T,a=e-T,f=s+T,p=e+T,i=g.data}}return i}function vW(s){if(isNaN(f=+this._x.call(null,s))||isNaN(p=+this._y.call(null,s)))return this;var e,n=this._root,i,o,a,c=this._x0,u=this._y0,h=this._x1,d=this._y1,f,p,A,g,v,b,x,E;if(!n)return this;if(n.length)for(;;){if((v=f>=(A=(c+h)/2))?c=A:h=A,(b=p>=(g=(u+d)/2))?u=g:d=g,e=n,!(n=n[x=b<<1|v]))return this;if(!n.length)break;(e[x+1&3]||e[x+2&3]||e[x+3&3])&&(i=e,E=x)}for(;n.data!==s;)if(o=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,o?(a?o.next=a:delete o.next,this):e?(a?e[x]=a:delete e[x],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[E]=n:this._root=n),this):(this._root=a,this)}function yW(s){for(var e=0,n=s.length;e<n;++e)this.remove(s[e]);return this}function xW(){return this._root}function EW(){var s=0;return this.visit(function(e){if(!e.length)do++s;while(e=e.next)}),s}function bW(s){var e=[],n,i=this._root,o,a,c,u,h;for(i&&e.push(new go(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!s(i=n.node,a=n.x0,c=n.y0,u=n.x1,h=n.y1)&&i.length){var d=(a+u)/2,f=(c+h)/2;(o=i[3])&&e.push(new go(o,d,f,u,h)),(o=i[2])&&e.push(new go(o,a,f,d,h)),(o=i[1])&&e.push(new go(o,d,c,u,f)),(o=i[0])&&e.push(new go(o,a,c,d,f))}return this}function _W(s){var e=[],n=[],i;for(this._root&&e.push(new go(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var o=i.node;if(o.length){var a,c=i.x0,u=i.y0,h=i.x1,d=i.y1,f=(c+h)/2,p=(u+d)/2;(a=o[0])&&e.push(new go(a,c,u,f,p)),(a=o[1])&&e.push(new go(a,f,u,h,p)),(a=o[2])&&e.push(new go(a,c,p,f,d)),(a=o[3])&&e.push(new go(a,f,p,h,d))}n.push(i)}for(;i=n.pop();)s(i.node,i.x0,i.y0,i.x1,i.y1);return this}function wW(s){return s[0]}function MW(s){return arguments.length?(this._x=s,this):this._x}function CW(s){return s[1]}function SW(s){return arguments.length?(this._y=s,this):this._y}function jB(s,e,n){var i=new Z_(e??wW,n??CW,NaN,NaN,NaN,NaN);return s==null?i:i.addAll(s)}function Z_(s,e,n,i,o,a){this._x=s,this._y=e,this._x0=n,this._y0=i,this._x1=o,this._y1=a,this._root=void 0}function D3(s){for(var e={data:s.data},n=e;s=s.next;)n=n.next={data:s.data};return e}var vo=jB.prototype=Z_.prototype;vo.copy=function(){var s=new Z_(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return s;if(!e.length)return s._root=D3(e),s;for(n=[{source:e,target:s._root=new Array(4)}];e=n.pop();)for(var o=0;o<4;++o)(i=e.source[o])&&(i.length?n.push({source:i,target:e.target[o]=new Array(4)}):e.target[o]=D3(i));return s};vo.add=dW;vo.addAll=fW;vo.cover=pW;vo.data=mW;vo.extent=gW;vo.find=AW;vo.remove=vW;vo.removeAll=yW;vo.root=xW;vo.size=EW;vo.visit=bW;vo.visitAfter=_W;vo.x=MW;vo.y=SW;function TW(s){const e=+this._x.call(null,s),n=+this._y.call(null,s),i=+this._z.call(null,s);return WB(this.cover(e,n,i),e,n,i,s)}function WB(s,e,n,i,o){if(isNaN(e)||isNaN(n)||isNaN(i))return s;var a,c=s._root,u={data:o},h=s._x0,d=s._y0,f=s._z0,p=s._x1,A=s._y1,g=s._z1,v,b,x,E,S,M,C,T,L,B,F;if(!c)return s._root=u,s;for(;c.length;)if((C=e>=(v=(h+p)/2))?h=v:p=v,(T=n>=(b=(d+A)/2))?d=b:A=b,(L=i>=(x=(f+g)/2))?f=x:g=x,a=c,!(c=c[B=L<<2|T<<1|C]))return a[B]=u,s;if(E=+s._x.call(null,c.data),S=+s._y.call(null,c.data),M=+s._z.call(null,c.data),e===E&&n===S&&i===M)return u.next=c,a?a[B]=u:s._root=u,s;do a=a?a[B]=new Array(8):s._root=new Array(8),(C=e>=(v=(h+p)/2))?h=v:p=v,(T=n>=(b=(d+A)/2))?d=b:A=b,(L=i>=(x=(f+g)/2))?f=x:g=x;while((B=L<<2|T<<1|C)===(F=(M>=x)<<2|(S>=b)<<1|E>=v));return a[F]=c,a[B]=u,s}function RW(s){Array.isArray(s)||(s=Array.from(s));const e=s.length,n=new Float64Array(e),i=new Float64Array(e),o=new Float64Array(e);let a=1/0,c=1/0,u=1/0,h=-1/0,d=-1/0,f=-1/0;for(let p=0,A,g,v,b;p<e;++p)isNaN(g=+this._x.call(null,A=s[p]))||isNaN(v=+this._y.call(null,A))||isNaN(b=+this._z.call(null,A))||(n[p]=g,i[p]=v,o[p]=b,g<a&&(a=g),g>h&&(h=g),v<c&&(c=v),v>d&&(d=v),b<u&&(u=b),b>f&&(f=b));if(a>h||c>d||u>f)return this;this.cover(a,c,u).cover(h,d,f);for(let p=0;p<e;++p)WB(this,n[p],i[p],o[p],s[p]);return this}function IW(s,e,n){if(isNaN(s=+s)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,o=this._y0,a=this._z0,c=this._x1,u=this._y1,h=this._z1;if(isNaN(i))c=(i=Math.floor(s))+1,u=(o=Math.floor(e))+1,h=(a=Math.floor(n))+1;else{for(var d=c-i||1,f=this._root,p,A;i>s||s>=c||o>e||e>=u||a>n||n>=h;)switch(A=(n<a)<<2|(e<o)<<1|s<i,p=new Array(8),p[A]=f,f=p,d*=2,A){case 0:c=i+d,u=o+d,h=a+d;break;case 1:i=c-d,u=o+d,h=a+d;break;case 2:c=i+d,o=u-d,h=a+d;break;case 3:i=c-d,o=u-d,h=a+d;break;case 4:c=i+d,u=o+d,a=h-d;break;case 5:i=c-d,u=o+d,a=h-d;break;case 6:c=i+d,o=u-d,a=h-d;break;case 7:i=c-d,o=u-d,a=h-d;break}this._root&&this._root.length&&(this._root=f)}return this._x0=i,this._y0=o,this._z0=a,this._x1=c,this._y1=u,this._z1=h,this}function BW(){var s=[];return this.visit(function(e){if(!e.length)do s.push(e.data);while(e=e.next)}),s}function LW(s){return arguments.length?this.cover(+s[0][0],+s[0][1],+s[0][2]).cover(+s[1][0],+s[1][1],+s[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Tr(s,e,n,i,o,a,c){this.node=s,this.x0=e,this.y0=n,this.z0=i,this.x1=o,this.y1=a,this.z1=c}function PW(s,e,n,i){var o,a=this._x0,c=this._y0,u=this._z0,h,d,f,p,A,g,v=this._x1,b=this._y1,x=this._z1,E=[],S=this._root,M,C;for(S&&E.push(new Tr(S,a,c,u,v,b,x)),i==null?i=1/0:(a=s-i,c=e-i,u=n-i,v=s+i,b=e+i,x=n+i,i*=i);M=E.pop();)if(!(!(S=M.node)||(h=M.x0)>v||(d=M.y0)>b||(f=M.z0)>x||(p=M.x1)<a||(A=M.y1)<c||(g=M.z1)<u))if(S.length){var T=(h+p)/2,L=(d+A)/2,B=(f+g)/2;E.push(new Tr(S[7],T,L,B,p,A,g),new Tr(S[6],h,L,B,T,A,g),new Tr(S[5],T,d,B,p,L,g),new Tr(S[4],h,d,B,T,L,g),new Tr(S[3],T,L,f,p,A,B),new Tr(S[2],h,L,f,T,A,B),new Tr(S[1],T,d,f,p,L,B),new Tr(S[0],h,d,f,T,L,B)),(C=(n>=B)<<2|(e>=L)<<1|s>=T)&&(M=E[E.length-1],E[E.length-1]=E[E.length-1-C],E[E.length-1-C]=M)}else{var F=s-+this._x.call(null,S.data),D=e-+this._y.call(null,S.data),P=n-+this._z.call(null,S.data),U=F*F+D*D+P*P;if(U<i){var K=Math.sqrt(i=U);a=s-K,c=e-K,u=n-K,v=s+K,b=e+K,x=n+K,o=S.data}}return o}function DW(s){if(isNaN(A=+this._x.call(null,s))||isNaN(g=+this._y.call(null,s))||isNaN(v=+this._z.call(null,s)))return this;var e,n=this._root,i,o,a,c=this._x0,u=this._y0,h=this._z0,d=this._x1,f=this._y1,p=this._z1,A,g,v,b,x,E,S,M,C,T,L;if(!n)return this;if(n.length)for(;;){if((S=A>=(b=(c+d)/2))?c=b:d=b,(M=g>=(x=(u+f)/2))?u=x:f=x,(C=v>=(E=(h+p)/2))?h=E:p=E,e=n,!(n=n[T=C<<2|M<<1|S]))return this;if(!n.length)break;(e[T+1&7]||e[T+2&7]||e[T+3&7]||e[T+4&7]||e[T+5&7]||e[T+6&7]||e[T+7&7])&&(i=e,L=T)}for(;n.data!==s;)if(o=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,o?(a?o.next=a:delete o.next,this):e?(a?e[T]=a:delete e[T],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[L]=n:this._root=n),this):(this._root=a,this)}function OW(s){for(var e=0,n=s.length;e<n;++e)this.remove(s[e]);return this}function FW(){return this._root}function NW(){var s=0;return this.visit(function(e){if(!e.length)do++s;while(e=e.next)}),s}function UW(s){var e=[],n,i=this._root,o,a,c,u,h,d,f;for(i&&e.push(new Tr(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!s(i=n.node,a=n.x0,c=n.y0,u=n.z0,h=n.x1,d=n.y1,f=n.z1)&&i.length){var p=(a+h)/2,A=(c+d)/2,g=(u+f)/2;(o=i[7])&&e.push(new Tr(o,p,A,g,h,d,f)),(o=i[6])&&e.push(new Tr(o,a,A,g,p,d,f)),(o=i[5])&&e.push(new Tr(o,p,c,g,h,A,f)),(o=i[4])&&e.push(new Tr(o,a,c,g,p,A,f)),(o=i[3])&&e.push(new Tr(o,p,A,u,h,d,g)),(o=i[2])&&e.push(new Tr(o,a,A,u,p,d,g)),(o=i[1])&&e.push(new Tr(o,p,c,u,h,A,g)),(o=i[0])&&e.push(new Tr(o,a,c,u,p,A,g))}return this}function kW(s){var e=[],n=[],i;for(this._root&&e.push(new Tr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var o=i.node;if(o.length){var a,c=i.x0,u=i.y0,h=i.z0,d=i.x1,f=i.y1,p=i.z1,A=(c+d)/2,g=(u+f)/2,v=(h+p)/2;(a=o[0])&&e.push(new Tr(a,c,u,h,A,g,v)),(a=o[1])&&e.push(new Tr(a,A,u,h,d,g,v)),(a=o[2])&&e.push(new Tr(a,c,g,h,A,f,v)),(a=o[3])&&e.push(new Tr(a,A,g,h,d,f,v)),(a=o[4])&&e.push(new Tr(a,c,u,v,A,g,p)),(a=o[5])&&e.push(new Tr(a,A,u,v,d,g,p)),(a=o[6])&&e.push(new Tr(a,c,g,v,A,f,p)),(a=o[7])&&e.push(new Tr(a,A,g,v,d,f,p))}n.push(i)}for(;i=n.pop();)s(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function zW(s){return s[0]}function GW(s){return arguments.length?(this._x=s,this):this._x}function VW(s){return s[1]}function HW(s){return arguments.length?(this._y=s,this):this._y}function jW(s){return s[2]}function WW(s){return arguments.length?(this._z=s,this):this._z}function QB(s,e,n,i){var o=new ew(e??zW,n??VW,i??jW,NaN,NaN,NaN,NaN,NaN,NaN);return s==null?o:o.addAll(s)}function ew(s,e,n,i,o,a,c,u,h){this._x=s,this._y=e,this._z=n,this._x0=i,this._y0=o,this._z0=a,this._x1=c,this._y1=u,this._z1=h,this._root=void 0}function O3(s){for(var e={data:s.data},n=e;s=s.next;)n=n.next={data:s.data};return e}var Zs=QB.prototype=ew.prototype;Zs.copy=function(){var s=new ew(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,i;if(!e)return s;if(!e.length)return s._root=O3(e),s;for(n=[{source:e,target:s._root=new Array(8)}];e=n.pop();)for(var o=0;o<8;++o)(i=e.source[o])&&(i.length?n.push({source:i,target:e.target[o]=new Array(8)}):e.target[o]=O3(i));return s};Zs.add=TW;Zs.addAll=RW;Zs.cover=IW;Zs.data=BW;Zs.extent=LW;Zs.find=PW;Zs.remove=DW;Zs.removeAll=OW;Zs.root=FW;Zs.size=NW;Zs.visit=UW;Zs.visitAfter=kW;Zs.x=GW;Zs.y=HW;Zs.z=WW;function Xl(s){return function(){return s}}function Hl(s){return(s()-.5)*1e-6}function QW(s){return s.index}function F3(s,e){var n=s.get(e);if(!n)throw new Error("node not found: "+e);return n}function XB(s){var e=QW,n=A,i,o=Xl(30),a,c,u,h,d,f,p=1;s==null&&(s=[]);function A(E){return 1/Math.min(h[E.source.index],h[E.target.index])}function g(E){for(var S=0,M=s.length;S<p;++S)for(var C=0,T,L,B,F=0,D=0,P=0,U,K;C<M;++C)T=s[C],L=T.source,B=T.target,F=B.x+B.vx-L.x-L.vx||Hl(f),u>1&&(D=B.y+B.vy-L.y-L.vy||Hl(f)),u>2&&(P=B.z+B.vz-L.z-L.vz||Hl(f)),U=Math.sqrt(F*F+D*D+P*P),U=(U-a[C])/U*E*i[C],F*=U,D*=U,P*=U,B.vx-=F*(K=d[C]),u>1&&(B.vy-=D*K),u>2&&(B.vz-=P*K),L.vx+=F*(K=1-K),u>1&&(L.vy+=D*K),u>2&&(L.vz+=P*K)}function v(){if(c){var E,S=c.length,M=s.length,C=new Map(c.map((L,B)=>[e(L,B,c),L])),T;for(E=0,h=new Array(S);E<M;++E)T=s[E],T.index=E,typeof T.source!="object"&&(T.source=F3(C,T.source)),typeof T.target!="object"&&(T.target=F3(C,T.target)),h[T.source.index]=(h[T.source.index]||0)+1,h[T.target.index]=(h[T.target.index]||0)+1;for(E=0,d=new Array(M);E<M;++E)T=s[E],d[E]=h[T.source.index]/(h[T.source.index]+h[T.target.index]);i=new Array(M),b(),a=new Array(M),x()}}function b(){if(c)for(var E=0,S=s.length;E<S;++E)i[E]=+n(s[E],E,s)}function x(){if(c)for(var E=0,S=s.length;E<S;++E)a[E]=+o(s[E],E,s)}return g.initialize=function(E,...S){c=E,f=S.find(M=>typeof M=="function")||Math.random,u=S.find(M=>[1,2,3].includes(M))||2,v()},g.links=function(E){return arguments.length?(s=E,v(),g):s},g.id=function(E){return arguments.length?(e=E,g):e},g.iterations=function(E){return arguments.length?(p=+E,g):p},g.strength=function(E){return arguments.length?(n=typeof E=="function"?E:Xl(+E),b(),g):n},g.distance=function(E){return arguments.length?(o=typeof E=="function"?E:Xl(+E),x(),g):o},g}var XW={value:()=>{}};function Rm(){for(var s=0,e=arguments.length,n={},i;s<e;++s){if(!(i=arguments[s]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new ev(n)}function ev(s){this._=s}function KW(s,e){return s.trim().split(/^|\s+/).map(function(n){var i="",o=n.indexOf(".");if(o>=0&&(i=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}ev.prototype=Rm.prototype={constructor:ev,on:function(s,e){var n=this._,i=KW(s+"",n),o,a=-1,c=i.length;if(arguments.length<2){for(;++a<c;)if((o=(s=i[a]).type)&&(o=qW(n[o],s.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<c;)if(o=(s=i[a]).type)n[o]=N3(n[o],s.name,e);else if(e==null)for(o in n)n[o]=N3(n[o],s.name,null);return this},copy:function(){var s={},e=this._;for(var n in e)s[n]=e[n].slice();return new ev(s)},call:function(s,e){if((o=arguments.length-2)>0)for(var n=new Array(o),i=0,o,a;i<o;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(a=this._[s],i=0,o=a.length;i<o;++i)a[i].value.apply(e,n)},apply:function(s,e,n){if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(var i=this._[s],o=0,a=i.length;o<a;++o)i[o].value.apply(e,n)}};function qW(s,e){for(var n=0,i=s.length,o;n<i;++n)if((o=s[n]).name===e)return o.value}function N3(s,e,n){for(var i=0,o=s.length;i<o;++i)if(s[i].name===e){s[i]=XW,s=s.slice(0,i).concat(s.slice(i+1));break}return n!=null&&s.push({name:e,value:n}),s}var mf=0,Wp=0,Bp=0,KB=1e3,yv,Qp,xv=0,lu=0,Zv=0,mm=typeof performance=="object"&&performance.now?performance:Date,qB=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(s){setTimeout(s,17)};function tw(){return lu||(qB(YW),lu=mm.now()+Zv)}function YW(){lu=0}function Ev(){this._call=this._time=this._next=null}Ev.prototype=nw.prototype={constructor:Ev,restart:function(s,e,n){if(typeof s!="function")throw new TypeError("callback is not a function");n=(n==null?tw():+n)+(e==null?0:+e),!this._next&&Qp!==this&&(Qp?Qp._next=this:yv=this,Qp=this),this._call=s,this._time=n,Qb()},stop:function(){this._call&&(this._call=null,this._time=1/0,Qb())}};function nw(s,e,n){var i=new Ev;return i.restart(s,e,n),i}function $W(){tw(),++mf;for(var s=yv,e;s;)(e=lu-s._time)>=0&&s._call.call(void 0,e),s=s._next;--mf}function U3(){lu=(xv=mm.now())+Zv,mf=Wp=0;try{$W()}finally{mf=0,ZW(),lu=0}}function JW(){var s=mm.now(),e=s-xv;e>KB&&(Zv-=e,xv=s)}function ZW(){for(var s,e=yv,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),s=e,e=e._next):(n=e._next,e._next=null,e=s?s._next=n:yv=n);Qp=s,Qb(i)}function Qb(s){if(!mf){Wp&&(Wp=clearTimeout(Wp));var e=s-lu;e>24?(s<1/0&&(Wp=setTimeout(U3,s-mm.now()-Zv)),Bp&&(Bp=clearInterval(Bp))):(Bp||(xv=mm.now(),Bp=setInterval(JW,KB)),mf=1,qB(U3))}}function k3(s,e,n){var i=new Ev;return e=e==null?0:+e,i.restart(o=>{i.stop(),s(o+e)},e,n),i}const eQ=1664525,tQ=1013904223,z3=4294967296;function nQ(){let s=1;return()=>(s=(eQ*s+tQ)%z3)/z3}var G3=3;function jE(s){return s.x}function V3(s){return s.y}function iQ(s){return s.z}var rQ=10,sQ=Math.PI*(3-Math.sqrt(5)),oQ=Math.PI*20/(9+Math.sqrt(221));function YB(s,e){e=e||2;var n=Math.min(G3,Math.max(1,Math.round(e))),i,o=1,a=.001,c=1-Math.pow(a,1/300),u=0,h=.6,d=new Map,f=nw(g),p=Rm("tick","end"),A=nQ();s==null&&(s=[]);function g(){v(),p.call("tick",i),o<a&&(f.stop(),p.call("end",i))}function v(E){var S,M=s.length,C;E===void 0&&(E=1);for(var T=0;T<E;++T)for(o+=(u-o)*c,d.forEach(function(L){L(o)}),S=0;S<M;++S)C=s[S],C.fx==null?C.x+=C.vx*=h:(C.x=C.fx,C.vx=0),n>1&&(C.fy==null?C.y+=C.vy*=h:(C.y=C.fy,C.vy=0)),n>2&&(C.fz==null?C.z+=C.vz*=h:(C.z=C.fz,C.vz=0));return i}function b(){for(var E=0,S=s.length,M;E<S;++E){if(M=s[E],M.index=E,M.fx!=null&&(M.x=M.fx),M.fy!=null&&(M.y=M.fy),M.fz!=null&&(M.z=M.fz),isNaN(M.x)||n>1&&isNaN(M.y)||n>2&&isNaN(M.z)){var C=rQ*(n>2?Math.cbrt(.5+E):n>1?Math.sqrt(.5+E):E),T=E*sQ,L=E*oQ;n===1?M.x=C:n===2?(M.x=C*Math.cos(T),M.y=C*Math.sin(T)):(M.x=C*Math.sin(T)*Math.cos(L),M.y=C*Math.cos(T),M.z=C*Math.sin(T)*Math.sin(L))}(isNaN(M.vx)||n>1&&isNaN(M.vy)||n>2&&isNaN(M.vz))&&(M.vx=0,n>1&&(M.vy=0),n>2&&(M.vz=0))}}function x(E){return E.initialize&&E.initialize(s,A,n),E}return b(),i={tick:v,restart:function(){return f.restart(g),i},stop:function(){return f.stop(),i},numDimensions:function(E){return arguments.length?(n=Math.min(G3,Math.max(1,Math.round(E))),d.forEach(x),i):n},nodes:function(E){return arguments.length?(s=E,b(),d.forEach(x),i):s},alpha:function(E){return arguments.length?(o=+E,i):o},alphaMin:function(E){return arguments.length?(a=+E,i):a},alphaDecay:function(E){return arguments.length?(c=+E,i):+c},alphaTarget:function(E){return arguments.length?(u=+E,i):u},velocityDecay:function(E){return arguments.length?(h=1-E,i):1-h},randomSource:function(E){return arguments.length?(A=E,d.forEach(x),i):A},force:function(E,S){return arguments.length>1?(S==null?d.delete(E):d.set(E,x(S)),i):d.get(E)},find:function(){var E=Array.prototype.slice.call(arguments),S=E.shift()||0,M=(n>1?E.shift():null)||0,C=(n>2?E.shift():null)||0,T=E.shift()||1/0,L=0,B=s.length,F,D,P,U,K,J;for(T*=T,L=0;L<B;++L)K=s[L],F=S-K.x,D=M-(K.y||0),P=C-(K.z||0),U=F*F+D*D+P*P,U<T&&(J=K,T=U);return J},on:function(E,S){return arguments.length>1?(p.on(E,S),i):p.on(E)}}}function $B(){var s,e,n,i,o,a=Xl(-30),c,u=1,h=1/0,d=.81;function f(v){var b,x=s.length,E=(e===1?VB(s,jE):e===2?jB(s,jE,V3):e===3?QB(s,jE,V3,iQ):null).visitAfter(A);for(o=v,b=0;b<x;++b)n=s[b],E.visit(g)}function p(){if(s){var v,b=s.length,x;for(c=new Array(b),v=0;v<b;++v)x=s[v],c[x.index]=+a(x,v,s)}}function A(v){var b=0,x,E,S=0,M,C,T,L,B=v.length;if(B){for(M=C=T=L=0;L<B;++L)(x=v[L])&&(E=Math.abs(x.value))&&(b+=x.value,S+=E,M+=E*(x.x||0),C+=E*(x.y||0),T+=E*(x.z||0));b*=Math.sqrt(4/B),v.x=M/S,e>1&&(v.y=C/S),e>2&&(v.z=T/S)}else{x=v,x.x=x.data.x,e>1&&(x.y=x.data.y),e>2&&(x.z=x.data.z);do b+=c[x.data.index];while(x=x.next)}v.value=b}function g(v,b,x,E,S){if(!v.value)return!0;var M=[x,E,S][e-1],C=v.x-n.x,T=e>1?v.y-n.y:0,L=e>2?v.z-n.z:0,B=M-b,F=C*C+T*T+L*L;if(B*B/d<F)return F<h&&(C===0&&(C=Hl(i),F+=C*C),e>1&&T===0&&(T=Hl(i),F+=T*T),e>2&&L===0&&(L=Hl(i),F+=L*L),F<u&&(F=Math.sqrt(u*F)),n.vx+=C*v.value*o/F,e>1&&(n.vy+=T*v.value*o/F),e>2&&(n.vz+=L*v.value*o/F)),!0;if(v.length||F>=h)return;(v.data!==n||v.next)&&(C===0&&(C=Hl(i),F+=C*C),e>1&&T===0&&(T=Hl(i),F+=T*T),e>2&&L===0&&(L=Hl(i),F+=L*L),F<u&&(F=Math.sqrt(u*F)));do v.data!==n&&(B=c[v.data.index]*o/F,n.vx+=C*B,e>1&&(n.vy+=T*B),e>2&&(n.vz+=L*B));while(v=v.next)}return f.initialize=function(v,...b){s=v,i=b.find(x=>typeof x=="function")||Math.random,e=b.find(x=>[1,2,3].includes(x))||2,p()},f.strength=function(v){return arguments.length?(a=typeof v=="function"?v:Xl(+v),p(),f):a},f.distanceMin=function(v){return arguments.length?(u=v*v,f):Math.sqrt(u)},f.distanceMax=function(v){return arguments.length?(h=v*v,f):Math.sqrt(h)},f.theta=function(v){return arguments.length?(d=v*v,f):Math.sqrt(d)},f}function JB(s,e,n,i){var o,a,c=Xl(.1),u,h;typeof s!="function"&&(s=Xl(+s)),e==null&&(e=0),n==null&&(n=0),i==null&&(i=0);function d(p){for(var A=0,g=o.length;A<g;++A){var v=o[A],b=v.x-e||1e-6,x=(v.y||0)-n||1e-6,E=(v.z||0)-i||1e-6,S=Math.sqrt(b*b+x*x+E*E),M=(h[A]-S)*u[A]*p/S;v.vx+=b*M,a>1&&(v.vy+=x*M),a>2&&(v.vz+=E*M)}}function f(){if(o){var p,A=o.length;for(u=new Array(A),h=new Array(A),p=0;p<A;++p)h[p]=+s(o[p],p,o),u[p]=isNaN(h[p])?0:+c(o[p],p,o)}}return d.initialize=function(p,...A){o=p,a=A.find(g=>[1,2,3].includes(g))||2,f()},d.strength=function(p){return arguments.length?(c=typeof p=="function"?p:Xl(+p),f(),d):c},d.radius=function(p){return arguments.length?(s=typeof p=="function"?p:Xl(+p),f(),d):s},d.x=function(p){return arguments.length?(e=+p,d):e},d.y=function(p){return arguments.length?(n=+p,d):n},d.z=function(p){return arguments.length?(i=+p,d):i},d}var iw=function(e){lQ(e);var n=aQ(e);return e.on=n.on,e.off=n.off,e.fire=n.fire,e};function aQ(s){var e=Object.create(null);return{on:function(n,i,o){if(typeof i!="function")throw new Error("callback is expected to be a function");var a=e[n];return a||(a=e[n]=[]),a.push({callback:i,ctx:o}),s},off:function(n,i){var o=typeof n>"u";if(o)return e=Object.create(null),s;if(e[n]){var a=typeof i!="function";if(a)delete e[n];else for(var c=e[n],u=0;u<c.length;++u)c[u].callback===i&&c.splice(u,1)}return s},fire:function(n){var i=e[n];if(!i)return s;var o;arguments.length>1&&(o=Array.prototype.splice.call(arguments,1));for(var a=0;a<i.length;++a){var c=i[a];c.callback.apply(c.ctx,o)}return s}}}function lQ(s){if(!s)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],n=0;n<e.length;++n)if(s.hasOwnProperty(e[n]))throw new Error("Subject cannot be eventified, since it already has property '"+e[n]+"'")}var cQ=uQ,hQ=iw;function uQ(s){if(s=s||{},"uniqueLinkId"in s&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),s.multigraph=s.uniqueLinkId),s.multigraph===void 0&&(s.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,n=new Map,i={},o=0,a=s.multigraph?C:M,c=[],u=G,h=G,d=G,f=G,p={version:20,addNode:b,addLink:S,removeLink:F,removeNode:E,getNode:x,getNodeCount:T,getLinkCount:L,getEdgeCount:L,getLinksCount:L,getNodesCount:T,getLinks:B,forEachNode:Z,forEachLinkedNode:J,forEachLink:K,beginUpdate:d,endUpdate:f,clear:U,hasLink:P,hasNode:x,getLink:P};return hQ(p),A(),p;function A(){var ee=p.on;p.on=oe;function oe(){return p.beginUpdate=d=H,p.endUpdate=f=te,u=g,h=v,p.on=ee,ee.apply(p,arguments)}}function g(ee,oe){c.push({link:ee,changeType:oe})}function v(ee,oe){c.push({node:ee,changeType:oe})}function b(ee,oe){if(ee===void 0)throw new Error("Invalid node identifier");d();var xe=x(ee);return xe?(xe.data=oe,h(xe,"update")):(xe=new dQ(ee,oe),h(xe,"add")),e.set(ee,xe),f(),xe}function x(ee){return e.get(ee)}function E(ee){var oe=x(ee);if(!oe)return!1;d();var xe=oe.links;return xe&&(xe.forEach(D),oe.links=null),e.delete(ee),h(oe,"remove"),f(),!0}function S(ee,oe,xe){d();var Pe=x(ee)||b(ee),me=x(oe)||b(oe),Ce=a(ee,oe,xe),Je=n.has(Ce.id);return n.set(Ce.id,Ce),H3(Pe,Ce),ee!==oe&&H3(me,Ce),u(Ce,Je?"update":"add"),f(),Ce}function M(ee,oe,xe){var Pe=B0(ee,oe),me=n.get(Pe);return me?(me.data=xe,me):new j3(ee,oe,xe,Pe)}function C(ee,oe,xe){var Pe=B0(ee,oe),me=i.hasOwnProperty(Pe);if(me||P(ee,oe)){me||(i[Pe]=0);var Ce="@"+ ++i[Pe];Pe=B0(ee+Ce,oe+Ce)}return new j3(ee,oe,xe,Pe)}function T(){return e.size}function L(){return n.size}function B(ee){var oe=x(ee);return oe?oe.links:null}function F(ee,oe){return oe!==void 0&&(ee=P(ee,oe)),D(ee)}function D(ee){if(!ee||!n.get(ee.id))return!1;d(),n.delete(ee.id);var oe=x(ee.fromId),xe=x(ee.toId);return oe&&oe.links.delete(ee),xe&&xe.links.delete(ee),u(ee,"remove"),f(),!0}function P(ee,oe){if(!(ee===void 0||oe===void 0))return n.get(B0(ee,oe))}function U(){d(),Z(function(ee){E(ee.id)}),f()}function K(ee){if(typeof ee=="function")for(var oe=n.values(),xe=oe.next();!xe.done;){if(ee(xe.value))return!0;xe=oe.next()}}function J(ee,oe,xe){var Pe=x(ee);if(Pe&&Pe.links&&typeof oe=="function")return xe?j(Pe.links,ee,oe):z(Pe.links,ee,oe)}function z(ee,oe,xe){for(var Pe,me=ee.values(),Ce=me.next();!Ce.done;){var Je=Ce.value,Oe=Je.fromId===oe?Je.toId:Je.fromId;if(Pe=xe(e.get(Oe),Je),Pe)return!0;Ce=me.next()}}function j(ee,oe,xe){for(var Pe,me=ee.values(),Ce=me.next();!Ce.done;){var Je=Ce.value;if(Je.fromId===oe&&(Pe=xe(e.get(Je.toId),Je),Pe))return!0;Ce=me.next()}}function G(){}function H(){o+=1}function te(){o-=1,o===0&&c.length>0&&(p.fire("changed",c),c.length=0)}function Z(ee){if(typeof ee!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+ee);for(var oe=e.values(),xe=oe.next();!xe.done;){if(ee(xe.value))return!0;xe=oe.next()}}}function dQ(s,e){this.id=s,this.links=null,this.data=e}function H3(s,e){s.links?s.links.add(e):s.links=new Set([e])}function j3(s,e,n,i){this.fromId=s,this.toId=e,this.data=n,this.id=i}function B0(s,e){return s.toString()+"👉 "+e.toString()}const fQ=w_(cQ);var rw={exports:{}},Im={exports:{}},ZB=function(e){return e===0?"x":e===1?"y":e===2?"z":"c"+(e+1)};const pQ=ZB;var _f=function(e){return n;function n(i,o){let a=o&&o.indent||0,c=o&&o.join!==void 0?o.join:`
`,u=Array(a+1).join(" "),h=[];for(let d=0;d<e;++d){let f=pQ(d),p=d===0?"":u;h.push(p+i.replace(/{var}/g,f))}return h.join(c)}};const eL=_f;Im.exports=mQ;Im.exports.generateCreateBodyFunctionBody=tL;Im.exports.getVectorCode=iL;Im.exports.getBodyCode=nL;function mQ(s,e){let n=tL(s,e),{Body:i}=new Function(n)();return i}function tL(s,e){return`
${iL(s,e)}
${nL(s)}
return {Body: Body, Vector: Vector};
`}function nL(s){let e=eL(s),n=e("{var}",{join:", "});return`
function Body(${n}) {
  this.isPinned = false;
  this.pos = new Vector(${n});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${n}) {
  ${e("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function iL(s,e){let n=eL(s),i="";return e&&(i=`${n(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${n("{var}",{join:", "})}) {
  ${i}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${n('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${n("this.{var} = v.{var};",{indent:4})}
    } else {
      ${n('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${n("this.{var} = ",{join:""})}0;
  };`}var gQ=Im.exports,eh={exports:{}};const sw=_f,Fc=ZB;eh.exports=AQ;eh.exports.generateQuadTreeFunctionBody=rL;eh.exports.getInsertStackCode=cL;eh.exports.getQuadNodeCode=lL;eh.exports.isSamePosition=sL;eh.exports.getChildBodyCode=aL;eh.exports.setChildBodyCode=oL;function AQ(s){let e=rL(s);return new Function(e)()}function rL(s){let e=sw(s),n=Math.pow(2,s);return`
${cL()}
${lL(s)}
${sL(s)}
${aL(s)}
${oL(s)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${c("      node.")}
      node.body = null;
      node.mass = ${e("node.mass_{var} = ",{join:""})}0;
      ${e("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${e("var d{var};",{indent:4})}
    var r; 
    ${e("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${e("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${e("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${e("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < θ, treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${Fc(0)} - node.min_${Fc(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${e("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${a()}
        }
      }
    }

    ${e("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${e("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${e("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${e("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${e("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${e("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${e("root.min_{var} = {var}min;",{indent:4})}
    ${e("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${e("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${e("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${e("var min_{var} = node.min_{var};",{indent:8})}
        ${e("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${o(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${e("child.min_{var} = min_{var};",{indent:10})}
          ${e("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${e("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${e("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function o(u){let h=[],d=Array(u+1).join(" ");for(let f=0;f<s;++f)h.push(d+`if (${Fc(f)} > max_${Fc(f)}) {`),h.push(d+`  quadIdx = quadIdx + ${Math.pow(2,f)};`),h.push(d+`  min_${Fc(f)} = max_${Fc(f)};`),h.push(d+`  max_${Fc(f)} = node.max_${Fc(f)};`),h.push(d+"}");return h.join(`
`)}function a(){let u=Array(11).join(" "),h=[];for(let d=0;d<n;++d)h.push(u+`if (node.quad${d}) {`),h.push(u+`  queue[pushIdx] = node.quad${d};`),h.push(u+"  queueLength += 1;"),h.push(u+"  pushIdx += 1;"),h.push(u+"}");return h.join(`
`)}function c(u){let h=[];for(let d=0;d<n;++d)h.push(`${u}quad${d} = null;`);return h.join(`
`)}}function sL(s){let e=sw(s);return`
  function isSamePosition(point1, point2) {
    ${e("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${e("d{var} < 1e-8",{join:" && "})};
  }  
`}function oL(s){var e=Math.pow(2,s);return`
function setChild(node, idx, child) {
  ${n()}
}`;function n(){let i=[];for(let o=0;o<e;++o){let a=o===0?"  ":"  else ";i.push(`${a}if (idx === ${o}) node.quad${o} = child;`)}return i.join(`
`)}}function aL(s){return`function getChild(node, idx) {
${e()}
  return null;
}`;function e(){let n=[],i=Math.pow(2,s);for(let o=0;o<i;++o)n.push(`  if (idx === ${o}) return node.quad${o};`);return n.join(`
`)}}function lL(s){let e=sw(s),n=Math.pow(2,s);var i=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${o("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${e("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${e("this.min_{var} = 0;",{indent:2})}
  ${e("this.max_{var} = 0;",{indent:2})}
}
`;return i;function o(a){let c=[];for(let u=0;u<n;++u)c.push(`${a}quad${u} = null;`);return c.join(`
`)}}function cL(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}var vQ=eh.exports,ow={exports:{}};ow.exports=xQ;ow.exports.generateFunctionBody=hL;const yQ=_f;function xQ(s){let e=hL(s);return new Function("bodies","settings","random",e)}function hL(s){let e=yQ(s);return`
  var boundingBox = {
    ${e("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${e("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${e("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${e("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${e("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${e("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${e("var max_{var} = -Infinity;",{indent:4})}
    ${e("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${e("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${e("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${e("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${e("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${e("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}var EQ=ow.exports,aw={exports:{}};const bQ=_f;aw.exports=_Q;aw.exports.generateCreateDragForceFunctionBody=uL;function _Q(s){let e=uL(s);return new Function("options",e)}function uL(s){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${bQ(s)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}var wQ=aw.exports,lw={exports:{}};const MQ=_f;lw.exports=CQ;lw.exports.generateCreateSpringForceFunctionBody=dL;function CQ(s){let e=dL(s);return new Function("options","random",e)}function dL(s){let e=MQ(s);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${e("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${e("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${e("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}var SQ=lw.exports,cw={exports:{}};const TQ=_f;cw.exports=RQ;cw.exports.generateIntegratorFunctionBody=fL;function RQ(s){let e=fL(s);return new Function("bodies","timeStep","adaptiveTimeStepWeight",e)}function fL(s){let e=TQ(s);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${e("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${e("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${e("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${e("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${e("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${e("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${e("body.pos.{var} += d{var};",{indent:4})}

    ${e("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${e("t{var} * t{var}",{join:" + "})})/length;
`}var IQ=cw.exports,WE,W3;function BQ(){if(W3)return WE;W3=1,WE=s;function s(e,n,i,o){this.from=e,this.to=n,this.length=i,this.coefficient=o}return WE}var QE,Q3;function LQ(){if(Q3)return QE;Q3=1,QE=s;function s(e,n){var i;if(e||(e={}),n){for(i in n)if(n.hasOwnProperty(i)){var o=e.hasOwnProperty(i),a=typeof n[i],c=!o||typeof e[i]!==a;c?e[i]=n[i]:a==="object"&&(e[i]=s(e[i],n[i]))}}return e}return QE}var Lp={exports:{}},X3;function PQ(){if(X3)return Lp.exports;X3=1,Lp.exports=s,Lp.exports.random=s,Lp.exports.randomIterator=u;function s(h){var d=typeof h=="number"?h:+new Date;return new e(d)}function e(h){this.seed=h}e.prototype.next=c,e.prototype.nextDouble=a,e.prototype.uniform=a,e.prototype.gaussian=n;function n(){var h,d,f;do d=this.nextDouble()*2-1,f=this.nextDouble()*2-1,h=d*d+f*f;while(h>=1||h===0);return d*Math.sqrt(-2*Math.log(h)/h)}e.prototype.levy=i;function i(){var h=1.5,d=Math.pow(o(1+h)*Math.sin(Math.PI*h/2)/(o((1+h)/2)*h*Math.pow(2,(h-1)/2)),1/h);return this.gaussian()*d/Math.pow(Math.abs(this.gaussian()),1/h)}function o(h){return Math.sqrt(2*Math.PI/h)*Math.pow(1/Math.E*(h+1/(12*h-1/(10*h))),h)}function a(){var h=this.seed;return h=h+2127912214+(h<<12)&4294967295,h=(h^3345072700^h>>>19)&4294967295,h=h+374761393+(h<<5)&4294967295,h=(h+3550635116^h<<9)&4294967295,h=h+4251993797+(h<<3)&4294967295,h=(h^3042594569^h>>>16)&4294967295,this.seed=h,(h&268435455)/268435456}function c(h){return Math.floor(this.nextDouble()*h)}function u(h,d){var f=d||s();if(typeof f.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:A,shuffle:p};function p(){var g,v,b;for(g=h.length-1;g>0;--g)v=f.next(g+1),b=h[v],h[v]=h[g],h[g]=b;return h}function A(g){var v,b,x;for(v=h.length-1;v>0;--v)b=f.next(v+1),x=h[b],h[b]=h[v],h[v]=x,g(x);h.length&&g(h[0])}}return Lp.exports}var pL=zQ,DQ=gQ,OQ=vQ,FQ=EQ,NQ=wQ,UQ=SQ,kQ=IQ,K3={};function zQ(s){var e=BQ(),n=LQ(),i=iw;if(s){if(s.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(s.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}s=n(s,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var o=K3[s.dimensions];if(!o){var a=s.dimensions;o={Body:DQ(a,s.debug),createQuadTree:OQ(a),createBounds:FQ(a),createDragForce:NQ(a),createSpringForce:UQ(a),integrate:kQ(a)},K3[a]=o}var c=o.Body,u=o.createQuadTree,h=o.createBounds,d=o.createDragForce,f=o.createSpringForce,p=o.integrate,A=j=>new c(j),g=PQ().random(42),v=[],b=[],x=u(s,g),E=h(v,s,g),S=f(s,g),M=d(s),C=0,T=[],L=new Map,B=0;P("nbody",J),P("spring",z);var F={bodies:v,quadTree:x,springs:b,settings:s,addForce:P,removeForce:U,getForces:K,step:function(){for(var j=0;j<T.length;++j)T[j](B);var G=p(v,s.timeStep,s.adaptiveTimeStepWeight);return B+=1,G},addBody:function(j){if(!j)throw new Error("Body is required");return v.push(j),j},addBodyAt:function(j){if(!j)throw new Error("Body position is required");var G=A(j);return v.push(G),G},removeBody:function(j){if(j){var G=v.indexOf(j);if(!(G<0))return v.splice(G,1),v.length===0&&E.reset(),!0}},addSpring:function(j,G,H,te){if(!j||!G)throw new Error("Cannot add null spring to force simulator");typeof H!="number"&&(H=-1);var Z=new e(j,G,H,te>=0?te:-1);return b.push(Z),Z},getTotalMovement:function(){return C},removeSpring:function(j){if(j){var G=b.indexOf(j);if(G>-1)return b.splice(G,1),!0}},getBestNewBodyPosition:function(j){return E.getBestNewPosition(j)},getBBox:D,getBoundingBox:D,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(j){return j!==void 0?(s.gravity=j,x.options({gravity:j}),this):s.gravity},theta:function(j){return j!==void 0?(s.theta=j,x.options({theta:j}),this):s.theta},random:g};return GQ(s,F),i(F),F;function D(){return E.update(),E.box}function P(j,G){if(L.has(j))throw new Error("Force "+j+" is already added");L.set(j,G),T.push(G)}function U(j){var G=T.indexOf(L.get(j));G<0||(T.splice(G,1),L.delete(j))}function K(){return L}function J(){if(v.length!==0){x.insertBodies(v);for(var j=v.length;j--;){var G=v[j];G.isPinned||(G.reset(),x.updateBodyForce(G),M.update(G))}}}function z(){for(var j=b.length;j--;)S.update(b[j])}}function GQ(s,e){for(var n in s)VQ(s,e,n)}function VQ(s,e,n){if(s.hasOwnProperty(n)&&typeof e[n]!="function"){var i=Number.isFinite(s[n]);i?e[n]=function(o){if(o!==void 0){if(!Number.isFinite(o))throw new Error("Value of "+n+" should be a valid number.");return s[n]=o,e}return s[n]}:e[n]=function(o){return o!==void 0?(s[n]=o,e):s[n]}}}rw.exports=jQ;rw.exports.simulator=pL;var HQ=iw;function jQ(s,e){if(!s)throw new Error("Graph structure cannot be undefined");var n=e&&e.createSimulator||pL,i=n(e);if(Array.isArray(e))throw new Error("Physics settings is expected to be an object");var o=s.version>19?J:K;e&&typeof e.nodeMass=="function"&&(o=e.nodeMass);var a=new Map,c={},u=0,h=i.settings.springTransform||WQ;M(),x();var d=!1,f={step:function(){if(u===0)return p(!0),!0;var z=i.step();f.lastMove=z,f.fire("step");var j=z/u,G=j<=.01;return p(G),G},getNodePosition:function(z){return U(z).pos},setNodePosition:function(z){var j=U(z);j.setPosition.apply(j,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(z){var j=c[z];if(j)return{from:j.from.pos,to:j.to.pos}},getGraphRect:function(){return i.getBBox()},forEachBody:A,pinNode:function(z,j){var G=U(z.id);G.isPinned=!!j},isNodePinned:function(z){return U(z.id).isPinned},dispose:function(){s.off("changed",S),f.fire("disposed")},getBody:b,getSpring:v,getForceVectorLength:g,simulator:i,graph:s,lastMove:0};return HQ(f),f;function p(z){d!==z&&(d=z,E(z))}function A(z){a.forEach(z)}function g(){var z=0,j=0;return A(function(G){z+=Math.abs(G.force.x),j+=Math.abs(G.force.y)}),Math.sqrt(z*z+j*j)}function v(z,j){var G;if(j===void 0)typeof z!="object"?G=z:G=z.id;else{var H=s.hasLink(z,j);if(!H)return;G=H.id}return c[G]}function b(z){return a.get(z)}function x(){s.on("changed",S)}function E(z){f.fire("stable",z)}function S(z){for(var j=0;j<z.length;++j){var G=z[j];G.changeType==="add"?(G.node&&C(G.node.id),G.link&&L(G.link)):G.changeType==="remove"&&(G.node&&T(G.node),G.link&&B(G.link))}u=s.getNodesCount()}function M(){u=0,s.forEachNode(function(z){C(z.id),u+=1}),s.forEachLink(L)}function C(z){var j=a.get(z);if(!j){var G=s.getNode(z);if(!G)throw new Error("initBody() was called with unknown node id");var H=G.position;if(!H){var te=F(G);H=i.getBestNewBodyPosition(te)}j=i.addBodyAt(H),j.id=z,a.set(z,j),D(z),P(G)&&(j.isPinned=!0)}}function T(z){var j=z.id,G=a.get(j);G&&(a.delete(j),i.removeBody(G))}function L(z){D(z.fromId),D(z.toId);var j=a.get(z.fromId),G=a.get(z.toId),H=i.addSpring(j,G,z.length);h(z,H),c[z.id]=H}function B(z){var j=c[z.id];if(j){var G=s.getNode(z.fromId),H=s.getNode(z.toId);G&&D(G.id),H&&D(H.id),delete c[z.id],i.removeSpring(j)}}function F(z){var j=[];if(!z.links)return j;for(var G=Math.min(z.links.length,2),H=0;H<G;++H){var te=z.links[H],Z=te.fromId!==z.id?a.get(te.fromId):a.get(te.toId);Z&&Z.pos&&j.push(Z)}return j}function D(z){var j=a.get(z);if(j.mass=o(z),Number.isNaN(j.mass))throw new Error("Node mass should be a number")}function P(z){return z&&(z.isPinned||z.data&&z.data.isPinned)}function U(z){var j=a.get(z);return j||(C(z),j=a.get(z)),j}function K(z){var j=s.getLinks(z);return j?1+j.length/3:1}function J(z){var j=s.getLinks(z);return j?1+j.size/3:1}}function WQ(){}var QQ=rw.exports;const XQ=w_(QQ);function bv(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}var KQ=typeof global=="object"&&global&&global.Object===Object&&global,qQ=typeof self=="object"&&self&&self.Object===Object&&self,mL=KQ||qQ||Function("return this")(),XE=function(){return mL.Date.now()},YQ=/\s/;function $Q(s){for(var e=s.length;e--&&YQ.test(s.charAt(e)););return e}var JQ=/^\s+/;function ZQ(s){return s&&s.slice(0,$Q(s)+1).replace(JQ,"")}var _v=mL.Symbol,gL=Object.prototype,eX=gL.hasOwnProperty,tX=gL.toString,Pp=_v?_v.toStringTag:void 0;function nX(s){var e=eX.call(s,Pp),n=s[Pp];try{s[Pp]=void 0;var i=!0}catch{}var o=tX.call(s);return i&&(e?s[Pp]=n:delete s[Pp]),o}var iX=Object.prototype,rX=iX.toString;function sX(s){return rX.call(s)}var oX="[object Null]",aX="[object Undefined]",q3=_v?_v.toStringTag:void 0;function lX(s){return s==null?s===void 0?aX:oX:q3&&q3 in Object(s)?nX(s):sX(s)}function cX(s){return s!=null&&typeof s=="object"}var hX="[object Symbol]";function uX(s){return typeof s=="symbol"||cX(s)&&lX(s)==hX}var Y3=NaN,dX=/^[-+]0x[0-9a-f]+$/i,fX=/^0b[01]+$/i,pX=/^0o[0-7]+$/i,mX=parseInt;function $3(s){if(typeof s=="number")return s;if(uX(s))return Y3;if(bv(s)){var e=typeof s.valueOf=="function"?s.valueOf():s;s=bv(e)?e+"":e}if(typeof s!="string")return s===0?s:+s;s=ZQ(s);var n=fX.test(s);return n||pX.test(s)?mX(s.slice(2),n?2:8):dX.test(s)?Y3:+s}var gX="Expected a function",AX=Math.max,vX=Math.min;function AL(s,e,n){var i,o,a,c,u,h,d=0,f=!1,p=!1,A=!0;if(typeof s!="function")throw new TypeError(gX);e=$3(e)||0,bv(n)&&(f=!!n.leading,p="maxWait"in n,a=p?AX($3(n.maxWait)||0,e):a,A="trailing"in n?!!n.trailing:A);function g(L){var B=i,F=o;return i=o=void 0,d=L,c=s.apply(F,B),c}function v(L){return d=L,u=setTimeout(E,e),f?g(L):c}function b(L){var B=L-h,F=L-d,D=e-B;return p?vX(D,a-F):D}function x(L){var B=L-h,F=L-d;return h===void 0||B>=e||B<0||p&&F>=a}function E(){var L=XE();if(x(L))return S(L);u=setTimeout(E,b(L))}function S(L){return u=void 0,A&&i?g(L):(i=o=void 0,c)}function M(){u!==void 0&&clearTimeout(u),d=0,i=h=o=u=void 0}function C(){return u===void 0?c:S(XE())}function T(){var L=XE(),B=x(L);if(i=arguments,o=this,h=L,B){if(u===void 0)return v(h);if(p)return clearTimeout(u),u=setTimeout(E,e),g(h)}return u===void 0&&(u=setTimeout(E,e)),c}return T.cancel=M,T.flush=C,T}function yX(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function xX(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function J3(s,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,SX(i.key),i)}}function EX(s,e,n){return e&&J3(s.prototype,e),n&&J3(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s}function bX(s,e){return _X(s)||yX(s,e)||wX(s,e)||MX()}function _X(s){if(Array.isArray(s))return s}function wX(s,e){if(s){if(typeof s=="string")return Z3(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z3(s,e)}}function Z3(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function MX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CX(s,e){if(typeof s!="object"||s===null)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function SX(s){var e=CX(s,"string");return typeof e=="symbol"?e:String(e)}var TX=EX(function s(e,n){var i=n.default,o=i===void 0?null:i,a=n.triggerUpdate,c=a===void 0?!0:a,u=n.onChange,h=u===void 0?function(d,f){}:u;xX(this,s),this.name=e,this.defaultVal=o,this.triggerUpdate=c,this.onChange=h});function du(s){var e=s.stateInit,n=e===void 0?function(){return{}}:e,i=s.props,o=i===void 0?{}:i,a=s.methods,c=a===void 0?{}:a,u=s.aliases,h=u===void 0?{}:u,d=s.init,f=d===void 0?function(){}:d,p=s.update,A=p===void 0?function(){}:p,g=Object.keys(o).map(function(v){return new TX(v,o[v])});return function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=Object.assign({},n instanceof Function?n(v):n,{initialised:!1}),x={};function E(C){return S(C,v),M(),E}var S=function(T,L){f.call(E,T,b,L),b.initialised=!0},M=AL(function(){b.initialised&&(A.call(E,b,x),x={})},1);return g.forEach(function(C){E[C.name]=T(C);function T(L){var B=L.name,F=L.triggerUpdate,D=F===void 0?!1:F,P=L.onChange,U=P===void 0?function(z,j){}:P,K=L.defaultVal,J=K===void 0?null:K;return function(z){var j=b[B];if(!arguments.length)return j;var G=z===void 0?J:z;return b[B]=G,U.call(E,G,b,j),!x.hasOwnProperty(B)&&(x[B]=j),D&&M(),E}}}),Object.keys(c).forEach(function(C){E[C]=function(){for(var T,L=arguments.length,B=new Array(L),F=0;F<L;F++)B[F]=arguments[F];return(T=c[C]).call.apply(T,[E,b].concat(B))}}),Object.entries(h).forEach(function(C){var T=bX(C,2),L=T[0],B=T[1];return E[L]=E[B]}),E.resetProps=function(){return g.forEach(function(C){E[C.name](C.defaultVal)}),E},E.resetProps(),b._rerender=M,E}}class eR extends Map{constructor(e,n=BX){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,o]of e)this.set(i,o)}get(e){return super.get(tR(this,e))}has(e){return super.has(tR(this,e))}set(e,n){return super.set(RX(this,e),n)}delete(e){return super.delete(IX(this,e))}}function tR({_intern:s,_key:e},n){const i=e(n);return s.has(i)?s.get(i):n}function RX({_intern:s,_key:e},n){const i=e(n);return s.has(i)?s.get(i):(s.set(i,n),n)}function IX({_intern:s,_key:e},n){const i=e(n);return s.has(i)&&(n=s.get(i),s.delete(i)),n}function BX(s){return s!==null&&typeof s=="object"?s.valueOf():s}function Xb(s,e){let n;if(e===void 0)for(const i of s)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let o of s)(o=e(o,++i,s))!=null&&(n<o||n===void 0&&o>=o)&&(n=o)}return n}function Kb(s,e){let n;if(e===void 0)for(const i of s)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let o of s)(o=e(o,++i,s))!=null&&(n>o||n===void 0&&o>=o)&&(n=o)}return n}function LX(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function PX(s,e){if(s==null)return{};var n={},i=Object.keys(s),o,a;for(a=0;a<i.length;a++)o=i[a],!(e.indexOf(o)>=0)&&(n[o]=s[o]);return n}function DX(s,e){if(s==null)return{};var n=PX(s,e),i,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);for(o=0;o<a.length;o++)i=a[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(n[i]=s[i])}return n}function OX(s,e){return UX(s)||LX(s,e)||vL(s,e)||GX()}function FX(s){return NX(s)||kX(s)||vL(s)||zX()}function NX(s){if(Array.isArray(s))return qb(s)}function UX(s){if(Array.isArray(s))return s}function kX(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function vL(s,e){if(s){if(typeof s=="string")return qb(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qb(s,e)}}function qb(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function zX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VX(s,e){if(typeof s!="object"||s===null)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function HX(s){var e=VX(s,"string");return typeof e=="symbol"?e:String(e)}var Yb=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(u){return{keyAccessor:u,isProp:!(u instanceof Function)}}),a=s.reduce(function(u,h){var d=u,f=h;return o.forEach(function(p,A){var g=p.keyAccessor,v=p.isProp,b;if(v){var x=f,E=x[g],S=DX(x,[g].map(HX));b=E,f=S}else b=g(f,A);A+1<o.length?(d.hasOwnProperty(b)||(d[b]={}),d=d[b]):n?(d.hasOwnProperty(b)||(d[b]=[]),d[b].push(f)):d[b]=f}),u},{});n instanceof Function&&function u(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;d===o.length?Object.keys(h).forEach(function(f){return h[f]=n(h[f])}):Object.values(h).forEach(function(f){return u(f,d+1)})}(a);var c=a;return i&&(c=[],function u(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];d.length===o.length?c.push({keys:d,vals:h}):Object.entries(h).forEach(function(f){var p=OX(f,2),A=p[0],g=p[1];return u(g,[].concat(FX(d),[A]))})}(a),e instanceof Array&&e.length===0&&c.length===1&&(c[0].keys=[])),c};function jX(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function nR(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),n.push.apply(n,i)}return n}function WX(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nR(Object(n),!0).forEach(function(i){yL(s,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):nR(Object(n)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(n,i))})}return s}function yL(s,e,n){return e=eK(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function QX(s,e){if(s==null)return{};var n={},i=Object.keys(s),o,a;for(a=0;a<i.length;a++)o=i[a],!(e.indexOf(o)>=0)&&(n[o]=s[o]);return n}function XX(s,e){if(s==null)return{};var n=QX(s,e),i,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);for(o=0;o<a.length;o++)i=a[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(n[i]=s[i])}return n}function xL(s,e){return qX(s)||jX(s,e)||EL(s,e)||JX()}function wv(s){return KX(s)||YX(s)||EL(s)||$X()}function KX(s){if(Array.isArray(s))return $b(s)}function qX(s){if(Array.isArray(s))return s}function YX(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function EL(s,e){if(s){if(typeof s=="string")return $b(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $b(s,e)}}function $b(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function $X(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZX(s,e){if(typeof s!="object"||s===null)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function eK(s){var e=ZX(s,"string");return typeof e=="symbol"?e:String(e)}var tK=["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"];function nK(s,e,n){var i={enter:[],update:[],exit:[]};if(n){var c=Yb(s,n,!1),u=Yb(e,n,!1),h=Object.assign({},c,u);Object.entries(h).forEach(function(d){var f=xL(d,2),p=f[0],A=f[1],g=c.hasOwnProperty(p)?u.hasOwnProperty(p)?"update":"exit":"enter";i[g].push(g==="update"?[c[p],u[p]]:A)})}else{var o=new Set(s),a=new Set(e);new Set([].concat(wv(o),wv(a))).forEach(function(d){var f=o.has(d)?a.has(d)?"update":"exit":"enter";i[f].push(f==="update"?[d,d]:d)})}return i}function iK(s,e,n){var i=n.objBindAttr,o=i===void 0?"__obj":i,a=n.dataBindAttr,c=a===void 0?"__data":a,u=n.idAccessor,h=n.purge,d=h===void 0?!1:h,f=function(x){return x.hasOwnProperty(c)},p=e.filter(function(b){return!f(b)}),A=e.filter(f).map(function(b){return b[c]}),g=s,v=d?{enter:g,exit:A,update:[]}:nK(A,g,u);return v.update=v.update.map(function(b){var x=xL(b,2),E=x[0],S=x[1];return E!==S&&(S[o]=E[o],S[o][c]=S),S}),v.exit=v.exit.concat(p.map(function(b){return yL({},o,b)})),v}function rK(s,e,n,i,o){var a=o.createObj,c=a===void 0?function(F){return{}}:a,u=o.updateObj,h=u===void 0?function(F,D){}:u,d=o.exitObj,f=d===void 0?function(F){}:d,p=o.objBindAttr,A=p===void 0?"__obj":p,g=o.dataBindAttr,v=g===void 0?"__data":g,b=XX(o,tK),x=iK(s,e,WX({objBindAttr:A,dataBindAttr:v},b)),E=x.enter,S=x.update,M=x.exit;M.forEach(function(F){var D=F[A];delete F[A],f(D),i(D)});var C=L(E),T=[].concat(wv(E),wv(S));B(T),C.forEach(n);function L(F){var D=[];return F.forEach(function(P){var U=c(P);U&&(U[v]=P,P[A]=U,D.push(U))}),D}function B(F){F.forEach(function(D){var P=D[A];P&&(P[v]=D,h(P,D))})}}function sK(s,e){switch(arguments.length){case 0:break;case 1:this.range(s);break;default:this.range(e).domain(s);break}return this}const iR=Symbol("implicit");function hw(){var s=new eR,e=[],n=[],i=iR;function o(a){let c=s.get(a);if(c===void 0){if(i!==iR)return i;s.set(a,c=e.push(a)-1)}return n[c%n.length]}return o.domain=function(a){if(!arguments.length)return e.slice();e=[],s=new eR;for(const c of a)s.has(c)||s.set(c,e.push(c)-1);return o},o.range=function(a){return arguments.length?(n=Array.from(a),o):n.slice()},o.unknown=function(a){return arguments.length?(i=a,o):i},o.copy=function(){return hw(e,n).unknown(i)},sK.apply(o,arguments),o}function uw(s,e,n){s.prototype=e.prototype=n,n.constructor=s}function bL(s,e){var n=Object.create(s.prototype);for(var i in e)n[i]=e[i];return n}function Bm(){}var gm=.7,Mv=1/gm,lf="\\s*([+-]?\\d+)\\s*",Am="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oK=/^#([0-9a-f]{3,8})$/,aK=new RegExp(`^rgb\\(${lf},${lf},${lf}\\)$`),lK=new RegExp(`^rgb\\(${tl},${tl},${tl}\\)$`),cK=new RegExp(`^rgba\\(${lf},${lf},${lf},${Am}\\)$`),hK=new RegExp(`^rgba\\(${tl},${tl},${tl},${Am}\\)$`),uK=new RegExp(`^hsl\\(${Am},${tl},${tl}\\)$`),dK=new RegExp(`^hsla\\(${Am},${tl},${tl},${Am}\\)$`),rR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};uw(Bm,vm,{copy(s){return Object.assign(new this.constructor,this,s)},displayable(){return this.rgb().displayable()},hex:sR,formatHex:sR,formatHex8:fK,formatHsl:pK,formatRgb:oR,toString:oR});function sR(){return this.rgb().formatHex()}function fK(){return this.rgb().formatHex8()}function pK(){return _L(this).formatHsl()}function oR(){return this.rgb().formatRgb()}function vm(s){var e,n;return s=(s+"").trim().toLowerCase(),(e=oK.exec(s))?(n=e[1].length,e=parseInt(e[1],16),n===6?aR(e):n===3?new Io(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?L0(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?L0(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=aK.exec(s))?new Io(e[1],e[2],e[3],1):(e=lK.exec(s))?new Io(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=cK.exec(s))?L0(e[1],e[2],e[3],e[4]):(e=hK.exec(s))?L0(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=uK.exec(s))?hR(e[1],e[2]/100,e[3]/100,1):(e=dK.exec(s))?hR(e[1],e[2]/100,e[3]/100,e[4]):rR.hasOwnProperty(s)?aR(rR[s]):s==="transparent"?new Io(NaN,NaN,NaN,0):null}function aR(s){return new Io(s>>16&255,s>>8&255,s&255,1)}function L0(s,e,n,i){return i<=0&&(s=e=n=NaN),new Io(s,e,n,i)}function mK(s){return s instanceof Bm||(s=vm(s)),s?(s=s.rgb(),new Io(s.r,s.g,s.b,s.opacity)):new Io}function Jb(s,e,n,i){return arguments.length===1?mK(s):new Io(s,e,n,i??1)}function Io(s,e,n,i){this.r=+s,this.g=+e,this.b=+n,this.opacity=+i}uw(Io,Jb,bL(Bm,{brighter(s){return s=s==null?Mv:Math.pow(Mv,s),new Io(this.r*s,this.g*s,this.b*s,this.opacity)},darker(s){return s=s==null?gm:Math.pow(gm,s),new Io(this.r*s,this.g*s,this.b*s,this.opacity)},rgb(){return this},clamp(){return new Io(ru(this.r),ru(this.g),ru(this.b),Cv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:lR,formatHex:lR,formatHex8:gK,formatRgb:cR,toString:cR}));function lR(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}`}function gK(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}${Jh((isNaN(this.opacity)?1:this.opacity)*255)}`}function cR(){const s=Cv(this.opacity);return`${s===1?"rgb(":"rgba("}${ru(this.r)}, ${ru(this.g)}, ${ru(this.b)}${s===1?")":`, ${s})`}`}function Cv(s){return isNaN(s)?1:Math.max(0,Math.min(1,s))}function ru(s){return Math.max(0,Math.min(255,Math.round(s)||0))}function Jh(s){return s=ru(s),(s<16?"0":"")+s.toString(16)}function hR(s,e,n,i){return i<=0?s=e=n=NaN:n<=0||n>=1?s=e=NaN:e<=0&&(s=NaN),new Na(s,e,n,i)}function _L(s){if(s instanceof Na)return new Na(s.h,s.s,s.l,s.opacity);if(s instanceof Bm||(s=vm(s)),!s)return new Na;if(s instanceof Na)return s;s=s.rgb();var e=s.r/255,n=s.g/255,i=s.b/255,o=Math.min(e,n,i),a=Math.max(e,n,i),c=NaN,u=a-o,h=(a+o)/2;return u?(e===a?c=(n-i)/u+(n<i)*6:n===a?c=(i-e)/u+2:c=(e-n)/u+4,u/=h<.5?a+o:2-a-o,c*=60):u=h>0&&h<1?0:c,new Na(c,u,h,s.opacity)}function AK(s,e,n,i){return arguments.length===1?_L(s):new Na(s,e,n,i??1)}function Na(s,e,n,i){this.h=+s,this.s=+e,this.l=+n,this.opacity=+i}uw(Na,AK,bL(Bm,{brighter(s){return s=s==null?Mv:Math.pow(Mv,s),new Na(this.h,this.s,this.l*s,this.opacity)},darker(s){return s=s==null?gm:Math.pow(gm,s),new Na(this.h,this.s,this.l*s,this.opacity)},rgb(){var s=this.h%360+(this.h<0)*360,e=isNaN(s)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new Io(KE(s>=240?s-240:s+120,o,i),KE(s,o,i),KE(s<120?s+240:s-120,o,i),this.opacity)},clamp(){return new Na(uR(this.h),P0(this.s),P0(this.l),Cv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const s=Cv(this.opacity);return`${s===1?"hsl(":"hsla("}${uR(this.h)}, ${P0(this.s)*100}%, ${P0(this.l)*100}%${s===1?")":`, ${s})`}`}}));function uR(s){return s=(s||0)%360,s<0?s+360:s}function P0(s){return Math.max(0,Math.min(1,s||0))}function KE(s,e,n){return(s<60?e+(n-e)*s/60:s<180?n:s<240?e+(n-e)*(240-s)/60:e)*255}const wL=s=>()=>s;function vK(s,e){return function(n){return s+n*e}}function yK(s,e,n){return s=Math.pow(s,n),e=Math.pow(e,n)-s,n=1/n,function(i){return Math.pow(s+i*e,n)}}function xK(s){return(s=+s)==1?ML:function(e,n){return n-e?yK(e,n,s):wL(isNaN(e)?n:e)}}function ML(s,e){var n=e-s;return n?vK(s,n):wL(isNaN(s)?e:s)}const dR=function s(e){var n=xK(e);function i(o,a){var c=n((o=Jb(o)).r,(a=Jb(a)).r),u=n(o.g,a.g),h=n(o.b,a.b),d=ML(o.opacity,a.opacity);return function(f){return o.r=c(f),o.g=u(f),o.b=h(f),o.opacity=d(f),o+""}}return i.gamma=s,i}(1);function Gc(s,e){return s=+s,e=+e,function(n){return s*(1-n)+e*n}}var Zb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qE=new RegExp(Zb.source,"g");function EK(s){return function(){return s}}function bK(s){return function(e){return s(e)+""}}function _K(s,e){var n=Zb.lastIndex=qE.lastIndex=0,i,o,a,c=-1,u=[],h=[];for(s=s+"",e=e+"";(i=Zb.exec(s))&&(o=qE.exec(e));)(a=o.index)>n&&(a=e.slice(n,a),u[c]?u[c]+=a:u[++c]=a),(i=i[0])===(o=o[0])?u[c]?u[c]+=o:u[++c]=o:(u[++c]=null,h.push({i:c,x:Gc(i,o)})),n=qE.lastIndex;return n<e.length&&(a=e.slice(n),u[c]?u[c]+=a:u[++c]=a),u.length<2?h[0]?bK(h[0].x):EK(e):(e=h.length,function(d){for(var f=0,p;f<e;++f)u[(p=h[f]).i]=p.x(d);return u.join("")})}var fR=180/Math.PI,e_={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function CL(s,e,n,i,o,a){var c,u,h;return(c=Math.sqrt(s*s+e*e))&&(s/=c,e/=c),(h=s*n+e*i)&&(n-=s*h,i-=e*h),(u=Math.sqrt(n*n+i*i))&&(n/=u,i/=u,h/=u),s*i<e*n&&(s=-s,e=-e,h=-h,c=-c),{translateX:o,translateY:a,rotate:Math.atan2(e,s)*fR,skewX:Math.atan(h)*fR,scaleX:c,scaleY:u}}var D0;function wK(s){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(s+"");return e.isIdentity?e_:CL(e.a,e.b,e.c,e.d,e.e,e.f)}function MK(s){return s==null||(D0||(D0=document.createElementNS("http://www.w3.org/2000/svg","g")),D0.setAttribute("transform",s),!(s=D0.transform.baseVal.consolidate()))?e_:(s=s.matrix,CL(s.a,s.b,s.c,s.d,s.e,s.f))}function SL(s,e,n,i){function o(d){return d.length?d.pop()+" ":""}function a(d,f,p,A,g,v){if(d!==p||f!==A){var b=g.push("translate(",null,e,null,n);v.push({i:b-4,x:Gc(d,p)},{i:b-2,x:Gc(f,A)})}else(p||A)&&g.push("translate("+p+e+A+n)}function c(d,f,p,A){d!==f?(d-f>180?f+=360:f-d>180&&(d+=360),A.push({i:p.push(o(p)+"rotate(",null,i)-2,x:Gc(d,f)})):f&&p.push(o(p)+"rotate("+f+i)}function u(d,f,p,A){d!==f?A.push({i:p.push(o(p)+"skewX(",null,i)-2,x:Gc(d,f)}):f&&p.push(o(p)+"skewX("+f+i)}function h(d,f,p,A,g,v){if(d!==p||f!==A){var b=g.push(o(g)+"scale(",null,",",null,")");v.push({i:b-4,x:Gc(d,p)},{i:b-2,x:Gc(f,A)})}else(p!==1||A!==1)&&g.push(o(g)+"scale("+p+","+A+")")}return function(d,f){var p=[],A=[];return d=s(d),f=s(f),a(d.translateX,d.translateY,f.translateX,f.translateY,p,A),c(d.rotate,f.rotate,p,A),u(d.skewX,f.skewX,p,A),h(d.scaleX,d.scaleY,f.scaleX,f.scaleY,p,A),d=f=null,function(g){for(var v=-1,b=A.length,x;++v<b;)p[(x=A[v]).i]=x.x(g);return p.join("")}}}var CK=SL(wK,"px, ","px)","deg)"),SK=SL(MK,", ",")",")"),TK=1e-12;function pR(s){return((s=Math.exp(s))+1/s)/2}function RK(s){return((s=Math.exp(s))-1/s)/2}function IK(s){return((s=Math.exp(2*s))-1)/(s+1)}const BK=function s(e,n,i){function o(a,c){var u=a[0],h=a[1],d=a[2],f=c[0],p=c[1],A=c[2],g=f-u,v=p-h,b=g*g+v*v,x,E;if(b<TK)E=Math.log(A/d)/e,x=function(B){return[u+B*g,h+B*v,d*Math.exp(e*B*E)]};else{var S=Math.sqrt(b),M=(A*A-d*d+i*b)/(2*d*n*S),C=(A*A-d*d-i*b)/(2*A*n*S),T=Math.log(Math.sqrt(M*M+1)-M),L=Math.log(Math.sqrt(C*C+1)-C);E=(L-T)/e,x=function(B){var F=B*E,D=pR(T),P=d/(n*S)*(D*IK(e*F+T)-RK(T));return[u+P*g,h+P*v,d*D/pR(e*F+T)]}}return x.duration=E*1e3*e/Math.SQRT2,x}return o.rho=function(a){var c=Math.max(.001,+a),u=c*c,h=u*u;return s(c,u,h)},o}(Math.SQRT2,2,4);function LK(s){for(var e=s.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+s.slice(i*6,++i*6);return n}const TL=LK("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function Sv(s){"@babel/helpers - typeof";return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sv(s)}var PK=/^\s+/,DK=/\s+$/;function ci(s,e){if(s=s||"",e=e||{},s instanceof ci)return s;if(!(this instanceof ci))return new ci(s,e);var n=OK(s);this._originalInput=s,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}ci.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,i,o,a,c,u;return n=e.r/255,i=e.g/255,o=e.b/255,n<=.03928?a=n/12.92:a=Math.pow((n+.055)/1.055,2.4),i<=.03928?c=i/12.92:c=Math.pow((i+.055)/1.055,2.4),o<=.03928?u=o/12.92:u=Math.pow((o+.055)/1.055,2.4),.2126*a+.7152*c+.0722*u},setAlpha:function(e){return this._a=RL(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=gR(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=gR(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),o=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+i+"%, "+o+"%)":"hsva("+n+", "+i+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var e=mR(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=mR(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),o=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+i+"%, "+o+"%)":"hsla("+n+", "+i+"%, "+o+"%, "+this._roundA+")"},toHex:function(e){return AR(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return kK(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(zr(this._r,255)*100)+"%",g:Math.round(zr(this._g,255)*100)+"%",b:Math.round(zr(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(zr(this._r,255)*100)+"%, "+Math.round(zr(this._g,255)*100)+"%, "+Math.round(zr(this._b,255)*100)+"%)":"rgba("+Math.round(zr(this._r,255)*100)+"%, "+Math.round(zr(this._g,255)*100)+"%, "+Math.round(zr(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:$K[AR(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+vR(this._r,this._g,this._b,this._a),i=n,o=this._gradientType?"GradientType = 1, ":"";if(e){var a=ci(e);i="#"+vR(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+n+",endColorstr="+i+")"},toString:function(e){var n=!!e;e=e||this._format;var i=!1,o=this._a<1&&this._a>=0,a=!n&&o&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return a?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return ci(this.toString())},_applyModification:function(e,n){var i=e.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(HK,arguments)},brighten:function(){return this._applyModification(jK,arguments)},darken:function(){return this._applyModification(WK,arguments)},desaturate:function(){return this._applyModification(zK,arguments)},saturate:function(){return this._applyModification(GK,arguments)},greyscale:function(){return this._applyModification(VK,arguments)},spin:function(){return this._applyModification(QK,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(qK,arguments)},complement:function(){return this._applyCombination(XK,arguments)},monochromatic:function(){return this._applyCombination(YK,arguments)},splitcomplement:function(){return this._applyCombination(KK,arguments)},triad:function(){return this._applyCombination(yR,[3])},tetrad:function(){return this._applyCombination(yR,[4])}};ci.fromRatio=function(s,e){if(Sv(s)=="object"){var n={};for(var i in s)s.hasOwnProperty(i)&&(i==="a"?n[i]=s[i]:n[i]=Xp(s[i]));s=n}return ci(s,e)};function OK(s){var e={r:0,g:0,b:0},n=1,i=null,o=null,a=null,c=!1,u=!1;return typeof s=="string"&&(s=tq(s)),Sv(s)=="object"&&(Fl(s.r)&&Fl(s.g)&&Fl(s.b)?(e=FK(s.r,s.g,s.b),c=!0,u=String(s.r).substr(-1)==="%"?"prgb":"rgb"):Fl(s.h)&&Fl(s.s)&&Fl(s.v)?(i=Xp(s.s),o=Xp(s.v),e=UK(s.h,i,o),c=!0,u="hsv"):Fl(s.h)&&Fl(s.s)&&Fl(s.l)&&(i=Xp(s.s),a=Xp(s.l),e=NK(s.h,i,a),c=!0,u="hsl"),s.hasOwnProperty("a")&&(n=s.a)),n=RL(n),{ok:c,format:s.format||u,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function FK(s,e,n){return{r:zr(s,255)*255,g:zr(e,255)*255,b:zr(n,255)*255}}function mR(s,e,n){s=zr(s,255),e=zr(e,255),n=zr(n,255);var i=Math.max(s,e,n),o=Math.min(s,e,n),a,c,u=(i+o)/2;if(i==o)a=c=0;else{var h=i-o;switch(c=u>.5?h/(2-i-o):h/(i+o),i){case s:a=(e-n)/h+(e<n?6:0);break;case e:a=(n-s)/h+2;break;case n:a=(s-e)/h+4;break}a/=6}return{h:a,s:c,l:u}}function NK(s,e,n){var i,o,a;s=zr(s,360),e=zr(e,100),n=zr(n,100);function c(d,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(f-d)*6*p:p<1/2?f:p<2/3?d+(f-d)*(2/3-p)*6:d}if(e===0)i=o=a=n;else{var u=n<.5?n*(1+e):n+e-n*e,h=2*n-u;i=c(h,u,s+1/3),o=c(h,u,s),a=c(h,u,s-1/3)}return{r:i*255,g:o*255,b:a*255}}function gR(s,e,n){s=zr(s,255),e=zr(e,255),n=zr(n,255);var i=Math.max(s,e,n),o=Math.min(s,e,n),a,c,u=i,h=i-o;if(c=i===0?0:h/i,i==o)a=0;else{switch(i){case s:a=(e-n)/h+(e<n?6:0);break;case e:a=(n-s)/h+2;break;case n:a=(s-e)/h+4;break}a/=6}return{h:a,s:c,v:u}}function UK(s,e,n){s=zr(s,360)*6,e=zr(e,100),n=zr(n,100);var i=Math.floor(s),o=s-i,a=n*(1-e),c=n*(1-o*e),u=n*(1-(1-o)*e),h=i%6,d=[n,c,a,a,u,n][h],f=[u,n,n,c,a,a][h],p=[a,a,u,n,n,c][h];return{r:d*255,g:f*255,b:p*255}}function AR(s,e,n,i){var o=[ka(Math.round(s).toString(16)),ka(Math.round(e).toString(16)),ka(Math.round(n).toString(16))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function kK(s,e,n,i,o){var a=[ka(Math.round(s).toString(16)),ka(Math.round(e).toString(16)),ka(Math.round(n).toString(16)),ka(IL(i))];return o&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function vR(s,e,n,i){var o=[ka(IL(i)),ka(Math.round(s).toString(16)),ka(Math.round(e).toString(16)),ka(Math.round(n).toString(16))];return o.join("")}ci.equals=function(s,e){return!s||!e?!1:ci(s).toRgbString()==ci(e).toRgbString()};ci.random=function(){return ci.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function zK(s,e){e=e===0?0:e||10;var n=ci(s).toHsl();return n.s-=e/100,n.s=ey(n.s),ci(n)}function GK(s,e){e=e===0?0:e||10;var n=ci(s).toHsl();return n.s+=e/100,n.s=ey(n.s),ci(n)}function VK(s){return ci(s).desaturate(100)}function HK(s,e){e=e===0?0:e||10;var n=ci(s).toHsl();return n.l+=e/100,n.l=ey(n.l),ci(n)}function jK(s,e){e=e===0?0:e||10;var n=ci(s).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),ci(n)}function WK(s,e){e=e===0?0:e||10;var n=ci(s).toHsl();return n.l-=e/100,n.l=ey(n.l),ci(n)}function QK(s,e){var n=ci(s).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,ci(n)}function XK(s){var e=ci(s).toHsl();return e.h=(e.h+180)%360,ci(e)}function yR(s,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=ci(s).toHsl(),i=[ci(s)],o=360/e,a=1;a<e;a++)i.push(ci({h:(n.h+a*o)%360,s:n.s,l:n.l}));return i}function KK(s){var e=ci(s).toHsl(),n=e.h;return[ci(s),ci({h:(n+72)%360,s:e.s,l:e.l}),ci({h:(n+216)%360,s:e.s,l:e.l})]}function qK(s,e,n){e=e||6,n=n||30;var i=ci(s).toHsl(),o=360/n,a=[ci(s)];for(i.h=(i.h-(o*e>>1)+720)%360;--e;)i.h=(i.h+o)%360,a.push(ci(i));return a}function YK(s,e){e=e||6;for(var n=ci(s).toHsv(),i=n.h,o=n.s,a=n.v,c=[],u=1/e;e--;)c.push(ci({h:i,s:o,v:a})),a=(a+u)%1;return c}ci.mix=function(s,e,n){n=n===0?0:n||50;var i=ci(s).toRgb(),o=ci(e).toRgb(),a=n/100,c={r:(o.r-i.r)*a+i.r,g:(o.g-i.g)*a+i.g,b:(o.b-i.b)*a+i.b,a:(o.a-i.a)*a+i.a};return ci(c)};ci.readability=function(s,e){var n=ci(s),i=ci(e);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)};ci.isReadable=function(s,e,n){var i=ci.readability(s,e),o,a;switch(a=!1,o=nq(n),o.level+o.size){case"AAsmall":case"AAAlarge":a=i>=4.5;break;case"AAlarge":a=i>=3;break;case"AAAsmall":a=i>=7;break}return a};ci.mostReadable=function(s,e,n){var i=null,o=0,a,c,u,h;n=n||{},c=n.includeFallbackColors,u=n.level,h=n.size;for(var d=0;d<e.length;d++)a=ci.readability(s,e[d]),a>o&&(o=a,i=ci(e[d]));return ci.isReadable(s,i,{level:u,size:h})||!c?i:(n.includeFallbackColors=!1,ci.mostReadable(s,["#fff","#000"],n))};var t_=ci.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},$K=ci.hexNames=JK(t_);function JK(s){var e={};for(var n in s)s.hasOwnProperty(n)&&(e[s[n]]=n);return e}function RL(s){return s=parseFloat(s),(isNaN(s)||s<0||s>1)&&(s=1),s}function zr(s,e){ZK(s)&&(s="100%");var n=eq(s);return s=Math.min(e,Math.max(0,parseFloat(s))),n&&(s=parseInt(s*e,10)/100),Math.abs(s-e)<1e-6?1:s%e/parseFloat(e)}function ey(s){return Math.min(1,Math.max(0,s))}function Wo(s){return parseInt(s,16)}function ZK(s){return typeof s=="string"&&s.indexOf(".")!=-1&&parseFloat(s)===1}function eq(s){return typeof s=="string"&&s.indexOf("%")!=-1}function ka(s){return s.length==1?"0"+s:""+s}function Xp(s){return s<=1&&(s=s*100+"%"),s}function IL(s){return Math.round(parseFloat(s)*255).toString(16)}function xR(s){return Wo(s)/255}var Ta=function(){var s="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+s+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",o="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+o),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+o),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+o),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Fl(s){return!!Ta.CSS_UNIT.exec(s)}function tq(s){s=s.replace(PK,"").replace(DK,"").toLowerCase();var e=!1;if(t_[s])s=t_[s],e=!0;else if(s=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=Ta.rgb.exec(s))?{r:n[1],g:n[2],b:n[3]}:(n=Ta.rgba.exec(s))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Ta.hsl.exec(s))?{h:n[1],s:n[2],l:n[3]}:(n=Ta.hsla.exec(s))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Ta.hsv.exec(s))?{h:n[1],s:n[2],v:n[3]}:(n=Ta.hsva.exec(s))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Ta.hex8.exec(s))?{r:Wo(n[1]),g:Wo(n[2]),b:Wo(n[3]),a:xR(n[4]),format:e?"name":"hex8"}:(n=Ta.hex6.exec(s))?{r:Wo(n[1]),g:Wo(n[2]),b:Wo(n[3]),format:e?"name":"hex"}:(n=Ta.hex4.exec(s))?{r:Wo(n[1]+""+n[1]),g:Wo(n[2]+""+n[2]),b:Wo(n[3]+""+n[3]),a:xR(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=Ta.hex3.exec(s))?{r:Wo(n[1]+""+n[1]),g:Wo(n[2]+""+n[2]),b:Wo(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function nq(s){var e,n;return s=s||{level:"AA",size:"small"},e=(s.level||"AA").toUpperCase(),n=(s.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function iq(s,e,n){return e=Tv(e),dq(s,dw()?Reflect.construct(e,n||[],Tv(s).constructor):e.apply(s,n))}function rq(s,e,n){if(dw())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var o=new(s.bind.apply(s,i));return n&&Rv(o,n.prototype),o}function dw(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dw=function(){return!!s})()}function sq(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function ER(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),n.push.apply(n,i)}return n}function BL(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ER(Object(n),!0).forEach(function(i){fw(s,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):ER(Object(n)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(n,i))})}return s}function oq(s,e){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function LL(s){var e=oq(s,"string");return typeof e=="symbol"?e:String(e)}function n_(s){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n_(s)}function aq(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function bR(s,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,LL(i.key),i)}}function lq(s,e,n){return e&&bR(s.prototype,e),n&&bR(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s}function fw(s,e,n){return e=LL(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function cq(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Rv(s,e)}function Tv(s){return Tv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Tv(s)}function Rv(s,e){return Rv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},Rv(s,e)}function hq(s,e){if(s==null)return{};var n={},i=Object.keys(s),o,a;for(a=0;a<i.length;a++)o=i[a],!(e.indexOf(o)>=0)&&(n[o]=s[o]);return n}function uq(s,e){if(s==null)return{};var n=hq(s,e),i,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);for(o=0;o<a.length;o++)i=a[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(n[i]=s[i])}return n}function PL(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function dq(s,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PL(s)}function _R(s,e){return pq(s)||sq(s,e)||DL(s,e)||Aq()}function Ba(s){return fq(s)||mq(s)||DL(s)||gq()}function fq(s){if(Array.isArray(s))return i_(s)}function pq(s){if(Array.isArray(s))return s}function mq(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function DL(s,e){if(s){if(typeof s=="string")return i_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i_(s,e)}}function i_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function gq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var vq=function s(e){e instanceof Array?e.forEach(s):(e.map&&e.map.dispose(),e.dispose())},yq=function s(e){e.geometry&&e.geometry.dispose(),e.material&&vq(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(s)},r_=function(e){for(;e.children.length;){var n=e.children[0];e.remove(n),yq(n)}},xq=["objFilter"];function Dp(s,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.objFilter,o=i===void 0?function(){return!0}:i,a=uq(n,xq);return rK(s,e.children.filter(o),function(c){return e.add(c)},function(c){e.remove(c),r_(c)},BL({objBindAttr:"__threeObj"},a))}var Op=function(e){return isNaN(e)?parseInt(ci(e).toHex(),16):e},YE=function(e){return isNaN(e)?ci(e).getAlpha():1},Eq=hw(TL);function wR(s,e,n){!e||typeof n!="string"||s.filter(function(i){return!i[n]}).forEach(function(i){i[n]=Eq(e(i))})}function bq(s,e){var n=s.nodes,i=s.links,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.nodeFilter,c=a===void 0?function(){return!0}:a,u=o.onLoopError,h=u===void 0?function(g){throw"Invalid DAG structure! Found cycle in node path: ".concat(g.join(" -> "),".")}:u,d={};n.forEach(function(g){return d[e(g)]={data:g,out:[],depth:-1,skip:!c(g)}}),i.forEach(function(g){var v=g.source,b=g.target,x=C(v),E=C(b);if(!d.hasOwnProperty(x))throw"Missing source node with id: ".concat(x);if(!d.hasOwnProperty(E))throw"Missing target node with id: ".concat(E);var S=d[x],M=d[E];S.out.push(M);function C(T){return n_(T)==="object"?e(T):T}});var f=[];A(Object.values(d));var p=Object.assign.apply(Object,[{}].concat(Ba(Object.entries(d).filter(function(g){var v=_R(g,2),b=v[1];return!b.skip}).map(function(g){var v=_R(g,2),b=v[0],x=v[1];return fw({},b,x.depth)}))));return p;function A(g){for(var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=function(){var C=g[E];if(v.indexOf(C)!==-1){var T=[].concat(Ba(v.slice(v.indexOf(C))),[C]).map(function(L){return e(L.data)});return f.some(function(L){return L.length===T.length&&L.every(function(B,F){return B===T[F]})})||(f.push(T),h(T)),1}b>C.depth&&(C.depth=b,A(C.out,[].concat(Ba(v),[C]),b+(C.skip?0:1)))},E=0,S=g.length;E<S;E++)x()}}var Mi=window.THREE?window.THREE:{Group:ef,Mesh:Qo,MeshLambertMaterial:Hj,Color:or,BufferGeometry:Lo,BufferAttribute:ha,Matrix4:Gr,Vector3:it,SphereGeometry:Tm,CylinderGeometry:Jv,TubeGeometry:Y_,ConeGeometry:q_,Line:Sj,LineBasicMaterial:DB,QuadraticBezierCurve3:K_,CubicBezierCurve3:FB,Box3:hu},MR={graph:fQ,forcelayout:XQ},_q=2,CR=new Mi.BufferGeometry().setAttribute?"setAttribute":"addAttribute",O0=new Mi.BufferGeometry().applyMatrix4?"applyMatrix4":"applyMatrix",wq=du({props:{jsonUrl:{onChange:function(e,n){var i=this;e&&!n.fetchingJson&&(n.fetchingJson=!0,n.onLoading(),fetch(e).then(function(o){return o.json()}).then(function(o){n.fetchingJson=!1,n.onFinishLoading(o),i.graphData(o)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1}},numDimensions:{default:3,onChange:function(e,n){var i=n.d3ForceLayout.force("charge");i&&i.strength(e>2?-60:-30),e<3&&o(n.graphData.nodes,"z"),e<2&&o(n.graphData.nodes,"y");function o(a,c){a.forEach(function(u){delete u[c],delete u["v".concat(c)]})}}},dagMode:{onChange:function(e,n){!e&&n.forceEngine==="d3"&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=i.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},nodePositionUpdate:{triggerUpdate:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.velocityDecay(e)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(e){return e._flushObjects=!0,e._rerender(),this},d3Force:function(e,n,i){return i===void 0?e.d3ForceLayout.force(n):(e.d3ForceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},tickFrame:function(e){var n=e.forceEngine!=="ngraph";return e.engineRunning&&i(),o(),a(),this;function i(){++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||n&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.layout[n?"tick":"step"](),e.onEngineTick());var c=ri(e.nodeThreeObjectExtend);e.graphData.nodes.forEach(function(A){var g=A.__threeObj;if(g){var v=n?A:e.layout.getNodePosition(A[e.nodeId]),b=c(A);(!e.nodePositionUpdate||!e.nodePositionUpdate(b?g.children[0]:g,{x:v.x,y:v.y,z:v.z},A)||b)&&(g.position.x=v.x,g.position.y=v.y||0,g.position.z=v.z||0)}});var u=ri(e.linkWidth),h=ri(e.linkCurvature),d=ri(e.linkCurveRotation),f=ri(e.linkThreeObjectExtend);e.graphData.links.forEach(function(A){var g=A.__lineObj;if(g){var v=n?A:e.layout.getLinkPosition(e.layout.graph.getLink(A.source,A.target).id),b=v[n?"source":"from"],x=v[n?"target":"to"];if(!(!b||!x||!b.hasOwnProperty("x")||!x.hasOwnProperty("x"))){p(A);var E=f(A);if(!(e.linkPositionUpdate&&e.linkPositionUpdate(E?g.children[1]:g,{start:{x:b.x,y:b.y,z:b.z},end:{x:x.x,y:x.y,z:x.z}},A)&&!E)){var S=30,M=A.__curve,C=g.children.length?g.children[0]:g;if(C.type==="Line"){if(M)C.geometry.setFromPoints(M.getPoints(S));else{var T=C.geometry.getAttribute("position");(!T||!T.array||T.array.length!==6)&&C.geometry[CR]("position",T=new Mi.BufferAttribute(new Float32Array(2*3),3)),T.array[0]=b.x,T.array[1]=b.y||0,T.array[2]=b.z||0,T.array[3]=x.x,T.array[4]=x.y||0,T.array[5]=x.z||0,T.needsUpdate=!0}C.geometry.computeBoundingSphere()}else if(C.type==="Mesh")if(M){C.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(C.position.set(0,0,0),C.rotation.set(0,0,0),C.scale.set(1,1,1));var K=Math.ceil(u(A)*10)/10,J=K/2,z=new Mi.TubeGeometry(M,S,J,e.linkResolution,!1);C.geometry.dispose(),C.geometry=z}else{if(!C.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var L=Math.ceil(u(A)*10)/10,B=L/2,F=new Mi.CylinderGeometry(B,B,1,e.linkResolution,1,!1);F[O0](new Mi.Matrix4().makeTranslation(0,1/2,0)),F[O0](new Mi.Matrix4().makeRotationX(Math.PI/2)),C.geometry.dispose(),C.geometry=F}var D=new Mi.Vector3(b.x,b.y||0,b.z||0),P=new Mi.Vector3(x.x,x.y||0,x.z||0),U=D.distanceTo(P);C.position.x=D.x,C.position.y=D.y,C.position.z=D.z,C.scale.z=U,C.parent.localToWorld(P),C.lookAt(P)}}}}});function p(A){var g=n?A:e.layout.getLinkPosition(e.layout.graph.getLink(A.source,A.target).id),v=g[n?"source":"from"],b=g[n?"target":"to"];if(!(!v||!b||!v.hasOwnProperty("x")||!b.hasOwnProperty("x"))){var x=h(A);if(!x)A.__curve=null;else{var E=new Mi.Vector3(v.x,v.y||0,v.z||0),S=new Mi.Vector3(b.x,b.y||0,b.z||0),M=E.distanceTo(S),C,T=d(A);if(M>0){var L=b.x-v.x,B=b.y-v.y||0,F=new Mi.Vector3().subVectors(S,E),D=F.clone().multiplyScalar(x).cross(L!==0||B!==0?new Mi.Vector3(0,0,1):new Mi.Vector3(0,1,0)).applyAxisAngle(F.normalize(),T).add(new Mi.Vector3().addVectors(E,S).divideScalar(2));C=new Mi.QuadraticBezierCurve3(E,D,S)}else{var P=x*70,U=-T,K=U+Math.PI/2;C=new Mi.CubicBezierCurve3(E,new Mi.Vector3(P*Math.cos(K),P*Math.sin(K),0).add(E),new Mi.Vector3(P*Math.cos(U),P*Math.sin(U),0).add(E),S)}A.__curve=C}}}}function o(){var c=ri(e.linkDirectionalArrowRelPos),u=ri(e.linkDirectionalArrowLength),h=ri(e.nodeVal);e.graphData.links.forEach(function(d){var f=d.__arrowObj;if(f){var p=n?d:e.layout.getLinkPosition(e.layout.graph.getLink(d.source,d.target).id),A=p[n?"source":"from"],g=p[n?"target":"to"];if(!(!A||!g||!A.hasOwnProperty("x")||!g.hasOwnProperty("x"))){var v=Math.cbrt(Math.max(0,h(A)||1))*e.nodeRelSize,b=Math.cbrt(Math.max(0,h(g)||1))*e.nodeRelSize,x=u(d),E=c(d),S=d.__curve?function(F){return d.__curve.getPoint(F)}:function(F){var D=function(U,K,J,z){return K[U]+(J[U]-K[U])*z||0};return{x:D("x",A,g,F),y:D("y",A,g,F),z:D("z",A,g,F)}},M=d.__curve?d.__curve.getLength():Math.sqrt(["x","y","z"].map(function(F){return Math.pow((g[F]||0)-(A[F]||0),2)}).reduce(function(F,D){return F+D},0)),C=v+x+(M-v-b-x)*E,T=S(C/M),L=S((C-x)/M);["x","y","z"].forEach(function(F){return f.position[F]=L[F]});var B=rq(Mi.Vector3,Ba(["x","y","z"].map(function(F){return T[F]})));f.parent.localToWorld(B),f.lookAt(B)}}})}function a(){var c=ri(e.linkDirectionalParticleSpeed);e.graphData.links.forEach(function(u){var h=u.__photonsObj&&u.__photonsObj.children,d=u.__singleHopPhotonsObj&&u.__singleHopPhotonsObj.children;if(!((!d||!d.length)&&(!h||!h.length))){var f=n?u:e.layout.getLinkPosition(e.layout.graph.getLink(u.source,u.target).id),p=f[n?"source":"from"],A=f[n?"target":"to"];if(!(!p||!A||!p.hasOwnProperty("x")||!A.hasOwnProperty("x"))){var g=c(u),v=u.__curve?function(x){return u.__curve.getPoint(x)}:function(x){var E=function(M,C,T,L){return C[M]+(T[M]-C[M])*L||0};return{x:E("x",p,A,x),y:E("y",p,A,x),z:E("z",p,A,x)}},b=[].concat(Ba(h||[]),Ba(d||[]));b.forEach(function(x,E){var S=x.parent.__linkThreeObjType==="singleHopPhotons";if(x.hasOwnProperty("__progressRatio")||(x.__progressRatio=S?0:E/h.length),x.__progressRatio+=g,x.__progressRatio>=1)if(!S)x.__progressRatio=x.__progressRatio%1;else{x.parent.remove(x),r_(x);return}var M=x.__progressRatio,C=v(M);["x","y","z"].forEach(function(T){return x.position[T]=C[T]})})}}})}},emitParticle:function(e,n){if(n&&e.graphData.links.includes(n)){if(!n.__singleHopPhotonsObj){var i=new Mi.Group;i.__linkThreeObjType="singleHopPhotons",n.__singleHopPhotonsObj=i,e.graphScene.add(i)}var o=ri(e.linkDirectionalParticleWidth),a=Math.ceil(o(n)*10)/10/2,c=e.linkDirectionalParticleResolution,u=new Mi.SphereGeometry(a,c,c),h=ri(e.linkColor),d=ri(e.linkDirectionalParticleColor),f=d(n)||h(n)||"#f0f0f0",p=new Mi.Color(Op(f)),A=e.linkOpacity*3,g=new Mi.MeshLambertMaterial({color:p,transparent:!0,opacity:A});n.__singleHopPhotonsObj.add(new Mi.Mesh(u,g))}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0};if(!e.initialised)return null;var i=function o(a){var c=[];if(a.geometry){a.geometry.computeBoundingBox();var u=new Mi.Box3;u.copy(a.geometry.boundingBox).applyMatrix4(a.matrixWorld),c.push(u)}return c.concat.apply(c,Ba((a.children||[]).filter(function(h){return!h.hasOwnProperty("__graphObjType")||h.__graphObjType==="node"&&n(h.__data)}).map(o)))}(e.graphScene);return i.length?Object.assign.apply(Object,Ba(["x","y","z"].map(function(o){return fw({},o,[Kb(i,function(a){return a.min[o]}),Xb(i,function(a){return a.max[o]})])}))):null}},stateInit:function(){return{d3ForceLayout:YB().force("link",XB()).force("charge",$B()).force("center",zB()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.graphScene=e},update:function(e,n){var i=function(Ce){return Ce.some(function(Je){return n.hasOwnProperty(Je)})};if(e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&i(["nodeAutoColorBy","graphData","nodeColor"])&&wR(e.graphData.nodes,ri(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&i(["linkAutoColorBy","graphData","linkColor"])&&wR(e.graphData.links,ri(e.linkAutoColorBy),e.linkColor),e._flushObjects||i(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var o=ri(e.nodeThreeObject),a=ri(e.nodeThreeObjectExtend),c=ri(e.nodeVal),u=ri(e.nodeColor),h=ri(e.nodeVisibility),d={},f={};Dp(e.graphData.nodes.filter(h),e.graphScene,{purge:e._flushObjects||i(["nodeThreeObject","nodeThreeObjectExtend"]),objFilter:function(Ce){return Ce.__graphObjType==="node"},createObj:function(Ce){var Je=o(Ce),Oe=a(Ce);Je&&e.nodeThreeObject===Je&&(Je=Je.clone());var $e;return Je&&!Oe?$e=Je:($e=new Mi.Mesh,$e.__graphDefaultObj=!0,Je&&Oe&&$e.add(Je)),$e.__graphObjType="node",$e},updateObj:function(Ce,Je){if(Ce.__graphDefaultObj){var Oe=c(Je)||1,$e=Math.cbrt(Oe)*e.nodeRelSize,nt=e.nodeResolution;(!Ce.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||Ce.geometry.parameters.radius!==$e||Ce.geometry.parameters.widthSegments!==nt)&&(d.hasOwnProperty(Oe)||(d[Oe]=new Mi.SphereGeometry($e,nt,nt)),Ce.geometry.dispose(),Ce.geometry=d[Oe]);var gt=u(Je),Tt=new Mi.Color(Op(gt||"#ffffaa")),Ze=e.nodeOpacity*YE(gt);(Ce.material.type!=="MeshLambertMaterial"||!Ce.material.color.equals(Tt)||Ce.material.opacity!==Ze)&&(f.hasOwnProperty(gt)||(f[gt]=new Mi.MeshLambertMaterial({color:Tt,transparent:!0,opacity:Ze})),Ce.material.dispose(),Ce.material=f[gt])}}})}if(e._flushObjects||i(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var p=ri(e.linkThreeObject),A=ri(e.linkThreeObjectExtend),g=ri(e.linkMaterial),v=ri(e.linkVisibility),b=ri(e.linkColor),x=ri(e.linkWidth),E={},S={},M={},C=e.graphData.links.filter(v);if(Dp(C,e.graphScene,{objBindAttr:"__lineObj",purge:e._flushObjects||i(["linkThreeObject","linkThreeObjectExtend","linkWidth"]),objFilter:function(Ce){return Ce.__graphObjType==="link"},exitObj:function(Ce){var Je=Ce.__data&&Ce.__data.__singleHopPhotonsObj;Je&&(Je.parent.remove(Je),r_(Je),delete Ce.__data.__singleHopPhotonsObj)},createObj:function(Ce){var Je=p(Ce),Oe=A(Ce);Je&&e.linkThreeObject===Je&&(Je=Je.clone());var $e;if(!Je||Oe){var nt=!!x(Ce);if(nt)$e=new Mi.Mesh;else{var gt=new Mi.BufferGeometry;gt[CR]("position",new Mi.BufferAttribute(new Float32Array(2*3),3)),$e=new Mi.Line(gt)}}var Tt;return Je?Oe?(Tt=new Mi.Group,Tt.__graphDefaultObj=!0,Tt.add($e),Tt.add(Je)):Tt=Je:(Tt=$e,Tt.__graphDefaultObj=!0),Tt.renderOrder=10,Tt.__graphObjType="link",Tt},updateObj:function(Ce,Je){if(Ce.__graphDefaultObj){var Oe=Ce.children.length?Ce.children[0]:Ce,$e=Math.ceil(x(Je)*10)/10,nt=!!$e;if(nt){var gt=$e/2,Tt=e.linkResolution;if(!Oe.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||Oe.geometry.parameters.radiusTop!==gt||Oe.geometry.parameters.radialSegments!==Tt){if(!E.hasOwnProperty($e)){var Ze=new Mi.CylinderGeometry(gt,gt,1,Tt,1,!1);Ze[O0](new Mi.Matrix4().makeTranslation(0,1/2,0)),Ze[O0](new Mi.Matrix4().makeRotationX(Math.PI/2)),E[$e]=Ze}Oe.geometry.dispose(),Oe.geometry=E[$e]}}var mn=g(Je);if(mn)Oe.material=mn;else{var Ft=b(Je),Qt=new Mi.Color(Op(Ft||"#f0f0f0")),Xt=e.linkOpacity*YE(Ft),Tn=nt?"MeshLambertMaterial":"LineBasicMaterial";if(Oe.material.type!==Tn||!Oe.material.color.equals(Qt)||Oe.material.opacity!==Xt){var vn=nt?S:M;vn.hasOwnProperty(Ft)||(vn[Ft]=new Mi[Tn]({color:Qt,transparent:Xt<1,opacity:Xt,depthWrite:Xt>=1})),Oe.material.dispose(),Oe.material=vn[Ft]}}}}}),e.linkDirectionalArrowLength||n.hasOwnProperty("linkDirectionalArrowLength")){var T=ri(e.linkDirectionalArrowLength),L=ri(e.linkDirectionalArrowColor);Dp(C.filter(T),e.graphScene,{objBindAttr:"__arrowObj",objFilter:function(Ce){return Ce.__linkThreeObjType==="arrow"},createObj:function(){var Ce=new Mi.Mesh(void 0,new Mi.MeshLambertMaterial({transparent:!0}));return Ce.__linkThreeObjType="arrow",Ce},updateObj:function(Ce,Je){var Oe=T(Je),$e=e.linkDirectionalArrowResolution;if(!Ce.geometry.type.match(/^Cone(Buffer)?Geometry$/)||Ce.geometry.parameters.height!==Oe||Ce.geometry.parameters.radialSegments!==$e){var nt=new Mi.ConeGeometry(Oe*.25,Oe,$e);nt.translate(0,Oe/2,0),nt.rotateX(Math.PI/2),Ce.geometry.dispose(),Ce.geometry=nt}var gt=L(Je)||b(Je)||"#f0f0f0";Ce.material.color=new Mi.Color(Op(gt)),Ce.material.opacity=e.linkOpacity*3*YE(gt)}})}if(e.linkDirectionalParticles||n.hasOwnProperty("linkDirectionalParticles")){var B=ri(e.linkDirectionalParticles),F=ri(e.linkDirectionalParticleWidth),D=ri(e.linkDirectionalParticleColor),P={},U={};Dp(C.filter(B),e.graphScene,{objBindAttr:"__photonsObj",objFilter:function(Ce){return Ce.__linkThreeObjType==="photons"},createObj:function(){var Ce=new Mi.Group;return Ce.__linkThreeObjType="photons",Ce},updateObj:function(Ce,Je){var Oe=Math.round(Math.abs(B(Je))),$e=!!Ce.children.length&&Ce.children[0],nt=Math.ceil(F(Je)*10)/10/2,gt=e.linkDirectionalParticleResolution,Tt;$e&&$e.geometry.parameters.radius===nt&&$e.geometry.parameters.widthSegments===gt?Tt=$e.geometry:(U.hasOwnProperty(nt)||(U[nt]=new Mi.SphereGeometry(nt,gt,gt)),Tt=U[nt],$e&&$e.geometry.dispose());var Ze=D(Je)||b(Je)||"#f0f0f0",mn=new Mi.Color(Op(Ze)),Ft=e.linkOpacity*3,Qt;$e&&$e.material.color.equals(mn)&&$e.material.opacity===Ft?Qt=$e.material:(P.hasOwnProperty(Ze)||(P[Ze]=new Mi.MeshLambertMaterial({color:mn,transparent:!0,opacity:Ft})),Qt=P[Ze],$e&&$e.material.dispose()),Dp(Ba(new Array(Oe)).map(function(Xt,Tn){return{idx:Tn}}),Ce,{idAccessor:function(Tn){return Tn.idx},createObj:function(){return new Mi.Mesh(Tt,Qt)},updateObj:function(Tn){Tn.geometry=Tt,Tn.material=Qt}})}})}}if(e._flushObjects=!1,i(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){e.engineRunning=!1,e.graphData.links.forEach(function(me){me.source=me[e.linkSource],me.target=me[e.linkTarget]});var K=e.forceEngine!=="ngraph",J;if(K){(J=e.d3ForceLayout).stop().alpha(1).numDimensions(e.numDimensions).nodes(e.graphData.nodes);var z=e.d3ForceLayout.force("link");z&&z.id(function(me){return me[e.nodeId]}).links(e.graphData.links);var j=e.dagMode&&bq(e.graphData,function(me){return me[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),G=Math.max.apply(Math,Ba(Object.values(j||[]))),H=e.dagLevelDistance||e.graphData.nodes.length/(G||1)*_q*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(e.dagMode){var te=function(Ce,Je){return function(Oe){return Ce?(j[Oe[e.nodeId]]-G/2)*H*(Je?-1:1):void 0}},Z=te(["lr","rl"].indexOf(e.dagMode)!==-1,e.dagMode==="rl"),ee=te(["td","bu"].indexOf(e.dagMode)!==-1,e.dagMode==="td"),oe=te(["zin","zout"].indexOf(e.dagMode)!==-1,e.dagMode==="zout");e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(me){me.fx=Z(me),me.fy=ee(me),me.fz=oe(me)})}e.d3ForceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?JB(function(me){var Ce=j[me[e.nodeId]]||-1;return(e.dagMode==="radialin"?G-Ce:Ce)*H}).strength(function(me){return e.dagNodeFilter(me)?1:0}):null)}else{var xe=MR.graph();e.graphData.nodes.forEach(function(me){xe.addNode(me[e.nodeId])}),e.graphData.links.forEach(function(me){xe.addLink(me.source,me.target)}),J=MR.forcelayout(xe,BL({dimensions:e.numDimensions},e.ngraphPhysics)),J.graph=xe}for(var Pe=0;Pe<e.warmupTicks&&!(K&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin);Pe++)J[K?"tick":"step"]();e.layout=J,this.resetCountdown()}e.engineRunning=!0,e.onFinishUpdate()}});function Mq(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=function(o){cq(a,o);function a(){var c;aq(this,a);for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return c=iq(this,a,[].concat(h)),c.__kapsuleInstance=s().apply(void 0,[].concat(Ba(n?[PL(c)]:[]),h)),c}return lq(a)}(e);return Object.keys(s()).forEach(function(o){return i.prototype[o]=function(){var a,c=(a=this.__kapsuleInstance)[o].apply(a,arguments);return c===this.__kapsuleInstance?this:c}}),i}var Cq=window.THREE?window.THREE:{Group:ef},pw=Mq(wq,Cq.Group,!0);const Sq=Object.freeze(Object.defineProperty({__proto__:null,default:pw},Symbol.toStringTag,{value:"Module"})),Tq=M_(Sq);if(typeof AFRAME>"u")throw new Error("Component attempted to register before AFRAME was available.");let $E=i7;"default"in $E&&($E=$E.default);let Zh=Tq;"default"in Zh&&(Zh=Zh.default);const JE=function(s){return typeof s=="string"?JSON.parse(s):s},Ra=function(s){if(typeof s=="function")return s;const e=eval;try{return e("("+s+")")}catch{}return null},Xr=function(s){return isNaN(parseFloat(s))?Ra(s)?Ra(s):s:parseFloat(s)};AFRAME.registerComponent("forcegraph",{schema:{jsonUrl:{type:"string",default:""},nodes:{parse:JE,default:[]},links:{parse:JE,default:[]},numDimensions:{type:"number",default:3},dagMode:{type:"string",default:""},dagLevelDistance:{type:"number",default:0},dagNodeFilter:{parse:Ra,default:function(){return!0}},onDagError:{parse:Ra,default:void 0},nodeRelSize:{type:"number",default:4},nodeId:{type:"string",default:"id"},nodeVal:{parse:Xr,default:"val"},nodeResolution:{type:"number",default:8},nodeVisibility:{parse:Xr,default:!0},nodeColor:{parse:Xr,default:"color"},nodeAutoColorBy:{parse:Xr,default:""},nodeOpacity:{type:"number",default:.75},nodeThreeObject:{parse:Xr,default:null},nodeThreeObjectExtend:{parse:Xr,default:!1},linkSource:{type:"string",default:"source"},linkTarget:{type:"string",default:"target"},linkVisibility:{parse:Xr,default:!0},linkColor:{parse:Xr,default:"color"},linkAutoColorBy:{parse:Xr,default:""},linkOpacity:{type:"number",default:.2},linkWidth:{parse:Xr,default:0},linkResolution:{type:"number",default:6},linkCurvature:{parse:Xr,default:0},linkCurveRotation:{parse:Xr,default:0},linkMaterial:{parse:Xr,default:null},linkThreeObject:{parse:Xr,default:null},linkThreeObjectExtend:{parse:Xr,default:!1},linkPositionUpdate:{parse:Ra,default:null},linkDirectionalArrowLength:{parse:Xr,default:0},linkDirectionalArrowColor:{parse:Xr,default:null},linkDirectionalArrowRelPos:{parse:Xr,default:.5},linkDirectionalArrowResolution:{type:"number",default:8},linkDirectionalParticles:{parse:Xr,default:0},linkDirectionalParticleSpeed:{parse:Xr,default:.01},linkDirectionalParticleWidth:{parse:Xr,default:.5},linkDirectionalParticleColor:{parse:Xr,default:null},linkDirectionalParticleResolution:{type:"number",default:4},onNodeHover:{parse:Ra,default:()=>{}},onLinkHover:{parse:Ra,default:()=>{}},onNodeClick:{parse:Ra,default:()=>{}},onLinkClick:{parse:Ra,default:()=>{}},forceEngine:{type:"string",default:"d3"},d3AlphaMin:{type:"number",default:0},d3AlphaDecay:{type:"number",default:.0228},d3VelocityDecay:{type:"number",default:.4},ngraphPhysics:{parse:JE,default:null},warmupTicks:{type:"int",default:0},cooldownTicks:{type:"int",default:1e18},cooldownTime:{type:"int",default:15e3},onEngineTick:{parse:Ra,default:function(){}},onEngineStop:{parse:Ra,default:function(){}}},getGraphBbox:function(){return this.forceGraph||(this.forceGraph=new Zh),this.forceGraph.getGraphBbox()},emitParticle:function(){this.forceGraph||(this.forceGraph=new Zh);const s=this.forceGraph,e=s.emitParticle.apply(s,arguments);return e===s?this:e},d3Force:function(){this.forceGraph||(this.forceGraph=new Zh);const s=this.forceGraph,e=s.d3Force.apply(s,arguments);return e===s?this:e},d3ReheatSimulation:function(){return this.forceGraph&&this.forceGraph.d3ReheatSimulation(),this},refresh:function(){return this.forceGraph&&this.forceGraph.refresh(),this},init:function(){const s=this.state={};s.infoEl=document.createElement("a-text"),s.infoEl.setAttribute("position","0 -0.1 -1"),s.infoEl.setAttribute("width",1),s.infoEl.setAttribute("align","center"),s.infoEl.setAttribute("color","lavender");const e=document.querySelector("a-entity[camera], a-camera");e.appendChild(s.infoEl),s.cameraObj=e.object3D.children.filter(function(n){return n.type==="PerspectiveCamera"})[0],this.el.sceneEl.addEventListener("camera-set-active",function(n){s.cameraObj=n.detail.cameraEl.components.camera.camera}),this.forceGraph||(this.forceGraph=new Zh),this.forceGraph.onFinishUpdate(()=>this.el.setObject3D("forcegraphGroup",this.forceGraph)).onLoading(()=>s.infoEl.setAttribute("value","Loading...")).onFinishLoading(()=>s.infoEl.setAttribute("value","")),this.el.addEventListener("raycaster-intersected",n=>s.hoverDetail=n.detail),this.el.addEventListener("raycaster-intersected-cleared",n=>s.hoverDetail=n.detail),this.el.addEventListener("click",()=>s.hoverObj&&this.data["on"+(s.hoverObj.__graphObjType==="node"?"Node":"Link")+"Click"](s.hoverObj.__data))},remove:function(){this.state.infoEl.remove(),this.el.removeObject3D("forcegraphGroup")},update:function(s){const e=this,n=this.data,i=AFRAME.utils.diff(n,s);["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].filter(function(a){return a in i}).forEach(function(a){e.forceGraph[a](n[a]!==""?n[a]:null)}),("nodes"in i||"links"in i)&&e.forceGraph.graphData({nodes:n.nodes,links:n.links})},tick:function(s,e){const n=this.state,i=this.data,o=n.hoverDetail?n.hoverDetail.getIntersection?n.hoverDetail.getIntersection(this.el):n.hoverDetail.intersection||void 0:void 0;let a=o?o.object:void 0;for(;a&&!a.hasOwnProperty("__graphObjType");)a=a.parent;if(a!==n.hoverObj){const c=n.hoverObj?n.hoverObj.__graphObjType:null,u=n.hoverObj?n.hoverObj.__data:null,h=a?a.__graphObjType:null,d=a?a.__data:null;c&&c!==h&&i["on"+(c==="node"?"Node":"Link")+"Hover"](null,u),h&&i["on"+(h==="node"?"Node":"Link")+"Hover"](d,c===h?u:null),n.hoverObj=a}this.forceGraph.tickFrame()}});function Bo(){return Bo=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=n[i])}return s},Bo.apply(this,arguments)}function Rq(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function ym(s,e){return ym=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},ym(s,e)}function Iq(s,e){s.prototype=Object.create(e.prototype),s.prototype.constructor=s,ym(s,e)}function s_(s){return s_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},s_(s)}function Bq(s){try{return Function.toString.call(s).indexOf("[native code]")!==-1}catch{return typeof s=="function"}}function OL(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OL=function(){return!!s})()}function Lq(s,e,n){if(OL())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var o=new(s.bind.apply(s,i));return n&&ym(o,n.prototype),o}function o_(s){var e=typeof Map=="function"?new Map:void 0;return o_=function(i){if(i===null||!Bq(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(i))return e.get(i);e.set(i,o)}function o(){return Lq(i,arguments,s_(this).constructor)}return o.prototype=Object.create(i.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),ym(o,i)},o_(s)}var el=function(s){Iq(e,s);function e(n){var i;return i=s.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+n+" for more information.")||this,Rq(i)}return e}(o_(Error));function ZE(s){return Math.round(s*255)}function Pq(s,e,n){return ZE(s)+","+ZE(e)+","+ZE(n)}function xm(s,e,n,i){if(i===void 0&&(i=Pq),e===0)return i(n,n,n);var o=(s%360+360)%360/60,a=(1-Math.abs(2*n-1))*e,c=a*(1-Math.abs(o%2-1)),u=0,h=0,d=0;o>=0&&o<1?(u=a,h=c):o>=1&&o<2?(u=c,h=a):o>=2&&o<3?(h=a,d=c):o>=3&&o<4?(h=c,d=a):o>=4&&o<5?(u=c,d=a):o>=5&&o<6&&(u=a,d=c);var f=n-a/2,p=u+f,A=h+f,g=d+f;return i(p,A,g)}var SR={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function Dq(s){if(typeof s!="string")return s;var e=s.toLowerCase();return SR[e]?"#"+SR[e]:s}var Oq=/^#[a-fA-F0-9]{6}$/,Fq=/^#[a-fA-F0-9]{8}$/,Nq=/^#[a-fA-F0-9]{3}$/,Uq=/^#[a-fA-F0-9]{4}$/,eb=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,kq=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,zq=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,Gq=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function $c(s){if(typeof s!="string")throw new el(3);var e=Dq(s);if(e.match(Oq))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(Fq)){var n=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:n}}if(e.match(Nq))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(Uq)){var i=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:i}}var o=eb.exec(e);if(o)return{red:parseInt(""+o[1],10),green:parseInt(""+o[2],10),blue:parseInt(""+o[3],10)};var a=kq.exec(e.substring(0,50));if(a)return{red:parseInt(""+a[1],10),green:parseInt(""+a[2],10),blue:parseInt(""+a[3],10),alpha:parseFloat(""+a[4])>1?parseFloat(""+a[4])/100:parseFloat(""+a[4])};var c=zq.exec(e);if(c){var u=parseInt(""+c[1],10),h=parseInt(""+c[2],10)/100,d=parseInt(""+c[3],10)/100,f="rgb("+xm(u,h,d)+")",p=eb.exec(f);if(!p)throw new el(4,e,f);return{red:parseInt(""+p[1],10),green:parseInt(""+p[2],10),blue:parseInt(""+p[3],10)}}var A=Gq.exec(e.substring(0,50));if(A){var g=parseInt(""+A[1],10),v=parseInt(""+A[2],10)/100,b=parseInt(""+A[3],10)/100,x="rgb("+xm(g,v,b)+")",E=eb.exec(x);if(!E)throw new el(4,e,x);return{red:parseInt(""+E[1],10),green:parseInt(""+E[2],10),blue:parseInt(""+E[3],10),alpha:parseFloat(""+A[4])>1?parseFloat(""+A[4])/100:parseFloat(""+A[4])}}throw new el(5)}function Vq(s){var e=s.red/255,n=s.green/255,i=s.blue/255,o=Math.max(e,n,i),a=Math.min(e,n,i),c=(o+a)/2;if(o===a)return s.alpha!==void 0?{hue:0,saturation:0,lightness:c,alpha:s.alpha}:{hue:0,saturation:0,lightness:c};var u,h=o-a,d=c>.5?h/(2-o-a):h/(o+a);switch(o){case e:u=(n-i)/h+(n<i?6:0);break;case n:u=(i-e)/h+2;break;default:u=(e-n)/h+4;break}return u*=60,s.alpha!==void 0?{hue:u,saturation:d,lightness:c,alpha:s.alpha}:{hue:u,saturation:d,lightness:c}}function th(s){return Vq($c(s))}var Hq=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},a_=Hq;function Xh(s){var e=s.toString(16);return e.length===1?"0"+e:e}function tb(s){return Xh(Math.round(s*255))}function jq(s,e,n){return a_("#"+tb(s)+tb(e)+tb(n))}function Iv(s,e,n){return xm(s,e,n,jq)}function Wq(s,e,n){if(typeof s=="number"&&typeof e=="number"&&typeof n=="number")return Iv(s,e,n);if(typeof s=="object"&&e===void 0&&n===void 0)return Iv(s.hue,s.saturation,s.lightness);throw new el(1)}function Qq(s,e,n,i){if(typeof s=="number"&&typeof e=="number"&&typeof n=="number"&&typeof i=="number")return i>=1?Iv(s,e,n):"rgba("+xm(s,e,n)+","+i+")";if(typeof s=="object"&&e===void 0&&n===void 0&&i===void 0)return s.alpha>=1?Iv(s.hue,s.saturation,s.lightness):"rgba("+xm(s.hue,s.saturation,s.lightness)+","+s.alpha+")";throw new el(2)}function l_(s,e,n){if(typeof s=="number"&&typeof e=="number"&&typeof n=="number")return a_("#"+Xh(s)+Xh(e)+Xh(n));if(typeof s=="object"&&e===void 0&&n===void 0)return a_("#"+Xh(s.red)+Xh(s.green)+Xh(s.blue));throw new el(6)}function ty(s,e,n,i){if(typeof s=="string"&&typeof e=="number"){var o=$c(s);return"rgba("+o.red+","+o.green+","+o.blue+","+e+")"}else{if(typeof s=="number"&&typeof e=="number"&&typeof n=="number"&&typeof i=="number")return i>=1?l_(s,e,n):"rgba("+s+","+e+","+n+","+i+")";if(typeof s=="object"&&e===void 0&&n===void 0&&i===void 0)return s.alpha>=1?l_(s.red,s.green,s.blue):"rgba("+s.red+","+s.green+","+s.blue+","+s.alpha+")"}throw new el(7)}var Xq=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},Kq=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},qq=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},Yq=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function nh(s){if(typeof s!="object")throw new el(8);if(Kq(s))return ty(s);if(Xq(s))return l_(s);if(Yq(s))return Qq(s);if(qq(s))return Wq(s);throw new el(8)}function FL(s,e,n){return function(){var o=n.concat(Array.prototype.slice.call(arguments));return o.length>=e?s.apply(this,o):FL(s,e,o)}}function Ko(s){return FL(s,s.length,[])}function $q(s,e){if(e==="transparent")return e;var n=th(e);return nh(Bo({},n,{hue:n.hue+parseFloat(s)}))}Ko($q);function wf(s,e,n){return Math.max(s,Math.min(e,n))}function Jq(s,e){if(e==="transparent")return e;var n=th(e);return nh(Bo({},n,{lightness:wf(0,1,n.lightness-parseFloat(s))}))}Ko(Jq);function Zq(s,e){if(e==="transparent")return e;var n=th(e);return nh(Bo({},n,{saturation:wf(0,1,n.saturation-parseFloat(s))}))}Ko(Zq);function eY(s,e){if(e==="transparent")return e;var n=th(e);return nh(Bo({},n,{lightness:wf(0,1,n.lightness+parseFloat(s))}))}Ko(eY);function tY(s,e,n){if(e==="transparent")return n;if(n==="transparent")return e;if(s===0)return n;var i=$c(e),o=Bo({},i,{alpha:typeof i.alpha=="number"?i.alpha:1}),a=$c(n),c=Bo({},a,{alpha:typeof a.alpha=="number"?a.alpha:1}),u=o.alpha-c.alpha,h=parseFloat(s)*2-1,d=h*u===-1?h:h+u,f=1+h*u,p=(d/f+1)/2,A=1-p,g={red:Math.floor(o.red*p+c.red*A),green:Math.floor(o.green*p+c.green*A),blue:Math.floor(o.blue*p+c.blue*A),alpha:o.alpha*parseFloat(s)+c.alpha*(1-parseFloat(s))};return ty(g)}var nY=Ko(tY),NL=nY;function iY(s,e){if(e==="transparent")return e;var n=$c(e),i=typeof n.alpha=="number"?n.alpha:1,o=Bo({},n,{alpha:wf(0,1,(i*100+parseFloat(s)*100)/100)});return ty(o)}var rY=Ko(iY),UL=rY;function sY(s,e){if(e==="transparent")return e;var n=th(e);return nh(Bo({},n,{saturation:wf(0,1,n.saturation+parseFloat(s))}))}Ko(sY);function oY(s,e){return e==="transparent"?e:nh(Bo({},th(e),{hue:parseFloat(s)}))}Ko(oY);function aY(s,e){return e==="transparent"?e:nh(Bo({},th(e),{lightness:parseFloat(s)}))}Ko(aY);function lY(s,e){return e==="transparent"?e:nh(Bo({},th(e),{saturation:parseFloat(s)}))}Ko(lY);function cY(s,e){return e==="transparent"?e:NL(parseFloat(s),"rgb(0, 0, 0)",e)}Ko(cY);function hY(s,e){return e==="transparent"?e:NL(parseFloat(s),"rgb(255, 255, 255)",e)}Ko(hY);function uY(s,e){if(e==="transparent")return e;var n=$c(e),i=typeof n.alpha=="number"?n.alpha:1,o=Bo({},n,{alpha:wf(0,1,+(i*100-parseFloat(s)*100).toFixed(2)/100)});return ty(o)}Ko(uY);function dY(s,e){e===void 0&&(e={});var n=e.insertAt;if(!(!s||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=s:o.appendChild(document.createTextNode(s))}}var fY=`.graph-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: Sans-serif;
  z-index: 1000;
}`;dY(fY);function pY(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function TR(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),n.push.apply(n,i)}return n}function RR(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?TR(Object(n),!0).forEach(function(i){Kp(s,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):TR(Object(n)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(n,i))})}return s}function mY(s,e){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function gY(s){var e=mY(s,"string");return typeof e=="symbol"?e:String(e)}function Kp(s,e,n){return e=gY(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function nb(s,e){return vY(s)||pY(s,e)||kL(s,e)||EY()}function F0(s){return AY(s)||yY(s)||kL(s)||xY()}function AY(s){if(Array.isArray(s))return c_(s)}function vY(s){if(Array.isArray(s))return s}function yY(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function kL(s,e){if(s){if(typeof s=="string")return c_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c_(s,e)}}function c_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function xY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var bY=du({props:{width:{default:window.innerWidth,triggerUpdate:!1,onChange:function(e,n){n.container&&(n.container.style.width="".concat(e,"px"))}},height:{default:window.innerHeight,triggerUpdate:!1,onChange:function(e,n){n.container&&(n.container.style.height="".concat(e,"px"))}},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},backgroundColor:{default:"#002"},showNavInfo:{default:!0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeLabel:{default:"name"},nodeDesc:{default:"desc"},onNodeHover:{},onNodeClick:{},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkLabel:{default:"name"},linkDesc:{default:"desc"},onLinkHover:{},onLinkClick:{},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:RR(RR({},Object.assign.apply(Object,[{}].concat(F0(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(s){return Kp({},s,function(e){for(var n=e.forcegraph.components.forcegraph,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var c=n[s].apply(n,o);return c===n?this:c})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(e,n){e.innerHTML="",n.container=document.createElement("div"),e.appendChild(n.container),n.container.style.position="relative",n.container.style.width="".concat(n.width,"px"),n.container.style.height="".concat(n.height,"px"),n.container.appendChild(n.navInfo=document.createElement("div")),n.navInfo.className="graph-nav-info",n.navInfo.textContent="Mouse drag: look, gamepad/arrow/wasd keys: move";var i=document.createElement("a-scene");i.setAttribute("embedded",""),i.appendChild(n.sky=document.createElement("a-sky")),n.sky.setAttribute("radius",3e3);var o;i.appendChild(o=document.createElement("a-entity")),o.setAttribute("position","0 0 300"),o.setAttribute("movement-controls","controls: gamepad, touch; fly: true; speed: 7");var a;o.appendChild(a=document.createElement("a-entity")),a.setAttribute("camera",""),a.setAttribute("position","0 0 0"),a.setAttribute("look-controls","pointerLockEnabled: false"),a.setAttribute("wasd-controls","fly: true; acceleration: 700");var c;a.appendChild(c=document.createElement("a-text")),c.setAttribute("position","0 -0.3 -1"),c.setAttribute("width",2),c.setAttribute("align","center"),c.setAttribute("color","lavender"),c.setAttribute("value","");var u;a.appendChild(u=document.createElement("a-text")),u.setAttribute("position","0 -0.4 -1"),u.setAttribute("width",1.3),u.setAttribute("align","center"),u.setAttribute("color","lavender"),u.setAttribute("value",""),n.raycasterEls=[];var h;i.appendChild(h=document.createElement("a-entity")),h.setAttribute("cursor","rayOrigin: mouse; mouseCursorStylesEnabled: true"),h.setAttribute("raycaster","objects: [forcegraph]; interval: 100"),n.raycasterEls.push(h),["left","right"].forEach(function(d){var f;o.appendChild(f=document.createElement("a-entity")),f.setAttribute("laser-controls","hand: ".concat(d,"; model: false;")),f.setAttribute("raycaster","objects: [forcegraph]; interval: 100; lineColor: steelblue; lineOpacity: 0.85"),n.raycasterEls.push(f)}),i.appendChild(n.forcegraph=document.createElement("a-entity")),n.forcegraph.setAttribute("forcegraph",null),n.container.appendChild(i),n.forcegraph.setAttribute("forcegraph",Object.assign.apply(Object,F0(["node","link"].map(function(d){var f={node:"Node",link:"Link"}[d];return Kp({},"on".concat(f,"Hover"),function(A,g){var v=A&&ri(n["".concat(d,"Label")])(A)||"",b=A&&ri(n["".concat(d,"Desc")])(A)||"";c.setAttribute("value",v),u.setAttribute("value",b),n["on".concat(f,"Hover")]&&n["on".concat(f,"Hover")](A,g)})}))))},update:function(e,n){if(n.hasOwnProperty("backgroundColor")){var i=$c(e.backgroundColor).alpha;i===void 0&&(i=1),e.sky.setAttribute("color",UL(1,e.backgroundColor)),e.sky.setAttribute("opacity",i)}n.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none");var o=["onNodeHover","onLinkHover","onNodeClick","onLinkClick"].some(function(u){return e[u]})||["nodeLabel","linkLabel"].some(function(u){return e[u]!=="name"})||["nodeDesc","linkDesc"].some(function(u){return e[u]!=="desc"});e.raycasterEls.forEach(function(u){return u.setAttribute("raycaster",o?"objects: [forcegraph]; interval: 100":"objects: __none__")});var a=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","onNodeClick","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","onLinkClick","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],c=Object.assign.apply(Object,[{}].concat(F0(Object.entries(e).filter(function(u){var h=nb(u,2),d=h[0],f=h[1];return n.hasOwnProperty(d)&&a.indexOf(d)!==-1&&f!==void 0&&f!==null}).map(function(u){var h=nb(u,2),d=h[0],f=h[1];return Kp({},d,f)})),F0(Object.entries(e.graphData).map(function(u){var h=nb(u,2),d=h[0],f=h[1];return Kp({},d,f)}))));e.forcegraph.setAttribute("forcegraph",c)}});function _Y(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function IR(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),n.push.apply(n,i)}return n}function BR(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IR(Object(n),!0).forEach(function(i){tv(s,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):IR(Object(n)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(n,i))})}return s}function tv(s,e,n){return e=IY(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function N0(s,e){return MY(s)||_Y(s,e)||zL(s,e)||TY()}function U0(s){return wY(s)||CY(s)||zL(s)||SY()}function wY(s){if(Array.isArray(s))return h_(s)}function MY(s){if(Array.isArray(s))return s}function CY(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function zL(s,e){if(s){if(typeof s=="string")return h_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h_(s,e)}}function h_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function SY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RY(s,e){if(typeof s!="object"||s===null)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function IY(s){var e=RY(s,"string");return typeof e=="symbol"?e:String(e)}var BY=du({props:{width:{},height:{},yOffset:{default:1.5},glScale:{default:200},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},onNodeHover:{},onNodeClick:{},onLinkHover:{},onLinkClick:{},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:BR(BR({},Object.assign.apply(Object,[{}].concat(U0(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(s){return tv({},s,function(e){for(var n=e.forcegraph.components.forcegraph,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var c=n[s].apply(n,o);return c===n?this:c})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.markerAttrs,a=o===void 0?{preset:"hiro"}:o;e.innerHTML="",n.container=document.createElement("div"),e.appendChild(n.container);var c=document.createElement("a-scene");c.setAttribute("embedded",""),c.setAttribute("vr-mode-ui","enabled: false"),c.setAttribute("arjs","debugUIEnabled: false;");var u=document.createElement("a-marker");Object.entries(a).forEach(function(f){var p=N0(f,2),A=p[0],g=p[1];return u.setAttribute(A,g)}),c.appendChild(u);var h;c.appendChild(h=document.createElement("a-entity")),h.setAttribute("cursor"),h.setAttribute("raycaster","objects: [forcegraph]"),n.forcegraph=document.createElement("a-entity"),n.forcegraph.setAttribute("forcegraph",null),u.appendChild(n.forcegraph);var d=document.createElement("a-entity");d.setAttribute("camera",""),c.appendChild(d),n.container.appendChild(c)},update:function(e,n){n.hasOwnProperty("width")&&e.width&&(e.container.style.width="".concat(e.width,"px")),n.hasOwnProperty("height")&&e.height&&(e.container.style.height="".concat(e.height,"px")),n.hasOwnProperty("glScale")&&e.forcegraph.setAttribute("scale",U0(new Array(3)).map(function(){return 1/e.glScale}).join(" ")),n.hasOwnProperty("yOffset")&&e.forcegraph.setAttribute("position","0 ".concat(e.yOffset," 0"));var i=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","onNodeHover","onNodeClick","onLinkHover","onLinkClick","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],o=Object.assign.apply(Object,[{}].concat(U0(Object.entries(e).filter(function(a){var c=N0(a,2),u=c[0],h=c[1];return n.hasOwnProperty(u)&&i.indexOf(u)!==-1&&h!==void 0&&h!==null}).map(function(a){var c=N0(a,2),u=c[0],h=c[1];return tv({},u,h)})),U0(Object.entries(e.graphData).map(function(a){var c=N0(a,2),u=c[0],h=c[1];return tv({},u,h)}))));e.forcegraph.setAttribute("forcegraph",o)}});const Hd=new Vl,Nc=new kB,Fp=new Mn,LR=new it,k0=new it,ib=new it,PR=new Gr;class LY extends Ga{constructor(e,n,i){super(),i.style.touchAction="none";let o=null,a=null;const c=[],u=this;function h(){i.addEventListener("pointermove",g),i.addEventListener("pointerdown",v),i.addEventListener("pointerup",b),i.addEventListener("pointerleave",b)}function d(){i.removeEventListener("pointermove",g),i.removeEventListener("pointerdown",v),i.removeEventListener("pointerup",b),i.removeEventListener("pointerleave",b),i.style.cursor=""}function f(){d()}function p(){return e}function A(){return Nc}function g(E){if(u.enabled!==!1){if(x(E),Nc.setFromCamera(Fp,n),o){Nc.ray.intersectPlane(Hd,k0)&&o.position.copy(k0.sub(LR).applyMatrix4(PR)),u.dispatchEvent({type:"drag",object:o});return}if(E.pointerType==="mouse"||E.pointerType==="pen")if(c.length=0,Nc.setFromCamera(Fp,n),Nc.intersectObjects(e,u.recursive,c),c.length>0){const S=c[0].object;Hd.setFromNormalAndCoplanarPoint(n.getWorldDirection(Hd.normal),ib.setFromMatrixPosition(S.matrixWorld)),a!==S&&a!==null&&(u.dispatchEvent({type:"hoveroff",object:a}),i.style.cursor="auto",a=null),a!==S&&(u.dispatchEvent({type:"hoveron",object:S}),i.style.cursor="pointer",a=S)}else a!==null&&(u.dispatchEvent({type:"hoveroff",object:a}),i.style.cursor="auto",a=null)}}function v(E){u.enabled!==!1&&(x(E),c.length=0,Nc.setFromCamera(Fp,n),Nc.intersectObjects(e,u.recursive,c),c.length>0&&(o=u.transformGroup===!0?e[0]:c[0].object,Hd.setFromNormalAndCoplanarPoint(n.getWorldDirection(Hd.normal),ib.setFromMatrixPosition(o.matrixWorld)),Nc.ray.intersectPlane(Hd,k0)&&(PR.copy(o.parent.matrixWorld).invert(),LR.copy(k0).sub(ib.setFromMatrixPosition(o.matrixWorld))),i.style.cursor="move",u.dispatchEvent({type:"dragstart",object:o})))}function b(){u.enabled!==!1&&(o&&(u.dispatchEvent({type:"dragend",object:o}),o=null),i.style.cursor=a?"pointer":"auto")}function x(E){const S=i.getBoundingClientRect();Fp.x=(E.clientX-S.left)/S.width*2-1,Fp.y=-(E.clientY-S.top)/S.height*2+1}h(),this.enabled=!0,this.recursive=!0,this.transformGroup=!1,this.activate=h,this.deactivate=d,this.dispose=f,this.getObjects=p,this.getRaycaster=A}}const rb={type:"change"},sb={type:"start"},ob={type:"end"};class PY extends Ga{constructor(e,n){super();const i=this,o={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=n,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Ja.ROTATE,MIDDLE:Ja.DOLLY,RIGHT:Ja.PAN},this.target=new it;const a=1e-6,c=new it;let u=1,h=o.NONE,d=o.NONE,f=0,p=0,A=0;const g=new it,v=new Mn,b=new Mn,x=new it,E=new Mn,S=new Mn,M=new Mn,C=new Mn,T=[],L={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const Oe=i.domElement.getBoundingClientRect(),$e=i.domElement.ownerDocument.documentElement;i.screen.left=Oe.left+window.pageXOffset-$e.clientLeft,i.screen.top=Oe.top+window.pageYOffset-$e.clientTop,i.screen.width=Oe.width,i.screen.height=Oe.height};const B=function(){const Oe=new Mn;return function(nt,gt){return Oe.set((nt-i.screen.left)/i.screen.width,(gt-i.screen.top)/i.screen.height),Oe}}(),F=function(){const Oe=new Mn;return function(nt,gt){return Oe.set((nt-i.screen.width*.5-i.screen.left)/(i.screen.width*.5),(i.screen.height+2*(i.screen.top-gt))/i.screen.width),Oe}}();this.rotateCamera=function(){const Oe=new it,$e=new za,nt=new it,gt=new it,Tt=new it,Ze=new it;return function(){Ze.set(b.x-v.x,b.y-v.y,0);let Ft=Ze.length();Ft?(g.copy(i.object.position).sub(i.target),nt.copy(g).normalize(),gt.copy(i.object.up).normalize(),Tt.crossVectors(gt,nt).normalize(),gt.setLength(b.y-v.y),Tt.setLength(b.x-v.x),Ze.copy(gt.add(Tt)),Oe.crossVectors(Ze,g).normalize(),Ft*=i.rotateSpeed,$e.setFromAxisAngle(Oe,Ft),g.applyQuaternion($e),i.object.up.applyQuaternion($e),x.copy(Oe),A=Ft):!i.staticMoving&&A&&(A*=Math.sqrt(1-i.dynamicDampingFactor),g.copy(i.object.position).sub(i.target),$e.setFromAxisAngle(x,A),g.applyQuaternion($e),i.object.up.applyQuaternion($e)),v.copy(b)}}(),this.zoomCamera=function(){let Oe;h===o.TOUCH_ZOOM_PAN?(Oe=f/p,f=p,i.object.isPerspectiveCamera?g.multiplyScalar(Oe):i.object.isOrthographicCamera?(i.object.zoom=Vb.clamp(i.object.zoom/Oe,i.minZoom,i.maxZoom),u!==i.object.zoom&&i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(Oe=1+(S.y-E.y)*i.zoomSpeed,Oe!==1&&Oe>0&&(i.object.isPerspectiveCamera?g.multiplyScalar(Oe):i.object.isOrthographicCamera?(i.object.zoom=Vb.clamp(i.object.zoom/Oe,i.minZoom,i.maxZoom),u!==i.object.zoom&&i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),i.staticMoving?E.copy(S):E.y+=(S.y-E.y)*this.dynamicDampingFactor)},this.panCamera=function(){const Oe=new Mn,$e=new it,nt=new it;return function(){if(Oe.copy(C).sub(M),Oe.lengthSq()){if(i.object.isOrthographicCamera){const Tt=(i.object.right-i.object.left)/i.object.zoom/i.domElement.clientWidth,Ze=(i.object.top-i.object.bottom)/i.object.zoom/i.domElement.clientWidth;Oe.x*=Tt,Oe.y*=Ze}Oe.multiplyScalar(g.length()*i.panSpeed),nt.copy(g).cross(i.object.up).setLength(Oe.x),nt.add($e.copy(i.object.up).setLength(Oe.y)),i.object.position.add(nt),i.target.add(nt),i.staticMoving?M.copy(C):M.add(Oe.subVectors(C,M).multiplyScalar(i.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!i.noZoom||!i.noPan)&&(g.lengthSq()>i.maxDistance*i.maxDistance&&(i.object.position.addVectors(i.target,g.setLength(i.maxDistance)),E.copy(S)),g.lengthSq()<i.minDistance*i.minDistance&&(i.object.position.addVectors(i.target,g.setLength(i.minDistance)),E.copy(S)))},this.update=function(){g.subVectors(i.object.position,i.target),i.noRotate||i.rotateCamera(),i.noZoom||i.zoomCamera(),i.noPan||i.panCamera(),i.object.position.addVectors(i.target,g),i.object.isPerspectiveCamera?(i.checkDistances(),i.object.lookAt(i.target),c.distanceToSquared(i.object.position)>a&&(i.dispatchEvent(rb),c.copy(i.object.position))):i.object.isOrthographicCamera?(i.object.lookAt(i.target),(c.distanceToSquared(i.object.position)>a||u!==i.object.zoom)&&(i.dispatchEvent(rb),c.copy(i.object.position),u=i.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){h=o.NONE,d=o.NONE,i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.up.copy(i.up0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),g.subVectors(i.object.position,i.target),i.object.lookAt(i.target),i.dispatchEvent(rb),c.copy(i.object.position),u=i.object.zoom};function D(Oe){i.enabled!==!1&&(T.length===0&&(i.domElement.setPointerCapture(Oe.pointerId),i.domElement.addEventListener("pointermove",P),i.domElement.addEventListener("pointerup",U)),Pe(Oe),Oe.pointerType==="touch"?Z(Oe):j(Oe))}function P(Oe){i.enabled!==!1&&(Oe.pointerType==="touch"?ee(Oe):G(Oe))}function U(Oe){i.enabled!==!1&&(Oe.pointerType==="touch"?oe(Oe):H(),me(Oe),T.length===0&&(i.domElement.releasePointerCapture(Oe.pointerId),i.domElement.removeEventListener("pointermove",P),i.domElement.removeEventListener("pointerup",U)))}function K(Oe){me(Oe)}function J(Oe){i.enabled!==!1&&(window.removeEventListener("keydown",J),d===o.NONE&&(Oe.code===i.keys[o.ROTATE]&&!i.noRotate?d=o.ROTATE:Oe.code===i.keys[o.ZOOM]&&!i.noZoom?d=o.ZOOM:Oe.code===i.keys[o.PAN]&&!i.noPan&&(d=o.PAN)))}function z(){i.enabled!==!1&&(d=o.NONE,window.addEventListener("keydown",J))}function j(Oe){if(h===o.NONE)switch(Oe.button){case i.mouseButtons.LEFT:h=o.ROTATE;break;case i.mouseButtons.MIDDLE:h=o.ZOOM;break;case i.mouseButtons.RIGHT:h=o.PAN;break}const $e=d!==o.NONE?d:h;$e===o.ROTATE&&!i.noRotate?(b.copy(F(Oe.pageX,Oe.pageY)),v.copy(b)):$e===o.ZOOM&&!i.noZoom?(E.copy(B(Oe.pageX,Oe.pageY)),S.copy(E)):$e===o.PAN&&!i.noPan&&(M.copy(B(Oe.pageX,Oe.pageY)),C.copy(M)),i.dispatchEvent(sb)}function G(Oe){const $e=d!==o.NONE?d:h;$e===o.ROTATE&&!i.noRotate?(v.copy(b),b.copy(F(Oe.pageX,Oe.pageY))):$e===o.ZOOM&&!i.noZoom?S.copy(B(Oe.pageX,Oe.pageY)):$e===o.PAN&&!i.noPan&&C.copy(B(Oe.pageX,Oe.pageY))}function H(){h=o.NONE,i.dispatchEvent(ob)}function te(Oe){if(i.enabled!==!1&&i.noZoom!==!0){switch(Oe.preventDefault(),Oe.deltaMode){case 2:E.y-=Oe.deltaY*.025;break;case 1:E.y-=Oe.deltaY*.01;break;default:E.y-=Oe.deltaY*25e-5;break}i.dispatchEvent(sb),i.dispatchEvent(ob)}}function Z(Oe){switch(Ce(Oe),T.length){case 1:h=o.TOUCH_ROTATE,b.copy(F(T[0].pageX,T[0].pageY)),v.copy(b);break;default:h=o.TOUCH_ZOOM_PAN;const $e=T[0].pageX-T[1].pageX,nt=T[0].pageY-T[1].pageY;p=f=Math.sqrt($e*$e+nt*nt);const gt=(T[0].pageX+T[1].pageX)/2,Tt=(T[0].pageY+T[1].pageY)/2;M.copy(B(gt,Tt)),C.copy(M);break}i.dispatchEvent(sb)}function ee(Oe){switch(Ce(Oe),T.length){case 1:v.copy(b),b.copy(F(Oe.pageX,Oe.pageY));break;default:const $e=Je(Oe),nt=Oe.pageX-$e.x,gt=Oe.pageY-$e.y;p=Math.sqrt(nt*nt+gt*gt);const Tt=(Oe.pageX+$e.x)/2,Ze=(Oe.pageY+$e.y)/2;C.copy(B(Tt,Ze));break}}function oe(Oe){switch(T.length){case 0:h=o.NONE;break;case 1:h=o.TOUCH_ROTATE,b.copy(F(Oe.pageX,Oe.pageY)),v.copy(b);break;case 2:h=o.TOUCH_ZOOM_PAN;for(let $e=0;$e<T.length;$e++)if(T[$e].pointerId!==Oe.pointerId){const nt=L[T[$e].pointerId];b.copy(F(nt.x,nt.y)),v.copy(b);break}break}i.dispatchEvent(ob)}function xe(Oe){i.enabled!==!1&&Oe.preventDefault()}function Pe(Oe){T.push(Oe)}function me(Oe){delete L[Oe.pointerId];for(let $e=0;$e<T.length;$e++)if(T[$e].pointerId==Oe.pointerId){T.splice($e,1);return}}function Ce(Oe){let $e=L[Oe.pointerId];$e===void 0&&($e=new Mn,L[Oe.pointerId]=$e),$e.set(Oe.pageX,Oe.pageY)}function Je(Oe){const $e=Oe.pointerId===T[0].pointerId?T[1]:T[0];return L[$e.pointerId]}this.dispose=function(){i.domElement.removeEventListener("contextmenu",xe),i.domElement.removeEventListener("pointerdown",D),i.domElement.removeEventListener("pointercancel",K),i.domElement.removeEventListener("wheel",te),i.domElement.removeEventListener("pointermove",P),i.domElement.removeEventListener("pointerup",U),window.removeEventListener("keydown",J),window.removeEventListener("keyup",z)},this.domElement.addEventListener("contextmenu",xe),this.domElement.addEventListener("pointerdown",D),this.domElement.addEventListener("pointercancel",K),this.domElement.addEventListener("wheel",te,{passive:!1}),window.addEventListener("keydown",J),window.addEventListener("keyup",z),this.handleResize(),this.update()}}const DR={type:"change"},ab={type:"start"},OR={type:"end"},z0=new Xv,FR=new Vl,DY=Math.cos(70*Vb.DEG2RAD);class OY extends Ga{constructor(e,n){super(),this.object=e,this.domElement=n,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new it,this.cursor=new it,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ja.ROTATE,MIDDLE:Ja.DOLLY,RIGHT:Ja.PAN},this.touches={ONE:bd.ROTATE,TWO:bd.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(k){k.addEventListener("keydown",_e),this._domElementKeyEvents=k},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",_e),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(DR),i.update(),a=o.NONE},this.update=function(){const k=new it,he=new za().setFromUnitVectors(e.up,new it(0,1,0)),Re=he.clone().invert(),We=new it,ve=new za,at=new it,At=2*Math.PI;return function(Pt=null){const $t=i.object.position;k.copy($t).sub(i.target),k.applyQuaternion(he),u.setFromVector3(k),i.autoRotate&&a===o.NONE&&K(P(Pt)),i.enableDamping?(u.theta+=h.theta*i.dampingFactor,u.phi+=h.phi*i.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let Bn=i.minAzimuthAngle,pi=i.maxAzimuthAngle;isFinite(Bn)&&isFinite(pi)&&(Bn<-Math.PI?Bn+=At:Bn>Math.PI&&(Bn-=At),pi<-Math.PI?pi+=At:pi>Math.PI&&(pi-=At),Bn<=pi?u.theta=Math.max(Bn,Math.min(pi,u.theta)):u.theta=u.theta>(Bn+pi)/2?Math.max(Bn,u.theta):Math.min(pi,u.theta)),u.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,u.phi)),u.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(f,i.dampingFactor):i.target.add(f),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor),i.zoomToCursor&&L||i.object.isOrthographicCamera?u.radius=ee(u.radius):u.radius=ee(u.radius*d),k.setFromSpherical(u),k.applyQuaternion(Re),$t.copy(i.target).add(k),i.object.lookAt(i.target),i.enableDamping===!0?(h.theta*=1-i.dampingFactor,h.phi*=1-i.dampingFactor,f.multiplyScalar(1-i.dampingFactor)):(h.set(0,0,0),f.set(0,0,0));let Ri=!1;if(i.zoomToCursor&&L){let Fn=null;if(i.object.isPerspectiveCamera){const sn=k.length();Fn=ee(sn*d);const Rt=sn-Fn;i.object.position.addScaledVector(C,Rt),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const sn=new it(T.x,T.y,0);sn.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/d)),i.object.updateProjectionMatrix(),Ri=!0;const Rt=new it(T.x,T.y,0);Rt.unproject(i.object),i.object.position.sub(Rt).add(sn),i.object.updateMatrixWorld(),Fn=k.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;Fn!==null&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Fn).add(i.object.position):(z0.origin.copy(i.object.position),z0.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(z0.direction))<DY?e.lookAt(i.target):(FR.setFromNormalAndCoplanarPoint(i.object.up,i.target),z0.intersectPlane(FR,i.target))))}else i.object.isOrthographicCamera&&(Ri=d!==1,Ri&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/d)),i.object.updateProjectionMatrix()));return d=1,L=!1,Ri||We.distanceToSquared(i.object.position)>c||8*(1-ve.dot(i.object.quaternion))>c||at.distanceToSquared(i.target)>0?(i.dispatchEvent(DR),We.copy(i.object.position),ve.copy(i.object.quaternion),at.copy(i.target),!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",De),i.domElement.removeEventListener("pointerdown",Fe),i.domElement.removeEventListener("pointercancel",pt),i.domElement.removeEventListener("wheel",Vt),i.domElement.removeEventListener("pointermove",Te),i.domElement.removeEventListener("pointerup",pt),i._domElementKeyEvents!==null&&(i._domElementKeyEvents.removeEventListener("keydown",_e),i._domElementKeyEvents=null)};const i=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=o.NONE;const c=1e-6,u=new Wb,h=new Wb;let d=1;const f=new it,p=new Mn,A=new Mn,g=new Mn,v=new Mn,b=new Mn,x=new Mn,E=new Mn,S=new Mn,M=new Mn,C=new it,T=new Mn;let L=!1;const B=[],F={};let D=!1;function P(k){return k!==null?2*Math.PI/60*i.autoRotateSpeed*k:2*Math.PI/60/60*i.autoRotateSpeed}function U(k){const he=Math.abs(k*.01);return Math.pow(.95,i.zoomSpeed*he)}function K(k){h.theta-=k}function J(k){h.phi-=k}const z=function(){const k=new it;return function(Re,We){k.setFromMatrixColumn(We,0),k.multiplyScalar(-Re),f.add(k)}}(),j=function(){const k=new it;return function(Re,We){i.screenSpacePanning===!0?k.setFromMatrixColumn(We,1):(k.setFromMatrixColumn(We,0),k.crossVectors(i.object.up,k)),k.multiplyScalar(Re),f.add(k)}}(),G=function(){const k=new it;return function(Re,We){const ve=i.domElement;if(i.object.isPerspectiveCamera){const at=i.object.position;k.copy(at).sub(i.target);let At=k.length();At*=Math.tan(i.object.fov/2*Math.PI/180),z(2*Re*At/ve.clientHeight,i.object.matrix),j(2*We*At/ve.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(z(Re*(i.object.right-i.object.left)/i.object.zoom/ve.clientWidth,i.object.matrix),j(We*(i.object.top-i.object.bottom)/i.object.zoom/ve.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function H(k){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?d/=k:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function te(k){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?d*=k:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Z(k,he){if(!i.zoomToCursor)return;L=!0;const Re=i.domElement.getBoundingClientRect(),We=k-Re.left,ve=he-Re.top,at=Re.width,At=Re.height;T.x=We/at*2-1,T.y=-(ve/At)*2+1,C.set(T.x,T.y,1).unproject(i.object).sub(i.object.position).normalize()}function ee(k){return Math.max(i.minDistance,Math.min(i.maxDistance,k))}function oe(k){p.set(k.clientX,k.clientY)}function xe(k){Z(k.clientX,k.clientX),E.set(k.clientX,k.clientY)}function Pe(k){v.set(k.clientX,k.clientY)}function me(k){A.set(k.clientX,k.clientY),g.subVectors(A,p).multiplyScalar(i.rotateSpeed);const he=i.domElement;K(2*Math.PI*g.x/he.clientHeight),J(2*Math.PI*g.y/he.clientHeight),p.copy(A),i.update()}function Ce(k){S.set(k.clientX,k.clientY),M.subVectors(S,E),M.y>0?H(U(M.y)):M.y<0&&te(U(M.y)),E.copy(S),i.update()}function Je(k){b.set(k.clientX,k.clientY),x.subVectors(b,v).multiplyScalar(i.panSpeed),G(x.x,x.y),v.copy(b),i.update()}function Oe(k){Z(k.clientX,k.clientY),k.deltaY<0?te(U(k.deltaY)):k.deltaY>0&&H(U(k.deltaY)),i.update()}function $e(k){let he=!1;switch(k.code){case i.keys.UP:k.ctrlKey||k.metaKey||k.shiftKey?J(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(0,i.keyPanSpeed),he=!0;break;case i.keys.BOTTOM:k.ctrlKey||k.metaKey||k.shiftKey?J(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(0,-i.keyPanSpeed),he=!0;break;case i.keys.LEFT:k.ctrlKey||k.metaKey||k.shiftKey?K(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(i.keyPanSpeed,0),he=!0;break;case i.keys.RIGHT:k.ctrlKey||k.metaKey||k.shiftKey?K(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):G(-i.keyPanSpeed,0),he=!0;break}he&&(k.preventDefault(),i.update())}function nt(k){if(B.length===1)p.set(k.pageX,k.pageY);else{const he=ne(k),Re=.5*(k.pageX+he.x),We=.5*(k.pageY+he.y);p.set(Re,We)}}function gt(k){if(B.length===1)v.set(k.pageX,k.pageY);else{const he=ne(k),Re=.5*(k.pageX+he.x),We=.5*(k.pageY+he.y);v.set(Re,We)}}function Tt(k){const he=ne(k),Re=k.pageX-he.x,We=k.pageY-he.y,ve=Math.sqrt(Re*Re+We*We);E.set(0,ve)}function Ze(k){i.enableZoom&&Tt(k),i.enablePan&&gt(k)}function mn(k){i.enableZoom&&Tt(k),i.enableRotate&&nt(k)}function Ft(k){if(B.length==1)A.set(k.pageX,k.pageY);else{const Re=ne(k),We=.5*(k.pageX+Re.x),ve=.5*(k.pageY+Re.y);A.set(We,ve)}g.subVectors(A,p).multiplyScalar(i.rotateSpeed);const he=i.domElement;K(2*Math.PI*g.x/he.clientHeight),J(2*Math.PI*g.y/he.clientHeight),p.copy(A)}function Qt(k){if(B.length===1)b.set(k.pageX,k.pageY);else{const he=ne(k),Re=.5*(k.pageX+he.x),We=.5*(k.pageY+he.y);b.set(Re,We)}x.subVectors(b,v).multiplyScalar(i.panSpeed),G(x.x,x.y),v.copy(b)}function Xt(k){const he=ne(k),Re=k.pageX-he.x,We=k.pageY-he.y,ve=Math.sqrt(Re*Re+We*We);S.set(0,ve),M.set(0,Math.pow(S.y/E.y,i.zoomSpeed)),H(M.y),E.copy(S);const at=(k.pageX+he.x)*.5,At=(k.pageY+he.y)*.5;Z(at,At)}function Tn(k){i.enableZoom&&Xt(k),i.enablePan&&Qt(k)}function vn(k){i.enableZoom&&Xt(k),i.enableRotate&&Ft(k)}function Fe(k){i.enabled!==!1&&(B.length===0&&(i.domElement.setPointerCapture(k.pointerId),i.domElement.addEventListener("pointermove",Te),i.domElement.addEventListener("pointerup",pt)),ke(k),k.pointerType==="touch"?Ne(k):Nt(k))}function Te(k){i.enabled!==!1&&(k.pointerType==="touch"?ye(k):zt(k))}function pt(k){switch(Ye(k),B.length){case 0:i.domElement.releasePointerCapture(k.pointerId),i.domElement.removeEventListener("pointermove",Te),i.domElement.removeEventListener("pointerup",pt),i.dispatchEvent(OR),a=o.NONE;break;case 1:const he=B[0],Re=F[he];Ne({pointerId:he,pageX:Re.x,pageY:Re.y});break}}function Nt(k){let he;switch(k.button){case 0:he=i.mouseButtons.LEFT;break;case 1:he=i.mouseButtons.MIDDLE;break;case 2:he=i.mouseButtons.RIGHT;break;default:he=-1}switch(he){case Ja.DOLLY:if(i.enableZoom===!1)return;xe(k),a=o.DOLLY;break;case Ja.ROTATE:if(k.ctrlKey||k.metaKey||k.shiftKey){if(i.enablePan===!1)return;Pe(k),a=o.PAN}else{if(i.enableRotate===!1)return;oe(k),a=o.ROTATE}break;case Ja.PAN:if(k.ctrlKey||k.metaKey||k.shiftKey){if(i.enableRotate===!1)return;oe(k),a=o.ROTATE}else{if(i.enablePan===!1)return;Pe(k),a=o.PAN}break;default:a=o.NONE}a!==o.NONE&&i.dispatchEvent(ab)}function zt(k){switch(a){case o.ROTATE:if(i.enableRotate===!1)return;me(k);break;case o.DOLLY:if(i.enableZoom===!1)return;Ce(k);break;case o.PAN:if(i.enablePan===!1)return;Je(k);break}}function Vt(k){i.enabled===!1||i.enableZoom===!1||a!==o.NONE||(k.preventDefault(),i.dispatchEvent(ab),Oe(fn(k)),i.dispatchEvent(OR))}function fn(k){const he=k.deltaMode,Re={clientX:k.clientX,clientY:k.clientY,deltaY:k.deltaY};switch(he){case 1:Re.deltaY*=16;break;case 2:Re.deltaY*=100;break}return k.ctrlKey&&!D&&(Re.deltaY*=10),Re}function mt(k){k.key==="Control"&&(D=!0,i.domElement.getRootNode().addEventListener("keyup",Ee,{passive:!0,capture:!0}))}function Ee(k){k.key==="Control"&&(D=!1,i.domElement.getRootNode().removeEventListener("keyup",Ee,{passive:!0,capture:!0}))}function _e(k){i.enabled===!1||i.enablePan===!1||$e(k)}function Ne(k){switch(Qe(k),B.length){case 1:switch(i.touches.ONE){case bd.ROTATE:if(i.enableRotate===!1)return;nt(k),a=o.TOUCH_ROTATE;break;case bd.PAN:if(i.enablePan===!1)return;gt(k),a=o.TOUCH_PAN;break;default:a=o.NONE}break;case 2:switch(i.touches.TWO){case bd.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Ze(k),a=o.TOUCH_DOLLY_PAN;break;case bd.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;mn(k),a=o.TOUCH_DOLLY_ROTATE;break;default:a=o.NONE}break;default:a=o.NONE}a!==o.NONE&&i.dispatchEvent(ab)}function ye(k){switch(Qe(k),a){case o.TOUCH_ROTATE:if(i.enableRotate===!1)return;Ft(k),i.update();break;case o.TOUCH_PAN:if(i.enablePan===!1)return;Qt(k),i.update();break;case o.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Tn(k),i.update();break;case o.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;vn(k),i.update();break;default:a=o.NONE}}function De(k){i.enabled!==!1&&k.preventDefault()}function ke(k){B.push(k.pointerId)}function Ye(k){delete F[k.pointerId];for(let he=0;he<B.length;he++)if(B[he]==k.pointerId){B.splice(he,1);return}}function Qe(k){let he=F[k.pointerId];he===void 0&&(he=new Mn,F[k.pointerId]=he),he.set(k.pageX,k.pageY)}function ne(k){const he=k.pointerId===B[0]?B[1]:B[0];return F[he]}i.domElement.addEventListener("contextmenu",De),i.domElement.addEventListener("pointerdown",Fe),i.domElement.addEventListener("pointercancel",pt),i.domElement.addEventListener("wheel",Vt,{passive:!1}),i.domElement.getRootNode().addEventListener("keydown",mt,{passive:!0,capture:!0}),this.update()}}const FY={type:"change"};class NY extends Ga{constructor(e,n){super(),this.object=e,this.domElement=n,this.enabled=!0,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const i=this,o=1e-6,a=new za,c=new it;this.tmpQuaternion=new za,this.status=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new it(0,0,0),this.rotationVector=new it(0,0,0),this.keydown=function(v){if(!(v.altKey||this.enabled===!1)){switch(v.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1;break}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(v){if(this.enabled!==!1){switch(v.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0;break}this.updateMovementVector(),this.updateRotationVector()}},this.pointerdown=function(v){if(this.enabled!==!1)if(this.dragToLook)this.status++;else{switch(v.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1;break}this.updateMovementVector()}},this.pointermove=function(v){if(this.enabled!==!1&&(!this.dragToLook||this.status>0)){const b=this.getContainerDimensions(),x=b.size[0]/2,E=b.size[1]/2;this.moveState.yawLeft=-(v.pageX-b.offset[0]-x)/x,this.moveState.pitchDown=(v.pageY-b.offset[1]-E)/E,this.updateRotationVector()}},this.pointerup=function(v){if(this.enabled!==!1){if(this.dragToLook)this.status--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(v.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0;break}this.updateMovementVector()}this.updateRotationVector()}},this.pointercancel=function(){this.enabled!==!1&&(this.dragToLook?(this.status=0,this.moveState.yawLeft=this.moveState.pitchDown=0):(this.moveState.forward=0,this.moveState.back=0,this.updateMovementVector()),this.updateRotationVector())},this.contextMenu=function(v){this.enabled!==!1&&v.preventDefault()},this.update=function(v){if(this.enabled===!1)return;const b=v*i.movementSpeed,x=v*i.rollSpeed;i.object.translateX(i.moveVector.x*b),i.object.translateY(i.moveVector.y*b),i.object.translateZ(i.moveVector.z*b),i.tmpQuaternion.set(i.rotationVector.x*x,i.rotationVector.y*x,i.rotationVector.z*x,1).normalize(),i.object.quaternion.multiply(i.tmpQuaternion),(c.distanceToSquared(i.object.position)>o||8*(1-a.dot(i.object.quaternion))>o)&&(i.dispatchEvent(FY),a.copy(i.object.quaternion),c.copy(i.object.position))},this.updateMovementVector=function(){const v=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-v+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",u),this.domElement.removeEventListener("pointerdown",d),this.domElement.removeEventListener("pointermove",h),this.domElement.removeEventListener("pointerup",f),this.domElement.removeEventListener("pointercancel",p),window.removeEventListener("keydown",A),window.removeEventListener("keyup",g)};const u=this.contextMenu.bind(this),h=this.pointermove.bind(this),d=this.pointerdown.bind(this),f=this.pointerup.bind(this),p=this.pointercancel.bind(this),A=this.keydown.bind(this),g=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",u),this.domElement.addEventListener("pointerdown",d),this.domElement.addEventListener("pointermove",h),this.domElement.addEventListener("pointerup",f),this.domElement.addEventListener("pointercancel",p),window.addEventListener("keydown",A),window.addEventListener("keyup",g),this.updateMovementVector(),this.updateRotationVector()}}const UY={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class ny{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const kY=new W_(-1,1,1,-1,0,1);class zY extends Lo{constructor(){super(),this.setAttribute("position",new As([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new As([0,2,0,0,2,0],2))}}const GY=new zY;class VY{constructor(e){this._mesh=new Qo(GY,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,kY)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class HY extends ny{constructor(e,n){super(),this.textureID=n!==void 0?n:"tDiffuse",e instanceof nl?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=EB.clone(e.uniforms),this.material=new nl({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new VY(this.material)}render(e,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class NR extends ny{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,i){const o=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0);let c,u;this.inverse?(c=0,u=1):(c=1,u=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),a.buffers.stencil.setFunc(o.ALWAYS,c,4294967295),a.buffers.stencil.setClear(u),a.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.color.setMask(!0),a.buffers.depth.setMask(!0),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(o.EQUAL,1,4294967295),a.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),a.buffers.stencil.setLocked(!0)}}class jY extends ny{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class WY{constructor(e,n){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),n===void 0){const i=e.getSize(new Mn);this._width=i.width,this._height=i.height,n=new Yc(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:df}),n.texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new HY(UY),this.copyPass.material.blending=$l,this.clock=new UB}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let i=!1;for(let o=0,a=this.passes.length;o<a;o++){const c=this.passes[o];if(c.enabled!==!1){if(c.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(o),c.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),c.needsSwap){if(i){const u=this.renderer.getContext(),h=this.renderer.state.buffers.stencil;h.setFunc(u.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),h.setFunc(u.EQUAL,1,4294967295)}this.swapBuffers()}NR!==void 0&&(c instanceof NR?i=!0:c instanceof jY&&(i=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Mn);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const i=this._width*this._pixelRatio,o=this._height*this._pixelRatio;this.renderTarget1.setSize(i,o),this.renderTarget2.setSize(i,o);for(let a=0;a<this.passes.length;a++)this.passes[a].setSize(i,o)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class QY extends ny{constructor(e,n,i=null,o=null,a=null){super(),this.scene=e,this.camera=n,this.overrideMaterial=i,this.clearColor=o,this.clearAlpha=a,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new or}render(e,n,i){const o=e.autoClear;e.autoClear=!1;let a,c;this.overrideMaterial!==null&&(c=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor)),this.clearAlpha!==null&&(a=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(a),this.overrideMaterial!==null&&(this.scene.overrideMaterial=c),e.autoClear=o}}var ec=Object.freeze({Linear:Object.freeze({None:function(s){return s},In:function(s){return this.None(s)},Out:function(s){return this.None(s)},InOut:function(s){return this.None(s)}}),Quadratic:Object.freeze({In:function(s){return s*s},Out:function(s){return s*(2-s)},InOut:function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)}}),Cubic:Object.freeze({In:function(s){return s*s*s},Out:function(s){return--s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)}}),Quartic:Object.freeze({In:function(s){return s*s*s*s},Out:function(s){return 1- --s*s*s*s},InOut:function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)}}),Quintic:Object.freeze({In:function(s){return s*s*s*s*s},Out:function(s){return--s*s*s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)}}),Sinusoidal:Object.freeze({In:function(s){return 1-Math.sin((1-s)*Math.PI/2)},Out:function(s){return Math.sin(s*Math.PI/2)},InOut:function(s){return .5*(1-Math.sin(Math.PI*(.5-s)))}}),Exponential:Object.freeze({In:function(s){return s===0?0:Math.pow(1024,s-1)},Out:function(s){return s===1?1:1-Math.pow(2,-10*s)},InOut:function(s){return s===0?0:s===1?1:(s*=2)<1?.5*Math.pow(1024,s-1):.5*(-Math.pow(2,-10*(s-1))+2)}}),Circular:Object.freeze({In:function(s){return 1-Math.sqrt(1-s*s)},Out:function(s){return Math.sqrt(1- --s*s)},InOut:function(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)}}),Elastic:Object.freeze({In:function(s){return s===0?0:s===1?1:-Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI)},Out:function(s){return s===0?0:s===1?1:Math.pow(2,-10*s)*Math.sin((s-.1)*5*Math.PI)+1},InOut:function(s){return s===0?0:s===1?1:(s*=2,s<1?-.5*Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI):.5*Math.pow(2,-10*(s-1))*Math.sin((s-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(s){var e=1.70158;return s===1?1:s*s*((e+1)*s-e)},Out:function(s){var e=1.70158;return s===0?0:--s*s*((e+1)*s+e)+1},InOut:function(s){var e=2.5949095;return(s*=2)<1?.5*(s*s*((e+1)*s-e)):.5*((s-=2)*s*((e+1)*s+e)+2)}}),Bounce:Object.freeze({In:function(s){return 1-ec.Bounce.Out(1-s)},Out:function(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},InOut:function(s){return s<.5?ec.Bounce.In(s*2)*.5:ec.Bounce.Out(s*2-1)*.5+.5}}),generatePow:function(s){return s===void 0&&(s=4),s=s<Number.EPSILON?Number.EPSILON:s,s=s>1e4?1e4:s,{In:function(e){return Math.pow(e,s)},Out:function(e){return 1-Math.pow(1-e,s)},InOut:function(e){return e<.5?Math.pow(e*2,s)/2:(1-Math.pow(2-e*2,s))/2+.5}}}}),qp=function(){return performance.now()},XY=function(){function s(){this._tweens={},this._tweensAddedDuringUpdate={}}return s.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},s.prototype.removeAll=function(){this._tweens={}},s.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},s.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},s.prototype.update=function(e,n){e===void 0&&(e=qp()),n===void 0&&(n=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var o=0;o<i.length;o++){var a=this._tweens[i[o]],c=!n;a&&a.update(e,c)===!1&&!n&&delete this._tweens[i[o]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},s}(),tf={Linear:function(s,e){var n=s.length-1,i=n*e,o=Math.floor(i),a=tf.Utils.Linear;return e<0?a(s[0],s[1],i):e>1?a(s[n],s[n-1],n-i):a(s[o],s[o+1>n?n:o+1],i-o)},Bezier:function(s,e){for(var n=0,i=s.length-1,o=Math.pow,a=tf.Utils.Bernstein,c=0;c<=i;c++)n+=o(1-e,i-c)*o(e,c)*s[c]*a(i,c);return n},CatmullRom:function(s,e){var n=s.length-1,i=n*e,o=Math.floor(i),a=tf.Utils.CatmullRom;return s[0]===s[n]?(e<0&&(o=Math.floor(i=n*(1+e))),a(s[(o-1+n)%n],s[o],s[(o+1)%n],s[(o+2)%n],i-o)):e<0?s[0]-(a(s[0],s[0],s[1],s[1],-i)-s[0]):e>1?s[n]-(a(s[n],s[n],s[n-1],s[n-1],i-n)-s[n]):a(s[o?o-1:0],s[o],s[n<o+1?n:o+1],s[n<o+2?n:o+2],i-o)},Utils:{Linear:function(s,e,n){return(e-s)*n+s},Bernstein:function(s,e){var n=tf.Utils.Factorial;return n(s)/n(e)/n(s-e)},Factorial:function(){var s=[1];return function(e){var n=1;if(s[e])return s[e];for(var i=e;i>1;i--)n*=i;return s[e]=n,n}}(),CatmullRom:function(s,e,n,i,o){var a=(n-s)*.5,c=(i-e)*.5,u=o*o,h=o*u;return(2*e-2*n+a+c)*h+(-3*e+3*n-2*a-c)*u+a*o+e}}},KY=function(){function s(){}return s.nextId=function(){return s._nextId++},s._nextId=0,s}(),u_=new XY,Bv=function(){function s(e,n){n===void 0&&(n=u_),this._object=e,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ec.Linear.None,this._interpolationFunction=tf.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=KY.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return s.prototype.getId=function(){return this._id},s.prototype.isPlaying=function(){return this._isPlaying},s.prototype.isPaused=function(){return this._isPaused},s.prototype.getDuration=function(){return this._duration},s.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},s.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},s.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},s.prototype.start=function(e,n){if(e===void 0&&(e=qp()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var o={};for(var a in this._valuesEnd)o[a]=this._valuesEnd[a];this._valuesEnd=o}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},s.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},s.prototype._setupProperties=function(e,n,i,o,a){for(var c in i){var u=e[c],h=Array.isArray(u),d=h?"array":typeof u,f=!h&&Array.isArray(i[c]);if(!(d==="undefined"||d==="function")){if(f){var p=i[c];if(p.length===0)continue;for(var A=[u],g=0,v=p.length;g<v;g+=1){var b=this._handleRelativeValue(u,p[g]);if(isNaN(b)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}A.push(b)}f&&(i[c]=A)}if((d==="object"||h)&&u&&!f){n[c]=h?[]:{};var x=u;for(var E in x)n[c][E]=x[E];o[c]=h?[]:{};var p=i[c];if(!this._isDynamic){var S={};for(var E in p)S[E]=p[E];i[c]=p=S}this._setupProperties(x,n[c],p,o[c],a)}else(typeof n[c]>"u"||a)&&(n[c]=u),h||(n[c]*=1),f?o[c]=i[c].slice().reverse():o[c]=n[c]||0}}},s.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},s.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},s.prototype.pause=function(e){return e===void 0&&(e=qp()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},s.prototype.resume=function(e){return e===void 0&&(e=qp()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},s.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},s.prototype.group=function(e){return e===void 0&&(e=u_),this._group=e,this},s.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},s.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},s.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},s.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},s.prototype.easing=function(e){return e===void 0&&(e=ec.Linear.None),this._easingFunction=e,this},s.prototype.interpolation=function(e){return e===void 0&&(e=tf.Linear),this._interpolationFunction=e,this},s.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},s.prototype.onStart=function(e){return this._onStartCallback=e,this},s.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},s.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},s.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},s.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},s.prototype.onStop=function(e){return this._onStopCallback=e,this},s.prototype.update=function(e,n){var i=this,o;if(e===void 0&&(e=qp()),n===void 0&&(n=!0),this._isPaused)return!0;var a,c=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>c)return!1;n&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var u=e-this._startTime,h=this._duration+((o=this._repeatDelayTime)!==null&&o!==void 0?o:this._delayTime),d=this._duration+this._repeat*h,f=function(){if(i._duration===0||u>d)return 1;var x=Math.trunc(u/h),E=u-x*h,S=Math.min(E/i._duration,1);return S===0&&u===i._duration?1:S},p=f(),A=this._easingFunction(p);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,A),this._onUpdateCallback&&this._onUpdateCallback(this._object,p),this._duration===0||u>=this._duration)if(this._repeat>0){var g=Math.min(Math.trunc((u-this._duration)/h)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=g);for(a in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo&&this._swapEndStartRepeatValues(a),this._valuesStart[a]=this._valuesStartRepeat[a];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=h*g,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var v=0,b=this._chainedTweens.length;v<b;v++)this._chainedTweens[v].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},s.prototype._updateProperties=function(e,n,i,o){for(var a in i)if(n[a]!==void 0){var c=n[a]||0,u=i[a],h=Array.isArray(e[a]),d=Array.isArray(u),f=!h&&d;f?e[a]=this._interpolationFunction(u,o):typeof u=="object"&&u?this._updateProperties(e[a],c,u,o):(u=this._handleRelativeValue(c,u),typeof u=="number"&&(e[a]=c+(u-c)*o))}},s.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},s.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},s}(),il=u_;il.getAll.bind(il);il.removeAll.bind(il);il.add.bind(il);il.remove.bind(il);var GL=il.update.bind(il);function qY(s,e){if(e={},e.insertAt,!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",n.appendChild(i),i.styleSheet?i.styleSheet.cssText=s:i.appendChild(document.createTextNode(s))}}var YY=`.scene-nav-info {
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
}

.scene-tooltip {
  top: 0;
  color: lavender;
  font-size: 15px;
}

.scene-nav-info, .scene-tooltip {
  position: absolute;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;qY(YY);function $Y(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e!==0)for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function JY(s,e){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}function ZY(s){var e=JY(s,"string");return typeof e=="symbol"?e:e+""}function e$(s,e,n){return e=ZY(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function t$(s,e){return i$(s)||$Y(s,e)||VL(s,e)||o$()}function Np(s){return n$(s)||r$(s)||VL(s)||s$()}function n$(s){if(Array.isArray(s))return d_(s)}function i$(s){if(Array.isArray(s))return s}function r$(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function VL(s,e){if(s){if(typeof s=="string")return d_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d_(s,e)}}function d_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function s$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var kr=window.THREE?window.THREE:{WebGLRenderer:BB,Scene:wj,PerspectiveCamera:sa,Raycaster:kB,SRGBColorSpace:ms,TextureLoader:Xj,Vector2:Mn,Vector3:it,Box3:hu,Color:or,Mesh:Qo,SphereGeometry:Tm,MeshBasicMaterial:qv,BackSide:Ao,EventDispatcher:Ga,MOUSE:Ja,Quaternion:za,Spherical:Wb,Clock:UB},HL=du({props:{width:{default:window.innerWidth,onChange:function(e,n,i){isNaN(e)&&(n.width=i)}},height:{default:window.innerHeight,onChange:function(e,n,i){isNaN(e)&&(n.height=i)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null,n.toolTipElem&&(n.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){if(e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(a){return a.render(e.scene,e.camera)}),e.enablePointerInteraction){var n=null;if(e.hoverDuringDrag||!e.isPointerDragging){var i=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y).filter(function(a){return e.hoverFilter(a.object)}).sort(function(a,c){return e.hoverOrderComparator(a.object,c.object)}),o=i.length?i[0]:null;n=o?o.object:null,e.intersectionPoint=o?o.point:null}n!==e.hoverObj&&(e.onHover(n,e.hoverObj),e.toolTipElem.innerHTML=n&&ri(e.tooltipContent)(n)||"",e.hoverObj=n)}GL()}return this},getPointerPos:function(e){var n=e.pointerPos,i=n.x,o=n.y;return{x:i,y:o}},cameraPosition:function(e,n,i,o){var a=e.camera;if(n&&e.initialised){var c=n,u=i||{x:0,y:0,z:0};if(!o)f(c),p(u);else{var h=Object.assign({},a.position),d=A();new Bv(h).to(c,o).easing(ec.Quadratic.Out).onUpdate(f).start(),new Bv(d).to(u,o/3).easing(ec.Quadratic.Out).onUpdate(p).start()}return this}return Object.assign({},a.position,{lookAt:A()});function f(g){var v=g.x,b=g.y,x=g.z;v!==void 0&&(a.position.x=v),b!==void 0&&(a.position.y=b),x!==void 0&&(a.position.z=x)}function p(g){var v=new kr.Vector3(g.x,g.y,g.z);e.controls.target?e.controls.target=v:a.lookAt(v)}function A(){return Object.assign(new kr.Vector3(0,0,-1e3).applyQuaternion(a.quaternion).add(a.position))}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,o=arguments.length,a=new Array(o>3?o-3:0),c=3;c<o;c++)a[c-3]=arguments[c];return this.fitToBbox(this.getBbox.apply(this,a),n,i)},fitToBbox:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,a=e.camera;if(n){var c=new kr.Vector3(0,0,0),u=Math.max.apply(Math,Np(Object.entries(n).map(function(g){var v=t$(g,2),b=v[0],x=v[1];return Math.max.apply(Math,Np(x.map(function(E){return Math.abs(c[b]-E)})))})))*2,h=(1-o*2/e.height)*a.fov,d=u/Math.atan(h*Math.PI/180),f=d/a.aspect,p=Math.max(d,f);if(p>0){var A=c.clone().sub(a.position).normalize().multiplyScalar(-p);this.cameraPosition(A,c,i)}}return this},getBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=new kr.Box3(new kr.Vector3(0,0,0),new kr.Vector3(0,0,0)),o=e.objects.filter(n);return o.length?(o.forEach(function(a){return i.expandByObject(a)}),Object.assign.apply(Object,Np(["x","y","z"].map(function(a){return e$({},a,[i.min[a],i.max[a]])})))):null},getScreenCoords:function(e,n,i,o){var a=new kr.Vector3(n,i,o);return a.project(this.camera()),{x:(a.x+1)*e.width/2,y:-(a.y-1)*e.height/2}},getSceneCoords:function(e,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=new kr.Vector2(n/e.width*2-1,-(i/e.height)*2+1),c=new kr.Raycaster;return c.setFromCamera(a,e.camera),Object.assign({},c.ray.at(o,new kr.Vector3))},intersectingObjects:function(e,n,i){var o=new kr.Vector2(n/e.width*2-1,-(i/e.height)*2+1),a=new kr.Raycaster;return a.params.Line.threshold=e.lineHoverPrecision,a.setFromCamera(o,e.camera),a.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new kr.Scene,camera:new kr.PerspectiveCamera,clock:new kr.Clock}},init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.controlType,a=o===void 0?"trackball":o,c=i.rendererConfig,u=c===void 0?{}:c,h=i.extraRenderers,d=h===void 0?[]:h,f=i.waitForLoadComplete,p=f===void 0?!0:f;e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.className="scene-container",n.container.style.position="relative",n.container.appendChild(n.navInfo=document.createElement("div")),n.navInfo.className="scene-nav-info",n.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[a]||"",n.navInfo.style.display=n.showNavInfo?null:"none",n.toolTipElem=document.createElement("div"),n.toolTipElem.classList.add("scene-tooltip"),n.container.appendChild(n.toolTipElem),n.pointerPos=new kr.Vector2,n.pointerPos.x=-2,n.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(A){return n.container.addEventListener(A,function(g){if(A==="pointerdown"&&(n.isPointerPressed=!0),!n.isPointerDragging&&g.type==="pointermove"&&(g.pressure>0||n.isPointerPressed)&&(g.pointerType!=="touch"||g.movementX===void 0||[g.movementX,g.movementY].some(function(x){return Math.abs(x)>1}))&&(n.isPointerDragging=!0),n.enablePointerInteraction){var v=b(n.container);n.pointerPos.x=g.pageX-v.left,n.pointerPos.y=g.pageY-v.top,n.toolTipElem.style.top="".concat(n.pointerPos.y,"px"),n.toolTipElem.style.left="".concat(n.pointerPos.x,"px"),n.toolTipElem.style.transform="translate(-".concat(n.pointerPos.x/n.width*100,"%, ").concat(n.height-n.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}function b(x){var E=x.getBoundingClientRect(),S=window.pageXOffset||document.documentElement.scrollLeft,M=window.pageYOffset||document.documentElement.scrollTop;return{top:E.top+M,left:E.left+S}}},{passive:!0})}),n.container.addEventListener("pointerup",function(A){n.isPointerPressed=!1,!(n.isPointerDragging&&(n.isPointerDragging=!1,!n.clickAfterDrag))&&requestAnimationFrame(function(){A.button===0&&n.onClick(n.hoverObj||null,A,n.intersectionPoint),A.button===2&&n.onRightClick&&n.onRightClick(n.hoverObj||null,A,n.intersectionPoint)})},{passive:!0,capture:!0}),n.container.addEventListener("contextmenu",function(A){n.onRightClick&&A.preventDefault()}),n.renderer=new kr.WebGLRenderer(Object.assign({antialias:!0,alpha:!0},u)),n.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),n.container.appendChild(n.renderer.domElement),n.extraRenderers=d,n.extraRenderers.forEach(function(A){A.domElement.style.position="absolute",A.domElement.style.top="0px",A.domElement.style.pointerEvents="none",n.container.appendChild(A.domElement)}),n.postProcessingComposer=new WY(n.renderer),n.postProcessingComposer.addPass(new QY(n.scene,n.camera)),n.controls=new{trackball:PY,orbit:OY,fly:NY}[a](n.camera,n.renderer.domElement),a==="fly"&&(n.controls.movementSpeed=300,n.controls.rollSpeed=Math.PI/6,n.controls.dragToLook=!0),(a==="trackball"||a==="orbit")&&(n.controls.minDistance=.1,n.controls.maxDistance=n.skyRadius,n.controls.addEventListener("start",function(){n.controlsEngaged=!0}),n.controls.addEventListener("change",function(){n.controlsEngaged&&(n.controlsDragging=!0)}),n.controls.addEventListener("end",function(){n.controlsEngaged=!1,n.controlsDragging=!1})),[n.renderer,n.postProcessingComposer].concat(Np(n.extraRenderers)).forEach(function(A){return A.setSize(n.width,n.height)}),n.camera.aspect=n.width/n.height,n.camera.updateProjectionMatrix(),n.camera.position.z=1e3,n.scene.add(n.skysphere=new kr.Mesh),n.skysphere.visible=!1,n.loadComplete=n.scene.visible=!p,window.scene=n.scene},update:function(e,n){if(e.width&&e.height&&(n.hasOwnProperty("width")||n.hasOwnProperty("height"))&&(e.container.style.width="".concat(e.width,"px"),e.container.style.height="".concat(e.height,"px"),[e.renderer,e.postProcessingComposer].concat(Np(e.extraRenderers)).forEach(function(a){return a.setSize(e.width,e.height)}),e.camera.aspect=e.width/e.height,e.camera.updateProjectionMatrix()),n.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&n.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new kr.SphereGeometry(e.skyRadius)),n.hasOwnProperty("backgroundColor")){var i=$c(e.backgroundColor).alpha;i===void 0&&(i=1),e.renderer.setClearColor(new kr.Color(UL(1,e.backgroundColor)),i)}n.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new kr.TextureLoader().load(e.backgroundImageUrl,function(a){a.colorSpace=kr.SRGBColorSpace,e.skysphere.material=new kr.MeshBasicMaterial({map:a,side:kr.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&o()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&o())),n.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),n.hasOwnProperty("lights")&&((n.lights||[]).forEach(function(a){return e.scene.remove(a)}),e.lights.forEach(function(a){return e.scene.add(a)})),n.hasOwnProperty("objects")&&((n.objects||[]).forEach(function(a){return e.scene.remove(a)}),e.objects.forEach(function(a){return e.scene.add(a)}));function o(){e.loadComplete=e.scene.visible=!0}}});function a$(s,e){e===void 0&&(e={});var n=e.insertAt;if(!(!s||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=s:o.appendChild(document.createTextNode(s))}}var l$=`.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}`;a$(l$);function UR(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),n.push.apply(n,i)}return n}function G0(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UR(Object(n),!0).forEach(function(i){Lm(s,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):UR(Object(n)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(n,i))})}return s}function c$(s,e){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function h$(s){var e=c$(s,"string");return typeof e=="symbol"?e:e+""}function Lm(s,e,n){return e=h$(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function iy(s){return u$(s)||d$(s)||f$(s)||p$()}function u$(s){if(Array.isArray(s))return f_(s)}function d$(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function f$(s,e){if(s){if(typeof s=="string")return f_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f_(s,e)}}function f_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function p$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jL(s,e){var n=new e;return n._destructor&&n._destructor(),{linkProp:function(o){return{default:n[o](),onChange:function(c,u){u[s][o](c)},triggerUpdate:!1}},linkMethod:function(o){return function(a){for(var c=a[s],u=arguments.length,h=new Array(u>1?u-1:0),d=1;d<u;d++)h[d-1]=arguments[d];var f=c[o].apply(c,h);return f===c?this:f}}}}var lb=window.THREE?window.THREE:{AmbientLight:$j,DirectionalLight:Yj,Vector3:it,REVISION:Hv},m$=170,WL=jL("forceGraph",pw),g$=Object.assign.apply(Object,iy(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(s){return Lm({},s,WL.linkProp(s))}))),A$=Object.assign.apply(Object,iy(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(s){return Lm({},s,WL.linkMethod(s))}))),nv=jL("renderObjs",HL),v$=Object.assign.apply(Object,iy(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(s){return Lm({},s,nv.linkProp(s))}))),y$=Object.assign.apply(Object,iy(["lights","cameraPosition","postProcessingComposer"].map(function(s){return Lm({},s,nv.linkMethod(s))})).concat([{graph2ScreenCoords:nv.linkMethod("getScreenCoords"),screen2GraphCoords:nv.linkMethod("getSceneCoords")}])),x$=du({props:G0(G0({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(e,n){return n.renderObjs.lineHoverPrecision(e)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(e,n){var i=n.renderObjs.controls();i&&(i.enabled=e,e&&i.domElement&&i.domElement.dispatchEvent(new PointerEvent("pointerup")))},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},g$),v$),methods:G0(G0({zoomToFit:function(e,n,i){for(var o,a=arguments.length,c=new Array(a>3?a-3:0),u=3;u<a;u++)c[u-3]=arguments[u];return e.renderObjs.fitToBbox((o=e.forceGraph).getGraphBbox.apply(o,c),n,i),this},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),this},_animationCycle:function(e){e.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),e.forceGraph.tickFrame(),e.renderObjs.tick(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},tbControls:function(e){return e.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},A$),y$),stateInit:function(e){var n=e.controlType,i=e.rendererConfig,o=e.extraRenderers,a=new pw;return{forceGraph:a,renderObjs:HL({controlType:n,rendererConfig:i,extraRenderers:o}).objects([a]).lights([new lb.AmbientLight(13421772,Math.PI),new lb.DirectionalLight(16777215,.6*Math.PI)])}},init:function(e,n){e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.style.position="relative";var i=document.createElement("div");n.container.appendChild(i),n.renderObjs(i);var o=n.renderObjs.camera(),a=n.renderObjs.renderer(),c=n.renderObjs.controls();c.enabled=!!n.enableNavigationControls,n.lastSetCameraZ=o.position.z;var u;n.container.appendChild(u=document.createElement("div")),u.className="graph-info-msg",u.textContent="",n.forceGraph.onLoading(function(){u.textContent="Loading..."}).onFinishLoading(function(){u.textContent=""}).onUpdate(function(){n.graphData=n.forceGraph.graphData(),o.position.x===0&&o.position.y===0&&o.position.z===n.lastSetCameraZ&&n.graphData.nodes.length&&(o.lookAt(n.forceGraph.position),n.lastSetCameraZ=o.position.z=Math.cbrt(n.graphData.nodes.length)*m$)}).onFinishUpdate(function(){if(n._dragControls){var h=n.graphData.nodes.find(function(f){return f.__initialFixedPos&&!f.__disposeControlsAfterDrag});h?h.__disposeControlsAfterDrag=!0:n._dragControls.dispose(),n._dragControls=void 0}if(n.enableNodeDrag&&n.enablePointerInteraction&&n.forceEngine==="d3"){var d=n._dragControls=new LY(n.graphData.nodes.map(function(f){return f.__threeObj}).filter(function(f){return f}),o,a.domElement);d.addEventListener("dragstart",function(f){c.enabled=!1,f.object.__initialPos=f.object.position.clone(),f.object.__prevPos=f.object.position.clone();var p=Nl(f.object).__data;!p.__initialFixedPos&&(p.__initialFixedPos={fx:p.fx,fy:p.fy,fz:p.fz}),!p.__initialPos&&(p.__initialPos={x:p.x,y:p.y,z:p.z}),["x","y","z"].forEach(function(A){return p["f".concat(A)]=p[A]}),a.domElement.classList.add("grabbable")}),d.addEventListener("drag",function(f){var p=Nl(f.object);if(!f.object.hasOwnProperty("__graphObjType")){var A=f.object.__initialPos,g=f.object.__prevPos,v=f.object.position;p.position.add(v.clone().sub(g)),g.copy(v),v.copy(A)}var b=p.__data,x=p.position,E={x:x.x-b.x,y:x.y-b.y,z:x.z-b.z};["x","y","z"].forEach(function(S){return b["f".concat(S)]=b[S]=x[S]}),n.forceGraph.d3AlphaTarget(.3).resetCountdown(),b.__dragged=!0,n.onNodeDrag(b,E)}),d.addEventListener("dragend",function(f){delete f.object.__initialPos,delete f.object.__prevPos;var p=Nl(f.object).__data;p.__disposeControlsAfterDrag&&(d.dispose(),delete p.__disposeControlsAfterDrag);var A=p.__initialFixedPos,g=p.__initialPos,v={x:g.x-p.x,y:g.y-p.y,z:g.z-p.z};A&&(["x","y","z"].forEach(function(b){var x="f".concat(b);A[x]===void 0&&delete p[x]}),delete p.__initialFixedPos,delete p.__initialPos,p.__dragged&&(delete p.__dragged,n.onNodeDragEnd(p,v))),n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.enableNavigationControls&&(c.enabled=!0,c.domElement&&c.domElement.ownerDocument&&c.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),a.domElement.classList.remove("grabbable")})}}),lb.REVISION<155&&(n.renderObjs.renderer().useLegacyLights=!1),n.renderObjs.hoverOrderComparator(function(h,d){var f=Nl(h);if(!f)return 1;var p=Nl(d);if(!p)return-1;var A=function(v){return v.__graphObjType==="node"};return A(p)-A(f)}).tooltipContent(function(h){var d=Nl(h);return d&&ri(n["".concat(d.__graphObjType,"Label")])(d.__data)||""}).hoverDuringDrag(!1).onHover(function(h){var d=Nl(h);if(d!==n.hoverObj){var f=n.hoverObj?n.hoverObj.__graphObjType:null,p=n.hoverObj?n.hoverObj.__data:null,A=d?d.__graphObjType:null,g=d?d.__data:null;if(f&&f!==A){var v=n["on".concat(f==="node"?"Node":"Link","Hover")];v&&v(null,p)}if(A){var b=n["on".concat(A==="node"?"Node":"Link","Hover")];b&&b(g,f===A?p:null)}a.domElement.classList[d&&n["on".concat(A==="node"?"Node":"Link","Click")]||!d&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=d}}).clickAfterDrag(!1).onClick(function(h,d){var f=Nl(h);if(f){var p=n["on".concat(f.__graphObjType==="node"?"Node":"Link","Click")];p&&p(f.__data,d)}else n.onBackgroundClick&&n.onBackgroundClick(d)}).onRightClick(function(h,d){var f=Nl(h);if(f){var p=n["on".concat(f.__graphObjType==="node"?"Node":"Link","RightClick")];p&&p(f.__data,d)}else n.onBackgroundRightClick&&n.onBackgroundRightClick(d)}),this._animationCycle()}});function Nl(s){for(var e=s;e&&!e.hasOwnProperty("__graphObjType");)e=e.parent;return e}var p_="http://www.w3.org/1999/xhtml";const kR={svg:"http://www.w3.org/2000/svg",xhtml:p_,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ry(s){var e=s+="",n=e.indexOf(":");return n>=0&&(e=s.slice(0,n))!=="xmlns"&&(s=s.slice(n+1)),kR.hasOwnProperty(e)?{space:kR[e],local:s}:s}function E$(s){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===p_&&e.documentElement.namespaceURI===p_?e.createElement(s):e.createElementNS(n,s)}}function b$(s){return function(){return this.ownerDocument.createElementNS(s.space,s.local)}}function QL(s){var e=ry(s);return(e.local?b$:E$)(e)}function _$(){}function mw(s){return s==null?_$:function(){return this.querySelector(s)}}function w$(s){typeof s!="function"&&(s=mw(s));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var a=e[o],c=a.length,u=i[o]=new Array(c),h,d,f=0;f<c;++f)(h=a[f])&&(d=s.call(h,h.__data__,f,a))&&("__data__"in h&&(d.__data__=h.__data__),u[f]=d);return new Xo(i,this._parents)}function M$(s){return s==null?[]:Array.isArray(s)?s:Array.from(s)}function C$(){return[]}function XL(s){return s==null?C$:function(){return this.querySelectorAll(s)}}function S$(s){return function(){return M$(s.apply(this,arguments))}}function T$(s){typeof s=="function"?s=S$(s):s=XL(s);for(var e=this._groups,n=e.length,i=[],o=[],a=0;a<n;++a)for(var c=e[a],u=c.length,h,d=0;d<u;++d)(h=c[d])&&(i.push(s.call(h,h.__data__,d,c)),o.push(h));return new Xo(i,o)}function KL(s){return function(){return this.matches(s)}}function qL(s){return function(e){return e.matches(s)}}var R$=Array.prototype.find;function I$(s){return function(){return R$.call(this.children,s)}}function B$(){return this.firstElementChild}function L$(s){return this.select(s==null?B$:I$(typeof s=="function"?s:qL(s)))}var P$=Array.prototype.filter;function D$(){return Array.from(this.children)}function O$(s){return function(){return P$.call(this.children,s)}}function F$(s){return this.selectAll(s==null?D$:O$(typeof s=="function"?s:qL(s)))}function N$(s){typeof s!="function"&&(s=KL(s));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var a=e[o],c=a.length,u=i[o]=[],h,d=0;d<c;++d)(h=a[d])&&s.call(h,h.__data__,d,a)&&u.push(h);return new Xo(i,this._parents)}function YL(s){return new Array(s.length)}function U$(){return new Xo(this._enter||this._groups.map(YL),this._parents)}function Lv(s,e){this.ownerDocument=s.ownerDocument,this.namespaceURI=s.namespaceURI,this._next=null,this._parent=s,this.__data__=e}Lv.prototype={constructor:Lv,appendChild:function(s){return this._parent.insertBefore(s,this._next)},insertBefore:function(s,e){return this._parent.insertBefore(s,e)},querySelector:function(s){return this._parent.querySelector(s)},querySelectorAll:function(s){return this._parent.querySelectorAll(s)}};function k$(s){return function(){return s}}function z$(s,e,n,i,o,a){for(var c=0,u,h=e.length,d=a.length;c<d;++c)(u=e[c])?(u.__data__=a[c],i[c]=u):n[c]=new Lv(s,a[c]);for(;c<h;++c)(u=e[c])&&(o[c]=u)}function G$(s,e,n,i,o,a,c){var u,h,d=new Map,f=e.length,p=a.length,A=new Array(f),g;for(u=0;u<f;++u)(h=e[u])&&(A[u]=g=c.call(h,h.__data__,u,e)+"",d.has(g)?o[u]=h:d.set(g,h));for(u=0;u<p;++u)g=c.call(s,a[u],u,a)+"",(h=d.get(g))?(i[u]=h,h.__data__=a[u],d.delete(g)):n[u]=new Lv(s,a[u]);for(u=0;u<f;++u)(h=e[u])&&d.get(A[u])===h&&(o[u]=h)}function V$(s){return s.__data__}function H$(s,e){if(!arguments.length)return Array.from(this,V$);var n=e?G$:z$,i=this._parents,o=this._groups;typeof s!="function"&&(s=k$(s));for(var a=o.length,c=new Array(a),u=new Array(a),h=new Array(a),d=0;d<a;++d){var f=i[d],p=o[d],A=p.length,g=j$(s.call(f,f&&f.__data__,d,i)),v=g.length,b=u[d]=new Array(v),x=c[d]=new Array(v),E=h[d]=new Array(A);n(f,p,b,x,E,g,e);for(var S=0,M=0,C,T;S<v;++S)if(C=b[S]){for(S>=M&&(M=S+1);!(T=x[M])&&++M<v;);C._next=T||null}}return c=new Xo(c,i),c._enter=u,c._exit=h,c}function j$(s){return typeof s=="object"&&"length"in s?s:Array.from(s)}function W$(){return new Xo(this._exit||this._groups.map(YL),this._parents)}function Q$(s,e,n){var i=this.enter(),o=this,a=this.exit();return typeof s=="function"?(i=s(i),i&&(i=i.selection())):i=i.append(s+""),e!=null&&(o=e(o),o&&(o=o.selection())),n==null?a.remove():n(a),i&&o?i.merge(o).order():o}function X$(s){for(var e=s.selection?s.selection():s,n=this._groups,i=e._groups,o=n.length,a=i.length,c=Math.min(o,a),u=new Array(o),h=0;h<c;++h)for(var d=n[h],f=i[h],p=d.length,A=u[h]=new Array(p),g,v=0;v<p;++v)(g=d[v]||f[v])&&(A[v]=g);for(;h<o;++h)u[h]=n[h];return new Xo(u,this._parents)}function K$(){for(var s=this._groups,e=-1,n=s.length;++e<n;)for(var i=s[e],o=i.length-1,a=i[o],c;--o>=0;)(c=i[o])&&(a&&c.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(c,a),a=c);return this}function q$(s){s||(s=Y$);function e(p,A){return p&&A?s(p.__data__,A.__data__):!p-!A}for(var n=this._groups,i=n.length,o=new Array(i),a=0;a<i;++a){for(var c=n[a],u=c.length,h=o[a]=new Array(u),d,f=0;f<u;++f)(d=c[f])&&(h[f]=d);h.sort(e)}return new Xo(o,this._parents).order()}function Y$(s,e){return s<e?-1:s>e?1:s>=e?0:NaN}function $$(){var s=arguments[0];return arguments[0]=this,s.apply(null,arguments),this}function J$(){return Array.from(this)}function Z$(){for(var s=this._groups,e=0,n=s.length;e<n;++e)for(var i=s[e],o=0,a=i.length;o<a;++o){var c=i[o];if(c)return c}return null}function eJ(){let s=0;for(const e of this)++s;return s}function tJ(){return!this.node()}function nJ(s){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var o=e[n],a=0,c=o.length,u;a<c;++a)(u=o[a])&&s.call(u,u.__data__,a,o);return this}function iJ(s){return function(){this.removeAttribute(s)}}function rJ(s){return function(){this.removeAttributeNS(s.space,s.local)}}function sJ(s,e){return function(){this.setAttribute(s,e)}}function oJ(s,e){return function(){this.setAttributeNS(s.space,s.local,e)}}function aJ(s,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(s):this.setAttribute(s,n)}}function lJ(s,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(s.space,s.local):this.setAttributeNS(s.space,s.local,n)}}function cJ(s,e){var n=ry(s);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?rJ:iJ:typeof e=="function"?n.local?lJ:aJ:n.local?oJ:sJ)(n,e))}function $L(s){return s.ownerDocument&&s.ownerDocument.defaultView||s.document&&s||s.defaultView}function hJ(s){return function(){this.style.removeProperty(s)}}function uJ(s,e,n){return function(){this.style.setProperty(s,e,n)}}function dJ(s,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(s):this.style.setProperty(s,i,n)}}function fJ(s,e,n){return arguments.length>1?this.each((e==null?hJ:typeof e=="function"?dJ:uJ)(s,e,n??"")):gf(this.node(),s)}function gf(s,e){return s.style.getPropertyValue(e)||$L(s).getComputedStyle(s,null).getPropertyValue(e)}function pJ(s){return function(){delete this[s]}}function mJ(s,e){return function(){this[s]=e}}function gJ(s,e){return function(){var n=e.apply(this,arguments);n==null?delete this[s]:this[s]=n}}function AJ(s,e){return arguments.length>1?this.each((e==null?pJ:typeof e=="function"?gJ:mJ)(s,e)):this.node()[s]}function JL(s){return s.trim().split(/^|\s+/)}function gw(s){return s.classList||new ZL(s)}function ZL(s){this._node=s,this._names=JL(s.getAttribute("class")||"")}ZL.prototype={add:function(s){var e=this._names.indexOf(s);e<0&&(this._names.push(s),this._node.setAttribute("class",this._names.join(" ")))},remove:function(s){var e=this._names.indexOf(s);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(s){return this._names.indexOf(s)>=0}};function eP(s,e){for(var n=gw(s),i=-1,o=e.length;++i<o;)n.add(e[i])}function tP(s,e){for(var n=gw(s),i=-1,o=e.length;++i<o;)n.remove(e[i])}function vJ(s){return function(){eP(this,s)}}function yJ(s){return function(){tP(this,s)}}function xJ(s,e){return function(){(e.apply(this,arguments)?eP:tP)(this,s)}}function EJ(s,e){var n=JL(s+"");if(arguments.length<2){for(var i=gw(this.node()),o=-1,a=n.length;++o<a;)if(!i.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?xJ:e?vJ:yJ)(n,e))}function bJ(){this.textContent=""}function _J(s){return function(){this.textContent=s}}function wJ(s){return function(){var e=s.apply(this,arguments);this.textContent=e??""}}function MJ(s){return arguments.length?this.each(s==null?bJ:(typeof s=="function"?wJ:_J)(s)):this.node().textContent}function CJ(){this.innerHTML=""}function SJ(s){return function(){this.innerHTML=s}}function TJ(s){return function(){var e=s.apply(this,arguments);this.innerHTML=e??""}}function RJ(s){return arguments.length?this.each(s==null?CJ:(typeof s=="function"?TJ:SJ)(s)):this.node().innerHTML}function IJ(){this.nextSibling&&this.parentNode.appendChild(this)}function BJ(){return this.each(IJ)}function LJ(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function PJ(){return this.each(LJ)}function DJ(s){var e=typeof s=="function"?s:QL(s);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function OJ(){return null}function FJ(s,e){var n=typeof s=="function"?s:QL(s),i=e==null?OJ:typeof e=="function"?e:mw(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function NJ(){var s=this.parentNode;s&&s.removeChild(this)}function UJ(){return this.each(NJ)}function kJ(){var s=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function zJ(){var s=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function GJ(s){return this.select(s?zJ:kJ)}function VJ(s){return arguments.length?this.property("__data__",s):this.node().__data__}function HJ(s){return function(e){s.call(this,e,this.__data__)}}function jJ(s){return s.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function WJ(s){return function(){var e=this.__on;if(e){for(var n=0,i=-1,o=e.length,a;n<o;++n)a=e[n],(!s.type||a.type===s.type)&&a.name===s.name?this.removeEventListener(a.type,a.listener,a.options):e[++i]=a;++i?e.length=i:delete this.__on}}}function QJ(s,e,n){return function(){var i=this.__on,o,a=HJ(e);if(i){for(var c=0,u=i.length;c<u;++c)if((o=i[c]).type===s.type&&o.name===s.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=n),o.value=e;return}}this.addEventListener(s.type,a,n),o={type:s.type,name:s.name,value:e,listener:a,options:n},i?i.push(o):this.__on=[o]}}function XJ(s,e,n){var i=jJ(s+""),o,a=i.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var h=0,d=u.length,f;h<d;++h)for(o=0,f=u[h];o<a;++o)if((c=i[o]).type===f.type&&c.name===f.name)return f.value}return}for(u=e?QJ:WJ,o=0;o<a;++o)this.each(u(i[o],e,n));return this}function nP(s,e,n){var i=$L(s),o=i.CustomEvent;typeof o=="function"?o=new o(e,n):(o=i.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),s.dispatchEvent(o)}function KJ(s,e){return function(){return nP(this,s,e)}}function qJ(s,e){return function(){return nP(this,s,e.apply(this,arguments))}}function YJ(s,e){return this.each((typeof e=="function"?qJ:KJ)(s,e))}function*$J(){for(var s=this._groups,e=0,n=s.length;e<n;++e)for(var i=s[e],o=0,a=i.length,c;o<a;++o)(c=i[o])&&(yield c)}var iP=[null];function Xo(s,e){this._groups=s,this._parents=e}function Pm(){return new Xo([[document.documentElement]],iP)}function JJ(){return this}Xo.prototype=Pm.prototype={constructor:Xo,select:w$,selectAll:T$,selectChild:L$,selectChildren:F$,filter:N$,data:H$,enter:U$,exit:W$,join:Q$,merge:X$,selection:JJ,order:K$,sort:q$,call:$$,nodes:J$,node:Z$,size:eJ,empty:tJ,each:nJ,attr:cJ,style:fJ,property:AJ,classed:EJ,text:MJ,html:RJ,raise:BJ,lower:PJ,append:DJ,insert:FJ,remove:UJ,clone:GJ,datum:VJ,on:XJ,dispatch:YJ,[Symbol.iterator]:$J};function Ua(s){return typeof s=="string"?new Xo([[document.querySelector(s)]],[document.documentElement]):new Xo([[s]],iP)}function ZJ(s){let e;for(;e=s.sourceEvent;)s=e;return s}function Gl(s,e){if(s=ZJ(s),e===void 0&&(e=s.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=s.clientX,i.y=s.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[s.clientX-o.left-e.clientLeft,s.clientY-o.top-e.clientTop]}}return[s.pageX,s.pageY]}const eZ={passive:!1},Em={capture:!0,passive:!1};function cb(s){s.stopImmediatePropagation()}function cf(s){s.preventDefault(),s.stopImmediatePropagation()}function rP(s){var e=s.document.documentElement,n=Ua(s).on("dragstart.drag",cf,Em);"onselectstart"in e?n.on("selectstart.drag",cf,Em):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function sP(s,e){var n=s.document.documentElement,i=Ua(s).on("dragstart.drag",null);e&&(i.on("click.drag",cf,Em),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const V0=s=>()=>s;function m_(s,{sourceEvent:e,subject:n,target:i,identifier:o,active:a,x:c,y:u,dx:h,dy:d,dispatch:f}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:f}})}m_.prototype.on=function(){var s=this._.on.apply(this._,arguments);return s===this._?this:s};function tZ(s){return!s.ctrlKey&&!s.button}function nZ(){return this.parentNode}function iZ(s,e){return e??{x:s.x,y:s.y}}function rZ(){return navigator.maxTouchPoints||"ontouchstart"in this}function sZ(){var s=tZ,e=nZ,n=iZ,i=rZ,o={},a=Rm("start","drag","end"),c=0,u,h,d,f,p=0;function A(C){C.on("mousedown.drag",g).filter(i).on("touchstart.drag",x).on("touchmove.drag",E,eZ).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(C,T){if(!(f||!s.call(this,C,T))){var L=M(this,e.call(this,C,T),C,T,"mouse");L&&(Ua(C.view).on("mousemove.drag",v,Em).on("mouseup.drag",b,Em),rP(C.view),cb(C),d=!1,u=C.clientX,h=C.clientY,L("start",C))}}function v(C){if(cf(C),!d){var T=C.clientX-u,L=C.clientY-h;d=T*T+L*L>p}o.mouse("drag",C)}function b(C){Ua(C.view).on("mousemove.drag mouseup.drag",null),sP(C.view,d),cf(C),o.mouse("end",C)}function x(C,T){if(s.call(this,C,T)){var L=C.changedTouches,B=e.call(this,C,T),F=L.length,D,P;for(D=0;D<F;++D)(P=M(this,B,C,T,L[D].identifier,L[D]))&&(cb(C),P("start",C,L[D]))}}function E(C){var T=C.changedTouches,L=T.length,B,F;for(B=0;B<L;++B)(F=o[T[B].identifier])&&(cf(C),F("drag",C,T[B]))}function S(C){var T=C.changedTouches,L=T.length,B,F;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),B=0;B<L;++B)(F=o[T[B].identifier])&&(cb(C),F("end",C,T[B]))}function M(C,T,L,B,F,D){var P=a.copy(),U=Gl(D||L,T),K,J,z;if((z=n.call(C,new m_("beforestart",{sourceEvent:L,target:A,identifier:F,active:c,x:U[0],y:U[1],dx:0,dy:0,dispatch:P}),B))!=null)return K=z.x-U[0]||0,J=z.y-U[1]||0,function j(G,H,te){var Z=U,ee;switch(G){case"start":o[F]=j,ee=c++;break;case"end":delete o[F],--c;case"drag":U=Gl(te||H,T),ee=c;break}P.call(G,C,new m_(G,{sourceEvent:H,subject:z,target:A,identifier:F,active:ee,x:U[0]+K,y:U[1]+J,dx:U[0]-Z[0],dy:U[1]-Z[1],dispatch:P}),B)}}return A.filter=function(C){return arguments.length?(s=typeof C=="function"?C:V0(!!C),A):s},A.container=function(C){return arguments.length?(e=typeof C=="function"?C:V0(C),A):e},A.subject=function(C){return arguments.length?(n=typeof C=="function"?C:V0(C),A):n},A.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:V0(!!C),A):i},A.on=function(){var C=a.on.apply(a,arguments);return C===a?A:C},A.clickDistance=function(C){return arguments.length?(p=(C=+C)*C,A):Math.sqrt(p)},A}var oZ=Rm("start","end","cancel","interrupt"),aZ=[],oP=0,zR=1,g_=2,iv=3,GR=4,A_=5,rv=6;function sy(s,e,n,i,o,a){var c=s.__transition;if(!c)s.__transition={};else if(n in c)return;lZ(s,n,{name:e,index:i,group:o,on:oZ,tween:aZ,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:oP})}function Aw(s,e){var n=Va(s,e);if(n.state>oP)throw new Error("too late; already scheduled");return n}function sl(s,e){var n=Va(s,e);if(n.state>iv)throw new Error("too late; already running");return n}function Va(s,e){var n=s.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function lZ(s,e,n){var i=s.__transition,o;i[e]=n,n.timer=nw(a,0,n.time);function a(d){n.state=zR,n.timer.restart(c,n.delay,n.time),n.delay<=d&&c(d-n.delay)}function c(d){var f,p,A,g;if(n.state!==zR)return h();for(f in i)if(g=i[f],g.name===n.name){if(g.state===iv)return k3(c);g.state===GR?(g.state=rv,g.timer.stop(),g.on.call("interrupt",s,s.__data__,g.index,g.group),delete i[f]):+f<e&&(g.state=rv,g.timer.stop(),g.on.call("cancel",s,s.__data__,g.index,g.group),delete i[f])}if(k3(function(){n.state===iv&&(n.state=GR,n.timer.restart(u,n.delay,n.time),u(d))}),n.state=g_,n.on.call("start",s,s.__data__,n.index,n.group),n.state===g_){for(n.state=iv,o=new Array(A=n.tween.length),f=0,p=-1;f<A;++f)(g=n.tween[f].value.call(s,s.__data__,n.index,n.group))&&(o[++p]=g);o.length=p+1}}function u(d){for(var f=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(h),n.state=A_,1),p=-1,A=o.length;++p<A;)o[p].call(s,f);n.state===A_&&(n.on.call("end",s,s.__data__,n.index,n.group),h())}function h(){n.state=rv,n.timer.stop(),delete i[e];for(var d in i)return;delete s.__transition}}function sv(s,e){var n=s.__transition,i,o,a=!0,c;if(n){e=e==null?null:e+"";for(c in n){if((i=n[c]).name!==e){a=!1;continue}o=i.state>g_&&i.state<A_,i.state=rv,i.timer.stop(),i.on.call(o?"interrupt":"cancel",s,s.__data__,i.index,i.group),delete n[c]}a&&delete s.__transition}}function cZ(s){return this.each(function(){sv(this,s)})}function hZ(s,e){var n,i;return function(){var o=sl(this,s),a=o.tween;if(a!==n){i=n=a;for(var c=0,u=i.length;c<u;++c)if(i[c].name===e){i=i.slice(),i.splice(c,1);break}}o.tween=i}}function uZ(s,e,n){var i,o;if(typeof n!="function")throw new Error;return function(){var a=sl(this,s),c=a.tween;if(c!==i){o=(i=c).slice();for(var u={name:e,value:n},h=0,d=o.length;h<d;++h)if(o[h].name===e){o[h]=u;break}h===d&&o.push(u)}a.tween=o}}function dZ(s,e){var n=this._id;if(s+="",arguments.length<2){for(var i=Va(this.node(),n).tween,o=0,a=i.length,c;o<a;++o)if((c=i[o]).name===s)return c.value;return null}return this.each((e==null?hZ:uZ)(n,s,e))}function vw(s,e,n){var i=s._id;return s.each(function(){var o=sl(this,i);(o.value||(o.value={}))[e]=n.apply(this,arguments)}),function(o){return Va(o,i).value[e]}}function aP(s,e){var n;return(typeof e=="number"?Gc:e instanceof vm?dR:(n=vm(e))?(e=n,dR):_K)(s,e)}function fZ(s){return function(){this.removeAttribute(s)}}function pZ(s){return function(){this.removeAttributeNS(s.space,s.local)}}function mZ(s,e,n){var i,o=n+"",a;return function(){var c=this.getAttribute(s);return c===o?null:c===i?a:a=e(i=c,n)}}function gZ(s,e,n){var i,o=n+"",a;return function(){var c=this.getAttributeNS(s.space,s.local);return c===o?null:c===i?a:a=e(i=c,n)}}function AZ(s,e,n){var i,o,a;return function(){var c,u=n(this),h;return u==null?void this.removeAttribute(s):(c=this.getAttribute(s),h=u+"",c===h?null:c===i&&h===o?a:(o=h,a=e(i=c,u)))}}function vZ(s,e,n){var i,o,a;return function(){var c,u=n(this),h;return u==null?void this.removeAttributeNS(s.space,s.local):(c=this.getAttributeNS(s.space,s.local),h=u+"",c===h?null:c===i&&h===o?a:(o=h,a=e(i=c,u)))}}function yZ(s,e){var n=ry(s),i=n==="transform"?SK:aP;return this.attrTween(s,typeof e=="function"?(n.local?vZ:AZ)(n,i,vw(this,"attr."+s,e)):e==null?(n.local?pZ:fZ)(n):(n.local?gZ:mZ)(n,i,e))}function xZ(s,e){return function(n){this.setAttribute(s,e.call(this,n))}}function EZ(s,e){return function(n){this.setAttributeNS(s.space,s.local,e.call(this,n))}}function bZ(s,e){var n,i;function o(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&EZ(s,a)),n}return o._value=e,o}function _Z(s,e){var n,i;function o(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&xZ(s,a)),n}return o._value=e,o}function wZ(s,e){var n="attr."+s;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=ry(s);return this.tween(n,(i.local?bZ:_Z)(i,e))}function MZ(s,e){return function(){Aw(this,s).delay=+e.apply(this,arguments)}}function CZ(s,e){return e=+e,function(){Aw(this,s).delay=e}}function SZ(s){var e=this._id;return arguments.length?this.each((typeof s=="function"?MZ:CZ)(e,s)):Va(this.node(),e).delay}function TZ(s,e){return function(){sl(this,s).duration=+e.apply(this,arguments)}}function RZ(s,e){return e=+e,function(){sl(this,s).duration=e}}function IZ(s){var e=this._id;return arguments.length?this.each((typeof s=="function"?TZ:RZ)(e,s)):Va(this.node(),e).duration}function BZ(s,e){if(typeof e!="function")throw new Error;return function(){sl(this,s).ease=e}}function LZ(s){var e=this._id;return arguments.length?this.each(BZ(e,s)):Va(this.node(),e).ease}function PZ(s,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;sl(this,s).ease=n}}function DZ(s){if(typeof s!="function")throw new Error;return this.each(PZ(this._id,s))}function OZ(s){typeof s!="function"&&(s=KL(s));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var a=e[o],c=a.length,u=i[o]=[],h,d=0;d<c;++d)(h=a[d])&&s.call(h,h.__data__,d,a)&&u.push(h);return new nc(i,this._parents,this._name,this._id)}function FZ(s){if(s._id!==this._id)throw new Error;for(var e=this._groups,n=s._groups,i=e.length,o=n.length,a=Math.min(i,o),c=new Array(i),u=0;u<a;++u)for(var h=e[u],d=n[u],f=h.length,p=c[u]=new Array(f),A,g=0;g<f;++g)(A=h[g]||d[g])&&(p[g]=A);for(;u<i;++u)c[u]=e[u];return new nc(c,this._parents,this._name,this._id)}function NZ(s){return(s+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function UZ(s,e,n){var i,o,a=NZ(e)?Aw:sl;return function(){var c=a(this,s),u=c.on;u!==i&&(o=(i=u).copy()).on(e,n),c.on=o}}function kZ(s,e){var n=this._id;return arguments.length<2?Va(this.node(),n).on.on(s):this.each(UZ(n,s,e))}function zZ(s){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==s)return;e&&e.removeChild(this)}}function GZ(){return this.on("end.remove",zZ(this._id))}function VZ(s){var e=this._name,n=this._id;typeof s!="function"&&(s=mw(s));for(var i=this._groups,o=i.length,a=new Array(o),c=0;c<o;++c)for(var u=i[c],h=u.length,d=a[c]=new Array(h),f,p,A=0;A<h;++A)(f=u[A])&&(p=s.call(f,f.__data__,A,u))&&("__data__"in f&&(p.__data__=f.__data__),d[A]=p,sy(d[A],e,n,A,d,Va(f,n)));return new nc(a,this._parents,e,n)}function HZ(s){var e=this._name,n=this._id;typeof s!="function"&&(s=XL(s));for(var i=this._groups,o=i.length,a=[],c=[],u=0;u<o;++u)for(var h=i[u],d=h.length,f,p=0;p<d;++p)if(f=h[p]){for(var A=s.call(f,f.__data__,p,h),g,v=Va(f,n),b=0,x=A.length;b<x;++b)(g=A[b])&&sy(g,e,n,b,A,v);a.push(A),c.push(f)}return new nc(a,c,e,n)}var jZ=Pm.prototype.constructor;function WZ(){return new jZ(this._groups,this._parents)}function QZ(s,e){var n,i,o;return function(){var a=gf(this,s),c=(this.style.removeProperty(s),gf(this,s));return a===c?null:a===n&&c===i?o:o=e(n=a,i=c)}}function lP(s){return function(){this.style.removeProperty(s)}}function XZ(s,e,n){var i,o=n+"",a;return function(){var c=gf(this,s);return c===o?null:c===i?a:a=e(i=c,n)}}function KZ(s,e,n){var i,o,a;return function(){var c=gf(this,s),u=n(this),h=u+"";return u==null&&(h=u=(this.style.removeProperty(s),gf(this,s))),c===h?null:c===i&&h===o?a:(o=h,a=e(i=c,u))}}function qZ(s,e){var n,i,o,a="style."+e,c="end."+a,u;return function(){var h=sl(this,s),d=h.on,f=h.value[a]==null?u||(u=lP(e)):void 0;(d!==n||o!==f)&&(i=(n=d).copy()).on(c,o=f),h.on=i}}function YZ(s,e,n){var i=(s+="")=="transform"?CK:aP;return e==null?this.styleTween(s,QZ(s,i)).on("end.style."+s,lP(s)):typeof e=="function"?this.styleTween(s,KZ(s,i,vw(this,"style."+s,e))).each(qZ(this._id,s)):this.styleTween(s,XZ(s,i,e),n).on("end.style."+s,null)}function $Z(s,e,n){return function(i){this.style.setProperty(s,e.call(this,i),n)}}function JZ(s,e,n){var i,o;function a(){var c=e.apply(this,arguments);return c!==o&&(i=(o=c)&&$Z(s,c,n)),i}return a._value=e,a}function ZZ(s,e,n){var i="style."+(s+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,JZ(s,e,n??""))}function eee(s){return function(){this.textContent=s}}function tee(s){return function(){var e=s(this);this.textContent=e??""}}function nee(s){return this.tween("text",typeof s=="function"?tee(vw(this,"text",s)):eee(s==null?"":s+""))}function iee(s){return function(e){this.textContent=s.call(this,e)}}function ree(s){var e,n;function i(){var o=s.apply(this,arguments);return o!==n&&(e=(n=o)&&iee(o)),e}return i._value=s,i}function see(s){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(s==null)return this.tween(e,null);if(typeof s!="function")throw new Error;return this.tween(e,ree(s))}function oee(){for(var s=this._name,e=this._id,n=cP(),i=this._groups,o=i.length,a=0;a<o;++a)for(var c=i[a],u=c.length,h,d=0;d<u;++d)if(h=c[d]){var f=Va(h,e);sy(h,s,n,d,c,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new nc(i,this._parents,s,n)}function aee(){var s,e,n=this,i=n._id,o=n.size();return new Promise(function(a,c){var u={value:c},h={value:function(){--o===0&&a()}};n.each(function(){var d=sl(this,i),f=d.on;f!==s&&(e=(s=f).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(h)),d.on=e}),o===0&&a()})}var lee=0;function nc(s,e,n,i){this._groups=s,this._parents=e,this._name=n,this._id=i}function cP(){return++lee}var Ul=Pm.prototype;nc.prototype={constructor:nc,select:VZ,selectAll:HZ,selectChild:Ul.selectChild,selectChildren:Ul.selectChildren,filter:OZ,merge:FZ,selection:WZ,transition:oee,call:Ul.call,nodes:Ul.nodes,node:Ul.node,size:Ul.size,empty:Ul.empty,each:Ul.each,on:kZ,attr:yZ,attrTween:wZ,style:YZ,styleTween:ZZ,text:nee,textTween:see,remove:GZ,tween:dZ,delay:SZ,duration:IZ,ease:LZ,easeVarying:DZ,end:aee,[Symbol.iterator]:Ul[Symbol.iterator]};function cee(s){return((s*=2)<=1?s*s*s:(s-=2)*s*s+2)/2}var hee={time:null,delay:0,duration:250,ease:cee};function uee(s,e){for(var n;!(n=s.__transition)||!(n=n[e]);)if(!(s=s.parentNode))throw new Error(`transition ${e} not found`);return n}function dee(s){var e,n;s instanceof nc?(e=s._id,s=s._name):(e=cP(),(n=hee).time=tw(),s=s==null?null:s+"");for(var i=this._groups,o=i.length,a=0;a<o;++a)for(var c=i[a],u=c.length,h,d=0;d<u;++d)(h=c[d])&&sy(h,s,e,d,c,n||uee(h,e));return new nc(i,this._parents,s,e)}Pm.prototype.interrupt=cZ;Pm.prototype.transition=dee;const H0=s=>()=>s;function fee(s,{sourceEvent:e,target:n,transform:i,dispatch:o}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function Kl(s,e,n){this.k=s,this.x=e,this.y=n}Kl.prototype={constructor:Kl,scale:function(s){return s===1?this:new Kl(this.k*s,this.x,this.y)},translate:function(s,e){return s===0&e===0?this:new Kl(this.k,this.x+this.k*s,this.y+this.k*e)},apply:function(s){return[s[0]*this.k+this.x,s[1]*this.k+this.y]},applyX:function(s){return s*this.k+this.x},applyY:function(s){return s*this.k+this.y},invert:function(s){return[(s[0]-this.x)/this.k,(s[1]-this.y)/this.k]},invertX:function(s){return(s-this.x)/this.k},invertY:function(s){return(s-this.y)/this.k},rescaleX:function(s){return s.copy().domain(s.range().map(this.invertX,this).map(s.invert,s))},rescaleY:function(s){return s.copy().domain(s.range().map(this.invertY,this).map(s.invert,s))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var yw=new Kl(1,0,0);$a.prototype=Kl.prototype;function $a(s){for(;!s.__zoom;)if(!(s=s.parentNode))return yw;return s.__zoom}function hb(s){s.stopImmediatePropagation()}function Up(s){s.preventDefault(),s.stopImmediatePropagation()}function pee(s){return(!s.ctrlKey||s.type==="wheel")&&!s.button}function mee(){var s=this;return s instanceof SVGElement?(s=s.ownerSVGElement||s,s.hasAttribute("viewBox")?(s=s.viewBox.baseVal,[[s.x,s.y],[s.x+s.width,s.y+s.height]]):[[0,0],[s.width.baseVal.value,s.height.baseVal.value]]):[[0,0],[s.clientWidth,s.clientHeight]]}function VR(){return this.__zoom||yw}function gee(s){return-s.deltaY*(s.deltaMode===1?.05:s.deltaMode?1:.002)*(s.ctrlKey?10:1)}function Aee(){return navigator.maxTouchPoints||"ontouchstart"in this}function vee(s,e,n){var i=s.invertX(e[0][0])-n[0][0],o=s.invertX(e[1][0])-n[1][0],a=s.invertY(e[0][1])-n[0][1],c=s.invertY(e[1][1])-n[1][1];return s.translate(o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o),c>a?(a+c)/2:Math.min(0,a)||Math.max(0,c))}function yee(){var s=pee,e=mee,n=vee,i=gee,o=Aee,a=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,h=BK,d=Rm("start","zoom","end"),f,p,A,g=500,v=150,b=0,x=10;function E(z){z.property("__zoom",VR).on("wheel.zoom",F,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",P).filter(o).on("touchstart.zoom",U).on("touchmove.zoom",K).on("touchend.zoom touchcancel.zoom",J).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}E.transform=function(z,j,G,H){var te=z.selection?z.selection():z;te.property("__zoom",VR),z!==te?T(z,j,G,H):te.interrupt().each(function(){L(this,arguments).event(H).start().zoom(null,typeof j=="function"?j.apply(this,arguments):j).end()})},E.scaleBy=function(z,j,G,H){E.scaleTo(z,function(){var te=this.__zoom.k,Z=typeof j=="function"?j.apply(this,arguments):j;return te*Z},G,H)},E.scaleTo=function(z,j,G,H){E.transform(z,function(){var te=e.apply(this,arguments),Z=this.__zoom,ee=G==null?C(te):typeof G=="function"?G.apply(this,arguments):G,oe=Z.invert(ee),xe=typeof j=="function"?j.apply(this,arguments):j;return n(M(S(Z,xe),ee,oe),te,c)},G,H)},E.translateBy=function(z,j,G,H){E.transform(z,function(){return n(this.__zoom.translate(typeof j=="function"?j.apply(this,arguments):j,typeof G=="function"?G.apply(this,arguments):G),e.apply(this,arguments),c)},null,H)},E.translateTo=function(z,j,G,H,te){E.transform(z,function(){var Z=e.apply(this,arguments),ee=this.__zoom,oe=H==null?C(Z):typeof H=="function"?H.apply(this,arguments):H;return n(yw.translate(oe[0],oe[1]).scale(ee.k).translate(typeof j=="function"?-j.apply(this,arguments):-j,typeof G=="function"?-G.apply(this,arguments):-G),Z,c)},H,te)};function S(z,j){return j=Math.max(a[0],Math.min(a[1],j)),j===z.k?z:new Kl(j,z.x,z.y)}function M(z,j,G){var H=j[0]-G[0]*z.k,te=j[1]-G[1]*z.k;return H===z.x&&te===z.y?z:new Kl(z.k,H,te)}function C(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function T(z,j,G,H){z.on("start.zoom",function(){L(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){L(this,arguments).event(H).end()}).tween("zoom",function(){var te=this,Z=arguments,ee=L(te,Z).event(H),oe=e.apply(te,Z),xe=G==null?C(oe):typeof G=="function"?G.apply(te,Z):G,Pe=Math.max(oe[1][0]-oe[0][0],oe[1][1]-oe[0][1]),me=te.__zoom,Ce=typeof j=="function"?j.apply(te,Z):j,Je=h(me.invert(xe).concat(Pe/me.k),Ce.invert(xe).concat(Pe/Ce.k));return function(Oe){if(Oe===1)Oe=Ce;else{var $e=Je(Oe),nt=Pe/$e[2];Oe=new Kl(nt,xe[0]-$e[0]*nt,xe[1]-$e[1]*nt)}ee.zoom(null,Oe)}})}function L(z,j,G){return!G&&z.__zooming||new B(z,j)}function B(z,j){this.that=z,this.args=j,this.active=0,this.sourceEvent=null,this.extent=e.apply(z,j),this.taps=0}B.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,j){return this.mouse&&z!=="mouse"&&(this.mouse[1]=j.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=j.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=j.invert(this.touch1[0])),this.that.__zoom=j,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var j=Ua(this.that).datum();d.call(z,this.that,new fee(z,{sourceEvent:this.sourceEvent,target:E,type:z,transform:this.that.__zoom,dispatch:d}),j)}};function F(z,...j){if(!s.apply(this,arguments))return;var G=L(this,j).event(z),H=this.__zoom,te=Math.max(a[0],Math.min(a[1],H.k*Math.pow(2,i.apply(this,arguments)))),Z=Gl(z);if(G.wheel)(G.mouse[0][0]!==Z[0]||G.mouse[0][1]!==Z[1])&&(G.mouse[1]=H.invert(G.mouse[0]=Z)),clearTimeout(G.wheel);else{if(H.k===te)return;G.mouse=[Z,H.invert(Z)],sv(this),G.start()}Up(z),G.wheel=setTimeout(ee,v),G.zoom("mouse",n(M(S(H,te),G.mouse[0],G.mouse[1]),G.extent,c));function ee(){G.wheel=null,G.end()}}function D(z,...j){if(A||!s.apply(this,arguments))return;var G=z.currentTarget,H=L(this,j,!0).event(z),te=Ua(z.view).on("mousemove.zoom",xe,!0).on("mouseup.zoom",Pe,!0),Z=Gl(z,G),ee=z.clientX,oe=z.clientY;rP(z.view),hb(z),H.mouse=[Z,this.__zoom.invert(Z)],sv(this),H.start();function xe(me){if(Up(me),!H.moved){var Ce=me.clientX-ee,Je=me.clientY-oe;H.moved=Ce*Ce+Je*Je>b}H.event(me).zoom("mouse",n(M(H.that.__zoom,H.mouse[0]=Gl(me,G),H.mouse[1]),H.extent,c))}function Pe(me){te.on("mousemove.zoom mouseup.zoom",null),sP(me.view,H.moved),Up(me),H.event(me).end()}}function P(z,...j){if(s.apply(this,arguments)){var G=this.__zoom,H=Gl(z.changedTouches?z.changedTouches[0]:z,this),te=G.invert(H),Z=G.k*(z.shiftKey?.5:2),ee=n(M(S(G,Z),H,te),e.apply(this,j),c);Up(z),u>0?Ua(this).transition().duration(u).call(T,ee,H,z):Ua(this).call(E.transform,ee,H,z)}}function U(z,...j){if(s.apply(this,arguments)){var G=z.touches,H=G.length,te=L(this,j,z.changedTouches.length===H).event(z),Z,ee,oe,xe;for(hb(z),ee=0;ee<H;++ee)oe=G[ee],xe=Gl(oe,this),xe=[xe,this.__zoom.invert(xe),oe.identifier],te.touch0?!te.touch1&&te.touch0[2]!==xe[2]&&(te.touch1=xe,te.taps=0):(te.touch0=xe,Z=!0,te.taps=1+!!f);f&&(f=clearTimeout(f)),Z&&(te.taps<2&&(p=xe[0],f=setTimeout(function(){f=null},g)),sv(this),te.start())}}function K(z,...j){if(this.__zooming){var G=L(this,j).event(z),H=z.changedTouches,te=H.length,Z,ee,oe,xe;for(Up(z),Z=0;Z<te;++Z)ee=H[Z],oe=Gl(ee,this),G.touch0&&G.touch0[2]===ee.identifier?G.touch0[0]=oe:G.touch1&&G.touch1[2]===ee.identifier&&(G.touch1[0]=oe);if(ee=G.that.__zoom,G.touch1){var Pe=G.touch0[0],me=G.touch0[1],Ce=G.touch1[0],Je=G.touch1[1],Oe=(Oe=Ce[0]-Pe[0])*Oe+(Oe=Ce[1]-Pe[1])*Oe,$e=($e=Je[0]-me[0])*$e+($e=Je[1]-me[1])*$e;ee=S(ee,Math.sqrt(Oe/$e)),oe=[(Pe[0]+Ce[0])/2,(Pe[1]+Ce[1])/2],xe=[(me[0]+Je[0])/2,(me[1]+Je[1])/2]}else if(G.touch0)oe=G.touch0[0],xe=G.touch0[1];else return;G.zoom("touch",n(M(ee,oe,xe),G.extent,c))}}function J(z,...j){if(this.__zooming){var G=L(this,j).event(z),H=z.changedTouches,te=H.length,Z,ee;for(hb(z),A&&clearTimeout(A),A=setTimeout(function(){A=null},g),Z=0;Z<te;++Z)ee=H[Z],G.touch0&&G.touch0[2]===ee.identifier?delete G.touch0:G.touch1&&G.touch1[2]===ee.identifier&&delete G.touch1;if(G.touch1&&!G.touch0&&(G.touch0=G.touch1,delete G.touch1),G.touch0)G.touch0[1]=this.__zoom.invert(G.touch0[0]);else if(G.end(),G.taps===2&&(ee=Gl(ee,this),Math.hypot(p[0]-ee[0],p[1]-ee[1])<x)){var oe=Ua(this).on("dblclick.zoom");oe&&oe.apply(this,arguments)}}}return E.wheelDelta=function(z){return arguments.length?(i=typeof z=="function"?z:H0(+z),E):i},E.filter=function(z){return arguments.length?(s=typeof z=="function"?z:H0(!!z),E):s},E.touchable=function(z){return arguments.length?(o=typeof z=="function"?z:H0(!!z),E):o},E.extent=function(z){return arguments.length?(e=typeof z=="function"?z:H0([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),E):e},E.scaleExtent=function(z){return arguments.length?(a[0]=+z[0],a[1]=+z[1],E):[a[0],a[1]]},E.translateExtent=function(z){return arguments.length?(c[0][0]=+z[0][0],c[1][0]=+z[1][0],c[0][1]=+z[0][1],c[1][1]=+z[1][1],E):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},E.constrain=function(z){return arguments.length?(n=z,E):n},E.duration=function(z){return arguments.length?(u=+z,E):u},E.interpolate=function(z){return arguments.length?(h=z,E):h},E.on=function(){var z=d.on.apply(d,arguments);return z===d?E:z},E.clickDistance=function(z){return arguments.length?(b=(z=+z)*z,E):Math.sqrt(b)},E.tapDistance=function(z){return arguments.length?(x=+z,E):x},E}var xee="Expected a function";function Eee(s,e,n){var i=!0,o=!0;if(typeof s!="function")throw new TypeError(xee);return bv(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),AL(s,e,{leading:i,maxWait:e,trailing:o})}function bee(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function HR(s,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,Iee(i.key),i)}}function _ee(s,e,n){return e&&HR(s.prototype,e),n&&HR(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s}function wee(s){return Mee(s)||Cee(s)||See(s)||Tee()}function Mee(s){if(Array.isArray(s))return v_(s)}function Cee(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function See(s,e){if(s){if(typeof s=="string")return v_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v_(s,e)}}function v_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function Tee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ree(s,e){if(typeof s!="object"||s===null)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Iee(s){var e=Ree(s,"string");return typeof e=="symbol"?e:String(e)}var Bee=123,Lee=function(e){return"#".concat(Math.min(e,Math.pow(2,24)).toString(16).padStart(6,"0"))},hP=function(e,n,i){return(e<<16)+(n<<8)+i},Pee=function(e){var n=ci(e).toRgb(),i=n.r,o=n.g,a=n.b;return hP(i,o,a)},jR=function(e,n){return e*Bee%Math.pow(2,n)},Dee=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;bee(this,s),this.csBits=e,this.registry=["__reserved for background__"]}return _ee(s,[{key:"register",value:function(n){if(this.registry.length>=Math.pow(2,24-this.csBits))return null;var i=this.registry.length,o=jR(i,this.csBits),a=Lee(i+(o<<24-this.csBits));return this.registry.push(n),a}},{key:"lookup",value:function(n){var i=typeof n=="string"?Pee(n):hP.apply(void 0,wee(n));if(!i)return null;var o=i&Math.pow(2,24-this.csBits)-1,a=i>>24-this.csBits&Math.pow(2,this.csBits)-1;return jR(o,this.csBits)!==a||o>=this.registry.length?null:this.registry[o]}}]),s}();const{abs:kp,cos:kl,sin:jd,acos:Oee,atan2:zp,sqrt:Uc,pow:ia}=Math;function Gp(s){return s<0?-ia(-s,1/3):ia(s,1/3)}const uP=Math.PI,j0=2*uP,kc=uP/2,Fee=1e-6,ub=Number.MAX_SAFE_INTEGER||9007199254740991,db=Number.MIN_SAFE_INTEGER||-9007199254740991,Nee={x:0,y:0,z:0},yn={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(s,e){const n=e(s);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),Uc(i)},compute:function(s,e,n){if(s===0)return e[0].t=0,e[0];const i=e.length-1;if(s===1)return e[i].t=1,e[i];const o=1-s;let a=e;if(i===0)return e[0].t=s,e[0];if(i===1){const u={x:o*a[0].x+s*a[1].x,y:o*a[0].y+s*a[1].y,t:s};return n&&(u.z=o*a[0].z+s*a[1].z),u}if(i<4){let u=o*o,h=s*s,d,f,p,A=0;i===2?(a=[a[0],a[1],a[2],Nee],d=u,f=o*s*2,p=h):i===3&&(d=u*o,f=u*s*3,p=o*h*3,A=s*h);const g={x:d*a[0].x+f*a[1].x+p*a[2].x+A*a[3].x,y:d*a[0].y+f*a[1].y+p*a[2].y+A*a[3].y,t:s};return n&&(g.z=d*a[0].z+f*a[1].z+p*a[2].z+A*a[3].z),g}const c=JSON.parse(JSON.stringify(e));for(;c.length>1;){for(let u=0;u<c.length-1;u++)c[u]={x:c[u].x+(c[u+1].x-c[u].x)*s,y:c[u].y+(c[u+1].y-c[u].y)*s},typeof c[u].z<"u"&&(c[u].z=c[u].z+(c[u+1].z-c[u].z)*s);c.splice(c.length-1,1)}return c[0].t=s,c[0]},computeWithRatios:function(s,e,n,i){const o=1-s,a=n,c=e;let u=a[0],h=a[1],d=a[2],f=a[3],p;if(u*=o,h*=s,c.length===2)return p=u+h,{x:(u*c[0].x+h*c[1].x)/p,y:(u*c[0].y+h*c[1].y)/p,z:i?(u*c[0].z+h*c[1].z)/p:!1,t:s};if(u*=o,h*=2*o,d*=s*s,c.length===3)return p=u+h+d,{x:(u*c[0].x+h*c[1].x+d*c[2].x)/p,y:(u*c[0].y+h*c[1].y+d*c[2].y)/p,z:i?(u*c[0].z+h*c[1].z+d*c[2].z)/p:!1,t:s};if(u*=o,h*=1.5*o,d*=3*o,f*=s*s*s,c.length===4)return p=u+h+d+f,{x:(u*c[0].x+h*c[1].x+d*c[2].x+f*c[3].x)/p,y:(u*c[0].y+h*c[1].y+d*c[2].y+f*c[3].y)/p,z:i?(u*c[0].z+h*c[1].z+d*c[2].z+f*c[3].z)/p:!1,t:s}},derive:function(s,e){const n=[];for(let i=s,o=i.length,a=o-1;o>1;o--,a--){const c=[];for(let u=0,h;u<a;u++)h={x:a*(i[u+1].x-i[u].x),y:a*(i[u+1].y-i[u].y)},e&&(h.z=a*(i[u+1].z-i[u].z)),c.push(h);n.push(c),i=c}return n},between:function(s,e,n){return e<=s&&s<=n||yn.approximately(s,e)||yn.approximately(s,n)},approximately:function(s,e,n){return kp(s-e)<=(n||Fee)},length:function(s){const n=yn.Tvalues.length;let i=0;for(let o=0,a;o<n;o++)a=.5*yn.Tvalues[o]+.5,i+=yn.Cvalues[o]*yn.arcfn(a,s);return .5*i},map:function(s,e,n,i,o){const a=n-e,c=o-i,u=s-e,h=u/a;return i+c*h},lerp:function(s,e,n){const i={x:e.x+s*(n.x-e.x),y:e.y+s*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+s*(n.z-e.z)),i},pointToString:function(s){let e=s.x+"/"+s.y;return typeof s.z<"u"&&(e+="/"+s.z),e},pointsToString:function(s){return"["+s.map(yn.pointToString).join(", ")+"]"},copy:function(s){return JSON.parse(JSON.stringify(s))},angle:function(s,e,n){const i=e.x-s.x,o=e.y-s.y,a=n.x-s.x,c=n.y-s.y,u=i*c-o*a,h=i*a+o*c;return zp(u,h)},round:function(s,e){const n=""+s,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(s,e){const n=s.x-e.x,i=s.y-e.y;return Uc(n*n+i*i)},closest:function(s,e){let n=ia(2,63),i,o;return s.forEach(function(a,c){o=yn.dist(e,a),o<n&&(n=o,i=c)}),{mdist:n,mpos:i}},abcratio:function(s,e){if(e!==2&&e!==3)return!1;if(typeof s>"u")s=.5;else if(s===0||s===1)return s;const n=ia(s,e)+ia(1-s,e),i=n-1;return kp(i/n)},projectionratio:function(s,e){if(e!==2&&e!==3)return!1;if(typeof s>"u")s=.5;else if(s===0||s===1)return s;const n=ia(1-s,e),i=ia(s,e)+n;return n/i},lli8:function(s,e,n,i,o,a,c,u){const h=(s*i-e*n)*(o-c)-(s-n)*(o*u-a*c),d=(s*i-e*n)*(a-u)-(e-i)*(o*u-a*c),f=(s-n)*(a-u)-(e-i)*(o-c);return f==0?!1:{x:h/f,y:d/f}},lli4:function(s,e,n,i){const o=s.x,a=s.y,c=e.x,u=e.y,h=n.x,d=n.y,f=i.x,p=i.y;return yn.lli8(o,a,c,u,h,d,f,p)},lli:function(s,e){return yn.lli4(s,s.c,e,e.c)},makeline:function(s,e){return new Pr(s.x,s.y,(s.x+e.x)/2,(s.y+e.y)/2,e.x,e.y)},findbbox:function(s){let e=ub,n=ub,i=db,o=db;return s.forEach(function(a){const c=a.bbox();e>c.x.min&&(e=c.x.min),n>c.y.min&&(n=c.y.min),i<c.x.max&&(i=c.x.max),o<c.y.max&&(o=c.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+o)/2,max:o,size:o-n}}},shapeintersections:function(s,e,n,i,o){if(!yn.bboxoverlap(e,i))return[];const a=[],c=[s.startcap,s.forward,s.back,s.endcap],u=[n.startcap,n.forward,n.back,n.endcap];return c.forEach(function(h){h.virtual||u.forEach(function(d){if(d.virtual)return;const f=h.intersects(d,o);f.length>0&&(f.c1=h,f.c2=d,f.s1=s,f.s2=n,a.push(f))})}),a},makeshape:function(s,e,n){const i=e.points.length,o=s.points.length,a=yn.makeline(e.points[i-1],s.points[0]),c=yn.makeline(s.points[o-1],e.points[0]),u={startcap:a,forward:s,back:e,endcap:c,bbox:yn.findbbox([a,s,e,c])};return u.intersections=function(h){return yn.shapeintersections(u,u.bbox,h,h.bbox,n)},u},getminmax:function(s,e,n){if(!n)return{min:0,max:0};let i=ub,o=db,a,c;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let u=0,h=n.length;u<h;u++)a=n[u],c=s.get(a),c[e]<i&&(i=c[e]),c[e]>o&&(o=c[e]);return{min:i,mid:(i+o)/2,max:o,size:o-i}},align:function(s,e){const n=e.p1.x,i=e.p1.y,o=-zp(e.p2.y-i,e.p2.x-n),a=function(c){return{x:(c.x-n)*kl(o)-(c.y-i)*jd(o),y:(c.x-n)*jd(o)+(c.y-i)*kl(o)}};return s.map(a)},roots:function(s,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=s.length-1,i=yn.align(s,e),o=function(B){return 0<=B&&B<=1};if(n===2){const B=i[0].y,F=i[1].y,D=i[2].y,P=B-2*F+D;if(P!==0){const U=-Uc(F*F-B*D),K=-B+F,J=-(U+K)/P,z=-(-U+K)/P;return[J,z].filter(o)}else if(F!==D&&P===0)return[(2*F-D)/(2*F-2*D)].filter(o);return[]}const a=i[0].y,c=i[1].y,u=i[2].y,h=i[3].y;let d=-a+3*c-3*u+h,f=3*a-6*c+3*u,p=-3*a+3*c,A=a;if(yn.approximately(d,0)){if(yn.approximately(f,0))return yn.approximately(p,0)?[]:[-A/p].filter(o);const B=Uc(p*p-4*f*A),F=2*f;return[(B-p)/F,(-p-B)/F].filter(o)}f/=d,p/=d,A/=d;const g=(3*p-f*f)/3,v=g/3,b=(2*f*f*f-9*f*p+27*A)/27,x=b/2,E=x*x+v*v*v;let S,M,C,T,L;if(E<0){const B=-g/3,F=B*B*B,D=Uc(F),P=-b/(2*D),U=P<-1?-1:P>1?1:P,K=Oee(U),J=Gp(D),z=2*J;return C=z*kl(K/3)-f/3,T=z*kl((K+j0)/3)-f/3,L=z*kl((K+2*j0)/3)-f/3,[C,T,L].filter(o)}else{if(E===0)return S=x<0?Gp(-x):-Gp(x),C=2*S-f/3,T=-S-f/3,[C,T].filter(o);{const B=Uc(E);return S=Gp(-x+B),M=Gp(x+B),[S-M-f/3].filter(o)}}},droots:function(s){if(s.length===3){const e=s[0],n=s[1],i=s[2],o=e-2*n+i;if(o!==0){const a=-Uc(n*n-e*i),c=-e+n,u=-(a+c)/o,h=-(-a+c)/o;return[u,h]}else if(n!==i&&o===0)return[(2*n-i)/(2*(n-i))];return[]}if(s.length===2){const e=s[0],n=s[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(s,e,n,i,o){let a,c,u,h,d=0,f=0;const p=yn.compute(s,e),A=yn.compute(s,n),g=p.x*p.x+p.y*p.y;if(i?(a=Uc(ia(p.y*A.z-A.y*p.z,2)+ia(p.z*A.x-A.z*p.x,2)+ia(p.x*A.y-A.x*p.y,2)),c=ia(g+p.z*p.z,3/2)):(a=p.x*A.y-p.y*A.x,c=ia(g,3/2)),a===0||c===0)return{k:0,r:0};if(d=a/c,f=c/a,!o){const v=yn.curvature(s-.001,e,n,i,!0).k,b=yn.curvature(s+.001,e,n,i,!0).k;h=(b-d+(d-v))/2,u=(kp(b-d)+kp(d-v))/2}return{k:d,r:f,dk:h,adk:u}},inflections:function(s){if(s.length<4)return[];const e=yn.align(s,{p1:s[0],p2:s.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,o=e[1].x*e[2].y,a=e[3].x*e[2].y,c=18*(-3*n+2*i+3*o-a),u=18*(3*n-i-3*o),h=18*(o-n);if(yn.approximately(c,0)){if(!yn.approximately(u,0)){let A=-h/u;if(0<=A&&A<=1)return[A]}return[]}const d=2*c;if(yn.approximately(d,0))return[];const f=u*u-4*c*h;if(f<0)return[];const p=Math.sqrt(f);return[(p-u)/d,-(u+p)/d].filter(function(A){return 0<=A&&A<=1})},bboxoverlap:function(s,e){const n=["x","y"],i=n.length;for(let o=0,a,c,u,h;o<i;o++)if(a=n[o],c=s[a].mid,u=e[a].mid,h=(s[a].size+e[a].size)/2,kp(c-u)>=h)return!1;return!0},expandbox:function(s,e){e.x.min<s.x.min&&(s.x.min=e.x.min),e.y.min<s.y.min&&(s.y.min=e.y.min),e.z&&e.z.min<s.z.min&&(s.z.min=e.z.min),e.x.max>s.x.max&&(s.x.max=e.x.max),e.y.max>s.y.max&&(s.y.max=e.y.max),e.z&&e.z.max>s.z.max&&(s.z.max=e.z.max),s.x.mid=(s.x.min+s.x.max)/2,s.y.mid=(s.y.min+s.y.max)/2,s.z&&(s.z.mid=(s.z.min+s.z.max)/2),s.x.size=s.x.max-s.x.min,s.y.size=s.y.max-s.y.min,s.z&&(s.z.size=s.z.max-s.z.min)},pairiteration:function(s,e,n){const i=s.bbox(),o=e.bbox(),a=1e5,c=n||.5;if(i.x.size+i.y.size<c&&o.x.size+o.y.size<c)return[(a*(s._t1+s._t2)/2|0)/a+"/"+(a*(e._t1+e._t2)/2|0)/a];let u=s.split(.5),h=e.split(.5),d=[{left:u.left,right:h.left},{left:u.left,right:h.right},{left:u.right,right:h.right},{left:u.right,right:h.left}];d=d.filter(function(p){return yn.bboxoverlap(p.left.bbox(),p.right.bbox())});let f=[];return d.length===0||(d.forEach(function(p){f=f.concat(yn.pairiteration(p.left,p.right,c))}),f=f.filter(function(p,A){return f.indexOf(p)===A})),f},getccenter:function(s,e,n){const i=e.x-s.x,o=e.y-s.y,a=n.x-e.x,c=n.y-e.y,u=i*kl(kc)-o*jd(kc),h=i*jd(kc)+o*kl(kc),d=a*kl(kc)-c*jd(kc),f=a*jd(kc)+c*kl(kc),p=(s.x+e.x)/2,A=(s.y+e.y)/2,g=(e.x+n.x)/2,v=(e.y+n.y)/2,b=p+u,x=A+h,E=g+d,S=v+f,M=yn.lli8(p,A,b,x,g,v,E,S),C=yn.dist(M,s);let T=zp(s.y-M.y,s.x-M.x),L=zp(e.y-M.y,e.x-M.x),B=zp(n.y-M.y,n.x-M.x),F;return T<B?((T>L||L>B)&&(T+=j0),T>B&&(F=B,B=T,T=F)):B<L&&L<T?(F=B,B=T,T=F):B+=j0,M.s=T,M.e=B,M.r=C,M},numberSort:function(s,e){return s-e}};class rm{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return yn.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)yn.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new rm(n)}}const{abs:Vp,min:WR,max:QR,cos:Uee,sin:kee,acos:zee,sqrt:Hp}=Math,Gee=Math.PI;class Pr{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const g=[];n.forEach(function(v){["x","y","z"].forEach(function(b){typeof v[b]<"u"&&g.push(v[b])})}),n=g}let o=!1;const a=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");o=!0}}else if(a!==6&&a!==8&&a!==9&&a!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const c=this._3d=!o&&(a===9||a===12)||e&&e[0]&&typeof e[0].z<"u",u=this.points=[];for(let g=0,v=c?3:2;g<a;g+=v){var h={x:n[g],y:n[g+1]};c&&(h.z=n[g+2]),u.push(h)}const d=this.order=u.length-1,f=this.dims=["x","y"];c&&f.push("z"),this.dimlen=f.length;const p=yn.align(u,{p1:u[0],p2:u[d]}),A=yn.dist(u[0],u[d]);this._linear=p.reduce((g,v)=>g+Vp(v.y),0)<A/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,o){if(typeof o>"u"&&(o=.5),o===0)return new Pr(n,n,i);if(o===1)return new Pr(e,n,n);const a=Pr.getABC(2,e,n,i,o);return new Pr(e,a.A,i)}static cubicFromPoints(e,n,i,o,a){typeof o>"u"&&(o=.5);const c=Pr.getABC(3,e,n,i,o);typeof a>"u"&&(a=yn.dist(n,c.C));const u=a*(1-o)/o,h=yn.dist(e,i),d=(i.x-e.x)/h,f=(i.y-e.y)/h,p=a*d,A=a*f,g=u*d,v=u*f,b={x:n.x-p,y:n.y-A},x={x:n.x+g,y:n.y+v},E=c.A,S={x:E.x+(b.x-E.x)/(1-o),y:E.y+(b.y-E.y)/(1-o)},M={x:E.x+(x.x-E.x)/o,y:E.y+(x.y-E.y)/o},C={x:e.x+(S.x-e.x)/o,y:e.y+(S.y-e.y)/o},T={x:i.x+(M.x-i.x)/(1-o),y:i.y+(M.y-i.y)/(1-o)};return new Pr(e,C,T,i)}static getUtils(){return yn}getUtils(){return Pr.getUtils()}static get PolyBezier(){return rm}valueOf(){return this.toString()}toString(){return yn.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,o=["M",n,i,this.order===2?"Q":"C"];for(let a=1,c=e.length;a<c;a++)o.push(e[a].x),o.push(e[a].y);return o.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=yn.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=yn.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return yn.length(this.derivative.bind(this))}static getABC(e=2,n,i,o,a=.5){const c=yn.projectionratio(a,e),u=1-c,h={x:c*n.x+u*o.x,y:c*n.y+u*o.y},d=yn.abcratio(a,e);return{A:{x:i.x+(i.x-h.x)/d,y:i.y+(i.y-h.y)/d},B:i,C:h,S:n,E:o}}getABC(e,n){n=n||this.get(e);let i=this.points[0],o=this.points[this.order];return Pr.getABC(this.order,i,n,o,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,o;n<e;n++)o=n/(e-1),i=this.compute(o),i.t=o,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),o=[];for(let a=0,c,u=0;a<i.length;a++)c=i[a],yn.dist(c,e)<n&&(o.push(c),u+=a/i.length);return o.length?t/=o.length:!1}project(e){const n=this.getLUT(),i=n.length-1,o=yn.closest(n,e),a=o.mpos,c=(a-1)/i,u=(a+1)/i,h=.1/i;let d=o.mdist,f=c,p=f,A;d+=1;for(let g;f<u+h;f+=h)A=this.compute(f),g=yn.dist(e,A),g<d&&(d=g,p=f);return p=p<0?0:p>1?1:p,A=this.compute(p),A.t=p,A.d=d,A}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?yn.computeWithRatios(e,this.points,this.ratios,this._3d):yn.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let o=1,a,c;o<i;o++)a=e[o],c=e[o-1],n[o]={x:(i-o)/i*a.x+o/i*c.x,y:(i-o)/i*a.y+o/i*c.y};return n[i]=e[i-1],new Pr(n)}derivative(e){return yn.compute(e,this.dpoints[0],this._3d)}dderivative(e){return yn.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new Pr(yn.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return yn.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return yn.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=Hp(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),o=Hp(n.x*n.x+n.y*n.y+n.z*n.z),a=Hp(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=o,n.y/=o,n.z/=o,i.x/=a,i.y/=a,i.z/=a;const c={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},u=Hp(c.x*c.x+c.y*c.y+c.z*c.z);c.x/=u,c.y/=u,c.z/=u;const h=[c.x*c.x,c.x*c.y-c.z,c.x*c.z+c.y,c.x*c.y+c.z,c.y*c.y,c.y*c.z-c.x,c.x*c.z-c.y,c.y*c.z+c.x,c.z*c.z];return{t:e,x:h[0]*n.x+h[1]*n.y+h[2]*n.z,y:h[3]*n.x+h[4]*n.y+h[5]*n.z,z:h[6]*n.x+h[7]*n.y+h[8]*n.z}}hull(e){let n=this.points,i=[],o=[],a=0;for(o[a++]=n[0],o[a++]=n[1],o[a++]=n[2],this.order===3&&(o[a++]=n[3]);n.length>1;){i=[];for(let c=0,u,h=n.length-1;c<h;c++)u=yn.lerp(e,n[c],n[c+1]),o[a++]=u,i.push(u);n=i}return o}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),o={left:this.order===2?new Pr([i[0],i[3],i[5]]):new Pr([i[0],i[4],i[7],i[9]]),right:this.order===2?new Pr([i[5],i[4],i[2]]):new Pr([i[9],i[8],i[6],i[3]]),span:i};return o.left._t1=yn.map(0,0,1,this._t1,this._t2),o.left._t2=yn.map(e,0,1,this._t1,this._t2),o.right._t1=yn.map(e,0,1,this._t1,this._t2),o.right._t2=yn.map(1,0,1,this._t1,this._t2),n?(n=yn.map(n,e,1,0,1),o.right.split(n).left):o}extrema(){const e={};let n=[];return this.dims.forEach(function(i){let o=function(c){return c[i]},a=this.dpoints[0].map(o);e[i]=yn.droots(a),this.order===3&&(a=this.dpoints[1].map(o),e[i]=e[i].concat(yn.droots(a))),e[i]=e[i].filter(function(c){return c>=0&&c<=1}),n=n.concat(e[i].sort(yn.numberSort))}.bind(this)),e.values=n.sort(yn.numberSort).filter(function(i,o){return n.indexOf(i)===o}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach(function(i){n[i]=yn.getminmax(this,i,e[i])}.bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return yn.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),o=this.normal(e),a={c:i,n:o,x:i.x+o.x*n,y:i.y+o.y*n};return this._3d&&(a.z=i.z+o.z*n),a}if(this._linear){const i=this.normal(0),o=this.points.map(function(a){const c={x:a.x+e*i.x,y:a.y+e*i.y};return a.z&&i.z&&(c.z=a.z+e*i.z),c});return[new Pr(o)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const o=yn.angle(this.points[0],this.points[3],this.points[1]),a=yn.angle(this.points[0],this.points[3],this.points[2]);if(o>0&&a<0||o<0&&a>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),Vp(zee(i))<Gee/3}reduce(){let e,n=0,i=0,o=.01,a,c=[],u=[],h=this.extrema().values;for(h.indexOf(0)===-1&&(h=[0].concat(h)),h.indexOf(1)===-1&&h.push(1),n=h[0],e=1;e<h.length;e++)i=h[e],a=this.split(n,i),a._t1=n,a._t2=i,c.push(a),n=i;return c.forEach(function(d){for(n=0,i=0;i<=1;)for(i=n+o;i<=1+o;i+=o)if(a=d.split(n,i),!a.simple()){if(i-=o,Vp(n-i)<o)return[];a=d.split(n,i),a._t1=yn.map(n,0,1,d._t1,d._t2),a._t2=yn.map(i,0,1,d._t1,d._t2),u.push(a),n=i;break}n<1&&(a=d.split(n,1),a._t1=yn.map(n,0,1,d._t1,d._t2),a._t2=d._t2,u.push(a))}),u}translate(e,n,i){i=typeof i=="number"?i:n;const o=this.order;let a=this.points.map((c,u)=>(1-u/o)*n+u/o*i);return new Pr(this.points.map((c,u)=>({x:c.x+e.x*a[u],y:c.y+e.y*a[u]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const o=this.clockwise,a=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const c=i?i(0):e,u=i?i(1):e,h=[this.offset(0,10),this.offset(1,10)],d=[],f=yn.lli4(h[0],h[0].c,h[1],h[1].c);if(!f)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(p){const A=d[p*n]=yn.copy(a[p*n]);A.x+=(p?u:c)*h[p].n.x,A.y+=(p?u:c)*h[p].n.y}),i?([0,1].forEach(function(p){if(!(n===2&&p)){var A=a[p+1],g={x:A.x-f.x,y:A.y-f.y},v=i?i((p+1)/n):e;i&&!o&&(v=-v);var b=Hp(g.x*g.x+g.y*g.y);g.x/=b,g.y/=b,d[p+1]={x:A.x+v*g.x,y:A.y+v*g.y}}}),new Pr(d)):([0,1].forEach(p=>{if(n===2&&p)return;const A=d[p*n],g=this.derivative(p),v={x:A.x+g.x,y:A.y+g.y};d[p+1]=yn.lli4(A,v,f,a[p+1])}),new Pr(d))}outline(e,n,i,o){if(n=n===void 0?e:n,this._linear){const T=this.normal(0),L=this.points[0],B=this.points[this.points.length-1];let F,D,P;i===void 0&&(i=e,o=n),F={x:L.x+T.x*e,y:L.y+T.y*e},P={x:B.x+T.x*i,y:B.y+T.y*i},D={x:(F.x+P.x)/2,y:(F.y+P.y)/2};const U=[F,D,P];F={x:L.x-T.x*n,y:L.y-T.y*n},P={x:B.x-T.x*o,y:B.y-T.y*o},D={x:(F.x+P.x)/2,y:(F.y+P.y)/2};const K=[P,D,F],J=yn.makeline(K[2],U[0]),z=yn.makeline(U[2],K[0]),j=[J,new Pr(U),z,new Pr(K)];return new rm(j)}const a=this.reduce(),c=a.length,u=[];let h=[],d,f=0,p=this.length();const A=typeof i<"u"&&typeof o<"u";function g(T,L,B,F,D){return function(P){const U=F/B,K=(F+D)/B,J=L-T;return yn.map(P,0,1,T+U*J,T+K*J)}}a.forEach(function(T){const L=T.length();A?(u.push(T.scale(g(e,i,p,f,L))),h.push(T.scale(g(-n,-o,p,f,L)))):(u.push(T.scale(e)),h.push(T.scale(-n))),f+=L}),h=h.map(function(T){return d=T.points,d[3]?T.points=[d[3],d[2],d[1],d[0]]:T.points=[d[2],d[1],d[0]],T}).reverse();const v=u[0].points[0],b=u[c-1].points[u[c-1].points.length-1],x=h[c-1].points[h[c-1].points.length-1],E=h[0].points[0],S=yn.makeline(x,v),M=yn.makeline(b,E),C=[S].concat(u).concat([M]).concat(h);return new rm(C)}outlineshapes(e,n,i){n=n||e;const o=this.outline(e,n).curves,a=[];for(let c=1,u=o.length;c<u/2;c++){const h=yn.makeshape(o[c],o[u-c],i);h.startcap.virtual=c>1,h.endcap.virtual=c<u/2-1,a.push(h)}return a}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof Pr&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=WR(e.p1.x,e.p2.x),i=WR(e.p1.y,e.p2.y),o=QR(e.p1.x,e.p2.x),a=QR(e.p1.y,e.p2.y);return yn.roots(this.points,e).filter(c=>{var u=this.get(c);return yn.between(u.x,n,o)&&yn.between(u.y,i,a)})}selfintersects(e){const n=this.reduce(),i=n.length-2,o=[];for(let a=0,c,u,h;a<i;a++)u=n.slice(a,a+1),h=n.slice(a+2),c=this.curveintersects(u,h,e),o.push(...c);return o}curveintersects(e,n,i){const o=[];e.forEach(function(c){n.forEach(function(u){c.overlaps(u)&&o.push({left:c,right:u})})});let a=[];return o.forEach(function(c){const u=yn.pairiteration(c.left,c.right,i);u.length>0&&(a=a.concat(u))}),a}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,o){const a=(o-i)/4,c=this.get(i+a),u=this.get(o-a),h=yn.dist(e,n),d=yn.dist(e,c),f=yn.dist(e,u);return Vp(d-h)+Vp(f-h)}_iterate(e,n){let i=0,o=1,a;do{a=0,o=1;let c=this.get(i),u,h,d,f,p=!1,A=!1,g,v=o,b=1;do if(A=p,f=d,v=(i+o)/2,u=this.get(v),h=this.get(o),d=yn.getccenter(c,u,h),d.interval={start:i,end:o},p=this._error(d,c,i,o)<=e,g=A&&!p,g||(b=o),p){if(o>=1){if(d.interval.end=b=1,f=d,o>1){let E={x:d.x+d.r*Uee(d.e),y:d.y+d.r*kee(d.e)};d.e+=yn.angle({x:d.x,y:d.y},E,this.get(1))}break}o=o+(o-i)/2}else o=v;while(!g&&a++<100);if(a>=100)break;f=f||d,n.push(f),i=b}while(o<1);return n}}function Vee(s,e){e===void 0&&(e={});var n=e.insertAt;if(!(!s||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",n==="top"&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=s:o.appendChild(document.createTextNode(s))}}var Hee=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .graph-tooltip {
  position: absolute;
  top: 0;
  font-family: sans-serif;
  font-size: 16px;
  padding: 4px;
  border-radius: 3px;
  color: #eee;
  background: rgba(0,0,0,0.65);
  visibility: hidden; /* by default */
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;Vee(Hee);function XR(s,e,n){if(dP())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var o=new(s.bind.apply(s,i));return n&&x_(o,n.prototype),o}function dP(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dP=function(){return!!s})()}function jee(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function KR(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),n.push.apply(n,i)}return n}function Wd(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KR(Object(n),!0).forEach(function(i){bm(s,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):KR(Object(n)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(n,i))})}return s}function Wee(s,e){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Qee(s){var e=Wee(s,"string");return typeof e=="symbol"?e:String(e)}function y_(s){"@babel/helpers - typeof";return y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y_(s)}function bm(s,e,n){return e=Qee(e),e in s?Object.defineProperty(s,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[e]=n,s}function x_(s,e){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},x_(s,e)}function sm(s,e){return Kee(s)||jee(s,e)||fP(s,e)||$ee()}function la(s){return Xee(s)||qee(s)||fP(s)||Yee()}function Xee(s){if(Array.isArray(s))return E_(s)}function Kee(s){if(Array.isArray(s))return s}function qee(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function fP(s,e){if(s){if(typeof s=="string")return E_(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E_(s,e)}}function E_(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function Yee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Jee=hw(TL);function qR(s,e,n){!e||typeof n!="string"||s.filter(function(i){return!i[n]}).forEach(function(i){i[n]=Jee(e(i))})}function Zee(s,e){var n=s.nodes,i=s.links,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.nodeFilter,c=a===void 0?function(){return!0}:a,u=o.onLoopError,h=u===void 0?function(g){throw"Invalid DAG structure! Found cycle in node path: ".concat(g.join(" -> "),".")}:u,d={};n.forEach(function(g){return d[e(g)]={data:g,out:[],depth:-1,skip:!c(g)}}),i.forEach(function(g){var v=g.source,b=g.target,x=C(v),E=C(b);if(!d.hasOwnProperty(x))throw"Missing source node with id: ".concat(x);if(!d.hasOwnProperty(E))throw"Missing target node with id: ".concat(E);var S=d[x],M=d[E];S.out.push(M);function C(T){return y_(T)==="object"?e(T):T}});var f=[];A(Object.values(d));var p=Object.assign.apply(Object,[{}].concat(la(Object.entries(d).filter(function(g){var v=sm(g,2),b=v[1];return!b.skip}).map(function(g){var v=sm(g,2),b=v[0],x=v[1];return bm({},b,x.depth)}))));return p;function A(g){for(var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=function(){var C=g[E];if(v.indexOf(C)!==-1){var T=[].concat(la(v.slice(v.indexOf(C))),[C]).map(function(L){return e(L.data)});return f.some(function(L){return L.length===T.length&&L.every(function(B,F){return B===T[F]})})||(f.push(T),h(T)),1}b>C.depth&&(C.depth=b,A(C.out,[].concat(la(v),[C]),b+(C.skip?0:1)))},E=0,S=g.length;E<S;E++)x()}}var ete=2,$s=function(e,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},YR=function(e,n){if(!n.isShadow){var i=ri(n.linkDirectionalParticles);n.graphData.links.forEach(function(o){var a=Math.round(Math.abs(i(o)));a?o.__photons=la(Array(a)).map(function(){return{}}):delete o.__photons})}},Pv=du({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1,YR(e,n)}},dagMode:{onChange:function(e,n){!e&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:$s},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:$s},nodeColor:{default:"color",triggerUpdate:!1,onChange:$s},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:$s},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:$s},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:$s},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:$s},linkColor:{default:"color",triggerUpdate:!1,onChange:$s},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:$s},linkWidth:{default:1,triggerUpdate:!1,onChange:$s},linkCurvature:{default:0,triggerUpdate:!1,onChange:$s},linkCanvasObject:{triggerUpdate:!1,onChange:$s},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:$s},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:$s},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:$s},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:$s},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:YR},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,n,i){return i===void 0?e.forceLayout.force(n):(e.forceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){return!e.isShadow&&n(),o(),!e.isShadow&&a(),!e.isShadow&&c(),i(),this;function n(){e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick()))}function i(){var u=ri(e.nodeVisibility),h=ri(e.nodeVal),d=ri(e.nodeColor),f=ri(e.nodeCanvasObjectMode),p=e.ctx,A=e.isShadow/e.globalScale,g=e.graphData.nodes.filter(u);p.save(),g.forEach(function(v){var b=f(v);if(e.nodeCanvasObject&&(b==="before"||b==="replace")&&(e.nodeCanvasObject(v,p,e.globalScale),b==="replace")){p.restore();return}var x=Math.sqrt(Math.max(0,h(v)||1))*e.nodeRelSize+A;p.beginPath(),p.arc(v.x,v.y,x,0,2*Math.PI,!1),p.fillStyle=d(v)||"rgba(31, 120, 180, 0.92)",p.fill(),e.nodeCanvasObject&&b==="after"&&e.nodeCanvasObject(v,e.ctx,e.globalScale)}),p.restore()}function o(){var u=ri(e.linkVisibility),h=ri(e.linkColor),d=ri(e.linkWidth),f=ri(e.linkLineDash),p=ri(e.linkCurvature),A=ri(e.linkCanvasObjectMode),g=e.ctx,v=e.isShadow*2,b=e.graphData.links.filter(u);b.forEach(L);var x=[],E=[],S=b;if(e.linkCanvasObject){var M=[],C=[];b.forEach(function(B){return({before:x,after:E,replace:M}[A(B)]||C).push(B)}),S=[].concat(la(x),E,C),x=x.concat(M)}g.save(),x.forEach(function(B){return e.linkCanvasObject(B,g,e.globalScale)}),g.restore();var T=Yb(S,[h,d,f]);g.save(),Object.entries(T).forEach(function(B){var F=sm(B,2),D=F[0],P=F[1],U=!D||D==="undefined"?"rgba(0,0,0,0.15)":D;Object.entries(P).forEach(function(K){var J=sm(K,2),z=J[0],j=J[1],G=(z||1)/e.globalScale+v;Object.entries(j).forEach(function(H){var te=sm(H,2);te[0];var Z=te[1],ee=f(Z[0]);g.beginPath(),Z.forEach(function(oe){var xe=oe.source,Pe=oe.target;if(!(!xe||!Pe||!xe.hasOwnProperty("x")||!Pe.hasOwnProperty("x"))){g.moveTo(xe.x,xe.y);var me=oe.__controlPoints;me?g[me.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(g,la(me).concat([Pe.x,Pe.y])):g.lineTo(Pe.x,Pe.y)}}),g.strokeStyle=U,g.lineWidth=G,g.setLineDash(ee||[]),g.stroke()})})}),g.restore(),g.save(),E.forEach(function(B){return e.linkCanvasObject(B,g,e.globalScale)}),g.restore();function L(B){var F=p(B);if(!F){B.__controlPoints=null;return}var D=B.source,P=B.target;if(!(!D||!P||!D.hasOwnProperty("x")||!P.hasOwnProperty("x"))){var U=Math.sqrt(Math.pow(P.x-D.x,2)+Math.pow(P.y-D.y,2));if(U>0){var K=Math.atan2(P.y-D.y,P.x-D.x),J=U*F,z={x:(D.x+P.x)/2+J*Math.cos(K-Math.PI/2),y:(D.y+P.y)/2+J*Math.sin(K-Math.PI/2)};B.__controlPoints=[z.x,z.y]}else{var j=F*70;B.__controlPoints=[P.x,P.y-j,P.x+j,P.y]}}}}function a(){var u=1.6,h=.2,d=ri(e.linkDirectionalArrowLength),f=ri(e.linkDirectionalArrowRelPos),p=ri(e.linkVisibility),A=ri(e.linkDirectionalArrowColor||e.linkColor),g=ri(e.nodeVal),v=e.ctx;v.save(),e.graphData.links.filter(p).forEach(function(b){var x=d(b);if(!(!x||x<0)){var E=b.source,S=b.target;if(!(!E||!S||!E.hasOwnProperty("x")||!S.hasOwnProperty("x"))){var M=Math.sqrt(Math.max(0,g(E)||1))*e.nodeRelSize,C=Math.sqrt(Math.max(0,g(S)||1))*e.nodeRelSize,T=Math.min(1,Math.max(0,f(b))),L=A(b)||"rgba(0,0,0,0.28)",B=x/u/2,F=b.__controlPoints&&XR(Pr,[E.x,E.y].concat(la(b.__controlPoints),[S.x,S.y])),D=F?function(G){return F.get(G)}:function(G){return{x:E.x+(S.x-E.x)*G||0,y:E.y+(S.y-E.y)*G||0}},P=F?F.length():Math.sqrt(Math.pow(S.x-E.x,2)+Math.pow(S.y-E.y,2)),U=M+x+(P-M-C-x)*T,K=D(U/P),J=D((U-x)/P),z=D((U-x*(1-h))/P),j=Math.atan2(K.y-J.y,K.x-J.x)-Math.PI/2;v.beginPath(),v.moveTo(K.x,K.y),v.lineTo(J.x+B*Math.cos(j),J.y+B*Math.sin(j)),v.lineTo(z.x,z.y),v.lineTo(J.x-B*Math.cos(j),J.y-B*Math.sin(j)),v.fillStyle=L,v.fill()}}}),v.restore()}function c(){var u=ri(e.linkDirectionalParticles),h=ri(e.linkDirectionalParticleSpeed),d=ri(e.linkDirectionalParticleWidth),f=ri(e.linkVisibility),p=ri(e.linkDirectionalParticleColor||e.linkColor),A=e.ctx;A.save(),e.graphData.links.filter(f).forEach(function(g){var v=u(g);if(!(!g.hasOwnProperty("__photons")||!g.__photons.length)){var b=g.source,x=g.target;if(!(!b||!x||!b.hasOwnProperty("x")||!x.hasOwnProperty("x"))){var E=h(g),S=g.__photons||[],M=Math.max(0,d(g)/2)/Math.sqrt(e.globalScale),C=p(g)||"rgba(0,0,0,0.28)";A.fillStyle=C;var T=g.__controlPoints?XR(Pr,[b.x,b.y].concat(la(g.__controlPoints),[x.x,x.y])):null,L=0,B=!1;S.forEach(function(F){var D=!!F.__singleHop;if(F.hasOwnProperty("__progressRatio")||(F.__progressRatio=D?0:L/v),!D&&L++,F.__progressRatio+=E,F.__progressRatio>=1)if(!D)F.__progressRatio=F.__progressRatio%1;else{B=!0;return}var P=F.__progressRatio,U=T?T.get(P):{x:b.x+(x.x-b.x)*P||0,y:b.y+(x.y-b.y)*P||0};A.beginPath(),A.arc(U.x,U.y,M,0,2*Math.PI,!1),A.fill()}),B&&(g.__photons=g.__photons.filter(function(F){return!F.__singleHop||F.__progressRatio<=1}))}}}),A.restore()}},emitParticle:function(e,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:YB().force("link",XB()).force("charge",$B()).force("center",zB()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.ctx=e},update:function(e){e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&qR(e.graphData.nodes,ri(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&qR(e.graphData.links,ri(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach(function(f){f.source=f[e.linkSource],f.target=f[e.linkTarget]}),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var n=e.forceLayout.force("link");n&&n.id(function(f){return f[e.nodeId]}).links(e.graphData.links);var i=e.dagMode&&Zee(e.graphData,function(f){return f[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),o=Math.max.apply(Math,la(Object.values(i||[]))),a=e.dagLevelDistance||e.graphData.nodes.length/(o||1)*ete*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(e.dagMode){var c=function(p,A){return function(g){return p?(i[g[e.nodeId]]-o/2)*a*(A?-1:1):void 0}},u=c(["lr","rl"].indexOf(e.dagMode)!==-1,e.dagMode==="rl"),h=c(["td","bu"].indexOf(e.dagMode)!==-1,e.dagMode==="bu");e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(f){f.fx=u(f),f.fy=h(f)})}e.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?JB(function(f){var p=i[f[e.nodeId]]||-1;return(e.dagMode==="radialin"?o-p:p)*a}).strength(function(f){return e.dagNodeFilter(f)?1:0}):null);for(var d=0;d<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);d++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function pP(s,e){var n=s instanceof Array?s:[s],i=new e;return i._destructor&&i._destructor(),{linkProp:function(a){return{default:i[a](),onChange:function(u,h){n.forEach(function(d){return h[d][a](u)})},triggerUpdate:!1}},linkMethod:function(a){return function(c){for(var u=arguments.length,h=new Array(u>1?u-1:0),d=1;d<u;d++)h[d-1]=arguments[d];var f=[];return n.forEach(function(p){var A=c[p],g=A[a].apply(A,h);g!==A&&f.push(g)}),f.length?f[0]:this}}}}var tte=800,nte=4,mP=pP("forceGraph",Pv),ite=pP(["forceGraph","shadowGraph"],Pv),rte=Object.assign.apply(Object,la(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(s){return bm({},s,mP.linkProp(s))})).concat(la(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(s){return bm({},s,ite.linkProp(s))})))),ste=Object.assign.apply(Object,la(["d3Force","d3ReheatSimulation","emitParticle"].map(function(s){return bm({},s,mP.linkMethod(s))})));function fb(s){if(s.canvas){var e=s.canvas.width,n=s.canvas.height;e===300&&n===150&&(e=n=0);var i=window.devicePixelRatio;e/=i,n/=i,[s.canvas,s.shadowCanvas].forEach(function(a){a.style.width="".concat(s.width,"px"),a.style.height="".concat(s.height,"px"),a.width=s.width*i,a.height=s.height*i,!e&&!n&&a.getContext("2d").scale(i,i)});var o=$a(s.canvas).k;s.zoom.translateBy(s.zoom.__baseElem,(s.width-e)/2/o,(s.height-n)/2/o),s.needsRedraw=!0}}function gP(s){var e=window.devicePixelRatio;s.setTransform(e,0,0,e,0,0)}function $R(s,e,n){s.save(),gP(s),s.clearRect(0,0,e,n),s.restore()}var ote=du({props:Wd({width:{default:window.innerWidth,onChange:function(e,n){return fb(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,n){return fb(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach(i),n.forceGraph.graphData(e),n.shadowGraph.graphData(e);function i(o){var a=o.type,c=o.objs;c.filter(function(u){if(!u.hasOwnProperty("__indexColor"))return!0;var h=n.colorTracker.lookup(u.__indexColor);return!h||!h.hasOwnProperty("d")||h.d!==u}).forEach(function(u){u.__indexColor=n.colorTracker.register({type:a,d:u})})}},triggerUpdate:!1},backgroundColor:{onChange:function(e,n){n.canvas&&e&&(n.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,n){n.shadowGraph.nodeCanvasObject(e?function(i,o,a){return e(i,i.__indexColor,o,a)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,n){n.shadowGraph.linkCanvasObject(e?function(i,o,a){return e(i,i.__indexColor,o,a)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,n){n.zoom.scaleExtent([e,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},rte),aliases:{stopAnimation:"pauseAnimation"},methods:Wd({graph2ScreenCoords:function(e,n,i){var o=$a(e.canvas);return{x:n*o.k+o.x,y:i*o.k+o.y}},screen2GraphCoords:function(e,n,i){var o=$a(e.canvas);return{x:(n-o.x)/o.k,y:(i-o.y)/o.k}},centerAt:function(e,n,i,o){if(!e.canvas)return null;if(n!==void 0||i!==void 0){var a=Object.assign({},n!==void 0?{x:n}:{},i!==void 0?{y:i}:{});return o?new Bv(c()).to(a,o).easing(ec.Quadratic.Out).onUpdate(u).start():u(a),this}return c();function c(){var h=$a(e.canvas);return{x:(e.width/2-h.x)/h.k,y:(e.height/2-h.y)/h.k}}function u(h){var d=h.x,f=h.y;e.zoom.translateTo(e.zoom.__baseElem,d===void 0?c().x:d,f===void 0?c().y:f),e.needsRedraw=!0}},zoom:function(e,n,i){if(!e.canvas)return null;if(n!==void 0)return i?new Bv({k:o()}).to({k:n},i).easing(ec.Quadratic.Out).onUpdate(function(c){var u=c.k;return a(u)}).start():a(n),this;return o();function o(){return $a(e.canvas).k}function a(c){e.zoom.scaleTo(e.zoom.__baseElem,c),e.needsRedraw=!0}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,o=arguments.length,a=new Array(o>3?o-3:0),c=3;c<o;c++)a[c-3]=arguments[c];var u=this.getGraphBbox.apply(this,a);if(u){var h={x:(u.x[0]+u.x[1])/2,y:(u.y[0]+u.y[1])/2},d=Math.max(1e-12,Math.min(1e12,(e.width-i*2)/(u.x[1]-u.x[0]),(e.height-i*2)/(u.y[1]-u.y[0])));this.centerAt(h.x,h.y,n),this.zoom(d,n)}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=ri(e.nodeVal),o=function(u){return Math.sqrt(Math.max(0,i(u)||1))*e.nodeRelSize},a=e.graphData.nodes.filter(n).map(function(c){return{x:c.x,y:c.y,r:o(c)}});return a.length?{x:[Kb(a,function(c){return c.x-c.r}),Xb(a,function(c){return c.x+c.r})],y:[Kb(a,function(c){return c.y-c.r}),Xb(a,function(c){return c.y+c.r})]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},ste),stateInit:function(){return{lastSetZoom:1,zoom:yee(),forceGraph:new Pv,shadowGraph:new Pv().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new Dee}},init:function(e,n){var i=this;e.innerHTML="";var o=document.createElement("div");o.classList.add("force-graph-container"),o.style.position="relative",e.appendChild(o),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),o.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var a=n.canvas.getContext("2d"),c=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),u={x:-1e12,y:-1e12},h=function(){var A=null,g=window.devicePixelRatio,v=u.x>0&&u.y>0?c.getImageData(u.x*g,u.y*g,1,1):null;return v&&(A=n.colorTracker.lookup(v.data)),A};Ua(n.canvas).call(sZ().subject(function(){if(!n.enableNodeDrag)return null;var p=h();return p&&p.type==="Node"?p.d:null}).on("start",function(p){var A=p.subject;A.__initialDragPos={x:A.x,y:A.y,fx:A.fx,fy:A.fy},p.active||(A.fx=A.x,A.fy=A.y),n.canvas.classList.add("grabbable")}).on("drag",function(p){var A=p.subject,g=A.__initialDragPos,v=p,b=$a(n.canvas).k,x={x:g.x+(v.x-g.x)/b-A.x,y:g.y+(v.y-g.y)/b-A.y};["x","y"].forEach(function(E){return A["f".concat(E)]=A[E]=g[E]+(v[E]-g[E])/b}),n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,A.__dragged=!0,n.onNodeDrag(A,x)}).on("end",function(p){var A=p.subject,g=A.__initialDragPos,v={x:A.x-g.x,y:A.y-g.y};g.fx===void 0&&(A.fx=void 0),g.fy===void 0&&(A.fy=void 0),delete A.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,A.__dragged&&(delete A.__dragged,n.onNodeDragEnd(A,v))})),n.zoom(n.zoom.__baseElem=Ua(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter(function(p){return!p.button&&n.enableZoomPanInteraction&&(n.enableZoomInteraction||p.type!=="wheel")&&(n.enablePanInteraction||p.type==="wheel")}).on("zoom",function(p){var A=p.transform;[a,c].forEach(function(g){gP(g),g.translate(A.x,A.y),g.scale(A.k,A.k)}),n.onZoom&&n.onZoom(Wd(Wd({},A),i.centerAt())),n.needsRedraw=!0}).on("end",function(p){return n.onZoomEnd&&n.onZoomEnd(Wd(Wd({},p.transform),i.centerAt()))}),fb(n),n.forceGraph.onNeedsRedraw(function(){return n.needsRedraw=!0}).onFinishUpdate(function(){$a(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=nte/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)});var d=document.createElement("div");d.classList.add("graph-tooltip"),o.appendChild(d),["pointermove","pointerdown"].forEach(function(p){return o.addEventListener(p,function(A){p==="pointerdown"&&(n.isPointerPressed=!0,n.pointerDownEvent=A),!n.isPointerDragging&&A.type==="pointermove"&&n.onBackgroundClick&&(A.pressure>0||n.isPointerPressed)&&(A.pointerType!=="touch"||A.movementX===void 0||[A.movementX,A.movementY].some(function(b){return Math.abs(b)>1}))&&(n.isPointerDragging=!0);var g=v(o);u.x=A.pageX-g.left,u.y=A.pageY-g.top,d.style.top="".concat(u.y,"px"),d.style.left="".concat(u.x,"px"),d.style.transform="translate(-".concat(u.x/n.width*100,"%, ").concat(n.height-u.y<100?"calc(-100% - 8px)":"21px",")");function v(b){var x=b.getBoundingClientRect(),E=window.pageXOffset||document.documentElement.scrollLeft,S=window.pageYOffset||document.documentElement.scrollTop;return{top:x.top+S,left:x.left+E}}},{passive:!0})}),o.addEventListener("pointerup",function(p){if(n.isPointerPressed=!1,n.isPointerDragging){n.isPointerDragging=!1;return}var A=[p,n.pointerDownEvent];requestAnimationFrame(function(){if(p.button===0)if(n.hoverObj){var g=n["on".concat(n.hoverObj.type,"Click")];g&&g.apply(void 0,[n.hoverObj.d].concat(A))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,A);if(p.button===2)if(n.hoverObj){var v=n["on".concat(n.hoverObj.type,"RightClick")];v&&v.apply(void 0,[n.hoverObj.d].concat(A))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,A)})},{passive:!0}),o.addEventListener("contextmenu",function(p){return!n.onBackgroundRightClick&&!n.onNodeRightClick&&!n.onLinkRightClick?!0:(p.preventDefault(),!1)}),n.forceGraph(a),n.shadowGraph(c);var f=Eee(function(){$R(c,n.width,n.height),n.shadowGraph.linkWidth(function(A){return ri(n.linkWidth)(A)+n.linkHoverPrecision});var p=$a(n.canvas);n.shadowGraph.globalScale(p.k).tickFrame()},tte);n.flushShadowCanvas=f.flush,(this._animationCycle=function p(){var A=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some(function(T){return T.__photons&&T.__photons.length});if(n.needsRedraw=!1,n.enablePointerInteraction){var g=n.isPointerDragging?null:h();if(g!==n.hoverObj){var v=n.hoverObj,b=v?v.type:null,x=g?g.type:null;if(b&&b!==x){var E=n["on".concat(b,"Hover")];E&&E(null,v.d)}if(x){var S=n["on".concat(x,"Hover")];S&&S(g.d,b===x?v.d:null)}var M=g&&ri(n["".concat(g.type.toLowerCase(),"Label")])(g.d)||"";d.style.visibility=M?"visible":"hidden",d.innerHTML=M,n.canvas.classList[g&&n["on".concat(x,"Click")]||!g&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=g}A&&f()}if(A){$R(a,n.width,n.height);var C=$a(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(a,C),n.forceGraph.globalScale(C).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(a,C)}GL(),n.animationFrameRequestId=requestAnimationFrame(p)})()},update:function(e){}}),oy={width:vt.number,height:vt.number,graphData:vt.shape({nodes:vt.arrayOf(vt.object).isRequired,links:vt.arrayOf(vt.object).isRequired}),backgroundColor:vt.string,nodeRelSize:vt.number,nodeId:vt.string,nodeLabel:vt.oneOfType([vt.string,vt.func]),nodeVal:vt.oneOfType([vt.number,vt.string,vt.func]),nodeVisibility:vt.oneOfType([vt.bool,vt.string,vt.func]),nodeColor:vt.oneOfType([vt.string,vt.func]),nodeAutoColorBy:vt.oneOfType([vt.string,vt.func]),onNodeHover:vt.func,onNodeClick:vt.func,linkSource:vt.string,linkTarget:vt.string,linkLabel:vt.oneOfType([vt.string,vt.func]),linkVisibility:vt.oneOfType([vt.bool,vt.string,vt.func]),linkColor:vt.oneOfType([vt.string,vt.func]),linkAutoColorBy:vt.oneOfType([vt.string,vt.func]),linkWidth:vt.oneOfType([vt.number,vt.string,vt.func]),linkCurvature:vt.oneOfType([vt.number,vt.string,vt.func]),linkDirectionalArrowLength:vt.oneOfType([vt.number,vt.string,vt.func]),linkDirectionalArrowColor:vt.oneOfType([vt.string,vt.func]),linkDirectionalArrowRelPos:vt.oneOfType([vt.number,vt.string,vt.func]),linkDirectionalParticles:vt.oneOfType([vt.number,vt.string,vt.func]),linkDirectionalParticleSpeed:vt.oneOfType([vt.number,vt.string,vt.func]),linkDirectionalParticleWidth:vt.oneOfType([vt.number,vt.string,vt.func]),linkDirectionalParticleColor:vt.oneOfType([vt.string,vt.func]),onLinkHover:vt.func,onLinkClick:vt.func,dagMode:vt.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:vt.number,dagNodeFilter:vt.func,onDagError:vt.func,d3AlphaMin:vt.number,d3AlphaDecay:vt.number,d3VelocityDecay:vt.number,warmupTicks:vt.number,cooldownTicks:vt.number,cooldownTime:vt.number,onEngineTick:vt.func,onEngineStop:vt.func,getGraphBbox:vt.func},AP={zoomToFit:vt.func,onNodeRightClick:vt.func,onNodeDrag:vt.func,onNodeDragEnd:vt.func,onLinkRightClick:vt.func,linkHoverPrecision:vt.number,onBackgroundClick:vt.func,onBackgroundRightClick:vt.func,enablePointerInteraction:vt.bool,enableNodeDrag:vt.bool},xw={showNavInfo:vt.bool,nodeOpacity:vt.number,nodeResolution:vt.number,nodeThreeObject:vt.oneOfType([vt.object,vt.string,vt.func]),nodeThreeObjectExtend:vt.oneOfType([vt.bool,vt.string,vt.func]),linkOpacity:vt.number,linkResolution:vt.number,linkCurveRotation:vt.oneOfType([vt.number,vt.string,vt.func]),linkMaterial:vt.oneOfType([vt.object,vt.string,vt.func]),linkThreeObject:vt.oneOfType([vt.object,vt.string,vt.func]),linkThreeObjectExtend:vt.oneOfType([vt.bool,vt.string,vt.func]),linkPositionUpdate:vt.func,linkDirectionalArrowResolution:vt.number,linkDirectionalParticleResolution:vt.number,forceEngine:vt.oneOf(["d3","ngraph"]),ngraphPhysics:vt.object,numDimensions:vt.oneOf([1,2,3])},ate=Object.assign({},oy,AP,{linkLineDash:vt.oneOfType([vt.arrayOf(vt.number),vt.string,vt.func]),nodeCanvasObjectMode:vt.oneOfType([vt.string,vt.func]),nodeCanvasObject:vt.func,nodePointerAreaPaint:vt.func,linkCanvasObjectMode:vt.oneOfType([vt.string,vt.func]),linkCanvasObject:vt.func,linkPointerAreaPaint:vt.func,autoPauseRedraw:vt.bool,minZoom:vt.number,maxZoom:vt.number,enableZoomInteraction:vt.bool,enablePanInteraction:vt.bool,onZoom:vt.func,onZoomEnd:vt.func,onRenderFramePre:vt.func,onRenderFramePost:vt.func}),lte=Object.assign({},oy,AP,xw,{enableNavigationControls:vt.bool,controlType:vt.oneOf(["trackball","orbit","fly"]),rendererConfig:vt.object,extraRenderers:vt.arrayOf(vt.shape({render:vt.func.isRequired}))}),cte=Object.assign({},oy,xw,{nodeDesc:vt.oneOfType([vt.string,vt.func]),linkDesc:vt.oneOfType([vt.string,vt.func])}),hte=Object.assign({},oy,xw,{markerAttrs:vt.object,yOffset:vt.number,glScale:vt.number});const vP=Ov(bY,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"]});vP.displayName="ForceGraphVR";vP.propTypes=cte;const yP=Ov(BY,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"],initPropNames:["markerAttrs"]});yP.displayName="ForceGraphAR";yP.propTypes=hte;const Ew=Ov(x$,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","cameraPosition","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords","postProcessingComposer","lights","scene","camera","renderer","controls","refresh"],initPropNames:["controlType","rendererConfig","extraRenderers"]});Ew.displayName="ForceGraph3D";Ew.propTypes=lte;const xP=Ov(ote,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});xP.displayName="ForceGraph2D";xP.propTypes=ate;function ute(s,e,n){return e=Dv(e),yte(s,EP()?Reflect.construct(e,n||[],Dv(s).constructor):e.apply(s,n))}function EP(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EP=function(){return!!s})()}function dte(s,e){var n=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(n!=null){var i,o,a,c,u=[],h=!0,d=!1;try{if(a=(n=n.call(s)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=a.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(f){d=!0,o=f}finally{try{if(!h&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(d)throw o}}return u}}function fte(s,e){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var i=n.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function pte(s){var e=fte(s,"string");return typeof e=="symbol"?e:String(e)}function mte(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function JR(s,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,pte(i.key),i)}}function gte(s,e,n){return e&&JR(s.prototype,e),n&&JR(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s}function Ate(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&b_(s,e)}function Dv(s){return Dv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Dv(s)}function b_(s,e){return b_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},b_(s,e)}function vte(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function yte(s,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vte(s)}function ZR(s,e){return Ete(s)||dte(s,e)||bP(s,e)||wte()}function W0(s){return xte(s)||bte(s)||bP(s)||_te()}function xte(s){if(Array.isArray(s))return __(s)}function Ete(s){if(Array.isArray(s))return s}function bte(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function bP(s,e){if(s){if(typeof s=="string")return __(s,e);var n=Object.prototype.toString.call(s).slice(8,-1);if(n==="Object"&&s.constructor&&(n=s.constructor.name),n==="Map"||n==="Set")return Array.from(s);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return __(s,e)}}function __(s,e){(e==null||e>s.length)&&(e=s.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=s[n];return i}function _te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Qd=typeof window<"u"&&window.THREE?window.THREE:{LinearFilter:fo,Sprite:Cj,SpriteMaterial:LB,SRGBColorSpace:ms,Texture:Js},Mte=function(s){Ate(e,s);function e(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"rgba(255, 255, 255, 1)";return mte(this,e),n=ute(this,e,[new Qd.SpriteMaterial]),n._text="".concat(i),n._textHeight=o,n._color=a,n._backgroundColor=!1,n._padding=0,n._borderWidth=0,n._borderRadius=0,n._borderColor="white",n._strokeWidth=0,n._strokeColor="white",n._fontFace="system-ui",n._fontSize=90,n._fontWeight="normal",n._canvas=document.createElement("canvas"),n._genCanvas(),n}return gte(e,[{key:"text",get:function(){return this._text},set:function(i){this._text=i,this._genCanvas()}},{key:"textHeight",get:function(){return this._textHeight},set:function(i){this._textHeight=i,this._genCanvas()}},{key:"color",get:function(){return this._color},set:function(i){this._color=i,this._genCanvas()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(i){this._backgroundColor=i,this._genCanvas()}},{key:"padding",get:function(){return this._padding},set:function(i){this._padding=i,this._genCanvas()}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(i){this._borderWidth=i,this._genCanvas()}},{key:"borderRadius",get:function(){return this._borderRadius},set:function(i){this._borderRadius=i,this._genCanvas()}},{key:"borderColor",get:function(){return this._borderColor},set:function(i){this._borderColor=i,this._genCanvas()}},{key:"fontFace",get:function(){return this._fontFace},set:function(i){this._fontFace=i,this._genCanvas()}},{key:"fontSize",get:function(){return this._fontSize},set:function(i){this._fontSize=i,this._genCanvas()}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(i){this._fontWeight=i,this._genCanvas()}},{key:"strokeWidth",get:function(){return this._strokeWidth},set:function(i){this._strokeWidth=i,this._genCanvas()}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(i){this._strokeColor=i,this._genCanvas()}},{key:"_genCanvas",value:function(){var i=this,o=this._canvas,a=o.getContext("2d"),c=Array.isArray(this.borderWidth)?this.borderWidth:[this.borderWidth,this.borderWidth],u=c.map(function(B){return B*i.fontSize*.1}),h=Array.isArray(this.borderRadius)?this.borderRadius:[this.borderRadius,this.borderRadius,this.borderRadius,this.borderRadius],d=h.map(function(B){return B*i.fontSize*.1}),f=Array.isArray(this.padding)?this.padding:[this.padding,this.padding],p=f.map(function(B){return B*i.fontSize*.1}),A=this.text.split(`
`),g="".concat(this.fontWeight," ").concat(this.fontSize,"px ").concat(this.fontFace);a.font=g;var v=Math.max.apply(Math,W0(A.map(function(B){return a.measureText(B).width}))),b=this.fontSize*A.length;if(o.width=v+u[0]*2+p[0]*2,o.height=b+u[1]*2+p[1]*2,this.borderWidth){if(a.strokeStyle=this.borderColor,u[0]){var x=u[0]/2;a.lineWidth=u[0],a.beginPath(),a.moveTo(x,d[0]),a.lineTo(x,o.height-d[3]),a.moveTo(o.width-x,d[1]),a.lineTo(o.width-x,o.height-d[2]),a.stroke()}if(u[1]){var E=u[1]/2;a.lineWidth=u[1],a.beginPath(),a.moveTo(Math.max(u[0],d[0]),E),a.lineTo(o.width-Math.max(u[0],d[1]),E),a.moveTo(Math.max(u[0],d[3]),o.height-E),a.lineTo(o.width-Math.max(u[0],d[2]),o.height-E),a.stroke()}if(this.borderRadius){var S=Math.max.apply(Math,W0(u)),M=S/2;a.lineWidth=S,a.beginPath(),[!!d[0]&&[d[0],M,M,d[0]],!!d[1]&&[o.width-d[1],o.width-M,M,d[1]],!!d[2]&&[o.width-d[2],o.width-M,o.height-M,o.height-d[2]],!!d[3]&&[d[3],M,o.height-M,o.height-d[3]]].filter(function(B){return B}).forEach(function(B){var F=ZR(B,4),D=F[0],P=F[1],U=F[2],K=F[3];a.moveTo(D,U),a.quadraticCurveTo(P,U,P,K)}),a.stroke()}}this.backgroundColor&&(a.fillStyle=this.backgroundColor,this.borderRadius?(a.beginPath(),a.moveTo(u[0],d[0]),[[u[0],d[0],o.width-d[1],u[1],u[1],u[1]],[o.width-u[0],o.width-u[0],o.width-u[0],u[1],d[1],o.height-d[2]],[o.width-u[0],o.width-d[2],d[3],o.height-u[1],o.height-u[1],o.height-u[1]],[u[0],u[0],u[0],o.height-u[1],o.height-d[3],d[0]]].forEach(function(B){var F=ZR(B,6),D=F[0],P=F[1],U=F[2],K=F[3],J=F[4],z=F[5];a.quadraticCurveTo(D,K,P,J),a.lineTo(U,z)}),a.closePath(),a.fill()):a.fillRect(u[0],u[1],o.width-u[0]*2,o.height-u[1]*2)),a.translate.apply(a,W0(u)),a.translate.apply(a,W0(p)),a.font=g,a.fillStyle=this.color,a.textBaseline="bottom";var C=this.strokeWidth>0;C&&(a.lineWidth=this.strokeWidth*this.fontSize/10,a.strokeStyle=this.strokeColor),A.forEach(function(B,F){var D=(v-a.measureText(B).width)/2,P=(F+1)*i.fontSize;C&&a.strokeText(B,D,P),a.fillText(B,D,P)}),this.material.map&&this.material.map.dispose();var T=this.material.map=new Qd.Texture(o);T.minFilter=Qd.LinearFilter,T.colorSpace=Qd.SRGBColorSpace,T.needsUpdate=!0;var L=this.textHeight*A.length+c[1]*2+f[1]*2;this.scale.set(L*o.width/o.height,L,0)}},{key:"clone",value:function(){return new this.constructor(this.text,this.textHeight,this.color).copy(this)}},{key:"copy",value:function(i){return Qd.Sprite.prototype.copy.call(this,i),this.color=i.color,this.backgroundColor=i.backgroundColor,this.padding=i.padding,this.borderWidth=i.borderWidth,this.borderColor=i.borderColor,this.fontFace=i.fontFace,this.fontSize=i.fontSize,this.fontWeight=i.fontWeight,this.strokeWidth=i.strokeWidth,this.strokeColor=i.strokeColor,this}}]),e}(Qd.Sprite);function pie(){const[s,e]=ps.useState({nodes:[],links:[]}),n=ps.useRef(null),i=ps.useRef(null),[o,a]=ps.useState({width:window.innerWidth,height:window.innerHeight});ps.useEffect(()=>{fetch("/api/graph.json").then(h=>h.json()).then(h=>{const d=u(h.nodes),f=h.links;e({nodes:d,links:f})}).catch(h=>console.error("Error fetching graph data:",h))},[]);const c=h=>{h.id?window.open(`/${h.id}`,"_blank"):console.log("No URL provided for this node")};ps.useEffect(()=>{const h=()=>{n.current&&a({width:n.current.offsetWidth,height:n.current.offsetHeight})};return window.addEventListener("resize",h),h(),()=>{window.removeEventListener("resize",h)}},[n.current]);function u(h){let d={};return h.forEach(f=>{f.tags.forEach(p=>{d[p]||(d[p]={x:0,y:0,z:0,count:0}),d[p].x+=Math.random()*100,d[p].y+=Math.random()*100,d[p].z+=Math.random()*100,d[p].count++})}),Object.keys(d).forEach(f=>{d[f].x/=d[f].count,d[f].y/=d[f].count,d[f].z/=d[f].count}),h.forEach(f=>{let p=0,A=0,g=0;f.tags.forEach(v=>{p+=d[v].x,A+=d[v].y,g+=d[v].z}),f.x=p/f.tags.length,f.y=A/f.tags.length,f.z=g/f.tags.length}),h}return n1.jsxs("div",{ref:n,className:"w-full h-100vh overflow-hidden overscroll-contain relative",id:"nodegraph",children:[n1.jsx(Ew,{graphData:s,width:o.width,height:o.height,nodeAutoColorBy:"group",linkColor:h=>h.type==="url"?"blue":"red",linkWidth:h=>h.type==="url"?2:1,linkDirectionalParticles:h=>h.type==="url"?2:0,nodeThreeObject:h=>{const d=new Qo(new Tm(5),new qv({color:h.color})),f=new Mte(h.name);return f.color="white",f.textHeight=8,f.material.depthWrite=!1,f.material.transparent=!0,f.position.set(0,0,12),d.add(f),d},onNodeClick:c,onNodeHover:h=>{h?(i.current.style.display="block",i.current.style.left=`${h.x}px`,i.current.style.top=`${h.y}px`,i.current.innerHTML=h.description):i.current.style.display="none"}}),n1.jsx("div",{ref:i,className:"absolute bg-white p-2 rounded shadow-md hidden",style:{transform:"translate(-50%, -50%)",pointerEvents:"none"},children:"Tooltip"})]})}export{pie as default};
