import{S as le,i as ce,s as ue,e as k,a as x,t as Y,A as de,b as w,f as v,c as V,d as U,h as R,g as J,j as p,l as f,k as S,n as A,o as re,q as X,C as he,r as pe,u as ee,w as fe,B as me,D as q}from"./index.Dpw-MKR5.js";import{g as ye}from"./globals.D0QH3NT1.js";import{e as te}from"./each.-gASlQSi.js";import{t as H,m as oe,f as ve}from"./khashvault.B92RoTXM.js";import"./index.CgBe15gE.js";import"./index.BH1EYZ08.js";const{document:se}=ye;function ae(t,i,c){const o=t.slice();return o[20]=i[c],o}function ne(t){let i,c=t[20]+"",o,u,y,_;function T(){return t[9](t[20])}return{c(){i=k("button"),o=Y(c),u=x(),this.h()},l(l){i=w(l,"BUTTON",{class:!0});var d=U(i);o=R(d,c),u=V(d),d.forEach(v),this.h()},h(){p(i,"class","relative z-1 px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500"),q(i,"opacity-100",t[3][t[20]]),q(i,"opacity-50",!t[3][t[20]])},m(l,d){S(l,i,d),f(i,o),f(i,u),y||(_=A(i,"click",T),y=!0)},p(l,d){t=l,d&8&&c!==(c=t[20]+"")&&re(o,c),d&8&&q(i,"opacity-100",t[3][t[20]]),d&8&&q(i,"opacity-50",!t[3][t[20]])},d(l){l&&v(i),y=!1,_()}}}function ge(t){let i,c,o,u,y,_,T,l,d,j,P,g,I="Sync",O,b,z="Currently Playing Video ID:",D,C,B,E,$="Skip",N,e,r,a,F=`<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web
    browser that
    <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>`,G,Q,M=te(Object.keys(t[3])),h=[];for(let s=0;s<M.length;s+=1)h[s]=ne(ae(t,M,s));return{c(){i=k("link"),c=x(),o=k("div"),u=k("button"),y=Y("Play Tracks"),T=x(),l=k("button"),d=Y("Play Sets"),P=x(),g=k("button"),g.textContent=I,O=x(),b=k("strong"),b.textContent=z,D=x(),C=Y(t[0]),B=x(),E=k("button"),E.textContent=$,N=x(),e=k("div");for(let s=0;s<h.length;s+=1)h[s].c();r=x(),a=k("video"),a.innerHTML=F,this.h()},l(s){const m=de("svelte-1jkjurj",se.head);i=w(m,"LINK",{href:!0,rel:!0}),m.forEach(v),c=V(s),o=w(s,"DIV",{class:!0});var n=U(o);u=w(n,"BUTTON",{class:!0});var L=U(u);y=R(L,"Play Tracks"),L.forEach(v),T=V(n),l=w(n,"BUTTON",{class:!0});var Z=U(l);d=R(Z,"Play Sets"),Z.forEach(v),P=V(n),g=w(n,"BUTTON",{class:!0,"data-svelte-h":!0}),J(g)!=="svelte-ecpas0"&&(g.textContent=I),O=V(n),b=w(n,"STRONG",{"data-svelte-h":!0}),J(b)!=="svelte-1xwgl6o"&&(b.textContent=z),D=V(n),C=R(n,t[0]),B=V(n),E=w(n,"BUTTON",{class:!0,"data-svelte-h":!0}),J(E)!=="svelte-1cd9dc6"&&(E.textContent=$),n.forEach(v),N=V(s),e=w(s,"DIV",{class:!0});var W=U(e);for(let K=0;K<h.length;K+=1)h[K].l(W);W.forEach(v),r=V(s),a=w(s,"VIDEO",{id:!0,class:!0,preload:!0,width:!0,height:!0,"data-svelte-h":!0}),J(a)!=="svelte-12y7kzy"&&(a.innerHTML=F),this.h()},h(){p(i,"href","https://unpkg.com/video.js/dist/video-js.min.css"),p(i,"rel","stylesheet"),p(u,"class",_="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[1]?"opacity-100":"opacity-50")),p(l,"class",j="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[2]?"opacity-100":"opacity-50")),p(g,"class","px-4 py-2 bg-blue-500 border text-white rounded hover:scale-110 ease-in-out duration-500"),p(E,"class","px-4 py-2 bg-red-500 text-white rounded hover:scale-110 ease-in-out duration-500"),p(o,"class","space-x-2 my-4"),p(e,"class","space-x-2"),p(a,"id","video-js"),p(a,"class","video-js vjs-default-skin w-full aspect-video"),a.controls=!0,p(a,"preload","auto"),p(a,"width","640"),p(a,"height","264")},m(s,m){f(se.head,i),S(s,c,m),S(s,o,m),f(o,u),f(u,y),f(o,T),f(o,l),f(l,d),f(o,P),f(o,g),f(o,O),f(o,b),f(o,D),f(o,C),f(o,B),f(o,E),S(s,N,m),S(s,e,m);for(let n=0;n<h.length;n+=1)h[n]&&h[n].m(e,null);S(s,r,m),S(s,a,m),G||(Q=[A(u,"click",t[7]),A(l,"click",t[8]),A(g,"click",t[6]),A(E,"click",t[4])],G=!0)},p(s,[m]){if(m&2&&_!==(_="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(s[1]?"opacity-100":"opacity-50"))&&p(u,"class",_),m&4&&j!==(j="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(s[2]?"opacity-100":"opacity-50"))&&p(l,"class",j),m&1&&re(C,s[0]),m&40){M=te(Object.keys(s[3]));let n;for(n=0;n<M.length;n+=1){const L=ae(s,M,n);h[n]?h[n].p(L,m):(h[n]=ne(L),h[n].c(),h[n].m(e,null))}for(;n<h.length;n+=1)h[n].d(1);h.length=M.length}},i:X,o:X,d(s){s&&(v(c),v(o),v(N),v(e),v(r),v(a)),v(i),he(h,s),G=!1,pe(Q)}}}function _e(t){return new URLSearchParams(window.location.search).get(t)}function ie(t){return/^[a-zA-Z0-9_-]{11}$/.test(t)}function be(t,i,c){let o,u;ee(t,H,e=>c(3,o=e)),ee(t,oe,e=>c(13,u=e));let y,_=!1,T=!1,l="",d=!0,j=!1;fe(()=>{T=!0,console.log("Mounted"),P().then(()=>{T&&_&&O()})}),me(()=>{T=!1,y&&y.dispose()});async function P(){try{await new Promise((e,r)=>{const a=document.createElement("script");a.src="https://unpkg.com/video.js/dist/video.min.js",a.onload=e,a.onerror=()=>r(new Error("Failed to load Video.js")),document.head.appendChild(a)}),await new Promise((e,r)=>{const a=document.createElement("script");a.src="https://unpkg.com/videojs-youtube/dist/Youtube.min.js",a.onload=e,a.onerror=()=>r(new Error("Failed to load YouTube plugin")),document.head.appendChild(a)}),_=!0}catch(e){console.error("Error loading scripts:",e)}}async function g(){ve.then(()=>{console.log("Music data has been successfully updated.")}).catch(e=>{console.error("Error updating music data:",e)})}function I(){const e={};u.items.forEach(r=>{r.tags.forEach(a=>{a!=="music"&&(e[a]=!0)})}),H.set(e)}async function O(){if(u.items.length===0)try{await g(),console.log("Music Data Loaded:",u.items)}catch(e){console.error("Failed to fetch music data:",e);return}Object.keys(o).length===0?(console.log("Initializing tags from music data..."),I()):console.log("Tags already initialized:",o),b()}function b(){if(typeof videojs<"u"&&videojs.getTech("youtube")){const e=_e("yt"),r=z();if(r.length===0&&(!e||!ie(e)))return;const a=e&&ie(e)?e:r[Math.floor(Math.random()*r.length)];y=videojs("video-js",{techOrder:["youtube"],sources:[{type:"video/youtube",src:`https://www.youtube.com/watch?v=${a}`}],youtube:{iv_load_policy:3},controls:!0,autoplay:!0,preload:"auto"}),y.on("ended",D),c(0,l=a)}else setTimeout(b,100)}function z(){let e=[];return u.items.forEach(r=>{r.tags.some(F=>o[F]===!0)&&(d&&(e=e.concat(r.ytTracks)),j&&(e=e.concat(r.ytSets)))}),e}function D(){const e=z();if(e.length===0)return;const r=e[Math.floor(Math.random()*e.length)];y.src({type:"video/youtube",src:`https://www.youtube.com/watch?v=${r}`}),y.play(),c(0,l=r)}function C(e){const r={...o,[e]:!o[e]};H.set(r)}async function B(){oe.set({items:[]}),H.set({});try{await g(),I(),b(),console.log("Data and tags have been synchronized."),window.location.reload()}catch(e){console.error("Error during synchronization:",e)}}return[l,d,j,o,D,C,B,()=>c(1,d=!d),()=>c(2,j=!j),e=>C(e)]}class Ve extends le{constructor(i){super(),ce(this,i,be,ge,ue,{})}}export{Ve as default};
