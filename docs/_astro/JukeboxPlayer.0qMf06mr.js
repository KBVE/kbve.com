import{S as X,i as Z,s as ee,e as g,a as S,t as A,A as te,b,f as d,c as x,g as H,d as C,h as F,j as p,l as k,k as _,n as L,q,C as oe,r as se,u as Y,w as ae,B as ie,D as z,o as ne}from"./index.DZiq8zhp.js";import{g as le}from"./globals.D0QH3NT1.js";import{e as K}from"./each.-gASlQSi.js";import{t as B,m as G,u as re}from"./khashvault.Cpl6ppDT.js";import"./index.B59itue1.js";import"./index.BH1EYZ08.js";const{document:Q}=le;function R(s,a,c){const i=s.slice();return i[19]=a[c],i}function W(s){let a,c=s[19]+"",i,m,h,f;function y(){return s[5](s[19])}return{c(){a=g("button"),i=A(c),m=S(),this.h()},l(l){a=b(l,"BUTTON",{class:!0});var n=C(a);i=F(n,c),m=x(n),n.forEach(d),this.h()},h(){p(a,"class","px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500"),z(a,"opacity-100",s[2][s[19]]),z(a,"opacity-50",!s[2][s[19]])},m(l,n){_(l,a,n),k(a,i),k(a,m),h||(f=L(a,"click",y),h=!0)},p(l,n){s=l,n&4&&c!==(c=s[19]+"")&&ne(i,c),n&4&&z(a,"opacity-100",s[2][s[19]]),n&4&&z(a,"opacity-50",!s[2][s[19]])},d(l){l&&d(a),h=!1,f()}}}function ce(s){let a,c,i,m="Sync",h,f,y,l,n,O,w,D,v,T,j,V,u,I=`<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a
		web browser that
		<a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>`,P,N,E=K(Object.keys(s[2])),e=[];for(let t=0;t<E.length;t+=1)e[t]=W(R(s,E,t));return{c(){a=g("link"),c=S(),i=g("button"),i.textContent=m,h=S(),f=g("div");for(let t=0;t<e.length;t+=1)e[t].c();y=S(),l=g("div"),n=g("button"),O=A("Play Tracks"),D=S(),v=g("button"),T=A("Play Sets"),V=S(),u=g("video"),u.innerHTML=I,this.h()},l(t){const o=te("svelte-1mim58",Q.head);a=b(o,"LINK",{href:!0,rel:!0}),o.forEach(d),c=x(t),i=b(t,"BUTTON",{class:!0,"data-svelte-h":!0}),H(i)!=="svelte-9jjtnc"&&(i.textContent=m),h=x(t),f=b(t,"DIV",{class:!0});var r=C(f);for(let $=0;$<e.length;$+=1)e[$].l(r);r.forEach(d),y=x(t),l=b(t,"DIV",{class:!0});var M=C(l);n=b(M,"BUTTON",{class:!0});var J=C(n);O=F(J,"Play Tracks"),J.forEach(d),D=x(M),v=b(M,"BUTTON",{class:!0});var U=C(v);T=F(U,"Play Sets"),U.forEach(d),M.forEach(d),V=x(t),u=b(t,"VIDEO",{id:!0,class:!0,preload:!0,width:!0,height:!0,"data-svelte-h":!0}),H(u)!=="svelte-tbppw6"&&(u.innerHTML=I),this.h()},h(){p(a,"href","https://unpkg.com/video.js/dist/video-js.min.css"),p(a,"rel","stylesheet"),p(i,"class","px-4 py-2 bg-blue-500 border text-white rounded hover:scale-110 ease-in-out duration-500"),p(f,"class","space-x-2"),p(n,"class",w="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(s[0]?"opacity-100":"opacity-50")),p(v,"class",j="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(s[1]?"opacity-100":"opacity-50")),p(l,"class","space-x-2 my-4"),p(u,"id","video-js"),p(u,"class","video-js vjs-default-skin w-full aspect-video"),u.controls=!0,p(u,"preload","auto"),p(u,"width","640"),p(u,"height","264")},m(t,o){k(Q.head,a),_(t,c,o),_(t,i,o),_(t,h,o),_(t,f,o);for(let r=0;r<e.length;r+=1)e[r]&&e[r].m(f,null);_(t,y,o),_(t,l,o),k(l,n),k(n,O),k(l,D),k(l,v),k(v,T),_(t,V,o),_(t,u,o),P||(N=[L(i,"click",s[4]),L(n,"click",s[6]),L(v,"click",s[7])],P=!0)},p(t,[o]){if(o&12){E=K(Object.keys(t[2]));let r;for(r=0;r<E.length;r+=1){const M=R(t,E,r);e[r]?e[r].p(M,o):(e[r]=W(M),e[r].c(),e[r].m(f,null))}for(;r<e.length;r+=1)e[r].d(1);e.length=E.length}o&1&&w!==(w="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[0]?"opacity-100":"opacity-50"))&&p(n,"class",w),o&2&&j!==(j="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[1]?"opacity-100":"opacity-50"))&&p(v,"class",j)},i:q,o:q,d(t){t&&(d(c),d(i),d(h),d(f),d(y),d(l),d(V),d(u)),d(a),oe(e,t),P=!1,se(N)}}}function ue(s,a,c){let i,m;Y(s,B,e=>c(2,i=e)),Y(s,G,e=>c(11,m=e));let h,f=!1,y=!1,l=!0,n=!1;ae(()=>{y=!0,console.log("Mounted"),O().then(()=>{y&&f&&v()})}),ie(()=>{y=!1,h&&h.dispose()});async function O(){try{await new Promise((e,t)=>{const o=document.createElement("script");o.src="https://unpkg.com/video.js/dist/video.min.js",o.onload=e,o.onerror=()=>t(new Error("Failed to load Video.js")),document.head.appendChild(o)}),await new Promise((e,t)=>{const o=document.createElement("script");o.src="https://unpkg.com/videojs-youtube/dist/Youtube.min.js",o.onload=e,o.onerror=()=>t(new Error("Failed to load YouTube plugin")),document.head.appendChild(o)}),f=!0}catch(e){console.error("Error loading scripts:",e)}}async function w(){re.then(()=>{console.log("Music data has been successfully updated.")}).catch(e=>{console.error("Error updating music data:",e)})}function D(){const e={};m.items.forEach(t=>{t.tags.forEach(o=>{o!=="music"&&(e[o]=!0)})}),B.set(e)}async function v(){if(m.items.length===0)try{await w(),console.log("Music Data Loaded:",m.items)}catch(e){console.error("Failed to fetch music data:",e);return}Object.keys(i).length===0?(console.log("Initializing tags from music data..."),D()):console.log("Tags already initialized:",i),T()}function T(){if(typeof videojs<"u"&&videojs.getTech("youtube")){const e=j();if(e.length===0)return;const t=Math.floor(Math.random()*e.length),o=e[t];h=videojs("video-js",{techOrder:["youtube"],sources:[{type:"video/youtube",src:`https://www.youtube.com/watch?v=${o}`}],youtube:{iv_load_policy:3},controls:!0,autoplay:!0,preload:"auto"}),h.on("ended",V)}else setTimeout(T,100)}function j(){let e=[];return m.items.forEach(t=>{t.tags.some(r=>i[r]===!0)&&(l&&(e=e.concat(t.ytTracks)),n&&(e=e.concat(t.ytSets)))}),e}function V(){const e=j();if(e.length===0)return;const t=e[Math.floor(Math.random()*e.length)];h.src({type:"video/youtube",src:`https://www.youtube.com/watch?v=${t}`}),h.play()}function u(e){const t={...i,[e]:!i[e]};B.set(t)}async function I(){G.set({items:[]}),B.set({});try{await w(),D(),T(),console.log("Data and tags have been synchronized."),window.location.reload()}catch(e){console.error("Error during synchronization:",e)}}return[l,n,i,u,I,e=>u(e),()=>c(0,l=!l),()=>c(1,n=!n)]}class ve extends X{constructor(a){super(),Z(this,a,ue,ce,ee,{})}}export{ve as default};
