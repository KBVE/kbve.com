import{r,j as e}from"./react.DlTOZz3w.js";import{C as f,O as g,u as y}from"./@react-three.Ck9Sp3Iy.js";import{k as j,l as x,m as v,E as o,n as h}from"./three.Ga6J2dPR.js";import{u as w}from"./@nanostores.CGdf_Ivg.js";import{a as b}from"./nanostores.Bo9-_MAV.js";import"./react-use-measure.BL_PlT8A.js";import"./its-fine.zliSf007.js";import"./react-reconciler.19LmHG8m.js";import"./react-dom.DmziSIKl.js";import"./scheduler.C323NY8X.js";import"./@babel.CF3RwP-h.js";import"./three-stdlib.C120A-Vd.js";import"./zustand.BejR9DWA.js";const c=b({values:[1,1,1,1],rolling:!1});function M(s=4){c.set({values:Array(s).fill(1),rolling:!1})}function u(s){c.set({...c.get(),rolling:s})}function I(s){c.set({values:s,rolling:!1})}const N=["/assets/items/set/dice/dice1.png","/assets/items/set/dice/dice2.png","/assets/items/set/dice/dice3.png","/assets/items/set/dice/dice4.png","/assets/items/set/dice/dice5.png","/assets/items/set/dice/dice6.png"],E=[new o(-Math.PI/2,-Math.PI/2,-Math.PI/2),new o(0,Math.PI/2,0),new o(0,-Math.PI/2,-Math.PI/2),new o(Math.PI/2,Math.PI,Math.PI),new o(0,0,-Math.PI/2),new o(Math.PI,0,0)];function P({values:s,rolling:m}){const l=r.useRef([]),d=r.useRef([]),i=r.useRef([]);return r.useEffect(()=>{const t=new j;new x(16766720);const a=new x(65535);d.current=N.map(n=>t.load(n)),i.current=d.current.map(n=>new v({map:n,color:a})),l.current.forEach(n=>{n&&(n.material=i.current)})},[]),y(()=>{l.current.forEach((t,a)=>{if(t)if(m)t.rotation.x+=.2,t.rotation.y+=.25;else{const n=E[s[a]-1];t.rotation.x=h.lerp(t.rotation.x,n.x,.15),t.rotation.y=h.lerp(t.rotation.y,n.y,.15),t.rotation.z=h.lerp(t.rotation.z,n.z,.15)}})}),e.jsx(e.Fragment,{children:s.map((t,a)=>e.jsxs("mesh",{ref:n=>l.current[a]=n,position:[a*2-(s.length-1),0,0],children:[e.jsx("boxGeometry",{args:[1,1,1]}),i.current.map((n,p)=>e.jsx("meshStandardMaterial",{attach:`material-${p}`,map:n.map,color:n.color},p))]},a))})}function $(){const s=w(c),[m,l]=r.useState(!0);r.useEffect(()=>{M();const i=document.getElementById("hero-spinner");i&&(i.style.display="none");const t=()=>{const a=document.visibilityState==="visible";l(a),i&&(i.style.display=a?"block":"none"),a||u(!1),console.log(`[Visible] ${a}`)};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[]);const d=()=>{u(!0);const i=document.getElementById("hero-spinner");i&&(i.style.display="block"),setTimeout(()=>{const t=Array.from({length:4},()=>Math.floor(Math.random()*6)+1);I(t),u(!1),i&&(i.style.display="none")},1500)};return e.jsxs("div",{className:"transition-opacity duration-700 ease-out w-full h-auto opacity-100",children:[e.jsxs("div",{className:"rounded-xl overflow-hidden shadow-xl w-full h-[250px] sm:h-[300px] md:h-[400px]",children:[m&&e.jsxs(f,{shadows:!0,camera:{position:[0,0,8],fov:65},style:{width:"100%",height:"100%"},children:[e.jsx("ambientLight",{intensity:2.5}),e.jsx("pointLight",{position:[10,10,10]}),e.jsx(P,{values:s.values,rolling:s.rolling}),e.jsx(g,{enableZoom:!1})]}),!m&&e.jsx("div",{children:"!"})]}),e.jsxs("div",{className:"mt-6 flex flex-row space-x-3 items-center z-40",children:[e.jsx("div",{className:"mt-4 text-zinc-200 text-lg text-center min-h-[3rem]",children:e.jsx("button",{onClick:d,className:"bg-cyan-600 hover:bg-cyan-700 text-white font-semibold px-6 py-3 rounded-lg shadow-lg focus:outline-none focus:ring-2 focus:ring-cyan-400 disabled:opacity-50","aria-label":"Roll the dice",disabled:s.rolling,children:"Roll the Dice ðŸŽ²"})}),e.jsx("div",{className:"mt-4 text-zinc-200 text-lg text-center min-h-[3rem]",children:s.rolling?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-cyan-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("span",{className:"text-white",children:"Rolling dice..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Total roll:"," ",e.jsx("span",{className:"font-bold text-white",children:s.values.reduce((i,t)=>i+t,0)})]}),e.jsxs("p",{children:["You rolled:"," ",e.jsx("span",{className:"font-bold text-white",children:s.values.join(", ")})]})]})})]})]})}export{$ as default};
