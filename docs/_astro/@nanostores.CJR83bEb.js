import{o as E,a as L,m as g}from"./nanostores.qAfxXu-z.js";import"./react.CvslfkeK.js";let c=e=>e,l={},r={addEventListener(){},removeEventListener(){}};function w(){try{return typeof localStorage<"u"}catch{return!1}}w()&&(l=localStorage);let h={addEventListener(e,f,i){window.addEventListener("storage",f),window.addEventListener("pageshow",i)},removeEventListener(e,f,i){window.removeEventListener("storage",f),window.removeEventListener("pageshow",i)}};typeof window<"u"&&(r=h);function k(e,f=void 0,i={}){let y=i.encode||c,u=i.decode||c,n=L(f),a=n.set;n.set=s=>{typeof s>"u"?delete l[e]:l[e]=y(s),a(s)};function v(s){s.key===e?s.newValue===null?a(void 0):a(u(s.newValue)):l[e]||a(void 0)}function d(){n.set(l[e]?u(l[e]):f)}return E(n,()=>{if(d(),i.listen!==!1)return r.addEventListener(e,v,d),()=>{r.removeEventListener(e,v,d)}}),n}function S(e,f={},i={}){let y=i.encode||c,u=i.decode||c,n=g(),a=n.setKey;n.setKey=(t,o)=>{typeof o>"u"?(i.listen!==!1&&r.perKey&&r.removeEventListener(e+t,d,s),delete l[e+t]):(i.listen!==!1&&r.perKey&&!(t in n.value)&&r.addEventListener(e+t,d,s),l[e+t]=y(o)),a(t,o)};let v=n.set;n.set=function(t){for(let o in t)n.setKey(o,t[o]);for(let o in n.value)o in t||n.setKey(o)};function d(t){t.key?t.key.startsWith(e)&&(t.newValue===null?a(t.key.slice(e.length),void 0):a(t.key.slice(e.length),u(t.newValue))):v({})}function s(){let t={...f};for(let o in l)o.startsWith(e)&&(t[o.slice(e.length)]=u(l[o]));n.set(t)}return E(n,()=>{if(s(),i.listen!==!1)return r.addEventListener(e,d,s),()=>{r.removeEventListener(e,d,s);for(let t in n.value)r.removeEventListener(e+t,d,s)}}),n}export{S as a,k as p};
