import{S as pe,i as fe,s as me,e as g,a as P,t as R,h as ye,c as k,d,b as V,f as L,g as G,j as Z,k as m,l as O,m as v,n as w,o as U,p as ee,q as le,r as ve,u as _e,v as ne,w as be,x as ge}from"./index.D49SYJia.js";import{g as ke}from"./globals.D0QH3NT1.js";import{e as ie}from"./each.-gASlQSi.js";import{t as W,m as re,e as we}from"./khashvault.CrgWuqfC.js";import"./index.CgBe15gE.js";import"./index.BH1EYZ08.js";const{document:ce}=ke;function ue(o,l,c){const s=o.slice();return s[22]=l[c],s}function de(o){let l,c=o[22]+"",s,h,y,T;function C(){return o[11](o[22])}return{c(){l=g("button"),s=R(c),h=P(),this.h()},l(u){l=k(u,"BUTTON",{class:!0});var p=L(l);s=G(p,c),h=V(p),p.forEach(d),this.h()},h(){m(l,"class","relative z-1 px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500"),O(l,"opacity-100",o[4][o[22]]),O(l,"opacity-50",!o[4][o[22]])},m(u,p){w(u,l,p),v(l,s),v(l,h),y||(T=U(l,"click",C),y=!0)},p(u,p){o=u,p&16&&c!==(c=o[22]+"")&&ee(s,c),p&16&&O(l,"opacity-100",o[4][o[22]]),p&16&&O(l,"opacity-50",!o[4][o[22]])},d(u){u&&d(l),y=!1,T()}}}function Te(o){let l,c,s,h,y,T,C,u,p,D,M,j,A="Sync",I,E,z="Skip",N,_,x=o[1]?"Disable Force Play":"Enable Force Play",B,J,S,q,b,e=`<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web
    browser that
    <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>`,i,n,K="Currently Playing Video ID:",Q,H,X,te,F=ie(Object.keys(o[4])),f=[];for(let t=0;t<F.length;t+=1)f[t]=de(ue(o,F,t));return{c(){l=g("link"),c=P(),s=g("div"),h=g("button"),y=R("Play Tracks"),C=P(),u=g("button"),p=R("Play Sets"),M=P(),j=g("button"),j.textContent=A,I=P(),E=g("button"),E.textContent=z,N=P(),_=g("button"),B=R(x),J=P(),S=g("div");for(let t=0;t<f.length;t+=1)f[t].c();q=P(),b=g("video"),b.innerHTML=e,i=P(),n=g("strong"),n.textContent=K,Q=P(),H=R(o[0]),this.h()},l(t){const r=ye("svelte-1jkjurj",ce.head);l=k(r,"LINK",{href:!0,rel:!0}),r.forEach(d),c=V(t),s=k(t,"DIV",{class:!0});var a=L(s);h=k(a,"BUTTON",{class:!0});var Y=L(h);y=G(Y,"Play Tracks"),Y.forEach(d),C=V(a),u=k(a,"BUTTON",{class:!0});var oe=L(u);p=G(oe,"Play Sets"),oe.forEach(d),M=V(a),j=k(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(j)!=="svelte-ecpas0"&&(j.textContent=A),I=V(a),E=k(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(E)!=="svelte-1cd9dc6"&&(E.textContent=z),N=V(a),_=k(a,"BUTTON",{class:!0});var se=L(_);B=G(se,x),se.forEach(d),a.forEach(d),J=V(t),S=k(t,"DIV",{class:!0});var ae=L(S);for(let $=0;$<f.length;$+=1)f[$].l(ae);ae.forEach(d),q=V(t),b=k(t,"VIDEO",{id:!0,class:!0,preload:!0,width:!0,height:!0,"data-svelte-h":!0}),Z(b)!=="svelte-12y7kzy"&&(b.innerHTML=e),i=V(t),n=k(t,"STRONG",{"data-svelte-h":!0}),Z(n)!=="svelte-1xwgl6o"&&(n.textContent=K),Q=V(t),H=G(t,o[0]),this.h()},h(){m(l,"href","https://unpkg.com/video.js/dist/video-js.min.css"),m(l,"rel","stylesheet"),m(h,"class",T="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[2]?"opacity-100":"opacity-50")),m(u,"class",D="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[3]?"opacity-100":"opacity-50")),m(j,"class","px-4 py-2 bg-blue-500 border text-white rounded hover:scale-110 ease-in-out duration-500"),m(E,"class","px-4 py-2 bg-red-500 text-white rounded hover:scale-110 ease-in-out duration-500"),m(_,"class","px-4 py-2 bg-cyan-600 border text-white rounded hover:scale-110 ease-in-out duration-500"),O(_,"opacity-100",o[1]),O(_,"opacity-50",!o[1]),m(s,"class","space-x-2 my-4"),m(S,"class","space-x-2"),m(b,"id","video-js"),m(b,"class","video-js vjs-default-skin w-full aspect-video"),b.controls=!0,m(b,"preload","auto"),m(b,"width","640"),m(b,"height","264")},m(t,r){v(ce.head,l),w(t,c,r),w(t,s,r),v(s,h),v(h,y),v(s,C),v(s,u),v(u,p),v(s,M),v(s,j),v(s,I),v(s,E),v(s,N),v(s,_),v(_,B),w(t,J,r),w(t,S,r);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(S,null);w(t,q,r),w(t,b,r),w(t,i,r),w(t,n,r),w(t,Q,r),w(t,H,r),X||(te=[U(h,"click",o[8]),U(u,"click",o[9]),U(j,"click",o[7]),U(E,"click",o[5]),U(_,"click",o[10])],X=!0)},p(t,[r]){if(r&4&&T!==(T="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[2]?"opacity-100":"opacity-50"))&&m(h,"class",T),r&8&&D!==(D="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[3]?"opacity-100":"opacity-50"))&&m(u,"class",D),r&2&&x!==(x=t[1]?"Disable Force Play":"Enable Force Play")&&ee(B,x),r&2&&O(_,"opacity-100",t[1]),r&2&&O(_,"opacity-50",!t[1]),r&80){F=ie(Object.keys(t[4]));let a;for(a=0;a<F.length;a+=1){const Y=ue(t,F,a);f[a]?f[a].p(Y,r):(f[a]=de(Y),f[a].c(),f[a].m(S,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=F.length}r&1&&ee(H,t[0])},i:le,o:le,d(t){t&&(d(c),d(s),d(J),d(S),d(q),d(b),d(i),d(n),d(Q),d(H)),d(l),ve(f,t),X=!1,_e(te)}}}function je(o){return new URLSearchParams(window.location.search).get(o)}function he(o){return/^[a-zA-Z0-9_-]{11}$/.test(o)}function Ee(o,l,c){let s,h;ne(o,W,e=>c(4,s=e)),ne(o,re,e=>c(15,h=e));let y,T=!1,C=!1,u="",p=!1,D=!0,M=!1;be(()=>{C=!0,console.log("Mounted"),j().then(()=>{C&&T&&E()})}),ge(()=>{C=!1,y&&y.dispose()});async function j(){try{await new Promise((e,i)=>{const n=document.createElement("script");n.src="https://unpkg.com/video.js/dist/video.min.js",n.onload=e,n.onerror=()=>i(new Error("Failed to load Video.js")),document.head.appendChild(n)}),await new Promise((e,i)=>{const n=document.createElement("script");n.src="https://unpkg.com/videojs-youtube/dist/Youtube.min.js",n.onload=e,n.onerror=()=>i(new Error("Failed to load YouTube plugin")),document.head.appendChild(n)}),T=!0}catch(e){console.error("Error loading scripts:",e)}}async function A(){we.then(()=>{console.log("Music data has been successfully updated.")}).catch(e=>{console.error("Error updating music data:",e)})}function I(){const e={};h.items.forEach(i=>{i.tags.forEach(n=>{n!=="music"&&(e[n]=!0)})}),W.set(e)}async function E(){if(h.items.length===0)try{await A(),console.log("Music Data Loaded:",h.items)}catch(e){console.error("Failed to fetch music data:",e);return}Object.keys(s).length===0?(console.log("Initializing tags from music data..."),I()):console.log("Tags already initialized:",s),z()}function z(){if(typeof videojs<"u"&&videojs.getTech("youtube")){const e=je("yt"),i=N();if(i.length===0&&(!e||!he(e)))return;const n=e&&he(e)?e:i[Math.floor(Math.random()*i.length)];y=videojs("video-js",{techOrder:["youtube"],sources:[{type:"video/youtube",src:`https://www.youtube.com/watch?v=${n}`}],youtube:{iv_load_policy:3},controls:!0,autoplay:!0,preload:"auto"}),y.on("pause",()=>{}),y.on("ended",_),c(0,u=n)}else setTimeout(z,100)}function N(){let e=[];return h.items.forEach(i=>{i.tags.some(K=>s[K]===!0)&&(D&&(e=e.concat(i.ytTracks)),M&&(e=e.concat(i.ytSets)))}),e}function _(){const e=N();if(e.length===0)return;const i=e[Math.floor(Math.random()*e.length)];y.src({type:"video/youtube",src:`https://www.youtube.com/watch?v=${i}`}),y.play(),c(0,u=i)}function x(e){const i={...s,[e]:!s[e]};W.set(i)}async function B(){re.set({items:[]}),W.set({});try{await A(),I(),z(),console.log("Data and tags have been synchronized."),window.location.reload()}catch(e){console.error("Error during synchronization:",e)}}return[u,p,D,M,s,_,x,B,()=>c(2,D=!D),()=>c(3,M=!M),()=>c(1,p=!p),e=>x(e)]}class xe extends pe{constructor(l){super(),fe(this,l,Ee,Te,me,{})}}export{xe as default};
