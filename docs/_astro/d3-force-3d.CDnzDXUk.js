import{t as L}from"./d3-timer.DdKHrDhs.js";import{d as O}from"./d3-dispatch.kxCwF96_.js";import{b as X}from"./d3-binarytree.e94m1gdS.js";import{q as Y}from"./d3-quadtree.CSANTnla.js";import{o as G}from"./d3-octree.CZ7m1I_d.js";function tn(t,c,e){var h,m=1;t==null&&(t=0),c==null&&(c=0),e==null&&(e=0);function z(){var s,p=h.length,g,y=0,M=0,u=0;for(s=0;s<p;++s)g=h[s],y+=g.x||0,M+=g.y||0,u+=g.z||0;for(y=(y/p-t)*m,M=(M/p-c)*m,u=(u/p-e)*m,s=0;s<p;++s)g=h[s],y&&(g.x-=y),M&&(g.y-=M),u&&(g.z-=u)}return z.initialize=function(s){h=s},z.x=function(s){return arguments.length?(t=+s,z):t},z.y=function(s){return arguments.length?(c=+s,z):c},z.z=function(s){return arguments.length?(e=+s,z):e},z.strength=function(s){return arguments.length?(m=+s,z):m},z}function R(t){return function(){return t}}function j(t){return(t()-.5)*1e-6}function H(t){return t.index}function C(t,c){var e=t.get(c);if(!e)throw new Error("node not found: "+c);return e}function rn(t){var c=H,e=D,h,m=R(30),z,s,p,g,y,M,u=1;t==null&&(t=[]);function D(n){return 1/Math.min(g[n.source.index],g[n.target.index])}function d(n){for(var v=0,f=t.length;v<u;++v)for(var r=0,a,o,q,x=0,I=0,S=0,E,A;r<f;++r)a=t[r],o=a.source,q=a.target,x=q.x+q.vx-o.x-o.vx||j(M),p>1&&(I=q.y+q.vy-o.y-o.vy||j(M)),p>2&&(S=q.z+q.vz-o.z-o.vz||j(M)),E=Math.sqrt(x*x+I*I+S*S),E=(E-z[r])/E*n*h[r],x*=E,I*=E,S*=E,q.vx-=x*(A=y[r]),p>1&&(q.vy-=I*A),p>2&&(q.vz-=S*A),o.vx+=x*(A=1-A),p>1&&(o.vy+=I*A),p>2&&(o.vz+=S*A)}function i(){if(s){var n,v=s.length,f=t.length,r=new Map(s.map((o,q)=>[c(o,q,s),o])),a;for(n=0,g=new Array(v);n<f;++n)a=t[n],a.index=n,typeof a.source!="object"&&(a.source=C(r,a.source)),typeof a.target!="object"&&(a.target=C(r,a.target)),g[a.source.index]=(g[a.source.index]||0)+1,g[a.target.index]=(g[a.target.index]||0)+1;for(n=0,y=new Array(f);n<f;++n)a=t[n],y[n]=g[a.source.index]/(g[a.source.index]+g[a.target.index]);h=new Array(f),w(),z=new Array(f),l()}}function w(){if(s)for(var n=0,v=t.length;n<v;++n)h[n]=+e(t[n],n,t)}function l(){if(s)for(var n=0,v=t.length;n<v;++n)z[n]=+m(t[n],n,t)}return d.initialize=function(n,...v){s=n,M=v.find(f=>typeof f=="function")||Math.random,p=v.find(f=>[1,2,3].includes(f))||2,i()},d.links=function(n){return arguments.length?(t=n,i(),d):t},d.id=function(n){return arguments.length?(c=n,d):c},d.iterations=function(n){return arguments.length?(u=+n,d):u},d.strength=function(n){return arguments.length?(e=typeof n=="function"?n:R(+n),w(),d):e},d.distance=function(n){return arguments.length?(m=typeof n=="function"?n:R(+n),l(),d):m},d}const J=1664525,K=1013904223,P=4294967296;function Q(){let t=1;return()=>(t=(J*t+K)%P)/P}var T=3;function b(t){return t.x}function F(t){return t.y}function U(t){return t.z}var V=10,W=Math.PI*(3-Math.sqrt(5)),Z=Math.PI*20/(9+Math.sqrt(221));function fn(t,c){c=c||2;var e=Math.min(T,Math.max(1,Math.round(c))),h,m=1,z=.001,s=1-Math.pow(z,1/300),p=0,g=.6,y=new Map,M=L(d),u=O("tick","end"),D=Q();t==null&&(t=[]);function d(){i(),u.call("tick",h),m<z&&(M.stop(),u.call("end",h))}function i(n){var v,f=t.length,r;n===void 0&&(n=1);for(var a=0;a<n;++a)for(m+=(p-m)*s,y.forEach(function(o){o(m)}),v=0;v<f;++v)r=t[v],r.fx==null?r.x+=r.vx*=g:(r.x=r.fx,r.vx=0),e>1&&(r.fy==null?r.y+=r.vy*=g:(r.y=r.fy,r.vy=0)),e>2&&(r.fz==null?r.z+=r.vz*=g:(r.z=r.fz,r.vz=0));return h}function w(){for(var n=0,v=t.length,f;n<v;++n){if(f=t[n],f.index=n,f.fx!=null&&(f.x=f.fx),f.fy!=null&&(f.y=f.fy),f.fz!=null&&(f.z=f.fz),isNaN(f.x)||e>1&&isNaN(f.y)||e>2&&isNaN(f.z)){var r=V*(e>2?Math.cbrt(.5+n):e>1?Math.sqrt(.5+n):n),a=n*W,o=n*Z;e===1?f.x=r:e===2?(f.x=r*Math.cos(a),f.y=r*Math.sin(a)):(f.x=r*Math.sin(a)*Math.cos(o),f.y=r*Math.cos(a),f.z=r*Math.sin(a)*Math.sin(o))}(isNaN(f.vx)||e>1&&isNaN(f.vy)||e>2&&isNaN(f.vz))&&(f.vx=0,e>1&&(f.vy=0),e>2&&(f.vz=0))}}function l(n){return n.initialize&&n.initialize(t,D,e),n}return w(),h={tick:i,restart:function(){return M.restart(d),h},stop:function(){return M.stop(),h},numDimensions:function(n){return arguments.length?(e=Math.min(T,Math.max(1,Math.round(n))),y.forEach(l),h):e},nodes:function(n){return arguments.length?(t=n,w(),y.forEach(l),h):t},alpha:function(n){return arguments.length?(m=+n,h):m},alphaMin:function(n){return arguments.length?(z=+n,h):z},alphaDecay:function(n){return arguments.length?(s=+n,h):+s},alphaTarget:function(n){return arguments.length?(p=+n,h):p},velocityDecay:function(n){return arguments.length?(g=1-n,h):1-g},randomSource:function(n){return arguments.length?(D=n,y.forEach(l),h):D},force:function(n,v){return arguments.length>1?(v==null?y.delete(n):y.set(n,l(v)),h):y.get(n)},find:function(){var n=Array.prototype.slice.call(arguments),v=n.shift()||0,f=(e>1?n.shift():null)||0,r=(e>2?n.shift():null)||0,a=n.shift()||1/0,o=0,q=t.length,x,I,S,E,A,B;for(a*=a,o=0;o<q;++o)A=t[o],x=v-A.x,I=f-(A.y||0),S=r-(A.z||0),E=x*x+I*I+S*S,E<a&&(B=A,a=E);return B},on:function(n,v){return arguments.length>1?(u.on(n,v),h):u.on(n)}}}function an(){var t,c,e,h,m,z=R(-30),s,p=1,g=1/0,y=.81;function M(i){var w,l=t.length,n=(c===1?X(t,b):c===2?Y(t,b,F):c===3?G(t,b,F,U):null).visitAfter(D);for(m=i,w=0;w<l;++w)e=t[w],n.visit(d)}function u(){if(t){var i,w=t.length,l;for(s=new Array(w),i=0;i<w;++i)l=t[i],s[l.index]=+z(l,i,t)}}function D(i){var w=0,l,n,v=0,f,r,a,o,q=i.length;if(q){for(f=r=a=o=0;o<q;++o)(l=i[o])&&(n=Math.abs(l.value))&&(w+=l.value,v+=n,f+=n*(l.x||0),r+=n*(l.y||0),a+=n*(l.z||0));w*=Math.sqrt(4/q),i.x=f/v,c>1&&(i.y=r/v),c>2&&(i.z=a/v)}else{l=i,l.x=l.data.x,c>1&&(l.y=l.data.y),c>2&&(l.z=l.data.z);do w+=s[l.data.index];while(l=l.next)}i.value=w}function d(i,w,l,n,v){if(!i.value)return!0;var f=[l,n,v][c-1],r=i.x-e.x,a=c>1?i.y-e.y:0,o=c>2?i.z-e.z:0,q=f-w,x=r*r+a*a+o*o;if(q*q/y<x)return x<g&&(r===0&&(r=j(h),x+=r*r),c>1&&a===0&&(a=j(h),x+=a*a),c>2&&o===0&&(o=j(h),x+=o*o),x<p&&(x=Math.sqrt(p*x)),e.vx+=r*i.value*m/x,c>1&&(e.vy+=a*i.value*m/x),c>2&&(e.vz+=o*i.value*m/x)),!0;if(i.length||x>=g)return;(i.data!==e||i.next)&&(r===0&&(r=j(h),x+=r*r),c>1&&a===0&&(a=j(h),x+=a*a),c>2&&o===0&&(o=j(h),x+=o*o),x<p&&(x=Math.sqrt(p*x)));do i.data!==e&&(q=s[i.data.index]*m/x,e.vx+=r*q,c>1&&(e.vy+=a*q),c>2&&(e.vz+=o*q));while(i=i.next)}return M.initialize=function(i,...w){t=i,h=w.find(l=>typeof l=="function")||Math.random,c=w.find(l=>[1,2,3].includes(l))||2,u()},M.strength=function(i){return arguments.length?(z=typeof i=="function"?i:R(+i),u(),M):z},M.distanceMin=function(i){return arguments.length?(p=i*i,M):Math.sqrt(p)},M.distanceMax=function(i){return arguments.length?(g=i*i,M):Math.sqrt(g)},M.theta=function(i){return arguments.length?(y=i*i,M):Math.sqrt(y)},M}function en(t,c,e,h){var m,z,s=R(.1),p,g;typeof t!="function"&&(t=R(+t)),c==null&&(c=0),e==null&&(e=0),h==null&&(h=0);function y(u){for(var D=0,d=m.length;D<d;++D){var i=m[D],w=i.x-c||1e-6,l=(i.y||0)-e||1e-6,n=(i.z||0)-h||1e-6,v=Math.sqrt(w*w+l*l+n*n),f=(g[D]-v)*p[D]*u/v;i.vx+=w*f,z>1&&(i.vy+=l*f),z>2&&(i.vz+=n*f)}}function M(){if(m){var u,D=m.length;for(p=new Array(D),g=new Array(D),u=0;u<D;++u)g[u]=+t(m[u],u,m),p[u]=isNaN(g[u])?0:+s(m[u],u,m)}}return y.initialize=function(u,...D){m=u,z=D.find(d=>[1,2,3].includes(d))||2,M()},y.strength=function(u){return arguments.length?(s=typeof u=="function"?u:R(+u),M(),y):s},y.radius=function(u){return arguments.length?(t=typeof u=="function"?u:R(+u),M(),y):t},y.x=function(u){return arguments.length?(c=+u,y):c},y.y=function(u){return arguments.length?(e=+u,y):e},y.z=function(u){return arguments.length?(h=+u,y):h},y}export{rn as a,an as b,tn as c,en as d,fn as f};
