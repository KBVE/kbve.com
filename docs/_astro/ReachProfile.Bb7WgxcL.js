import{r,j as e}from"./react.XJQ4OnvF.js";import{e as o,$ as j,k as i}from"./npchandler.B0r6PUz8.js";import{u as v}from"./@nanostores.kqnvP3SD.js";import{t as N}from"./tailwind-merge.B9ugUrge.js";import"./@react-three.DzcfnNYH.js";import"./@supabase.WhYem7Cd.js";import"./Tabs.astro_astro_type_script_index_0_lang.DXuUnoum.js";import"./react-dom.3umP1jIU.js";import"./scheduler.CzFDRTuY.js";import"./dexie.FI_cDWIf.js";import"./nanostores.Bo9-_MAV.js";import"./axios.dxcvQi4N.js";const I=()=>{const a=v(j),[x,s]=r.useState(!0),[d,n]=r.useState(null),[f,c]=r.useState(!1),p=[{label:"Full Name:",value:a.fullName||"N/A"},{label:"Username:",value:a.username||"N/A"},{label:"Email:",value:a.email||"N/A"},{label:"User ID:",value:a.id||"N/A"},{label:"Last Updated:",value:a.updatedAt?a.updatedAt.toLocaleString():"N/A"}];r.useEffect(()=>{(async()=>{try{s(!0),await i.loadProfileFromSupabase()}catch(l){console.error("Failed to load profile:",l),n("Failed to load profile. Please try again later.")}finally{s(!1)}})()},[]),r.useEffect(()=>{const t=()=>{c(!0)};return o.on("openModal",t),()=>{o.off("openModal",t)}},[]);const b=()=>{o.emit("openModal",{message:"Edit Profile"})},u=()=>{c(!1)},m=t=>{t.target},h=()=>(n(null),!0),g=async t=>{t.preventDefault(),s(!0),h();try{if(!i.getSupabaseClient()){n("Failed to get a valid Supabase client instance.");return}await i.loadProfileFromSupabase()}catch(l){console.error("Failed to update profile:",l),n("Failed to update profile. Please try again later.")}finally{s(!1),u()}};return x?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("p",{className:"text-lg text-neutral-600 dark:text-neutral-200",children:"Loading profile..."})}):d?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("p",{className:"text-lg text-red-500 dark:text-red-400",children:d})}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-yellow-50/60 dark:bg-neutral-800 p-5",children:[e.jsxs("div",{className:N("bg-yellow-50 dark:bg-neutral-900 rounded-lg shadow-lg p-8 max-w-md w-full"),children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"w-24 h-24 bg-gray-200 dark:bg-neutral-700 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-neutral-600 dark:text-neutral-200",children:a.username?.substring(0,2).toUpperCase()||"U"})})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-neutral-700 dark:text-neutral-100 mb-2",children:a.username||"Unknown User"}),e.jsx("p",{className:"text-neutral-600 dark:text-neutral-300 mb-4",children:a.email||"No email available"})]}),e.jsx("div",{className:"text-center",children:p.map((t,l)=>e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"font-bold text-neutral-600 dark:text-neutral-200",children:t.label})," ",e.jsx("span",{className:"text-neutral-800 dark:text-neutral-300",children:t.value})]},l))}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{className:"px-4 py-2 bg-cyan-500 text-white rounded hover:bg-cyan-600 focus:outline-none",onClick:b,children:"Edit Profile"})})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-lg p-6 max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-gray-500 dark:text-neutral-300 hover:text-gray-800 dark:hover:text-neutral-100",onClick:u,children:"Ã—"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-neutral-800 dark:text-neutral-200",children:"Edit Profile"}),e.jsx("p",{className:"mt-2 text-sm text-neutral-600 dark:text-neutral-400",children:"Update your profile details below."})]}),e.jsx("div",{className:"mt-5",children:e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-neutral-600 dark:text-neutral-300",children:"Bio"}),e.jsx("textarea",{id:"bio",name:"bio",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-neutral-700 shadow-sm focus:border-cyan-500 focus:ring-cyan-500 sm:text-sm dark:bg-neutral-900 dark:text-neutral-400",placeholder:"Tell us about yourself...",onChange:m})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"avatar_url",className:"block text-sm font-medium text-neutral-600 dark:text-neutral-300",children:"Avatar URL"}),e.jsx("input",{id:"avatar_url",name:"avatar_url",type:"text",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-neutral-700 shadow-sm focus:border-cyan-500 focus:ring-cyan-500 sm:text-sm dark:bg-neutral-900 dark:text-neutral-400",placeholder:"Enter a valid avatar URL",onChange:m})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"submit",className:"w-full py-2 px-4 bg-cyan-500 text-white rounded hover:bg-cyan-600 focus:outline-none",children:"Save Changes"})})]})})]})})]})};export{I as default};
