import{p,a as y}from"./index.B59itue1.js";import{t as h}from"./index.BH1EYZ08.js";const l="/api/v1/",u=y(""),m=p("kbve:"),x=async r=>{h(async()=>{u.set(r),console.log(`[LOG] ${u.get()}`)})},O=async(r,e)=>{h(async()=>{x(`Storing ${e} into locker for ${r}`),m.setKey(r,e)})},j="5ba581fa-b6fc-4bb0-8222-02fcd6a59e35",J="https://js.hcaptcha.com/1/api.js",w="auth/register",b="auth/login",S="graceful/profile";async function R(r){return new Promise(e=>setTimeout(e,r))}class a{constructor(e,s,t){this.status=e,this.error=e<200||e>=300,this.message=s,this.data=t}display(){console.log(`Status: ${this.status}, Message: ${this.message}, Error: ${this.error}, Data: ${JSON.stringify(this.data)}`)}scope(){try{return JSON.stringify(this.data)}catch(e){return console.error("Parsing error:",e),"Error: Unable to parse data"}}extractField(e){if(this.data&&typeof this.data=="object"&&e in this.data)return this.data[e];try{if(typeof this.message=="string"){const s=JSON.parse(this.message);if(s&&typeof s=="object"&&e in s)return s[e]}}catch(s){console.error("Parsing error when checking message:",s)}return null}extractError(){if(typeof this.message=="string")try{const e=JSON.parse(this.message);if(e&&typeof e=="object"&&"error"in e)return e.error}catch(e){console.error("Parsing error:",e)}return"Error: Unable to parse error message"}token(){if(typeof this.message=="string")try{const e=JSON.parse(this.message);if(e&&typeof e=="object"&&"token"in e)return e.token}catch(e){console.error("Parsing error:",e)}return"Error: Unable to parse token"}async serialize(){try{return JSON.stringify({status:this.status,error:this.error,message:this.message,data:this.data})}catch(e){return console.error("Serialization error:",e),JSON.stringify({status:500,error:!0,message:"Internal Server Error: Unable to serialize response",data:{}})}}static async deserialize(e){try{const s=JSON.parse(e);return new a(s.status,s.message,s.data)}catch(s){return console.error("Deserialization error:",s),new a(500,"Internal Server Error: Unable to deserialize response",{})}}}const E=new RegExp(/^[a-z0-9]+$/i),d=8,$=async r=>r.length<d?new a(400,"Validation Error",{error:"Username is too short. Minimum length is "+d}):E.test(r)?new a(200,"Validation Successful",{message:"Username is valid."}):new a(400,"Validation Error",{error:"Username contains invalid characters."});async function N(r){try{const e=await $(r);return e.status===200?{isValid:!0,error:null}:{isValid:!1,error:e.data.error}}catch{return{isValid:!1,error:"An unexpected error occurred"}}}const k=new RegExp(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/),z=async r=>k.test(r)?new a(200,"Validation Successful",{message:"Email is valid."}):new a(400,"Validation Error",{error:"Email is invalid."});async function A(r){try{const e=await z(r);return e.status===200?{isValid:!0,error:null}:{isValid:!1,error:e.data.error}}catch{return{isValid:!1,error:"An unexpected error occurred"}}}const v=async r=>{if(r.length<8)return new a(400,"Validation Error",{error:"Password is too short"});if(r.length>255)return new a(400,"Validation Error",{error:"Password is too long"});const e=/[A-Z]/.test(r),s=/[a-z]/.test(r),t=/\d/.test(r),n=/[^A-Za-z0-9]/.test(r);return!e||!s||!t||!n?new a(400,"Validation Error",{error:"Password must include uppercase, lowercase, digits, and special characters"}):new a(200,"Validation Successful",{message:"Password is valid"})};async function q(r){try{const e=await v(r);return e.status===200?{isValid:!0,error:null}:{isValid:!1,error:e.data.error}}catch{return{isValid:!1,error:"An unexpected error occurred"}}}async function f(r,e,s){try{const t=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...s},body:JSON.stringify(e),credentials:"include"}),n=await t.json(),o=!t.ok;let i=t.ok?"Success":"Error";typeof n.message=="object"&&n.message!==null&&(i=JSON.stringify(n.message));const c=o&&n.error?{error:n.error}:n;return new a(t.status,i,c)}catch(t){return console.error("Request failed:",t),new a(500,"Internal Server Error: Request failed",{})}}async function V(r,e,s){try{const t=new URLSearchParams(e).toString(),n=`${r}?${t}`,o=await fetch(n,{method:"GET",headers:{...s},credentials:"include"}),i=await o.json(),c=i.message||(o.ok?"Success":"Error"),g=i.data||i;return new a(o.status,c,g)}catch(t){return console.error("Request failed:",t),new a(500,"Internal Server Error: Request failed",{})}}async function D(r,e,s,t,n){const o=`${r}${l}${w}`;return f(o,{username:e,email:s,password:t,token:n},{"x-kbve-shieldwall":"auth-register"})}async function T(r,e,s){const t=`${r}${l}${b}`;return f(t,{email:e,password:s},{"x-kbve-shieldwall":"auth-login"})}async function L(r,e){const s=`${r}${l}${S}`,t={Authorization:`Bearer ${e}`,"x-kbve-shieldwall":"auth-profile"};return V(s,{},t)}export{O as a,J as b,N as c,A as d,q as e,j as h,m as k,T as l,L as p,D as r,R as s};
