import{S as pe,i as me,s as ye,D as ne,b,a as x,t as K,h as ve,f as w,d,c as E,g as B,k as R,j as Z,l as m,F as C,o as v,p as k,r as L,v as te,w as re,E as ge,x as _e,C as ce,z as be,A as we,B as ke}from"./svelte.BvUY9TOw.js";import{a as X,p as Te}from"./@nanostores.BerOGW42.js";import{t as je}from"./nanostores.Bo9-_MAV.js";import"./react.B0RgU8Fg.js";import"./@react-three.Bml1aeim.js";X("atlas",{plugin:[]},{encode:JSON.stringify,decode:JSON.parse});const oe=X("musicData",{items:[]},{encode:JSON.stringify,decode:JSON.parse}),W=X("tagSettings",{},{encode:JSON.stringify,decode:JSON.parse}),Se=je(async()=>{const o=await fetch("/api/music.json");if(!o.ok)throw new Error("Failed to fetch music data");const a=await o.json();return oe.set(a),a}),xe=[{i:"a",x:0,y:0,w:4,h:16,moved:!1,static:!0},{i:"b",x:4,y:0,w:4,h:16,moved:!1,static:!0},{i:"c",x:8,y:0,w:4,h:16,moved:!1,static:!0},{i:"d",x:4,y:16,w:4,h:4,moved:!1,static:!1},{i:"e",x:4,y:8,w:4,h:4,moved:!1,static:!1},{i:"f",x:8,y:16,w:4,h:4,moved:!1,static:!1},{i:"g",x:4,y:12,w:4,h:4,moved:!1,static:!1},{i:"h",x:8,y:12,w:4,h:4,moved:!1,static:!1},{i:"i",x:0,y:16,w:4,h:4,moved:!1,static:!1},{i:"j",x:8,y:0,w:4,h:16,moved:!1,static:!1}];X("layoutKey",xe,{encode:JSON.stringify,decode:JSON.parse});Te("kbve:");const{document:ue}=ke;function de(o,a,c){const s=o.slice();return s[22]=a[c],s}function he(o){let a,c=o[22]+"",s,h,y,T;function O(){return o[11](o[22])}return{c(){a=b("button"),s=K(c),h=x(),this.h()},l(u){a=w(u,"BUTTON",{class:!0});var f=B(a);s=R(f,c),h=E(f),f.forEach(d),this.h()},h(){m(a,"class","relative z-1 px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500"),C(a,"opacity-100",o[4][o[22]]),C(a,"opacity-50",!o[4][o[22]])},m(u,f){k(u,a,f),v(a,s),v(a,h),y||(T=L(a,"click",O),y=!0)},p(u,f){o=u,f&16&&c!==(c=o[22]+"")&&te(s,c),f&16&&C(a,"opacity-100",o[4][o[22]]),f&16&&C(a,"opacity-50",!o[4][o[22]])},d(u){u&&d(a),y=!1,T()}}}function Ee(o){let a,c,s,h,y,T,O,u,f,P,D,j,U="Sync",M,S,J="Skip",z,g,V=o[1]?"Disable Force Play":"Enable Force Play",I,A,N,H,_,e=`<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web
    browser that
    <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>`,n,l,G="Currently Playing Video ID:",Q,Y,$,se,F=ne(Object.keys(o[4])),p=[];for(let t=0;t<F.length;t+=1)p[t]=he(de(o,F,t));return{c(){a=b("link"),c=x(),s=b("div"),h=b("button"),y=K("Play Tracks"),O=x(),u=b("button"),f=K("Play Sets"),D=x(),j=b("button"),j.textContent=U,M=x(),S=b("button"),S.textContent=J,z=x(),g=b("button"),I=K(V),A=x(),N=b("div");for(let t=0;t<p.length;t+=1)p[t].c();H=x(),_=b("video"),_.innerHTML=e,n=x(),l=b("strong"),l.textContent=G,Q=x(),Y=K(o[0]),this.h()},l(t){const r=ve("svelte-1jkjurj",ue.head);a=w(r,"LINK",{href:!0,rel:!0}),r.forEach(d),c=E(t),s=w(t,"DIV",{class:!0});var i=B(s);h=w(i,"BUTTON",{class:!0});var q=B(h);y=R(q,"Play Tracks"),q.forEach(d),O=E(i),u=w(i,"BUTTON",{class:!0});var ae=B(u);f=R(ae,"Play Sets"),ae.forEach(d),D=E(i),j=w(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(j)!=="svelte-ecpas0"&&(j.textContent=U),M=E(i),S=w(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(S)!=="svelte-1cd9dc6"&&(S.textContent=J),z=E(i),g=w(i,"BUTTON",{class:!0});var ie=B(g);I=R(ie,V),ie.forEach(d),i.forEach(d),A=E(t),N=w(t,"DIV",{class:!0});var le=B(N);for(let ee=0;ee<p.length;ee+=1)p[ee].l(le);le.forEach(d),H=E(t),_=w(t,"VIDEO",{id:!0,class:!0,preload:!0,width:!0,height:!0,"data-svelte-h":!0}),Z(_)!=="svelte-12y7kzy"&&(_.innerHTML=e),n=E(t),l=w(t,"STRONG",{"data-svelte-h":!0}),Z(l)!=="svelte-1xwgl6o"&&(l.textContent=G),Q=E(t),Y=R(t,o[0]),this.h()},h(){m(a,"href","https://unpkg.com/video.js/dist/video-js.min.css"),m(a,"rel","stylesheet"),m(h,"class",T="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[2]?"opacity-100":"opacity-50")),m(u,"class",P="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[3]?"opacity-100":"opacity-50")),m(j,"class","px-4 py-2 bg-blue-500 border text-white rounded hover:scale-110 ease-in-out duration-500"),m(S,"class","px-4 py-2 bg-red-500 text-white rounded hover:scale-110 ease-in-out duration-500"),m(g,"class","px-4 py-2 bg-cyan-600 border text-white rounded hover:scale-110 ease-in-out duration-500"),C(g,"opacity-100",o[1]),C(g,"opacity-50",!o[1]),m(s,"class","space-x-2 my-4"),m(N,"class","space-x-2"),m(_,"id","video-js"),m(_,"class","video-js vjs-default-skin w-full aspect-video"),_.controls=!0,m(_,"preload","auto"),m(_,"width","640"),m(_,"height","264")},m(t,r){v(ue.head,a),k(t,c,r),k(t,s,r),v(s,h),v(h,y),v(s,O),v(s,u),v(u,f),v(s,D),v(s,j),v(s,M),v(s,S),v(s,z),v(s,g),v(g,I),k(t,A,r),k(t,N,r);for(let i=0;i<p.length;i+=1)p[i]&&p[i].m(N,null);k(t,H,r),k(t,_,r),k(t,n,r),k(t,l,r),k(t,Q,r),k(t,Y,r),$||(se=[L(h,"click",o[8]),L(u,"click",o[9]),L(j,"click",o[7]),L(S,"click",o[5]),L(g,"click",o[10])],$=!0)},p(t,[r]){if(r&4&&T!==(T="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[2]?"opacity-100":"opacity-50"))&&m(h,"class",T),r&8&&P!==(P="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[3]?"opacity-100":"opacity-50"))&&m(u,"class",P),r&2&&V!==(V=t[1]?"Disable Force Play":"Enable Force Play")&&te(I,V),r&2&&C(g,"opacity-100",t[1]),r&2&&C(g,"opacity-50",!t[1]),r&80){F=ne(Object.keys(t[4]));let i;for(i=0;i<F.length;i+=1){const q=de(t,F,i);p[i]?p[i].p(q,r):(p[i]=he(q),p[i].c(),p[i].m(N,null))}for(;i<p.length;i+=1)p[i].d(1);p.length=F.length}r&1&&te(Y,t[0])},i:re,o:re,d(t){t&&(d(c),d(s),d(A),d(N),d(H),d(_),d(n),d(l),d(Q),d(Y)),d(a),ge(p,t),$=!1,_e(se)}}}function Oe(o){return new URLSearchParams(window.location.search).get(o)}function fe(o){return/^[a-zA-Z0-9_-]{11}$/.test(o)}function Pe(o,a,c){let s,h;ce(o,W,e=>c(4,s=e)),ce(o,oe,e=>c(15,h=e));let y,T=!1,O=!1,u="",f=!1,P=!0,D=!1;be(()=>{O=!0,console.log("Mounted"),j().then(()=>{O&&T&&S()})}),we(()=>{O=!1,y&&y.dispose()});async function j(){try{await new Promise((e,n)=>{const l=document.createElement("script");l.src="https://unpkg.com/video.js/dist/video.min.js",l.onload=e,l.onerror=()=>n(new Error("Failed to load Video.js")),document.head.appendChild(l)}),await new Promise((e,n)=>{const l=document.createElement("script");l.src="https://unpkg.com/videojs-youtube/dist/Youtube.min.js",l.onload=e,l.onerror=()=>n(new Error("Failed to load YouTube plugin")),document.head.appendChild(l)}),T=!0}catch(e){console.error("Error loading scripts:",e)}}async function U(){Se.then(()=>{console.log("Music data has been successfully updated.")}).catch(e=>{console.error("Error updating music data:",e)})}function M(){const e={};h.items.forEach(n=>{n.tags.forEach(l=>{l!=="music"&&(e[l]=!0)})}),W.set(e)}async function S(){if(h.items.length===0)try{await U(),console.log("Music Data Loaded:",h.items)}catch(e){console.error("Failed to fetch music data:",e);return}Object.keys(s).length===0?(console.log("Initializing tags from music data..."),M()):console.log("Tags already initialized:",s),J()}function J(){if(typeof videojs<"u"&&videojs.getTech("youtube")){const e=Oe("yt"),n=z();if(n.length===0&&(!e||!fe(e)))return;const l=e&&fe(e)?e:n[Math.floor(Math.random()*n.length)];y=videojs("video-js",{techOrder:["youtube"],sources:[{type:"video/youtube",src:`https://www.youtube.com/watch?v=${l}`}],youtube:{iv_load_policy:3},controls:!0,autoplay:!0,preload:"auto"}),y.on("pause",()=>{}),y.on("ended",g),c(0,u=l)}else setTimeout(J,100)}function z(){let e=[];return h.items.forEach(n=>{n.tags.some(G=>s[G]===!0)&&(P&&(e=e.concat(n.ytTracks)),D&&(e=e.concat(n.ytSets)))}),e}function g(){const e=z();if(e.length===0)return;const n=e[Math.floor(Math.random()*e.length)];y.src({type:"video/youtube",src:`https://www.youtube.com/watch?v=${n}`}),y.play(),c(0,u=n)}function V(e){const n={...s,[e]:!s[e]};W.set(n)}async function I(){oe.set({items:[]}),W.set({});try{await U(),M(),J(),console.log("Data and tags have been synchronized."),window.location.reload()}catch(e){console.error("Error during synchronization:",e)}}return[u,f,P,D,s,g,V,I,()=>c(2,P=!P),()=>c(3,D=!D),()=>c(1,f=!f),e=>V(e)]}class Je extends pe{constructor(a){super(),me(this,a,Pe,Ee,ye,{})}}export{Je as default};
