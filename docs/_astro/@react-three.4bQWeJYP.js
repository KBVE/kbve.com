import{r as R,j as U}from"./react.BO4Kayu4.js";import{W as rt,R as ot,O as it,P as st,S as at,a as pe,V as ct,b as lt,B as ut,C as ft,L as dt,c as Be,N as pt,A as vt,d as ke,e as bt,f as mt,U as ht,g as ie,h as gt,i as yt,T as jt}from"./three.xRXBQ6Zu.js";import{j as wt}from"./react-use-measure.yU5S79rD.js";import{c as Ct,x as Pt,i as Et,m as St}from"./its-fine.B0m_k8NB.js";import{c as se,R as Mt}from"./react-reconciler.D42_nvds.js";import"./react-dom.Cq2Wkcjl.js";import{_ as _t}from"./@babel.CF3RwP-h.js";import{O as Ot}from"./three-stdlib.DSm8ebGF.js";import{c as Tt}from"./zustand.yH8b0vWy.js";var Pn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function En(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Sn(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),n}var ve={exports:{}},be={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ie;function Rt(){return Ie||(Ie=1,function(e){function t(u,j){var y=u.length;u.push(j);e:for(;0<y;){var _=y-1>>>1,H=u[_];if(0<o(H,j))u[_]=j,u[y]=H,y=_;else break e}}function n(u){return u.length===0?null:u[0]}function r(u){if(u.length===0)return null;var j=u[0],y=u.pop();if(y!==j){u[0]=y;e:for(var _=0,H=u.length,S=H>>>1;_<S;){var x=2*(_+1)-1,z=u[x],L=x+1,X=u[L];if(0>o(z,y))L<H&&0>o(X,z)?(u[_]=X,u[L]=y,_=L):(u[_]=z,u[x]=y,_=x);else if(L<H&&0>o(X,y))u[_]=X,u[L]=y,_=L;else break e}}return j}function o(u,j){var y=u.sortIndex-j.sortIndex;return y!==0?y:u.id-j.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var b=Date,f=b.now();e.unstable_now=function(){return b.now()-f}}var i=[],p=[],l=1,c=null,v=3,g=!1,M=!1,k=!1,I=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,a=typeof setImmediate<"u"?setImmediate:null;function w(u){for(var j=n(p);j!==null;){if(j.callback===null)r(p);else if(j.startTime<=u)r(p),j.sortIndex=j.expirationTime,t(i,j);else break;j=n(p)}}function C(u){if(k=!1,w(u),!M)if(n(i)!==null)M=!0,F();else{var j=n(p);j!==null&&q(C,j.startTime-u)}}var h=!1,m=-1,A=5,D=-1;function P(){return!(e.unstable_now()-D<A)}function T(){if(h){var u=e.unstable_now();D=u;var j=!0;try{e:{M=!1,k&&(k=!1,d(m),m=-1),g=!0;var y=v;try{t:{for(w(u),c=n(i);c!==null&&!(c.expirationTime>u&&P());){var _=c.callback;if(typeof _=="function"){c.callback=null,v=c.priorityLevel;var H=_(c.expirationTime<=u);if(u=e.unstable_now(),typeof H=="function"){c.callback=H,w(u),j=!0;break t}c===n(i)&&r(i),w(u)}else r(i);c=n(i)}if(c!==null)j=!0;else{var S=n(p);S!==null&&q(C,S.startTime-u),j=!1}}break e}finally{c=null,v=y,g=!1}j=void 0}}finally{j?O():h=!1}}}var O;if(typeof a=="function")O=function(){a(T)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,E=V.port2;V.port1.onmessage=T,O=function(){E.postMessage(null)}}else O=function(){I(T,0)};function F(){h||(h=!0,O())}function q(u,j){m=I(function(){u(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(u){u.callback=null},e.unstable_continueExecution=function(){M||g||(M=!0,F())},e.unstable_forceFrameRate=function(u){0>u||125<u?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<u?Math.floor(1e3/u):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return n(i)},e.unstable_next=function(u){switch(v){case 1:case 2:case 3:var j=3;break;default:j=v}var y=v;v=j;try{return u()}finally{v=y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(u,j){switch(u){case 1:case 2:case 3:case 4:case 5:break;default:u=3}var y=v;v=u;try{return j()}finally{v=y}},e.unstable_scheduleCallback=function(u,j,y){var _=e.unstable_now();switch(typeof y=="object"&&y!==null?(y=y.delay,y=typeof y=="number"&&0<y?_+y:_):y=_,u){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=y+H,u={id:l++,callback:j,priorityLevel:u,startTime:y,expirationTime:H,sortIndex:-1},y>_?(u.sortIndex=y,t(p,u),n(i)===null&&u===n(p)&&(k?(d(m),m=-1):k=!0,q(C,y-_))):(u.sortIndex=H,t(i,u),M||g||(M=!0,F())),u},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(u){var j=v;return function(){var y=v;v=j;try{return u.apply(this,arguments)}finally{v=y}}}}(be)),be}var xe;function kt(){return xe||(xe=1,ve.exports=Rt()),ve.exports}var Ae=kt();function Ue(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const Ve=e=>e&&e.isOrthographicCamera,It=e=>e&&e.hasOwnProperty("current"),xt=e=>e!=null&&(typeof e=="string"||typeof e=="number"||e.isColor),ne=((e,t)=>typeof window<"u"&&(((e=window.document)==null?void 0:e.createElement)||((t=window.navigator)==null?void 0:t.product)==="ReactNative"))()?R.useLayoutEffect:R.useEffect;function Xe(e){const t=R.useRef(e);return ne(()=>void(t.current=e),[e]),t}function At(){const e=Ct(),t=Pt();return R.useMemo(()=>({children:n})=>{const o=!!Et(e,!0,s=>s.type===R.StrictMode)?R.StrictMode:R.Fragment;return U.jsx(o,{children:U.jsx(t,{children:n})})},[e,t])}function Dt({set:e}){return ne(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const Ft=(e=>(e=class extends R.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},e.getDerivedStateFromError=()=>({error:!0}),e))();function Ge(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function Q(e){var t;return(t=e.__r3f)==null?void 0:t.root.getState()}const N={obj:e=>e===Object(e)&&!N.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,nul:e=>e===null,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(N.str(e)||N.num(e)||N.boo(e))return e===t;const s=N.obj(e);if(s&&r==="reference")return e===t;const b=N.arr(e);if(b&&n==="reference")return e===t;if((b||s)&&e===t)return!0;let f;for(f in e)if(!(f in t))return!1;if(s&&n==="shallow"&&r==="shallow"){for(f in o?t:e)if(!N.equ(e[f],t[f],{strict:o,objects:"reference"}))return!1}else for(f in o?t:e)if(e[f]!==t[f])return!1;if(N.und(f)){if(b&&e.length===0&&t.length===0||s&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Lt(e){e.type!=="Scene"&&(e.dispose==null||e.dispose());for(const t in e){const n=e[t];n?.type!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const We=["children","key","ref"];function Ht(e){const t={};for(const n in e)We.includes(n)||(t[n]=e[n]);return t}function ce(e,t,n,r){const o=e;let s=o?.__r3f;return s||(s={root:t,type:n,parent:null,children:[],props:Ht(r),object:o,eventCount:0,handlers:{},isHidden:!1},o&&(o.__r3f=s)),s}function te(e,t){let n=e[t];if(!t.includes("-"))return{root:e,key:t,target:n};n=e;for(const o of t.split("-")){var r;t=o,e=n,n=(r=n)==null?void 0:r[t]}return{root:e,key:t,target:n}}const De=/-\d+$/;function le(e,t){if(N.str(t.props.attach)){if(De.test(t.props.attach)){const o=t.props.attach.replace(De,""),{root:s,key:b}=te(e.object,o);Array.isArray(s[b])||(s[b]=[])}const{root:n,key:r}=te(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else N.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function ue(e,t){if(N.str(t.props.attach)){const{root:n,key:r}=te(e.object,t.props.attach),o=t.previousAttach;o===void 0?delete n[r]:n[r]=o}else t.previousAttach==null||t.previousAttach(e.object,t.object);delete t.previousAttach}const Pe=[...We,"args","dispose","attach","object","onUpdate","dispose"],Fe=new Map;function Nt(e){let t=Fe.get(e.constructor);try{t||(t=new e.constructor,Fe.set(e.constructor,t))}catch{}return t}function qt(e,t){const n={};for(const r in t)if(!Pe.includes(r)&&!N.equ(t[r],e.props[r])){n[r]=t[r];for(const o in t)o.startsWith(`${r}-`)&&(n[o]=t[o])}for(const r in e.props){if(Pe.includes(r)||t.hasOwnProperty(r))continue;const{root:o,key:s}=te(e.object,r);if(o.constructor&&o.constructor.length===0){const b=Nt(o);N.und(b)||(n[s]=b[s])}else n[s]=0}return n}const zt=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Bt=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function W(e,t){var n;const r=e.__r3f,o=r&&Ue(r).getState(),s=r?.eventCount;for(const f in t){let i=t[f];if(Pe.includes(f))continue;if(r&&Bt.test(f)){typeof i=="function"?r.handlers[f]=i:delete r.handlers[f],r.eventCount=Object.keys(r.handlers).length;continue}if(i===void 0)continue;let{root:p,key:l,target:c}=te(e,f);if(c instanceof ke&&i instanceof ke)c.mask=i.mask;else if(c instanceof bt&&xt(i))c.set(i);else if(c!==null&&typeof c=="object"&&typeof c.set=="function"&&typeof c.copy=="function"&&i!=null&&i.constructor&&c.constructor===i.constructor)c.copy(i);else if(c!==null&&typeof c=="object"&&typeof c.set=="function"&&Array.isArray(i))typeof c.fromArray=="function"?c.fromArray(i):c.set(...i);else if(c!==null&&typeof c=="object"&&typeof c.set=="function"&&typeof i=="number")typeof c.setScalar=="function"?c.setScalar(i):c.set(i);else{var b;p[l]=i,o&&!o.linear&&zt.includes(l)&&(b=p[l])!=null&&b.isTexture&&p[l].format===mt&&p[l].type===ht&&(p[l].colorSpace=Be)}}if(r!=null&&r.parent&&o!=null&&o.internal&&(n=r.object)!=null&&n.isObject3D&&s!==r.eventCount){const f=r.object,i=o.internal.interaction.indexOf(f);i>-1&&o.internal.interaction.splice(i,1),r.eventCount&&f.raycast!==null&&o.internal.interaction.push(f)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&$(r),e}function $(e){var t;if(!e.parent)return;e.props.onUpdate==null||e.props.onUpdate(e.object);const n=(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Ut(e,t){e.manual||(Ve(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const B=e=>e?.isObject3D;function re(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Ye(e,t,n,r){const o=n.get(t);o&&(n.delete(t),n.size===0&&(e.delete(r),o.target.releasePointerCapture(r)))}function Vt(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(r=>r!==t),n.initialHits=n.initialHits.filter(r=>r!==t),n.hovered.forEach((r,o)=>{(r.eventObject===t||r.object===t)&&n.hovered.delete(o)}),n.capturedMap.forEach((r,o)=>{Ye(n.capturedMap,t,r,o)})}function Xt(e){function t(i){const{internal:p}=e.getState(),l=i.offsetX-p.initialClick[0],c=i.offsetY-p.initialClick[1];return Math.round(Math.sqrt(l*l+c*c))}function n(i){return i.filter(p=>["Move","Over","Enter","Out","Leave"].some(l=>{var c;return(c=p.__r3f)==null?void 0:c.handlers["onPointer"+l]}))}function r(i,p){const l=e.getState(),c=new Set,v=[],g=p?p(l.internal.interaction):l.internal.interaction;for(let d=0;d<g.length;d++){const a=Q(g[d]);a&&(a.raycaster.camera=void 0)}l.previousRoot||l.events.compute==null||l.events.compute(i,l);function M(d){const a=Q(d);if(!a||!a.events.enabled||a.raycaster.camera===null)return[];if(a.raycaster.camera===void 0){var w;a.events.compute==null||a.events.compute(i,a,(w=a.previousRoot)==null?void 0:w.getState()),a.raycaster.camera===void 0&&(a.raycaster.camera=null)}return a.raycaster.camera?a.raycaster.intersectObject(d,!0):[]}let k=g.flatMap(M).sort((d,a)=>{const w=Q(d.object),C=Q(a.object);return!w||!C?d.distance-a.distance:C.events.priority-w.events.priority||d.distance-a.distance}).filter(d=>{const a=re(d);return c.has(a)?!1:(c.add(a),!0)});l.events.filter&&(k=l.events.filter(k,l));for(const d of k){let a=d.object;for(;a;){var I;(I=a.__r3f)!=null&&I.eventCount&&v.push({...d,eventObject:a}),a=a.parent}}if("pointerId"in i&&l.internal.capturedMap.has(i.pointerId))for(let d of l.internal.capturedMap.get(i.pointerId).values())c.has(re(d.intersection))||v.push(d.intersection);return v}function o(i,p,l,c){if(i.length){const v={stopped:!1};for(const g of i){let M=Q(g.object);if(M||g.object.traverseAncestors(k=>{const I=Q(k);if(I)return M=I,!1}),M){const{raycaster:k,pointer:I,camera:d,internal:a}=M,w=new ie(I.x,I.y,0).unproject(d),C=P=>{var T,O;return(T=(O=a.capturedMap.get(P))==null?void 0:O.has(g.eventObject))!=null?T:!1},h=P=>{const T={intersection:g,target:p.target};a.capturedMap.has(P)?a.capturedMap.get(P).set(g.eventObject,T):a.capturedMap.set(P,new Map([[g.eventObject,T]])),p.target.setPointerCapture(P)},m=P=>{const T=a.capturedMap.get(P);T&&Ye(a.capturedMap,g.eventObject,T,P)};let A={};for(let P in p){let T=p[P];typeof T!="function"&&(A[P]=T)}let D={...g,...A,pointer:I,intersections:i,stopped:v.stopped,delta:l,unprojectedPoint:w,ray:k.ray,camera:d,stopPropagation(){const P="pointerId"in p&&a.capturedMap.get(p.pointerId);if((!P||P.has(g.eventObject))&&(D.stopped=v.stopped=!0,a.hovered.size&&Array.from(a.hovered.values()).find(T=>T.eventObject===g.eventObject))){const T=i.slice(0,i.indexOf(g));s([...T,g])}},target:{hasPointerCapture:C,setPointerCapture:h,releasePointerCapture:m},currentTarget:{hasPointerCapture:C,setPointerCapture:h,releasePointerCapture:m},nativeEvent:p};if(c(D),v.stopped===!0)break}}}return i}function s(i){const{internal:p}=e.getState();for(const l of p.hovered.values())if(!i.length||!i.find(c=>c.object===l.object&&c.index===l.index&&c.instanceId===l.instanceId)){const v=l.eventObject.__r3f;if(p.hovered.delete(re(l)),v!=null&&v.eventCount){const g=v.handlers,M={...l,intersections:i};g.onPointerOut==null||g.onPointerOut(M),g.onPointerLeave==null||g.onPointerLeave(M)}}}function b(i,p){for(let l=0;l<p.length;l++){const c=p[l].__r3f;c==null||c.handlers.onPointerMissed==null||c.handlers.onPointerMissed(i)}}function f(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return p=>{const{internal:l}=e.getState();"pointerId"in p&&l.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{l.capturedMap.has(p.pointerId)&&(l.capturedMap.delete(p.pointerId),s([]))})}}return function(l){const{onPointerMissed:c,internal:v}=e.getState();v.lastEvent.current=l;const g=i==="onPointerMove",M=i==="onClick"||i==="onContextMenu"||i==="onDoubleClick",I=r(l,g?n:void 0),d=M?t(l):0;i==="onPointerDown"&&(v.initialClick=[l.offsetX,l.offsetY],v.initialHits=I.map(w=>w.eventObject)),M&&!I.length&&d<=2&&(b(l,v.interaction),c&&c(l)),g&&s(I);function a(w){const C=w.eventObject,h=C.__r3f;if(!(h!=null&&h.eventCount))return;const m=h.handlers;if(g){if(m.onPointerOver||m.onPointerEnter||m.onPointerOut||m.onPointerLeave){const A=re(w),D=v.hovered.get(A);D?D.stopped&&w.stopPropagation():(v.hovered.set(A,w),m.onPointerOver==null||m.onPointerOver(w),m.onPointerEnter==null||m.onPointerEnter(w))}m.onPointerMove==null||m.onPointerMove(w)}else{const A=m[i];A?(!M||v.initialHits.includes(C))&&(b(l,v.interaction.filter(D=>!v.initialHits.includes(D))),A(w)):M&&v.initialHits.includes(C)&&b(l,v.interaction.filter(D=>!v.initialHits.includes(D)))}}o(I,l,d,a)}}return{handlePointer:f}}const Le=e=>!!(e!=null&&e.render),Qe=R.createContext(null),Gt=(e,t)=>{const n=Tt((f,i)=>{const p=new ie,l=new ie,c=new ie;function v(d=i().camera,a=l,w=i().size){const{width:C,height:h,top:m,left:A}=w,D=C/h;a.isVector3?c.copy(a):c.set(...a);const P=d.getWorldPosition(p).distanceTo(c);if(Ve(d))return{width:C/d.zoom,height:h/d.zoom,top:m,left:A,factor:1,distance:P,aspect:D};{const T=d.fov*Math.PI/180,O=2*Math.tan(T/2)*P,V=O*(C/h);return{width:V,height:O,top:m,left:A,factor:C/V,distance:P,aspect:D}}}let g;const M=d=>f(a=>({performance:{...a.performance,current:d}})),k=new gt;return{set:f,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(d=1)=>e(i(),d),advance:(d,a)=>t(d,a,i()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new yt,pointer:k,mouse:k,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const d=i();g&&clearTimeout(g),d.performance.current!==d.performance.min&&M(d.performance.min),g=setTimeout(()=>M(i().performance.max),d.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:d=>f(a=>({...a,events:{...a.events,...d}})),setSize:(d,a,w=0,C=0)=>{const h=i().camera,m={width:d,height:a,top:w,left:C};f(A=>({size:m,viewport:{...A.viewport,...v(h,l,m)}}))},setDpr:d=>f(a=>{const w=Ge(d);return{viewport:{...a.viewport,dpr:w,initialDpr:a.viewport.initialDpr||w}}}),setFrameloop:(d="always")=>{const a=i().clock;a.stop(),a.elapsedTime=0,d!=="never"&&(a.start(),a.elapsedTime=0),f(()=>({frameloop:d}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:R.createRef(),active:!1,frames:0,priority:0,subscribe:(d,a,w)=>{const C=i().internal;return C.priority=C.priority+(a>0?1:0),C.subscribers.push({ref:d,priority:a,store:w}),C.subscribers=C.subscribers.sort((h,m)=>h.priority-m.priority),()=>{const h=i().internal;h!=null&&h.subscribers&&(h.priority=h.priority-(a>0?1:0),h.subscribers=h.subscribers.filter(m=>m.ref!==d))}}}}}),r=n.getState();let o=r.size,s=r.viewport.dpr,b=r.camera;return n.subscribe(()=>{const{camera:f,size:i,viewport:p,gl:l,set:c}=n.getState();if(i.width!==o.width||i.height!==o.height||p.dpr!==s){o=i,s=p.dpr,Ut(f,i),p.dpr>0&&l.setPixelRatio(p.dpr);const v=typeof HTMLCanvasElement<"u"&&l.domElement instanceof HTMLCanvasElement;l.setSize(i.width,i.height,v)}f!==b&&(b=f,c(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(f)}})))}),n.subscribe(f=>e(f)),n};function Ze(){const e=R.useContext(Qe);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function G(e=n=>n,t){return Ze()(e,t)}function Wt(e,t=0){const n=Ze(),r=n.getState().internal.subscribe,o=Xe(e);return ne(()=>r(o,t,n),[t,r,n]),null}function Yt(e){const t=Mt(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:R.version}),t}const Je=0,K={},Qt=/^three(?=[A-Z])/,de=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let Zt=0;const Jt=e=>typeof e=="function";function Kt(e){if(Jt(e)){const t=`${Zt++}`;return K[t]=e,t}else Object.assign(K,e)}function Ke(e,t){const n=de(e),r=K[n];if(e!=="primitive"&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(e==="primitive"&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(t.args!==void 0&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function $t(e,t,n){var r;return e=de(e)in K?e:e.replace(Qt,""),Ke(e,t),e==="primitive"&&(r=t.object)!=null&&r.__r3f&&delete t.object.__r3f,ce(t.object,n,e,t)}function en(e){if(!e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?ue(e.parent,e):B(e.object)&&(e.object.visible=!1),e.isHidden=!0,$(e)}}function $e(e){if(e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?le(e.parent,e):B(e.object)&&e.props.visible!==!1&&(e.object.visible=!0),e.isHidden=!1,$(e)}}function Te(e,t,n){const r=t.root.getState();if(!(!e.parent&&e.object!==r.scene)){if(!t.object){var o,s;const b=K[de(t.type)];t.object=(o=t.props.object)!=null?o:new b(...(s=t.props.args)!=null?s:[]),t.object.__r3f=t}if(W(t.object,t.props),t.props.attach)le(e,t);else if(B(t.object)&&B(e.object)){const b=e.object.children.indexOf(n?.object);if(n&&b!==-1){const f=e.object.children.indexOf(t.object);if(f!==-1){e.object.children.splice(f,1);const i=f<b?b-1:b;e.object.children.splice(i,0,t.object)}else t.object.parent=e.object,e.object.children.splice(b,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const b of t.children)Te(t,b);$(t)}}function me(e,t){t&&(t.parent=e,e.children.push(t),Te(e,t))}function He(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);r!==-1?e.children.splice(r,0,t):e.children.push(t),Te(e,t,n)}function et(e){if(typeof e.dispose=="function"){const t=()=>{try{e.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?t():Ae.unstable_scheduleCallback(Ae.unstable_IdlePriority,t)}}function Ee(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);r!==-1&&e.children.splice(r,1),t.props.attach?ue(e,t):B(t.object)&&B(e.object)&&(e.object.remove(t.object),Vt(Ue(t),t.object));const o=t.props.dispose!==null&&n!==!1;for(let s=t.children.length-1;s>=0;s--){const b=t.children[s];Ee(t,b,o)}t.children.length=0,delete t.object.__r3f,o&&t.type!=="primitive"&&t.object.type!=="Scene"&&et(t.object),n===void 0&&$(t)}function tn(e,t){for(const n of[e,e.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const r=n.ref(t);typeof r=="function"&&(n.refCleanup=r)}else n.ref&&(n.ref.current=t)}const ae=[];function nn(){for(const[n]of ae){const r=n.parent;if(r){n.props.attach?ue(r,n):B(n.object)&&B(r.object)&&r.object.remove(n.object);for(const o of n.children)o.props.attach?ue(n,o):B(o.object)&&B(n.object)&&n.object.remove(o.object)}n.isHidden&&$e(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&et(n.object)}for(const[n,r,o]of ae){n.props=r;const s=n.parent;if(s){var e,t;const b=K[de(n.type)];n.object=(e=n.props.object)!=null?e:new b(...(t=n.props.args)!=null?t:[]),n.object.__r3f=n,tn(o,n.object),W(n.object,n.props),n.props.attach?le(s,n):B(n.object)&&B(s.object)&&s.object.add(n.object);for(const f of n.children)f.props.attach?le(n,f):B(f.object)&&B(n.object)&&n.object.add(f.object);$(n)}}ae.length=0}const he=()=>{},Ne={};let oe=Je;const rn=0,on=4,Se=Yt({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:$t,removeChild:Ee,appendChild:me,appendInitialChild:me,insertBefore:He,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||me(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||Ee(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;!t||!n||!r||He(r,t,n)},getRootHostContext:()=>Ne,getChildHostContext:()=>Ne,commitUpdate(e,t,n,r,o){var s,b,f;Ke(t,r);let i=!1;if((e.type==="primitive"&&n.object!==r.object||((s=r.args)==null?void 0:s.length)!==((b=n.args)==null?void 0:b.length)||(f=r.args)!=null&&f.some((l,c)=>{var v;return l!==((v=n.args)==null?void 0:v[c])}))&&(i=!0),i)ae.push([e,{...r},o]);else{const l=qt(e,r);Object.keys(l).length&&(Object.assign(e.props,l),W(e.object,l))}(o.sibling===null||(o.flags&on)===rn)&&nn()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>e?.object,prepareForCommit:()=>null,preparePortalMount:e=>ce(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:en,unhideInstance:$e,createTextInstance:he,hideTextInstance:he,unhideTextInstance:he,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:R.createContext(null),setCurrentUpdatePriority(e){oe=e},getCurrentUpdatePriority(){return oe},resolveUpdatePriority(){var e;if(oe!==Je)return oe;switch(typeof window<"u"&&((e=window.event)==null?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return se.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return se.ContinuousEventPriority;default:return se.DefaultEventPriority}},resetFormInstance(){}}),Y=new Map,Z={objects:"shallow",strict:!1};function sn(e,t){if(!t&&typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:r,top:o,left:s}=e.parentElement.getBoundingClientRect();return{width:n,height:r,top:o,left:s}}else if(!t&&typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...t}}function an(e){const t=Y.get(e),n=t?.fiber,r=t?.store;t&&console.warn("R3F.createRoot should only be called once!");const o=typeof reportError=="function"?reportError:console.error,s=r||Gt(Oe,ze),b=n||Se.createContainer(s,se.ConcurrentRoot,null,!1,null,"",o,o,o,null);t||Y.set(e,{fiber:b,store:s});let f,i,p=!1,l=null;return{async configure(c={}){let v;l=new Promise(S=>v=S);let{gl:g,size:M,scene:k,events:I,onCreated:d,shadows:a=!1,linear:w=!1,flat:C=!1,legacy:h=!1,orthographic:m=!1,frameloop:A="always",dpr:D=[1,2],performance:P,raycaster:T,camera:O,onPointerMissed:V}=c,E=s.getState(),F=E.gl;if(!E.gl){const S={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},x=typeof g=="function"?await g(S):g;Le(x)?F=x:F=new rt({...S,...g}),E.set({gl:F})}let q=E.raycaster;q||E.set({raycaster:q=new ot});const{params:u,...j}=T||{};if(N.equ(j,q,Z)||W(q,{...j}),N.equ(u,q.params,Z)||W(q,{params:{...q.params,...u}}),!E.camera||E.camera===i&&!N.equ(i,O,Z)){i=O;const S=O?.isCamera,x=S?O:m?new it(0,0,0,0,.1,1e3):new st(75,0,.1,1e3);S||(x.position.z=5,O&&(W(x,O),x.manual||("aspect"in O||"left"in O||"right"in O||"bottom"in O||"top"in O)&&(x.manual=!0,x.updateProjectionMatrix())),!E.camera&&!(O!=null&&O.rotation)&&x.lookAt(0,0,0)),E.set({camera:x}),q.camera=x}if(!E.scene){let S;k!=null&&k.isScene?(S=k,ce(S,s,"",{})):(S=new at,ce(S,s,"",{}),k&&W(S,k)),E.set({scene:S})}I&&!E.events.handlers&&E.set({events:I(s)});const y=sn(e,M);if(N.equ(y,E.size,Z)||E.setSize(y.width,y.height,y.top,y.left),D&&E.viewport.dpr!==Ge(D)&&E.setDpr(D),E.frameloop!==A&&E.setFrameloop(A),E.onPointerMissed||E.set({onPointerMissed:V}),P&&!N.equ(P,E.performance,Z)&&E.set(S=>({performance:{...S.performance,...P}})),!E.xr){var _;const S=(L,X)=>{const Re=s.getState();Re.frameloop!=="never"&&ze(L,!0,Re,X)},x=()=>{const L=s.getState();L.gl.xr.enabled=L.gl.xr.isPresenting,L.gl.xr.setAnimationLoop(L.gl.xr.isPresenting?S:null),L.gl.xr.isPresenting||Oe(L)},z={connect(){const L=s.getState().gl;L.xr.addEventListener("sessionstart",x),L.xr.addEventListener("sessionend",x)},disconnect(){const L=s.getState().gl;L.xr.removeEventListener("sessionstart",x),L.xr.removeEventListener("sessionend",x)}};typeof((_=F.xr)==null?void 0:_.addEventListener)=="function"&&z.connect(),E.set({xr:z})}if(F.shadowMap){const S=F.shadowMap.enabled,x=F.shadowMap.type;if(F.shadowMap.enabled=!!a,N.boo(a))F.shadowMap.type=pe;else if(N.str(a)){var H;const z={basic:ut,percentage:lt,soft:pe,variance:ct};F.shadowMap.type=(H=z[a])!=null?H:pe}else N.obj(a)&&Object.assign(F.shadowMap,a);(S!==F.shadowMap.enabled||x!==F.shadowMap.type)&&(F.shadowMap.needsUpdate=!0)}return ft.enabled=!h,p||(F.outputColorSpace=w?dt:Be,F.toneMapping=C?pt:vt),E.legacy!==h&&E.set(()=>({legacy:h})),E.linear!==w&&E.set(()=>({linear:w})),E.flat!==C&&E.set(()=>({flat:C})),g&&!N.fun(g)&&!Le(g)&&!N.equ(g,F,Z)&&W(F,g),f=d,p=!0,v(),this},render(c){return!p&&!l&&this.configure(),l.then(()=>{Se.updateContainer(U.jsx(cn,{store:s,children:c,onCreated:f,rootElement:e}),b,null,()=>{})}),s},unmount(){tt(e)}}}function cn({store:e,children:t,onCreated:n,rootElement:r}){return ne(()=>{const o=e.getState();o.set(s=>({internal:{...s.internal,active:!0}})),n&&n(o),e.getState().events.connected||o.events.connect==null||o.events.connect(r)},[]),U.jsx(Qe.Provider,{value:e,children:t})}function tt(e,t){const n=Y.get(e),r=n?.fiber;if(r){const o=n?.store.getState();o&&(o.internal.active=!1),Se.updateContainer(null,r,null,()=>{o&&setTimeout(()=>{try{var s,b,f,i;o.events.disconnect==null||o.events.disconnect(),(s=o.gl)==null||(b=s.renderLists)==null||b.dispose==null||b.dispose(),(f=o.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(i=o.gl)!=null&&i.xr&&o.xr.disconnect(),Lt(o.scene),Y.delete(e)}catch{}},500)})}}const ln=new Set,un=new Set,fn=new Set;function ge(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function ee(e,t){switch(e){case"before":return ge(ln,t);case"after":return ge(un,t);case"tail":return ge(fn,t)}}let ye,je;function Me(e,t,n){let r=t.clock.getDelta();t.frameloop==="never"&&typeof e=="number"&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),ye=t.internal.subscribers;for(let o=0;o<ye.length;o++)je=ye[o],je.ref.current(je.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}let fe=!1,_e=!1,we,qe,J;function nt(e){qe=requestAnimationFrame(nt),fe=!0,we=0,ee("before",e),_e=!0;for(const n of Y.values()){var t;J=n.store.getState(),J.internal.active&&(J.frameloop==="always"||J.internal.frames>0)&&!((t=J.gl.xr)!=null&&t.isPresenting)&&(we+=Me(e,J))}if(_e=!1,ee("after",e),we===0)return ee("tail",e),fe=!1,cancelAnimationFrame(qe)}function Oe(e,t=1){var n;if(!e)return Y.forEach(r=>Oe(r.store.getState(),t));(n=e.gl.xr)!=null&&n.isPresenting||!e.internal.active||e.frameloop==="never"||(t>1?e.internal.frames=Math.min(60,e.internal.frames+t):_e?e.internal.frames=2:e.internal.frames=1,fe||(fe=!0,requestAnimationFrame(nt)))}function ze(e,t=!0,n,r){if(t&&ee("before",e),n)Me(e,n,r);else for(const o of Y.values())Me(e,o.store.getState());t&&ee("after",e)}const Ce={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function dn(e){const{handlePointer:t}=Xt(e);return{priority:1,enabled:!0,compute(n,r,o){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(Ce).reduce((n,r)=>({...n,[r]:t(r)}),{}),update:()=>{var n;const{events:r,internal:o}=e.getState();(n=o.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(o.lastEvent.current)},connect:n=>{const{set:r,events:o}=e.getState();if(o.disconnect==null||o.disconnect(),r(s=>({events:{...s.events,connected:n}})),o.handlers)for(const s in o.handlers){const b=o.handlers[s],[f,i]=Ce[s];n.addEventListener(f,b,{passive:i})}},disconnect:()=>{const{set:n,events:r}=e.getState();if(r.connected){if(r.handlers)for(const o in r.handlers){const s=r.handlers[o],[b]=Ce[o];r.connected.removeEventListener(b,s)}n(o=>({events:{...o.events,connected:void 0}}))}}}}function pn({ref:e,children:t,fallback:n,resize:r,style:o,gl:s,events:b=dn,eventSource:f,eventPrefix:i,shadows:p,linear:l,flat:c,legacy:v,orthographic:g,frameloop:M,dpr:k,performance:I,raycaster:d,camera:a,scene:w,onPointerMissed:C,onCreated:h,...m}){R.useMemo(()=>Kt(jt),[]);const A=At(),[D,P]=wt({scroll:!0,debounce:{scroll:50,resize:0},...r}),T=R.useRef(null),O=R.useRef(null);R.useImperativeHandle(e,()=>T.current);const V=Xe(C),[E,F]=R.useState(!1),[q,u]=R.useState(!1);if(E)throw E;if(q)throw q;const j=R.useRef(null);ne(()=>{const _=T.current;if(P.width>0&&P.height>0&&_){j.current||(j.current=an(_));async function H(){await j.current.configure({gl:s,scene:w,events:b,shadows:p,linear:l,flat:c,legacy:v,orthographic:g,frameloop:M,dpr:k,performance:I,raycaster:d,camera:a,size:P,onPointerMissed:(...S)=>V.current==null?void 0:V.current(...S),onCreated:S=>{S.events.connect==null||S.events.connect(f?It(f)?f.current:f:O.current),i&&S.setEvents({compute:(x,z)=>{const L=x[i+"X"],X=x[i+"Y"];z.pointer.set(L/z.size.width*2-1,-(X/z.size.height)*2+1),z.raycaster.setFromCamera(z.pointer,z.camera)}}),h?.(S)}}),j.current.render(U.jsx(A,{children:U.jsx(Ft,{set:u,children:U.jsx(R.Suspense,{fallback:U.jsx(Dt,{set:F}),children:t??null})})}))}H()}}),R.useEffect(()=>{const _=T.current;if(_)return()=>tt(_)},[]);const y=f?"none":"auto";return U.jsx("div",{ref:O,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:y,...o},...m,children:U.jsx("div",{ref:D,style:{width:"100%",height:"100%"},children:U.jsx("canvas",{ref:T,style:{display:"block"},children:n})})})}function _n(e){return U.jsx(St,{children:U.jsx(pn,{...e})})}const On=R.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:r,enableDamping:o=!0,keyEvents:s=!1,onChange:b,onStart:f,onEnd:i,...p},l)=>{const c=G(m=>m.invalidate),v=G(m=>m.camera),g=G(m=>m.gl),M=G(m=>m.events),k=G(m=>m.setEvents),I=G(m=>m.set),d=G(m=>m.get),a=G(m=>m.performance),w=t||v,C=r||M.connected||g.domElement,h=R.useMemo(()=>new Ot(w),[w]);return Wt(()=>{h.enabled&&h.update()},-1),R.useEffect(()=>(s&&h.connect(s===!0?C:s),h.connect(C),()=>void h.dispose()),[s,C,n,h,c]),R.useEffect(()=>{const m=P=>{c(),n&&a.regress(),b&&b(P)},A=P=>{f&&f(P)},D=P=>{i&&i(P)};return h.addEventListener("change",m),h.addEventListener("start",A),h.addEventListener("end",D),()=>{h.removeEventListener("start",A),h.removeEventListener("end",D),h.removeEventListener("change",m)}},[b,f,i,h,c,k]),R.useEffect(()=>{if(e){const m=d().controls;return I({controls:h}),()=>I({controls:m})}},[e,h]),R.createElement("primitive",_t({ref:l,object:h,enableDamping:o},p))});export{_n as C,On as O,En as a,Pn as c,Sn as g,Wt as u};
