import{q as P}from"./d3-quadtree.CSANTnla.js";import{t as R}from"./d3-timer.DdKHrDhs.js";import{d as b}from"./d3-dispatch.kxCwF96_.js";function N(n){return function(){return n}}function B(n){return 1e-6*(n()-.5)}function C(n){return n.x+n.vx}function G(n){return n.y+n.vy}function Z(n){var t,r,e,i=1,u=1;function o(){for(var n,o,a,c,l,h,v,s=t.length,x=0;x<u;++x)for(o=P(t,C,G).visitAfter(f),n=0;n<s;++n)a=t[n],h=r[a.index],v=h*h,c=a.x+a.vx,l=a.y+a.vy,o.visit(y);function y(n,t,r,u,o){var f=n.data,s=n.r,x=h+s;if(!f)return t>c+x||u<c-x||r>l+x||o<l-x;if(f.index>a.index){var y=c-f.x-f.vx,g=l-f.y-f.vy,d=y*y+g*g;d<x*x&&(0===y&&(d+=(y=B(e))*y),0===g&&(d+=(g=B(e))*g),d=(x-(d=Math.sqrt(d)))/d*i,a.vx+=(y*=d)*(x=(s*=s)/(v+s)),a.vy+=(g*=d)*x,f.vx-=y*(x=1-x),f.vy-=g*x)}}}function f(n){if(n.data)return n.r=r[n.data.index];for(var t=n.r=0;t<4;++t)n[t]&&n[t].r>n.r&&(n.r=n[t].r)}function a(){if(t){var e,i,u=t.length;for(r=new Array(u),e=0;e<u;++e)i=t[e],r[i.index]=+n(i,e,t)}}return"function"!=typeof n&&(n=N(null==n?1:+n)),o.initialize=function(n,r){t=n,e=r,a()},o.iterations=function(n){return arguments.length?(u=+n,o):u},o.strength=function(n){return arguments.length?(i=+n,o):i},o.radius=function(t){return arguments.length?(n="function"==typeof t?t:N(+t),a(),o):n},o}function H(n){return n.index}function T(n,t){var r=n.get(t);if(!r)throw new Error("node not found: "+t);return r}function k(n){var t,r,e,i,u,o,f=H,a=function(n){return 1/Math.min(i[n.source.index],i[n.target.index])},c=N(30),l=1;function h(e){for(var i=0,f=n.length;i<l;++i)for(var a,c,h,v,s,x,y,g=0;g<f;++g)c=(a=n[g]).source,v=(h=a.target).x+h.vx-c.x-c.vx||B(o),s=h.y+h.vy-c.y-c.vy||B(o),v*=x=((x=Math.sqrt(v*v+s*s))-r[g])/x*e*t[g],s*=x,h.vx-=v*(y=u[g]),h.vy-=s*y,c.vx+=v*(y=1-y),c.vy+=s*y}function v(){if(e){var o,a,c=e.length,l=n.length,h=new Map(e.map(((n,t)=>[f(n,t,e),n])));for(o=0,i=new Array(c);o<l;++o)(a=n[o]).index=o,"object"!=typeof a.source&&(a.source=T(h,a.source)),"object"!=typeof a.target&&(a.target=T(h,a.target)),i[a.source.index]=(i[a.source.index]||0)+1,i[a.target.index]=(i[a.target.index]||0)+1;for(o=0,u=new Array(l);o<l;++o)a=n[o],u[o]=i[a.source.index]/(i[a.source.index]+i[a.target.index]);t=new Array(l),s(),r=new Array(l),x()}}function s(){if(e)for(var r=0,i=n.length;r<i;++r)t[r]=+a(n[r],r,n)}function x(){if(e)for(var t=0,i=n.length;t<i;++t)r[t]=+c(n[t],t,n)}return null==n&&(n=[]),h.initialize=function(n,t){e=n,o=t,v()},h.links=function(t){return arguments.length?(n=t,v(),h):n},h.id=function(n){return arguments.length?(f=n,h):f},h.iterations=function(n){return arguments.length?(l=+n,h):l},h.strength=function(n){return arguments.length?(a="function"==typeof n?n:N(+n),s(),h):a},h.distance=function(n){return arguments.length?(c="function"==typeof n?n:N(+n),x(),h):c},h}const J=1664525,K=1013904223,F=4294967296;function L(){let n=1;return()=>(n=(J*n+K)%F)/F}function O(n){return n.x}function Q(n){return n.y}var U=10,V=Math.PI*(3-Math.sqrt(5));function q(n){var t,r=1,e=.001,i=1-Math.pow(e,1/300),u=0,o=.6,f=new Map,a=R(h),c=b("tick","end"),l=L();function h(){v(),c.call("tick",t),r<e&&(a.stop(),c.call("end",t))}function v(e){var a,c,l=n.length;void 0===e&&(e=1);for(var h=0;h<e;++h)for(r+=(u-r)*i,f.forEach((function(n){n(r)})),a=0;a<l;++a)null==(c=n[a]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return t}function s(){for(var t,r=0,e=n.length;r<e;++r){if((t=n[r]).index=r,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=U*Math.sqrt(.5+r),u=r*V;t.x=i*Math.cos(u),t.y=i*Math.sin(u)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function x(t){return t.initialize&&t.initialize(n,l),t}return null==n&&(n=[]),s(),t={tick:v,restart:function(){return a.restart(h),t},stop:function(){return a.stop(),t},nodes:function(r){return arguments.length?(n=r,s(),f.forEach(x),t):n},alpha:function(n){return arguments.length?(r=+n,t):r},alphaMin:function(n){return arguments.length?(e=+n,t):e},alphaDecay:function(n){return arguments.length?(i=+n,t):+i},alphaTarget:function(n){return arguments.length?(u=+n,t):u},velocityDecay:function(n){return arguments.length?(o=1-n,t):1-o},randomSource:function(n){return arguments.length?(l=n,f.forEach(x),t):l},force:function(n,r){return arguments.length>1?(null==r?f.delete(n):f.set(n,x(r)),t):f.get(n)},find:function(t,r,e){var i,u,o,f,a,c=0,l=n.length;for(null==e?e=1/0:e*=e,c=0;c<l;++c)(o=(i=t-(f=n[c]).x)*i+(u=r-f.y)*u)<e&&(a=f,e=o);return a},on:function(n,r){return arguments.length>1?(c.on(n,r),t):c.on(n)}}}function _(){var n,t,r,e,i,u=N(-30),o=1,f=1/0,a=.81;function c(r){var i,u=n.length,o=P(n,O,Q).visitAfter(h);for(e=r,i=0;i<u;++i)t=n[i],o.visit(v)}function l(){if(n){var t,r,e=n.length;for(i=new Array(e),t=0;t<e;++t)r=n[t],i[r.index]=+u(r,t,n)}}function h(n){var t,r,e,u,o,f=0,a=0;if(n.length){for(e=u=o=0;o<4;++o)(t=n[o])&&(r=Math.abs(t.value))&&(f+=t.value,a+=r,e+=r*t.x,u+=r*t.y);n.x=e/a,n.y=u/a}else{(t=n).x=t.data.x,t.y=t.data.y;do{f+=i[t.data.index]}while(t=t.next)}n.value=f}function v(n,u,c,l){if(!n.value)return!0;var h=n.x-t.x,v=n.y-t.y,s=l-u,x=h*h+v*v;if(s*s/a<x)return x<f&&(0===h&&(x+=(h=B(r))*h),0===v&&(x+=(v=B(r))*v),x<o&&(x=Math.sqrt(o*x)),t.vx+=h*n.value*e/x,t.vy+=v*n.value*e/x),!0;if(!(n.length||x>=f)){(n.data!==t||n.next)&&(0===h&&(x+=(h=B(r))*h),0===v&&(x+=(v=B(r))*v),x<o&&(x=Math.sqrt(o*x)));do{n.data!==t&&(s=i[n.data.index]*e/x,t.vx+=h*s,t.vy+=v*s)}while(n=n.next)}}return c.initialize=function(t,e){n=t,r=e,l()},c.strength=function(n){return arguments.length?(u="function"==typeof n?n:N(+n),l(),c):u},c.distanceMin=function(n){return arguments.length?(o=n*n,c):Math.sqrt(o)},c.distanceMax=function(n){return arguments.length?(f=n*n,c):Math.sqrt(f)},c.theta=function(n){return arguments.length?(a=n*n,c):Math.sqrt(a)},c}function nn(n){var t,r,e,i=N(.1);function u(n){for(var i,u=0,o=t.length;u<o;++u)(i=t[u]).vx+=(e[u]-i.x)*r[u]*n}function o(){if(t){var u,o=t.length;for(r=new Array(o),e=new Array(o),u=0;u<o;++u)r[u]=isNaN(e[u]=+n(t[u],u,t))?0:+i(t[u],u,t)}}return"function"!=typeof n&&(n=N(null==n?0:+n)),u.initialize=function(n){t=n,o()},u.strength=function(n){return arguments.length?(i="function"==typeof n?n:N(+n),o(),u):i},u.x=function(t){return arguments.length?(n="function"==typeof t?t:N(+t),o(),u):n},u}function tn(n){var t,r,e,i=N(.1);function u(n){for(var i,u=0,o=t.length;u<o;++u)(i=t[u]).vy+=(e[u]-i.y)*r[u]*n}function o(){if(t){var u,o=t.length;for(r=new Array(o),e=new Array(o),u=0;u<o;++u)r[u]=isNaN(e[u]=+n(t[u],u,t))?0:+i(t[u],u,t)}}return"function"!=typeof n&&(n=N(null==n?0:+n)),u.initialize=function(n){t=n,o()},u.strength=function(n){return arguments.length?(i="function"==typeof n?n:N(+n),o(),u):i},u.y=function(t){return arguments.length?(n="function"==typeof t?t:N(+t),o(),u):n},u}export{Z as c,k as l,_ as m,q as s,nn as x,tn as y};