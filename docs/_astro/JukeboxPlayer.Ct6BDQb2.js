import{a as te,o as oe,y as ae,i as se,t as M,B as ie,L as re,e as ne,d as q,H as r,f as E,g as ce,R as de,b as n,j as V,Q as H,s as l,k as h,v as a,r as v,l as le,Y as g,q as D,E as Q}from"./svelte.BG-3nfZ7.js";import{p as w,a as ue}from"./@nanostores.4Ikc6yb_.js";import{t as pe}from"./nanostores.Bo9-_MAV.js";import"./esm-env.rsSWfq8L.js";import"./react.C2V1wh_4.js";import"./@react-three.BOv1JqT7.js";w("atlas",{plugin:[]},{encode:JSON.stringify,decode:JSON.parse});const J=w("musicData",{items:[]},{encode:JSON.stringify,decode:JSON.parse}),b=w("tagSettings",{},{encode:JSON.stringify,decode:JSON.parse}),fe=pe(async()=>{const u=await fetch("/api/music.json");if(!u.ok)throw new Error("Failed to fetch music data");const p=await u.json();return J.set(p),p}),ye=[{i:"a",x:0,y:0,w:4,h:16,moved:!1,static:!0},{i:"b",x:4,y:0,w:4,h:16,moved:!1,static:!0},{i:"c",x:8,y:0,w:4,h:16,moved:!1,static:!0},{i:"d",x:4,y:16,w:4,h:4,moved:!1,static:!1},{i:"e",x:4,y:8,w:4,h:4,moved:!1,static:!1},{i:"f",x:8,y:16,w:4,h:4,moved:!1,static:!1},{i:"g",x:4,y:12,w:4,h:4,moved:!1,static:!1},{i:"h",x:8,y:12,w:4,h:4,moved:!1,static:!1},{i:"i",x:0,y:16,w:4,h:4,moved:!1,static:!1},{i:"j",x:8,y:0,w:4,h:16,moved:!1,static:!1}];w("layoutKey",ye,{encode:JSON.stringify,decode:JSON.parse});ue("kbve:");var me=M('<link href="https://unpkg.com/video.js/dist/video-js.min.css" rel="stylesheet">'),he=M('<button class="relative z-1 px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500"> </button>'),ve=M(`<div class="space-x-2 my-4"><button>Play Tracks</button> <button>Play Sets</button> <button class="px-4 py-2 bg-blue-500 border text-white rounded hover:scale-110 ease-in-out duration-500">Sync</button> <button class="px-4 py-2 bg-red-500 text-white rounded hover:scale-110 ease-in-out duration-500">Skip</button> <button class="px-4 py-2 bg-cyan-600 border text-white rounded hover:scale-110 ease-in-out duration-500"> </button></div> <div class="space-x-2"></div> <video id="video-js" class="video-js vjs-default-skin w-full aspect-video" controls preload="auto" width="640" height="264"><p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web
    browser that <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p></video> <strong>Currently Playing Video ID:</strong> `,3);function $e(u,p){te(p,!1);const[O,R]=de(),f=()=>H(J,"$musicData$",O),s=()=>H(b,"$tagSetting$",O);let i,z=!1,x=!1,k=h(""),c=h(!1),y=h(!0),m=h(!1);function K(e){return new URLSearchParams(window.location.search).get(e)}function N(e){return/^[a-zA-Z0-9_-]{11}$/.test(e)}oe(()=>{x=!0,console.log("Mounted"),U().then(()=>{x&&z&&Z()})}),ae(()=>{x=!1,i&&i.dispose()});async function U(){try{await new Promise((e,t)=>{const o=document.createElement("script");o.src="https://unpkg.com/video.js/dist/video.min.js",o.onload=e,o.onerror=()=>t(new Error("Failed to load Video.js")),document.head.appendChild(o)}),await new Promise((e,t)=>{const o=document.createElement("script");o.src="https://unpkg.com/videojs-youtube/dist/Youtube.min.js",o.onload=e,o.onerror=()=>t(new Error("Failed to load YouTube plugin")),document.head.appendChild(o)}),z=!0}catch(e){console.error("Error loading scripts:",e)}}async function F(){fe.then(()=>{console.log("Music data has been successfully updated.")}).catch(e=>{console.error("Error updating music data:",e)})}function I(){const e={};f().items.forEach(t=>{t.tags.forEach(o=>{o!=="music"&&(e[o]=!0)})}),b.set(e)}async function Z(){if(f().items.length===0)try{await F(),console.log("Music Data Loaded:",f().items)}catch(e){console.error("Failed to fetch music data:",e);return}Object.keys(s()).length===0?(console.log("Initializing tags from music data..."),I()):console.log("Tags already initialized:",s()),j()}function j(){if(typeof videojs<"u"&&videojs.getTech("youtube")){const e=K("yt"),t=L();if(t.length===0&&(!e||!N(e)))return;const o=e&&N(e)?e:t[Math.floor(Math.random()*t.length)];i=videojs("video-js",{techOrder:["youtube"],sources:[{type:"video/youtube",src:`https://www.youtube.com/watch?v=${o}`}],youtube:{iv_load_policy:3},controls:!0,autoplay:!0,preload:"auto"}),i.on("pause",()=>{}),i.on("ended",A),l(k,o)}else setTimeout(j,100)}function L(){let e=[];return f().items.forEach(t=>{t.tags.some(T=>s()[T]===!0)&&(a(y)&&(e=e.concat(t.ytTracks)),a(m)&&(e=e.concat(t.ytSets)))}),e}function A(){const e=L();if(e.length===0)return;const t=e[Math.floor(Math.random()*e.length)];i.src({type:"video/youtube",src:`https://www.youtube.com/watch?v=${t}`}),i.play(),l(k,t)}function G(e){const t={...s(),[e]:!s()[e]};b.set(t)}async function W(){J.set({items:[]}),b.set({});try{await F(),I(),j(),console.log("Data and tags have been synchronized."),window.location.reload()}catch(e){console.error("Error during synchronization:",e)}}se();var Y=ve();ie(e=>{var t=me();E(e,t)});var $=re(Y),_=V($),S=n(_,2),B=n(S,2),C=n(B,2),d=n(C,2),X=V(d,!0);v(d),v($);var P=n($,2);ne(P,5,()=>Object.keys(s()),le,(e,t)=>{var o=he(),T=V(o,!0);v(o),q(()=>{g(o,"opacity-100",s()[a(t)]),g(o,"opacity-50",!s()[a(t)]),D(T,a(t))}),r("click",o,()=>G(a(t))),E(e,o)}),v(P);var ee=n(P,5);q(()=>{Q(_,`px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 ${(a(y)?"opacity-100":"opacity-50")??""}`),Q(S,`px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 ${(a(m)?"opacity-100":"opacity-50")??""}`),g(d,"opacity-100",a(c)),g(d,"opacity-50",!a(c)),D(X,a(c)?"Disable Force Play":"Enable Force Play"),D(ee,` ${a(k)??""}`)}),r("click",_,()=>l(y,!a(y))),r("click",S,()=>l(m,!a(m))),r("click",B,W),r("click",C,A),r("click",d,()=>l(c,!a(c))),E(u,Y),ce(),R()}export{$e as default};
