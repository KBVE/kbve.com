import{S as le,i as re,s as ce,e as T,a as M,t as Y,A as ue,b as j,f as h,c as P,g as K,d as z,h as R,j as f,l as k,k as b,n as $,o as ne,q as W,C as de,r as he,u as X,w as pe,B as fe,D as q}from"./index.Dpw-MKR5.js";import{g as me}from"./globals.D0QH3NT1.js";import{e as ee}from"./each.-gASlQSi.js";import{t as H,m as te,f as ye}from"./khashvault.B92RoTXM.js";import"./index.CgBe15gE.js";import"./index.BH1EYZ08.js";const{document:oe}=me;function se(o,s,u){const a=o.slice();return a[20]=s[u],a}function ae(o){let s,u=o[20]+"",a,v,m,y;function w(){return o[6](o[20])}return{c(){s=T("button"),a=Y(u),v=M(),this.h()},l(n){s=j(n,"BUTTON",{class:!0});var i=z(s);a=R(i,u),v=P(i),i.forEach(h),this.h()},h(){f(s,"class","px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500"),q(s,"opacity-100",o[3][o[20]]),q(s,"opacity-50",!o[3][o[20]])},m(n,i){b(n,s,i),k(s,a),k(s,v),m||(y=$(s,"click",w),m=!0)},p(n,i){o=n,i&8&&u!==(u=o[20]+"")&&ne(a,u),i&8&&q(s,"opacity-100",o[3][o[20]]),i&8&&q(s,"opacity-50",!o[3][o[20]])},d(n){n&&h(s),m=!1,y()}}}function ve(o){let s,u,a,v="Sync",m,y,w,n,i,V,C,I,_,B,D,S,g,E,A="Currently Playing Video ID:",U,L,N,e,l=`<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a
		web browser that
		<a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>`,r,F,O=ee(Object.keys(o[3])),p=[];for(let t=0;t<O.length;t+=1)p[t]=ae(se(o,O,t));return{c(){s=T("link"),u=M(),a=T("button"),a.textContent=v,m=M(),y=T("div");for(let t=0;t<p.length;t+=1)p[t].c();w=M(),n=T("div"),i=T("button"),V=Y("Play Tracks"),I=M(),_=T("button"),B=Y("Play Sets"),S=M(),g=T("div"),E=T("strong"),E.textContent=A,U=M(),L=Y(o[0]),N=M(),e=T("video"),e.innerHTML=l,this.h()},l(t){const d=ue("svelte-1mim58",oe.head);s=j(d,"LINK",{href:!0,rel:!0}),d.forEach(h),u=P(t),a=j(t,"BUTTON",{class:!0,"data-svelte-h":!0}),K(a)!=="svelte-9jjtnc"&&(a.textContent=v),m=P(t),y=j(t,"DIV",{class:!0});var c=z(y);for(let G=0;G<p.length;G+=1)p[G].l(c);c.forEach(h),w=P(t),n=j(t,"DIV",{class:!0});var x=z(n);i=j(x,"BUTTON",{class:!0});var Q=z(i);V=R(Q,"Play Tracks"),Q.forEach(h),I=P(x),_=j(x,"BUTTON",{class:!0});var Z=z(_);B=R(Z,"Play Sets"),Z.forEach(h),x.forEach(h),S=P(t),g=j(t,"DIV",{class:!0});var J=z(g);E=j(J,"STRONG",{"data-svelte-h":!0}),K(E)!=="svelte-1xwgl6o"&&(E.textContent=A),U=P(J),L=R(J,o[0]),J.forEach(h),N=P(t),e=j(t,"VIDEO",{id:!0,class:!0,preload:!0,width:!0,height:!0,"data-svelte-h":!0}),K(e)!=="svelte-tbppw6"&&(e.innerHTML=l),this.h()},h(){f(s,"href","https://unpkg.com/video.js/dist/video-js.min.css"),f(s,"rel","stylesheet"),f(a,"class","px-4 py-2 bg-blue-500 border text-white rounded hover:scale-110 ease-in-out duration-500"),f(y,"class","space-x-2"),f(i,"class",C="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[1]?"opacity-100":"opacity-50")),f(_,"class",D="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[2]?"opacity-100":"opacity-50")),f(n,"class","space-x-2 my-4"),f(g,"class","mt-4"),f(e,"id","video-js"),f(e,"class","video-js vjs-default-skin w-full aspect-video"),e.controls=!0,f(e,"preload","auto"),f(e,"width","640"),f(e,"height","264")},m(t,d){k(oe.head,s),b(t,u,d),b(t,a,d),b(t,m,d),b(t,y,d);for(let c=0;c<p.length;c+=1)p[c]&&p[c].m(y,null);b(t,w,d),b(t,n,d),k(n,i),k(i,V),k(n,I),k(n,_),k(_,B),b(t,S,d),b(t,g,d),k(g,E),k(g,U),k(g,L),b(t,N,d),b(t,e,d),r||(F=[$(a,"click",o[5]),$(i,"click",o[7]),$(_,"click",o[8])],r=!0)},p(t,[d]){if(d&24){O=ee(Object.keys(t[3]));let c;for(c=0;c<O.length;c+=1){const x=se(t,O,c);p[c]?p[c].p(x,d):(p[c]=ae(x),p[c].c(),p[c].m(y,null))}for(;c<p.length;c+=1)p[c].d(1);p.length=O.length}d&2&&C!==(C="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[1]?"opacity-100":"opacity-50"))&&f(i,"class",C),d&4&&D!==(D="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(t[2]?"opacity-100":"opacity-50"))&&f(_,"class",D),d&1&&ne(L,t[0])},i:W,o:W,d(t){t&&(h(u),h(a),h(m),h(y),h(w),h(n),h(S),h(g),h(N),h(e)),h(s),de(p,t),r=!1,he(F)}}}function _e(o){return new URLSearchParams(window.location.search).get(o)}function ie(o){return/^[a-zA-Z0-9_-]{11}$/.test(o)}function ge(o,s,u){let a,v;X(o,H,e=>u(3,a=e)),X(o,te,e=>u(12,v=e));let m,y=!1,w=!1,n="",i=!0,V=!1;pe(()=>{w=!0,console.log("Mounted"),C().then(()=>{w&&y&&B()})}),fe(()=>{w=!1,m&&m.dispose()});async function C(){try{await new Promise((e,l)=>{const r=document.createElement("script");r.src="https://unpkg.com/video.js/dist/video.min.js",r.onload=e,r.onerror=()=>l(new Error("Failed to load Video.js")),document.head.appendChild(r)}),await new Promise((e,l)=>{const r=document.createElement("script");r.src="https://unpkg.com/videojs-youtube/dist/Youtube.min.js",r.onload=e,r.onerror=()=>l(new Error("Failed to load YouTube plugin")),document.head.appendChild(r)}),y=!0}catch(e){console.error("Error loading scripts:",e)}}async function I(){ye.then(()=>{console.log("Music data has been successfully updated.")}).catch(e=>{console.error("Error updating music data:",e)})}function _(){const e={};v.items.forEach(l=>{l.tags.forEach(r=>{r!=="music"&&(e[r]=!0)})}),H.set(e)}async function B(){if(v.items.length===0)try{await I(),console.log("Music Data Loaded:",v.items)}catch(e){console.error("Failed to fetch music data:",e);return}Object.keys(a).length===0?(console.log("Initializing tags from music data..."),_()):console.log("Tags already initialized:",a),D()}function D(){if(typeof videojs<"u"&&videojs.getTech("youtube")){const e=_e("yt"),l=S();if(l.length===0&&(!e||!ie(e)))return;const r=e&&ie(e)?e:l[Math.floor(Math.random()*l.length)];m=videojs("video-js",{techOrder:["youtube"],sources:[{type:"video/youtube",src:`https://www.youtube.com/watch?v=${r}`}],youtube:{iv_load_policy:3},controls:!0,autoplay:!0,preload:"auto"}),m.on("ended",g),u(0,n=r)}else setTimeout(D,100)}function S(){let e=[];return v.items.forEach(l=>{l.tags.some(F=>a[F]===!0)&&(i&&(e=e.concat(l.ytTracks)),V&&(e=e.concat(l.ytSets)))}),e}function g(){const e=S();if(e.length===0)return;const l=e[Math.floor(Math.random()*e.length)];m.src({type:"video/youtube",src:`https://www.youtube.com/watch?v=${l}`}),m.play(),u(0,n=l)}function E(e){const l={...a,[e]:!a[e]};H.set(l)}async function A(){te.set({items:[]}),H.set({});try{await I(),_(),D(),console.log("Data and tags have been synchronized."),window.location.reload()}catch(e){console.error("Error during synchronization:",e)}}return[n,i,V,a,E,A,e=>E(e),()=>u(1,i=!i),()=>u(2,V=!V)]}class Ve extends le{constructor(s){super(),re(this,s,ge,ve,ce,{})}}export{Ve as default};
