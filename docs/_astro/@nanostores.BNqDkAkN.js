import{o as c,m as L}from"./nanostores.uU_Bu82q.js";let u=t=>t,a={},o={addEventListener(){},removeEventListener(){}};function g(){try{return typeof localStorage<"u"}catch{return!1}}g()&&(a=localStorage);let w={addEventListener(t,r,i){window.addEventListener("storage",r),window.addEventListener("pageshow",i)},removeEventListener(t,r,i){window.removeEventListener("storage",r),window.removeEventListener("pageshow",i)}};typeof window<"u"&&(o=w);function h(t,r={},i={}){let y=i.encode||u,f=i.decode||u,s=L(),v=s.setKey;s.setKey=(e,n)=>{typeof n>"u"?(i.listen!==!1&&o.perKey&&o.removeEventListener(t+e,d,l),delete a[t+e]):(i.listen!==!1&&o.perKey&&!(e in s.value)&&o.addEventListener(t+e,d,l),a[t+e]=y(n)),v(e,n)};let E=s.set;s.set=function(e){for(let n in e)s.setKey(n,e[n]);for(let n in s.value)n in e||s.setKey(n)};function d(e){e.key?e.key.startsWith(t)&&(e.newValue===null?v(e.key.slice(t.length),void 0):v(e.key.slice(t.length),f(e.newValue))):E({})}function l(){let e={...r};for(let n in a)n.startsWith(t)&&(e[n.slice(t.length)]=f(a[n]));s.set(e)}return c(s,()=>{if(l(),i.listen!==!1)return o.addEventListener(t,d,l),()=>{o.removeEventListener(t,d,l);for(let e in s.value)o.removeEventListener(t+e,d,l)}}),s}export{h as p};
