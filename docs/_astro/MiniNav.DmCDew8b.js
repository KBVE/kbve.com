import{r as n,j as e}from"./react.CvslfkeK.js";import{u}from"./@nanostores.vmeSb_hF.js";import{c as p}from"./clsx.B-dksMZM.js";import{u as N,a as z,b as S}from"./userstate.P8giVhEZ.js";import{B as E,q as M,D as k,r as C,U as I,c as _,h as L,s as U}from"./lucide-react.Cq0BVVq0.js";import"./@react-three.B-wTPXHf.js";import"./nanostores.Bo9-_MAV.js";import"./supabaseClient.xweZyGB4.js";import"./@supabase.B1FuS6Fv.js";import"./Page.astro_astro_type_script_index_0_lang.DoJZq5Ub.js";import"./react-dom.DDrfKqI3.js";import"./svelte.BEh2_tzM.js";import"./esm-env.rsSWfq8L.js";const J=({className:x})=>{const s=u(N),d=u(z);u(S);const[o,c]=n.useState(!1),[b,m]=n.useState(!0),[v,g]=n.useState(!1),i=n.useRef(null),a=n.useMemo(()=>!s||!d,[s,d]);n.useEffect(()=>{const t=()=>{const r=document.querySelector('[data-skeleton="avatar"]');r&&(r.style.transition="opacity 0.5s ease-out",r.style.opacity="0",r.style.pointerEvents="none",r.style.zIndex="-1",r.style.visibility="hidden"),setTimeout(()=>g(!0),100)};(async()=>{try{await new Promise(r=>setTimeout(r,800)),t(),m(!1)}catch(r){console.error("Error initializing MiniNav:",r),t(),m(!1)}})()},[s,d,a]),n.useEffect(()=>{const t=r=>{i.current&&!i.current.contains(r.target)&&c(!1)},l=r=>{i.current&&!i.current.contains(r.target)&&c(!1)};return o&&(document.addEventListener("mousedown",t),document.addEventListener("touchstart",l)),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",l)}},[o]);const f=n.useMemo(()=>a?"Guest User":s?.user_metadata?.full_name?s.user_metadata.full_name:s?.email?s.email.split("@")[0]:"User",[s,a]),h=n.useMemo(()=>a||!s?null:s?.user_metadata?.avatar_url||s?.user_metadata?.picture||null,[s,a]),y=n.useMemo(()=>a?"G":(s?.user_metadata?.full_name||s?.email||"User").split(" ").map(l=>l[0]).join("").toUpperCase().slice(0,2),[s,a]),j=[{icon:E,label:"Analytics",href:"/dashboard/analytics"},{icon:M,label:"Performance",href:"/dashboard/performance"},{icon:k,label:"Downloads",href:"/dashboard/downloads"},{icon:C,label:"Share",href:"/dashboard/share"}],w=[{icon:I,label:"Profile",href:"/profile"},{icon:_,label:"Settings",href:"/settings"},{icon:L,label:"Notifications",href:"/notifications"},{icon:U,label:"Sign Out",href:"/logout",divider:!0}];return b?null:e.jsxs("div",{className:p("flex items-center space-x-4 transition-opacity duration-500 z-50",v?"opacity-100":"opacity-0",x),style:{position:"absolute",top:0,left:0,right:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"0",zIndex:50},children:[e.jsx("nav",{className:"hidden md:flex items-center space-x-3 mr-4",children:j.map(t=>e.jsxs("a",{href:t.href,className:"flex items-center px-3 py-2 text-sm text-zinc-400 hover:text-white hover:bg-zinc-800 rounded-lg transition-all duration-200",title:t.label,children:[e.jsx(t.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-2 hidden lg:block",children:t.label})]},t.label))}),e.jsxs("div",{className:"relative",ref:i,children:[e.jsxs("button",{onClick:()=>c(!o),className:"flex items-center space-x-4 px-4 py-3 rounded-lg hover:bg-zinc-800 transition-all duration-200",children:[e.jsxs("div",{className:"relative w-12 h-12",children:[h?e.jsx("img",{src:h,alt:f,className:"w-full h-full rounded-full object-cover border-2 border-zinc-700 hover:border-cyan-500 transition-colors duration-200"}):e.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-white font-semibold text-sm border-2 border-zinc-700 hover:border-cyan-500 transition-colors duration-200",children:y}),!a&&e.jsx("span",{className:"absolute -bottom-1 -right-1 w-4 h-4 rounded-full bg-green-500 border-2 border-zinc-900"})]}),e.jsxs("div",{className:"hidden sm:flex flex-col justify-center text-left leading-tight",children:[e.jsx("span",{className:"text-sm font-semibold text-white truncate",children:f}),e.jsx("span",{className:"text-xs text-zinc-400 truncate",children:a?"Guest Account":s?.email||"Member"})]}),e.jsx("svg",{className:p("w-4 h-4 text-zinc-400 transition-transform duration-200",o&&"rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&e.jsx("div",{className:"absolute top-full right-0 mt-2 w-48 bg-zinc-800 rounded-lg shadow-lg border border-zinc-700 py-1 z-[9999] transform -translate-x-1/4",children:w.map(t=>e.jsxs("div",{children:[t.divider&&e.jsx("hr",{className:"border-zinc-700 my-1"}),e.jsxs("a",{href:t.href,className:"flex items-center px-4 py-2 text-sm text-zinc-300 hover:text-white hover:bg-zinc-700 transition-colors duration-200",onClick:()=>c(!1),children:[e.jsx(t.icon,{className:"w-4 h-4 mr-3"}),t.label]})]},t.label))})]})]})};export{J as default};
