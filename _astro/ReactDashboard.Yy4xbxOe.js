import{j as e,r as f}from"./react.C2V1wh_4.js";import{u as O,a as S,D as $,r as B,b as T,T as A,P as R,c as D,d as V,C as F}from"./@dnd-kit.CuVuMIgw.js";import{a as J,e as y,$ as K}from"./npchandler.UIyRYcCY.js";import{p as G,u as q}from"./@nanostores.4Ikc6yb_.js";import{c as j}from"./clsx.B-dksMZM.js";import{t as c}from"./tailwind-merge.B9ugUrge.js";import{E as z}from"./ExpandIcon.ByxONmlD.js";import"./@react-three.BOv1JqT7.js";import"./react-dom.BQuvmPqq.js";import"./scheduler.C323NY8X.js";import"./@supabase.Bwp_VmKO.js";import"./Page.astro_astro_type_script_index_0_lang.B3mxYo9S.js";import"./svelte.jL6egXml.js";import"./esm-env.rsSWfq8L.js";import"./dexie.Db70IFYj.js";import"./nanostores.Bo9-_MAV.js";import"./axios.Bw-gCGc_.js";class H extends J{itemPositionsStore;constructor(){super(),this.itemPositionsStore=G("dashboardItemPositions",{},{encode:JSON.stringify,decode:JSON.parse})}saveItemPositions(s){this.itemPositionsStore.set(s),console.log("Item positions saved to DashboardBase:",s)}loadItemPositions(){const s=this.itemPositionsStore.get();return console.log("Item positions loaded from DashboardBase:",s),s||{}}}const x=new H,w=c("p-5 border-gray-200 dark:text-neutral-200 rounded-md","w-full md:w-1/4","flex flex-col items-center"),L=c("flex flex-wrap flex-grow bg-gray-500 p-5 rounded-md","w-full md:w-3/4"),Q=({title:a,isVisible:s,onClose:o})=>s?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-5 rounded shadow-lg w-96",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:a}),e.jsxs("p",{className:"mb-4",children:["This is the content of the modal for item ",a,"."]}),e.jsx("button",{className:"bg-cyan-500 text-gray-500 py-2 px-4 rounded hover:bg-cyan-600",onClick:o,children:"Close"})]})}):null,N=({id:a,onExpandClick:s})=>{const{attributes:o,listeners:d,setNodeRef:p,transform:h,isDragging:b}=V({id:a}),g={transform:F.Translate.toString(h)};return e.jsxs("div",{ref:p,className:c("p-3 border border-cyan-500 rounded-md m-2 cursor-grab bg-cyan-300 dark:text-neutral-600 flex items-center justify-between",j({"opacity-50":b})),style:g,...d,...o,children:[a,e.jsx("button",{onClick:s,className:"ml-2 p-2 rounded-full bg-gray-200 hover:bg-gray-300",children:e.jsx(z,{className:"w-4 h-4 text-gray-800 dark:text-gray-200"})})]})},U=({id:a,children:s})=>{const{setNodeRef:o,isOver:d}=D({id:a});return e.jsxs("div",{ref:o,className:c("p-5 border-dashed border-2 border-gray-300 rounded-md m-3 min-h-[150px]","w-full sm:w-[45%] md:w-[30%]",j({"bg-cyan-100":d,"bg-white":!d})),children:[e.jsx("h3",{className:c("font-bold mb-3"),children:a}),s]})},W=({id:a,children:s})=>{const{setNodeRef:o,isOver:d}=D({id:a}),p=q(K);return e.jsxs("div",{ref:o,className:c(w,"border-2 border-dashed border-gray-400",j({"bg-cyan-500":d})),children:[e.jsx("h3",{className:c("font-bold text-xl mb-4"),children:`${p.username}'s Inventory`}),s]})},X=({items:a,onItemExpandClick:s})=>e.jsxs("div",{className:w,children:[e.jsx("h3",{className:c("font-bold text-xl mb-4"),children:"Available Items"}),a.map(o=>e.jsx(N,{id:o,onExpandClick:()=>s(o)},o))]}),Y=({containers:a})=>{const[s,o]=f.useState({}),[d,p]=f.useState(["Item 1","Item 2","Item 3","Function","IGBC"]),[h,b]=f.useState(null),[g,I]=f.useState(!1),[C,P]=f.useState(""),E=O(S(R,{activationConstraint:{distance:5}}),S(A,{activationConstraint:{delay:100,tolerance:5}}));f.useEffect(()=>{(async()=>{try{const t=await x.loadProfile();console.log(`Data: ${t}`)}catch(t){console.error("Error loading profile or item positions:",t)}})()},[]),f.useEffect(()=>{const r=x.loadItemPositions();o(r);const t=new Set(Object.values(r).flatMap(u=>u.map(n=>n.id)));p(u=>u.filter(n=>!t.has(n)))},[]);const v=r=>{y.emit("openModal",{message:`Modal for ${r}`})};f.useEffect(()=>{const r=t=>{t&&P(t.message),I(!0)};return y.on("openModal",r),()=>{y.off("openModal",r)}},[]);const k=async r=>{const{active:t,over:u}=r;if(!u){b(null);return}const n=Object.keys(s).find(i=>s[i]?.some(l=>l.id===t.id)),m=u.id;if(m==="sidebar")d.includes(t.id)||p(i=>[...i,t.id]),n&&o(i=>{const l={...i,[n]:i[n].filter(M=>M.id!==t.id)};return x.saveItemPositions(l),l});else if(!n)p(i=>i.filter(l=>l!==t.id)),o(i=>{const l={...i,[m]:[...i[m]||[],{id:t.id,container:m}]};return x.saveItemPositions(l),l});else if(n!==m){const i={...s,[n]:s[n].filter(l=>l.id!==t.id),[m]:[...s[m]||[],{id:t.id,container:m}]};o(i),x.saveItemPositions(i)}b(null)};return e.jsxs($,{sensors:E,collisionDetection:B,onDragStart:r=>b(r.active.id),onDragEnd:k,children:[e.jsxs("div",{className:c("flex flex-col md:flex-row"),children:[e.jsx(W,{id:"sidebar",children:e.jsx(X,{items:d,onItemExpandClick:v})}),e.jsx("div",{className:L,children:a.map(r=>e.jsx(U,{id:r,children:s[r]?.map(t=>e.jsx(N,{id:t.id,onExpandClick:()=>v(t.id)},t.id))},r))})]}),e.jsx(T,{children:h?e.jsx("div",{children:h}):null}),e.jsx(Q,{title:C,isVisible:g,onClose:()=>I(!1)})]})},be=()=>e.jsx(Y,{containers:["Deploy","B","C","D","E","F","Kill"]});export{be as default};
