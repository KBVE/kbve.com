import{R as N}from"./index.bb46cfe7.js";import{g as C}from"./_commonjsHelpers.042e6b4d.js";import{j}from"./jsx-runtime.16ac5568.js";const i=1,F=2,H=4,f=8,k=16,S=32,g=64,O={a:{content:9,self:!1,type:105},address:{invalid:["h1","h2","h3","h4","h5","h6","address","article","aside","section","div","header","footer"],self:!1},audio:{children:["track","source"]},br:{type:9,void:!0},body:{content:127},button:{content:8,type:105},caption:{content:1,parent:["table"]},col:{parent:["colgroup"],void:!0},colgroup:{children:["col"],parent:["table"]},details:{children:["summary"],type:97},dd:{content:1,parent:["dl"]},dl:{children:["dt","dd"],type:1},dt:{content:1,invalid:["footer","header"],parent:["dl"]},figcaption:{content:1,parent:["figure"]},footer:{invalid:["footer","header"]},header:{invalid:["footer","header"]},hr:{type:1,void:!0},img:{void:!0},li:{content:1,parent:["ul","ol","menu"]},main:{self:!1},ol:{children:["li"],type:1},picture:{children:["source","img"],type:25},rb:{parent:["ruby","rtc"]},rp:{parent:["ruby","rtc"]},rt:{content:8,parent:["ruby","rtc"]},rtc:{content:8,parent:["ruby"]},ruby:{children:["rb","rp","rt","rtc"]},source:{parent:["audio","video","picture"],void:!0},summary:{content:8,parent:["details"]},table:{children:["caption","colgroup","thead","tbody","tfoot","tr"],type:1},tbody:{parent:["table"],children:["tr"]},td:{content:1,parent:["tr"]},tfoot:{parent:["table"],children:["tr"]},th:{content:1,parent:["tr"]},thead:{parent:["table"],children:["tr"]},tr:{parent:["table","tbody","thead","tfoot"],children:["th","td"]},track:{parent:["audio","video"],void:!0},ul:{children:["li"],type:1},video:{children:["track","source"]},wbr:{type:9,void:!0}};function w(e){return t=>{O[t]={...e,...O[t]}}}["address","main","div","figure","p","pre"].forEach(w({content:1,type:65})),["abbr","b","bdi","bdo","cite","code","data","dfn","em","i","kbd","mark","q","ruby","samp","strong","sub","sup","time","u","var"].forEach(w({content:8,type:73})),["p","pre"].forEach(w({content:8,type:65})),["s","small","span","del","ins"].forEach(w({content:8,type:9})),["article","aside","footer","header","nav","section","blockquote"].forEach(w({content:1,type:67})),["h1","h2","h3","h4","h5","h6"].forEach(w({content:8,type:69})),["audio","canvas","iframe","img","video"].forEach(w({type:89}));const R=Object.freeze(O),W=["applet","base","body","command","embed","frame","frameset","head","html","link","meta","noscript","object","script","style","title"],Y=Object.keys(R).filter((e=>"canvas"!==e&&"iframe"!==e)),d=1,$=2,A=3,x=4,M=5,P=Object.freeze({alt:1,cite:1,class:1,colspan:3,controls:4,datetime:1,default:4,disabled:4,dir:1,height:1,href:1,id:1,kind:1,label:1,lang:1,loading:1,loop:4,media:1,muted:4,poster:1,rel:1,role:1,rowspan:3,scope:1,sizes:1,span:3,start:3,style:5,src:1,srclang:1,srcset:1,tabindex:1,target:1,title:1,type:1,width:1}),z=Object.freeze({class:"className",colspan:"colSpan",datetime:"dateTime",rowspan:"rowSpan",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex"});function _(){return _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(this,arguments)}function B({attributes:e={},className:t,children:n=null,selfClose:r=!1,tagName:a}){const s=a;return r?N.createElement(s,_({className:t},e)):N.createElement(s,_({className:t},e),n)}class U{attribute(e,t){return t}node(e,t){return t}}var G=/["'&<>]/,V=q;function q(e){var t=""+e,n=G.exec(t);if(!n)return t;var r,a="",s=0,i=0;for(s=n.index;s<t.length;s++){switch(t.charCodeAt(s)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&#39;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}i!==s&&(a+=t.substring(i,s)),i=s+1,a+=r}return i!==s?a+t.substring(i,s):a}const K=C(V);function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const X=/(url|image|image-set)\(/i;class J extends U{attribute(e,t){return"style"===e&&Object.keys(t).forEach((e=>{String(t[e]).match(X)&&delete t[e]})),t}}const D=1,Q=3,Z=/^<(!doctype|(html|head|body)(\s|>))/i,ee=/^(aria-|data-|\w+:)/iu,te=/{{{(\w+)\/?}}}/;function ne(){if(!(typeof window>"u"||typeof document>"u"))return document.implementation.createHTMLDocument("Interweave")}class re{constructor(e,t={},n=[],r=[]){var a;v(this,"allowed",void 0),v(this,"banned",void 0),v(this,"blocked",void 0),v(this,"container",void 0),v(this,"content",[]),v(this,"props",void 0),v(this,"matchers",void 0),v(this,"filters",void 0),v(this,"keyIndex",void 0),this.props=t,this.matchers=n,this.filters=[...r,new J],this.keyIndex=-1,this.container=this.createContainer(e||""),this.allowed=new Set(null!==(a=t.allowList)&&void 0!==a?a:Y),this.banned=new Set(W),this.blocked=new Set(t.blockList)}applyAttributeFilters(e,t){return this.filters.reduce(((t,n)=>null!==t&&"function"==typeof n.attribute?n.attribute(e,t):t),t)}applyNodeFilters(e,t){return this.filters.reduce(((t,n)=>null!==t&&"function"==typeof n.node?n.node(e,t):t),t)}applyMatchers(e,t){const n={},{props:r}=this;let a=e,s=0,i=null;return this.matchers.forEach((e=>{const o=e.asTag().toLowerCase(),l=this.getTagConfig(o);if(r[e.inverseName]||!this.isTagAllowed(o)||!this.canRenderChild(t,l))return;let c="";for(;a&&(i=e.match(a));){const{index:t,length:o,match:l,valid:d,void:h,...p}=i,u=e.propName+String(s);t>0&&(c+=a.slice(0,t)),d?(c+=h?`{{{${u}/}}}`:`{{{${u}}}}${l}{{{/${u}}}}`,this.keyIndex+=1,s+=1,n[u]={children:l,matcher:e,props:{...r,...p,key:this.keyIndex}}):c+=l,e.greedy?(a=c+a.slice(t+o),c=""):a=a.slice(t+(o||l.length))}e.greedy||(a=c+a)})),0===s?e:this.replaceTokens(a,n)}canRenderChild(e,t){return!(!e.tagName||!t.tagName||e.void)&&(e.children.length>0?e.children.includes(t.tagName):!(e.invalid.length>0&&e.invalid.includes(t.tagName))&&(t.parent.length>0?t.parent.includes(e.tagName):!(!e.self&&e.tagName===t.tagName)&&!!(e&&e.content&t.type)))}convertLineBreaks(e){const{noHtml:t,disableLineBreaks:n}=this.props;if(t||n||e.match(/<((?:\/[ a-z]+)|(?:[ a-z]+\/))>/gi))return e;let r=e.replace(/\r\n/g,"\n");return r=r.replace(/\n{3,}/g,"\n\n\n"),r=r.replace(/\n/g,"<br/>"),r}createContainer(e){var t;const n=(typeof global<"u"&&global.INTERWEAVE_SSR_POLYFILL||ne)();if(!n)return;const r=null!==(t=this.props.containerTagName)&&void 0!==t?t:"body",a="body"===r||"fragment"===r?n.body:n.createElement(r);return e.match(Z)||(a.innerHTML=this.convertLineBreaks(this.props.escapeHtml?K(e):e)),a}extractAttributes(e){const{allowAttributes:t}=this.props,n={};let r=0;return 1===e.nodeType&&e.attributes&&([...e.attributes].forEach((a=>{const{name:s,value:i}=a,o=s.toLowerCase(),l=P[o]||P[s];if(!this.isSafe(e)||!o.match(ee)&&(!t&&(!l||2===l)||o.startsWith("on")||i.replace(/(\s|\0|&#x0([9AD]);)/,"").match(/(javascript|vbscript|livescript|xss):/i)))return;let c="style"===o?this.extractStyleAttribute(e):i;4===l?c=!0:3===l?c=Number.parseFloat(String(c)):5!==l&&(c=String(c)),n[z[o]||o]=this.applyAttributeFilters(o,c),r+=1})),0!==r)?n:null}extractStyleAttribute(e){const t={};return Array.from(e.style).forEach((n=>{const r=e.style[n];("string"==typeof r||"number"==typeof r)&&(t[n.replace(/-([a-z])/g,((e,t)=>String(t).toUpperCase()))]=r)})),t}getTagConfig(e){const t={children:[],content:0,invalid:[],parent:[],self:!0,tagName:"",type:0,void:!1};return R[e]?{...t,...R[e],tagName:e}:t}isSafe(e){if(typeof HTMLAnchorElement<"u"&&e instanceof HTMLAnchorElement){const t=e.getAttribute("href");if(null!=t&&t.startsWith("#"))return!0;const n=e.protocol.toLowerCase();return":"===n||"http:"===n||"https:"===n||"mailto:"===n||"tel:"===n}return!0}isTagAllowed(e){return!this.banned.has(e)&&!this.blocked.has(e)&&(this.props.allowElements||this.allowed.has(e))}parse(){return this.container?this.parseNode(this.container,this.getTagConfig(this.container.nodeName.toLowerCase())):[]}parseNode(e,t){const{noHtml:n,noHtmlExceptMatchers:r,allowElements:a,transform:s,transformOnlyAllowList:i}=this.props;let o=[],l="";return[...e.childNodes].forEach((e=>{if(1===e.nodeType){const d=e.nodeName.toLowerCase(),h=this.getTagConfig(d);l&&(o.push(l),l="");const p=this.applyNodeFilters(d,e);if(!p)return;let u;if(s&&(!i||this.isTagAllowed(d))){this.keyIndex+=1;const e=this.keyIndex;u=this.parseNode(p,h);const t=s(p,u,h);if(null===t)return;if(typeof t<"u")return void o.push(N.cloneElement(t,{key:e}));this.keyIndex=e-1}if(this.banned.has(d))return;if(n||r&&"br"!==d||!this.isTagAllowed(d)||!a&&!this.canRenderChild(t,h))o=[...o,...this.parseNode(p,h.tagName?h:t)];else{var c;this.keyIndex+=1;const e=this.extractAttributes(p),t={tagName:d};e&&(t.attributes=e),h.void&&(t.selfClose=h.void),o.push(N.createElement(B,{...t,key:this.keyIndex},null!==(c=u)&&void 0!==c?c:this.parseNode(p,h)))}}else if(3===e.nodeType){const a=n&&!r?e.textContent:this.applyMatchers(e.textContent||"",t);Array.isArray(a)?o=[...o,...a]:l+=a}})),l&&o.push(l),o}replaceTokens(e,t){if(!e.includes("{{{"))return e;const n=[];let r=e,a=null;for(;a=r.match(te);){const[e,s]=a,i=a.index,o=e.includes("/");i>0&&(n.push(r.slice(0,i)),r=r.slice(i));const{children:l,matcher:c,props:d}=t[s];let h;if(o)h=e.length,n.push(c.createElement(l,d));else{const a=r.match(new RegExp(`{{{/${s}}}}`));h=a.index+a[0].length,n.push(c.createElement(this.replaceTokens(r.slice(e.length,a.index),t),d))}r=r.slice(h)}return r.length>0&&n.push(r),0===n.length?"":1===n.length&&"string"==typeof n[0]?n[0]:n}}function se(e){var t;const{attributes:n,className:r,containerTagName:a,content:s,emptyContent:i,parsedContent:o,tagName:l,noWrap:c}=e,d=null!==(t=a??l)&&void 0!==t?t:"span",h="fragment"===d||c;let p;if(o)p=o;else{const t=new re(s??"",e).parse();t.length>0&&(p=t)}return p||(p=i),h?N.createElement(N.Fragment,null,p):N.createElement(B,{attributes:n,className:r,tagName:d},p)}function ae(e){const t=document.createElement("textarea");return t.innerHTML=decodeURI(e),t.value}const le=()=>{const e=ae(new URL(window.location.href).hash.slice(1));return j.jsx(se,{content:e})};export{le as default};