import{q as P}from"./d3-quadtree.CSANTnla.js";import{t as R}from"./d3-timer.DdKHrDhs.js";import{d as b}from"./d3-dispatch.kxCwF96_.js";function N(n){return function(){return n}}function B(n){return(n()-.5)*1e-6}function C(n){return n.x+n.vx}function G(n){return n.y+n.vy}function Z(n){var o,l,p,M=1,v=1;typeof n!="function"&&(n=N(n==null?1:+n));function g(){for(var f,s=o.length,D,x,a,m,e,t,i=0;i<v;++i)for(D=P(o,C,G).visitAfter(r),f=0;f<s;++f)x=o[f],e=l[x.index],t=e*e,a=x.x+x.vx,m=x.y+x.vy,D.visit(c);function c(y,u,d,A,j){var w=y.data,E=y.r,z=e+E;if(w){if(w.index>x.index){var I=a-w.x-w.vx,S=m-w.y-w.vy,$=I*I+S*S;$<z*z&&(I===0&&(I=B(p),$+=I*I),S===0&&(S=B(p),$+=S*S),$=(z-($=Math.sqrt($)))/$*M,x.vx+=(I*=$)*(z=(E*=E)/(t+E)),x.vy+=(S*=$)*z,w.vx-=I*(z=1-z),w.vy-=S*z)}return}return u>a+z||A<a-z||d>m+z||j<m-z}}function r(f){if(f.data)return f.r=l[f.data.index];for(var s=f.r=0;s<4;++s)f[s]&&f[s].r>f.r&&(f.r=f[s].r)}function h(){if(o){var f,s=o.length,D;for(l=new Array(s),f=0;f<s;++f)D=o[f],l[D.index]=+n(D,f,o)}}return g.initialize=function(f,s){o=f,p=s,h()},g.iterations=function(f){return arguments.length?(v=+f,g):v},g.strength=function(f){return arguments.length?(M=+f,g):M},g.radius=function(f){return arguments.length?(n=typeof f=="function"?f:N(+f),h(),g):n},g}function H(n){return n.index}function T(n,o){var l=n.get(o);if(!l)throw new Error("node not found: "+o);return l}function k(n){var o=H,l=D,p,M=N(30),v,g,r,h,f,s=1;n==null&&(n=[]);function D(t){return 1/Math.min(r[t.source.index],r[t.target.index])}function x(t){for(var i=0,c=n.length;i<s;++i)for(var y=0,u,d,A,j,w,E,z;y<c;++y)u=n[y],d=u.source,A=u.target,j=A.x+A.vx-d.x-d.vx||B(f),w=A.y+A.vy-d.y-d.vy||B(f),E=Math.sqrt(j*j+w*w),E=(E-v[y])/E*t*p[y],j*=E,w*=E,A.vx-=j*(z=h[y]),A.vy-=w*z,d.vx+=j*(z=1-z),d.vy+=w*z}function a(){if(g){var t,i=g.length,c=n.length,y=new Map(g.map((d,A)=>[o(d,A,g),d])),u;for(t=0,r=new Array(i);t<c;++t)u=n[t],u.index=t,typeof u.source!="object"&&(u.source=T(y,u.source)),typeof u.target!="object"&&(u.target=T(y,u.target)),r[u.source.index]=(r[u.source.index]||0)+1,r[u.target.index]=(r[u.target.index]||0)+1;for(t=0,h=new Array(c);t<c;++t)u=n[t],h[t]=r[u.source.index]/(r[u.source.index]+r[u.target.index]);p=new Array(c),m(),v=new Array(c),e()}}function m(){if(g)for(var t=0,i=n.length;t<i;++t)p[t]=+l(n[t],t,n)}function e(){if(g)for(var t=0,i=n.length;t<i;++t)v[t]=+M(n[t],t,n)}return x.initialize=function(t,i){g=t,f=i,a()},x.links=function(t){return arguments.length?(n=t,a(),x):n},x.id=function(t){return arguments.length?(o=t,x):o},x.iterations=function(t){return arguments.length?(s=+t,x):s},x.strength=function(t){return arguments.length?(l=typeof t=="function"?t:N(+t),m(),x):l},x.distance=function(t){return arguments.length?(M=typeof t=="function"?t:N(+t),e(),x):M},x}const J=1664525,K=1013904223,F=4294967296;function L(){let n=1;return()=>(n=(J*n+K)%F)/F}function O(n){return n.x}function Q(n){return n.y}var U=10,V=Math.PI*(3-Math.sqrt(5));function q(n){var o,l=1,p=.001,M=1-Math.pow(p,1/300),v=0,g=.6,r=new Map,h=R(D),f=b("tick","end"),s=L();n==null&&(n=[]);function D(){x(),f.call("tick",o),l<p&&(h.stop(),f.call("end",o))}function x(e){var t,i=n.length,c;e===void 0&&(e=1);for(var y=0;y<e;++y)for(l+=(v-l)*M,r.forEach(function(u){u(l)}),t=0;t<i;++t)c=n[t],c.fx==null?c.x+=c.vx*=g:(c.x=c.fx,c.vx=0),c.fy==null?c.y+=c.vy*=g:(c.y=c.fy,c.vy=0);return o}function a(){for(var e=0,t=n.length,i;e<t;++e){if(i=n[e],i.index=e,i.fx!=null&&(i.x=i.fx),i.fy!=null&&(i.y=i.fy),isNaN(i.x)||isNaN(i.y)){var c=U*Math.sqrt(.5+e),y=e*V;i.x=c*Math.cos(y),i.y=c*Math.sin(y)}(isNaN(i.vx)||isNaN(i.vy))&&(i.vx=i.vy=0)}}function m(e){return e.initialize&&e.initialize(n,s),e}return a(),o={tick:x,restart:function(){return h.restart(D),o},stop:function(){return h.stop(),o},nodes:function(e){return arguments.length?(n=e,a(),r.forEach(m),o):n},alpha:function(e){return arguments.length?(l=+e,o):l},alphaMin:function(e){return arguments.length?(p=+e,o):p},alphaDecay:function(e){return arguments.length?(M=+e,o):+M},alphaTarget:function(e){return arguments.length?(v=+e,o):v},velocityDecay:function(e){return arguments.length?(g=1-e,o):1-g},randomSource:function(e){return arguments.length?(s=e,r.forEach(m),o):s},force:function(e,t){return arguments.length>1?(t==null?r.delete(e):r.set(e,m(t)),o):r.get(e)},find:function(e,t,i){var c=0,y=n.length,u,d,A,j,w;for(i==null?i=1/0:i*=i,c=0;c<y;++c)j=n[c],u=e-j.x,d=t-j.y,A=u*u+d*d,A<i&&(w=j,i=A);return w},on:function(e,t){return arguments.length>1?(f.on(e,t),o):f.on(e)}}}function _(){var n,o,l,p,M=N(-30),v,g=1,r=1/0,h=.81;function f(a){var m,e=n.length,t=P(n,O,Q).visitAfter(D);for(p=a,m=0;m<e;++m)o=n[m],t.visit(x)}function s(){if(n){var a,m=n.length,e;for(v=new Array(m),a=0;a<m;++a)e=n[a],v[e.index]=+M(e,a,n)}}function D(a){var m=0,e,t,i=0,c,y,u;if(a.length){for(c=y=u=0;u<4;++u)(e=a[u])&&(t=Math.abs(e.value))&&(m+=e.value,i+=t,c+=t*e.x,y+=t*e.y);a.x=c/i,a.y=y/i}else{e=a,e.x=e.data.x,e.y=e.data.y;do m+=v[e.data.index];while(e=e.next)}a.value=m}function x(a,m,e,t){if(!a.value)return!0;var i=a.x-o.x,c=a.y-o.y,y=t-m,u=i*i+c*c;if(y*y/h<u)return u<r&&(i===0&&(i=B(l),u+=i*i),c===0&&(c=B(l),u+=c*c),u<g&&(u=Math.sqrt(g*u)),o.vx+=i*a.value*p/u,o.vy+=c*a.value*p/u),!0;if(a.length||u>=r)return;(a.data!==o||a.next)&&(i===0&&(i=B(l),u+=i*i),c===0&&(c=B(l),u+=c*c),u<g&&(u=Math.sqrt(g*u)));do a.data!==o&&(y=v[a.data.index]*p/u,o.vx+=i*y,o.vy+=c*y);while(a=a.next)}return f.initialize=function(a,m){n=a,l=m,s()},f.strength=function(a){return arguments.length?(M=typeof a=="function"?a:N(+a),s(),f):M},f.distanceMin=function(a){return arguments.length?(g=a*a,f):Math.sqrt(g)},f.distanceMax=function(a){return arguments.length?(r=a*a,f):Math.sqrt(r)},f.theta=function(a){return arguments.length?(h=a*a,f):Math.sqrt(h)},f}function nn(n){var o=N(.1),l,p,M;typeof n!="function"&&(n=N(n==null?0:+n));function v(r){for(var h=0,f=l.length,s;h<f;++h)s=l[h],s.vx+=(M[h]-s.x)*p[h]*r}function g(){if(l){var r,h=l.length;for(p=new Array(h),M=new Array(h),r=0;r<h;++r)p[r]=isNaN(M[r]=+n(l[r],r,l))?0:+o(l[r],r,l)}}return v.initialize=function(r){l=r,g()},v.strength=function(r){return arguments.length?(o=typeof r=="function"?r:N(+r),g(),v):o},v.x=function(r){return arguments.length?(n=typeof r=="function"?r:N(+r),g(),v):n},v}function tn(n){var o=N(.1),l,p,M;typeof n!="function"&&(n=N(n==null?0:+n));function v(r){for(var h=0,f=l.length,s;h<f;++h)s=l[h],s.vy+=(M[h]-s.y)*p[h]*r}function g(){if(l){var r,h=l.length;for(p=new Array(h),M=new Array(h),r=0;r<h;++r)p[r]=isNaN(M[r]=+n(l[r],r,l))?0:+o(l[r],r,l)}}return v.initialize=function(r){l=r,g()},v.strength=function(r){return arguments.length?(o=typeof r=="function"?r:N(+r),g(),v):o},v.y=function(r){return arguments.length?(n=typeof r=="function"?r:N(+r),g(),v):n},v}export{Z as c,k as l,_ as m,q as s,nn as x,tn as y};
