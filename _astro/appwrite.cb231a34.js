import{C as y,D as v,S as E,F as b,A as k,I as m}from"./sdk.15bb076e.js";let w=0,d=[];function $(){return w+=1,()=>{if(w-=1,0===w){let e=d;d=[];for(let t of e)t()}}}function S(e){let t=$();return e().finally(t)}let o=[],p=(e,t)=>{let s=[],n={lc:0,l:t||0,value:e,set(e){n.value!==e&&(n.value=e,n.notify())},get:()=>(n.lc||n.listen((()=>{}))(),n.value),notify(e){let t=!o.length;for(let t=0;t<s.length;t+=2)o.push(s[t],n.value,e,s[t+1]);if(t){for(let e=0;e<o.length;e+=4){let t=!1;for(let s=e+7;s<o.length;s+=4)if(o[s]<o[e+3]){t=!0;break}t?o.push(o[e],o[e+1],o[e+2],o[e+3]):o[e](o[e+1],o[e+2])}o.length=0}},listen:(e,t)=>(n.lc=s.push(e,t||n.l)/2,()=>{let t=s.indexOf(e);~t&&(s.splice(t,2),n.lc--,n.lc||n.off())}),subscribe(e,t){let o=n.listen(e,t);return e(n.value),o},off(){}};return n};const f=(new y).setEndpoint("https://ap.kbve.com/v1").setProject("6436a6dc9a6b48db802f");new v(f),new E(f);const A=new b(f),c=new k(f),i=p(void 0);c.getSession("current").then((function(e){i.set(e)}),(function(e){i.set(void 0)}));const I=p(void 0),T=p(void 0),u=p(!1);i.subscribe((async e=>{e?.userId&&I.set(await x())}));const C=async()=>{try{return c.createOAuth2Session("github","https://kbve.com/account/","https://kbve.com/account/login/?failure")}catch(e){throw e}},F=async(e,t)=>{try{const o=await c.createEmailSession(e,t);i.set(o),window.location.href="/account"}catch(e){throw e.message}},j=async()=>{try{const e=i.get();console.log(e),e?.$id&&(await c.deleteSession(e?.$id),i.set(void 0),window.location.href="/")}catch(e){throw e.message}},L=async(e,t,o)=>{try{await c.create(m.unique(),e,t,o);const s=await c.createEmailSession(e,t);i.set(s),window.location.href="/account"}catch(e){throw e.message}},x=async()=>{try{return c.get()}catch(e){throw e.message}},D=async(e,t)=>{try{return A.createExecution(e,t)}catch(e){throw e.message}},O=async(e,t)=>{u.get()?console.log("[API] is currently running"):S((async()=>{u.set(!0),console.log(`Task API -> ${u.get()}`),console.log(`Started Task ${e}`),console.log(`Data ${t}`),T.set(await D(e,t)),u.set(!1),console.log(`Task API -> ${u.get()}`),console.log("Task Ended")}))};export{u as a,j as b,T as f,C as g,F as l,O as p,L as r,I as u};