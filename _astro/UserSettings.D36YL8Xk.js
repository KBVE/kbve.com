const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/supabaseClient.BVs_U1Yj.js","_astro/@supabase.YBEbTA-W.js","_astro/@react-three.B-wTPXHf.js","_astro/react.CvslfkeK.js","_astro/Page.astro_astro_type_script_index_0_lang.DQ_zeJSQ.js","_astro/react-dom.CtWA3ti2.js","_astro/svelte.BEh2_tzM.js","_astro/esm-env.rsSWfq8L.js"])))=>i.map(i=>d[i]);
import{_ as w}from"./Page.astro_astro_type_script_index_0_lang.DQ_zeJSQ.js";import{r as u,j as e}from"./react.CvslfkeK.js";import{u as b}from"./@nanostores.vmeSb_hF.js";import{u as j,s as v,f as p,h as f}from"./userstate.DNABvgUj.js";import{t as l}from"./tailwind-merge.B9ugUrge.js";import{supabase as y}from"./supabaseClient.BVs_U1Yj.js";import{k as _,T as S,l as A,m as U,M as g,n as E,o as D,U as k,p as L,b as C}from"./lucide-react.4nCU159t.js";import"./react-dom.CtWA3ti2.js";import"./svelte.BEh2_tzM.js";import"./esm-env.rsSWfq8L.js";import"./@react-three.B-wTPXHf.js";import"./nanostores.Bo9-_MAV.js";import"./@supabase.YBEbTA-W.js";const M=()=>{const a=b(j),[n,m]=u.useState(null),[d,x]=u.useState(null),t=(r,s)=>{x({text:r,type:s}),setTimeout(()=>x(null),7e3)},o=a?.app_metadata?.provider==="web3",c=a?.email;if(!o||c)return null;const i=async r=>{m(r);try{const{data:s,error:h}=await y.auth.linkIdentity({provider:r,options:{redirectTo:window.location.origin+"/settings"}});h?t(`Failed to link ${r}: ${h.message}`,"error"):s?.url&&(t(`Redirecting to ${r} for account linking...`,"info"),window.location.href=s.url)}catch{t(`An unexpected error occurred while linking ${r}.`,"error")}finally{m(null)}};return e.jsxs("div",{className:l("rounded-2xl p-6 shadow-xl","bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/50 dark:to-orange-950/50","border-2 border-amber-300 dark:border-amber-600","backdrop-blur-sm"),children:[d&&e.jsx("div",{className:l("p-3 rounded-lg border mb-4",d.type==="success"?"bg-green-100 border-green-300 text-green-800 dark:bg-green-900/50 dark:border-green-600 dark:text-green-300":d.type==="error"?"bg-red-100 border-red-300 text-red-800 dark:bg-red-900/50 dark:border-red-600 dark:text-red-300":"bg-blue-100 border-blue-300 text-blue-800 dark:bg-blue-900/50 dark:border-blue-600 dark:text-blue-300"),children:d.text}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(_,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"}),e.jsx("h3",{className:"text-xl font-semibold text-amber-900 dark:text-amber-100",children:"Link Additional Identity"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-100/50 dark:bg-amber-900/30 rounded-lg border border-amber-200 dark:border-amber-700",children:[e.jsx(S,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-800 dark:text-amber-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Web3 Account Detected"}),e.jsx("p",{children:"Your account was created using a Web3 wallet and doesn't have an email address. Link a social account to add email functionality and enable additional features."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-lg font-medium text-amber-900 dark:text-amber-100",children:"Available Identity Providers"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>i("github"),disabled:n!==null,className:l("flex items-center gap-3 p-4 rounded-lg border-2 transition-all duration-200","bg-white dark:bg-neutral-800","border-neutral-300 dark:border-neutral-600","hover:border-neutral-400 dark:hover:border-neutral-500","focus:outline-none focus:ring-2 focus:ring-amber-400 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",n==="github"&&"border-amber-400 dark:border-amber-500"),children:[e.jsx(A,{className:"w-6 h-6 text-neutral-700 dark:text-neutral-300"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold text-neutral-900 dark:text-neutral-100",children:n==="github"?"Linking GitHub...":"Link GitHub"}),e.jsx("div",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Connect your GitHub account"})]})]}),e.jsxs("button",{onClick:()=>i("discord"),disabled:n!==null,className:l("flex items-center gap-3 p-4 rounded-lg border-2 transition-all duration-200","bg-white dark:bg-neutral-800","border-neutral-300 dark:border-neutral-600","hover:border-neutral-400 dark:hover:border-neutral-500","focus:outline-none focus:ring-2 focus:ring-amber-400 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",n==="discord"&&"border-amber-400 dark:border-amber-500"),children:[e.jsx(U,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold text-neutral-900 dark:text-neutral-100",children:n==="discord"?"Linking Discord...":"Link Discord"}),e.jsx("div",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Connect your Discord account"})]})]})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(g,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Benefits of Linking"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Add email address to your account"}),e.jsx("li",{children:"Enable email notifications and recovery"}),e.jsx("li",{children:"Access member features requiring verified email"}),e.jsx("li",{children:"Keep your Web3 wallet as primary authentication"})]})]})]})})]})]})},P=()=>{const a=b(j),[n,m]=u.useState(!1),[d,x]=u.useState(null),[t,o]=u.useState({email:"",phone:"",displayName:"",username:""});u.useEffect(()=>{a&&o({email:a.email||"",phone:a.phone||"",displayName:a.user_metadata?.display_name||"",username:a.user_metadata?.username||""})},[a]);const c=(r,s)=>{x({text:r,type:s}),setTimeout(()=>x(null),5e3)},i=async()=>{m(!0);try{const r={};t.email!==(a?.email||"")&&(r.email=t.email),t.phone!==(a?.phone||"")&&(r.phone=t.phone);const s={};if(t.displayName!==(a?.user_metadata?.display_name||"")&&(s.display_name=t.displayName),t.username!==(a?.user_metadata?.username||"")&&(s.username=t.username),Object.keys(s).length>0&&(r.data=s),Object.keys(r).length===0){c("No changes to save.","error");return}const{data:h,error:N}=await y.auth.updateUser(r);N?c(`Failed to update profile: ${N.message}`,"error"):(c("Profile updated successfully!","success"),await v())}catch{c("An unexpected error occurred while updating your profile.","error")}finally{m(!1)}};return a?e.jsxs("div",{className:l("rounded-2xl p-6 shadow-xl","bg-white dark:bg-neutral-800","border border-neutral-300 dark:border-neutral-600","backdrop-blur-sm"),children:[d&&e.jsx("div",{className:l("p-3 rounded-lg border mb-4",d.type==="success"?"bg-green-100 border-green-300 text-green-800 dark:bg-green-900/50 dark:border-green-600 dark:text-green-300":"bg-red-100 border-red-300 text-red-800 dark:bg-red-900/50 dark:border-red-600 dark:text-red-300"),children:d.text}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(E,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 dark:text-white",children:"Update Profile Information"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-2",children:[e.jsx(g,{className:"w-4 h-4"}),"Email Address"]}),e.jsx("input",{type:"email",value:t.email,onChange:r=>o(s=>({...s,email:r.target.value})),placeholder:"Enter your email address",className:l("w-full p-3 rounded-lg border","bg-neutral-50 dark:bg-neutral-700","border-neutral-300 dark:border-neutral-600","text-neutral-900 dark:text-neutral-100","placeholder-neutral-500 dark:placeholder-neutral-400","focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent","transition-colors duration-200")}),!a.email&&e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-1",children:"Adding an email will require verification"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Phone Number"]}),e.jsx("input",{type:"tel",value:t.phone,onChange:r=>o(s=>({...s,phone:r.target.value})),placeholder:"Enter your phone number",className:l("w-full p-3 rounded-lg border","bg-neutral-50 dark:bg-neutral-700","border-neutral-300 dark:border-neutral-600","text-neutral-900 dark:text-neutral-100","placeholder-neutral-500 dark:placeholder-neutral-400","focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent","transition-colors duration-200")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Display Name"]}),e.jsx("input",{type:"text",value:t.displayName,onChange:r=>o(s=>({...s,displayName:r.target.value})),placeholder:"Enter your display name",className:l("w-full p-3 rounded-lg border","bg-neutral-50 dark:bg-neutral-700","border-neutral-300 dark:border-neutral-600","text-neutral-900 dark:text-neutral-100","placeholder-neutral-500 dark:placeholder-neutral-400","focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent","transition-colors duration-200")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Username"]}),e.jsx("input",{type:"text",value:t.username,onChange:r=>o(s=>({...s,username:r.target.value})),placeholder:"Enter your username",className:l("w-full p-3 rounded-lg border","bg-neutral-50 dark:bg-neutral-700","border-neutral-300 dark:border-neutral-600","text-neutral-900 dark:text-neutral-100","placeholder-neutral-500 dark:placeholder-neutral-400","focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent","transition-colors duration-200")}),e.jsx("p",{className:"text-xs text-neutral-600 dark:text-neutral-400 mt-1",children:"Username will be used for profile identification"})]}),e.jsx("div",{className:"pt-4 border-t border-neutral-200 dark:border-neutral-700",children:e.jsxs("button",{onClick:i,disabled:n,className:l("inline-flex items-center gap-2 px-6 py-3 rounded-lg font-medium","bg-gradient-to-r from-blue-500 to-blue-600 text-white","hover:from-blue-600 hover:to-blue-700 transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed","shadow-lg hover:shadow-xl transition-shadow duration-200"),children:[e.jsx(L,{className:"w-4 h-4"}),n?"Updating...":"Save Changes"]})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Profile Update Notes:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Email changes require verification before taking effect"}),e.jsx("li",{children:"Phone number changes may require SMS verification"}),e.jsx("li",{children:"Display name and username updates are immediate"}),e.jsx("li",{children:"Web3 wallet address cannot be changed"})]})]})})]})]}):null},K=()=>{const a=b(j),n=b(p),m=b(f),[d,x]=u.useState(!1),[t,o]=u.useState(null);u.useEffect(()=>{(async()=>{p.set(!0),f.set("");try{await v()}catch(r){f.set(r instanceof Error?r.message:"Failed to load user data")}finally{p.set(!1)}})()},[]);const c=(i,r)=>{o({text:i,type:r}),setTimeout(()=>o(null),5e3)};return n?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-center text-neutral-600 dark:text-neutral-300",children:"Loading settings..."})}):m?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-red-500 text-center",children:m})}):a?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[t&&e.jsx("div",{className:l("p-4 rounded-lg border",t.type==="success"?"bg-green-100/50 border-green-300 text-green-800 dark:bg-green-900/30 dark:border-green-600 dark:text-green-300":"bg-red-100/50 border-red-300 text-red-800 dark:bg-red-900/30 dark:border-red-600 dark:text-red-300"),children:t.text}),e.jsxs("div",{className:l("rounded-2xl p-6 shadow-xl","bg-white dark:bg-neutral-800","border border-neutral-300 dark:border-neutral-600","backdrop-blur-sm"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(k,{className:"w-6 h-6 text-cyan-600 dark:text-cyan-400"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 dark:text-white",children:"Account Information"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-1",children:"User ID"}),e.jsx("div",{className:"p-3 bg-neutral-50 dark:bg-neutral-700 rounded-lg font-mono text-sm text-neutral-900 dark:text-neutral-100 border border-neutral-200 dark:border-neutral-600",children:a.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-1",children:"Account Created"}),e.jsx("div",{className:"p-3 bg-neutral-50 dark:bg-neutral-700 rounded-lg text-sm text-neutral-900 dark:text-neutral-100 border border-neutral-200 dark:border-neutral-600",children:a.created_at?new Date(a.created_at).toLocaleDateString():"N/A"})]})]})})]}),e.jsxs("div",{className:l("rounded-2xl p-6 shadow-xl","bg-white dark:bg-neutral-800","border border-neutral-300 dark:border-neutral-600","backdrop-blur-sm"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(g,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 dark:text-white",children:"Email Settings"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-1",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 p-3 bg-neutral-50 dark:bg-neutral-700 rounded-lg text-neutral-900 dark:text-neutral-100 border border-neutral-200 dark:border-neutral-600",children:a.email||"No email address set"}),a.email_confirmed_at?e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-200 rounded-full text-xs font-medium border border-green-200 dark:border-green-700",children:"Verified"}):e.jsx("span",{className:"px-3 py-1 bg-amber-100 text-amber-800 dark:bg-amber-800 dark:text-amber-200 rounded-full text-xs font-medium border border-amber-200 dark:border-amber-700",children:"Unverified"})]})]}),!a.email_confirmed_at&&a.email&&e.jsxs("button",{onClick:async()=>{x(!0);try{const{error:i}=await w(async()=>{const{error:r}=await import("./supabaseClient.BVs_U1Yj.js");return{error:r}},__vite__mapDeps([0,1,2,3,4,5,6,7])).then(({supabase:r})=>r.auth.resend({type:"signup",email:a.email}));i?c("Failed to resend verification email: "+i.message,"error"):c("Verification email sent! Please check your inbox.","success")}catch{c("An unexpected error occurred.","error")}finally{x(!1)}},disabled:d,className:l("inline-flex items-center gap-2 px-4 py-2 rounded-lg","bg-gradient-to-r from-purple-500 to-purple-600 text-white font-medium","hover:from-purple-600 hover:to-purple-700 transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(g,{className:"w-4 h-4"}),d?"Sending...":"Resend Verification Email"]})]})]}),e.jsxs("div",{className:l("rounded-2xl p-6 shadow-xl","bg-white dark:bg-neutral-800","border border-neutral-300 dark:border-neutral-600","backdrop-blur-sm"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(C,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 dark:text-white",children:"Security & Authentication"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-1",children:"Authentication Method"}),e.jsx("div",{className:"p-3 bg-neutral-50 dark:bg-neutral-700 rounded-lg border border-neutral-200 dark:border-neutral-600",children:a.app_metadata?.provider==="web3"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 dark:bg-purple-800 dark:text-purple-200 rounded text-xs font-medium border border-purple-200 dark:border-purple-700",children:"Web3"}),e.jsx("span",{className:"text-sm text-neutral-900 dark:text-neutral-100",children:a.user_metadata?.custom_claims?.chain==="solana"?"Solana Wallet":"Web3 Wallet"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200 rounded text-xs font-medium border border-blue-200 dark:border-blue-700",children:"OAuth"}),e.jsx("span",{className:"text-sm capitalize text-neutral-900 dark:text-neutral-100",children:a.app_metadata?.provider||"Standard"})]})})]}),a.user_metadata?.custom_claims?.address&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-200 mb-1",children:"Connected Wallet"}),e.jsx("div",{className:"p-3 bg-neutral-50 dark:bg-neutral-700 rounded-lg font-mono text-sm break-all text-neutral-900 dark:text-neutral-100 border border-neutral-200 dark:border-neutral-600",children:a.user_metadata.custom_claims.address})]})]})]}),e.jsx(M,{}),e.jsx(P,{})]}):e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-center text-neutral-600 dark:text-neutral-300",children:"Please log in to access settings."})})};export{K as default};
