import{C as y,D as v,S as b,F as k,A as m,I as E}from"./sdk.15bb076e.js";let f=0,d=[];function S(){return f+=1,()=>{if(f-=1,0===f){let t=d;d=[];for(let e of t)e()}}}function A(t){let e=S();return t().finally(e)}let o=[],p=(t,e)=>{let a=[],s={lc:0,l:e||0,value:t,set(t){s.value!==t&&(s.value=t,s.notify())},get:()=>(s.lc||s.listen((()=>{}))(),s.value),notify(t){let e=!o.length;for(let e=0;e<a.length;e+=2)o.push(a[e],s.value,t,a[e+1]);if(e){for(let t=0;t<o.length;t+=4){let e=!1;for(let a=t+7;a<o.length;a+=4)if(o[a]<o[t+3]){e=!0;break}e?o.push(o[t],o[t+1],o[t+2],o[t+3]):o[t](o[t+1],o[t+2])}o.length=0}},listen:(t,e)=>(s.lc=a.push(t,e||s.l)/2,()=>{let e=a.indexOf(t);~e&&(a.splice(e,2),s.lc--,s.lc||s.off())}),subscribe(t,e){let o=s.listen(t,e);return t(s.value),o},off(){}};return s};const g=(new y).setEndpoint("https://ap.kbve.com/v1").setProject("6436a6dc9a6b48db802f");new v(g),new b(g);const $=new k(g),a=new m(g),i=p(void 0);a.getSession("current").then((function(t){i.set(t)}),(function(t){i.set(void 0)}));const I=p(void 0),T=p(void 0),u=p(!1);i.subscribe((async t=>{t?.userId&&I.set(await x())}));const P=async()=>{try{return a.createOAuth2Session("github","https://kbve.com/account/","https://kbve.com/account/login/?failure")}catch(t){return t}},C=async()=>{try{return a.createOAuth2Session("discord","https://kbve.com/account/","https://kbve.com/account/login/?failure")}catch(t){return t}},F=async()=>{try{return a.createOAuth2Session("google","https://kbve.com/account/","https://kbve.com/account/login/?failure")}catch(t){return t}},j=async()=>{try{return a.createOAuth2Session("discord","https://kbve.com/account/","https://kbve.com/account/login/?failure")}catch(t){return t}},L=async(t,e)=>{try{const o=await a.createEmailSession(t,e);i.set(o),window.location.href="/account"}catch(t){throw t.message}},Q=async()=>{try{const t=i.get();console.log(t),t?.$id&&(await a.deleteSession(t?.$id),i.set(void 0),window.location.href="/")}catch(t){throw t.message}},q=async(t,e,o)=>{try{await a.create(E.unique(),t,e,o);const s=await a.createEmailSession(t,e);i.set(s),window.location.href="/account"}catch(t){throw t.message}},x=async()=>{try{return a.get()}catch(t){throw t.message}},O=async(t,e)=>{try{return $.createExecution(t,e)}catch(t){throw t.message}},R=async(t,e)=>{u.get()?console.log("[API] is currently running"):A((async()=>{u.set(!0),console.log(`Task API -> ${u.get()}`),console.log(`Started Task ${t}`),console.log(`Data ${e}`),T.set(await O(t,e)),u.set(!1),console.log(`Task API -> ${u.get()}`),console.log("Task Ended")}))};export{F as a,u as b,Q as c,C as d,T as f,P as g,L as l,R as p,q as r,j as t,I as u};