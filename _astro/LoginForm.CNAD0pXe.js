import{S as Ne,i as Fe,s as Re,e as Se,a as D,b as o,t as he,h as Ke,d as c,c as T,f as n,g,j as Y,k as me,l as a,m as se,n as je,o as l,p as G,q as ue,r as we,u as We,v as pe,w as fe,x as Ye,y as Ge,z as Je,A as Qe}from"./index.BL2D2LL-.js";import{g as Xe}from"./globals.D0QH3NT1.js";import{C as Ze,r as $e}from"./loader.glmVqvBr.js";import{K as Pe,k as le}from"./npchandler.CsnXuAhR.js";import"./jsx-runtime.CzgMDNMm.js";import"./index.DQ2WTIsS.js";import"./preload-helper.ygWHROA3.js";import"./index.CFX5TIQh.js";import"./index.BH1EYZ08.js";const{document:ye}=Xe;function Be(d){let e,t;return{c(){e=o("script"),this.h()},l(s){e=n(s,"SCRIPT",{src:!0});var u=g(e);u.forEach(c),this.h()},h(){je(e.src,t=d[5])||a(e,"src",t),e.async=!0,e.defer=!0},m(s,u){G(s,e,u)},p:fe,d(s){s&&c(e)}}}function He(d){let e,t='<div class="flex p-4"><div class="shrink-0"><svg class="shrink-0 size-4 text-blue-500 mt-0.5" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"></path></svg></div> <div class="ms-3"><p id="hs-toast-normal-example-label" class="text-sm text-gray-700 dark:text-neutral-400">Processing...</p></div></div>';return{c(){e=o("div"),e.innerHTML=t,this.h()},l(s){e=n(s,"DIV",{class:!0,role:!0,tabindex:!0,"aria-labelledby":!0,"data-svelte-h":!0}),Y(e)!=="svelte-xpal3g"&&(e.innerHTML=t),this.h()},h(){a(e,"class","max-w-xs bg-white border border-gray-200 rounded-xl shadow-lg dark:bg-neutral-800 dark:border-neutral-700 z-100"),a(e,"role","alert"),a(e,"tabindex","-1"),a(e,"aria-labelledby","hs-toast-normal-example-label")},m(s,u){G(s,e,u)},d(s){s&&c(e)}}}function Oe(d){let e,t,s,u='<svg class="shrink-0 size-4 text-red-500 mt-0.5" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"></path></svg>',h,r,m,v=d[4].error_message+"",_;return{c(){e=o("div"),t=o("div"),s=o("div"),s.innerHTML=u,h=D(),r=o("div"),m=o("p"),_=he(v),this.h()},l(b){e=n(b,"DIV",{class:!0,role:!0,tabindex:!0,"aria-labelledby":!0});var C=g(e);t=n(C,"DIV",{class:!0});var V=g(t);s=n(V,"DIV",{class:!0,"data-svelte-h":!0}),Y(s)!=="svelte-mnfjrn"&&(s.innerHTML=u),h=T(V),r=n(V,"DIV",{class:!0});var U=g(r);m=n(U,"P",{id:!0,class:!0});var P=g(m);_=me(P,v),P.forEach(c),U.forEach(c),V.forEach(c),C.forEach(c),this.h()},h(){a(s,"class","shrink-0"),a(m,"id","hs-toast-error-example-label"),a(m,"class","text-sm text-gray-700 dark:text-neutral-400"),a(r,"class","ms-3"),a(t,"class","flex p-4"),a(e,"class","max-w-xs bg-white border border-gray-200 rounded-xl shadow-lg dark:bg-neutral-800 dark:border-neutral-700 z-100"),a(e,"role","alert"),a(e,"tabindex","-1"),a(e,"aria-labelledby","hs-toast-error-example-label")},m(b,C){G(b,e,C),l(e,t),l(t,s),l(t,h),l(t,r),l(r,m),l(m,_)},p(b,C){C&16&&v!==(v=b[4].error_message+"")&&pe(_,v)},d(b){b&&c(e)}}}function Ue(d){let e,t,s=d[4].successful_message+"",u;return{c(){e=o("div"),t=o("span"),u=he(s),this.h()},l(h){e=n(h,"DIV",{class:!0});var r=g(e);t=n(r,"SPAN",{class:!0});var m=g(t);u=me(m,s),m.forEach(c),r.forEach(c),this.h()},h(){a(t,"class","text-lg text-cyan-600 dark:text-cyan-300"),a(e,"class","flex")},m(h,r){G(h,e,r),l(e,t),l(t,u)},p(h,r){r&16&&s!==(s=h[4].successful_message+"")&&pe(u,s)},d(h){h&&c(e)}}}function et(d){let e,t='<span class="relative flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-cyan-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-cyan-500"></span></span> <span class="px-2 text-gray-600 dark:text-neutral-400 font-bold">Online</span>';return{c(){e=o("div"),e.innerHTML=t,this.h()},l(s){e=n(s,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-hfgq2j"&&(e.innerHTML=t),this.h()},h(){a(e,"class","inline-flex items-center")},m(s,u){G(s,e,u)},p:fe,d(s){s&&c(e)}}}function tt(d){let e,t,s='<span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>',u,h,r;return{c(){e=o("div"),t=o("span"),t.innerHTML=s,u=D(),h=o("div"),r=he(d[3]),this.h()},l(m){e=n(m,"DIV",{class:!0});var v=g(e);t=n(v,"SPAN",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-493u0u"&&(t.innerHTML=s),u=T(v),h=n(v,"DIV",{class:!0});var _=g(h);r=me(_,d[3]),_.forEach(c),v.forEach(c),this.h()},h(){a(t,"class","relative flex h-3 w-3"),a(h,"class","px-2 text-gray-600 dark:text-neutral-400 text-wrap w-1/2"),a(e,"class","inline-flex items-center")},m(m,v){G(m,e,v),l(e,t),l(e,u),l(e,h),l(h,r)},p(m,v){v&8&&pe(r,m[3])},d(m){m&&c(e)}}}function at(d){let e,t,s,u,h,r,m,v="Login!",_,b,C="KBVE Authentication Portal",V,U,P,R,M,w,B,A,p="Email Address",Z,J,x,$,q,i,H='<label for="login-password" class="mb-1 block text-xs md:text-sm md:mb-2 text-neutral-800 dark:text-neutral-200">Password</label>',N,ee,z,ge,te,X,ve,F,ae=d[2]?"Loading...":"Login",re,be,K,Q,_e,j,ke,xe,Ee,y=d[1]&&!window?.hcaptcha&&Be(d),L=d[2]&&He(),k=d[4].error_message&&Oe(d),E=d[4].successful_message&&Ue(d);function Ce(f,I){return f[3]?tt:et}let ie=Ce(d),O=ie(d);return{c(){y&&y.c(),e=Se(),t=D(),s=o("div"),u=o("div"),h=o("div"),r=o("div"),m=o("h3"),m.textContent=v,_=D(),b=o("h1"),b.textContent=C,V=D(),L&&L.c(),U=D(),k&&k.c(),P=D(),E&&E.c(),R=D(),M=o("form"),w=o("div"),B=o("div"),A=o("label"),A.textContent=p,Z=D(),J=o("div"),x=o("input"),$=D(),q=o("div"),i=o("div"),i.innerHTML=H,N=D(),ee=o("div"),z=o("input"),ge=D(),te=o("div"),X=o("div"),ve=D(),F=o("button"),re=he(ae),be=D(),K=o("div"),Q=o("div"),O.c(),_e=D(),j=o("dotlottie-player"),this.h()},l(f){const I=Ke("svelte-1fvsnp3",ye.head);y&&y.l(I),e=Se(),I.forEach(c),t=T(f),s=n(f,"DIV",{class:!0});var Le=g(s);u=n(Le,"DIV",{class:!0,id:!0});var Ie=g(u);h=n(Ie,"DIV",{class:!0});var oe=g(h);r=n(oe,"DIV",{class:!0});var S=g(r);m=n(S,"H3",{class:!0,"data-svelte-h":!0}),Y(m)!=="svelte-19a6ky5"&&(m.textContent=v),_=T(S),b=n(S,"H1",{class:!0,"data-svelte-h":!0}),Y(b)!=="svelte-4x0q1u"&&(b.textContent=C),V=T(S),L&&L.l(S),U=T(S),k&&k.l(S),P=T(S),E&&E.l(S),R=T(S),M=n(S,"FORM",{id:!0,class:!0,action:!0});var De=g(M);w=n(De,"DIV",{class:!0});var W=g(w);B=n(W,"DIV",{});var ne=g(B);A=n(ne,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Y(A)!=="svelte-1botxoa"&&(A.textContent=p),Z=T(ne),J=n(ne,"DIV",{});var Te=g(J);x=n(Te,"INPUT",{type:!0,id:!0,name:!0,autocomplete:!0,class:!0,"aria-describedby":!0}),Te.forEach(c),ne.forEach(c),$=T(W),q=n(W,"DIV",{});var ce=g(q);i=n(ce,"DIV",{class:!0,"data-svelte-h":!0}),Y(i)!=="svelte-1d795g4"&&(i.innerHTML=H),N=T(ce),ee=n(ce,"DIV",{});var Ve=g(ee);z=n(Ve,"INPUT",{type:!0,id:!0,name:!0,class:!0,"aria-describedby":!0}),Ve.forEach(c),ce.forEach(c),ge=T(W),te=n(W,"DIV",{});var Me=g(te);X=n(Me,"DIV",{id:!0,class:!0}),g(X).forEach(c),Me.forEach(c),ve=T(W),F=n(W,"BUTTON",{type:!0,class:!0});var ze=g(F);re=me(ze,ae),ze.forEach(c),W.forEach(c),De.forEach(c),S.forEach(c),be=T(oe),K=n(oe,"DIV",{class:!0});var de=g(K);Q=n(de,"DIV",{class:!0});var Ae=g(Q);O.l(Ae),Ae.forEach(c),_e=T(de),j=n(de,"DOTLOTTIE-PLAYER",{autoplay:!0,loop:!0,class:!0,mode:!0,src:!0});var qe=g(j);qe.forEach(c),de.forEach(c),oe.forEach(c),Ie.forEach(c),Le.forEach(c),this.h()},h(){a(m,"class","text-blue-400 mb-1"),a(b,"class","page-title text-white font-bold text-3xl mb-5 lg:text-3xl xl:text-4xl 2xl:text-5xl"),a(A,"for","login-email"),a(A,"class","mb-1 block text-xs text-left md:text-sm md:mb-2 text-neutral-800 dark:text-neutral-200"),a(x,"type","email"),a(x,"id","login-email"),a(x,"name","email"),a(x,"autocomplete","email"),a(x,"class","block w-full h-4 md:h-12 rounded-lg border border-neutral-200 bg-neutral-50 px-4 py-3 text-sm text-neutral-700 focus:border-neutral-200 focus:outline-none focus:ring focus:ring-neutral-400 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-600 dark:bg-neutral-700/30 dark:text-neutral-300 dark:focus:ring-1"),x.required=!0,a(x,"aria-describedby","login-email"),a(i,"class","flex items-center justify-between"),a(z,"type","password"),a(z,"id","login-password"),a(z,"name","password"),a(z,"class","block w-full h-4 md:h-12 rounded-lg border border-neutral-200 bg-neutral-50 px-4 py-3 text-sm text-neutral-700 focus:border-neutral-200 focus:outline-none focus:ring focus:ring-neutral-400 disabled:pointer-events-none disabled:opacity-50 dark:border-neutral-600 dark:bg-neutral-700/30 dark:text-neutral-300 dark:focus:ring-1"),z.required=!0,a(z,"aria-describedby","login-password"),a(X,"id","h-captcha-"+d[6]),a(X,"class","flex justify-center scale-75 md:scale-100"),a(F,"type","submit"),a(F,"class",`${lt} ${rt} ${it} ${ot} ${nt} ${ct} ${dt}`),F.disabled=d[2],a(w,"class","grid gap-y-2 md:gap-y-4"),a(M,"id","loginForm"),a(M,"class","opacity-0 transition-opacity duration-500"),a(M,"action","#"),a(r,"class","relative"),a(Q,"class",""),se(j,"autoplay",""),se(j,"loop",""),se(j,"class","hidden md:block md:w-full"),se(j,"mode","normal"),je(j.src,ke="/assets/lottie/"+st)||se(j,"src",ke),a(K,"class","flex flex-col w-1/2"),a(h,"class","px-16 flex flex-row justify-center items-center lg:justify-between"),a(u,"class","py-16 opacity-0 transition-opacity duration-500"),a(u,"id","formulation_form"),a(s,"class","")},m(f,I){y&&y.m(ye.head,null),l(ye.head,e),G(f,t,I),G(f,s,I),l(s,u),l(u,h),l(h,r),l(r,m),l(r,_),l(r,b),l(r,V),L&&L.m(r,null),l(r,U),k&&k.m(r,null),l(r,P),E&&E.m(r,null),l(r,R),l(r,M),l(M,w),l(w,B),l(B,A),l(B,Z),l(B,J),l(J,x),ue(x,d[4].email),l(w,$),l(w,q),l(q,i),l(q,N),l(q,ee),l(ee,z),ue(z,d[4].password),l(w,ge),l(w,te),l(te,X),l(w,ve),l(w,F),l(F,re),l(h,be),l(h,K),l(K,Q),O.m(Q,null),l(K,_e),l(K,j),xe||(Ee=[we(x,"input",d[16]),we(z,"input",d[17]),we(M,"submit",We(d[0]))],xe=!0)},p(f,[I]){f[1]&&!window?.hcaptcha?y?y.p(f,I):(y=Be(f),y.c(),y.m(e.parentNode,e)):y&&(y.d(1),y=null),f[2]?L||(L=He(),L.c(),L.m(r,U)):L&&(L.d(1),L=null),f[4].error_message?k?k.p(f,I):(k=Oe(f),k.c(),k.m(r,P)):k&&(k.d(1),k=null),f[4].successful_message?E?E.p(f,I):(E=Ue(f),E.c(),E.m(r,R)):E&&(E.d(1),E=null),I&16&&x.value!==f[4].email&&ue(x,f[4].email),I&16&&z.value!==f[4].password&&ue(z,f[4].password),I&4&&ae!==(ae=f[2]?"Loading...":"Login")&&pe(re,ae),I&4&&(F.disabled=f[2]),ie===(ie=Ce(f))&&O?O.p(f,I):(O.d(1),O=ie(f),O&&(O.c(),O.m(Q,null)))},i:fe,o:fe,d(f){f&&(c(t),c(s)),y&&y.d(f),c(e),L&&L.d(),k&&k.d(),E&&E.d(),O.d(),xe=!1,Ye(Ee)}}}let st="/holydance.lottie";const lt="inline-flex w-full items-center justify-center gap-x-2 rounded-lg px-4 py-1 text-sm font-normal text-blue-400 focus-visible:ring outline-none transition duration-300 py-3",rt="border border-transparent",it="bg-blue-100 dark:focus:outline-none",ot="hover:bg-blue-400 hover:text-white",nt="2xl:text-base",ct="disabled:pointer-events-none disabled:opacity-50 disabled:animate-pulse",dt="ring-zinc-500 dark:ring-zinc-200";function ut(d,e,t){const s=Ge(),u=()=>{t(2,b=!1),t(4,p.successful_message="",p),v&&_&&C&&hcaptcha.reset(C)},h=i=>{if(v&&_&&C)return hcaptcha.execute(C,i)},r=async()=>{if(t(2,b=!0),V=await le.createActionULID("loginUser"),!V){t(4,p.error_message="Failed to create action!",p),u();return}try{const i=await le.loginUser(p.email,p.password,V,p.captchaToken);if(i){t(4,p.successful_message=`Welcome, ${i.username||i.email}! Login successful. Redirecting in 1 second`,p),console.log("User logined and profile saved:",i);const H=await le.getSupabaseClient()?.auth.getSession();H?(console.log("User is already logged in after registration:",H),setTimeout(()=>{window.location.href="/dashboard"},1e3)):setTimeout(()=>{window.location.href="/login#offline"},1e3);return}await m(V)}catch(i){console.error("Login failed:",i),await m(V),u()}finally{t(2,b=!1),u()}},m=async i=>{const H=await le.getErrorByActionId(i);H?t(4,p.error_message=H,p):t(4,p.error_message="An unexpected error occurred. Please try again.",p);const N=await le.getDetailedErrorByActionId(i);N?t(3,U=N):t(4,p.error_message="An unexpected error occurred. Please try again.",p)};let v=!1,_=!1,b=!1,C,V,U,{hl:P=""}=e,{sitekey:R=Pe.get().hcaptcha}=e,{apihost:M=Pe.get().hcaptcha_api}=e,{reCaptchaCompat:w=!0}=e,{theme:B=Ze.DARK}=e,{size:A="compact"}=e,p={email:"",password:"",captchaToken:"",actionId:"",error_message:"",successful_message:""};const Z=new URLSearchParams({recaptchacompat:w?"on":"off",onload:"hcaptchaOnLoad",render:"explicit"}),J=`${M}?${Z.toString()}`,x=Math.floor(Math.random()*100);Je(()=>{$e({elementIdOrName:"skeleton_login_loader",duration:500}),document.getElementById("astro_error_message")&&document.getElementById("astro_error_message");const i=document.getElementById("formulation_form");i&&setTimeout(()=>{i.classList.replace("opacity-0","opacity-100")},200);const H=document.getElementById("loginForm");H&&setTimeout(()=>{H.classList.replace("opacity-0","opacity-100")},500),window.hcaptchaOnLoad=()=>{s("load"),t(15,_=!0)},window.onSuccess=N=>{s("success",{token:N}),t(4,p.captchaToken=N,p)},window.onError=()=>{s("error")},window.onClose=()=>{s("close")},window.onExpired=()=>{s("expired"),u()},s("mount"),t(1,v=!0)}),Qe(()=>{window.hcaptchaOnLoad=null,window.onSuccess=null,_&&(hcaptcha=null)});function $(){p.email=this.value,t(4,p)}function q(){p.password=this.value,t(4,p)}return d.$$set=i=>{"hl"in i&&t(9,P=i.hl),"sitekey"in i&&t(10,R=i.sitekey),"apihost"in i&&t(11,M=i.apihost),"reCaptchaCompat"in i&&t(12,w=i.reCaptchaCompat),"theme"in i&&t(13,B=i.theme),"size"in i&&t(14,A=i.size)},d.$$.update=()=>{d.$$.dirty&58882&&v&&_&&(C=hcaptcha.render(`h-captcha-${x}`,{sitekey:R,hl:P,theme:B,callback:"onSuccess","error-callback":"onError","close-callback":"onClose","expired-callback":"onExpired",size:A}))},[r,v,b,U,p,J,x,u,h,P,R,M,w,B,A,_,$,q]}class wt extends Ne{constructor(e){super(),Fe(this,e,ut,at,Re,{reset:7,execute:8,handleLogin:0,hl:9,sitekey:10,apihost:11,reCaptchaCompat:12,theme:13,size:14})}get reset(){return this.$$.ctx[7]}get execute(){return this.$$.ctx[8]}get handleLogin(){return this.$$.ctx[0]}}export{wt as default};
