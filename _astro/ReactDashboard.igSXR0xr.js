import{j as e,r as p}from"./react.XJQ4OnvF.js";import{u as O,a as S,D as B,r as V,b as $,c as T,C as A,d as w,T as R,P as F}from"./@dnd-kit.CZoI31gw.js";import{a as J,e as j,$ as K}from"./npchandler.B0r6PUz8.js";import{a as L,u as G}from"./@nanostores.kqnvP3SD.js";import{c as y}from"./clsx.B-dksMZM.js";import{t as m}from"./tailwind-merge.B9ugUrge.js";import"./@react-three.DzcfnNYH.js";import"./react-dom.3umP1jIU.js";import"./scheduler.CzFDRTuY.js";import"./@supabase.WhYem7Cd.js";import"./Tabs.astro_astro_type_script_index_0_lang.DXuUnoum.js";import"./dexie.FI_cDWIf.js";import"./nanostores.Bo9-_MAV.js";import"./axios.dxcvQi4N.js";const W=({styleClass:r,size:s=24,color:o="#000",onClick:i,...c})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",width:s,height:s,className:r,onClick:i,...c,children:e.jsx("path",{stroke:o,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 8.5V4m0 0h4.5M4 4l5.5 5.5m10.5-1V4m0 0h-4.5M20 4l-5.5 5.5M4 15.5V20m0 0h4.5M4 20l5.5-5.5m10.5 1V20m0 0h-4.5m4.5 0l-5.5-5.5"})});class q extends J{itemPositionsStore;constructor(){super(),this.itemPositionsStore=L("dashboardItemPositions",{},{encode:JSON.stringify,decode:JSON.parse})}saveItemPositions(s){this.itemPositionsStore.set(s),console.log("Item positions saved to DashboardBase:",s)}loadItemPositions(){const s=this.itemPositionsStore.get();return console.log("Item positions loaded from DashboardBase:",s),s||{}}}const b=new q,D=m("p-5 border-gray-200 dark:text-neutral-200 rounded-md","w-full md:w-1/4","flex flex-col items-center"),H=m("flex flex-wrap flex-grow bg-gray-500 p-5 rounded-md","w-full md:w-3/4"),Q=({title:r,isVisible:s,onClose:o})=>s?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-5 rounded shadow-lg w-96",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:r}),e.jsxs("p",{className:"mb-4",children:["This is the content of the modal for item ",r,"."]}),e.jsx("button",{className:"bg-cyan-500 text-gray-500 py-2 px-4 rounded hover:bg-cyan-600",onClick:o,children:"Close"})]})}):null,N=({id:r,onExpandClick:s})=>{const{attributes:o,listeners:i,setNodeRef:c,transform:h,isDragging:x}=T({id:r}),g={transform:A.Translate.toString(h)};return e.jsxs("div",{ref:c,className:m("p-3 border border-cyan-500 rounded-md m-2 cursor-grab bg-cyan-300 dark:text-neutral-600 flex items-center justify-between",y({"opacity-50":x})),style:g,...i,...o,children:[r,e.jsx("button",{onClick:s,className:"ml-2 p-2 rounded-full bg-gray-200 hover:bg-gray-300",children:e.jsx(W,{className:"w-4 h-4 text-gray-800 dark:text-gray-200"})})]})},U=({id:r,children:s})=>{const{setNodeRef:o,isOver:i}=w({id:r});return e.jsxs("div",{ref:o,className:m("p-5 border-dashed border-2 border-gray-300 rounded-md m-3 min-h-[150px]","w-full sm:w-[45%] md:w-[30%]",y({"bg-cyan-100":i,"bg-white":!i})),children:[e.jsx("h3",{className:m("font-bold mb-3"),children:r}),s]})},X=({id:r,children:s})=>{const{setNodeRef:o,isOver:i}=w({id:r}),c=G(K);return e.jsxs("div",{ref:o,className:m(D,"border-2 border-dashed border-gray-400",y({"bg-cyan-500":i})),children:[e.jsx("h3",{className:m("font-bold text-xl mb-4"),children:`${c.username}'s Inventory`}),s]})},Y=({items:r,onItemExpandClick:s})=>e.jsxs("div",{className:D,children:[e.jsx("h3",{className:m("font-bold text-xl mb-4"),children:"Available Items"}),r.map(o=>e.jsx(N,{id:o,onExpandClick:()=>s(o)},o))]}),Z=({containers:r})=>{const[s,o]=p.useState({}),[i,c]=p.useState(["Item 1","Item 2","Item 3","Function","IGBC"]),[h,x]=p.useState(null),[g,v]=p.useState(!1),[C,P]=p.useState(""),M=O(S(F,{activationConstraint:{distance:5}}),S(R,{activationConstraint:{delay:100,tolerance:5}}));p.useEffect(()=>{(async()=>{try{const t=await b.loadProfile();console.log(`Data: ${t}`)}catch(t){console.error("Error loading profile or item positions:",t)}})()},[]),p.useEffect(()=>{const a=b.loadItemPositions();o(a);const t=new Set(Object.values(a).flatMap(u=>u.map(l=>l.id)));c(u=>u.filter(l=>!t.has(l)))},[]);const I=a=>{j.emit("openModal",{message:`Modal for ${a}`})};p.useEffect(()=>{const a=t=>{t&&P(t.message),v(!0)};return j.on("openModal",a),()=>{j.off("openModal",a)}},[]);const k=async a=>{const{active:t,over:u}=a;if(!u){x(null);return}const l=Object.keys(s).find(n=>s[n]?.some(d=>d.id===t.id)),f=u.id;if(f==="sidebar")i.includes(t.id)||c(n=>[...n,t.id]),l&&o(n=>{const d={...n,[l]:n[l].filter(E=>E.id!==t.id)};return b.saveItemPositions(d),d});else if(!l)c(n=>n.filter(d=>d!==t.id)),o(n=>{const d={...n,[f]:[...n[f]||[],{id:t.id,container:f}]};return b.saveItemPositions(d),d});else if(l!==f){const n={...s,[l]:s[l].filter(d=>d.id!==t.id),[f]:[...s[f]||[],{id:t.id,container:f}]};o(n),b.saveItemPositions(n)}x(null)};return e.jsxs(B,{sensors:M,collisionDetection:V,onDragStart:a=>x(a.active.id),onDragEnd:k,children:[e.jsxs("div",{className:m("flex flex-col md:flex-row"),children:[e.jsx(X,{id:"sidebar",children:e.jsx(Y,{items:i,onItemExpandClick:I})}),e.jsx("div",{className:H,children:r.map(a=>e.jsx(U,{id:a,children:s[a]?.map(t=>e.jsx(N,{id:t.id,onExpandClick:()=>I(t.id)},t.id))},a))})]}),e.jsx($,{children:h?e.jsx("div",{children:h}):null}),e.jsx(Q,{title:C,isVisible:g,onClose:()=>v(!1)})]})},fe=()=>e.jsx(Z,{containers:["Deploy","B","C","D","E","F","Kill"]});export{fe as default};
