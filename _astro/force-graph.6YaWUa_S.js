import{t as L,z as vn}from"./d3-zoom.B5IvJ505.js";import{G as mn,T as X,E as Y}from"./@tweenjs.Ddm5d4jd.js";import{i as un}from"./kapsule.DoQQNCoE.js";import{i as m}from"./accessor-fn.DXlyMOTY.js";import{_ as yn}from"./canvas-color-tracker.BPG-3Xnv.js";import{B as Q}from"./bezier-js.4W2y2lww.js";import{i as bn}from"./index-array-by.D2QHmuxS.js";import{s as J}from"./d3-selection.DSeOx27A.js";import{a as Cn}from"./d3-drag.DP3CZ3aB.js";import{t as wn}from"./lodash-es.BFDc8I3u.js";import{f as kn,a as xn,b as _n,c as Pn,d as Dn}from"./d3-force-3d.B-Z8vgRJ.js";import{o as On}from"./d3-scale.Btia-9_0.js";import{s as Rn}from"./d3-scale-chromatic.BvAsqZ2o.js";import{m as nn,a as en}from"./d3-array.tv6RD-6E.js";function En(r,n){n===void 0&&(n={});var e=n.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e==="top"&&i.firstChild?i.insertBefore(t,i.firstChild):i.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}}var An=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .graph-tooltip {
  position: absolute;
  top: 0;
  font-family: sans-serif;
  font-size: 16px;
  padding: 4px;
  border-radius: 3px;
  color: #eee;
  background: rgba(0,0,0,0.65);
  visibility: hidden; /* by default */
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;En(An);function H(r,n){(n==null||n>r.length)&&(n=r.length);for(var e=0,i=Array(n);e<n;e++)i[e]=r[e];return i}function Un(r){if(Array.isArray(r))return r}function Mn(r){if(Array.isArray(r))return H(r)}function rn(r,n,e){if(cn())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,n);var t=new(r.bind.apply(r,i));return t}function G(r,n,e){return(n=zn(n))in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}function cn(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cn=function(){return!!r})()}function Sn(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ln(r,n){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var i,t,c,f,l=[],p=!0,h=!1;try{if(c=(e=e.call(r)).next,n!==0)for(;!(p=(i=c.call(e)).done)&&(l.push(i.value),l.length!==n);p=!0);}catch(y){h=!0,t=y}finally{try{if(!p&&e.return!=null&&(f=e.return(),Object(f)!==f))return}finally{if(h)throw t}}return l}}function Tn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function on(r,n){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);n&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})),e.push.apply(e,i)}return e}function z(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?on(Object(e),!0).forEach(function(i){G(r,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):on(Object(e)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(e,i))})}return r}function F(r,n){return Un(r)||Ln(r,n)||dn(r,n)||Tn()}function E(r){return Mn(r)||Sn(r)||dn(r)||jn()}function In(r,n){if(typeof r!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var i=e.call(r,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function zn(r){var n=In(r,"string");return typeof n=="symbol"?n:n+""}function W(r){"@babel/helpers - typeof";return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},W(r)}function dn(r,n){if(r){if(typeof r=="string")return H(r,n);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?H(r,n):void 0}}var Fn=On(Rn);function an(r,n,e){!n||typeof e!="string"||r.filter(function(i){return!i[e]}).forEach(function(i){i[e]=Fn(n(i))})}function Gn(r,n){var e=r.nodes,i=r.links,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=t.nodeFilter,f=c===void 0?function(){return!0}:c,l=t.onLoopError,p=l===void 0?function(o){throw"Invalid DAG structure! Found cycle in node path: ".concat(o.join(" -> "),".")}:l,h={};e.forEach(function(o){return h[n(o)]={data:o,out:[],depth:-1,skip:!f(o)}}),i.forEach(function(o){var d=o.source,g=o.target,s=x(d),v=x(g);if(!h.hasOwnProperty(s))throw"Missing source node with id: ".concat(s);if(!h.hasOwnProperty(v))throw"Missing target node with id: ".concat(v);var w=h[s],O=h[v];w.out.push(O);function x(P){return W(P)==="object"?n(P):P}});var y=[];a(Object.values(h));var u=Object.assign.apply(Object,[{}].concat(E(Object.entries(h).filter(function(o){var d=F(o,2),g=d[1];return!g.skip}).map(function(o){var d=F(o,2),g=d[0],s=d[1];return G({},g,s.depth)}))));return u;function a(o){for(var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=function(){var x=o[v];if(d.indexOf(x)!==-1){var P=[].concat(E(d.slice(d.indexOf(x))),[x]).map(function(A){return n(A.data)});return y.some(function(A){return A.length===P.length&&A.every(function(b,C){return b===P[C]})})||(y.push(P),p(P)),1}g>x.depth&&(x.depth=g,a(x.out,[].concat(E(d),[x]),g+(x.skip?0:1)))},v=0,w=o.length;v<w;v++)s()}}var Nn=2,D=function(n,e){return e.onNeedsRedraw&&e.onNeedsRedraw()},tn=function(n,e){if(!e.isShadow){var i=m(e.linkDirectionalParticles);e.graphData.links.forEach(function(t){var c=Math.round(Math.abs(i(t)));c?t.__photons=E(Array(c)).map(function(){return{}}):delete t.__photons})}},B=un({props:{graphData:{default:{nodes:[],links:[]},onChange:function(n,e){e.engineRunning=!1,tn(n,e)}},dagMode:{onChange:function(n,e){!n&&(e.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:D},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:D},nodeColor:{default:"color",triggerUpdate:!1,onChange:D},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:D},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:D},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:D},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:D},linkColor:{default:"color",triggerUpdate:!1,onChange:D},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:D},linkWidth:{default:1,triggerUpdate:!1,onChange:D},linkCurvature:{default:0,triggerUpdate:!1,onChange:D},linkCanvasObject:{triggerUpdate:!1,onChange:D},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:D},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:D},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:D},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:D},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:tn},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,e){e.forceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,e){e.forceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,e){e.forceLayout.velocityDecay(n)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(n,e,i){return i===void 0?n.forceLayout.force(e):(n.forceLayout.force(e,i),this)},d3ReheatSimulation:function(n){return n.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},isEngineRunning:function(n){return!!n.engineRunning},tickFrame:function(n){return!n.isShadow&&e(),t(),!n.isShadow&&c(),!n.isShadow&&f(),i(),this;function e(){n.engineRunning&&(++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.forceLayout.tick(),n.onEngineTick()))}function i(){var l=m(n.nodeVisibility),p=m(n.nodeVal),h=m(n.nodeColor),y=m(n.nodeCanvasObjectMode),u=n.ctx,a=n.isShadow/n.globalScale,o=n.graphData.nodes.filter(l);u.save(),o.forEach(function(d){var g=y(d);if(n.nodeCanvasObject&&(g==="before"||g==="replace")&&(n.nodeCanvasObject(d,u,n.globalScale),g==="replace")){u.restore();return}var s=Math.sqrt(Math.max(0,p(d)||1))*n.nodeRelSize+a;u.beginPath(),u.arc(d.x,d.y,s,0,2*Math.PI,!1),u.fillStyle=h(d)||"rgba(31, 120, 180, 0.92)",u.fill(),n.nodeCanvasObject&&g==="after"&&n.nodeCanvasObject(d,n.ctx,n.globalScale)}),u.restore()}function t(){var l=m(n.linkVisibility),p=m(n.linkColor),h=m(n.linkWidth),y=m(n.linkLineDash),u=m(n.linkCurvature),a=m(n.linkCanvasObjectMode),o=n.ctx,d=n.isShadow*2,g=n.graphData.links.filter(l);g.forEach(A);var s=[],v=[],w=g;if(n.linkCanvasObject){var O=[],x=[];g.forEach(function(b){return({before:s,after:v,replace:O}[a(b)]||x).push(b)}),w=[].concat(E(s),v,x),s=s.concat(O)}o.save(),s.forEach(function(b){return n.linkCanvasObject(b,o,n.globalScale)}),o.restore();var P=bn(w,[p,h,y]);o.save(),Object.entries(P).forEach(function(b){var C=F(b,2),_=C[0],k=C[1],U=!_||_==="undefined"?"rgba(0,0,0,0.15)":_;Object.entries(k).forEach(function(M){var R=F(M,2),T=R[0],S=R[1],j=(T||1)/n.globalScale+d;Object.entries(S).forEach(function(hn){var $=F(hn,2);$[0];var K=$[1],pn=y(K[0]);o.beginPath(),K.forEach(function(V){var N=V.source,I=V.target;if(!(!N||!I||!N.hasOwnProperty("x")||!I.hasOwnProperty("x"))){o.moveTo(N.x,N.y);var Z=V.__controlPoints;Z?o[Z.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(o,E(Z).concat([I.x,I.y])):o.lineTo(I.x,I.y)}}),o.strokeStyle=U,o.lineWidth=j,o.setLineDash(pn||[]),o.stroke()})})}),o.restore(),o.save(),v.forEach(function(b){return n.linkCanvasObject(b,o,n.globalScale)}),o.restore();function A(b){var C=u(b);if(!C){b.__controlPoints=null;return}var _=b.source,k=b.target;if(!(!_||!k||!_.hasOwnProperty("x")||!k.hasOwnProperty("x"))){var U=Math.sqrt(Math.pow(k.x-_.x,2)+Math.pow(k.y-_.y,2));if(U>0){var M=Math.atan2(k.y-_.y,k.x-_.x),R=U*C,T={x:(_.x+k.x)/2+R*Math.cos(M-Math.PI/2),y:(_.y+k.y)/2+R*Math.sin(M-Math.PI/2)};b.__controlPoints=[T.x,T.y]}else{var S=C*70;b.__controlPoints=[k.x,k.y-S,k.x+S,k.y]}}}}function c(){var l=1.6,p=.2,h=m(n.linkDirectionalArrowLength),y=m(n.linkDirectionalArrowRelPos),u=m(n.linkVisibility),a=m(n.linkDirectionalArrowColor||n.linkColor),o=m(n.nodeVal),d=n.ctx;d.save(),n.graphData.links.filter(u).forEach(function(g){var s=h(g);if(!(!s||s<0)){var v=g.source,w=g.target;if(!(!v||!w||!v.hasOwnProperty("x")||!w.hasOwnProperty("x"))){var O=Math.sqrt(Math.max(0,o(v)||1))*n.nodeRelSize,x=Math.sqrt(Math.max(0,o(w)||1))*n.nodeRelSize,P=Math.min(1,Math.max(0,y(g))),A=a(g)||"rgba(0,0,0,0.28)",b=s/l/2,C=g.__controlPoints&&rn(Q,[v.x,v.y].concat(E(g.__controlPoints),[w.x,w.y])),_=C?function(j){return C.get(j)}:function(j){return{x:v.x+(w.x-v.x)*j||0,y:v.y+(w.y-v.y)*j||0}},k=C?C.length():Math.sqrt(Math.pow(w.x-v.x,2)+Math.pow(w.y-v.y,2)),U=O+s+(k-O-x-s)*P,M=_(U/k),R=_((U-s)/k),T=_((U-s*(1-p))/k),S=Math.atan2(M.y-R.y,M.x-R.x)-Math.PI/2;d.beginPath(),d.moveTo(M.x,M.y),d.lineTo(R.x+b*Math.cos(S),R.y+b*Math.sin(S)),d.lineTo(T.x,T.y),d.lineTo(R.x-b*Math.cos(S),R.y-b*Math.sin(S)),d.fillStyle=A,d.fill()}}}),d.restore()}function f(){var l=m(n.linkDirectionalParticles),p=m(n.linkDirectionalParticleSpeed),h=m(n.linkDirectionalParticleWidth),y=m(n.linkVisibility),u=m(n.linkDirectionalParticleColor||n.linkColor),a=n.ctx;a.save(),n.graphData.links.filter(y).forEach(function(o){var d=l(o);if(!(!o.hasOwnProperty("__photons")||!o.__photons.length)){var g=o.source,s=o.target;if(!(!g||!s||!g.hasOwnProperty("x")||!s.hasOwnProperty("x"))){var v=p(o),w=o.__photons||[],O=Math.max(0,h(o)/2)/Math.sqrt(n.globalScale),x=u(o)||"rgba(0,0,0,0.28)";a.fillStyle=x;var P=o.__controlPoints?rn(Q,[g.x,g.y].concat(E(o.__controlPoints),[s.x,s.y])):null,A=0,b=!1;w.forEach(function(C){var _=!!C.__singleHop;if(C.hasOwnProperty("__progressRatio")||(C.__progressRatio=_?0:A/d),!_&&A++,C.__progressRatio+=v,C.__progressRatio>=1)if(!_)C.__progressRatio=C.__progressRatio%1;else{b=!0;return}var k=C.__progressRatio,U=P?P.get(k):{x:g.x+(s.x-g.x)*k||0,y:g.y+(s.y-g.y)*k||0};a.beginPath(),a.arc(U.x,U.y,O,0,2*Math.PI,!1),a.fill()}),b&&(o.__photons=o.__photons.filter(function(C){return!C.__singleHop||C.__progressRatio<=1}))}}}),a.restore()}},emitParticle:function(n,e){return e&&(!e.__photons&&(e.__photons=[]),e.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:xn().force("link",_n()).force("charge",Pn()).force("center",Dn()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,e){e.ctx=n},update:function(n,e){n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&an(n.graphData.nodes,m(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&an(n.graphData.links,m(n.linkAutoColorBy),n.linkColor),n.graphData.links.forEach(function(a){a.source=a[n.linkSource],a.target=a[n.linkTarget]}),n.forceLayout.stop().alpha(1).nodes(n.graphData.nodes);var i=n.forceLayout.force("link");i&&i.id(function(a){return a[n.nodeId]}).links(n.graphData.links);var t=n.dagMode&&Gn(n.graphData,function(a){return a[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),c=Math.max.apply(Math,E(Object.values(t||[]))),f=n.dagLevelDistance||n.graphData.nodes.length/(c||1)*Nn*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(e.dagMode)){var l=["lr","rl"].includes(e.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(a){return delete a[l]})}if(["lr","rl","td","bu"].includes(n.dagMode)){var p=["rl","bu"].includes(n.dagMode),h=function(o){return(t[o[n.nodeId]]-c/2)*f*(p?-1:1)},y=["lr","rl"].includes(n.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(a){return a[y]=h(a)})}n.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?kn(function(a){var o=t[a[n.nodeId]]||-1;return(n.dagMode==="radialin"?c-o:o)*f}).strength(function(a){return n.dagNodeFilter(a)?1:0}):null);for(var u=0;u<n.warmupTicks&&!(n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin);u++)n.forceLayout.tick();this.resetCountdown(),n.onFinishUpdate()}});function fn(r,n){var e=r instanceof Array?r:[r],i=new n;return i._destructor&&i._destructor(),{linkProp:function(c){return{default:i[c](),onChange:function(l,p){e.forEach(function(h){return p[h][c](l)})},triggerUpdate:!1}},linkMethod:function(c){return function(f){for(var l=arguments.length,p=new Array(l>1?l-1:0),h=1;h<l;h++)p[h-1]=arguments[h];var y=[];return e.forEach(function(u){var a=f[u],o=a[c].apply(a,p);o!==a&&y.push(o)}),y.length?y[0]:this}}}}var Bn=800,Vn=4,gn=fn("forceGraph",B),Zn=fn(["forceGraph","shadowGraph"],B),qn=Object.assign.apply(Object,E(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return G({},r,gn.linkProp(r))})).concat(E(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return G({},r,Zn.linkProp(r))})))),Hn=Object.assign.apply(Object,E(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return G({},r,gn.linkMethod(r))})));function q(r){if(r.canvas){var n=r.canvas.width,e=r.canvas.height;n===300&&e===150&&(n=e=0);var i=window.devicePixelRatio;n/=i,e/=i,[r.canvas,r.shadowCanvas].forEach(function(c){c.style.width="".concat(r.width,"px"),c.style.height="".concat(r.height,"px"),c.width=r.width*i,c.height=r.height*i,!n&&!e&&c.getContext("2d").scale(i,i)});var t=L(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-n)/2/t,(r.height-e)/2/t),r.needsRedraw=!0}}function sn(r){var n=window.devicePixelRatio;r.setTransform(n,0,0,n,0,0)}function ln(r,n,e){r.save(),sn(r),r.clearRect(0,0,n,e),r.restore()}var le=un({props:z({width:{default:window.innerWidth,onChange:function(n,e){return q(e)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(n,e){return q(e)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,e){[n.nodes,n.links].every(function(t){return(t||[]).every(function(c){return!c.hasOwnProperty("__indexColor")})})&&e.colorTracker.reset(),[{type:"Node",objs:n.nodes},{type:"Link",objs:n.links}].forEach(i),e.forceGraph.graphData(n),e.shadowGraph.graphData(n);function i(t){var c=t.type,f=t.objs;f.filter(function(l){if(!l.hasOwnProperty("__indexColor"))return!0;var p=e.colorTracker.lookup(l.__indexColor);return!p||!p.hasOwnProperty("d")||p.d!==l}).forEach(function(l){l.__indexColor=e.colorTracker.register({type:c,d:l})})}},triggerUpdate:!1},backgroundColor:{onChange:function(n,e){e.canvas&&n&&(e.canvas.style.background=n)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(n,e){e.shadowGraph.nodeCanvasObject(n?function(i,t,c){return n(i,i.__indexColor,t,c)}:null),e.flushShadowCanvas&&e.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(n,e){e.shadowGraph.linkCanvasObject(n?function(i,t,c){return n(i,i.__indexColor,t,c)}:null),e.flushShadowCanvas&&e.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(n,e){e.zoom.scaleExtent([n,e.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(n,e){e.zoom.scaleExtent([e.zoom.scaleExtent()[0],n])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(n,e){e.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},qn),aliases:{stopAnimation:"pauseAnimation"},methods:z({graph2ScreenCoords:function(n,e,i){var t=L(n.canvas);return{x:e*t.k+t.x,y:i*t.k+t.y}},screen2GraphCoords:function(n,e,i){var t=L(n.canvas);return{x:(e-t.x)/t.k,y:(i-t.y)/t.k}},centerAt:function(n,e,i,t){if(!n.canvas)return null;if(e!==void 0||i!==void 0){var c=Object.assign({},e!==void 0?{x:e}:{},i!==void 0?{y:i}:{});return t?n.tweenGroup.add(new X(f()).to(c,t).easing(Y.Quadratic.Out).onUpdate(l).start()):l(c),this}return f();function f(){var p=L(n.canvas);return{x:(n.width/2-p.x)/p.k,y:(n.height/2-p.y)/p.k}}function l(p){var h=p.x,y=p.y;n.zoom.translateTo(n.zoom.__baseElem,h===void 0?f().x:h,y===void 0?f().y:y),n.needsRedraw=!0}},zoom:function(n,e,i){if(!n.canvas)return null;if(e!==void 0)return i?n.tweenGroup.add(new X({k:t()}).to({k:e},i).easing(Y.Quadratic.Out).onUpdate(function(f){var l=f.k;return c(l)}).start()):c(e),this;return t();function t(){return L(n.canvas).k}function c(f){n.zoom.scaleTo(n.zoom.__baseElem,f),n.needsRedraw=!0}},zoomToFit:function(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,t=arguments.length,c=new Array(t>3?t-3:0),f=3;f<t;f++)c[f-3]=arguments[f];var l=this.getGraphBbox.apply(this,c);if(l){var p={x:(l.x[0]+l.x[1])/2,y:(l.y[0]+l.y[1])/2},h=Math.max(1e-12,Math.min(1e12,(n.width-i*2)/(l.x[1]-l.x[0]),(n.height-i*2)/(l.y[1]-l.y[0])));this.centerAt(p.x,p.y,e),this.zoom(h,e)}return this},getGraphBbox:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=m(n.nodeVal),t=function(l){return Math.sqrt(Math.max(0,i(l)||1))*n.nodeRelSize},c=n.graphData.nodes.filter(e).map(function(f){return{x:f.x,y:f.y,r:t(f)}});return c.length?{x:[nn(c,function(f){return f.x-f.r}),en(c,function(f){return f.x+f.r})],y:[nn(c,function(f){return f.y-f.r}),en(c,function(f){return f.y+f.r})]}:null},pauseAnimation:function(n){return n.animationFrameRequestId&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},Hn),stateInit:function(){return{lastSetZoom:1,zoom:vn(),forceGraph:new B,shadowGraph:new B().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new yn,tweenGroup:new mn}},init:function(n,e){var i=this;n.innerHTML="";var t=document.createElement("div");t.classList.add("force-graph-container"),t.style.position="relative",n.appendChild(t),e.canvas=document.createElement("canvas"),e.backgroundColor&&(e.canvas.style.background=e.backgroundColor),t.appendChild(e.canvas),e.shadowCanvas=document.createElement("canvas");var c=e.canvas.getContext("2d"),f=e.shadowCanvas.getContext("2d",{willReadFrequently:!0}),l={x:-1e12,y:-1e12},p=function(){var a=null,o=window.devicePixelRatio,d=l.x>0&&l.y>0?f.getImageData(l.x*o,l.y*o,1,1):null;return d&&(a=e.colorTracker.lookup(d.data)),a};J(e.canvas).call(Cn().subject(function(){if(!e.enableNodeDrag)return null;var u=p();return u&&u.type==="Node"?u.d:null}).on("start",function(u){var a=u.subject;a.__initialDragPos={x:a.x,y:a.y,fx:a.fx,fy:a.fy},u.active||(a.fx=a.x,a.fy=a.y),e.canvas.classList.add("grabbable")}).on("drag",function(u){var a=u.subject,o=a.__initialDragPos,d=u,g=L(e.canvas).k,s={x:o.x+(d.x-o.x)/g-a.x,y:o.y+(d.y-o.y)/g-a.y};["x","y"].forEach(function(v){return a["f".concat(v)]=a[v]=o[v]+(d[v]-o[v])/g}),e.forceGraph.d3AlphaTarget(.3).resetCountdown(),e.isPointerDragging=!0,a.__dragged=!0,e.onNodeDrag(a,s)}).on("end",function(u){var a=u.subject,o=a.__initialDragPos,d={x:a.x-o.x,y:a.y-o.y};o.fx===void 0&&(a.fx=void 0),o.fy===void 0&&(a.fy=void 0),delete a.__initialDragPos,e.forceGraph.d3AlphaTarget()&&e.forceGraph.d3AlphaTarget(0).resetCountdown(),e.canvas.classList.remove("grabbable"),e.isPointerDragging=!1,a.__dragged&&(delete a.__dragged,e.onNodeDragEnd(a,d))})),e.zoom(e.zoom.__baseElem=J(e.canvas)),e.zoom.__baseElem.on("dblclick.zoom",null),e.zoom.filter(function(u){return!u.button&&e.enableZoomPanInteraction&&(e.enableZoomInteraction||u.type!=="wheel")&&(e.enablePanInteraction||u.type==="wheel")}).on("zoom",function(u){var a=u.transform;[c,f].forEach(function(o){sn(o),o.translate(a.x,a.y),o.scale(a.k,a.k)}),e.onZoom&&e.onZoom(z(z({},a),i.centerAt())),e.needsRedraw=!0}).on("end",function(u){return e.onZoomEnd&&e.onZoomEnd(z(z({},u.transform),i.centerAt()))}),q(e),e.forceGraph.onNeedsRedraw(function(){return e.needsRedraw=!0}).onFinishUpdate(function(){L(e.canvas).k===e.lastSetZoom&&e.graphData.nodes.length&&(e.zoom.scaleTo(e.zoom.__baseElem,e.lastSetZoom=Vn/Math.cbrt(e.graphData.nodes.length)),e.needsRedraw=!0)});var h=document.createElement("div");h.classList.add("graph-tooltip"),t.appendChild(h),["pointermove","pointerdown"].forEach(function(u){return t.addEventListener(u,function(a){u==="pointerdown"&&(e.isPointerPressed=!0,e.pointerDownEvent=a),!e.isPointerDragging&&a.type==="pointermove"&&e.onBackgroundClick&&(a.pressure>0||e.isPointerPressed)&&(a.pointerType!=="touch"||a.movementX===void 0||[a.movementX,a.movementY].some(function(g){return Math.abs(g)>1}))&&(e.isPointerDragging=!0);var o=d(t);l.x=a.pageX-o.left,l.y=a.pageY-o.top,h.style.top="".concat(l.y,"px"),h.style.left="".concat(l.x,"px"),h.style.transform="translate(-".concat(l.x/e.width*100,"%, ").concat(e.height-l.y<100?"calc(-100% - 8px)":"21px",")");function d(g){var s=g.getBoundingClientRect(),v=window.pageXOffset||document.documentElement.scrollLeft,w=window.pageYOffset||document.documentElement.scrollTop;return{top:s.top+w,left:s.left+v}}},{passive:!0})}),t.addEventListener("pointerup",function(u){if(e.isPointerPressed=!1,e.isPointerDragging){e.isPointerDragging=!1;return}var a=[u,e.pointerDownEvent];requestAnimationFrame(function(){if(u.button===0)if(e.hoverObj){var o=e["on".concat(e.hoverObj.type,"Click")];o&&o.apply(void 0,[e.hoverObj.d].concat(a))}else e.onBackgroundClick&&e.onBackgroundClick.apply(e,a);if(u.button===2)if(e.hoverObj){var d=e["on".concat(e.hoverObj.type,"RightClick")];d&&d.apply(void 0,[e.hoverObj.d].concat(a))}else e.onBackgroundRightClick&&e.onBackgroundRightClick.apply(e,a)})},{passive:!0}),t.addEventListener("contextmenu",function(u){return!e.onBackgroundRightClick&&!e.onNodeRightClick&&!e.onLinkRightClick?!0:(u.preventDefault(),!1)}),e.forceGraph(c),e.shadowGraph(f);var y=wn(function(){ln(f,e.width,e.height),e.shadowGraph.linkWidth(function(a){return m(e.linkWidth)(a)+e.linkHoverPrecision});var u=L(e.canvas);e.shadowGraph.globalScale(u.k).tickFrame()},Bn);e.flushShadowCanvas=y.flush,(this._animationCycle=function u(){var a=!e.autoPauseRedraw||!!e.needsRedraw||e.forceGraph.isEngineRunning()||e.graphData.links.some(function(P){return P.__photons&&P.__photons.length});if(e.needsRedraw=!1,e.enablePointerInteraction){var o=e.isPointerDragging?null:p();if(o!==e.hoverObj){var d=e.hoverObj,g=d?d.type:null,s=o?o.type:null;if(g&&g!==s){var v=e["on".concat(g,"Hover")];v&&v(null,d.d)}if(s){var w=e["on".concat(s,"Hover")];w&&w(o.d,g===s?d.d:null)}var O=o&&m(e["".concat(o.type.toLowerCase(),"Label")])(o.d)||"";h.style.visibility=O?"visible":"hidden",h.innerHTML=O,e.canvas.classList[o&&e["on".concat(s,"Click")]||!o&&e.onBackgroundClick?"add":"remove"]("clickable"),e.hoverObj=o}a&&y()}if(a){ln(c,e.width,e.height);var x=L(e.canvas).k;e.onRenderFramePre&&e.onRenderFramePre(c,x),e.forceGraph.globalScale(x).tickFrame(),e.onRenderFramePost&&e.onRenderFramePost(c,x)}e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(u)})()},update:function(n){}});export{le as f};
