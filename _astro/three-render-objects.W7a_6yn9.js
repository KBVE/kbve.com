import{S as j,C as S,j as O,k as L,l as M,m as I,n as B,W as A,o as _,E as U,p as D,F as G,O as z,q as V,c as F,r as N,P as W,s as H,t as $,V as Q,b as X}from"./three.BMLrZlci.js";import{p as q,c as Y}from"./polished.gGQlsDnk.js";import{G as K,T as x,E as k}from"./@tweenjs.Ddm5d4jd.js";import{i as J}from"./accessor-fn.DXlyMOTY.js";import{i as Z}from"./kapsule.DoQQNCoE.js";function ee(r,n){n===void 0&&(n={});var e=n.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e==="top"&&i.firstChild?i.insertBefore(t,i.firstChild):i.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}}var ne=`.scene-nav-info {
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
}

.scene-tooltip {
  top: 0;
  color: lavender;
  font-size: 15px;
}

.scene-nav-info, .scene-tooltip {
  position: absolute;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;ee(ne);function C(r,n){(n==null||n>r.length)&&(n=r.length);for(var e=0,i=Array(n);e<n;e++)i[e]=r[e];return i}function re(r){if(Array.isArray(r))return r}function oe(r){if(Array.isArray(r))return C(r)}function ie(r,n,e){return(n=se(n))in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}function te(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ae(r,n){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var i,t,o,l,s=[],f=!0,p=!1;try{if(o=(e=e.call(r)).next,n!==0)for(;!(f=(i=o.call(e)).done)&&(s.push(i.value),s.length!==n);f=!0);}catch(m){p=!0,t=m}finally{try{if(!f&&e.return!=null&&(l=e.return(),Object(l)!==l))return}finally{if(p)throw t}}return s}}function ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function le(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ue(r,n){return re(r)||ae(r,n)||E(r,n)||ce()}function v(r){return oe(r)||te(r)||E(r)||le()}function de(r,n){if(typeof r!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var i=e.call(r,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function se(r){var n=de(r,"string");return typeof n=="symbol"?n:n+""}function E(r,n){if(r){if(typeof r=="string")return C(r,n);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?C(r,n):void 0}}var c=window.THREE?window.THREE:{WebGLRenderer:_,Scene:H,PerspectiveCamera:W,Raycaster:$,SRGBColorSpace:L,TextureLoader:O,Vector2:B,Vector3:Q,Box3:X,Color:S,Mesh:F,SphereGeometry:j,MeshBasicMaterial:M,BackSide:I,Clock:N},ye=Z({props:{width:{default:window.innerWidth,onChange:function(n,e,i){isNaN(n)&&(e.width=i)}},height:{default:window.innerHeight,onChange:function(n,e,i){isNaN(n)&&(e.height=i)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(n,e){e.hoverObj=null,e.toolTipElem&&(e.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(n){if(n.initialised){if(n.controls.update&&n.controls.update(Math.min(1,n.clock.getDelta())),n.postProcessingComposer?n.postProcessingComposer.render():n.renderer.render(n.scene,n.camera),n.extraRenderers.forEach(function(o){return o.render(n.scene,n.camera)}),n.enablePointerInteraction){var e=null;if(n.hoverDuringDrag||!n.isPointerDragging){var i=this.intersectingObjects(n.pointerPos.x,n.pointerPos.y).filter(function(o){return n.hoverFilter(o.object)}).sort(function(o,l){return n.hoverOrderComparator(o.object,l.object)}),t=i.length?i[0]:null;e=t?t.object:null,n.intersectionPoint=t?t.point:null}e!==n.hoverObj&&(n.onHover(e,n.hoverObj),n.toolTipElem.innerHTML=e&&J(n.tooltipContent)(e)||"",n.hoverObj=e)}n.tweenGroup.update()}return this},getPointerPos:function(n){var e=n.pointerPos,i=e.x,t=e.y;return{x:i,y:t}},cameraPosition:function(n,e,i,t){var o=n.camera;if(e&&n.initialised){var l=e,s=i||{x:0,y:0,z:0};if(!t)m(l),g(s);else{var f=Object.assign({},o.position),p=h();n.tweenGroup.add(new x(f).to(l,t).easing(k.Quadratic.Out).onUpdate(m).start()),n.tweenGroup.add(new x(p).to(s,t/3).easing(k.Quadratic.Out).onUpdate(g).start())}return this}return Object.assign({},o.position,{lookAt:h()});function m(d){var a=d.x,u=d.y,y=d.z;a!==void 0&&(o.position.x=a),u!==void 0&&(o.position.y=u),y!==void 0&&(o.position.z=y)}function g(d){var a=new c.Vector3(d.x,d.y,d.z);n.controls.target?n.controls.target=a:o.lookAt(a)}function h(){return Object.assign(new c.Vector3(0,0,-1e3).applyQuaternion(o.quaternion).add(o.position))}},zoomToFit:function(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,t=arguments.length,o=new Array(t>3?t-3:0),l=3;l<t;l++)o[l-3]=arguments[l];return this.fitToBbox(this.getBbox.apply(this,o),e,i)},fitToBbox:function(n,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,o=n.camera;if(e){var l=new c.Vector3(0,0,0),s=Math.max.apply(Math,v(Object.entries(e).map(function(d){var a=ue(d,2),u=a[0],y=a[1];return Math.max.apply(Math,v(y.map(function(b){return Math.abs(l[u]-b)})))})))*2,f=(1-t*2/n.height)*o.fov,p=s/Math.atan(f*Math.PI/180),m=p/o.aspect,g=Math.max(p,m);if(g>0){var h=l.clone().sub(o.position).normalize().multiplyScalar(-g);this.cameraPosition(h,l,i)}}return this},getBbox:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=new c.Box3(new c.Vector3(0,0,0),new c.Vector3(0,0,0)),t=n.objects.filter(e);return t.length?(t.forEach(function(o){return i.expandByObject(o)}),Object.assign.apply(Object,v(["x","y","z"].map(function(o){return ie({},o,[i.min[o],i.max[o]])})))):null},getScreenCoords:function(n,e,i,t){var o=new c.Vector3(e,i,t);return o.project(this.camera()),{x:(o.x+1)*n.width/2,y:-(o.y-1)*n.height/2}},getSceneCoords:function(n,e,i){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=new c.Vector2(e/n.width*2-1,-(i/n.height)*2+1),l=new c.Raycaster;return l.setFromCamera(o,n.camera),Object.assign({},l.ray.at(t,new c.Vector3))},intersectingObjects:function(n,e,i){var t=new c.Vector2(e/n.width*2-1,-(i/n.height)*2+1),o=new c.Raycaster;return o.params.Line.threshold=n.lineHoverPrecision,o.setFromCamera(t,n.camera),o.intersectObjects(n.objects,!0)},renderer:function(n){return n.renderer},scene:function(n){return n.scene},camera:function(n){return n.camera},postProcessingComposer:function(n){return n.postProcessingComposer},controls:function(n){return n.controls},tbControls:function(n){return n.controls}},stateInit:function(){return{scene:new c.Scene,camera:new c.PerspectiveCamera,clock:new c.Clock,tweenGroup:new K}},init:function(n,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=i.controlType,o=t===void 0?"trackball":t,l=i.useWebGPU,s=l===void 0?!1:l,f=i.rendererConfig,p=f===void 0?{}:f,m=i.extraRenderers,g=m===void 0?[]:m,h=i.waitForLoadComplete,d=h===void 0?!0:h;n.innerHTML="",n.appendChild(e.container=document.createElement("div")),e.container.className="scene-container",e.container.style.position="relative",e.container.appendChild(e.navInfo=document.createElement("div")),e.navInfo.className="scene-nav-info",e.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[o]||"",e.navInfo.style.display=e.showNavInfo?null:"none",e.toolTipElem=document.createElement("div"),e.toolTipElem.classList.add("scene-tooltip"),e.container.appendChild(e.toolTipElem),e.pointerPos=new c.Vector2,e.pointerPos.x=-2,e.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(a){return e.container.addEventListener(a,function(u){if(a==="pointerdown"&&(e.isPointerPressed=!0),!e.isPointerDragging&&u.type==="pointermove"&&(u.pressure>0||e.isPointerPressed)&&(u.pointerType!=="touch"||u.movementX===void 0||[u.movementX,u.movementY].some(function(w){return Math.abs(w)>1}))&&(e.isPointerDragging=!0),e.enablePointerInteraction){var y=b(e.container);e.pointerPos.x=u.pageX-y.left,e.pointerPos.y=u.pageY-y.top,e.toolTipElem.style.top="".concat(e.pointerPos.y,"px"),e.toolTipElem.style.left="".concat(e.pointerPos.x,"px"),e.toolTipElem.style.transform="translate(-".concat(e.pointerPos.x/e.width*100,"%, ").concat(e.height-e.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}function b(w){var P=w.getBoundingClientRect(),T=window.pageXOffset||document.documentElement.scrollLeft,R=window.pageYOffset||document.documentElement.scrollTop;return{top:P.top+R,left:P.left+T}}},{passive:!0})}),e.container.addEventListener("pointerup",function(a){e.isPointerPressed=!1,!(e.isPointerDragging&&(e.isPointerDragging=!1,!e.clickAfterDrag))&&requestAnimationFrame(function(){a.button===0&&e.onClick(e.hoverObj||null,a,e.intersectionPoint),a.button===2&&e.onRightClick&&e.onRightClick(e.hoverObj||null,a,e.intersectionPoint)})},{passive:!0,capture:!0}),e.container.addEventListener("contextmenu",function(a){e.onRightClick&&a.preventDefault()}),e.renderer=new(s?A:c.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},p)),e.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),e.container.appendChild(e.renderer.domElement),e.extraRenderers=g,e.extraRenderers.forEach(function(a){a.domElement.style.position="absolute",a.domElement.style.top="0px",a.domElement.style.pointerEvents="none",e.container.appendChild(a.domElement)}),e.postProcessingComposer=new U(e.renderer),e.postProcessingComposer.addPass(new D(e.scene,e.camera)),e.controls=new{trackball:V,orbit:z,fly:G}[o](e.camera,e.renderer.domElement),o==="fly"&&(e.controls.movementSpeed=300,e.controls.rollSpeed=Math.PI/6,e.controls.dragToLook=!0),(o==="trackball"||o==="orbit")&&(e.controls.minDistance=.1,e.controls.maxDistance=e.skyRadius,e.controls.addEventListener("start",function(){e.controlsEngaged=!0}),e.controls.addEventListener("change",function(){e.controlsEngaged&&(e.controlsDragging=!0)}),e.controls.addEventListener("end",function(){e.controlsEngaged=!1,e.controlsDragging=!1})),[e.renderer,e.postProcessingComposer].concat(v(e.extraRenderers)).forEach(function(a){return a.setSize(e.width,e.height)}),e.camera.aspect=e.width/e.height,e.camera.updateProjectionMatrix(),e.camera.position.z=1e3,e.scene.add(e.skysphere=new c.Mesh),e.skysphere.visible=!1,e.loadComplete=e.scene.visible=!d,window.scene=e.scene},update:function(n,e){if(n.width&&n.height&&(e.hasOwnProperty("width")||e.hasOwnProperty("height"))&&(n.container.style.width="".concat(n.width,"px"),n.container.style.height="".concat(n.height,"px"),[n.renderer,n.postProcessingComposer].concat(v(n.extraRenderers)).forEach(function(o){return o.setSize(n.width,n.height)}),n.camera.aspect=n.width/n.height,n.camera.updateProjectionMatrix()),e.hasOwnProperty("skyRadius")&&n.skyRadius&&(n.controls.hasOwnProperty("maxDistance")&&e.skyRadius&&(n.controls.maxDistance=Math.min(n.controls.maxDistance,n.skyRadius)),n.camera.far=n.skyRadius*2.5,n.camera.updateProjectionMatrix(),n.skysphere.geometry=new c.SphereGeometry(n.skyRadius)),e.hasOwnProperty("backgroundColor")){var i=q(n.backgroundColor).alpha;i===void 0&&(i=1),n.renderer.setClearColor(new c.Color(Y(1,n.backgroundColor)),i)}e.hasOwnProperty("backgroundImageUrl")&&(n.backgroundImageUrl?new c.TextureLoader().load(n.backgroundImageUrl,function(o){o.colorSpace=c.SRGBColorSpace,n.skysphere.material=new c.MeshBasicMaterial({map:o,side:c.BackSide}),n.skysphere.visible=!0,n.onBackgroundImageLoaded&&setTimeout(n.onBackgroundImageLoaded),!n.loadComplete&&t()}):(n.skysphere.visible=!1,n.skysphere.material.map=null,!n.loadComplete&&t())),e.hasOwnProperty("showNavInfo")&&(n.navInfo.style.display=n.showNavInfo?null:"none"),e.hasOwnProperty("lights")&&((e.lights||[]).forEach(function(o){return n.scene.remove(o)}),n.lights.forEach(function(o){return n.scene.add(o)})),e.hasOwnProperty("objects")&&((e.objects||[]).forEach(function(o){return n.scene.remove(o)}),n.objects.forEach(function(o){return n.scene.add(o)}));function t(){n.loadComplete=n.scene.visible=!0}}});export{ye as t};
