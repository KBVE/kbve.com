const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/supabaseClient.BVs_U1Yj.js","_astro/@supabase.YBEbTA-W.js","_astro/@react-three.B-wTPXHf.js","_astro/react.CvslfkeK.js","_astro/Page.astro_astro_type_script_index_0_lang.DQ_zeJSQ.js","_astro/react-dom.CtWA3ti2.js","_astro/svelte.BEh2_tzM.js","_astro/esm-env.rsSWfq8L.js"])))=>i.map(i=>d[i]);
import{j as e,r as l}from"./react.CvslfkeK.js";import{u as d}from"./@nanostores.vmeSb_hF.js";import{u as x,a as b,b as h,s as p,c as m}from"./userstate.DNABvgUj.js";import{t}from"./tailwind-merge.B9ugUrge.js";import{_ as g}from"./Page.astro_astro_type_script_index_0_lang.DQ_zeJSQ.js";import{T as j,M as c,R as y}from"./lucide-react.4nCU159t.js";import"./@react-three.B-wTPXHf.js";import"./nanostores.Bo9-_MAV.js";import"./supabaseClient.BVs_U1Yj.js";import"./@supabase.YBEbTA-W.js";import"./react-dom.CtWA3ti2.js";import"./svelte.BEh2_tzM.js";import"./esm-env.rsSWfq8L.js";const v=()=>{const r=d(x),n=r?.email&&r?.email_confirmed_at,a=r?.email&&!r?.email_confirmed_at;return n?null:e.jsxs("div",{className:t("flex flex-col items-center justify-center gap-4 p-6 rounded-xl","bg-gradient-to-br from-amber-100/80 to-red-100/60 dark:from-amber-900/40 dark:to-red-900/30","border-2 border-amber-300 dark:border-amber-600","shadow-lg"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-8 h-8 text-amber-600 dark:text-amber-400"}),e.jsx(c,{className:"w-8 h-8 text-red-600 dark:text-red-400"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-xl font-bold text-amber-800 dark:text-amber-200",children:"Email Verification Required"}),r?.email?a?e.jsxs("p",{className:"text-amber-700 dark:text-amber-300",children:["Your email address ",e.jsx("span",{className:"font-semibold",children:r.email})," needs to be verified before you can access member features."]}):null:e.jsx("p",{className:"text-amber-700 dark:text-amber-300",children:"No email address found on your account. A verified email is required to access member features."})]}),e.jsxs("div",{className:"flex flex-col gap-3 w-full max-w-sm",children:[r?.email?e.jsxs("button",{onClick:async()=>{const{error:i}=await g(async()=>{const{error:s}=await import("./supabaseClient.BVs_U1Yj.js");return{error:s}},__vite__mapDeps([0,1,2,3,4,5,6,7])).then(({supabase:s})=>s.auth.resend({type:"signup",email:r.email}));alert(i?"Failed to resend verification email: "+i.message:"Verification email sent! Please check your inbox.")},className:t("inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg","bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold","hover:from-green-600 hover:to-green-700 transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-offset-2"),children:[e.jsx(c,{className:"w-4 h-4"}),"Resend Verification Email"]}):e.jsxs("a",{href:"/settings",className:t("inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg","bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold","hover:from-blue-600 hover:to-blue-700 transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2"),children:[e.jsx(c,{className:"w-4 h-4"}),"Add Email Address"]}),e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 text-center",children:"Member onboarding will be available once your email is verified."})]})]})},U=()=>{const r=d(b),n=d(x),a=d(h),[i,s]=l.useState(!1),[o,f]=l.useState(!1),u=n?.email&&n?.email_confirmed_at;return l.useEffect(()=>{p()},[]),l.useEffect(()=>{r&&m(r)},[r]),r?r&&!a?u?e.jsxs("div",{className:t("flex flex-col items-center justify-center gap-4 p-6 rounded-xl bg-gradient-to-br from-cyan-100/60 to-purple-100/40 dark:from-cyan-900/30 dark:to-purple-900/20 shadow-lg"),children:[e.jsx("div",{className:"text-lg font-semibold text-neutral-700 dark:text-neutral-200",children:"No member profile found."}),e.jsx("a",{href:"/onboarding",className:t("inline-block px-5 py-2 rounded-lg bg-gradient-to-r from-cyan-400 to-purple-400 text-white font-bold shadow hover:from-cyan-500 hover:to-purple-500 transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-offset-2"),children:"Start Onboarding"})]}):e.jsx(v,{}):a?e.jsxs("div",{className:t("w-full max-w-md mx-auto rounded-2xl p-6 shadow-xl bg-white/80 dark:bg-zinc-900/70 border border-cyan-200 dark:border-zinc-800","flex flex-col gap-2 items-center","transition-all duration-300","relative"),children:[e.jsxs("button",{onClick:async()=>{s(!0),f(!0),await m(r,!1),s(!1)},className:t("absolute top-4 right-4 group inline-flex items-center justify-center w-8 h-8 rounded-md border border-cyan-400 dark:border-cyan-700","bg-white/30 dark:bg-zinc-800/50 text-cyan-600 dark:text-cyan-300 hover:bg-cyan-100/50 dark:hover:bg-cyan-800/60 transition",o&&"opacity-50 cursor-not-allowed pointer-events-none"),"aria-label":"Refresh Balance",disabled:o,children:[e.jsx(y,{className:t("w-4 h-4",i&&"animate-spin")}),e.jsx("span",{className:t("absolute bottom-full mb-1 w-max max-w-xs px-2 py-1 rounded bg-neutral-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity",o&&"cursor-not-allowed"),children:o?"Already pulled live":"Pull balance from live view"})]}),e.jsx("h2",{className:t("text-2xl font-bold text-cyan-700 dark:text-cyan-300 mb-2"),children:"Member Card"}),e.jsxs("div",{className:"w-full flex flex-col gap-1 text-base text-neutral-800 dark:text-neutral-200",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Username:"})," ",a.username]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Level:"})," ",a.level??"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Role:"})," ",a.role??"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Credits:"})," ",typeof a.credits=="number"?a.credits.toFixed(2):"0.00"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"KHash:"})," ",typeof a.khash=="number"?a.khash.toFixed(2):"0.00"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Joined:"})," ",new Date(a.created_at).toLocaleDateString()]})]})]}):e.jsx("div",{className:t("text-center text-neutral-600 dark:text-neutral-300 p-4"),children:"Loading member data..."}):e.jsx("div",{className:t("text-center text-neutral-600 dark:text-neutral-300 p-4"),children:"Please log in to view your member card."})};export{U as default};
